(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,185357,180766,782719,969641,476993,824296,64352,266537,230312,e=>{"use strict";var t,a,i=e.i(843476),r=e.i(808613),l=e.i(311451),n=e.i(212931),s=e.i(199133),o=e.i(262218),c=e.i(898586),d=e.i(464571),u=e.i(271645),p=e.i(727749),m=e.i(764205),g=e.i(770914),h=e.i(515831),x=e.i(175712),f=e.i(646563),y=e.i(519756);let{Text:j}=c.Typography,{Option:_}=s.Select,v=({visible:e,prebuiltPatterns:t,categories:a,selectedPatternName:r,patternAction:l,onPatternNameChange:o,onActionChange:c,onAdd:u,onCancel:p})=>(0,i.jsxs)(n.Modal,{title:"Add prebuilt pattern",open:e,onCancel:p,footer:null,width:800,children:[(0,i.jsxs)(g.Space,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(j,{strong:!0,children:"Pattern type"}),(0,i.jsx)(s.Select,{placeholder:"Choose pattern type",value:r,onChange:o,style:{width:"100%",marginTop:8},showSearch:!0,filterOption:(e,a)=>{let i=t.find(e=>e.name===a?.value);return!!i&&(i.display_name.toLowerCase().includes(e.toLowerCase())||i.name.toLowerCase().includes(e.toLowerCase()))},children:a.map(e=>{let a=t.filter(t=>t.category===e);return 0===a.length?null:(0,i.jsx)(s.Select.OptGroup,{label:e,children:a.map(e=>(0,i.jsx)(_,{value:e.name,children:e.display_name},e.name))},e)})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(j,{strong:!0,children:"Action"}),(0,i.jsx)(j,{type:"secondary",style:{display:"block",marginTop:4,marginBottom:8},children:"Choose what action the guardrail should take when this pattern is detected"}),(0,i.jsxs)(s.Select,{value:l,onChange:c,style:{width:"100%"},children:[(0,i.jsx)(_,{value:"BLOCK",children:"Block"}),(0,i.jsx)(_,{value:"MASK",children:"Mask"})]})]})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"24px"},children:[(0,i.jsx)(d.Button,{onClick:p,children:"Cancel"}),(0,i.jsx)(d.Button,{type:"primary",onClick:u,children:"Add"})]})]}),{Text:b}=c.Typography,{Option:C}=s.Select,w=({visible:e,patternName:t,patternRegex:a,patternAction:r,onNameChange:o,onRegexChange:c,onActionChange:u,onAdd:p,onCancel:m})=>(0,i.jsxs)(n.Modal,{title:"Add custom regex pattern",open:e,onCancel:m,footer:null,width:800,children:[(0,i.jsxs)(g.Space,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(b,{strong:!0,children:"Pattern name"}),(0,i.jsx)(l.Input,{placeholder:"e.g., internal_id, employee_code",value:t,onChange:e=>o(e.target.value),style:{marginTop:8}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(b,{strong:!0,children:"Regex pattern"}),(0,i.jsx)(l.Input,{placeholder:"e.g., ID-[0-9]{6}",value:a,onChange:e=>c(e.target.value),style:{marginTop:8}}),(0,i.jsx)(b,{type:"secondary",style:{fontSize:12},children:"Enter a valid regular expression to match sensitive data"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(b,{strong:!0,children:"Action"}),(0,i.jsx)(b,{type:"secondary",style:{display:"block",marginTop:4,marginBottom:8},children:"Choose what action the guardrail should take when this pattern is detected"}),(0,i.jsxs)(s.Select,{value:r,onChange:u,style:{width:"100%"},children:[(0,i.jsx)(C,{value:"BLOCK",children:"Block"}),(0,i.jsx)(C,{value:"MASK",children:"Mask"})]})]})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"24px"},children:[(0,i.jsx)(d.Button,{onClick:m,children:"Cancel"}),(0,i.jsx)(d.Button,{type:"primary",onClick:p,children:"Add"})]})]}),{Text:S}=c.Typography,{Option:k}=s.Select,N=({visible:e,keyword:t,action:a,description:r,onKeywordChange:o,onActionChange:c,onDescriptionChange:u,onAdd:p,onCancel:m})=>(0,i.jsxs)(n.Modal,{title:"Add blocked keyword",open:e,onCancel:m,footer:null,width:800,children:[(0,i.jsxs)(g.Space,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(S,{strong:!0,children:"Keyword"}),(0,i.jsx)(l.Input,{placeholder:"Enter sensitive keyword or phrase",value:t,onChange:e=>o(e.target.value),style:{marginTop:8}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(S,{strong:!0,children:"Action"}),(0,i.jsx)(S,{type:"secondary",style:{display:"block",marginTop:4,marginBottom:8},children:"Choose what action the guardrail should take when this keyword is detected"}),(0,i.jsxs)(s.Select,{value:a,onChange:c,style:{width:"100%"},children:[(0,i.jsx)(k,{value:"BLOCK",children:"Block"}),(0,i.jsx)(k,{value:"MASK",children:"Mask"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(S,{strong:!0,children:"Description (optional)"}),(0,i.jsx)(l.Input.TextArea,{placeholder:"Explain why this keyword is sensitive",value:r,onChange:e=>u(e.target.value),rows:3,style:{marginTop:8}})]})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"24px"},children:[(0,i.jsx)(d.Button,{onClick:m,children:"Cancel"}),(0,i.jsx)(d.Button,{type:"primary",onClick:p,children:"Add"})]})]});var A=e.i(291542),I=e.i(955135);let{Text:O}=c.Typography,{Option:T}=s.Select,P=({patterns:e,onActionChange:t,onRemove:a})=>{let r=[{title:"Type",dataIndex:"type",key:"type",width:100,render:e=>(0,i.jsx)(o.Tag,{color:"prebuilt"===e?"blue":"green",children:"prebuilt"===e?"Prebuilt":"Custom"})},{title:"Pattern name",dataIndex:"name",key:"name",render:(e,t)=>t.display_name||t.name},{title:"Regex pattern",dataIndex:"pattern",key:"pattern",render:e=>e?(0,i.jsxs)(O,{code:!0,style:{fontSize:12},children:[e.substring(0,40),"..."]}):"-"},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,a)=>(0,i.jsxs)(s.Select,{value:e,onChange:e=>t(a.id,e),style:{width:120},size:"small",children:[(0,i.jsx)(T,{value:"BLOCK",children:"Block"}),(0,i.jsx)(T,{value:"MASK",children:"Mask"})]})},{title:"",key:"actions",width:100,render:(e,t)=>(0,i.jsx)(d.Button,{type:"text",danger:!0,size:"small",icon:(0,i.jsx)(I.DeleteOutlined,{}),onClick:()=>a(t.id),children:"Delete"})}];return 0===e.length?(0,i.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:"No patterns added."}):(0,i.jsx)(A.Table,{dataSource:e,columns:r,rowKey:"id",pagination:!1,size:"small"})},{Text:L}=c.Typography,{Option:B}=s.Select,F=({keywords:e,onActionChange:t,onRemove:a})=>{let r=[{title:"Keyword",dataIndex:"keyword",key:"keyword"},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,a)=>(0,i.jsxs)(s.Select,{value:e,onChange:e=>t(a.id,"action",e),style:{width:120},size:"small",children:[(0,i.jsx)(B,{value:"BLOCK",children:"Block"}),(0,i.jsx)(B,{value:"MASK",children:"Mask"})]})},{title:"Description",dataIndex:"description",key:"description",render:e=>e||"-"},{title:"",key:"actions",width:100,render:(e,t)=>(0,i.jsx)(d.Button,{type:"text",danger:!0,size:"small",icon:(0,i.jsx)(I.DeleteOutlined,{}),onClick:()=>a(t.id),children:"Delete"})}];return 0===e.length?(0,i.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:"No keywords added."}):(0,i.jsx)(A.Table,{dataSource:e,columns:r,rowKey:"id",pagination:!1,size:"small"})};var E=e.i(362024),M=e.i(993914);let{Title:z,Text:$}=c.Typography,{Option:R}=s.Select,D=({availableCategories:e,selectedCategories:t,onCategoryAdd:a,onCategoryRemove:r,onCategoryUpdate:l,accessToken:n,pendingSelection:c,onPendingSelectionChange:p})=>{let[g,h]=u.default.useState(""),y=void 0!==c?c:g,j=p||h,[_,v]=u.default.useState({}),[b,C]=u.default.useState({}),[w,S]=u.default.useState({}),[k,N]=u.default.useState([]),[O,T]=u.default.useState(""),[P,L]=u.default.useState(!1),B=async e=>{if(n&&!_[e]){S(t=>({...t,[e]:!0}));try{let t=await (0,m.getCategoryYaml)(n,e),a=t.yaml_content;if("json"===t.file_type)try{let e=JSON.parse(a);a=JSON.stringify(e,null,2)}catch(t){console.warn(`Failed to format JSON for ${e}:`,t)}v(t=>({...t,[e]:a})),C(a=>({...a,[e]:t.file_type||"yaml"}))}catch(t){console.error(`Failed to fetch content for category ${e}:`,t)}finally{S(t=>({...t,[e]:!1}))}}};u.default.useEffect(()=>{if(y&&n){let e=_[y];if(e)return void T(e);L(!0),console.log(`Fetching content for category: ${y}`,{accessToken:n?"present":"missing"}),(0,m.getCategoryYaml)(n,y).then(e=>{console.log(`Successfully fetched content for ${y}:`,e);let t=e.yaml_content;if("json"===e.file_type)try{let e=JSON.parse(t);t=JSON.stringify(e,null,2)}catch(e){console.warn(`Failed to format JSON for ${y}:`,e)}T(t),v(e=>({...e,[y]:t})),C(t=>({...t,[y]:e.file_type||"yaml"}))}).catch(e=>{console.error(`Failed to fetch preview content for category ${y}:`,e),T("")}).finally(()=>{L(!1)})}else T(""),L(!1)},[y,n]);let F=[{title:"Category",dataIndex:"display_name",key:"display_name",render:(t,a)=>{let r=e.find(e=>e.name===a.category);return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontWeight:500},children:t}),r?.description&&(0,i.jsx)("div",{style:{fontSize:"12px",color:"#888",marginTop:"4px"},children:r.description})]})}},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,t)=>(0,i.jsxs)(s.Select,{value:e,onChange:e=>l(t.id,"action",e),style:{width:"100%"},children:[(0,i.jsx)(R,{value:"BLOCK",children:(0,i.jsx)(o.Tag,{color:"red",children:"BLOCK"})}),(0,i.jsx)(R,{value:"MASK",children:(0,i.jsx)(o.Tag,{color:"orange",children:"MASK"})})]})},{title:"Severity Threshold",dataIndex:"severity_threshold",key:"severity_threshold",width:180,render:(e,t)=>(0,i.jsxs)(s.Select,{value:e,onChange:e=>l(t.id,"severity_threshold",e),style:{width:"100%"},children:[(0,i.jsx)(R,{value:"low",children:"Low"}),(0,i.jsx)(R,{value:"medium",children:"Medium"}),(0,i.jsx)(R,{value:"high",children:"High"})]})},{title:"",key:"actions",width:80,render:(e,t)=>(0,i.jsx)(d.Button,{icon:(0,i.jsx)(I.DeleteOutlined,{}),onClick:()=>r(t.id),size:"small",children:"Remove"})}],D=e.filter(e=>!t.some(t=>t.category===e.name));return(0,i.jsxs)(x.Card,{title:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:8},children:[(0,i.jsx)(z,{level:5,style:{margin:0},children:"Blocked topics"}),(0,i.jsx)($,{type:"secondary",style:{fontSize:12,fontWeight:400},children:"Select topics to block using keyword and semantic analysis"})]}),size:"small",children:[(0,i.jsxs)("div",{style:{marginBottom:16,display:"flex",gap:8},children:[(0,i.jsx)(s.Select,{placeholder:"Select a content category",value:y||void 0,onChange:j,style:{flex:1},showSearch:!0,optionLabelProp:"label",filterOption:(e,t)=>(t?.label?.toString().toLowerCase()??"").includes(e.toLowerCase()),children:D.map(e=>(0,i.jsx)(R,{value:e.name,label:e.display_name,children:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontWeight:500},children:e.display_name}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:e.description})]})},e.name))}),(0,i.jsx)(d.Button,{type:"primary",onClick:()=>{if(!y)return;let i=e.find(e=>e.name===y);!i||t.some(e=>e.category===y)||(a({id:`category-${Date.now()}`,category:i.name,display_name:i.display_name,action:i.default_action,severity_threshold:"medium"}),j(""),T(""))},disabled:!y,icon:(0,i.jsx)(f.PlusOutlined,{}),children:"Add"})]}),y&&(0,i.jsxs)("div",{style:{marginBottom:16,padding:"12px",background:"#f9f9f9",border:"1px solid #e0e0e0",borderRadius:"4px"},children:[(0,i.jsxs)("div",{style:{marginBottom:8,fontWeight:500,fontSize:"14px"},children:["Preview: ",e.find(e=>e.name===y)?.display_name,b[y]&&(0,i.jsxs)("span",{style:{marginLeft:8,fontSize:"12px",color:"#888",fontWeight:400},children:["(",b[y]?.toUpperCase(),")"]})]}),P?(0,i.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#888"},children:"Loading content..."}):O?(0,i.jsx)("pre",{style:{background:"#fff",padding:"12px",borderRadius:"4px",overflow:"auto",maxHeight:"300px",maxWidth:"100%",fontSize:"12px",lineHeight:"1.5",margin:0,border:"1px solid #e0e0e0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:(0,i.jsx)("code",{children:O})}):(0,i.jsx)("div",{style:{padding:"8px",textAlign:"center",color:"#888",fontSize:"12px"},children:"Unable to load category content"})]}),t.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(A.Table,{dataSource:t,columns:F,pagination:!1,size:"small",rowKey:"id"}),(0,i.jsx)("div",{style:{marginTop:16},children:(0,i.jsx)(E.Collapse,{activeKey:k,onChange:e=>{let t=Array.isArray(e)?e:e?[e]:[],a=new Set(k);t.forEach(e=>{a.has(e)||_[e]||B(e)}),N(t)},ghost:!0,items:t.map(e=>{let t=(b[e.category]||"yaml").toUpperCase();return{key:e.category,label:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,i.jsx)(M.FileTextOutlined,{}),(0,i.jsxs)("span",{children:["View ",t," for ",e.display_name]})]}),children:w[e.category]?(0,i.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#888"},children:"Loading content..."}):_[e.category]?(0,i.jsx)("pre",{style:{background:"#f5f5f5",padding:"16px",borderRadius:"4px",overflow:"auto",maxHeight:"400px",fontSize:"12px",lineHeight:"1.5",margin:0},children:(0,i.jsx)("code",{children:_[e.category]})}):(0,i.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#888"},children:"Content will load when expanded"})}})})})]}):(0,i.jsx)("div",{style:{textAlign:"center",padding:"24px",color:"#888",border:"1px dashed #d9d9d9",borderRadius:"4px"},children:"No blocked topics selected. Add topics to detect and block harmful content."})]})};var G=e.i(790848),K=e.i(28651);let{Title:q,Text:J}=c.Typography,{Option:U}=s.Select,W={competitor_intent_type:"airline",brand_self:[],locations:[],policy:{competitor_comparison:"refuse",possible_competitor_comparison:"reframe"},threshold_high:.7,threshold_medium:.45,threshold_low:.3},H=({enabled:e,config:t,onChange:a,accessToken:l})=>{let n=t??W,[o,c]=(0,u.useState)([]),[d,p]=(0,u.useState)(!1);(0,u.useEffect)(()=>{"airline"===n.competitor_intent_type&&l&&0===o.length&&(p(!0),(0,m.getMajorAirlines)(l).then(e=>c(e.airlines??[])).catch(()=>c([])).finally(()=>p(!1)))},[n.competitor_intent_type,l,o.length]);let h=e=>{a(e,e?{...W}:null)},f=(t,i)=>{a(e,{...n,[t]:i})},y=(t,i)=>{a(e,{...n,policy:{...n.policy,[t]:i}})},j=(t,i)=>{a(e,{...n,[t]:i.filter(Boolean)})};return e?(0,i.jsxs)(x.Card,{title:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)(q,{level:5,style:{margin:0},children:"Competitor Intent Filter"}),(0,i.jsx)(G.Switch,{checked:e,onChange:h})]}),size:"small",children:[(0,i.jsx)(J,{type:"secondary",style:{display:"block",marginBottom:16},children:"Block or reframe competitor comparison questions. Airline type uses major airlines (excluding your brand); generic requires manual competitor list."}),(0,i.jsxs)(r.Form,{layout:"vertical",size:"small",children:[(0,i.jsx)(r.Form.Item,{label:"Type",children:(0,i.jsxs)(s.Select,{value:n.competitor_intent_type,onChange:e=>f("competitor_intent_type",e),style:{width:"100%"},children:[(0,i.jsx)(U,{value:"airline",children:"Airline (auto-load competitors from IATA)"}),(0,i.jsx)(U,{value:"generic",children:"Generic (specify competitors manually)"})]})}),(0,i.jsx)(r.Form.Item,{label:"Your Brand (brand_self)",required:!0,help:"airline"===n.competitor_intent_type?"Select your airline from the list (excluded from competitors) or type to add a custom term":"Names/codes users use for your brand",children:(0,i.jsx)(s.Select,{mode:"tags",style:{width:"100%"},placeholder:d?"Loading airlines...":"airline"===n.competitor_intent_type?"Search or select airline, or type to add custom":"Type and press Enter to add",value:n.brand_self,onChange:t=>"airline"===n.competitor_intent_type&&o.length>0?(t=>{let i=t.filter(Boolean),r=[],l=new Set;for(let e of i){let t=o.find(t=>t.match.split("|")[0]?.trim().toLowerCase()===e.toLowerCase());if(t)for(let e of t.match.split("|").map(e=>e.trim().toLowerCase()).filter(Boolean))l.has(e)||(l.add(e),r.push(e));else l.has(e.toLowerCase())||(l.add(e.toLowerCase()),r.push(e))}a(e,{...n,brand_self:r})})(t??[]):j("brand_self",t??[]),tokenSeparators:[","],loading:d,showSearch:!0,filterOption:(e,t)=>(t?.label?.toString().toLowerCase()??"").includes(e.toLowerCase()),optionFilterProp:"label",options:"airline"===n.competitor_intent_type&&o.length>0?o.map(e=>{let t=e.match.split("|")[0]?.trim()??e.id,a=e.match.split("|").map(e=>e.trim().toLowerCase()).filter(Boolean);return{value:t.toLowerCase(),label:`${t}${a.length>1?` (${a.slice(1).join(", ")})`:""}`}}):void 0})}),"airline"===n.competitor_intent_type&&(0,i.jsx)(r.Form.Item,{label:"Locations (optional)",help:"Countries, cities, airports for disambiguation (e.g. qatar, doha)",children:(0,i.jsx)(s.Select,{mode:"tags",style:{width:"100%"},placeholder:"Type and press Enter to add",value:n.locations??[],onChange:e=>j("locations",e??[]),tokenSeparators:[","]})}),"generic"===n.competitor_intent_type&&(0,i.jsx)(r.Form.Item,{label:"Competitors",required:!0,help:"Competitor names to detect (required for generic type)",children:(0,i.jsx)(s.Select,{mode:"tags",style:{width:"100%"},placeholder:"Type and press Enter to add",value:n.competitors??[],onChange:e=>j("competitors",e??[]),tokenSeparators:[","]})}),(0,i.jsx)(r.Form.Item,{label:"Policy: Competitor comparison",children:(0,i.jsxs)(s.Select,{value:n.policy?.competitor_comparison??"refuse",onChange:e=>y("competitor_comparison",e),style:{width:"100%"},children:[(0,i.jsx)(U,{value:"refuse",children:"Refuse (block request)"}),(0,i.jsx)(U,{value:"reframe",children:"Reframe (suggest alternative)"})]})}),(0,i.jsx)(r.Form.Item,{label:"Policy: Possible competitor comparison",children:(0,i.jsxs)(s.Select,{value:n.policy?.possible_competitor_comparison??"reframe",onChange:e=>y("possible_competitor_comparison",e),style:{width:"100%"},children:[(0,i.jsx)(U,{value:"refuse",children:"Refuse (block request)"}),(0,i.jsx)(U,{value:"reframe",children:"Reframe (suggest alternative to backend LLM)"})]})}),(0,i.jsx)(r.Form.Item,{label:"Confidence thresholds",help:(0,i.jsxs)(i.Fragment,{children:["Classify competitor intent by confidence (0–1). Higher confidence → stronger intent.",(0,i.jsxs)("ul",{style:{marginBottom:0,marginTop:4,paddingLeft:20},children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"High (≥)"}),': Treat as full competitor comparison → uses "Competitor comparison" policy']}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Medium (≥)"}),': Treat as possible comparison → uses "Possible competitor comparison" policy']}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Low (≥)"}),": Log only; allow request. Below Low → allow with no action"]})]}),"Raise thresholds to be more permissive; lower them to be stricter."]}),children:(0,i.jsxs)(g.Space,{wrap:!0,children:[(0,i.jsx)(r.Form.Item,{label:"High",style:{marginBottom:0},help:"e.g. 0.7",children:(0,i.jsx)(K.InputNumber,{min:0,max:1,step:.05,value:n.threshold_high??.7,onChange:e=>f("threshold_high",e??.7),style:{width:80}})}),(0,i.jsx)(r.Form.Item,{label:"Medium",style:{marginBottom:0},help:"e.g. 0.45",children:(0,i.jsx)(K.InputNumber,{min:0,max:1,step:.05,value:n.threshold_medium??.45,onChange:e=>f("threshold_medium",e??.45),style:{width:80}})}),(0,i.jsx)(r.Form.Item,{label:"Low",style:{marginBottom:0},help:"e.g. 0.3",children:(0,i.jsx)(K.InputNumber,{min:0,max:1,step:.05,value:n.threshold_low??.3,onChange:e=>f("threshold_low",e??.3),style:{width:80}})})]})})]})]}):(0,i.jsx)(x.Card,{title:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)(q,{level:5,style:{margin:0},children:"Competitor Intent Filter"}),(0,i.jsx)(G.Switch,{checked:!1,onChange:h})]}),size:"small",children:(0,i.jsx)(J,{type:"secondary",children:"Block or reframe competitor comparison questions. When enabled, airline type auto-loads competitors from IATA; generic type requires manual competitor list."})})},{Title:V,Text:Y}=c.Typography,Z=({prebuiltPatterns:e,categories:t,selectedPatterns:a,blockedWords:r,onPatternAdd:l,onPatternRemove:n,onPatternActionChange:s,onBlockedWordAdd:o,onBlockedWordRemove:c,onBlockedWordUpdate:j,onFileUpload:_,accessToken:b,showStep:C,contentCategories:S=[],selectedContentCategories:k=[],onContentCategoryAdd:A,onContentCategoryRemove:I,onContentCategoryUpdate:O,pendingCategorySelection:T,onPendingCategorySelectionChange:L,competitorIntentEnabled:B=!1,competitorIntentConfig:E=null,onCompetitorIntentChange:M})=>{let[z,$]=(0,u.useState)(!1),[R,G]=(0,u.useState)(!1),[K,q]=(0,u.useState)(!1),[J,U]=(0,u.useState)(""),[W,Z]=(0,u.useState)("BLOCK"),[Q,X]=(0,u.useState)(""),[ee,et]=(0,u.useState)(""),[ea,ei]=(0,u.useState)("BLOCK"),[er,el]=(0,u.useState)(""),[en,es]=(0,u.useState)("BLOCK"),[eo,ec]=(0,u.useState)(""),[ed,eu]=(0,u.useState)(!1),ep=async e=>{eu(!0);try{let t=await e.text();if(b){let e=await (0,m.validateBlockedWordsFile)(b,t);if(e.valid)_&&_(t),p.default.success(e.message||"File uploaded successfully");else{let t=e.error||e.errors&&e.errors.join(", ")||"Invalid file";p.default.error(`Validation failed: ${t}`)}}}catch(e){p.default.error(`Failed to upload file: ${e}`)}finally{eu(!1)}return!1};return(0,i.jsxs)("div",{className:"space-y-6",children:[!C&&(0,i.jsx)("div",{children:(0,i.jsx)(Y,{type:"secondary",children:"Configure patterns, keywords, and content categories to detect and filter sensitive information in requests and responses."})}),(!C||"patterns"===C)&&(0,i.jsxs)(x.Card,{title:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)(V,{level:5,style:{margin:0},children:"Pattern Detection"}),(0,i.jsx)(Y,{type:"secondary",style:{fontSize:14,fontWeight:400},children:"Detect sensitive information using regex patterns (SSN, credit cards, API keys, etc.)"})]}),size:"small",children:[(0,i.jsx)("div",{style:{marginBottom:16},children:(0,i.jsxs)(g.Space,{children:[(0,i.jsx)(d.Button,{type:"primary",onClick:()=>$(!0),icon:(0,i.jsx)(f.PlusOutlined,{}),children:"Add prebuilt pattern"}),(0,i.jsx)(d.Button,{onClick:()=>q(!0),icon:(0,i.jsx)(f.PlusOutlined,{}),children:"Add custom regex"})]})}),(0,i.jsx)(P,{patterns:a,onActionChange:s,onRemove:n})]}),(!C||"keywords"===C)&&(0,i.jsxs)(x.Card,{title:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)(V,{level:5,style:{margin:0},children:"Blocked Keywords"}),(0,i.jsx)(Y,{type:"secondary",style:{fontSize:14,fontWeight:400},children:"Block or mask specific sensitive terms and phrases"})]}),size:"small",children:[(0,i.jsx)("div",{style:{marginBottom:16},children:(0,i.jsxs)(g.Space,{children:[(0,i.jsx)(d.Button,{type:"primary",onClick:()=>G(!0),icon:(0,i.jsx)(f.PlusOutlined,{}),children:"Add keyword"}),(0,i.jsx)(h.Upload,{beforeUpload:ep,accept:".yaml,.yml",showUploadList:!1,children:(0,i.jsx)(d.Button,{icon:(0,i.jsx)(y.UploadOutlined,{}),loading:ed,children:"Upload YAML file"})})]})}),(0,i.jsx)(F,{keywords:r,onActionChange:j,onRemove:c})]}),(!C||"competitor_intent"===C||"categories"===C)&&M&&(0,i.jsx)(H,{enabled:B,config:E,onChange:M,accessToken:b}),(!C||"categories"===C)&&S.length>0&&A&&I&&O&&(0,i.jsx)(D,{availableCategories:S,selectedCategories:k,onCategoryAdd:A,onCategoryRemove:I,onCategoryUpdate:O,accessToken:b,pendingSelection:T,onPendingSelectionChange:L}),(0,i.jsx)(v,{visible:z,prebuiltPatterns:e,categories:t,selectedPatternName:J,patternAction:W,onPatternNameChange:U,onActionChange:e=>Z(e),onAdd:()=>{if(!J)return void p.default.error("Please select a pattern");let t=e.find(e=>e.name===J);l({id:`pattern-${Date.now()}`,type:"prebuilt",name:J,display_name:t?.display_name,action:W}),$(!1),U(""),Z("BLOCK")},onCancel:()=>{$(!1),U(""),Z("BLOCK")}}),(0,i.jsx)(w,{visible:K,patternName:Q,patternRegex:ee,patternAction:ea,onNameChange:X,onRegexChange:et,onActionChange:e=>ei(e),onAdd:()=>{Q&&ee?(l({id:`custom-${Date.now()}`,type:"custom",name:Q,pattern:ee,action:ea}),q(!1),X(""),et(""),ei("BLOCK")):p.default.error("Please provide pattern name and regex")},onCancel:()=>{q(!1),X(""),et(""),ei("BLOCK")}}),(0,i.jsx)(N,{visible:R,keyword:er,action:en,description:eo,onKeywordChange:el,onActionChange:e=>es(e),onDescriptionChange:ec,onAdd:()=>{er?(o({id:`word-${Date.now()}`,keyword:er,action:en,description:eo||void 0}),G(!1),el(""),ec(""),es("BLOCK")):p.default.error("Please enter a keyword")},onCancel:()=>{G(!1),el(""),ec(""),es("BLOCK")}})]})};var Q=((t={}).PresidioPII="Presidio PII",t.Bedrock="Bedrock Guardrail",t.Lakera="Lakera",t);let X={},ee=e=>{let t={};return t.PresidioPII="Presidio PII",t.Bedrock="Bedrock Guardrail",t.Lakera="Lakera",Object.entries(e).forEach(([e,a])=>{a&&"object"==typeof a&&"ui_friendly_name"in a&&(t[e.split("_").map((e,t)=>e.charAt(0).toUpperCase()+e.slice(1)).join("")]=a.ui_friendly_name)}),X=t,t},et=()=>Object.keys(X).length>0?X:Q,ea={PresidioPII:"presidio",Bedrock:"bedrock",Lakera:"lakera_v2",LitellmContentFilter:"litellm_content_filter",ToolPermission:"tool_permission",BlockCodeExecution:"block_code_execution"},ei=e=>{Object.entries(e).forEach(([e,t])=>{t&&"object"==typeof t&&"ui_friendly_name"in t&&(ea[e.split("_").map((e,t)=>e.charAt(0).toUpperCase()+e.slice(1)).join("")]=e)})},er=e=>!!e&&"Presidio PII"===et()[e],el=e=>!!e&&"LiteLLM Content Filter"===et()[e],en="../ui/assets/logos/",es={"Zscaler AI Guard":`${en}zscaler.svg`,"Presidio PII":`${en}microsoft_azure.svg`,"Bedrock Guardrail":`${en}bedrock.svg`,Lakera:`${en}lakeraai.jpeg`,"Azure Content Safety Prompt Shield":`${en}microsoft_azure.svg`,"Azure Content Safety Text Moderation":`${en}microsoft_azure.svg`,"Aporia AI":`${en}aporia.png`,"PANW Prisma AIRS":`${en}palo_alto_networks.jpeg`,"Noma Security":`${en}noma_security.png`,"Javelin Guardrails":`${en}javelin.png`,"Pillar Guardrail":`${en}pillar.jpeg`,"Google Cloud Model Armor":`${en}google.svg`,"Guardrails AI":`${en}guardrails_ai.jpeg`,"Lasso Guardrail":`${en}lasso.png`,"Pangea Guardrail":`${en}pangea.png`,"AIM Guardrail":`${en}aim_security.jpeg`,"OpenAI Moderation":`${en}openai_small.svg`,EnkryptAI:`${en}enkrypt_ai.avif`,"Prompt Security":`${en}prompt_security.png`,"LiteLLM Content Filter":`${en}litellm_logo.jpg`},eo=e=>{if(!e)return{logo:"",displayName:"-"};let t=Object.keys(ea).find(t=>ea[t].toLowerCase()===e.toLowerCase());if(!t)return{logo:"",displayName:e};let a=et()[t];return{logo:es[a]||"",displayName:a||e}};e.s(["getGuardrailLogoAndName",0,eo,"getGuardrailProviders",0,et,"guardrailLogoMap",0,es,"guardrail_provider_map",0,ea,"populateGuardrailProviderMap",0,ei,"populateGuardrailProviders",0,ee,"shouldRenderContentFilterConfigSettings",0,el,"shouldRenderPIIConfigSettings",0,er],180766);var ec=e.i(435451);let{Title:ed}=c.Typography,eu=({field:e,fieldKey:t,fullFieldKey:a,value:n})=>{let[o,c]=u.default.useState([]),[p,m]=u.default.useState(e.dict_key_options||[]);return u.default.useEffect(()=>{if(n&&"object"==typeof n){let t=Object.keys(n);c(t.map(e=>({key:e,id:`${e}_${Date.now()}_${Math.random()}`}))),m((e.dict_key_options||[]).filter(e=>!t.includes(e)))}},[n,e.dict_key_options]),(0,i.jsxs)("div",{className:"space-y-3",children:[o.map(t=>(0,i.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[(0,i.jsx)("div",{className:"w-24 font-medium text-sm",children:t.key}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(r.Form.Item,{name:Array.isArray(a)?[...a,t.key]:[a,t.key],style:{marginBottom:0},initialValue:n&&"object"==typeof n?n[t.key]:void 0,normalize:"number"===e.dict_value_type?e=>{if(null==e||""===e)return;let t=Number(e);return isNaN(t)?e:t}:void 0,children:"number"===e.dict_value_type?(0,i.jsx)(ec.default,{step:1,width:200,placeholder:`Enter ${t.key} value`}):"boolean"===e.dict_value_type?(0,i.jsxs)(s.Select,{placeholder:`Select ${t.key} value`,children:[(0,i.jsx)(s.Select.Option,{value:!0,children:"True"}),(0,i.jsx)(s.Select.Option,{value:!1,children:"False"})]}):(0,i.jsx)(l.Input,{placeholder:`Enter ${t.key} value`})})}),(0,i.jsx)(d.Button,{type:"text",danger:!0,size:"small",onClick:()=>{var e,a;return e=t.id,a=t.key,void(c(o.filter(t=>t.id!==e)),m([...p,a].sort()))},children:"Remove"})]},t.id)),p.length>0&&(0,i.jsxs)("div",{className:"flex items-center space-x-3 mt-2",children:[(0,i.jsx)(s.Select,{placeholder:"Select category to configure",style:{width:200},onSelect:e=>e&&void(!e||(c([...o,{key:e,id:`${e}_${Date.now()}`}]),m(p.filter(t=>t!==e)))),value:void 0,children:p.map(e=>(0,i.jsx)(s.Select.Option,{value:e,children:e},e))}),(0,i.jsx)("span",{className:"text-sm text-gray-500",children:"Select a category to add threshold configuration"})]})]})},ep=({optionalParams:e,parentFieldKey:t,values:a})=>e.fields&&0!==Object.keys(e.fields).length?(0,i.jsxs)("div",{className:"guardrail-optional-params",children:[(0,i.jsxs)("div",{className:"mb-8 pb-4 border-b border-gray-100",children:[(0,i.jsx)(ed,{level:3,className:"mb-2 font-semibold text-gray-900",children:"Optional Parameters"}),(0,i.jsx)("p",{className:"text-gray-600 text-sm",children:e.description||"Configure additional settings for this guardrail provider"})]}),(0,i.jsx)("div",{className:"space-y-8",children:Object.entries(e.fields).map(([e,n])=>{let o,c;return o=`${t}.${e}`,(console.log("value",c=a?.[e]),"dict"===n.type&&n.dict_key_options)?(0,i.jsxs)("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[(0,i.jsx)("div",{className:"mb-4 font-medium text-gray-900 text-base",children:e}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:n.description}),(0,i.jsx)(eu,{field:n,fieldKey:e,fullFieldKey:[t,e],value:c})]},o):(0,i.jsx)("div",{className:"mb-8 p-6 bg-white rounded-lg border border-gray-200 shadow-sm",children:(0,i.jsx)(r.Form.Item,{name:[t,e],label:(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("div",{className:"font-medium text-gray-900 text-base",children:e}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:n.description})]}),rules:n.required?[{required:!0,message:`${e} is required`}]:void 0,className:"mb-0",initialValue:void 0!==c?c:n.default_value,normalize:"number"===n.type?e=>{if(null==e||""===e)return;let t=Number(e);return isNaN(t)?e:t}:void 0,children:"select"===n.type&&n.options?(0,i.jsx)(s.Select,{placeholder:n.description,children:n.options.map(e=>(0,i.jsx)(s.Select.Option,{value:e,children:e},e))}):"multiselect"===n.type&&n.options?(0,i.jsx)(s.Select,{mode:"multiple",placeholder:n.description,children:n.options.map(e=>(0,i.jsx)(s.Select.Option,{value:e,children:e},e))}):"bool"===n.type||"boolean"===n.type?(0,i.jsxs)(s.Select,{placeholder:n.description,children:[(0,i.jsx)(s.Select.Option,{value:"true",children:"True"}),(0,i.jsx)(s.Select.Option,{value:"false",children:"False"})]}):"number"===n.type?(0,i.jsx)(ec.default,{step:1,width:400,placeholder:n.description}):e.includes("password")||e.includes("secret")||e.includes("key")?(0,i.jsx)(l.Input.Password,{placeholder:n.description}):(0,i.jsx)(l.Input,{placeholder:n.description})})},o)})})]}):null;var em=e.i(482725),eg=e.i(850627);let eh=({selectedProvider:e,accessToken:t,providerParams:a=null,value:n=null})=>{let[o,c]=(0,u.useState)(!1),[d,p]=(0,u.useState)(a),[g,h]=(0,u.useState)(null);if((0,u.useEffect)(()=>{if(a)return void p(a);let e=async()=>{if(t){c(!0),h(null);try{let e=await (0,m.getGuardrailProviderSpecificParams)(t);console.log("Provider params API response:",e),p(e),ee(e),ei(e)}catch(e){console.error("Error fetching provider params:",e),h("Failed to load provider parameters")}finally{c(!1)}}};a||e()},[t,a]),!e)return null;if(o)return(0,i.jsx)(em.Spin,{tip:"Loading provider parameters..."});if(g)return(0,i.jsx)("div",{className:"text-red-500",children:g});let x=ea[e]?.toLowerCase(),f=d&&d[x];if(console.log("Provider key:",x),console.log("Provider fields:",f),!f||0===Object.keys(f).length)return(0,i.jsx)("div",{children:"No configuration fields available for this provider."});console.log("Value:",n);let y=new Set(["patterns","blocked_words","blocked_words_file","categories","severity_threshold","pattern_redaction_format","keyword_redaction_tag"]),j=el(e),_=(e,t="",a)=>Object.entries(e).map(([e,o])=>{let c=t?`${t}.${e}`:e,d=a?a[e]:n?.[e];if(console.log("Field value:",d),"ui_friendly_name"===e||"optional_params"===e&&"nested"===o.type&&o.fields||j&&y.has(e))return null;if("nested"===o.type&&o.fields)return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"mb-2 font-medium",children:e}),(0,i.jsx)("div",{className:"ml-4 border-l-2 border-gray-200 pl-4",children:_(o.fields,c,d)})]},c);let u="percentage"===o.type&&null==d?o.default_value??.5:void 0;return(0,i.jsx)(r.Form.Item,{name:c,label:e,tooltip:o.description,rules:o.required?[{required:!0,message:`${e} is required`}]:void 0,initialValue:u,children:"select"===o.type&&o.options?(0,i.jsx)(s.Select,{placeholder:o.description,defaultValue:d||o.default_value,children:o.options.map(e=>(0,i.jsx)(s.Select.Option,{value:e,children:e},e))}):"multiselect"===o.type&&o.options?(0,i.jsx)(s.Select,{mode:"multiple",placeholder:o.description,defaultValue:d||o.default_value,children:o.options.map(e=>(0,i.jsx)(s.Select.Option,{value:e,children:e},e))}):"bool"===o.type||"boolean"===o.type?(0,i.jsxs)(s.Select,{placeholder:o.description,defaultValue:void 0!==d?String(d):o.default_value,children:[(0,i.jsx)(s.Select.Option,{value:"true",children:"True"}),(0,i.jsx)(s.Select.Option,{value:"false",children:"False"})]}):"percentage"===o.type&&null!=o.min&&null!=o.max?(0,i.jsx)(eg.Slider,{min:o.min,max:o.max,step:o.step??.1,marks:{[o.min]:"0%",[(o.min+o.max)/2]:"50%",[o.max]:"100%"}}):"number"===o.type?(0,i.jsx)(ec.default,{step:1,width:400,placeholder:o.description,defaultValue:void 0!==d?Number(d):void 0}):e.includes("password")||e.includes("secret")||e.includes("key")?(0,i.jsx)(l.Input.Password,{placeholder:o.description,defaultValue:d||""}):(0,i.jsx)(l.Input,{placeholder:o.description,defaultValue:d||""})},c)});return(0,i.jsx)(i.Fragment,{children:_(f)})};var ex=e.i(536916),ef=e.i(592968),ey=e.i(149192),ej=e.i(741585),ej=ej,e_=e.i(724154);e.i(247167);var ev=e.i(931067);let eb={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"};var eC=e.i(9583),ew=u.forwardRef(function(e,t){return u.createElement(eC.default,(0,ev.default)({},e,{ref:t,icon:eb}))});let{Text:eS}=c.Typography,{Option:ek}=s.Select,eN=({categories:e,selectedCategories:t,onChange:a})=>(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[(0,i.jsx)(ew,{className:"text-gray-500 mr-1"}),(0,i.jsx)(eS,{className:"text-gray-500 font-medium",children:"Filter by category"})]}),(0,i.jsx)(s.Select,{mode:"multiple",placeholder:"Select categories to filter by",style:{width:"100%"},onChange:a,value:t,allowClear:!0,showSearch:!0,optionFilterProp:"children",className:"mb-4",tagRender:e=>(0,i.jsx)(o.Tag,{color:"blue",closable:e.closable,onClose:e.onClose,className:"mr-2 mb-2",children:e.label}),children:e.map(e=>(0,i.jsx)(ek,{value:e.category,children:e.category},e.category))})]}),eA=({onSelectAll:e,onUnselectAll:t,hasSelectedEntities:a})=>(0,i.jsxs)("div",{className:"bg-gray-50 p-5 rounded-lg mb-6 border border-gray-200 shadow-sm",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(eS,{strong:!0,className:"text-gray-700 text-base",children:"Quick Actions"}),(0,i.jsx)(ef.Tooltip,{title:"Apply action to all PII types at once",children:(0,i.jsx)("div",{className:"ml-2 text-gray-400 cursor-help text-xs",children:"ⓘ"})})]}),(0,i.jsx)(d.Button,{color:"danger",variant:"outlined",onClick:t,disabled:!a,icon:(0,i.jsx)(ey.CloseOutlined,{}),children:"Unselect All"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsx)(d.Button,{color:"primary",variant:"outlined",onClick:()=>e("MASK"),className:"h-10",block:!0,icon:(0,i.jsx)(ej.default,{}),children:"Select All & Mask"}),(0,i.jsx)(d.Button,{color:"danger",variant:"outlined",onClick:()=>e("BLOCK"),className:"h-10 hover:bg-red-100",block:!0,icon:(0,i.jsx)(e_.StopOutlined,{}),children:"Select All & Block"})]})]}),eI=({entities:e,selectedEntities:t,selectedActions:a,actions:r,onEntitySelect:l,onActionSelect:n,entityToCategoryMap:c})=>(0,i.jsxs)("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[(0,i.jsxs)("div",{className:"bg-gray-50 px-5 py-3 border-b flex",children:[(0,i.jsx)(eS,{strong:!0,className:"flex-1 text-gray-700",children:"PII Type"}),(0,i.jsx)(eS,{strong:!0,className:"w-32 text-right text-gray-700",children:"Action"})]}),(0,i.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:0===e.length?(0,i.jsx)("div",{className:"py-10 text-center text-gray-500",children:"No PII types match your filter criteria"}):e.map(e=>(0,i.jsxs)("div",{className:`px-5 py-3 flex items-center justify-between hover:bg-gray-50 border-b ${t.includes(e)?"bg-blue-50":""}`,children:[(0,i.jsxs)("div",{className:"flex items-center flex-1",children:[(0,i.jsx)(ex.Checkbox,{checked:t.includes(e),onChange:()=>l(e),className:"mr-3"}),(0,i.jsx)(eS,{className:t.includes(e)?"font-medium text-gray-900":"text-gray-700",children:e.replace(/_/g," ")}),c.get(e)&&(0,i.jsx)(o.Tag,{className:"ml-2 text-xs",color:"blue",children:c.get(e)})]}),(0,i.jsx)("div",{className:"w-32",children:(0,i.jsx)(s.Select,{value:t.includes(e)&&a[e]||"MASK",onChange:t=>n(e,t),style:{width:120},disabled:!t.includes(e),className:`${!t.includes(e)?"opacity-50":""}`,dropdownMatchSelectWidth:!1,children:r.map(e=>(0,i.jsx)(ek,{value:e,children:(0,i.jsxs)("div",{className:"flex items-center",children:[(e=>{switch(e){case"MASK":return(0,i.jsx)(ej.default,{style:{marginRight:4}});case"BLOCK":return(0,i.jsx)(e_.StopOutlined,{style:{marginRight:4}});default:return null}})(e),e]})},e))})})]},e))})]}),{Title:eO,Text:eT}=c.Typography,eP=({entities:e,actions:t,selectedEntities:a,selectedActions:r,onEntitySelect:l,onActionSelect:n,entityCategories:s=[]})=>{let[o,c]=(0,u.useState)([]),d=new Map;s.forEach(e=>{e.entities.forEach(t=>{d.set(t,e.category)})});let p=e.filter(e=>0===o.length||o.includes(d.get(e)||""));return(0,i.jsxs)("div",{className:"pii-configuration",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,i.jsx)("div",{className:"flex items-center",children:(0,i.jsx)(eO,{level:4,className:"!m-0 font-semibold text-gray-800",children:"Configure PII Protection"})}),(0,i.jsxs)(eT,{className:"text-gray-500",children:[a.length," items selected"]})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)(eN,{categories:s,selectedCategories:o,onChange:c}),(0,i.jsx)(eA,{onSelectAll:t=>{e.forEach(e=>{a.includes(e)||l(e),n(e,t)})},onUnselectAll:()=>{a.forEach(e=>{l(e)})},hasSelectedEntities:a.length>0})]}),(0,i.jsx)(eI,{entities:p,selectedEntities:a,selectedActions:r,actions:t,onEntitySelect:l,onActionSelect:n,entityToCategoryMap:d})]})};var eL=e.i(304967),eB=e.i(599724),eF=e.i(312361),eE=e.i(21548),eM=e.i(827252);let ez={rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""},e$=({value:e,onChange:t,disabled:a=!1})=>{let r={...ez,...e||{},rules:e?.rules?[...e.rules]:[]},n=e=>{let a={...r,...e};t?.(a)},o=(e,t)=>{n({rules:r.rules.map((a,i)=>i===e?{...a,...t}:a)})},c=(e,t)=>{let a=r.rules[e];if(!a)return;let i=Object.entries(a.allowed_param_patterns||{});t(i);let l={};i.forEach(([e,t])=>{l[e]=t}),o(e,{allowed_param_patterns:Object.keys(l).length>0?l:void 0})};return(0,i.jsxs)(eL.Card,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"text-lg font-semibold",children:"LiteLLM Tool Permission Guardrail"}),(0,i.jsx)(eB.Text,{className:"text-sm text-gray-500",children:"Provide regex patterns (e.g., ^mcp__github_.*$) for tool names or types and optionally constrain payload fields."})]}),!a&&(0,i.jsx)(d.Button,{icon:(0,i.jsx)(f.PlusOutlined,{}),type:"primary",onClick:()=>{n({rules:[...r.rules,{id:`rule_${Math.random().toString(36).slice(2,8)}`,decision:"allow",allowed_param_patterns:void 0}]})},className:"!bg-blue-600 !text-white hover:!bg-blue-500",children:"Add Rule"})]}),(0,i.jsx)(eF.Divider,{}),0===r.rules.length?(0,i.jsx)(eE.Empty,{description:"No tool rules added yet"}):(0,i.jsx)("div",{className:"space-y-4",children:r.rules.map((e,t)=>{let u;return(0,i.jsxs)(eL.Card,{className:"bg-gray-50",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,i.jsxs)(eB.Text,{className:"font-semibold",children:["Rule ",t+1]}),(0,i.jsx)(d.Button,{icon:(0,i.jsx)(I.DeleteOutlined,{}),danger:!0,type:"text",disabled:a,onClick:()=>{n({rules:r.rules.filter((e,a)=>a!==t)})},children:"Remove"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"text-sm font-medium",children:"Rule ID"}),(0,i.jsx)(l.Input,{disabled:a,placeholder:"unique_rule_id",value:e.id,onChange:e=>o(t,{id:e.target.value})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"text-sm font-medium",children:"Tool Name (optional)"}),(0,i.jsx)(l.Input,{disabled:a,placeholder:"^mcp__github_.*$",value:e.tool_name??"",onChange:e=>o(t,{tool_name:""===e.target.value.trim()?void 0:e.target.value})})]})]}),(0,i.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 mt-4",children:(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"text-sm font-medium",children:"Tool Type (optional)"}),(0,i.jsx)(l.Input,{disabled:a,placeholder:"^function$",value:e.tool_type??"",onChange:e=>o(t,{tool_type:""===e.target.value.trim()?void 0:e.target.value})})]})}),(0,i.jsxs)("div",{className:"mt-4 flex flex-col gap-2",children:[(0,i.jsx)(eB.Text,{className:"text-sm font-medium",children:"Decision"}),(0,i.jsxs)(s.Select,{disabled:a,value:e.decision,style:{width:200},onChange:e=>o(t,{decision:e}),children:[(0,i.jsx)(s.Select.Option,{value:"allow",children:"Allow"}),(0,i.jsx)(s.Select.Option,{value:"deny",children:"Deny"})]})]}),(0,i.jsx)("div",{className:"mt-4",children:0===(u=Object.entries(e.allowed_param_patterns||{})).length?(0,i.jsx)(d.Button,{disabled:a,size:"small",onClick:()=>o(t,{allowed_param_patterns:{"":""}}),children:"+ Restrict tool arguments (optional)"}):(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(eB.Text,{className:"text-sm text-gray-600",children:"Argument constraints (dot or array paths)"}),u.map(([r,n],s)=>(0,i.jsxs)(g.Space,{align:"start",children:[(0,i.jsx)(l.Input,{disabled:a,placeholder:"messages[0].content",value:r,onChange:e=>{var a;return a=e.target.value,void c(t,e=>{if(!e[s])return;let[,t]=e[s];e[s]=[a,t]})}}),(0,i.jsx)(l.Input,{disabled:a,placeholder:"^email@.*$",value:n,onChange:e=>{var a;return a=e.target.value,void c(t,e=>{if(!e[s])return;let[t]=e[s];e[s]=[t,a]})}}),(0,i.jsx)(d.Button,{disabled:a,icon:(0,i.jsx)(I.DeleteOutlined,{}),danger:!0,onClick:()=>c(t,e=>{e.splice(s,1)})})]},`${e.id||t}-${s}`)),(0,i.jsx)(d.Button,{disabled:a,size:"small",onClick:()=>o(t,{allowed_param_patterns:{...e.allowed_param_patterns||{},"":""}}),children:"+ Add another constraint"})]})})]},e.id||t)})}),(0,i.jsx)(eF.Divider,{}),(0,i.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"text-sm font-medium",children:"Default action"}),(0,i.jsxs)(s.Select,{disabled:a,value:r.default_action,onChange:e=>n({default_action:e}),children:[(0,i.jsx)(s.Select.Option,{value:"allow",children:"Allow"}),(0,i.jsx)(s.Select.Option,{value:"deny",children:"Deny"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(eB.Text,{className:"text-sm font-medium flex items-center gap-1",children:["On disallowed action",(0,i.jsx)(ef.Tooltip,{title:"Block returns an error when a forbidden tool is invoked. Rewrite strips the tool call but lets the rest of the response continue.",children:(0,i.jsx)(eM.InfoCircleOutlined,{})})]}),(0,i.jsxs)(s.Select,{disabled:a,value:r.on_disallowed_action,onChange:e=>n({on_disallowed_action:e}),children:[(0,i.jsx)(s.Select.Option,{value:"block",children:"Block"}),(0,i.jsx)(s.Select.Option,{value:"rewrite",children:"Rewrite"})]})]})]}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)(eB.Text,{className:"text-sm font-medium",children:"Violation message (optional)"}),(0,i.jsx)(l.Input.TextArea,{disabled:a,rows:3,placeholder:"This violates our org policy...",value:r.violation_message_template,onChange:e=>n({violation_message_template:e.target.value})})]})]})},{Title:eR,Text:eD,Link:eG}=c.Typography,{Option:eK}=s.Select,eq={pre_call:"Before LLM Call - Runs before the LLM call and checks the input (Recommended)",during_call:"During LLM Call - Runs in parallel with the LLM call, with response held until check completes",post_call:"After LLM Call - Runs after the LLM call and checks only the output",logging_only:"Logging Only - Only runs on logging callbacks without affecting the LLM call",pre_mcp_call:"Before MCP Tool Call - Runs before MCP tool execution and validates tool calls",during_mcp_call:"During MCP Tool Call - Runs in parallel with MCP tool execution for monitoring"};e.s(["default",0,({visible:e,onClose:t,accessToken:a,onSuccess:c,preset:g})=>{let[h]=r.Form.useForm(),[x,f]=(0,u.useState)(!1),[y,j]=(0,u.useState)(null),[_,v]=(0,u.useState)(null),[b,C]=(0,u.useState)([]),[w,S]=(0,u.useState)({}),[k,N]=(0,u.useState)(0),[A,I]=(0,u.useState)(null),[O,T]=(0,u.useState)([]),[P,L]=(0,u.useState)(2),[B,F]=(0,u.useState)({}),[E,M]=(0,u.useState)([]),[z,$]=(0,u.useState)([]),[R,D]=(0,u.useState)([]),[G,K]=(0,u.useState)(""),[q,J]=(0,u.useState)(!1),[U,W]=(0,u.useState)(null),[H,V]=(0,u.useState)(""),[Y,Q]=(0,u.useState)(void 0),[X,en]=(0,u.useState)("warn"),[eo,ec]=(0,u.useState)(""),[ed,eu]=(0,u.useState)(!1),[em,eg]=(0,u.useState)({rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""}),ex=(0,u.useMemo)(()=>!!y&&"tool_permission"===(ea[y]||"").toLowerCase(),[y]);(0,u.useEffect)(()=>{a&&(async()=>{try{let[e,t]=await Promise.all([(0,m.getGuardrailUISettings)(a),(0,m.getGuardrailProviderSpecificParams)(a)]);v(e),I(t),ee(t),ei(t)}catch(e){console.error("Error fetching guardrail data:",e),p.default.fromBackend("Failed to load guardrail configuration")}})()},[a]),(0,u.useEffect)(()=>{if(!g||!e||!_)return;j(g.provider);let t={provider:g.provider,guardrail_name:g.guardrailNameSuggestion,mode:g.mode,default_on:g.defaultOn};if("BlockCodeExecution"===g.provider&&(t.confidence_threshold=.5),h.setFieldsValue(t),g.categoryName&&_.content_filter_settings?.content_categories){let e=_.content_filter_settings.content_categories.find(e=>e.name===g.categoryName);e&&D([{id:`category-${Date.now()}`,category:e.name,display_name:e.display_name,action:e.default_action,severity_threshold:"medium"}])}},[g,e,_]);let ef=e=>{j(e);let t={config:void 0,presidio_analyzer_api_base:void 0,presidio_anonymizer_api_base:void 0};"BlockCodeExecution"===e&&(t.confidence_threshold=.5),h.setFieldsValue(t),C([]),S({}),T([]),L(2),F({}),M([]),$([]),D([]),K(""),J(!1),W(null),eg({rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""})},ey=e=>{C(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},ej=(e,t)=>{S(a=>({...a,[e]:t}))},e_=async()=>{try{if(0===k&&(await h.validateFields(["guardrail_name","provider","mode","default_on"]),y)){let e=["guardrail_name","provider","mode","default_on"];"PresidioPII"===y&&e.push("presidio_analyzer_api_base","presidio_anonymizer_api_base"),await h.validateFields(e)}if(1===k&&er(y)&&0===b.length)return void p.default.fromBackend("Please select at least one PII entity to continue");N(k+1)}catch(e){console.error("Form validation failed:",e)}},ev=()=>{h.resetFields(),j(null),C([]),S({}),T([]),L(2),F({}),M([]),$([]),D([]),K(""),eg({rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""}),V(""),Q(void 0),en("warn"),ec(""),eu(!1),N(0)},eb=()=>{ev(),t()},eC=async()=>{try{f(!0),await h.validateFields();let e=h.getFieldsValue(!0),i=ea[e.provider],r={guardrail_name:e.guardrail_name,litellm_params:{guardrail:i,mode:e.mode,default_on:e.default_on},guardrail_info:{}};if("PresidioPII"===e.provider&&b.length>0){let t={};b.forEach(e=>{t[e]=w[e]||"MASK"}),r.litellm_params.pii_entities_config=t,e.presidio_analyzer_api_base&&(r.litellm_params.presidio_analyzer_api_base=e.presidio_analyzer_api_base),e.presidio_anonymizer_api_base&&(r.litellm_params.presidio_anonymizer_api_base=e.presidio_anonymizer_api_base)}if(el(e.provider)){let e=q&&U?.brand_self?.length>0;if(0===E.length&&0===z.length&&0===R.length&&!e){p.default.fromBackend("Please configure at least one content filter setting (category, pattern, keyword, or competitor intent)"),f(!1);return}E.length>0&&(r.litellm_params.patterns=E.map(e=>({pattern_type:"prebuilt"===e.type?"prebuilt":"regex",pattern_name:"prebuilt"===e.type?e.name:void 0,pattern:"custom"===e.type?e.pattern:void 0,name:e.name,action:e.action}))),z.length>0&&(r.litellm_params.blocked_words=z.map(e=>({keyword:e.keyword,action:e.action,description:e.description}))),R.length>0&&(r.litellm_params.categories=R.map(e=>({category:e.category,enabled:!0,action:e.action,severity_threshold:e.severity_threshold||"medium"}))),q&&U?.brand_self?.length>0&&(r.litellm_params.competitor_intent_config={competitor_intent_type:U.competitor_intent_type??"airline",brand_self:U.brand_self,locations:U.locations?.length>0?U.locations:void 0,competitors:"generic"===U.competitor_intent_type&&U.competitors?.length>0?U.competitors:void 0,policy:U.policy,threshold_high:U.threshold_high,threshold_medium:U.threshold_medium,threshold_low:U.threshold_low})}else if(e.config)try{r.guardrail_info=JSON.parse(e.config)}catch(e){p.default.fromBackend("Invalid JSON in configuration"),f(!1);return}if("tool_permission"===i){if(0===em.rules.length){p.default.fromBackend("Add at least one tool permission rule"),f(!1);return}r.litellm_params.rules=em.rules,r.litellm_params.default_action=em.default_action,r.litellm_params.on_disallowed_action=em.on_disallowed_action,em.violation_message_template&&(r.litellm_params.violation_message_template=em.violation_message_template)}if(el(e.provider)&&(void 0!==Y&&Y>0&&(r.litellm_params.end_session_after_n_fails=Y),X&&"realtime"===H&&(r.litellm_params.on_violation=X),eo.trim()&&(r.litellm_params.realtime_violation_message=eo.trim())),console.log("values: ",JSON.stringify(e)),A&&y){let t=ea[y]?.toLowerCase();console.log("providerKey: ",t);let a=A[t]||{},i=new Set;console.log("providerSpecificParams: ",JSON.stringify(a)),Object.keys(a).forEach(e=>{"optional_params"!==e&&i.add(e)}),a.optional_params&&a.optional_params.fields&&Object.keys(a.optional_params.fields).forEach(e=>{i.add(e)}),console.log("allowedParams: ",i),i.forEach(t=>{let a=e[t];(null==a||""===a)&&(a=e.optional_params?.[t]),null!=a&&""!==a&&(r.litellm_params[t]=a)})}if(!a)throw Error("No access token available");console.log("Sending guardrail data:",JSON.stringify(r)),await (0,m.createGuardrailCall)(a,r),p.default.success("Guardrail created successfully"),ev(),c(),t()}catch(e){console.error("Failed to create guardrail:",e),p.default.fromBackend("Failed to create guardrail: "+(e instanceof Error?e.message:String(e)))}finally{f(!1)}},ew=e=>{if(!_||!el(y))return null;let t=_.content_filter_settings;return t?(0,i.jsx)(Z,{prebuiltPatterns:t.prebuilt_patterns||[],categories:t.pattern_categories||[],selectedPatterns:E,blockedWords:z,onPatternAdd:e=>M([...E,e]),onPatternRemove:e=>M(E.filter(t=>t.id!==e)),onPatternActionChange:(e,t)=>{M(E.map(a=>a.id===e?{...a,action:t}:a))},onBlockedWordAdd:e=>$([...z,e]),onBlockedWordRemove:e=>$(z.filter(t=>t.id!==e)),onBlockedWordUpdate:(e,t,a)=>{$(z.map(i=>i.id===e?{...i,[t]:a}:i))},contentCategories:t.content_categories||[],selectedContentCategories:R,onContentCategoryAdd:e=>D([...R,e]),onContentCategoryRemove:e=>D(R.filter(t=>t.id!==e)),onContentCategoryUpdate:(e,t,a)=>{D(R.map(i=>i.id===e?{...i,[t]:a}:i))},pendingCategorySelection:G,onPendingCategorySelectionChange:K,accessToken:a,showStep:e,competitorIntentEnabled:q,competitorIntentConfig:U,onCompetitorIntentChange:(e,t)=>{J(e),W(t)}}):null},eS=el(y)?[{title:"Basic Info",optional:!1},{title:"Topics",optional:!1},{title:"Patterns",optional:!1},{title:"Keywords",optional:!1},{title:"Endpoint Settings (Optional)",optional:!0}]:er(y)?[{title:"Basic Info",optional:!1},{title:"PII Configuration",optional:!1}]:[{title:"Basic Info",optional:!1},{title:"Provider Configuration",optional:!1}];return(0,i.jsx)(n.Modal,{title:null,open:e,onCancel:eb,footer:null,width:1e3,closable:!1,className:"top-8",styles:{body:{padding:0}},children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[(0,i.jsx)("h3",{className:"text-base font-semibold text-gray-900 m-0",children:"Create guardrail"}),(0,i.jsx)("button",{onClick:eb,className:"text-gray-400 hover:text-gray-600 bg-transparent border-none cursor-pointer text-base leading-none p-1",children:"✕"})]}),(0,i.jsx)("div",{className:"overflow-auto px-6 py-4",style:{maxHeight:"calc(80vh - 120px)"},children:(0,i.jsx)(r.Form,{form:h,layout:"vertical",initialValues:{mode:"pre_call",default_on:!1},children:eS.map((e,t)=>{let n=t<k,c=t===k,d=t===eS.length-1;return(0,i.jsxs)("div",{className:"relative flex gap-4",style:{paddingBottom:8*!d},children:[(0,i.jsxs)("div",{className:"flex flex-col items-center flex-shrink-0",style:{width:24},children:[(0,i.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium flex-shrink-0",style:{background:n?"#4f46e5":c?"#fff":"#f8fafc",color:n?"#fff":c?"#4f46e5":"#94a3b8",border:c?"2px solid #4f46e5":n?"none":"1px solid #e2e8f0"},children:n?"✓":t+1}),!d&&(0,i.jsx)("div",{className:"flex-1",style:{width:1,background:n?"#4f46e5":"#e2e8f0",minHeight:16}})]}),(0,i.jsxs)("div",{className:"flex-1 min-w-0",style:{paddingBottom:16*!d},children:[(0,i.jsxs)("div",{className:`flex items-center gap-2 ${n?"cursor-pointer":""}`,onClick:()=>{n&&N(t)},style:{minHeight:24},children:[(0,i.jsx)("span",{className:"text-sm",style:{fontWeight:c?600:500,color:c?"#1e293b":n?"#4f46e5":"#94a3b8"},children:e.title}),e.optional&&!c&&(0,i.jsx)("span",{className:"text-[11px] text-slate-400",children:"optional"}),n&&(0,i.jsx)("span",{className:"text-[11px] text-indigo-500 hover:underline",children:"Edit"})]}),c&&(0,i.jsx)("div",{className:"mt-3",children:(()=>{switch(k){case 0:return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.Form.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,i.jsx)(l.Input,{placeholder:"Enter a name for this guardrail"})}),(0,i.jsx)(r.Form.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,i.jsx)(s.Select,{placeholder:"Select a guardrail provider",onChange:ef,labelInValue:!1,optionLabelProp:"label",dropdownRender:e=>e,showSearch:!0,children:Object.entries(et()).map(([e,t])=>(0,i.jsx)(eK,{value:e,label:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[es[t]&&(0,i.jsx)("img",{src:es[t],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,i.jsx)("span",{children:t})]}),children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[es[t]&&(0,i.jsx)("img",{src:es[t],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,i.jsx)("span",{children:t})]})},e))})}),(0,i.jsx)(r.Form.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,i.jsx)(s.Select,{optionLabelProp:"label",mode:"multiple",children:_?.supported_modes?.map(e=>(0,i.jsx)(eK,{value:e,label:e,children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:e}),"pre_call"===e&&(0,i.jsx)(o.Tag,{color:"green",style:{marginLeft:"8px"},children:"Recommended"})]}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eq[e]})]})},e))||(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eK,{value:"pre_call",label:"pre_call",children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"pre_call"})," ",(0,i.jsx)(o.Tag,{color:"green",children:"Recommended"})]}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eq.pre_call})]})}),(0,i.jsx)(eK,{value:"during_call",label:"during_call",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:(0,i.jsx)("strong",{children:"during_call"})}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eq.during_call})]})}),(0,i.jsx)(eK,{value:"post_call",label:"post_call",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:(0,i.jsx)("strong",{children:"post_call"})}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eq.post_call})]})}),(0,i.jsx)(eK,{value:"logging_only",label:"logging_only",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:(0,i.jsx)("strong",{children:"logging_only"})}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eq.logging_only})]})})]})})}),(0,i.jsx)(r.Form.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default.",children:(0,i.jsxs)(s.Select,{children:[(0,i.jsx)(s.Select.Option,{value:!0,children:"Yes"}),(0,i.jsx)(s.Select.Option,{value:!1,children:"No"})]})}),!ex&&!el(y)&&(0,i.jsx)(eh,{selectedProvider:y,accessToken:a,providerParams:A})]});case 1:if(er(y))return _&&"PresidioPII"===y?(0,i.jsx)(eP,{entities:_.supported_entities,actions:_.supported_actions,selectedEntities:b,selectedActions:w,onEntitySelect:ey,onActionSelect:ej,entityCategories:_.pii_entity_categories}):null;if(el(y))return ew("categories");if(!y)return null;if(ex)return(0,i.jsx)(e$,{value:em,onChange:eg});if(!A)return null;console.log("guardrail_provider_map: ",ea),console.log("selectedProvider: ",y);let e=ea[y]?.toLowerCase(),t=A&&A[e];return t&&t.optional_params?(0,i.jsx)(ep,{optionalParams:t.optional_params,parentFieldKey:"optional_params"}):null;case 2:if(el(y))return ew("patterns");return null;case 3:if(el(y))return ew("keywords");return null;case 4:return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{children:(0,i.jsxs)("p",{className:"text-sm text-gray-500",children:["Configure settings for a specific call type. Most guardrails don't need this — skip it unless you're using a specific endpoint like ",(0,i.jsx)("code",{children:"/v1/realtime"}),"."]})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Call type"}),(0,i.jsx)(s.Select,{placeholder:"Select a call type",value:H||void 0,onChange:e=>{V(e),eu(!1)},style:{width:260},allowClear:!0,options:[{value:"realtime",label:"/v1/realtime"}]}),(0,i.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"More call types coming soon."})]}),"realtime"===H&&(0,i.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,i.jsxs)("button",{type:"button",onClick:()=>eu(e=>!e),className:"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100 text-sm font-medium text-gray-700",children:[(0,i.jsx)("span",{children:"/v1/realtime settings"}),(0,i.jsx)("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${ed?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),ed&&(0,i.jsxs)("div",{className:"space-y-5 px-4 py-4 border-t border-gray-200",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End session after X violations"}),(0,i.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:"Automatically close the session after this many guardrail violations. Leave empty to never auto-close."}),(0,i.jsx)("input",{type:"number",min:1,placeholder:"e.g. 3",value:Y??"",onChange:e=>Q(e.target.value?parseInt(e.target.value,10):void 0),className:"border border-gray-300 rounded px-3 py-1.5 text-sm w-32"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"On violation"}),(0,i.jsx)("div",{className:"space-y-2",children:["warn","end_session"].map(e=>(0,i.jsxs)("label",{className:"flex items-start gap-2 cursor-pointer",children:[(0,i.jsx)("input",{type:"radio",name:"on_violation",value:e,checked:X===e,onChange:()=>en(e),className:"mt-0.5"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-sm font-medium text-gray-800",children:"warn"===e?"Warn":"End session"}),(0,i.jsx)("p",{className:"text-xs text-gray-400 m-0",children:"warn"===e?"Bot speaks the message, session continues":"Bot speaks the message, connection closes immediately"})]})]},e))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message the user hears"}),(0,i.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:"What the bot says aloud when this guardrail fires. Falls back to the default violation message if empty."}),(0,i.jsx)("textarea",{rows:3,placeholder:"e.g. I'm not able to continue this conversation. Please contact us at 1-800-774-2678.",value:eo,onChange:e=>ec(e.target.value),className:"border border-gray-300 rounded px-3 py-2 text-sm w-full resize-none"})]})]})]})]});default:return null}})()})]})]},t)})})}),(0,i.jsxs)("div",{className:"flex items-center justify-end space-x-3 px-6 py-3 border-t border-gray-200",children:[(0,i.jsx)(d.Button,{onClick:eb,children:"Cancel"}),k>0&&(0,i.jsx)(d.Button,{onClick:()=>{N(k-1)},children:"Previous"}),k<eS.length-1?(0,i.jsx)(d.Button,{type:"primary",onClick:e_,children:"Next"}):(0,i.jsx)(d.Button,{type:"primary",onClick:eC,loading:x,children:"Create Guardrail"})]})]})})}],185357);var eJ=e.i(269200),eU=e.i(942232),eW=e.i(977572),eH=e.i(427612),eV=e.i(64848),eY=e.i(496020),eZ=e.i(752978),eQ=e.i(994388),eX=e.i(68155),e0=e.i(94629),e1=e.i(360820),e2=e.i(871943),e4=e.i(389083),e6=e.i(152990),e8=e.i(682830),e3=e.i(779241);let{Title:e5,Text:e9}=c.Typography,{Option:e7}=s.Select,te=({visible:e,onClose:t,accessToken:a,onSuccess:o,guardrailId:c,initialValues:d})=>{let[g]=r.Form.useForm(),[h,x]=(0,u.useState)(!1),[f,y]=(0,u.useState)(d?.provider||null),[j,_]=(0,u.useState)(null),[v,b]=(0,u.useState)([]),[C,w]=(0,u.useState)({});(0,u.useEffect)(()=>{(async()=>{try{if(!a)return;let e=await (0,m.getGuardrailUISettings)(a);_(e)}catch(e){console.error("Error fetching guardrail settings:",e),p.default.fromBackend("Failed to load guardrail settings")}})()},[a]),(0,u.useEffect)(()=>{d?.pii_entities_config&&Object.keys(d.pii_entities_config).length>0&&(b(Object.keys(d.pii_entities_config)),w(d.pii_entities_config))},[d]);let S=e=>{b(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},k=(e,t)=>{w(a=>({...a,[e]:t}))},N=async()=>{try{x(!0);let e=await g.validateFields(),i=ea[e.provider],r={guardrail_id:c,guardrail:{guardrail_name:e.guardrail_name,litellm_params:{guardrail:i,mode:e.mode,default_on:e.default_on},guardrail_info:{}}};if("PresidioPII"===e.provider&&v.length>0){let e={};v.forEach(t=>{e[t]=C[t]||"MASK"}),r.guardrail.litellm_params.pii_entities_config=e}else if(e.config)try{let t=JSON.parse(e.config);"Bedrock"===e.provider&&t?(t.guardrail_id&&(r.guardrail.litellm_params.guardrailIdentifier=t.guardrail_id),t.guardrail_version&&(r.guardrail.litellm_params.guardrailVersion=t.guardrail_version)):r.guardrail.guardrail_info=t}catch(e){p.default.fromBackend("Invalid JSON in configuration"),x(!1);return}if(!a)throw Error("No access token available");console.log("Sending guardrail update data:",JSON.stringify(r));let l=`/guardrails/${c}`,n=await fetch(l,{method:"PUT",headers:{[(0,m.getGlobalLitellmHeaderName)()]:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){let e=await n.text();throw Error(e||"Failed to update guardrail")}p.default.success("Guardrail updated successfully"),o(),t()}catch(e){console.error("Failed to update guardrail:",e),p.default.fromBackend("Failed to update guardrail: "+(e instanceof Error?e.message:String(e)))}finally{x(!1)}};return(0,i.jsx)(n.Modal,{title:"Edit Guardrail",open:e,onCancel:t,footer:null,width:700,children:(0,i.jsxs)(r.Form,{form:g,layout:"vertical",initialValues:d,children:[(0,i.jsx)(r.Form.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,i.jsx)(e3.TextInput,{placeholder:"Enter a name for this guardrail"})}),(0,i.jsx)(r.Form.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,i.jsx)(s.Select,{placeholder:"Select a guardrail provider",onChange:e=>{y(e),g.setFieldsValue({config:void 0}),b([]),w({})},disabled:!0,optionLabelProp:"label",children:Object.entries(et()).map(([e,t])=>(0,i.jsx)(e7,{value:e,label:t,children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[es[t]&&(0,i.jsx)("img",{src:es[t],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,i.jsx)("span",{children:t})]})},e))})}),(0,i.jsx)(r.Form.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,i.jsx)(s.Select,{children:j?.supported_modes?.map(e=>(0,i.jsx)(e7,{value:e,children:e},e))||(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e7,{value:"pre_call",children:"pre_call"}),(0,i.jsx)(e7,{value:"post_call",children:"post_call"})]})})}),(0,i.jsx)(r.Form.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default",valuePropName:"checked",children:(0,i.jsx)(G.Switch,{})}),(()=>{if(!f)return null;if("PresidioPII"===f)return j&&f&&"PresidioPII"===f?(0,i.jsx)(eP,{entities:j.supported_entities,actions:j.supported_actions,selectedEntities:v,selectedActions:C,onEntitySelect:S,onActionSelect:k,entityCategories:j.pii_entity_categories}):null;switch(f){case"Aporia":return(0,i.jsx)(r.Form.Item,{label:"Aporia Configuration",name:"config",tooltip:"JSON configuration for Aporia",children:(0,i.jsx)(l.Input.TextArea,{rows:4,placeholder:`{
  "api_key": "your_aporia_api_key",
  "project_name": "your_project_name"
}`})});case"AimSecurity":return(0,i.jsx)(r.Form.Item,{label:"Aim Security Configuration",name:"config",tooltip:"JSON configuration for Aim Security",children:(0,i.jsx)(l.Input.TextArea,{rows:4,placeholder:`{
  "api_key": "your_aim_api_key"
}`})});case"Bedrock":return(0,i.jsx)(r.Form.Item,{label:"Amazon Bedrock Configuration",name:"config",tooltip:"JSON configuration for Amazon Bedrock guardrails",children:(0,i.jsx)(l.Input.TextArea,{rows:4,placeholder:`{
  "guardrail_id": "your_guardrail_id",
  "guardrail_version": "your_guardrail_version"
}`})});case"GuardrailsAI":return(0,i.jsx)(r.Form.Item,{label:"Guardrails.ai Configuration",name:"config",tooltip:"JSON configuration for Guardrails.ai",children:(0,i.jsx)(l.Input.TextArea,{rows:4,placeholder:`{
  "api_key": "your_guardrails_api_key",
  "guardrail_id": "your_guardrail_id"
}`})});case"LakeraAI":return(0,i.jsx)(r.Form.Item,{label:"Lakera AI Configuration",name:"config",tooltip:"JSON configuration for Lakera AI",children:(0,i.jsx)(l.Input.TextArea,{rows:4,placeholder:`{
  "api_key": "your_lakera_api_key"
}`})});case"PromptInjection":return(0,i.jsx)(r.Form.Item,{label:"Prompt Injection Configuration",name:"config",tooltip:"JSON configuration for prompt injection detection",children:(0,i.jsx)(l.Input.TextArea,{rows:4,placeholder:`{
  "threshold": 0.8
}`})});default:return(0,i.jsx)(r.Form.Item,{label:"Custom Configuration",name:"config",tooltip:"JSON configuration for your custom guardrail",children:(0,i.jsx)(l.Input.TextArea,{rows:4,placeholder:`{
  "key1": "value1",
  "key2": "value2"
}`})})}})(),(0,i.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,i.jsx)(eQ.Button,{variant:"secondary",onClick:t,children:"Cancel"}),(0,i.jsx)(eQ.Button,{onClick:N,loading:h,children:"Update Guardrail"})]})]})})};var tt=((a={}).DB="db",a.CONFIG="config",a);e.s(["default",0,({guardrailsList:e,isLoading:t,onDeleteClick:a,accessToken:r,onGuardrailUpdated:l,isAdmin:n=!1,onGuardrailClick:s})=>{let[o,c]=(0,u.useState)([{id:"created_at",desc:!0}]),[d,p]=(0,u.useState)(!1),[m,g]=(0,u.useState)(null),h=e=>e?new Date(e).toLocaleString():"-",x=[{header:"Guardrail ID",accessorKey:"guardrail_id",cell:e=>(0,i.jsx)(ef.Tooltip,{title:String(e.getValue()||""),children:(0,i.jsx)(eQ.Button,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>e.getValue()&&s(e.getValue()),children:e.getValue()?`${String(e.getValue()).slice(0,7)}...`:""})})},{header:"Name",accessorKey:"guardrail_name",cell:({row:e})=>{let t=e.original;return(0,i.jsx)(ef.Tooltip,{title:t.guardrail_name,children:(0,i.jsx)("span",{className:"text-xs font-medium",children:t.guardrail_name||"-"})})}},{header:"Provider",accessorKey:"litellm_params.guardrail",cell:({row:e})=>{let{logo:t,displayName:a}=eo(e.original.litellm_params.guardrail);return(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,i.jsx)("img",{src:t,alt:`${a} logo`,className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,i.jsx)("span",{className:"text-xs",children:a})]})}},{header:"Mode",accessorKey:"litellm_params.mode",cell:({row:e})=>{let t=e.original;return(0,i.jsx)("span",{className:"text-xs",children:t.litellm_params.mode})}},{header:"Default On",accessorKey:"litellm_params.default_on",cell:({row:e})=>{let t=e.original;return(0,i.jsx)(e4.Badge,{color:t.litellm_params?.default_on?"green":"gray",className:"text-xs font-normal",size:"xs",children:t.litellm_params?.default_on?"Default On":"Default Off"})}},{header:"Created At",accessorKey:"created_at",cell:({row:e})=>{let t=e.original;return(0,i.jsx)(ef.Tooltip,{title:t.created_at,children:(0,i.jsx)("span",{className:"text-xs",children:h(t.created_at)})})}},{header:"Updated At",accessorKey:"updated_at",cell:({row:e})=>{let t=e.original;return(0,i.jsx)(ef.Tooltip,{title:t.updated_at,children:(0,i.jsx)("span",{className:"text-xs",children:h(t.updated_at)})})}},{id:"actions",header:"Actions",cell:({row:e})=>{let t=e.original,r=t.guardrail_definition_location===tt.CONFIG;return(0,i.jsx)("div",{className:"flex space-x-2",children:r?(0,i.jsx)(ef.Tooltip,{title:"Config guardrail cannot be deleted on the dashboard. Please delete it from the config file.",children:(0,i.jsx)(eZ.Icon,{"data-testid":"config-delete-icon",icon:eX.TrashIcon,size:"sm",className:"cursor-not-allowed text-gray-400",title:"Config guardrail cannot be deleted on the dashboard. Please delete it from the config file.","aria-label":"Delete guardrail (config)"})}):(0,i.jsx)(ef.Tooltip,{title:"Delete guardrail",children:(0,i.jsx)(eZ.Icon,{icon:eX.TrashIcon,size:"sm",onClick:()=>t.guardrail_id&&a(t.guardrail_id,t.guardrail_name||"Unnamed Guardrail"),className:"cursor-pointer hover:text-red-500"})})})}}],f=(0,e6.useReactTable)({data:e,columns:x,state:{sorting:o},onSortingChange:c,getCoreRowModel:(0,e8.getCoreRowModel)(),getSortedRowModel:(0,e8.getSortedRowModel)(),enableSorting:!0});return(0,i.jsxs)("div",{className:"rounded-lg custom-border relative",children:[(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)(eJ.Table,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,i.jsx)(eH.TableHead,{children:f.getHeaderGroups().map(e=>(0,i.jsx)(eY.TableRow,{children:e.headers.map(e=>(0,i.jsx)(eV.TableHeaderCell,{className:`py-1 h-8 ${"actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""}`,onClick:e.column.getToggleSortingHandler(),children:(0,i.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,i.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,e6.flexRender)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,i.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,i.jsx)(e1.ChevronUpIcon,{className:"h-4 w-4 text-blue-500"}),desc:(0,i.jsx)(e2.ChevronDownIcon,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,i.jsx)(e0.SwitchVerticalIcon,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,i.jsx)(eU.TableBody,{children:t?(0,i.jsx)(eY.TableRow,{children:(0,i.jsx)(eW.TableCell,{colSpan:x.length,className:"h-8 text-center",children:(0,i.jsx)("div",{className:"text-center text-gray-500",children:(0,i.jsx)("p",{children:"Loading..."})})})}):e.length>0?f.getRowModel().rows.map(e=>(0,i.jsx)(eY.TableRow,{className:"h-8",children:e.getVisibleCells().map(e=>(0,i.jsx)(eW.TableCell,{className:`py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ${"actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""}`,children:(0,e6.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,i.jsx)(eY.TableRow,{children:(0,i.jsx)(eW.TableCell,{colSpan:x.length,className:"h-8 text-center",children:(0,i.jsx)("div",{className:"text-center text-gray-500",children:(0,i.jsx)("p",{children:"No guardrails found"})})})})})]})}),m&&(0,i.jsx)(te,{visible:d,onClose:()=>p(!1),accessToken:r,onSuccess:()=>{p(!1),g(null),l()},guardrailId:m.guardrail_id||"",initialValues:{guardrail_name:m.guardrail_name||"",provider:Object.keys(ea).find(e=>ea[e]===m?.litellm_params.guardrail)||"",mode:m.litellm_params.mode,default_on:m.litellm_params.default_on,pii_entities_config:m.litellm_params.pii_entities_config,...m.guardrail_info}})]})}],782719);var ta=e.i(500330),ti=e.i(245094),ej=ej,tr=e.i(530212),tl=e.i(350967),tn=e.i(197647),ts=e.i(653824),to=e.i(881073),tc=e.i(404206),td=e.i(723731),tu=e.i(629569),tp=e.i(678784),tm=e.i(118366),tg=e.i(560445),th=function(e,t){var a,i="";for(a=0;a<t;a+=1)i+=e;return i},tx=function(e){return 0===e&&-1/0==1/e};function tf(e,t){var a="",i=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(a+='in "'+e.mark.name+'" '),a+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(a+="\n\n"+e.mark.snippet),i+" "+a):i}function ty(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=tf(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=Error().stack||""}function tj(e,t,a,i,r){var l="",n="",s=Math.floor(r/2)-1;return i-t>s&&(t=i-s+(l=" ... ").length),a-i>s&&(a=i+s-(n=" ...").length),{str:l+e.slice(t,a).replace(/\t/g,"→")+n,pos:i-t+l.length}}function t_(e,t){return th(" ",t-e.length)+e}ty.prototype=Object.create(Error.prototype),ty.prototype.constructor=ty,ty.prototype.toString=function(e){return this.name+": "+tf(this,e)};var tv=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var a=/\r?\n|\r|\0/g,i=[0],r=[],l=-1;n=a.exec(e.buffer);)r.push(n.index),i.push(n.index+n[0].length),e.position<=n.index&&l<0&&(l=i.length-2);l<0&&(l=i.length-1);var n,s,o,c="",d=Math.min(e.line+t.linesAfter,r.length).toString().length,u=t.maxLength-(t.indent+d+3);for(s=1;s<=t.linesBefore&&!(l-s<0);s++)o=tj(e.buffer,i[l-s],r[l-s],e.position-(i[l]-i[l-s]),u),c=th(" ",t.indent)+t_((e.line-s+1).toString(),d)+" | "+o.str+"\n"+c;for(o=tj(e.buffer,i[l],r[l],e.position,u),c+=th(" ",t.indent)+t_((e.line+1).toString(),d)+" | "+o.str+"\n"+th("-",t.indent+d+3+o.pos)+"^\n",s=1;s<=t.linesAfter&&!(l+s>=r.length);s++)o=tj(e.buffer,i[l+s],r[l+s],e.position-(i[l]-i[l+s]),u),c+=th(" ",t.indent)+t_((e.line+s+1).toString(),d)+" | "+o.str+"\n";return c.replace(/\n$/,"")},tb=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],tC=["scalar","sequence","mapping"],tw=function(e,t){var a,i;if(Object.keys(t=t||{}).forEach(function(t){if(-1===tb.indexOf(t))throw new ty('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=(a=t.styleAliases||null,i={},null!==a&&Object.keys(a).forEach(function(e){a[e].forEach(function(t){i[String(t)]=e})}),i),-1===tC.indexOf(this.kind))throw new ty('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function tS(e,t){var a=[];return e[t].forEach(function(e){var t=a.length;a.forEach(function(a,i){a.tag===e.tag&&a.kind===e.kind&&a.multi===e.multi&&(t=i)}),a[t]=e}),a}function tk(e){return this.extend(e)}tk.prototype.extend=function(e){var t=[],a=[];if(e instanceof tw)a.push(e);else if(Array.isArray(e))a=a.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(a=a.concat(e.explicit));else throw new ty("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(e){if(!(e instanceof tw))throw new ty("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new ty("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new ty("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),a.forEach(function(e){if(!(e instanceof tw))throw new ty("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(tk.prototype);return i.implicit=(this.implicit||[]).concat(t),i.explicit=(this.explicit||[]).concat(a),i.compiledImplicit=tS(i,"implicit"),i.compiledExplicit=tS(i,"explicit"),i.compiledTypeMap=function(){var e,t,a={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(e){e.multi?(a.multi[e.kind].push(e),a.multi.fallback.push(e)):a[e.kind][e.tag]=a.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(i);return a}(i.compiledImplicit,i.compiledExplicit),i};var tN=new tk({explicit:[new tw("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),new tw("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),new tw("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})]}),tA=new tw("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),tI=new tw("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"}),tO=new tw("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,a,i,r,l=e.length,n=0,s=!1;if(!l)return!1;if(("-"===(r=e[n])||"+"===r)&&(r=e[++n]),"0"===r){if(n+1===l)return!0;if("b"===(r=e[++n])){for(n++;n<l;n++)if("_"!==(r=e[n])){if("0"!==r&&"1"!==r)return!1;s=!0}return s&&"_"!==r}if("x"===r){for(n++;n<l;n++)if("_"!==(r=e[n])){if(!(48<=(t=e.charCodeAt(n))&&t<=57||65<=t&&t<=70||97<=t&&t<=102))return!1;s=!0}return s&&"_"!==r}if("o"===r){for(n++;n<l;n++)if("_"!==(r=e[n])){if(!(48<=(a=e.charCodeAt(n))&&a<=55))return!1;s=!0}return s&&"_"!==r}}if("_"===r)return!1;for(;n<l;n++)if("_"!==(r=e[n])){if(!(48<=(i=e.charCodeAt(n))&&i<=57))return!1;s=!0}return!!s&&"_"!==r},construct:function(e){var t,a=e,i=1;if(-1!==a.indexOf("_")&&(a=a.replace(/_/g,"")),("-"===(t=a[0])||"+"===t)&&("-"===t&&(i=-1),t=(a=a.slice(1))[0]),"0"===a)return 0;if("0"===t){if("b"===a[1])return i*parseInt(a.slice(2),2);if("x"===a[1])return i*parseInt(a.slice(2),16);if("o"===a[1])return i*parseInt(a.slice(2),8)}return i*parseInt(a,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!tx(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),tT=RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),tP=/^[-+]?[0-9]+e/,tL=new tw("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!!tT.test(e)&&"_"!==e[e.length-1]},construct:function(e){var t,a;return(a="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t)?1===a?1/0:-1/0:".nan"===t?NaN:a*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||tx(e))},represent:function(e,t){var a;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(1/0===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(-1/0===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(tx(e))return"-0.0";return a=e.toString(10),tP.test(a)?a.replace("e",".e"):a},defaultStyle:"lowercase"}),tB=tN.extend({implicit:[tA,tI,tO,tL]}),tF=RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),tE=RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),tM=new tw("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==tF.exec(e)||null!==tE.exec(e))},construct:function(e){var t,a,i,r,l,n,s,o,c=0,d=null;if(null===(t=tF.exec(e))&&(t=tE.exec(e)),null===t)throw Error("Date resolve error");if(a=+t[1],i=t[2]-1,r=+t[3],!t[4])return new Date(Date.UTC(a,i,r));if(l=+t[4],n=+t[5],s=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c*=1}return t[9]&&(d=(60*t[10]+ +(t[11]||0))*6e4,"-"===t[9]&&(d=-d)),o=new Date(Date.UTC(a,i,r,l,n,s,c)),d&&o.setTime(o.getTime()-d),o},instanceOf:Date,represent:function(e){return e.toISOString()}}),tz=new tw("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),t$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",tR=new tw("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,a,i=0,r=e.length;for(a=0;a<r;a++)if(!((t=t$.indexOf(e.charAt(a)))>64)){if(t<0)return!1;i+=6}return i%8==0},construct:function(e){var t,a,i=e.replace(/[\r\n=]/g,""),r=i.length,l=0,n=[];for(t=0;t<r;t++)t%4==0&&t&&(n.push(l>>16&255),n.push(l>>8&255),n.push(255&l)),l=l<<6|t$.indexOf(i.charAt(t));return 0==(a=r%4*6)?(n.push(l>>16&255),n.push(l>>8&255),n.push(255&l)):18===a?(n.push(l>>10&255),n.push(l>>2&255)):12===a&&n.push(l>>4&255),new Uint8Array(n)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,a,i="",r=0,l=e.length;for(t=0;t<l;t++)t%3==0&&t&&(i+=t$[r>>18&63],i+=t$[r>>12&63],i+=t$[r>>6&63],i+=t$[63&r]),r=(r<<8)+e[t];return 0==(a=l%3)?(i+=t$[r>>18&63],i+=t$[r>>12&63],i+=t$[r>>6&63],i+=t$[63&r]):2===a?(i+=t$[r>>10&63],i+=t$[r>>4&63],i+=t$[r<<2&63],i+=t$[64]):1===a&&(i+=t$[r>>2&63],i+=t$[r<<4&63],i+=t$[64],i+=t$[64]),i}}),tD=Object.prototype.hasOwnProperty,tG=Object.prototype.toString,tK=new tw("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,a,i,r,l,n=[];for(t=0,a=e.length;t<a;t+=1){if(i=e[t],l=!1,"[object Object]"!==tG.call(i))return!1;for(r in i)if(tD.call(i,r))if(l)return!1;else l=!0;if(!l||-1!==n.indexOf(r))return!1;n.push(r)}return!0},construct:function(e){return null!==e?e:[]}}),tq=Object.prototype.toString,tJ=new tw("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){var t,a,i,r,l;if(null===e)return!0;for(t=0,l=Array(e.length),a=e.length;t<a;t+=1){if(i=e[t],"[object Object]"!==tq.call(i)||1!==(r=Object.keys(i)).length)return!1;l[t]=[r[0],i[r[0]]]}return!0},construct:function(e){var t,a,i,r,l;if(null===e)return[];for(t=0,l=Array(e.length),a=e.length;t<a;t+=1)r=Object.keys(i=e[t]),l[t]=[r[0],i[r[0]]];return l}}),tU=Object.prototype.hasOwnProperty,tW=new tw("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){var t;if(null===e)return!0;for(t in e)if(tU.call(e,t)&&null!==e[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),tH=tB.extend({implicit:[tM,tz],explicit:[tR,tK,tJ,tW]}),tV=Object.prototype.hasOwnProperty,tY=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,tZ=/[\x85\u2028\u2029]/,tQ=/[,\[\]\{\}]/,tX=/^(?:!|!!|![a-z\-]+!)$/i,t0=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function t1(e){return Object.prototype.toString.call(e)}function t2(e){return 10===e||13===e}function t4(e){return 9===e||32===e}function t6(e){return 9===e||32===e||10===e||13===e}function t8(e){return 44===e||91===e||93===e||123===e||125===e}function t3(e){return 48===e?"\0":97===e?"\x07":98===e?"\b":116===e||9===e?"	":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"\x1b":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function t5(e,t,a){"__proto__"===t?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:a}):e[t]=a}for(var t9=Array(256),t7=Array(256),ae=0;ae<256;ae++)t9[ae]=+!!t3(ae),t7[ae]=t3(ae);function at(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||tH,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function aa(e,t){var a={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return a.snippet=tv(a),new ty(t,a)}function ai(e,t){throw aa(e,t)}function ar(e,t){e.onWarning&&e.onWarning.call(null,aa(e,t))}var al={YAML:function(e,t,a){var i,r,l;null!==e.version&&ai(e,"duplication of %YAML directive"),1!==a.length&&ai(e,"YAML directive accepts exactly one argument"),null===(i=/^([0-9]+)\.([0-9]+)$/.exec(a[0]))&&ai(e,"ill-formed argument of the YAML directive"),r=parseInt(i[1],10),l=parseInt(i[2],10),1!==r&&ai(e,"unacceptable YAML version of the document"),e.version=a[0],e.checkLineBreaks=l<2,1!==l&&2!==l&&ar(e,"unsupported YAML version of the document")},TAG:function(e,t,a){var i,r;2!==a.length&&ai(e,"TAG directive accepts exactly two arguments"),i=a[0],r=a[1],tX.test(i)||ai(e,"ill-formed tag handle (first argument) of the TAG directive"),tV.call(e.tagMap,i)&&ai(e,'there is a previously declared suffix for "'+i+'" tag handle'),t0.test(r)||ai(e,"ill-formed tag prefix (second argument) of the TAG directive");try{r=decodeURIComponent(r)}catch(t){ai(e,"tag prefix is malformed: "+r)}e.tagMap[i]=r}};function an(e,t,a,i){var r,l,n,s;if(t<a){if(s=e.input.slice(t,a),i)for(r=0,l=s.length;r<l;r+=1)9===(n=s.charCodeAt(r))||32<=n&&n<=1114111||ai(e,"expected valid JSON character");else tY.test(s)&&ai(e,"the stream contains non-printable characters");e.result+=s}}function as(e,t,a,i){var r,l,n,s,o;for("object"==typeof(o=a)&&null!==o||ai(e,"cannot merge mappings; the provided source object is unacceptable"),n=0,s=(r=Object.keys(a)).length;n<s;n+=1)l=r[n],tV.call(t,l)||(t5(t,l,a[l]),i[l]=!0)}function ao(e,t,a,i,r,l,n,s,o){var c,d;if(Array.isArray(r))for(c=0,d=(r=Array.prototype.slice.call(r)).length;c<d;c+=1)Array.isArray(r[c])&&ai(e,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===t1(r[c])&&(r[c]="[object Object]");if("object"==typeof r&&"[object Object]"===t1(r)&&(r="[object Object]"),r=String(r),null===t&&(t={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(l))for(c=0,d=l.length;c<d;c+=1)as(e,t,l[c],a);else as(e,t,l,a);else!e.json&&!tV.call(a,r)&&tV.call(t,r)&&(e.line=n||e.line,e.lineStart=s||e.lineStart,e.position=o||e.position,ai(e,"duplicated mapping key")),t5(t,r,l),delete a[r];return t}function ac(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):ai(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function ad(e,t,a){for(var i=0,r=e.input.charCodeAt(e.position);0!==r;){for(;t4(r);)9===r&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),r=e.input.charCodeAt(++e.position);if(t&&35===r)do r=e.input.charCodeAt(++e.position);while(10!==r&&13!==r&&0!==r)if(t2(r))for(ac(e),r=e.input.charCodeAt(e.position),i++,e.lineIndent=0;32===r;)e.lineIndent++,r=e.input.charCodeAt(++e.position);else break}return -1!==a&&0!==i&&e.lineIndent<a&&ar(e,"deficient indentation"),i}function au(e){var t,a=e.position;return!!((45===(t=e.input.charCodeAt(a))||46===t)&&t===e.input.charCodeAt(a+1)&&t===e.input.charCodeAt(a+2)&&(a+=3,0===(t=e.input.charCodeAt(a))||t6(t)))||!1}function ap(e,t){1===t?e.result+=" ":t>1&&(e.result+=th("\n",t-1))}function am(e,t){var a,i,r=e.tag,l=e.anchor,n=[],s=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=n),i=e.input.charCodeAt(e.position);0!==i&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,ai(e,"tab characters must not be used in indentation")),45===i&&t6(e.input.charCodeAt(e.position+1)));){if(s=!0,e.position++,ad(e,!0,-1)&&e.lineIndent<=t){n.push(null),i=e.input.charCodeAt(e.position);continue}if(a=e.line,ag(e,t,3,!1,!0),n.push(e.result),ad(e,!0,-1),i=e.input.charCodeAt(e.position),(e.line===a||e.lineIndent>t)&&0!==i)ai(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return!!s&&(e.tag=r,e.anchor=l,e.kind="sequence",e.result=n,!0)}function ag(e,t,a,i,r){var l,n,s,o,c,d,u,p,m,g=1,h=!1,x=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,l=n=s=4===a||3===a,i&&ad(e,!0,-1)&&(h=!0,e.lineIndent>t?g=1:e.lineIndent===t?g=0:e.lineIndent<t&&(g=-1)),1===g)for(;function(e){var t,a,i,r,l=!1,n=!1;if(33!==(r=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&ai(e,"duplication of a tag property"),60===(r=e.input.charCodeAt(++e.position))?(l=!0,r=e.input.charCodeAt(++e.position)):33===r?(n=!0,a="!!",r=e.input.charCodeAt(++e.position)):a="!",t=e.position,l){do r=e.input.charCodeAt(++e.position);while(0!==r&&62!==r)e.position<e.length?(i=e.input.slice(t,e.position),r=e.input.charCodeAt(++e.position)):ai(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==r&&!t6(r);)33===r&&(n?ai(e,"tag suffix cannot contain exclamation marks"):(a=e.input.slice(t-1,e.position+1),tX.test(a)||ai(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),r=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),tQ.test(i)&&ai(e,"tag suffix cannot contain flow indicator characters")}i&&!t0.test(i)&&ai(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch(t){ai(e,"tag name is malformed: "+i)}return l?e.tag=i:tV.call(e.tagMap,a)?e.tag=e.tagMap[a]+i:"!"===a?e.tag="!"+i:"!!"===a?e.tag="tag:yaml.org,2002:"+i:ai(e,'undeclared tag handle "'+a+'"'),!0}(e)||function(e){var t,a;if(38!==(a=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&ai(e,"duplication of an anchor property"),a=e.input.charCodeAt(++e.position),t=e.position;0!==a&&!t6(a)&&!t8(a);)a=e.input.charCodeAt(++e.position);return e.position===t&&ai(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}(e);)ad(e,!0,-1)?(h=!0,s=l,e.lineIndent>t?g=1:e.lineIndent===t?g=0:e.lineIndent<t&&(g=-1)):s=!1;if(s&&(s=h||r),(1===g||4===a)&&(p=1===a||2===a?t:t+1,m=e.position-e.lineStart,1===g?s&&(am(e,m)||function(e,t,a){var i,r,l,n,s,o,c,d=e.tag,u=e.anchor,p={},m=Object.create(null),g=null,h=null,x=null,f=!1,y=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=p),c=e.input.charCodeAt(e.position);0!==c;){if(f||-1===e.firstTabInLine||(e.position=e.firstTabInLine,ai(e,"tab characters must not be used in indentation")),i=e.input.charCodeAt(e.position+1),l=e.line,(63===c||58===c)&&t6(i))63===c?(f&&(ao(e,p,m,g,h,null,n,s,o),g=h=x=null),y=!0,f=!0,r=!0):f?(f=!1,r=!0):ai(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,c=i;else{if(n=e.line,s=e.lineStart,o=e.position,!ag(e,a,2,!1,!0))break;if(e.line===l){for(c=e.input.charCodeAt(e.position);t4(c);)c=e.input.charCodeAt(++e.position);if(58===c)t6(c=e.input.charCodeAt(++e.position))||ai(e,"a whitespace character is expected after the key-value separator within a block mapping"),f&&(ao(e,p,m,g,h,null,n,s,o),g=h=x=null),y=!0,f=!1,r=!1,g=e.tag,h=e.result;else{if(!y)return e.tag=d,e.anchor=u,!0;ai(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return e.tag=d,e.anchor=u,!0;ai(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}if((e.line===l||e.lineIndent>t)&&(f&&(n=e.line,s=e.lineStart,o=e.position),ag(e,t,4,!0,r)&&(f?h=e.result:x=e.result),f||(ao(e,p,m,g,h,x,n,s,o),g=h=x=null),ad(e,!0,-1),c=e.input.charCodeAt(e.position)),(e.line===l||e.lineIndent>t)&&0!==c)ai(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return f&&ao(e,p,m,g,h,null,n,s,o),y&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=p),y}(e,m,p))||function(e,t){var a,i,r,l,n,s,o,c,d,u,p,m,g=!0,h=e.tag,x=e.anchor,f=Object.create(null);if(91===(m=e.input.charCodeAt(e.position)))n=93,c=!1,l=[];else{if(123!==m)return!1;n=125,c=!0,l={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=l),m=e.input.charCodeAt(++e.position);0!==m;){if(ad(e,!0,t),(m=e.input.charCodeAt(e.position))===n)return e.position++,e.tag=h,e.anchor=x,e.kind=c?"mapping":"sequence",e.result=l,!0;g?44===m&&ai(e,"expected the node content, but found ','"):ai(e,"missed comma between flow collection entries"),u=d=p=null,s=o=!1,63===m&&t6(e.input.charCodeAt(e.position+1))&&(s=o=!0,e.position++,ad(e,!0,t)),a=e.line,i=e.lineStart,r=e.position,ag(e,t,1,!1,!0),u=e.tag,d=e.result,ad(e,!0,t),m=e.input.charCodeAt(e.position),(o||e.line===a)&&58===m&&(s=!0,m=e.input.charCodeAt(++e.position),ad(e,!0,t),ag(e,t,1,!1,!0),p=e.result),c?ao(e,l,f,u,d,p,a,i,r):s?l.push(ao(e,null,f,u,d,p,a,i,r)):l.push(d),ad(e,!0,t),44===(m=e.input.charCodeAt(e.position))?(g=!0,m=e.input.charCodeAt(++e.position)):g=!1}ai(e,"unexpected end of the stream within a flow collection")}(e,p)?x=!0:(n&&function(e,t){var a,i,r,l,n,s=1,o=!1,c=!1,d=t,u=0,p=!1;if(124===(n=e.input.charCodeAt(e.position)))r=!1;else{if(62!==n)return!1;r=!0}for(e.kind="scalar",e.result="";0!==n;)if(43===(n=e.input.charCodeAt(++e.position))||45===n)1===s?s=43===n?3:2:ai(e,"repeat of a chomping mode identifier");else if((l=48<=(a=n)&&a<=57?a-48:-1)>=0)0===l?ai(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):c?ai(e,"repeat of an indentation width identifier"):(d=t+l-1,c=!0);else break;if(t4(n)){do n=e.input.charCodeAt(++e.position);while(t4(n))if(35===n)do n=e.input.charCodeAt(++e.position);while(!t2(n)&&0!==n)}for(;0!==n;){for(ac(e),e.lineIndent=0,n=e.input.charCodeAt(e.position);(!c||e.lineIndent<d)&&32===n;)e.lineIndent++,n=e.input.charCodeAt(++e.position);if(!c&&e.lineIndent>d&&(d=e.lineIndent),t2(n)){u++;continue}if(e.lineIndent<d){3===s?e.result+=th("\n",o?1+u:u):1===s&&o&&(e.result+="\n");break}for(r?t4(n)?(p=!0,e.result+=th("\n",o?1+u:u)):p?(p=!1,e.result+=th("\n",u+1)):0===u?o&&(e.result+=" "):e.result+=th("\n",u):e.result+=th("\n",o?1+u:u),o=!0,c=!0,u=0,i=e.position;!t2(n)&&0!==n;)n=e.input.charCodeAt(++e.position);an(e,i,e.position,!1)}return!0}(e,p)||function(e,t){var a,i,r;if(39!==(a=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,i=r=e.position;0!==(a=e.input.charCodeAt(e.position));)if(39===a){if(an(e,i,e.position,!0),39!==(a=e.input.charCodeAt(++e.position)))return!0;i=e.position,e.position++,r=e.position}else t2(a)?(an(e,i,r,!0),ap(e,ad(e,!1,t)),i=r=e.position):e.position===e.lineStart&&au(e)?ai(e,"unexpected end of the document within a single quoted scalar"):(e.position++,r=e.position);ai(e,"unexpected end of the stream within a single quoted scalar")}(e,p)||function(e,t){var a,i,r,l,n,s,o,c;if(34!==(s=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,a=i=e.position;0!==(s=e.input.charCodeAt(e.position));)if(34===s)return an(e,a,e.position,!0),e.position++,!0;else if(92===s){if(an(e,a,e.position,!0),t2(s=e.input.charCodeAt(++e.position)))ad(e,!1,t);else if(s<256&&t9[s])e.result+=t7[s],e.position++;else if((n=120===(o=s)?2:117===o?4:8*(85===o))>0){for(r=n,l=0;r>0;r--)(n=function(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}(s=e.input.charCodeAt(++e.position)))>=0?l=(l<<4)+n:ai(e,"expected hexadecimal character");e.result+=(c=l)<=65535?String.fromCharCode(c):String.fromCharCode((c-65536>>10)+55296,(c-65536&1023)+56320),e.position++}else ai(e,"unknown escape sequence");a=i=e.position}else t2(s)?(an(e,a,i,!0),ap(e,ad(e,!1,t)),a=i=e.position):e.position===e.lineStart&&au(e)?ai(e,"unexpected end of the document within a double quoted scalar"):(e.position++,i=e.position);ai(e,"unexpected end of the stream within a double quoted scalar")}(e,p)?x=!0:!function(e){var t,a,i;if(42!==(i=e.input.charCodeAt(e.position)))return!1;for(i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!t6(i)&&!t8(i);)i=e.input.charCodeAt(++e.position);return e.position===t&&ai(e,"name of an alias node must contain at least one character"),a=e.input.slice(t,e.position),tV.call(e.anchorMap,a)||ai(e,'unidentified alias "'+a+'"'),e.result=e.anchorMap[a],ad(e,!0,-1),!0}(e)?function(e,t,a){var i,r,l,n,s,o,c,d,u=e.kind,p=e.result;if(t6(d=e.input.charCodeAt(e.position))||t8(d)||35===d||38===d||42===d||33===d||124===d||62===d||39===d||34===d||37===d||64===d||96===d||(63===d||45===d)&&(t6(i=e.input.charCodeAt(e.position+1))||a&&t8(i)))return!1;for(e.kind="scalar",e.result="",r=l=e.position,n=!1;0!==d;){if(58===d){if(t6(i=e.input.charCodeAt(e.position+1))||a&&t8(i))break}else if(35===d){if(t6(e.input.charCodeAt(e.position-1)))break}else if(e.position===e.lineStart&&au(e)||a&&t8(d))break;else if(t2(d)){if(s=e.line,o=e.lineStart,c=e.lineIndent,ad(e,!1,-1),e.lineIndent>=t){n=!0,d=e.input.charCodeAt(e.position);continue}e.position=l,e.line=s,e.lineStart=o,e.lineIndent=c;break}n&&(an(e,r,l,!1),ap(e,e.line-s),r=l=e.position,n=!1),t4(d)||(l=e.position+1),d=e.input.charCodeAt(++e.position)}return an(e,r,l,!1),!!e.result||(e.kind=u,e.result=p,!1)}(e,p,1===a)&&(x=!0,null===e.tag&&(e.tag="?")):(x=!0,(null!==e.tag||null!==e.anchor)&&ai(e,"alias node should not have any properties")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===g&&(x=s&&am(e,m))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&ai(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),o=0,c=e.implicitTypes.length;o<c;o+=1)if((u=e.implicitTypes[o]).resolve(e.result)){e.result=u.construct(e.result),e.tag=u.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(tV.call(e.typeMap[e.kind||"fallback"],e.tag))u=e.typeMap[e.kind||"fallback"][e.tag];else for(o=0,u=null,c=(d=e.typeMap.multi[e.kind||"fallback"]).length;o<c;o+=1)if(e.tag.slice(0,d[o].tag.length)===d[o].tag){u=d[o];break}u||ai(e,"unknown tag !<"+e.tag+">"),null!==e.result&&u.kind!==e.kind&&ai(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+u.kind+'", not "'+e.kind+'"'),u.resolve(e.result,e.tag)?(e.result=u.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):ai(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||x}function ah(e,t){e=String(e),t=t||{},0!==e.length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var a=new at(e,t),i=e.indexOf("\0");for(-1!==i&&(a.position=i,ai(a,"null byte is not allowed in input")),a.input+="\0";32===a.input.charCodeAt(a.position);)a.lineIndent+=1,a.position+=1;for(;a.position<a.length-1;)!function(e){var t,a,i,r,l=e.position,n=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(r=e.input.charCodeAt(e.position))&&(ad(e,!0,-1),r=e.input.charCodeAt(e.position),!(e.lineIndent>0)&&37===r);){for(n=!0,r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!t6(r);)r=e.input.charCodeAt(++e.position);for(a=e.input.slice(t,e.position),i=[],a.length<1&&ai(e,"directive name must not be less than one character in length");0!==r;){for(;t4(r);)r=e.input.charCodeAt(++e.position);if(35===r){do r=e.input.charCodeAt(++e.position);while(0!==r&&!t2(r))break}if(t2(r))break;for(t=e.position;0!==r&&!t6(r);)r=e.input.charCodeAt(++e.position);i.push(e.input.slice(t,e.position))}0!==r&&ac(e),tV.call(al,a)?al[a](e,a,i):ar(e,'unknown document directive "'+a+'"')}if(ad(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,ad(e,!0,-1)):n&&ai(e,"directives end mark is expected"),ag(e,e.lineIndent-1,4,!1,!0),ad(e,!0,-1),e.checkLineBreaks&&tZ.test(e.input.slice(l,e.position))&&ar(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&au(e)){46===e.input.charCodeAt(e.position)&&(e.position+=3,ad(e,!0,-1));return}e.position<e.length-1&&ai(e,"end of the stream or a document separator is expected")}(a);return a.documents}var ax=Object.prototype.toString,af=Object.prototype.hasOwnProperty,ay={};ay[0]="\\0",ay[7]="\\a",ay[8]="\\b",ay[9]="\\t",ay[10]="\\n",ay[11]="\\v",ay[12]="\\f",ay[13]="\\r",ay[27]="\\e",ay[34]='\\"',ay[92]="\\\\",ay[133]="\\N",ay[160]="\\_",ay[8232]="\\L",ay[8233]="\\P";function aj(e,t){return function(){throw Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}aj("safeLoad","load"),aj("safeLoadAll","loadAll"),aj("safeDump","dump");var a_=function(e,t){var a=ah(e,t);if(0!==a.length){if(1===a.length)return a[0];throw new ty("expected a single document in the stream, but found more")}};let{Text:av}=c.Typography,{Option:ab}=s.Select,aC=({categories:e,onActionChange:t,onSeverityChange:a,onRemove:r,readOnly:l=!1})=>{let n=[{title:"Category",dataIndex:"display_name",key:"display_name",render:(e,t)=>(0,i.jsxs)("div",{children:[(0,i.jsx)(av,{strong:!0,children:e}),e!==t.category&&(0,i.jsx)("div",{children:(0,i.jsx)(av,{type:"secondary",style:{fontSize:12},children:t.category})})]})},{title:"Severity Threshold",dataIndex:"severity_threshold",key:"severity_threshold",width:180,render:(e,t)=>l?(0,i.jsx)(o.Tag,{color:{high:"red",medium:"orange",low:"yellow"}[e],children:e.toUpperCase()}):(0,i.jsxs)(s.Select,{value:e,onChange:e=>a?.(t.id,e),style:{width:150},size:"small",children:[(0,i.jsx)(ab,{value:"high",children:"High"}),(0,i.jsx)(ab,{value:"medium",children:"Medium"}),(0,i.jsx)(ab,{value:"low",children:"Low"})]})},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,a)=>l?(0,i.jsx)(o.Tag,{color:"BLOCK"===e?"red":"blue",children:e}):(0,i.jsxs)(s.Select,{value:e,onChange:e=>t?.(a.id,e),style:{width:120},size:"small",children:[(0,i.jsx)(ab,{value:"BLOCK",children:"Block"}),(0,i.jsx)(ab,{value:"MASK",children:"Mask"})]})}];return(l||n.push({title:"",key:"actions",width:100,render:(e,t)=>(0,i.jsx)(d.Button,{type:"text",danger:!0,size:"small",icon:(0,i.jsx)(I.DeleteOutlined,{}),onClick:()=>r?.(t.id),children:"Delete"})}),0===e.length)?(0,i.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:"No categories configured."}):(0,i.jsx)(A.Table,{dataSource:e,columns:n,rowKey:"id",pagination:!1,size:"small"})},aw=({patterns:e,blockedWords:t,categories:a=[],readOnly:r=!0,onPatternActionChange:l,onPatternRemove:n,onBlockedWordUpdate:s,onBlockedWordRemove:o,onCategoryActionChange:c,onCategorySeverityChange:d,onCategoryRemove:u})=>{if(0===e.length&&0===t.length&&0===a.length)return null;let p=()=>{};return(0,i.jsxs)(i.Fragment,{children:[a.length>0&&(0,i.jsxs)(eL.Card,{className:"mt-6",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)(eB.Text,{className:"text-lg font-semibold",children:"Content Categories"}),(0,i.jsxs)(e4.Badge,{color:"blue",children:[a.length," categories configured"]})]}),(0,i.jsx)(aC,{categories:a,onActionChange:r?void 0:c,onSeverityChange:r?void 0:d,onRemove:r?void 0:u,readOnly:r})]}),e.length>0&&(0,i.jsxs)(eL.Card,{className:"mt-6",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)(eB.Text,{className:"text-lg font-semibold",children:"Pattern Detection"}),(0,i.jsxs)(e4.Badge,{color:"blue",children:[e.length," patterns configured"]})]}),(0,i.jsx)(P,{patterns:e,onActionChange:r?p:l||p,onRemove:r?p:n||p})]}),t.length>0&&(0,i.jsxs)(eL.Card,{className:"mt-6",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)(eB.Text,{className:"text-lg font-semibold",children:"Blocked Keywords"}),(0,i.jsxs)(e4.Badge,{color:"blue",children:[t.length," keywords configured"]})]}),(0,i.jsx)(F,{keywords:t,onActionChange:r?p:s||p,onRemove:r?p:o||p})]})]})},{Text:aS}=c.Typography,ak=({guardrailData:e,guardrailSettings:t,isEditing:a,accessToken:r,onDataChange:l,onUnsavedChanges:n})=>{let[s,o]=(0,u.useState)([]),[c,d]=(0,u.useState)([]),[p,m]=(0,u.useState)([]),[g,h]=(0,u.useState)([]),[x,f]=(0,u.useState)([]),[y,j]=(0,u.useState)([]),[_,v]=(0,u.useState)(!1),[b,C]=(0,u.useState)(null),[w,S]=(0,u.useState)(!1),[k,N]=(0,u.useState)(null);(0,u.useEffect)(()=>{if(e?.litellm_params?.patterns){let t=e.litellm_params.patterns.map((e,t)=>({id:`pattern-${t}`,type:"prebuilt"===e.pattern_type?"prebuilt":"custom",name:e.pattern_name||e.name,display_name:e.display_name,pattern:e.pattern,action:e.action||"BLOCK"}));o(t),h(t)}else o([]),h([]);if(e?.litellm_params?.blocked_words){let t=e.litellm_params.blocked_words.map((e,t)=>({id:`word-${t}`,keyword:e.keyword,action:e.action||"BLOCK",description:e.description}));d(t),f(t)}else d([]),f([]);if(e?.litellm_params?.categories?.length>0){let a=t?.content_filter_settings?.content_categories?Object.fromEntries(t.content_filter_settings.content_categories.map(e=>[e.name,e])):{},i=e.litellm_params.categories.map((e,t)=>{let i=a[e.category];return{id:`category-${t}`,category:e.category,display_name:i?.display_name??e.category,action:e.action||"BLOCK",severity_threshold:e.severity_threshold||"medium"}});m(i),j(i)}else m([]),j([]);let a=e?.litellm_params?.competitor_intent_config;if(a&&"object"==typeof a){let e=!!(a.brand_self&&Array.isArray(a.brand_self)&&a.brand_self.length>0),t={competitor_intent_type:a.competitor_intent_type??"airline",brand_self:Array.isArray(a.brand_self)?a.brand_self:[],locations:Array.isArray(a.locations)?a.locations:[],competitors:Array.isArray(a.competitors)?a.competitors:[],policy:a.policy??{competitor_comparison:"refuse",possible_competitor_comparison:"reframe"},threshold_high:"number"==typeof a.threshold_high?a.threshold_high:.7,threshold_medium:"number"==typeof a.threshold_medium?a.threshold_medium:.45,threshold_low:"number"==typeof a.threshold_low?a.threshold_low:.3};v(e),C(t),S(e),N(t)}else v(!1),C(null),S(!1),N(null)},[e,t?.content_filter_settings?.content_categories]),(0,u.useEffect)(()=>{l&&l(s,c,p,_,b)},[s,c,p,_,b,l]);let A=u.default.useMemo(()=>{let e=JSON.stringify(s)!==JSON.stringify(g),t=JSON.stringify(c)!==JSON.stringify(x),a=JSON.stringify(p)!==JSON.stringify(y),i=_!==w||JSON.stringify(b)!==JSON.stringify(k);return e||t||a||i},[s,c,p,_,b,g,x,y,w,k]);return((0,u.useEffect)(()=>{a&&n&&n(A)},[A,a,n]),e?.litellm_params?.guardrail!=="litellm_content_filter")?null:a?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eF.Divider,{orientation:"left",children:"Content Filter Configuration"}),A&&(0,i.jsx)(tg.Alert,{type:"warning",showIcon:!0,className:"mb-4",message:(0,i.jsx)(aS,{children:'You have unsaved changes to patterns or keywords. Remember to click "Save Changes" at the bottom.'})}),(0,i.jsx)("div",{className:"mb-6",children:t&&t.content_filter_settings&&(0,i.jsx)(Z,{prebuiltPatterns:t.content_filter_settings.prebuilt_patterns||[],categories:t.content_filter_settings.pattern_categories||[],selectedPatterns:s,blockedWords:c,onPatternAdd:e=>o([...s,e]),onPatternRemove:e=>o(s.filter(t=>t.id!==e)),onPatternActionChange:(e,t)=>o(s.map(a=>a.id===e?{...a,action:t}:a)),onBlockedWordAdd:e=>d([...c,e]),onBlockedWordRemove:e=>d(c.filter(t=>t.id!==e)),onBlockedWordUpdate:(e,t,a)=>d(c.map(i=>i.id===e?{...i,[t]:a}:i)),onFileUpload:e=>{try{let t=a_(e);if(t&&Array.isArray(t.blocked_words)){let e=t.blocked_words.filter(e=>null!=e&&"object"==typeof e).map((e,t)=>({id:crypto.randomUUID(),keyword:String(e.keyword??""),action:"MASK"===e.action?"MASK":"BLOCK"})).filter(e=>""!==e.keyword.trim());d(t=>[...t,...e])}}catch{}},accessToken:r,contentCategories:t.content_filter_settings.content_categories||[],selectedContentCategories:p,onContentCategoryAdd:e=>m([...p,e]),onContentCategoryRemove:e=>m(p.filter(t=>t.id!==e)),onContentCategoryUpdate:(e,t,a)=>m(p.map(i=>i.id===e?{...i,[t]:a}:i)),competitorIntentEnabled:_,competitorIntentConfig:b,onCompetitorIntentChange:(e,t)=>{v(e),C(t)}})})]}):(0,i.jsx)(aw,{patterns:s,blockedWords:c,categories:p,readOnly:!0})};var aN=e.i(788191),aA=e.i(245704),aI=e.i(518617);let aO={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};var aT=u.forwardRef(function(e,t){return u.createElement(eC.default,(0,ev.default)({},e,{ref:t,icon:aO}))}),aP=e.i(987432);let aL={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M892 772h-80v-80c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v80h-80c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h80v80c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-80h80c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM373.5 498.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.8-1.7-203.2 89.2-203.2 200 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.8-1.1 6.4-4.8 5.9-8.8zM824 472c0-109.4-87.9-198.3-196.9-200C516.3 270.3 424 361.2 424 472c0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C357 742.6 326 814.8 324 891.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5C505.8 695.7 563 672 624 672c110.4 0 200-89.5 200-200zm-109.5 90.5C690.3 586.7 658.2 600 624 600s-66.3-13.3-90.5-37.5a127.26 127.26 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4-.1 34.2-13.4 66.3-37.6 90.5z"}}]},name:"usergroup-add",theme:"outlined"};var aB=u.forwardRef(function(e,t){return u.createElement(eC.default,(0,ev.default)({},e,{ref:t,icon:aL}))}),aF=e.i(872934);let{Panel:aE}=E.Collapse,{TextArea:aM}=l.Input,az={empty:{name:"Empty Template",code:`async def apply_guardrail(inputs, request_data, input_type):
    # inputs: {texts, images, tools, tool_calls, structured_messages, model}
    # request_data: {model, user_id, team_id, end_user_id, metadata}
    # input_type: "request" or "response"
    return allow()`},blockSSN:{name:"Block SSN",code:`def apply_guardrail(inputs, request_data, input_type):
    for text in inputs["texts"]:
        if regex_match(text, r"\\d{3}-\\d{2}-\\d{4}"):
            return block("SSN detected")
    return allow()`},redactEmail:{name:"Redact Emails",code:`def apply_guardrail(inputs, request_data, input_type):
    pattern = r"[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"
    modified = []
    for text in inputs["texts"]:
        modified.append(regex_replace(text, pattern, "[EMAIL REDACTED]"))
    return modify(texts=modified)`},blockSQL:{name:"Block SQL Injection",code:`def apply_guardrail(inputs, request_data, input_type):
    if input_type != "request":
        return allow()
    for text in inputs["texts"]:
        if contains_code_language(text, ["sql"]):
            return block("SQL code not allowed")
    return allow()`},validateJSON:{name:"Validate JSON",code:`def apply_guardrail(inputs, request_data, input_type):
    if input_type != "response":
        return allow()
    
    schema = {"type": "object", "required": ["name", "value"]}
    
    for text in inputs["texts"]:
        obj = json_parse(text)
        if obj is None:
            return block("Invalid JSON response")
        if not json_schema_valid(obj, schema):
            return block("Response missing required fields")
    return allow()`},externalAPI:{name:"External API Check (async)",code:`async def apply_guardrail(inputs, request_data, input_type):
    # Call an external moderation API (async for non-blocking)
    for text in inputs["texts"]:
        response = await http_post(
            "https://api.example.com/moderate",
            body={"text": text, "user_id": request_data["user_id"]},
            headers={"Authorization": "Bearer YOUR_API_KEY"},
            timeout=10
        )
        
        if not response["success"]:
            # API call failed, allow by default or block
            return allow()
        
        if response["body"].get("flagged"):
            return block(response["body"].get("reason", "Content flagged"))
    
    return allow()`}},a$={"Return Values":[{name:"allow()",desc:"Let request/response through"},{name:"block(reason)",desc:"Reject with message"},{name:"modify(texts=[], images=[], tool_calls=[])",desc:"Transform content"}],"HTTP Requests (async)":[{name:"await http_request(url, method, headers, body)",desc:"Make async HTTP request"},{name:"await http_get(url, headers)",desc:"Async GET request"},{name:"await http_post(url, body, headers)",desc:"Async POST request"}],"Regex Functions":[{name:"regex_match(text, pattern)",desc:"Returns True if pattern found"},{name:"regex_replace(text, pattern, replacement)",desc:"Replace all matches"},{name:"regex_find_all(text, pattern)",desc:"Return list of matches"}],"JSON Functions":[{name:"json_parse(text)",desc:"Parse JSON string, returns None on error"},{name:"json_stringify(obj)",desc:"Convert to JSON string"},{name:"json_schema_valid(obj, schema)",desc:"Validate against JSON schema"}],"URL Functions":[{name:"extract_urls(text)",desc:"Extract all URLs from text"},{name:"is_valid_url(url)",desc:"Check if URL is valid"},{name:"all_urls_valid(text)",desc:"Check all URLs in text are valid"}],"Code Detection":[{name:"detect_code(text)",desc:"Returns True if code detected"},{name:"detect_code_languages(text)",desc:"Returns list of detected languages"},{name:'contains_code_language(text, ["sql"])',desc:"Check for specific languages"}],"Text Utilities":[{name:"contains(text, substring)",desc:"Check if substring exists"},{name:"contains_any(text, [substr1, substr2])",desc:"Check if any substring exists"},{name:"word_count(text)",desc:"Count words"},{name:"char_count(text)",desc:"Count characters"},{name:"lower(text) / upper(text) / trim(text)",desc:"String transforms"}]},aR=[{value:"pre_call",label:"pre_call (Request)"},{value:"post_call",label:"post_call (Response)"},{value:"during_call",label:"during_call (Parallel)"},{value:"logging_only",label:"logging_only"},{value:"pre_mcp_call",label:"pre_mcp_call (Before MCP Tool Call)"},{value:"post_mcp_call",label:"post_mcp_call (After MCP Tool Call)"},{value:"during_mcp_call",label:"during_mcp_call (During MCP Tool Call)"}],aD=({visible:e,onClose:t,onSuccess:a,accessToken:r,editData:l})=>{let o=!!l,[c,d]=(0,u.useState)(""),[g,h]=(0,u.useState)(["pre_call"]),[x,f]=(0,u.useState)(!1),[y,j]=(0,u.useState)("empty"),[_,v]=(0,u.useState)(az.empty.code),[b,C]=(0,u.useState)(!1),[w,S]=(0,u.useState)(!1),[k,N]=(0,u.useState)(!1),A={texts:["Hello, my SSN is 123-45-6789"],images:[],tools:[{type:"function",function:{name:"get_weather",description:"Get the current weather in a location",parameters:{type:"object",properties:{location:{type:"string",description:"City name"}},required:["location"]}}}],tool_calls:[],structured_messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:"Hello, my SSN is 123-45-6789"}],model:"gpt-4"},I={texts:["The weather in San Francisco is 72°F and sunny."],images:[],tools:[],tool_calls:[{id:"call_abc123",type:"function",function:{name:"get_weather",arguments:'{"location": "San Francisco"}'}}],structured_messages:[],model:"gpt-4"},O={texts:['Tool: read_wiki_structure\nArguments: {"repoName": "BerriAI/litellm"}'],images:[],tools:[{type:"function",function:{name:"read_wiki_structure",description:"Read the structure of a GitHub repository (MCP tool passed as OpenAI tool)",parameters:{type:"object",properties:{repoName:{type:"string",description:"Repository name, e.g. BerriAI/litellm"}},required:["repoName"]}}}],tool_calls:[{id:"call_mcp_001",type:"function",function:{name:"read_wiki_structure",arguments:'{"repoName": "BerriAI/litellm"}'}}],structured_messages:[{role:"user",content:'Tool: read_wiki_structure\nArguments: {"repoName": "BerriAI/litellm"}'}],model:"mcp-tool-call"},[T,P]=(0,u.useState)(JSON.stringify(A,null,2)),[L,B]=(0,u.useState)(null),[F,M]=(0,u.useState)(null),z=(0,u.useRef)(null),$=e=>null==e?["pre_call"]:Array.isArray(e)?e.length?e:["pre_call"]:[e];(0,u.useEffect)(()=>{e&&(l?(d(l.guardrail_name||""),h($(l.litellm_params?.mode)),f(l.litellm_params?.default_on||!1),v(l.litellm_params?.custom_code||az.empty.code),j("")):(d(""),h(["pre_call"]),f(!1),j("empty"),v(az.empty.code)),B(null),N(!1))},[e,l]);let R=async e=>{try{await navigator.clipboard.writeText(e),M(e),setTimeout(()=>M(null),2e3)}catch(e){console.error("Failed to copy:",e)}},D=async()=>{if(!c.trim())return void p.default.fromBackend("Please enter a guardrail name");if(!_.trim())return void p.default.fromBackend("Please enter custom code");if(!r)return void p.default.fromBackend("No access token available");C(!0);try{if(o&&l){let e={litellm_params:{custom_code:_}};c!==l.guardrail_name&&(e.guardrail_name=c);let t=$(l.litellm_params?.mode);(g.length!==t.length||g.some((e,a)=>e!==t[a]))&&(e.litellm_params.mode=g),x!==l.litellm_params?.default_on&&(e.litellm_params.default_on=x),await (0,m.updateGuardrailCall)(r,l.guardrail_id,e),p.default.success("Custom code guardrail updated successfully")}else await (0,m.createGuardrailCall)(r,{guardrail_name:c,litellm_params:{guardrail:"custom_code",mode:g,default_on:x,custom_code:_},guardrail_info:{}}),p.default.success("Custom code guardrail created successfully");a(),t()}catch(e){console.error("Failed to save guardrail:",e),p.default.fromBackend(`Failed to ${o?"update":"create"} guardrail: `+(e instanceof Error?e.message:String(e)))}finally{C(!1)}},K=async()=>{if(!r)return void B({error:"No access token available"});S(!0),B(null);try{let e;try{e=JSON.parse(T)}catch(e){B({error:"Invalid test input JSON"}),S(!1);return}e.texts||(e.texts=[]);let t=["pre_call","pre_mcp_call"],a=["post_call","post_mcp_call"],i=g.some(e=>t.includes(e))?"request":g.some(e=>a.includes(e))?"response":"request",l=await (0,m.testCustomCodeGuardrail)(r,{custom_code:_,test_input:e,input_type:i,request_data:{model:"test-model",metadata:{}}});l.success&&l.result?B(l.result):l.error?B({error:l.error,error_type:l.error_type}):B({error:"Unknown error occurred"})}catch(e){console.error("Failed to test custom code:",e),B({error:e instanceof Error?e.message:"Failed to test custom code"})}finally{S(!1)}},q=_.split("\n").length;return(0,i.jsxs)(n.Modal,{open:e,onCancel:t,footer:null,width:1400,className:"custom-code-modal",closable:!0,destroyOnClose:!0,children:[(0,i.jsxs)("div",{className:"flex flex-col h-[80vh]",children:[(0,i.jsxs)("div",{className:"pb-4 border-b border-gray-200",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:o?"Edit Custom Guardrail":"Create Custom Guardrail"}),(0,i.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Define custom logic using Python-like syntax"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-4 py-4 border-b border-gray-100",children:[(0,i.jsxs)("div",{className:"flex-1 max-w-[200px]",children:[(0,i.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Guardrail Name"}),(0,i.jsx)(e3.TextInput,{value:c,onValueChange:d,placeholder:"e.g., block-pii-custom"})]}),(0,i.jsxs)("div",{className:"w-[280px]",children:[(0,i.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Mode (can select multiple)"}),(0,i.jsx)(s.Select,{mode:"multiple",value:g,onChange:h,options:aR,className:"w-full",size:"middle",placeholder:"Select modes"})]}),(0,i.jsxs)("div",{className:"w-[180px]",children:[(0,i.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Template"}),(0,i.jsx)(s.Select,{value:y,onChange:e=>{j(e),v(az[e].code)},className:"w-full",size:"middle",dropdownRender:e=>(0,i.jsxs)(i.Fragment,{children:[e,(0,i.jsx)(eF.Divider,{style:{margin:"8px 0"}}),(0,i.jsxs)("div",{style:{padding:"8px 12px",cursor:"pointer",color:"#1890ff",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},onClick:e=>{e.preventDefault(),window.open("https://models.litellm.ai/guardrails","_blank")},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f0f0f0"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[(0,i.jsx)(aB,{}),(0,i.jsx)("span",{children:"Browse Community templates"}),(0,i.jsx)(aF.ExportOutlined,{style:{fontSize:"10px"}})]})]}),children:(0,i.jsx)(s.Select.OptGroup,{label:"STANDARD",children:Object.entries(az).map(([e,t])=>(0,i.jsx)(s.Select.Option,{value:e,children:t.name},e))})})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2 pt-5",children:[(0,i.jsx)("span",{className:"text-sm text-gray-600",children:"Default On"}),(0,i.jsx)(G.Switch,{checked:x,onChange:f})]})]}),(0,i.jsxs)("div",{className:"flex flex-1 overflow-hidden mt-4 gap-6",children:[(0,i.jsxs)("div",{className:"flex-[2] flex flex-col min-w-0 overflow-y-auto",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2 flex-shrink-0",children:[(0,i.jsx)("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Python Logic"}),(0,i.jsx)("span",{className:"text-xs text-gray-400",children:"Restricted environment (no imports)"})]}),(0,i.jsxs)("div",{className:"relative rounded-lg overflow-hidden border border-gray-700 bg-[#1e1e1e] flex-shrink-0",style:{minHeight:"300px",maxHeight:"400px"},children:[(0,i.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-12 bg-[#1e1e1e] border-r border-gray-700 text-right pr-3 pt-3 select-none overflow-hidden",style:{fontFamily:"'Fira Code', 'Monaco', 'Consolas', monospace",fontSize:"14px",lineHeight:"1.6"},children:Array.from({length:Math.max(q,20)},(e,t)=>(0,i.jsx)("div",{className:"text-gray-500 h-[22.4px]",children:t+1},t+1))}),(0,i.jsx)("textarea",{ref:z,value:_,onChange:e=>v(e.target.value),onKeyDown:e=>{if("Tab"===e.key){e.preventDefault();let t=e.currentTarget,a=t.selectionStart,i=t.selectionEnd;v(_.substring(0,a)+"    "+_.substring(i)),setTimeout(()=>{t.selectionStart=t.selectionEnd=a+4},0)}},spellCheck:!1,className:"w-full h-full pl-14 pr-4 pt-3 pb-3 resize-none focus:outline-none bg-transparent text-gray-200",style:{fontFamily:"'Fira Code', 'Monaco', 'Consolas', monospace",fontSize:"14px",lineHeight:"1.6",tabSize:4}})]}),(0,i.jsx)(E.Collapse,{activeKey:k?["test"]:[],onChange:e=>N(e.includes("test")),className:"mt-3 bg-white border border-gray-200 rounded-lg flex-shrink-0",expandIcon:({isActive:e})=>(0,i.jsx)(aT,{rotate:90*!!e}),children:(0,i.jsx)(aE,{header:(0,i.jsxs)("span",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,i.jsx)(aN.PlayCircleOutlined,{className:"text-blue-500"}),"Test Your Guardrail"]}),children:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsx)("label",{className:"block text-xs font-medium text-gray-600",children:"Test Input (JSON)"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-xs text-gray-500",children:"Load example:"}),(0,i.jsx)("button",{type:"button",onClick:()=>P(JSON.stringify(A,null,2)),className:"px-2 py-1 text-xs rounded border border-orange-200 bg-orange-50 text-orange-700 hover:bg-orange-100 transition-colors",children:"Pre-call"}),(0,i.jsx)("button",{type:"button",onClick:()=>P(JSON.stringify(O,null,2)),className:"px-2 py-1 text-xs rounded border border-purple-200 bg-purple-50 text-purple-700 hover:bg-purple-100 transition-colors",children:"Pre MCP"}),(0,i.jsx)("button",{type:"button",onClick:()=>P(JSON.stringify(I,null,2)),className:"px-2 py-1 text-xs rounded border border-green-200 bg-green-50 text-green-700 hover:bg-green-100 transition-colors",children:"Post-call"})]})]}),(0,i.jsx)("div",{className:"mb-2 p-2 bg-gray-50 rounded text-xs text-gray-600 border border-gray-200",children:(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"texts"}),": Message content (always)"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"images"}),": Base64 images (vision)"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"tools"}),": Tool definitions ",(0,i.jsx)("span",{className:"text-orange-600",children:"(pre_call)"}),", MCP as OpenAI tool ",(0,i.jsx)("span",{className:"text-purple-600",children:"(pre_mcp_call)"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"tool_calls"}),": LLM tool calls ",(0,i.jsx)("span",{className:"text-green-600",children:"(post_call)"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"structured_messages"}),": Full messages ",(0,i.jsx)("span",{className:"text-orange-600",children:"(pre_call)"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"model"}),": Model name (always)"]})]})}),(0,i.jsx)(aM,{value:T,onChange:e=>P(e.target.value),rows:8,className:"font-mono text-xs",placeholder:'{"texts": ["test message"], ...}'})]}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(eQ.Button,{size:"xs",onClick:K,disabled:w,icon:aN.PlayCircleOutlined,children:w?"Running...":"Run Test"}),L&&(0,i.jsx)("div",{className:`flex items-center gap-2 text-sm ${L.error?"text-red-600":"allow"===L.action?"text-green-600":"block"===L.action?"text-orange-600":"text-blue-600"}`,children:L.error?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(aI.CloseCircleOutlined,{}),(0,i.jsxs)("span",{children:[L.error_type&&(0,i.jsxs)("span",{className:"font-medium",children:["[",L.error_type,"] "]}),L.error]})]}):"allow"===L.action?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(aA.CheckCircleOutlined,{})," Allowed"]}):"block"===L.action?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(aI.CloseCircleOutlined,{})," Blocked: ",L.reason]}):"modify"===L.action?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(aA.CheckCircleOutlined,{})," Modified",L.texts&&L.texts.length>0&&(0,i.jsxs)("span",{className:"text-xs text-gray-500 ml-1",children:["→ ",L.texts[0].substring(0,50),L.texts[0].length>50?"...":""]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(aA.CheckCircleOutlined,{})," ",L.action||"Unknown"]})})]})]})},"test")}),(0,i.jsxs)("div",{className:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg flex items-center justify-between flex-shrink-0",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"bg-blue-100 rounded-full p-2",children:(0,i.jsx)(aB,{className:"text-blue-600 text-lg"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Built a useful guardrail?"}),(0,i.jsx)("div",{className:"text-xs text-gray-600",children:"Share it with the community and help others build faster"})]})]}),(0,i.jsx)(eQ.Button,{size:"xs",onClick:()=>window.open("https://github.com/BerriAI/litellm-guardrails","_blank"),icon:aF.ExportOutlined,className:"bg-blue-600 hover:bg-blue-700 text-white border-0",children:"Contribute Template"})]})]}),(0,i.jsxs)("div",{className:"w-[300px] flex-shrink-0 overflow-auto border-l border-gray-200 pl-6",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,i.jsx)(ti.CodeOutlined,{className:"text-blue-500"}),(0,i.jsx)("span",{className:"font-semibold text-gray-700",children:"Available Primitives"})]}),(0,i.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:"Click to copy functions to clipboard"}),(0,i.jsx)(E.Collapse,{defaultActiveKey:["Return Values"],className:"primitives-collapse bg-transparent border-0",expandIconPosition:"end",children:Object.entries(a$).map(([e,t])=>(0,i.jsx)(aE,{header:(0,i.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e}),className:"bg-white mb-2 rounded-lg border border-gray-200",children:(0,i.jsx)("div",{className:"space-y-2",children:t.map(e=>(0,i.jsx)("button",{onClick:()=>R(e.name),className:`w-full text-left px-2 py-2 rounded transition-colors ${F===e.name?"bg-green-100":"bg-gray-50 hover:bg-blue-50"}`,children:F===e.name?(0,i.jsxs)("span",{className:"flex items-center gap-1 text-xs font-mono text-green-700",children:[(0,i.jsx)(aA.CheckCircleOutlined,{})," Copied!"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"text-xs font-mono text-gray-800",children:e.name}),(0,i.jsx)("div",{className:"text-[10px] text-gray-500 mt-0.5",children:e.desc})]})},e.name))})},e))})]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between pt-4 mt-4 border-t border-gray-200",children:[(0,i.jsx)("span",{className:"text-xs text-gray-400",children:"Changes are auto-saved to local draft"}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(eQ.Button,{variant:"secondary",onClick:t,children:"Cancel"}),(0,i.jsx)(eQ.Button,{onClick:D,loading:b,disabled:b||!c.trim(),icon:aP.SaveOutlined,children:o?"Update Guardrail":"Save Guardrail"})]})]})]}),(0,i.jsx)("style",{children:`
        .custom-code-modal .ant-modal-content {
          padding: 24px;
        }
        .custom-code-modal .ant-modal-close {
          top: 20px;
          right: 20px;
        }
        .primitives-collapse .ant-collapse-item {
          border: none !important;
        }
        .primitives-collapse .ant-collapse-header {
          padding: 8px 12px !important;
        }
        .primitives-collapse .ant-collapse-content-box {
          padding: 8px 12px !important;
        }
      `})]})};e.s(["default",0,({guardrailId:e,onClose:t,accessToken:a,isAdmin:n})=>{let[o,c]=(0,u.useState)(null),[g,h]=(0,u.useState)(null),[x,f]=(0,u.useState)(!0),[y,j]=(0,u.useState)(!1),[_]=r.Form.useForm(),[v,b]=(0,u.useState)([]),[C,w]=(0,u.useState)({}),[S,k]=(0,u.useState)(null),[N,A]=(0,u.useState)({}),[I,O]=(0,u.useState)(!1),T={rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""},[P,L]=(0,u.useState)(T),[B,F]=(0,u.useState)(!1),[E,M]=(0,u.useState)(!1),z=u.default.useRef({patterns:[],blockedWords:[],categories:[]}),$=(0,u.useCallback)((e,t,a,i,r)=>{z.current={patterns:e,blockedWords:t,categories:a||[],competitorIntentEnabled:i,competitorIntentConfig:r}},[]),R=async()=>{try{if(f(!0),!a)return;let t=await (0,m.getGuardrailInfo)(a,e);if(c(t),t.litellm_params?.pii_entities_config){let e=t.litellm_params.pii_entities_config;if(b([]),w({}),Object.keys(e).length>0){let t=[],a={};Object.entries(e).forEach(([e,i])=>{t.push(e),a[e]="string"==typeof i?i:"MASK"}),b(t),w(a)}}else b([]),w({})}catch(e){p.default.fromBackend("Failed to load guardrail information"),console.error("Error fetching guardrail info:",e)}finally{f(!1)}},D=async()=>{try{if(!a)return;let e=await (0,m.getGuardrailProviderSpecificParams)(a);h(e)}catch(e){console.error("Error fetching guardrail provider specific params:",e)}},G=async()=>{try{if(!a)return;let e=await (0,m.getGuardrailUISettings)(a);k(e)}catch(e){console.error("Error fetching guardrail UI settings:",e)}};(0,u.useEffect)(()=>{D()},[a]),(0,u.useEffect)(()=>{R(),G()},[e,a]),(0,u.useEffect)(()=>{o&&_&&_.setFieldsValue({guardrail_name:o.guardrail_name,...o.litellm_params,guardrail_info:o.guardrail_info?JSON.stringify(o.guardrail_info,null,2):"",...o.litellm_params?.optional_params&&{optional_params:o.litellm_params.optional_params}})},[o,g,_]);let K=(0,u.useCallback)(()=>{o?.litellm_params?.guardrail==="tool_permission"?L({rules:o.litellm_params?.rules||[],default_action:(o.litellm_params?.default_action||"deny").toLowerCase(),on_disallowed_action:(o.litellm_params?.on_disallowed_action||"block").toLowerCase(),violation_message_template:o.litellm_params?.violation_message_template||""}):L(T),F(!1)},[o]);(0,u.useEffect)(()=>{K()},[K]);let q=async t=>{try{if(!a)return;let c={litellm_params:{}};t.guardrail_name!==o.guardrail_name&&(c.guardrail_name=t.guardrail_name),t.default_on!==o.litellm_params?.default_on&&(c.litellm_params.default_on=t.default_on);let d=o.guardrail_info,u=t.guardrail_info?JSON.parse(t.guardrail_info):void 0;JSON.stringify(d)!==JSON.stringify(u)&&(c.guardrail_info=u);let h=o.litellm_params?.pii_entities_config||{},x={};if(v.forEach(e=>{x[e]=C[e]||"MASK"}),JSON.stringify(h)!==JSON.stringify(x)&&(c.litellm_params.pii_entities_config=x),o.litellm_params?.guardrail==="litellm_content_filter"&&I){var i,r,l,n,s;let e,t=(i=z.current.patterns||[],r=z.current.blockedWords||[],l=z.current.categories||[],n=z.current.competitorIntentEnabled,s=z.current.competitorIntentConfig,e={patterns:i.map(e=>({pattern_type:"prebuilt"===e.type?"prebuilt":"regex",pattern_name:"prebuilt"===e.type?e.name:void 0,pattern:"custom"===e.type?e.pattern:void 0,name:e.name,action:e.action})),blocked_words:r.map(e=>({keyword:e.keyword,action:e.action,description:e.description}))},void 0!==l&&(e.categories=l.map(e=>({category:e.category,enabled:!0,action:e.action,severity_threshold:e.severity_threshold||"medium"}))),n&&s&&s.brand_self.length>0&&(e.competitor_intent_config={competitor_intent_type:s.competitor_intent_type,brand_self:s.brand_self,locations:s.locations?.length?s.locations:void 0,competitors:"generic"===s.competitor_intent_type&&s.competitors?.length?s.competitors:void 0,policy:s.policy,threshold_high:s.threshold_high,threshold_medium:s.threshold_medium,threshold_low:s.threshold_low}),e);c.litellm_params.patterns=t.patterns,c.litellm_params.blocked_words=t.blocked_words,c.litellm_params.categories=t.categories,c.litellm_params.competitor_intent_config=t.competitor_intent_config??null}if(o.litellm_params?.guardrail==="tool_permission"){let e=o.litellm_params?.rules||[],t=P.rules||[],a=JSON.stringify(e)!==JSON.stringify(t),i=(o.litellm_params?.default_action||"deny").toLowerCase(),r=(P.default_action||"deny").toLowerCase(),l=i!==r,n=(o.litellm_params?.on_disallowed_action||"block").toLowerCase(),s=(P.on_disallowed_action||"block").toLowerCase(),d=n!==s,u=o.litellm_params?.violation_message_template||"",p=P.violation_message_template||"",m=u!==p;(B||a||l||d||m)&&(c.litellm_params.rules=t,c.litellm_params.default_action=r,c.litellm_params.on_disallowed_action=s,c.litellm_params.violation_message_template=p||null)}let f=Object.keys(ea).find(e=>ea[e]===o.litellm_params?.guardrail);console.log("values: ",JSON.stringify(t)),console.log("currentProvider: ",f);let y=o.litellm_params?.guardrail==="tool_permission";if(g&&f&&!y){let e=g[ea[f]?.toLowerCase()]||{},a=new Set;console.log("providerSpecificParams: ",JSON.stringify(e)),Object.keys(e).forEach(e=>{"optional_params"!==e&&a.add(e)}),e.optional_params&&e.optional_params.fields&&Object.keys(e.optional_params.fields).forEach(e=>{a.add(e)}),console.log("allowedParams: ",a),a.forEach(e=>{if("patterns"===e||"blocked_words"===e||"categories"===e)return;let a=t[e];(null==a||""===a)&&(a=t.optional_params?.[e]);let i=o.litellm_params?.[e];JSON.stringify(a)!==JSON.stringify(i)&&(null!=a&&""!==a?c.litellm_params[e]=a:null!=i&&""!==i&&(c.litellm_params[e]=null))})}if(0===Object.keys(c.litellm_params).length&&delete c.litellm_params,0===Object.keys(c).length){p.default.info("No changes detected"),j(!1);return}await (0,m.updateGuardrailCall)(a,e,c),p.default.success("Guardrail updated successfully"),O(!1),R(),j(!1)}catch(e){console.error("Error updating guardrail:",e),p.default.fromBackend("Failed to update guardrail")}};if(x)return(0,i.jsx)("div",{className:"p-4",children:"Loading..."});if(!o)return(0,i.jsx)("div",{className:"p-4",children:"Guardrail not found"});let J=e=>e?new Date(e).toLocaleString():"-",{logo:U,displayName:W}=eo(o.litellm_params?.guardrail||""),H=async(e,t)=>{await (0,ta.copyToClipboard)(e)&&(A(e=>({...e,[t]:!0})),setTimeout(()=>{A(e=>({...e,[t]:!1}))},2e3))},V="config"===o.guardrail_definition_location;return(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(d.Button,{type:"text",icon:(0,i.jsx)(tr.ArrowLeftIcon,{className:"w-4 h-4"}),onClick:t,className:"mb-4",children:"Back to Guardrails"}),(0,i.jsx)(tu.Title,{children:o.guardrail_name||"Unnamed Guardrail"}),(0,i.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,i.jsx)(eB.Text,{className:"text-gray-500 font-mono",children:o.guardrail_id}),(0,i.jsx)(d.Button,{type:"text",size:"small",icon:N["guardrail-id"]?(0,i.jsx)(tp.CheckIcon,{size:12}):(0,i.jsx)(tm.CopyIcon,{size:12}),onClick:()=>H(o.guardrail_id,"guardrail-id"),className:`left-2 z-10 transition-all duration-200 ${N["guardrail-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`})]})]}),(0,i.jsxs)(ts.TabGroup,{children:[(0,i.jsxs)(to.TabList,{className:"mb-4",children:[(0,i.jsx)(tn.Tab,{children:"Overview"},"overview"),n?(0,i.jsx)(tn.Tab,{children:"Settings"},"settings"):(0,i.jsx)(i.Fragment,{})]}),(0,i.jsxs)(td.TabPanels,{children:[(0,i.jsxs)(tc.TabPanel,{children:[(0,i.jsxs)(tl.Grid,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,i.jsxs)(eL.Card,{children:[(0,i.jsx)(eB.Text,{children:"Provider"}),(0,i.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[U&&(0,i.jsx)("img",{src:U,alt:`${W} logo`,className:"w-6 h-6",onError:e=>{e.target.style.display="none"}}),(0,i.jsx)(tu.Title,{children:W})]})]}),(0,i.jsxs)(eL.Card,{children:[(0,i.jsx)(eB.Text,{children:"Mode"}),(0,i.jsxs)("div",{className:"mt-2",children:[(0,i.jsx)(tu.Title,{children:o.litellm_params?.mode||"-"}),(0,i.jsx)(e4.Badge,{color:o.litellm_params?.default_on?"green":"gray",children:o.litellm_params?.default_on?"Default On":"Default Off"})]})]}),(0,i.jsxs)(eL.Card,{children:[(0,i.jsx)(eB.Text,{children:"Created At"}),(0,i.jsxs)("div",{className:"mt-2",children:[(0,i.jsx)(tu.Title,{children:J(o.created_at)}),(0,i.jsxs)(eB.Text,{children:["Last Updated: ",J(o.updated_at)]})]})]})]}),o.litellm_params?.pii_entities_config&&Object.keys(o.litellm_params.pii_entities_config).length>0&&(0,i.jsx)(eL.Card,{className:"mt-6",children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)(eB.Text,{className:"font-medium",children:"PII Protection"}),(0,i.jsxs)(e4.Badge,{color:"blue",children:[Object.keys(o.litellm_params.pii_entities_config).length," PII entities configured"]})]})}),o.litellm_params?.pii_entities_config&&Object.keys(o.litellm_params.pii_entities_config).length>0&&(0,i.jsxs)(eL.Card,{className:"mt-6",children:[(0,i.jsx)(eB.Text,{className:"mb-4 text-lg font-semibold",children:"PII Entity Configuration"}),(0,i.jsxs)("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[(0,i.jsxs)("div",{className:"bg-gray-50 px-5 py-3 border-b flex",children:[(0,i.jsx)(eB.Text,{className:"flex-1 font-semibold text-gray-700",children:"Entity Type"}),(0,i.jsx)(eB.Text,{className:"flex-1 font-semibold text-gray-700",children:"Configuration"})]}),(0,i.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:Object.entries(o.litellm_params?.pii_entities_config).map(([e,t])=>(0,i.jsxs)("div",{className:"px-5 py-3 flex border-b hover:bg-gray-50 transition-colors",children:[(0,i.jsx)(eB.Text,{className:"flex-1 font-medium text-gray-900",children:e}),(0,i.jsx)(eB.Text,{className:"flex-1",children:(0,i.jsxs)("span",{className:`inline-flex items-center gap-1.5 ${"MASK"===t?"text-blue-600":"text-red-600"}`,children:["MASK"===t?(0,i.jsx)(ej.default,{}):(0,i.jsx)(e_.StopOutlined,{}),String(t)]})})]},e))})]})]}),o.litellm_params?.guardrail==="tool_permission"&&(0,i.jsx)(eL.Card,{className:"mt-6",children:(0,i.jsx)(e$,{value:P,disabled:!0})}),o.litellm_params?.guardrail==="custom_code"&&o.litellm_params?.custom_code&&(0,i.jsxs)(eL.Card,{className:"mt-6",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(ti.CodeOutlined,{className:"text-blue-500"}),(0,i.jsx)(eB.Text,{className:"font-medium text-lg",children:"Custom Code"})]}),n&&!V&&(0,i.jsx)(d.Button,{size:"small",icon:(0,i.jsx)(ti.CodeOutlined,{}),onClick:()=>M(!0),children:"Edit Code"})]}),(0,i.jsx)("div",{className:"relative rounded-lg overflow-hidden border border-gray-700 bg-[#1e1e1e]",children:(0,i.jsx)("pre",{className:"p-4 text-sm text-gray-200 overflow-x-auto",style:{fontFamily:"'Fira Code', 'Monaco', 'Consolas', monospace"},children:(0,i.jsx)("code",{children:o.litellm_params.custom_code})})})]}),(0,i.jsx)(ak,{guardrailData:o,guardrailSettings:S,isEditing:!1,accessToken:a})]}),n&&(0,i.jsx)(tc.TabPanel,{children:(0,i.jsxs)(eL.Card,{children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)(tu.Title,{children:"Guardrail Settings"}),V&&(0,i.jsx)(ef.Tooltip,{title:"Guardrail is defined in the config file and cannot be edited.",children:(0,i.jsx)(eM.InfoCircleOutlined,{})}),!y&&!V&&(o.litellm_params?.guardrail==="custom_code"?(0,i.jsx)(d.Button,{icon:(0,i.jsx)(ti.CodeOutlined,{}),onClick:()=>M(!0),children:"Edit Code"}):(0,i.jsx)(d.Button,{onClick:()=>j(!0),children:"Edit Settings"}))]}),y?(0,i.jsxs)(r.Form,{form:_,onFinish:q,initialValues:{guardrail_name:o.guardrail_name,...o.litellm_params,guardrail_info:o.guardrail_info?JSON.stringify(o.guardrail_info,null,2):"",...o.litellm_params?.optional_params&&{optional_params:o.litellm_params.optional_params}},layout:"vertical",children:[(0,i.jsx)(r.Form.Item,{label:"Guardrail Name",name:"guardrail_name",rules:[{required:!0,message:"Please input a guardrail name"}],children:(0,i.jsx)(l.Input,{placeholder:"Enter guardrail name"})}),(0,i.jsx)(r.Form.Item,{label:"Default On",name:"default_on",children:(0,i.jsxs)(s.Select,{children:[(0,i.jsx)(s.Select.Option,{value:!0,children:"Yes"}),(0,i.jsx)(s.Select.Option,{value:!1,children:"No"})]})}),o.litellm_params?.guardrail==="presidio"&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eF.Divider,{orientation:"left",children:"PII Protection"}),(0,i.jsx)("div",{className:"mb-6",children:S&&(0,i.jsx)(eP,{entities:S.supported_entities,actions:S.supported_actions,selectedEntities:v,selectedActions:C,onEntitySelect:e=>{b(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},onActionSelect:(e,t)=>{w(a=>({...a,[e]:t}))},entityCategories:S.pii_entity_categories})})]}),(0,i.jsx)(ak,{guardrailData:o,guardrailSettings:S,isEditing:!0,accessToken:a,onDataChange:$,onUnsavedChanges:O}),(o.litellm_params?.guardrail==="tool_permission"||g)&&(0,i.jsx)(eF.Divider,{orientation:"left",children:"Provider Settings"}),o.litellm_params?.guardrail==="tool_permission"?(0,i.jsx)(e$,{value:P,onChange:L}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eh,{selectedProvider:Object.keys(ea).find(e=>ea[e]===o.litellm_params?.guardrail)||null,accessToken:a,providerParams:g,value:o.litellm_params}),g&&(()=>{let e=Object.keys(ea).find(e=>ea[e]===o.litellm_params?.guardrail);if(!e)return null;let t=g[ea[e]?.toLowerCase()];return t&&t.optional_params?(0,i.jsx)(ep,{optionalParams:t.optional_params,parentFieldKey:"optional_params",values:o.litellm_params}):null})()]}),(0,i.jsx)(eF.Divider,{orientation:"left",children:"Advanced Settings"}),(0,i.jsx)(r.Form.Item,{label:"Guardrail Information",name:"guardrail_info",children:(0,i.jsx)(l.Input.TextArea,{rows:5})}),(0,i.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,i.jsx)(d.Button,{onClick:()=>{j(!1),O(!1),K()},children:"Cancel"}),(0,i.jsx)(d.Button,{type:"primary",htmlType:"submit",children:"Save Changes"})]})]}):(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"font-medium",children:"Guardrail ID"}),(0,i.jsx)("div",{className:"font-mono",children:o.guardrail_id})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"font-medium",children:"Guardrail Name"}),(0,i.jsx)("div",{children:o.guardrail_name||"Unnamed Guardrail"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"font-medium",children:"Provider"}),(0,i.jsx)("div",{children:W})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"font-medium",children:"Mode"}),(0,i.jsx)("div",{children:o.litellm_params?.mode||"-"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"font-medium",children:"Default On"}),(0,i.jsx)(e4.Badge,{color:o.litellm_params?.default_on?"green":"gray",children:o.litellm_params?.default_on?"Yes":"No"})]}),o.litellm_params?.pii_entities_config&&Object.keys(o.litellm_params.pii_entities_config).length>0&&(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"font-medium",children:"PII Protection"}),(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsxs)(e4.Badge,{color:"blue",children:[Object.keys(o.litellm_params.pii_entities_config).length," PII entities configured"]})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"font-medium",children:"Created At"}),(0,i.jsx)("div",{children:J(o.created_at)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eB.Text,{className:"font-medium",children:"Last Updated"}),(0,i.jsx)("div",{children:J(o.updated_at)})]}),o.litellm_params?.guardrail==="tool_permission"&&(0,i.jsx)(e$,{value:P,disabled:!0})]})]})})]})]}),(0,i.jsx)(aD,{visible:E,onClose:()=>M(!1),onSuccess:()=>{M(!1),R()},accessToken:a,editData:o?{guardrail_id:o.guardrail_id,guardrail_name:o.guardrail_name,litellm_params:o.litellm_params}:null})]})}],969641);var aG=e.i(573421),aK=e.i(19732),aq=e.i(928685),aJ=e.i(166406),aU=e.i(637235),aW=e.i(755151),aH=e.i(240647);let{Text:aV}=c.Typography,aY=function({results:e,errors:t}){let[a,r]=(0,u.useState)(new Set),l=e=>{let t=new Set(a);t.has(e)?t.delete(e):t.add(e),r(t)},n=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select();let a=document.execCommand("copy");if(document.body.removeChild(t),!a)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}};return e||t?(0,i.jsxs)("div",{className:"space-y-3 pt-4 border-t border-gray-200",children:[(0,i.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Results"}),e&&e.map(e=>{let t=a.has(e.guardrailName);return(0,i.jsx)(eL.Card,{className:"bg-green-50 border-green-200",children:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer flex-1",onClick:()=>l(e.guardrailName),children:[t?(0,i.jsx)(aH.RightOutlined,{className:"text-gray-500 text-xs"}):(0,i.jsx)(aW.DownOutlined,{className:"text-gray-500 text-xs"}),(0,i.jsx)(aA.CheckCircleOutlined,{className:"text-green-600 text-lg"}),(0,i.jsx)("span",{className:"text-sm font-medium text-green-800",children:e.guardrailName})]}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-600",children:[(0,i.jsx)(aU.ClockCircleOutlined,{}),(0,i.jsxs)("span",{className:"font-medium",children:[e.latency,"ms"]})]}),!t&&(0,i.jsx)(eQ.Button,{size:"xs",variant:"secondary",icon:aJ.CopyOutlined,onClick:async()=>{await n(e.response_text)?p.default.success("Result copied to clipboard"):p.default.fromBackend("Failed to copy result")},children:"Copy"})]})]}),!t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"bg-white border border-green-200 rounded p-3",children:[(0,i.jsx)("label",{className:"text-xs font-medium text-gray-600 mb-2 block",children:"Output Text"}),(0,i.jsx)("div",{className:"font-mono text-sm text-gray-900 whitespace-pre-wrap break-words",children:e.response_text})]}),(0,i.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,i.jsx)("span",{className:"font-medium",children:"Characters:"})," ",e.response_text.length]})]})]})},e.guardrailName)}),t&&t.map(e=>{let t=a.has(e.guardrailName);return(0,i.jsx)(eL.Card,{className:"bg-red-50 border-red-200",children:(0,i.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,i.jsx)("div",{className:"cursor-pointer mt-0.5",onClick:()=>l(e.guardrailName),children:t?(0,i.jsx)(aH.RightOutlined,{className:"text-gray-500 text-xs"}):(0,i.jsx)(aW.DownOutlined,{className:"text-gray-500 text-xs"})}),(0,i.jsx)("div",{className:"text-red-600 mt-0.5",children:(0,i.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,i.jsxs)("p",{className:"text-sm font-medium text-red-800 cursor-pointer",onClick:()=>l(e.guardrailName),children:[e.guardrailName," - Error"]}),(0,i.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-600",children:[(0,i.jsx)(aU.ClockCircleOutlined,{}),(0,i.jsxs)("span",{className:"font-medium",children:[e.latency,"ms"]})]})]}),!t&&(0,i.jsx)("p",{className:"text-sm text-red-700 mt-1",children:e.error.message})]})]})},e.guardrailName)})]}):null},{TextArea:aZ}=l.Input,{Text:aQ}=c.Typography,aX=function({guardrailNames:e,onSubmit:t,isLoading:a,results:r,errors:l,onClose:n}){let[s,o]=(0,u.useState)(""),c=()=>{s.trim()?t(s):p.default.fromBackend("Please enter text to test")},d=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select();let a=document.execCommand("copy");if(document.body.removeChild(t),!a)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}},m=async()=>{await d(s)?p.default.success("Input copied to clipboard"):p.default.fromBackend("Failed to copy input")};return(0,i.jsxs)("div",{className:"space-y-4 h-full flex flex-col",children:[(0,i.jsx)("div",{className:"flex items-center justify-between pb-3 border-b border-gray-200",children:(0,i.jsx)("div",{className:"flex items-center space-x-3",children:(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Test Guardrails:"}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(e=>(0,i.jsx)("div",{className:"inline-flex items-center space-x-1 bg-blue-50 px-3 py-1 rounded-md border border-blue-200",children:(0,i.jsx)("span",{className:"font-mono text-blue-700 font-medium text-sm",children:e})},e))})]}),(0,i.jsxs)("p",{className:"text-sm text-gray-500",children:["Test ",e.length>1?"guardrails":"guardrail"," and compare results"]})]})})}),(0,i.jsxs)("div",{className:"flex-1 overflow-auto space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Input Text"}),(0,i.jsx)(ef.Tooltip,{title:"Press Enter to submit. Use Shift+Enter for new line.",children:(0,i.jsx)(eM.InfoCircleOutlined,{className:"text-gray-400 cursor-help"})})]}),s&&(0,i.jsx)(eQ.Button,{size:"xs",variant:"secondary",icon:aJ.CopyOutlined,onClick:m,children:"Copy Input"})]}),(0,i.jsx)(aZ,{value:s,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||e.ctrlKey||e.metaKey||(e.preventDefault(),c())},placeholder:"Enter text to test with guardrails...",rows:8,className:"font-mono text-sm"}),(0,i.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,i.jsxs)(aQ,{className:"text-xs text-gray-500",children:["Press ",(0,i.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"Enter"})," to submit • ",(0,i.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"Shift+Enter"})," for new line"]}),(0,i.jsxs)(aQ,{className:"text-xs text-gray-500",children:["Characters: ",s.length]})]})]}),(0,i.jsx)("div",{className:"pt-2",children:(0,i.jsx)(eQ.Button,{onClick:c,loading:a,disabled:!s.trim(),className:"w-full",children:a?`Testing ${e.length} guardrail${e.length>1?"s":""}...`:`Test ${e.length} guardrail${e.length>1?"s":""}`})})]}),(0,i.jsx)(aY,{results:r,errors:l})]})]})};e.s(["default",0,({guardrailsList:e,isLoading:t,accessToken:a,onClose:r})=>{let[l,n]=(0,u.useState)(new Set),[s,o]=(0,u.useState)(""),[c,d]=(0,u.useState)([]),[g,h]=(0,u.useState)([]),[x,f]=(0,u.useState)(!1),y=e.filter(e=>e.guardrail_name?.toLowerCase().includes(s.toLowerCase())),j=e=>{let t=new Set(l);t.has(e)?t.delete(e):t.add(e),n(t)},_=async e=>{if(0===l.size||!a)return;f(!0),d([]),h([]);let t=[],i=[];await Promise.all(Array.from(l).map(async r=>{let l=Date.now();try{let i=await (0,m.applyGuardrail)(a,r,e,null,null),n=Date.now()-l;t.push({guardrailName:r,response_text:i.response_text,latency:n})}catch(t){let e=Date.now()-l;console.error(`Error testing guardrail ${r}:`,t),i.push({guardrailName:r,error:t,latency:e})}})),d(t),h(i),f(!1),t.length>0&&p.default.success(`${t.length} guardrail${t.length>1?"s":""} applied successfully`),i.length>0&&p.default.fromBackend(`${i.length} guardrail${i.length>1?"s":""} failed`)};return(0,i.jsx)("div",{className:"w-full h-[calc(100vh-200px)]",children:(0,i.jsx)(eL.Card,{className:"h-full",children:(0,i.jsxs)("div",{className:"flex h-full",children:[(0,i.jsxs)("div",{className:"w-1/4 border-r border-gray-200 flex flex-col overflow-hidden",children:[(0,i.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)(tu.Title,{className:"text-lg font-semibold mb-3",children:"Guardrails"}),(0,i.jsx)(e3.TextInput,{icon:aq.SearchOutlined,placeholder:"Search guardrails...",value:s,onValueChange:o})]})}),(0,i.jsx)("div",{className:"flex-1 overflow-auto",children:t?(0,i.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,i.jsx)(em.Spin,{})}):0===y.length?(0,i.jsx)("div",{className:"p-4",children:(0,i.jsx)(eE.Empty,{description:s?"No guardrails match your search":"No guardrails available"})}):(0,i.jsx)(aG.List,{dataSource:y,renderItem:e=>(0,i.jsx)(aG.List.Item,{onClick:()=>{e.guardrail_name&&j(e.guardrail_name)},className:`cursor-pointer hover:bg-gray-50 transition-colors px-4 ${l.has(e.guardrail_name||"")?"bg-blue-50 border-l-4 border-l-blue-500":"border-l-4 border-l-transparent"}`,children:(0,i.jsx)(aG.List.Item.Meta,{avatar:(0,i.jsx)(ex.Checkbox,{checked:l.has(e.guardrail_name||""),onClick:t=>{t.stopPropagation(),e.guardrail_name&&j(e.guardrail_name)}}),title:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(aK.ExperimentOutlined,{className:"text-gray-400"}),(0,i.jsx)("span",{className:"font-medium text-gray-900",children:e.guardrail_name})]}),description:(0,i.jsxs)("div",{className:"text-xs space-y-1 mt-1",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Type: "}),(0,i.jsx)("span",{className:"text-gray-600",children:e.litellm_params.guardrail})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Mode: "}),(0,i.jsx)("span",{className:"text-gray-600",children:e.litellm_params.mode})]})]})})})})}),(0,i.jsx)("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:(0,i.jsxs)(eB.Text,{className:"text-xs text-gray-600",children:[l.size," of ",y.length," selected"]})})]}),(0,i.jsxs)("div",{className:"w-3/4 flex flex-col bg-white",children:[(0,i.jsx)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:(0,i.jsx)(tu.Title,{className:"text-xl font-semibold mb-0",children:"Guardrail Testing Playground"})}),(0,i.jsx)("div",{className:"flex-1 overflow-auto p-4",children:0===l.size?(0,i.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,i.jsx)(aK.ExperimentOutlined,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,i.jsx)(eB.Text,{className:"text-lg font-medium text-gray-600 mb-2",children:"Select Guardrails to Test"}),(0,i.jsx)(eB.Text,{className:"text-center text-gray-500 max-w-md",children:"Choose one or more guardrails from the left sidebar to start testing and comparing results."})]}):(0,i.jsx)("div",{className:"h-full",children:(0,i.jsx)(aX,{guardrailNames:Array.from(l),onSubmit:_,results:c.length>0?c:null,errors:g.length>0?g:null,isLoading:x,onClose:()=>n(new Set)})})})]})]})})})}],476993),e.s([],824296),e.s(["CustomCodeModal",0,aD],64352);let a0={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"};var a1=u.forwardRef(function(e,t){return u.createElement(eC.default,(0,ev.default)({},e,{ref:t,icon:a0}))});e.s(["ArrowRightOutlined",0,a1],266537);let a2="../ui/assets/logos/",a4=[{id:"cf_denied_financial",name:"Denied Financial Advice",description:"Detects requests for personalized financial advice, investment recommendations, or financial planning.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Topic Blocker"],eval:{f1:100,precision:100,recall:100,testCases:207,latency:"<0.1ms"}},{id:"cf_denied_insults",name:"Insults & Personal Attacks",description:"Detects insults, name-calling, and personal attacks directed at the chatbot, staff, or other people.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Topic Blocker"],eval:{f1:100,precision:100,recall:100,testCases:299,latency:"<0.1ms"}},{id:"cf_denied_legal",name:"Denied Legal Advice",description:"Detects requests for unauthorized legal advice, case analysis, or legal recommendations.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Topic Blocker"]},{id:"cf_denied_medical",name:"Denied Medical Advice",description:"Detects requests for medical diagnosis, treatment recommendations, or health advice.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Topic Blocker"]},{id:"cf_harmful_violence",name:"Harmful Violence",description:"Detects content related to violence, criminal planning, attacks, and violent threats.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Safety"]},{id:"cf_harmful_self_harm",name:"Harmful Self-Harm",description:"Detects content related to self-harm, suicide, and dangerous self-destructive behavior.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Safety"]},{id:"cf_harmful_child_safety",name:"Harmful Child Safety",description:"Detects content that could endanger child safety or exploit minors.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Safety"]},{id:"cf_harmful_illegal_weapons",name:"Harmful Illegal Weapons",description:"Detects content related to illegal weapons manufacturing, distribution, or acquisition.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Safety"]},{id:"cf_bias_gender",name:"Bias: Gender",description:"Detects gender-based discrimination, stereotypes, and biased language.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Bias"]},{id:"cf_bias_racial",name:"Bias: Racial",description:"Detects racial discrimination, stereotypes, and racially biased content.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Bias"]},{id:"cf_bias_religious",name:"Bias: Religious",description:"Detects religious discrimination, intolerance, and religiously biased content.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Bias"]},{id:"cf_bias_sexual_orientation",name:"Bias: Sexual Orientation",description:"Detects discrimination based on sexual orientation and related biased content.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Bias"]},{id:"cf_prompt_injection_jailbreak",name:"Prompt Injection: Jailbreak",description:"Detects jailbreak attempts designed to bypass AI safety guidelines and restrictions.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Prompt Injection"]},{id:"cf_prompt_injection_data_exfil",name:"Prompt Injection: Data Exfiltration",description:"Detects attempts to extract sensitive data through prompt manipulation.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Prompt Injection"]},{id:"cf_prompt_injection_sql",name:"Prompt Injection: SQL",description:"Detects SQL injection attempts embedded in prompts.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Prompt Injection"]},{id:"cf_prompt_injection_malicious_code",name:"Prompt Injection: Malicious Code",description:"Detects attempts to inject malicious code through prompts.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Prompt Injection"]},{id:"cf_prompt_injection_system_prompt",name:"Prompt Injection: System Prompt",description:"Detects attempts to extract or override system prompts.",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Prompt Injection"]},{id:"cf_toxic_abuse",name:"Toxic & Abusive Language",description:"Detects toxic, abusive, and hateful language across multiple languages (EN, AU, DE, ES, FR).",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Toxicity"]},{id:"cf_patterns",name:"Pattern Matching",description:"Detect and block sensitive data patterns like SSNs, credit card numbers, API keys, and custom regex patterns.",category:"litellm",subcategory:"Patterns",logo:`${a2}litellm_logo.jpg`,tags:["PII","Regex","Data Protection"]},{id:"cf_keywords",name:"Keyword Blocking",description:"Block or mask content containing specific keywords or phrases. Upload custom word lists or add individual terms.",category:"litellm",subcategory:"Keywords",logo:`${a2}litellm_logo.jpg`,tags:["Keywords","Blocklist"]},{id:"block_code_execution",name:"Block Code Execution",description:"Detects markdown fenced code blocks in requests and responses. Block or mask executable code (e.g. Python, JavaScript, Bash) by language with configurable confidence.",category:"litellm",subcategory:"Code Safety",logo:`${a2}litellm_logo.jpg`,tags:["Code","Safety","Prompt Injection"]},{id:"cf_competitor_intent",name:"Competitor Name Blocking",description:"Block or reframe competitor comparison and ranking intent. Detect when users ask to compare or recommend competitors (airline or generic competitor lists).",category:"litellm",subcategory:"Content Category",logo:`${a2}litellm_logo.jpg`,tags:["Content Category","Competitor","Topic Blocker"]},{id:"presidio",name:"Presidio PII",description:"Microsoft Presidio for PII detection and anonymization. Supports 30+ entity types with configurable actions.",category:"partner",logo:`${a2}microsoft_azure.svg`,tags:["PII","Microsoft"],providerKey:"PresidioPII"},{id:"bedrock",name:"Bedrock Guardrail",description:"AWS Bedrock Guardrails for content filtering, topic avoidance, and sensitive information detection.",category:"partner",logo:`${a2}bedrock.svg`,tags:["AWS","Content Safety"],providerKey:"Bedrock"},{id:"lakera",name:"Lakera",description:"AI security platform protecting against prompt injections, data leakage, and harmful content.",category:"partner",logo:`${a2}lakeraai.jpeg`,tags:["Security","Prompt Injection"],providerKey:"Lakera"},{id:"openai_moderation",name:"OpenAI Moderation",description:"OpenAI's content moderation API for detecting harmful content across multiple categories.",category:"partner",logo:`${a2}openai_small.svg`,tags:["Content Moderation","OpenAI"]},{id:"google_model_armor",name:"Google Cloud Model Armor",description:"Google Cloud's model protection service for safe and responsible AI deployments.",category:"partner",logo:`${a2}google.svg`,tags:["Google Cloud","Safety"]},{id:"guardrails_ai",name:"Guardrails AI",description:"Open-source framework for adding structural, type, and quality guarantees to LLM outputs.",category:"partner",logo:`${a2}guardrails_ai.jpeg`,tags:["Open Source","Validation"]},{id:"zscaler",name:"Zscaler AI Guard",description:"Enterprise AI security from Zscaler for monitoring and protecting AI/ML workloads.",category:"partner",logo:`${a2}zscaler.svg`,tags:["Enterprise","Security"]},{id:"panw",name:"PANW Prisma AIRS",description:"Palo Alto Networks Prisma AI Runtime Security for securing AI applications in production.",category:"partner",logo:`${a2}palo_alto_networks.jpeg`,tags:["Enterprise","Security"]},{id:"noma",name:"Noma Security",description:"AI security platform for detecting and preventing AI-specific threats and vulnerabilities.",category:"partner",logo:`${a2}noma_security.png`,tags:["Security","Threat Detection"]},{id:"aporia",name:"Aporia AI",description:"Real-time AI guardrails for hallucination detection, topic control, and policy enforcement.",category:"partner",logo:`${a2}aporia.png`,tags:["Hallucination","Policy"]},{id:"aim",name:"AIM Guardrail",description:"AIM Security guardrails for comprehensive AI threat detection and mitigation.",category:"partner",logo:`${a2}aim_security.jpeg`,tags:["Security","Threat Detection"]},{id:"prompt_security",name:"Prompt Security",description:"Protect against prompt injection attacks, data leakage, and other LLM security threats.",category:"partner",logo:`${a2}prompt_security.png`,tags:["Prompt Injection","Security"]},{id:"lasso",name:"Lasso Guardrail",description:"Content moderation and safety guardrails for responsible AI deployments.",category:"partner",logo:`${a2}lasso.png`,tags:["Content Moderation"]},{id:"pangea",name:"Pangea Guardrail",description:"Pangea's AI guardrails for secure, compliant, and trustworthy AI applications.",category:"partner",logo:`${a2}pangea.png`,tags:["Compliance","Security"]},{id:"enkryptai",name:"EnkryptAI",description:"AI security and governance platform for enterprise AI safety and compliance.",category:"partner",logo:`${a2}enkrypt_ai.avif`,tags:["Enterprise","Governance"]},{id:"javelin",name:"Javelin Guardrails",description:"AI gateway with built-in guardrails for secure and compliant AI operations.",category:"partner",logo:`${a2}javelin.png`,tags:["Gateway","Security"]},{id:"pillar",name:"Pillar Guardrail",description:"AI safety platform for monitoring, testing, and securing AI systems.",category:"partner",logo:`${a2}pillar.jpeg`,tags:["Monitoring","Safety"]}];e.s(["ALL_CARDS",0,a4],230312)},826910,e=>{"use strict";var t=e.i(201072);e.s(["CheckCircleFilled",()=>t.default])},487304,e=>{"use strict";var t=e.i(843476),a=e.i(271645),i=e.i(994388),r=e.i(653824),l=e.i(881073),n=e.i(197647),s=e.i(723731),o=e.i(404206),c=e.i(326373),d=e.i(755151),u=e.i(646563),p=e.i(245094),m=e.i(764205),g=e.i(185357),h=e.i(782719),x=e.i(708347),f=e.i(969641),y=e.i(476993),j=e.i(727749),_=e.i(127952),v=e.i(180766);e.i(824296);var b=e.i(64352),C=e.i(311451),w=e.i(928685),S=e.i(266537),k=e.i(230312),N=e.i(826910);let A=({src:e,name:i})=>{let[r,l]=(0,a.useState)(!1);return r||!e?(0,t.jsx)("div",{style:{width:28,height:28,borderRadius:6,backgroundColor:"#e5e7eb",display:"flex",alignItems:"center",justifyContent:"center",fontSize:13,fontWeight:600,color:"#6b7280",flexShrink:0},children:i?.charAt(0)||"?"}):(0,t.jsx)("img",{src:e,alt:"",style:{width:28,height:28,borderRadius:6,objectFit:"contain",flexShrink:0},onError:()=>l(!0)})},I=({card:e,onClick:i})=>{let[r,l]=(0,a.useState)(!1);return(0,t.jsxs)("div",{onClick:i,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),style:{borderRadius:12,border:r?"1px solid #93c5fd":"1px solid #e5e7eb",backgroundColor:"#ffffff",padding:"20px 20px 16px 20px",cursor:"pointer",transition:"border-color 0.15s, box-shadow 0.15s",display:"flex",flexDirection:"column",minHeight:170,boxShadow:r?"0 1px 6px rgba(59,130,246,0.08)":"none"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[(0,t.jsx)(A,{src:e.logo,name:e.name}),(0,t.jsx)("span",{style:{fontSize:14,fontWeight:600,color:"#111827",lineHeight:1.3},children:e.name})]}),(0,t.jsx)("p",{className:"line-clamp-3",style:{fontSize:12,color:"#6b7280",lineHeight:1.6,margin:0,flex:1},children:e.description}),e.eval&&(0,t.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"center",gap:4},children:[(0,t.jsx)(N.CheckCircleFilled,{style:{color:"#16a34a",fontSize:12}}),(0,t.jsxs)("span",{style:{fontSize:11,color:"#16a34a",fontWeight:500},children:["F1: ",e.eval.f1,"% · ",e.eval.testCases," test cases"]})]})]})};var O=e.i(464571),T=e.i(447566);let P={cf_denied_financial:{provider:"LitellmContentFilter",categoryName:"denied_financial_advice",guardrailNameSuggestion:"Denied Financial Advice",mode:"pre_call",defaultOn:!1},cf_denied_legal:{provider:"LitellmContentFilter",categoryName:"denied_legal_advice",guardrailNameSuggestion:"Denied Legal Advice",mode:"pre_call",defaultOn:!1},cf_denied_medical:{provider:"LitellmContentFilter",categoryName:"denied_medical_advice",guardrailNameSuggestion:"Denied Medical Advice",mode:"pre_call",defaultOn:!1},cf_denied_insults:{provider:"LitellmContentFilter",categoryName:"denied_insults",guardrailNameSuggestion:"Insults & Personal Attacks",mode:"pre_call",defaultOn:!1},cf_harmful_violence:{provider:"LitellmContentFilter",categoryName:"harmful_violence",guardrailNameSuggestion:"Harmful Violence",mode:"pre_call",defaultOn:!1},cf_harmful_self_harm:{provider:"LitellmContentFilter",categoryName:"harmful_self_harm",guardrailNameSuggestion:"Harmful Self-Harm",mode:"pre_call",defaultOn:!1},cf_harmful_child_safety:{provider:"LitellmContentFilter",categoryName:"harmful_child_safety",guardrailNameSuggestion:"Harmful Child Safety",mode:"pre_call",defaultOn:!1},cf_harmful_illegal_weapons:{provider:"LitellmContentFilter",categoryName:"harmful_illegal_weapons",guardrailNameSuggestion:"Harmful Illegal Weapons",mode:"pre_call",defaultOn:!1},cf_bias_gender:{provider:"LitellmContentFilter",categoryName:"bias_gender",guardrailNameSuggestion:"Bias: Gender",mode:"pre_call",defaultOn:!1},cf_bias_racial:{provider:"LitellmContentFilter",categoryName:"bias_racial",guardrailNameSuggestion:"Bias: Racial",mode:"pre_call",defaultOn:!1},cf_bias_religious:{provider:"LitellmContentFilter",categoryName:"bias_religious",guardrailNameSuggestion:"Bias: Religious",mode:"pre_call",defaultOn:!1},cf_bias_sexual_orientation:{provider:"LitellmContentFilter",categoryName:"bias_sexual_orientation",guardrailNameSuggestion:"Bias: Sexual Orientation",mode:"pre_call",defaultOn:!1},cf_prompt_injection_jailbreak:{provider:"LitellmContentFilter",categoryName:"prompt_injection_jailbreak",guardrailNameSuggestion:"Prompt Injection: Jailbreak",mode:"pre_call",defaultOn:!1},cf_prompt_injection_data_exfil:{provider:"LitellmContentFilter",categoryName:"prompt_injection_data_exfiltration",guardrailNameSuggestion:"Prompt Injection: Data Exfiltration",mode:"pre_call",defaultOn:!1},cf_prompt_injection_sql:{provider:"LitellmContentFilter",categoryName:"prompt_injection_sql",guardrailNameSuggestion:"Prompt Injection: SQL",mode:"pre_call",defaultOn:!1},cf_prompt_injection_malicious_code:{provider:"LitellmContentFilter",categoryName:"prompt_injection_malicious_code",guardrailNameSuggestion:"Prompt Injection: Malicious Code",mode:"pre_call",defaultOn:!1},cf_prompt_injection_system_prompt:{provider:"LitellmContentFilter",categoryName:"prompt_injection_system_prompt",guardrailNameSuggestion:"Prompt Injection: System Prompt",mode:"pre_call",defaultOn:!1},cf_toxic_abuse:{provider:"LitellmContentFilter",categoryName:"harm_toxic_abuse",guardrailNameSuggestion:"Toxic & Abusive Language",mode:"pre_call",defaultOn:!1},cf_patterns:{provider:"LitellmContentFilter",guardrailNameSuggestion:"Pattern Matching",mode:"pre_call",defaultOn:!1},cf_keywords:{provider:"LitellmContentFilter",guardrailNameSuggestion:"Keyword Blocking",mode:"pre_call",defaultOn:!1},block_code_execution:{provider:"BlockCodeExecution",guardrailNameSuggestion:"Block Code Execution",mode:"pre_call",defaultOn:!1},cf_competitor_intent:{provider:"LitellmContentFilter",guardrailNameSuggestion:"Competitor Name Blocking",mode:"pre_call",defaultOn:!1},presidio:{provider:"PresidioPII",guardrailNameSuggestion:"Presidio PII",mode:"pre_call",defaultOn:!1},bedrock:{provider:"Bedrock",guardrailNameSuggestion:"Bedrock Guardrail",mode:"pre_call",defaultOn:!1},lakera:{provider:"Lakera",guardrailNameSuggestion:"Lakera",mode:"pre_call",defaultOn:!1},openai_moderation:{provider:"OpenaiModeration",guardrailNameSuggestion:"OpenAI Moderation",mode:"pre_call",defaultOn:!1},google_model_armor:{provider:"ModelArmor",guardrailNameSuggestion:"Google Cloud Model Armor",mode:"pre_call",defaultOn:!1},guardrails_ai:{provider:"GuardrailsAi",guardrailNameSuggestion:"Guardrails AI",mode:"pre_call",defaultOn:!1},zscaler:{provider:"ZscalerAiGuard",guardrailNameSuggestion:"Zscaler AI Guard",mode:"pre_call",defaultOn:!1},panw:{provider:"PanwPrismaAirs",guardrailNameSuggestion:"PANW Prisma AIRS",mode:"pre_call",defaultOn:!1},noma:{provider:"Noma",guardrailNameSuggestion:"Noma Security",mode:"pre_call",defaultOn:!1},aporia:{provider:"AporiaAi",guardrailNameSuggestion:"Aporia AI",mode:"pre_call",defaultOn:!1},aim:{provider:"Aim",guardrailNameSuggestion:"AIM Guardrail",mode:"pre_call",defaultOn:!1},prompt_security:{provider:"PromptSecurity",guardrailNameSuggestion:"Prompt Security",mode:"pre_call",defaultOn:!1},lasso:{provider:"Lasso",guardrailNameSuggestion:"Lasso Guardrail",mode:"pre_call",defaultOn:!1},pangea:{provider:"Pangea",guardrailNameSuggestion:"Pangea Guardrail",mode:"pre_call",defaultOn:!1},enkryptai:{provider:"Enkryptai",guardrailNameSuggestion:"EnkryptAI",mode:"pre_call",defaultOn:!1},javelin:{provider:"Javelin",guardrailNameSuggestion:"Javelin Guardrails",mode:"pre_call",defaultOn:!1},pillar:{provider:"Pillar",guardrailNameSuggestion:"Pillar Guardrail",mode:"pre_call",defaultOn:!1}},L=({card:e,onBack:i,accessToken:r,onGuardrailCreated:l})=>{let[n,s]=(0,a.useState)(!1),[o,c]=(0,a.useState)("overview"),d=[{property:"Provider",value:"litellm"===e.category?"LiteLLM Content Filter":"Partner Guardrail"},...e.subcategory?[{property:"Subcategory",value:e.subcategory}]:[],..."litellm"===e.category?[{property:"Cost",value:"$0 / request"}]:[],..."litellm"===e.category?[{property:"External Dependencies",value:"None"}]:[],..."litellm"===e.category?[{property:"Latency",value:e.eval?.latency||"<1ms"}]:[]],u=e.eval?[{metric:"Precision",value:`${e.eval.precision}%`},{metric:"Recall",value:`${e.eval.recall}%`},{metric:"F1 Score",value:`${e.eval.f1}%`},{metric:"Test Cases",value:String(e.eval.testCases)},{metric:"False Positives",value:"0"},{metric:"False Negatives",value:"0"},{metric:"Latency (p50)",value:e.eval.latency}]:[],p=[{key:"overview",label:"Overview"},...e.eval?[{key:"eval",label:"Eval Results"}]:[]];return(0,t.jsxs)("div",{style:{maxWidth:960,margin:"0 auto"},children:[(0,t.jsxs)("div",{onClick:i,style:{display:"inline-flex",alignItems:"center",gap:6,color:"#5f6368",cursor:"pointer",fontSize:14,marginBottom:24},children:[(0,t.jsx)(T.ArrowLeftOutlined,{style:{fontSize:11}}),(0,t.jsx)("span",{children:e.name})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:8},children:[(0,t.jsx)("img",{src:e.logo,alt:"",style:{width:40,height:40,borderRadius:8,objectFit:"contain"},onError:e=>{e.target.style.display="none"}}),(0,t.jsx)("h1",{style:{fontSize:28,fontWeight:400,color:"#202124",margin:0,lineHeight:1.2},children:e.name})]}),(0,t.jsx)("p",{style:{fontSize:14,color:"#5f6368",margin:"0 0 20px 0",lineHeight:1.6},children:e.description}),(0,t.jsx)("div",{style:{display:"flex",gap:10,marginBottom:32},children:(0,t.jsx)(O.Button,{onClick:()=>s(!0),style:{borderRadius:20,padding:"4px 20px",height:36,borderColor:"#dadce0",color:"#1a73e8",fontWeight:500,fontSize:14},children:"Create Guardrail"})}),(0,t.jsx)("div",{style:{borderBottom:"1px solid #dadce0",marginBottom:28},children:(0,t.jsx)("div",{style:{display:"flex",gap:0},children:p.map(e=>(0,t.jsx)("div",{onClick:()=>c(e.key),style:{padding:"12px 20px",fontSize:14,color:o===e.key?"#1a73e8":"#5f6368",borderBottom:o===e.key?"3px solid #1a73e8":"3px solid transparent",cursor:"pointer",fontWeight:o===e.key?500:400,marginBottom:-1},children:e.label},e.key))})}),"overview"===o&&(0,t.jsxs)("div",{style:{display:"flex",gap:64},children:[(0,t.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,t.jsx)("h2",{style:{fontSize:18,fontWeight:400,color:"#202124",margin:"0 0 12px 0"},children:"Overview"}),(0,t.jsx)("p",{style:{fontSize:14,color:"#3c4043",lineHeight:1.7,margin:"0 0 32px 0"},children:e.description}),(0,t.jsx)("h2",{style:{fontSize:18,fontWeight:400,color:"#202124",margin:"0 0 4px 0"},children:"Guardrail Details"}),(0,t.jsx)("p",{style:{fontSize:13,color:"#5f6368",margin:"0 0 16px 0"},children:"Details are as follows"}),(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{borderBottom:"1px solid #dadce0"},children:[(0,t.jsx)("th",{style:{textAlign:"left",padding:"12px 0",color:"#5f6368",fontWeight:500,width:200},children:"Property"}),(0,t.jsx)("th",{style:{textAlign:"left",padding:"12px 0",color:"#5f6368",fontWeight:500},children:e.name})]})}),(0,t.jsx)("tbody",{children:d.map((e,a)=>(0,t.jsxs)("tr",{style:{borderBottom:"1px solid #f1f3f4"},children:[(0,t.jsx)("td",{style:{padding:"12px 0",color:"#3c4043"},children:e.property}),(0,t.jsx)("td",{style:{padding:"12px 0",color:"#202124"},children:e.value})]},a))})]})]}),(0,t.jsxs)("div",{style:{width:240,flexShrink:0},children:[(0,t.jsxs)("div",{style:{marginBottom:28},children:[(0,t.jsx)("div",{style:{fontSize:12,color:"#5f6368",marginBottom:4},children:"Guardrail ID"}),(0,t.jsxs)("div",{style:{fontSize:13,color:"#202124",wordBreak:"break-all"},children:["litellm/",e.id]})]}),(0,t.jsxs)("div",{style:{marginBottom:28},children:[(0,t.jsx)("div",{style:{fontSize:12,color:"#5f6368",marginBottom:4},children:"Type"}),(0,t.jsx)("div",{style:{fontSize:13,color:"#202124"},children:"litellm"===e.category?"Content Filter":"Partner"})]}),e.tags.length>0&&(0,t.jsxs)("div",{style:{marginBottom:28},children:[(0,t.jsx)("div",{style:{fontSize:12,color:"#5f6368",marginBottom:8},children:"Tags"}),(0,t.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:e.tags.map(e=>(0,t.jsx)("span",{style:{fontSize:12,padding:"4px 12px",borderRadius:16,border:"1px solid #dadce0",color:"#3c4043",backgroundColor:"#fff"},children:e},e))})]})]})]}),"eval"===o&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{style:{fontSize:18,fontWeight:400,color:"#202124",margin:"0 0 16px 0"},children:"Eval Results"}),(0,t.jsxs)("table",{style:{width:"100%",maxWidth:560,borderCollapse:"collapse",fontSize:14},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{backgroundColor:"#f8f9fa",borderBottom:"1px solid #dadce0"},children:[(0,t.jsx)("th",{style:{textAlign:"left",padding:"12px 16px",color:"#5f6368",fontWeight:500},children:"Metric"}),(0,t.jsx)("th",{style:{textAlign:"left",padding:"12px 16px",color:"#5f6368",fontWeight:500},children:"Value"})]})}),(0,t.jsx)("tbody",{children:u.map((e,a)=>(0,t.jsxs)("tr",{style:{borderBottom:"1px solid #f1f3f4"},children:[(0,t.jsx)("td",{style:{padding:"12px 16px",color:"#3c4043"},children:e.metric}),(0,t.jsx)("td",{style:{padding:"12px 16px",color:"#202124",fontWeight:500},children:e.value})]},a))})]})]}),(0,t.jsx)(g.default,{visible:n,onClose:()=>s(!1),accessToken:r,onSuccess:()=>{s(!1),l()},preset:P[e.id]})]})},B=({accessToken:e,onGuardrailCreated:i})=>{let[r,l]=(0,a.useState)(""),[n,s]=(0,a.useState)(null),[o,c]=(0,a.useState)(!1),d=k.ALL_CARDS.filter(e=>{if(!r)return!0;let t=r.toLowerCase();return e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t))}),u=d.filter(e=>"litellm"===e.category),p=d.filter(e=>"partner"===e.category);return n?(0,t.jsx)(L,{card:n,onBack:()=>s(null),accessToken:e,onGuardrailCreated:i}):(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{marginBottom:24},children:(0,t.jsx)(C.Input,{size:"large",placeholder:"Search guardrails",prefix:(0,t.jsx)(w.SearchOutlined,{style:{color:"#9ca3af"}}),value:r,onChange:e=>l(e.target.value),style:{borderRadius:8}})}),(0,t.jsxs)("div",{style:{marginBottom:40},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:4},children:[(0,t.jsx)("h2",{style:{fontSize:20,fontWeight:600,color:"#111827",margin:0},children:"LiteLLM Content Filter"}),(0,t.jsx)("span",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:14,color:"#1a73e8",cursor:"pointer"},onClick:()=>c(!o),children:o?(0,t.jsx)(t.Fragment,{children:"Show less"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.ArrowRightOutlined,{style:{fontSize:12}}),`Show all (${u.length})`]})})]}),(0,t.jsx)("p",{style:{fontSize:13,color:"#6b7280",margin:"4px 0 20px 0"},children:"Built-in guardrails powered by LiteLLM. Zero latency, no external dependencies, no additional cost."}),(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:16},children:(o?u:u.slice(0,10)).map(e=>(0,t.jsx)(I,{card:e,onClick:()=>s(e)},e.id))})]}),(0,t.jsxs)("div",{style:{marginBottom:40},children:[(0,t.jsx)("h2",{style:{fontSize:20,fontWeight:600,color:"#111827",margin:"0 0 4px 0"},children:"Partner Guardrails"}),(0,t.jsx)("p",{style:{fontSize:13,color:"#6b7280",margin:"4px 0 20px 0"},children:"Third-party guardrail integrations from leading AI security providers."}),(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:16},children:p.map(e=>(0,t.jsx)(I,{card:e,onClick:()=>s(e)},e.id))})]})]})};e.s(["default",0,({accessToken:e,userRole:C})=>{let[w,S]=(0,a.useState)([]),[k,N]=(0,a.useState)(!1),[A,I]=(0,a.useState)(!1),[O,T]=(0,a.useState)(!1),[P,L]=(0,a.useState)(!1),[F,E]=(0,a.useState)(null),[M,z]=(0,a.useState)(!1),[$,R]=(0,a.useState)(null),[D,G]=(0,a.useState)(0),K=!!C&&(0,x.isAdminRole)(C),q=async()=>{if(e){T(!0);try{let t=await (0,m.getGuardrailsList)(e);console.log(`guardrails: ${JSON.stringify(t)}`),S(t.guardrails)}catch(e){console.error("Error fetching guardrails:",e)}finally{T(!1)}}};(0,a.useEffect)(()=>{q()},[e]);let J=()=>{q()},U=async()=>{if(F&&e){L(!0);try{await (0,m.deleteGuardrailCall)(e,F.guardrail_id),j.default.success(`Guardrail "${F.guardrail_name}" deleted successfully`),await q()}catch(e){console.error("Error deleting guardrail:",e),j.default.fromBackend("Failed to delete guardrail")}finally{L(!1),z(!1),E(null)}}},W=F&&F.litellm_params?(0,v.getGuardrailLogoAndName)(F.litellm_params.guardrail).displayName:void 0;return(0,t.jsx)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:(0,t.jsxs)(r.TabGroup,{index:D,onIndexChange:G,children:[(0,t.jsxs)(l.TabList,{className:"mb-4",children:[(0,t.jsx)(n.Tab,{children:"Guardrail Garden"}),(0,t.jsx)(n.Tab,{children:"Guardrails"}),(0,t.jsx)(n.Tab,{disabled:!e||0===w.length,children:"Test Playground"})]}),(0,t.jsxs)(s.TabPanels,{children:[(0,t.jsx)(o.TabPanel,{children:(0,t.jsx)(B,{accessToken:e,onGuardrailCreated:J})}),(0,t.jsxs)(o.TabPanel,{children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,t.jsx)(c.Dropdown,{menu:{items:[{key:"provider",icon:(0,t.jsx)(u.PlusOutlined,{}),label:"Add Provider Guardrail",onClick:()=>{$&&R(null),N(!0)}},{key:"custom_code",icon:(0,t.jsx)(p.CodeOutlined,{}),label:"Create Custom Code Guardrail",onClick:()=>{$&&R(null),I(!0)}}]},trigger:["click"],disabled:!e,children:(0,t.jsxs)(i.Button,{disabled:!e,children:["+ Add New Guardrail ",(0,t.jsx)(d.DownOutlined,{className:"ml-2"})]})})}),$?(0,t.jsx)(f.default,{guardrailId:$,onClose:()=>R(null),accessToken:e,isAdmin:K}):(0,t.jsx)(h.default,{guardrailsList:w,isLoading:O,onDeleteClick:(e,t)=>{E(w.find(t=>t.guardrail_id===e)||null),z(!0)},accessToken:e,onGuardrailUpdated:q,isAdmin:K,onGuardrailClick:e=>R(e)}),(0,t.jsx)(g.default,{visible:k,onClose:()=>{N(!1)},accessToken:e,onSuccess:J}),(0,t.jsx)(b.CustomCodeModal,{visible:A,onClose:()=>{I(!1)},accessToken:e,onSuccess:J}),(0,t.jsx)(_.default,{isOpen:M,title:"Delete Guardrail",message:`Are you sure you want to delete guardrail: ${F?.guardrail_name}? This action cannot be undone.`,resourceInformationTitle:"Guardrail Information",resourceInformation:[{label:"Name",value:F?.guardrail_name},{label:"ID",value:F?.guardrail_id,code:!0},{label:"Provider",value:W},{label:"Mode",value:F?.litellm_params.mode},{label:"Default On",value:F?.litellm_params.default_on?"Yes":"No"}],onCancel:()=>{z(!1),E(null)},onOk:U,confirmLoading:P})]}),(0,t.jsx)(o.TabPanel,{children:(0,t.jsx)(y.default,{guardrailsList:w,isLoading:O,accessToken:e,onClose:()=>G(0)})})]})]})})}],487304)}]);