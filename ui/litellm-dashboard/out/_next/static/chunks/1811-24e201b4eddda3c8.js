"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1811],{1309:function(e,t,l){l.d(t,{C:function(){return a.Z}});var a=l(41649)},13271:function(e,t,l){l.d(t,{Z:function(){return r.Z},z:function(){return a.Z}});var a=l(78489),r=l(12514)},71618:function(e,t,l){l.d(t,{OK:function(){return r.Z},nP:function(){return o.Z},td:function(){return n.Z},v0:function(){return i.Z},x4:function(){return s.Z},zx:function(){return a.Z}});var a=l(78489),r=l(12485),i=l(18135),n=l(35242),s=l(29706),o=l(77991)},51811:function(e,t,l){l.d(t,{Z:function(){return ls}});var a,r,i,n,s=l(57437),o=l(2265),d=l(71618),c=l(73705),m=l(96473),u=l(11894),p=l(70464),g=l(19250),x=l(57840),h=l(37592),f=l(10032),y=l(4260),v=l(3810),j=l(5545),_=l(22116),b=l(9114),C=l(5945),N=l(55590),w=l(65319),S=l(3632);let{Text:k}=x.default,{Option:Z}=h.default;var P=e=>{let{visible:t,prebuiltPatterns:l,categories:a,selectedPatternName:r,patternAction:i,onPatternNameChange:n,onActionChange:o,onAdd:d,onCancel:c}=e;return(0,s.jsxs)(_.Z,{title:"Add prebuilt pattern",open:t,onCancel:c,footer:null,width:800,children:[(0,s.jsxs)(N.Z,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(k,{strong:!0,children:"Pattern type"}),(0,s.jsx)(h.default,{placeholder:"Choose pattern type",value:r,onChange:n,style:{width:"100%",marginTop:8},showSearch:!0,filterOption:(e,t)=>{let a=l.find(e=>e.name===(null==t?void 0:t.value));return!!a&&(a.display_name.toLowerCase().includes(e.toLowerCase())||a.name.toLowerCase().includes(e.toLowerCase()))},children:a.map(e=>{let t=l.filter(t=>t.category===e);return 0===t.length?null:(0,s.jsx)(h.default.OptGroup,{label:e,children:t.map(e=>(0,s.jsx)(Z,{value:e.name,children:e.display_name},e.name))},e)})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(k,{strong:!0,children:"Action"}),(0,s.jsx)(k,{type:"secondary",style:{display:"block",marginTop:4,marginBottom:8},children:"Choose what action the guardrail should take when this pattern is detected"}),(0,s.jsxs)(h.default,{value:i,onChange:o,style:{width:"100%"},children:[(0,s.jsx)(Z,{value:"BLOCK",children:"Block"}),(0,s.jsx)(Z,{value:"MASK",children:"Mask"})]})]})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"24px"},children:[(0,s.jsx)(j.ZP,{onClick:c,children:"Cancel"}),(0,s.jsx)(j.ZP,{type:"primary",onClick:d,children:"Add"})]})]})};let{Text:I}=x.default,{Option:A}=h.default;var O=e=>{let{visible:t,patternName:l,patternRegex:a,patternAction:r,onNameChange:i,onRegexChange:n,onActionChange:o,onAdd:d,onCancel:c}=e;return(0,s.jsxs)(_.Z,{title:"Add custom regex pattern",open:t,onCancel:c,footer:null,width:800,children:[(0,s.jsxs)(N.Z,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(I,{strong:!0,children:"Pattern name"}),(0,s.jsx)(y.default,{placeholder:"e.g., internal_id, employee_code",value:l,onChange:e=>i(e.target.value),style:{marginTop:8}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(I,{strong:!0,children:"Regex pattern"}),(0,s.jsx)(y.default,{placeholder:"e.g., ID-[0-9]{6}",value:a,onChange:e=>n(e.target.value),style:{marginTop:8}}),(0,s.jsx)(I,{type:"secondary",style:{fontSize:12},children:"Enter a valid regular expression to match sensitive data"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(I,{strong:!0,children:"Action"}),(0,s.jsx)(I,{type:"secondary",style:{display:"block",marginTop:4,marginBottom:8},children:"Choose what action the guardrail should take when this pattern is detected"}),(0,s.jsxs)(h.default,{value:r,onChange:o,style:{width:"100%"},children:[(0,s.jsx)(A,{value:"BLOCK",children:"Block"}),(0,s.jsx)(A,{value:"MASK",children:"Mask"})]})]})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"24px"},children:[(0,s.jsx)(j.ZP,{onClick:c,children:"Cancel"}),(0,s.jsx)(j.ZP,{type:"primary",onClick:d,children:"Add"})]})]})};let{Text:L}=x.default,{Option:B}=h.default;var T=e=>{let{visible:t,keyword:l,action:a,description:r,onKeywordChange:i,onActionChange:n,onDescriptionChange:o,onAdd:d,onCancel:c}=e;return(0,s.jsxs)(_.Z,{title:"Add blocked keyword",open:t,onCancel:c,footer:null,width:800,children:[(0,s.jsxs)(N.Z,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(L,{strong:!0,children:"Keyword"}),(0,s.jsx)(y.default,{placeholder:"Enter sensitive keyword or phrase",value:l,onChange:e=>i(e.target.value),style:{marginTop:8}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(L,{strong:!0,children:"Action"}),(0,s.jsx)(L,{type:"secondary",style:{display:"block",marginTop:4,marginBottom:8},children:"Choose what action the guardrail should take when this keyword is detected"}),(0,s.jsxs)(h.default,{value:a,onChange:n,style:{width:"100%"},children:[(0,s.jsx)(B,{value:"BLOCK",children:"Block"}),(0,s.jsx)(B,{value:"MASK",children:"Mask"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(L,{strong:!0,children:"Description (optional)"}),(0,s.jsx)(y.default.TextArea,{placeholder:"Explain why this keyword is sensitive",value:r,onChange:e=>o(e.target.value),rows:3,style:{marginTop:8}})]})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"24px"},children:[(0,s.jsx)(j.ZP,{onClick:c,children:"Cancel"}),(0,s.jsx)(j.ZP,{type:"primary",onClick:d,children:"Add"})]})]})},z=l(56609),E=l(26349);let{Text:F}=x.default,{Option:G}=h.default;var M=e=>{let{patterns:t,onActionChange:l,onRemove:a}=e,r=[{title:"Type",dataIndex:"type",key:"type",width:100,render:e=>(0,s.jsx)(v.Z,{color:"prebuilt"===e?"blue":"green",children:"prebuilt"===e?"Prebuilt":"Custom"})},{title:"Pattern name",dataIndex:"name",key:"name",render:(e,t)=>t.display_name||t.name},{title:"Regex pattern",dataIndex:"pattern",key:"pattern",render:e=>e?(0,s.jsxs)(F,{code:!0,style:{fontSize:12},children:[e.substring(0,40),"..."]}):"-"},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,t)=>(0,s.jsxs)(h.default,{value:e,onChange:e=>l(t.id,e),style:{width:120},size:"small",children:[(0,s.jsx)(G,{value:"BLOCK",children:"Block"}),(0,s.jsx)(G,{value:"MASK",children:"Mask"})]})},{title:"",key:"actions",width:100,render:(e,t)=>(0,s.jsx)(j.ZP,{type:"text",danger:!0,size:"small",icon:(0,s.jsx)(E.Z,{}),onClick:()=>a(t.id),children:"Delete"})}];return 0===t.length?(0,s.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:"No patterns added."}):(0,s.jsx)(z.Z,{dataSource:t,columns:r,rowKey:"id",pagination:!1,size:"small"})};let{Text:R}=x.default,{Option:D}=h.default;var K=e=>{let{keywords:t,onActionChange:l,onRemove:a}=e,r=[{title:"Keyword",dataIndex:"keyword",key:"keyword"},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,t)=>(0,s.jsxs)(h.default,{value:e,onChange:e=>l(t.id,"action",e),style:{width:120},size:"small",children:[(0,s.jsx)(D,{value:"BLOCK",children:"Block"}),(0,s.jsx)(D,{value:"MASK",children:"Mask"})]})},{title:"Description",dataIndex:"description",key:"description",render:e=>e||"-"},{title:"",key:"actions",width:100,render:(e,t)=>(0,s.jsx)(j.ZP,{type:"text",danger:!0,size:"small",icon:(0,s.jsx)(E.Z,{}),onClick:()=>a(t.id),children:"Delete"})}];return 0===t.length?(0,s.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:"No keywords added."}):(0,s.jsx)(z.Z,{dataSource:t,columns:r,rowKey:"id",pagination:!1,size:"small"})},J=l(44851),q=l(38434);let{Title:W,Text:H}=x.default,{Option:U}=h.default;var V=e=>{var t,l;let{availableCategories:a,selectedCategories:r,onCategoryAdd:i,onCategoryRemove:n,onCategoryUpdate:d,accessToken:c,pendingSelection:u,onPendingSelectionChange:p}=e,[x,f]=o.useState(""),y=void 0!==u?u:x,_=p||f,[b,N]=o.useState({}),[w,S]=o.useState({}),[k,Z]=o.useState({}),[P,I]=o.useState([]),[A,O]=o.useState(""),[L,B]=o.useState(!1),T=async e=>{if(c&&!b[e]){Z(t=>({...t,[e]:!0}));try{let t=await (0,g.getCategoryYaml)(c,e),l=t.yaml_content;if("json"===t.file_type)try{let e=JSON.parse(l);l=JSON.stringify(e,null,2)}catch(t){console.warn("Failed to format JSON for ".concat(e,":"),t)}N(t=>({...t,[e]:l})),S(l=>({...l,[e]:t.file_type||"yaml"}))}catch(t){console.error("Failed to fetch content for category ".concat(e,":"),t)}finally{Z(t=>({...t,[e]:!1}))}}};o.useEffect(()=>{if(y&&c){let e=b[y];if(e){O(e);return}B(!0),console.log("Fetching content for category: ".concat(y),{accessToken:c?"present":"missing"}),(0,g.getCategoryYaml)(c,y).then(e=>{console.log("Successfully fetched content for ".concat(y,":"),e);let t=e.yaml_content;if("json"===e.file_type)try{let e=JSON.parse(t);t=JSON.stringify(e,null,2)}catch(e){console.warn("Failed to format JSON for ".concat(y,":"),e)}O(t),N(e=>({...e,[y]:t})),S(t=>({...t,[y]:e.file_type||"yaml"}))}).catch(e=>{console.error("Failed to fetch preview content for category ".concat(y,":"),e),O("")}).finally(()=>{B(!1)})}else O(""),B(!1)},[y,c]);let F=[{title:"Category",dataIndex:"display_name",key:"display_name",render:(e,t)=>{let l=a.find(e=>e.name===t.category);return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:500},children:e}),(null==l?void 0:l.description)&&(0,s.jsx)("div",{style:{fontSize:"12px",color:"#888",marginTop:"4px"},children:l.description})]})}},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,t)=>(0,s.jsxs)(h.default,{value:e,onChange:e=>d(t.id,"action",e),style:{width:"100%"},children:[(0,s.jsx)(U,{value:"BLOCK",children:(0,s.jsx)(v.Z,{color:"red",children:"BLOCK"})}),(0,s.jsx)(U,{value:"MASK",children:(0,s.jsx)(v.Z,{color:"orange",children:"MASK"})})]})},{title:"Severity Threshold",dataIndex:"severity_threshold",key:"severity_threshold",width:180,render:(e,t)=>(0,s.jsxs)(h.default,{value:e,onChange:e=>d(t.id,"severity_threshold",e),style:{width:"100%"},children:[(0,s.jsx)(U,{value:"low",children:"Low"}),(0,s.jsx)(U,{value:"medium",children:"Medium"}),(0,s.jsx)(U,{value:"high",children:"High"})]})},{title:"",key:"actions",width:80,render:(e,t)=>(0,s.jsx)(j.ZP,{icon:(0,s.jsx)(E.Z,{}),onClick:()=>n(t.id),size:"small",children:"Remove"})}],G=a.filter(e=>!r.some(t=>t.category===e.name));return(0,s.jsxs)(C.Z,{title:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:8},children:[(0,s.jsx)(W,{level:5,style:{margin:0},children:"Blocked topics"}),(0,s.jsx)(H,{type:"secondary",style:{fontSize:12,fontWeight:400},children:"Select topics to block using keyword and semantic analysis"})]}),size:"small",children:[(0,s.jsxs)("div",{style:{marginBottom:16,display:"flex",gap:8},children:[(0,s.jsx)(h.default,{placeholder:"Select a content category",value:y||void 0,onChange:_,style:{flex:1},showSearch:!0,optionLabelProp:"label",filterOption:(e,t)=>{var l,a;return(null!==(a=null==t?void 0:null===(l=t.label)||void 0===l?void 0:l.toString().toLowerCase())&&void 0!==a?a:"").includes(e.toLowerCase())},children:G.map(e=>(0,s.jsx)(U,{value:e.name,label:e.display_name,children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:500},children:e.display_name}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:e.description})]})},e.name))}),(0,s.jsx)(j.ZP,{type:"primary",onClick:()=>{if(!y)return;let e=a.find(e=>e.name===y);!e||r.some(e=>e.category===y)||(i({id:"category-".concat(Date.now()),category:e.name,display_name:e.display_name,action:e.default_action,severity_threshold:"medium"}),_(""),O(""))},disabled:!y,icon:(0,s.jsx)(m.Z,{}),children:"Add"})]}),y&&(0,s.jsxs)("div",{style:{marginBottom:16,padding:"12px",background:"#f9f9f9",border:"1px solid #e0e0e0",borderRadius:"4px"},children:[(0,s.jsxs)("div",{style:{marginBottom:8,fontWeight:500,fontSize:"14px"},children:["Preview: ",null===(t=a.find(e=>e.name===y))||void 0===t?void 0:t.display_name,w[y]&&(0,s.jsxs)("span",{style:{marginLeft:8,fontSize:"12px",color:"#888",fontWeight:400},children:["(",null===(l=w[y])||void 0===l?void 0:l.toUpperCase(),")"]})]}),L?(0,s.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#888"},children:"Loading content..."}):A?(0,s.jsx)("pre",{style:{background:"#fff",padding:"12px",borderRadius:"4px",overflow:"auto",maxHeight:"300px",maxWidth:"100%",fontSize:"12px",lineHeight:"1.5",margin:0,border:"1px solid #e0e0e0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:(0,s.jsx)("code",{children:A})}):(0,s.jsx)("div",{style:{padding:"8px",textAlign:"center",color:"#888",fontSize:"12px"},children:"Unable to load category content"})]}),r.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.Z,{dataSource:r,columns:F,pagination:!1,size:"small",rowKey:"id"}),(0,s.jsx)("div",{style:{marginTop:16},children:(0,s.jsx)(J.default,{activeKey:P,onChange:e=>{let t=Array.isArray(e)?e:e?[e]:[],l=new Set(P);t.forEach(e=>{l.has(e)||b[e]||T(e)}),I(t)},ghost:!0,items:r.map(e=>{let t=(w[e.category]||"yaml").toUpperCase();return{key:e.category,label:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)(q.Z,{}),(0,s.jsxs)("span",{children:["View ",t," for ",e.display_name]})]}),children:k[e.category]?(0,s.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#888"},children:"Loading content..."}):b[e.category]?(0,s.jsx)("pre",{style:{background:"#f5f5f5",padding:"16px",borderRadius:"4px",overflow:"auto",maxHeight:"400px",fontSize:"12px",lineHeight:"1.5",margin:0},children:(0,s.jsx)("code",{children:b[e.category]})}):(0,s.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#888"},children:"Content will load when expanded"})}})})})]}):(0,s.jsx)("div",{style:{textAlign:"center",padding:"24px",color:"#888",border:"1px dashed #d9d9d9",borderRadius:"4px"},children:"No blocked topics selected. Add topics to detect and block harmful content."})]})},Y=l(63709),Q=l(12221);let{Title:$,Text:X}=x.default,{Option:ee}=h.default,et={competitor_intent_type:"airline",brand_self:[],locations:[],policy:{competitor_comparison:"refuse",possible_competitor_comparison:"reframe"},threshold_high:.7,threshold_medium:.45,threshold_low:.3};var el=e=>{var t,l,a,r,i,n,d,c,m;let{enabled:u,config:p,onChange:x,accessToken:y}=e,v=null!=p?p:et,[j,_]=(0,o.useState)([]),[b,w]=(0,o.useState)(!1);(0,o.useEffect)(()=>{"airline"===v.competitor_intent_type&&y&&0===j.length&&(w(!0),(0,g.getMajorAirlines)(y).then(e=>{var t;return _(null!==(t=e.airlines)&&void 0!==t?t:[])}).catch(()=>_([])).finally(()=>w(!1)))},[v.competitor_intent_type,y,j.length]);let S=e=>{x(e,e?{...et}:null)},k=(e,t)=>{x(u,{...v,[e]:t})},Z=(e,t)=>{x(u,{...v,policy:{...v.policy,[e]:t}})},P=(e,t)=>{x(u,{...v,[e]:t.filter(Boolean)})},I=e=>{let t=e.filter(Boolean),l=[],a=new Set;for(let e of t){let t=j.find(t=>{var l;return(null===(l=t.match.split("|")[0])||void 0===l?void 0:l.trim().toLowerCase())===e.toLowerCase()});if(t)for(let e of t.match.split("|").map(e=>e.trim().toLowerCase()).filter(Boolean))a.has(e)||(a.add(e),l.push(e));else a.has(e.toLowerCase())||(a.add(e.toLowerCase()),l.push(e))}x(u,{...v,brand_self:l})};return u?(0,s.jsxs)(C.Z,{title:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsx)($,{level:5,style:{margin:0},children:"Competitor Intent Filter"}),(0,s.jsx)(Y.Z,{checked:u,onChange:S})]}),size:"small",children:[(0,s.jsx)(X,{type:"secondary",style:{display:"block",marginBottom:16},children:"Block or reframe competitor comparison questions. Airline type uses major airlines (excluding your brand); generic requires manual competitor list."}),(0,s.jsxs)(f.Z,{layout:"vertical",size:"small",children:[(0,s.jsx)(f.Z.Item,{label:"Type",children:(0,s.jsxs)(h.default,{value:v.competitor_intent_type,onChange:e=>k("competitor_intent_type",e),style:{width:"100%"},children:[(0,s.jsx)(ee,{value:"airline",children:"Airline (auto-load competitors from IATA)"}),(0,s.jsx)(ee,{value:"generic",children:"Generic (specify competitors manually)"})]})}),(0,s.jsx)(f.Z.Item,{label:"Your Brand (brand_self)",required:!0,help:"airline"===v.competitor_intent_type?"Select your airline from the list (excluded from competitors) or type to add a custom term":"Names/codes users use for your brand",children:(0,s.jsx)(h.default,{mode:"tags",style:{width:"100%"},placeholder:b?"Loading airlines...":"airline"===v.competitor_intent_type?"Search or select airline, or type to add custom":"Type and press Enter to add",value:v.brand_self,onChange:e=>"airline"===v.competitor_intent_type&&j.length>0?I(null!=e?e:[]):P("brand_self",null!=e?e:[]),tokenSeparators:[","],loading:b,showSearch:!0,filterOption:(e,t)=>{var l,a;return(null!==(a=null==t?void 0:null===(l=t.label)||void 0===l?void 0:l.toString().toLowerCase())&&void 0!==a?a:"").includes(e.toLowerCase())},optionFilterProp:"label",options:"airline"===v.competitor_intent_type&&j.length>0?j.map(e=>{var t,l;let a=null!==(l=null===(t=e.match.split("|")[0])||void 0===t?void 0:t.trim())&&void 0!==l?l:e.id,r=e.match.split("|").map(e=>e.trim().toLowerCase()).filter(Boolean);return{value:a.toLowerCase(),label:"".concat(a).concat(r.length>1?" (".concat(r.slice(1).join(", "),")"):"")}}):void 0})}),"airline"===v.competitor_intent_type&&(0,s.jsx)(f.Z.Item,{label:"Locations (optional)",help:"Countries, cities, airports for disambiguation (e.g. qatar, doha)",children:(0,s.jsx)(h.default,{mode:"tags",style:{width:"100%"},placeholder:"Type and press Enter to add",value:null!==(a=v.locations)&&void 0!==a?a:[],onChange:e=>P("locations",null!=e?e:[]),tokenSeparators:[","]})}),"generic"===v.competitor_intent_type&&(0,s.jsx)(f.Z.Item,{label:"Competitors",required:!0,help:"Competitor names to detect (required for generic type)",children:(0,s.jsx)(h.default,{mode:"tags",style:{width:"100%"},placeholder:"Type and press Enter to add",value:null!==(r=v.competitors)&&void 0!==r?r:[],onChange:e=>P("competitors",null!=e?e:[]),tokenSeparators:[","]})}),(0,s.jsx)(f.Z.Item,{label:"Policy: Competitor comparison",children:(0,s.jsxs)(h.default,{value:null!==(i=null===(t=v.policy)||void 0===t?void 0:t.competitor_comparison)&&void 0!==i?i:"refuse",onChange:e=>Z("competitor_comparison",e),style:{width:"100%"},children:[(0,s.jsx)(ee,{value:"refuse",children:"Refuse (block request)"}),(0,s.jsx)(ee,{value:"reframe",children:"Reframe (suggest alternative)"})]})}),(0,s.jsx)(f.Z.Item,{label:"Policy: Possible competitor comparison",children:(0,s.jsxs)(h.default,{value:null!==(n=null===(l=v.policy)||void 0===l?void 0:l.possible_competitor_comparison)&&void 0!==n?n:"reframe",onChange:e=>Z("possible_competitor_comparison",e),style:{width:"100%"},children:[(0,s.jsx)(ee,{value:"refuse",children:"Refuse (block request)"}),(0,s.jsx)(ee,{value:"reframe",children:"Reframe (suggest alternative to backend LLM)"})]})}),(0,s.jsx)(f.Z.Item,{label:"Confidence thresholds",help:(0,s.jsxs)(s.Fragment,{children:["Classify competitor intent by confidence (0–1). Higher confidence → stronger intent.",(0,s.jsxs)("ul",{style:{marginBottom:0,marginTop:4,paddingLeft:20},children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"High (≥)"}),': Treat as full competitor comparison → uses "Competitor comparison" policy']}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Medium (≥)"}),': Treat as possible comparison → uses "Possible competitor comparison" policy']}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Low (≥)"}),": Log only; allow request. Below Low → allow with no action"]})]}),"Raise thresholds to be more permissive; lower them to be stricter."]}),children:(0,s.jsxs)(N.Z,{wrap:!0,children:[(0,s.jsx)(f.Z.Item,{label:"High",style:{marginBottom:0},help:"e.g. 0.7",children:(0,s.jsx)(Q.Z,{min:0,max:1,step:.05,value:null!==(d=v.threshold_high)&&void 0!==d?d:.7,onChange:e=>k("threshold_high",null!=e?e:.7),style:{width:80}})}),(0,s.jsx)(f.Z.Item,{label:"Medium",style:{marginBottom:0},help:"e.g. 0.45",children:(0,s.jsx)(Q.Z,{min:0,max:1,step:.05,value:null!==(c=v.threshold_medium)&&void 0!==c?c:.45,onChange:e=>k("threshold_medium",null!=e?e:.45),style:{width:80}})}),(0,s.jsx)(f.Z.Item,{label:"Low",style:{marginBottom:0},help:"e.g. 0.3",children:(0,s.jsx)(Q.Z,{min:0,max:1,step:.05,value:null!==(m=v.threshold_low)&&void 0!==m?m:.3,onChange:e=>k("threshold_low",null!=e?e:.3),style:{width:80}})})]})})]})]}):(0,s.jsx)(C.Z,{title:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsx)($,{level:5,style:{margin:0},children:"Competitor Intent Filter"}),(0,s.jsx)(Y.Z,{checked:!1,onChange:S})]}),size:"small",children:(0,s.jsx)(X,{type:"secondary",children:"Block or reframe competitor comparison questions. When enabled, airline type auto-loads competitors from IATA; generic type requires manual competitor list."})})};let{Title:ea,Text:er}=x.default;var ei=e=>{let{prebuiltPatterns:t,categories:l,selectedPatterns:a,blockedWords:r,onPatternAdd:i,onPatternRemove:n,onPatternActionChange:d,onBlockedWordAdd:c,onBlockedWordRemove:u,onBlockedWordUpdate:p,onFileUpload:x,accessToken:h,showStep:f,contentCategories:y=[],selectedContentCategories:v=[],onContentCategoryAdd:_,onContentCategoryRemove:k,onContentCategoryUpdate:Z,pendingCategorySelection:I,onPendingCategorySelectionChange:A,competitorIntentEnabled:L=!1,competitorIntentConfig:B=null,onCompetitorIntentChange:z}=e,[E,F]=(0,o.useState)(!1),[G,R]=(0,o.useState)(!1),[D,J]=(0,o.useState)(!1),[q,W]=(0,o.useState)(""),[H,U]=(0,o.useState)("BLOCK"),[Y,Q]=(0,o.useState)(""),[$,X]=(0,o.useState)(""),[ee,et]=(0,o.useState)("BLOCK"),[ei,en]=(0,o.useState)(""),[es,eo]=(0,o.useState)("BLOCK"),[ed,ec]=(0,o.useState)(""),[em,eu]=(0,o.useState)(!1),ep=async e=>{eu(!0);try{let t=await e.text();if(h){let e=await (0,g.validateBlockedWordsFile)(h,t);if(e.valid)x&&x(t),b.ZP.success(e.message||"File uploaded successfully");else{let t=e.error||e.errors&&e.errors.join(", ")||"Invalid file";b.ZP.error("Validation failed: ".concat(t))}}}catch(e){b.ZP.error("Failed to upload file: ".concat(e))}finally{eu(!1)}return!1};return(0,s.jsxs)("div",{className:"space-y-6",children:[!f&&(0,s.jsx)("div",{children:(0,s.jsx)(er,{type:"secondary",children:"Configure patterns, keywords, and content categories to detect and filter sensitive information in requests and responses."})}),(!f||"patterns"===f)&&(0,s.jsxs)(C.Z,{title:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsx)(ea,{level:5,style:{margin:0},children:"Pattern Detection"}),(0,s.jsx)(er,{type:"secondary",style:{fontSize:14,fontWeight:400},children:"Detect sensitive information using regex patterns (SSN, credit cards, API keys, etc.)"})]}),size:"small",children:[(0,s.jsx)("div",{style:{marginBottom:16},children:(0,s.jsxs)(N.Z,{children:[(0,s.jsx)(j.ZP,{type:"primary",onClick:()=>F(!0),icon:(0,s.jsx)(m.Z,{}),children:"Add prebuilt pattern"}),(0,s.jsx)(j.ZP,{onClick:()=>J(!0),icon:(0,s.jsx)(m.Z,{}),children:"Add custom regex"})]})}),(0,s.jsx)(M,{patterns:a,onActionChange:d,onRemove:n})]}),(!f||"keywords"===f)&&(0,s.jsxs)(C.Z,{title:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsx)(ea,{level:5,style:{margin:0},children:"Blocked Keywords"}),(0,s.jsx)(er,{type:"secondary",style:{fontSize:14,fontWeight:400},children:"Block or mask specific sensitive terms and phrases"})]}),size:"small",children:[(0,s.jsx)("div",{style:{marginBottom:16},children:(0,s.jsxs)(N.Z,{children:[(0,s.jsx)(j.ZP,{type:"primary",onClick:()=>R(!0),icon:(0,s.jsx)(m.Z,{}),children:"Add keyword"}),(0,s.jsx)(w.default,{beforeUpload:ep,accept:".yaml,.yml",showUploadList:!1,children:(0,s.jsx)(j.ZP,{icon:(0,s.jsx)(S.Z,{}),loading:em,children:"Upload YAML file"})})]})}),(0,s.jsx)(K,{keywords:r,onActionChange:p,onRemove:u})]}),(!f||"competitor_intent"===f||"categories"===f)&&z&&(0,s.jsx)(el,{enabled:L,config:B,onChange:z,accessToken:h}),(!f||"categories"===f)&&y.length>0&&_&&k&&Z&&(0,s.jsx)(V,{availableCategories:y,selectedCategories:v,onCategoryAdd:_,onCategoryRemove:k,onCategoryUpdate:Z,accessToken:h,pendingSelection:I,onPendingSelectionChange:A}),(0,s.jsx)(P,{visible:E,prebuiltPatterns:t,categories:l,selectedPatternName:q,patternAction:H,onPatternNameChange:W,onActionChange:e=>U(e),onAdd:()=>{if(!q){b.ZP.error("Please select a pattern");return}let e=t.find(e=>e.name===q);i({id:"pattern-".concat(Date.now()),type:"prebuilt",name:q,display_name:null==e?void 0:e.display_name,action:H}),F(!1),W(""),U("BLOCK")},onCancel:()=>{F(!1),W(""),U("BLOCK")}}),(0,s.jsx)(O,{visible:D,patternName:Y,patternRegex:$,patternAction:ee,onNameChange:Q,onRegexChange:X,onActionChange:e=>et(e),onAdd:()=>{if(!Y||!$){b.ZP.error("Please provide pattern name and regex");return}i({id:"custom-".concat(Date.now()),type:"custom",name:Y,pattern:$,action:ee}),J(!1),Q(""),X(""),et("BLOCK")},onCancel:()=>{J(!1),Q(""),X(""),et("BLOCK")}}),(0,s.jsx)(T,{visible:G,keyword:ei,action:es,description:ed,onKeywordChange:en,onActionChange:e=>eo(e),onDescriptionChange:ec,onAdd:()=>{if(!ei){b.ZP.error("Please enter a keyword");return}c({id:"word-".concat(Date.now()),keyword:ei,action:es,description:ed||void 0}),R(!1),en(""),ec(""),eo("BLOCK")},onCancel:()=>{R(!1),en(""),ec(""),eo("BLOCK")}})]})};(a=i||(i={})).PresidioPII="Presidio PII",a.Bedrock="Bedrock Guardrail",a.Lakera="Lakera";let en={},es=e=>{let t={};return t.PresidioPII="Presidio PII",t.Bedrock="Bedrock Guardrail",t.Lakera="Lakera",Object.entries(e).forEach(e=>{let[l,a]=e;a&&"object"==typeof a&&"ui_friendly_name"in a&&(t[l.split("_").map((e,t)=>e.charAt(0).toUpperCase()+e.slice(1)).join("")]=a.ui_friendly_name)}),en=t,t},eo=()=>Object.keys(en).length>0?en:i,ed={PresidioPII:"presidio",Bedrock:"bedrock",Lakera:"lakera_v2",LitellmContentFilter:"litellm_content_filter",ToolPermission:"tool_permission"},ec=e=>{Object.entries(e).forEach(e=>{let[t,l]=e;l&&"object"==typeof l&&"ui_friendly_name"in l&&(ed[t.split("_").map((e,t)=>e.charAt(0).toUpperCase()+e.slice(1)).join("")]=t)})},em=e=>!!e&&"Presidio PII"===eo()[e],eu=e=>!!e&&"LiteLLM Content Filter"===eo()[e],ep="../ui/assets/logos/",eg={"Zscaler AI Guard":"".concat(ep,"zscaler.svg"),"Presidio PII":"".concat(ep,"microsoft_azure.svg"),"Bedrock Guardrail":"".concat(ep,"bedrock.svg"),Lakera:"".concat(ep,"lakeraai.jpeg"),"Azure Content Safety Prompt Shield":"".concat(ep,"microsoft_azure.svg"),"Azure Content Safety Text Moderation":"".concat(ep,"microsoft_azure.svg"),"Aporia AI":"".concat(ep,"aporia.png"),"PANW Prisma AIRS":"".concat(ep,"palo_alto_networks.jpeg"),"Noma Security":"".concat(ep,"noma_security.png"),"Javelin Guardrails":"".concat(ep,"javelin.png"),"Pillar Guardrail":"".concat(ep,"pillar.jpeg"),"Google Cloud Model Armor":"".concat(ep,"google.svg"),"Guardrails AI":"".concat(ep,"guardrails_ai.jpeg"),"Lasso Guardrail":"".concat(ep,"lasso.png"),"Pangea Guardrail":"".concat(ep,"pangea.png"),"AIM Guardrail":"".concat(ep,"aim_security.jpeg"),"OpenAI Moderation":"".concat(ep,"openai_small.svg"),EnkryptAI:"".concat(ep,"enkrypt_ai.avif"),"Prompt Security":"".concat(ep,"prompt_security.png"),"LiteLLM Content Filter":"".concat(ep,"litellm_logo.jpg")},ex=e=>{if(!e)return{logo:"",displayName:"-"};let t=Object.keys(ed).find(t=>ed[t].toLowerCase()===e.toLowerCase());if(!t)return{logo:"",displayName:e};let l=eo()[t];return{logo:eg[l]||"",displayName:l||e}};var eh=l(24199);let{Title:ef}=x.default,ey=e=>{let{field:t,fieldKey:l,fullFieldKey:a,value:r}=e,[i,n]=o.useState([]),[d,c]=o.useState(t.dict_key_options||[]);o.useEffect(()=>{if(r&&"object"==typeof r){let e=Object.keys(r);n(e.map(e=>({key:e,id:"".concat(e,"_").concat(Date.now(),"_").concat(Math.random())}))),c((t.dict_key_options||[]).filter(t=>!e.includes(t)))}},[r,t.dict_key_options]);let m=e=>{e&&(n([...i,{key:e,id:"".concat(e,"_").concat(Date.now())}]),c(d.filter(t=>t!==e)))},u=(e,t)=>{n(i.filter(t=>t.id!==e)),c([...d,t].sort())};return(0,s.jsxs)("div",{className:"space-y-3",children:[i.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[(0,s.jsx)("div",{className:"w-24 font-medium text-sm",children:e.key}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(f.Z.Item,{name:Array.isArray(a)?[...a,e.key]:[a,e.key],style:{marginBottom:0},initialValue:r&&"object"==typeof r?r[e.key]:void 0,normalize:"number"===t.dict_value_type?e=>{if(null==e||""===e)return;let t=Number(e);return isNaN(t)?e:t}:void 0,children:"number"===t.dict_value_type?(0,s.jsx)(eh.Z,{step:1,width:200,placeholder:"Enter ".concat(e.key," value")}):"boolean"===t.dict_value_type?(0,s.jsxs)(h.default,{placeholder:"Select ".concat(e.key," value"),children:[(0,s.jsx)(h.default.Option,{value:!0,children:"True"}),(0,s.jsx)(h.default.Option,{value:!1,children:"False"})]}):(0,s.jsx)(y.default,{placeholder:"Enter ".concat(e.key," value")})})}),(0,s.jsx)(j.ZP,{type:"text",danger:!0,size:"small",onClick:()=>u(e.id,e.key),children:"Remove"})]},e.id)),d.length>0&&(0,s.jsxs)("div",{className:"flex items-center space-x-3 mt-2",children:[(0,s.jsx)(h.default,{placeholder:"Select category to configure",style:{width:200},onSelect:e=>e&&m(e),value:void 0,children:d.map(e=>(0,s.jsx)(h.default.Option,{value:e,children:e},e))}),(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"Select a category to add threshold configuration"})]})]})};var ev=e=>{let{optionalParams:t,parentFieldKey:l,values:a}=e,r=(e,t)=>{let r="".concat(l,".").concat(e),i=null==a?void 0:a[e];return(console.log("value",i),"dict"===t.type&&t.dict_key_options)?(0,s.jsxs)("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[(0,s.jsx)("div",{className:"mb-4 font-medium text-gray-900 text-base",children:e}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:t.description}),(0,s.jsx)(ey,{field:t,fieldKey:e,fullFieldKey:[l,e],value:i})]},r):(0,s.jsx)("div",{className:"mb-8 p-6 bg-white rounded-lg border border-gray-200 shadow-sm",children:(0,s.jsx)(f.Z.Item,{name:[l,e],label:(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("div",{className:"font-medium text-gray-900 text-base",children:e}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]}),rules:t.required?[{required:!0,message:"".concat(e," is required")}]:void 0,className:"mb-0",initialValue:void 0!==i?i:t.default_value,normalize:"number"===t.type?e=>{if(null==e||""===e)return;let t=Number(e);return isNaN(t)?e:t}:void 0,children:"select"===t.type&&t.options?(0,s.jsx)(h.default,{placeholder:t.description,children:t.options.map(e=>(0,s.jsx)(h.default.Option,{value:e,children:e},e))}):"multiselect"===t.type&&t.options?(0,s.jsx)(h.default,{mode:"multiple",placeholder:t.description,children:t.options.map(e=>(0,s.jsx)(h.default.Option,{value:e,children:e},e))}):"bool"===t.type||"boolean"===t.type?(0,s.jsxs)(h.default,{placeholder:t.description,children:[(0,s.jsx)(h.default.Option,{value:"true",children:"True"}),(0,s.jsx)(h.default.Option,{value:"false",children:"False"})]}):"number"===t.type?(0,s.jsx)(eh.Z,{step:1,width:400,placeholder:t.description}):e.includes("password")||e.includes("secret")||e.includes("key")?(0,s.jsx)(y.default.Password,{placeholder:t.description}):(0,s.jsx)(y.default,{placeholder:t.description})})},r)};return t.fields&&0!==Object.keys(t.fields).length?(0,s.jsxs)("div",{className:"guardrail-optional-params",children:[(0,s.jsxs)("div",{className:"mb-8 pb-4 border-b border-gray-100",children:[(0,s.jsx)(ef,{level:3,className:"mb-2 font-semibold text-gray-900",children:"Optional Parameters"}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:t.description||"Configure additional settings for this guardrail provider"})]}),(0,s.jsx)("div",{className:"space-y-8",children:Object.entries(t.fields).map(e=>{let[t,l]=e;return r(t,l)})})]}):null},ej=l(10353),e_=e=>{var t;let{selectedProvider:l,accessToken:a,providerParams:r=null,value:i=null}=e,[n,d]=(0,o.useState)(!1),[c,m]=(0,o.useState)(r),[u,p]=(0,o.useState)(null);if((0,o.useEffect)(()=>{if(r){m(r);return}let e=async()=>{if(a){d(!0),p(null);try{let e=await (0,g.getGuardrailProviderSpecificParams)(a);console.log("Provider params API response:",e),m(e),es(e),ec(e)}catch(e){console.error("Error fetching provider params:",e),p("Failed to load provider parameters")}finally{d(!1)}}};r||e()},[a,r]),!l)return null;if(n)return(0,s.jsx)(ej.Z,{tip:"Loading provider parameters..."});if(u)return(0,s.jsx)("div",{className:"text-red-500",children:u});let x=null===(t=ed[l])||void 0===t?void 0:t.toLowerCase(),v=c&&c[x];if(console.log("Provider key:",x),console.log("Provider fields:",v),!v||0===Object.keys(v).length)return(0,s.jsx)("div",{children:"No configuration fields available for this provider."});console.log("Value:",i);let j=new Set(["patterns","blocked_words","blocked_words_file","categories","severity_threshold","pattern_redaction_format","keyword_redaction_tag"]),_=eu(l),b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",l=arguments.length>2?arguments[2]:void 0;return Object.entries(e).map(e=>{let[a,r]=e,n=t?"".concat(t,".").concat(a):a,o=l?l[a]:null==i?void 0:i[a];return(console.log("Field value:",o),"ui_friendly_name"===a||"optional_params"===a&&"nested"===r.type&&r.fields||_&&j.has(a))?null:"nested"===r.type&&r.fields?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-2 font-medium",children:a}),(0,s.jsx)("div",{className:"ml-4 border-l-2 border-gray-200 pl-4",children:b(r.fields,n,o)})]},n):(0,s.jsx)(f.Z.Item,{name:n,label:a,tooltip:r.description,rules:r.required?[{required:!0,message:"".concat(a," is required")}]:void 0,children:"select"===r.type&&r.options?(0,s.jsx)(h.default,{placeholder:r.description,defaultValue:o||r.default_value,children:r.options.map(e=>(0,s.jsx)(h.default.Option,{value:e,children:e},e))}):"multiselect"===r.type&&r.options?(0,s.jsx)(h.default,{mode:"multiple",placeholder:r.description,defaultValue:o||r.default_value,children:r.options.map(e=>(0,s.jsx)(h.default.Option,{value:e,children:e},e))}):"bool"===r.type||"boolean"===r.type?(0,s.jsxs)(h.default,{placeholder:r.description,defaultValue:void 0!==o?String(o):r.default_value,children:[(0,s.jsx)(h.default.Option,{value:"true",children:"True"}),(0,s.jsx)(h.default.Option,{value:"false",children:"False"})]}):"number"===r.type?(0,s.jsx)(eh.Z,{step:1,width:400,placeholder:r.description,defaultValue:void 0!==o?Number(o):void 0}):a.includes("password")||a.includes("secret")||a.includes("key")?(0,s.jsx)(y.default.Password,{placeholder:r.description,defaultValue:o||""}):(0,s.jsx)(y.default,{placeholder:r.description,defaultValue:o||""})},n)})};return(0,s.jsx)(s.Fragment,{children:b(v)})},eb=l(99981),eC=l(61994),eN=l(97416),ew=l(8881),eS=l(10798),ek=l(49638);let{Text:eZ}=x.default,{Option:eP}=h.default,eI=e=>e.replace(/_/g," "),eA=e=>{switch(e){case"MASK":return(0,s.jsx)(eN.Z,{style:{marginRight:4}});case"BLOCK":return(0,s.jsx)(ew.Z,{style:{marginRight:4}});default:return null}},eO=e=>{let{categories:t,selectedCategories:l,onChange:a}=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)(eS.Z,{className:"text-gray-500 mr-1"}),(0,s.jsx)(eZ,{className:"text-gray-500 font-medium",children:"Filter by category"})]}),(0,s.jsx)(h.default,{mode:"multiple",placeholder:"Select categories to filter by",style:{width:"100%"},onChange:a,value:l,allowClear:!0,showSearch:!0,optionFilterProp:"children",className:"mb-4",tagRender:e=>(0,s.jsx)(v.Z,{color:"blue",closable:e.closable,onClose:e.onClose,className:"mr-2 mb-2",children:e.label}),children:t.map(e=>(0,s.jsx)(eP,{value:e.category,children:e.category},e.category))})]})},eL=e=>{let{onSelectAll:t,onUnselectAll:l,hasSelectedEntities:a}=e;return(0,s.jsxs)("div",{className:"bg-gray-50 p-5 rounded-lg mb-6 border border-gray-200 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(eZ,{strong:!0,className:"text-gray-700 text-base",children:"Quick Actions"}),(0,s.jsx)(eb.Z,{title:"Apply action to all PII types at once",children:(0,s.jsx)("div",{className:"ml-2 text-gray-400 cursor-help text-xs",children:"ⓘ"})})]}),(0,s.jsx)(j.ZP,{color:"danger",variant:"outlined",onClick:l,disabled:!a,icon:(0,s.jsx)(ek.Z,{}),children:"Unselect All"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(j.ZP,{color:"primary",variant:"outlined",onClick:()=>t("MASK"),className:"h-10",block:!0,icon:(0,s.jsx)(eN.Z,{}),children:"Select All & Mask"}),(0,s.jsx)(j.ZP,{color:"danger",variant:"outlined",onClick:()=>t("BLOCK"),className:"h-10 hover:bg-red-100",block:!0,icon:(0,s.jsx)(ew.Z,{}),children:"Select All & Block"})]})]})},eB=e=>{let{entities:t,selectedEntities:l,selectedActions:a,actions:r,onEntitySelect:i,onActionSelect:n,entityToCategoryMap:o}=e;return(0,s.jsxs)("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[(0,s.jsxs)("div",{className:"bg-gray-50 px-5 py-3 border-b flex",children:[(0,s.jsx)(eZ,{strong:!0,className:"flex-1 text-gray-700",children:"PII Type"}),(0,s.jsx)(eZ,{strong:!0,className:"w-32 text-right text-gray-700",children:"Action"})]}),(0,s.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:0===t.length?(0,s.jsx)("div",{className:"py-10 text-center text-gray-500",children:"No PII types match your filter criteria"}):t.map(e=>(0,s.jsxs)("div",{className:"px-5 py-3 flex items-center justify-between hover:bg-gray-50 border-b ".concat(l.includes(e)?"bg-blue-50":""),children:[(0,s.jsxs)("div",{className:"flex items-center flex-1",children:[(0,s.jsx)(eC.Z,{checked:l.includes(e),onChange:()=>i(e),className:"mr-3"}),(0,s.jsx)(eZ,{className:l.includes(e)?"font-medium text-gray-900":"text-gray-700",children:eI(e)}),o.get(e)&&(0,s.jsx)(v.Z,{className:"ml-2 text-xs",color:"blue",children:o.get(e)})]}),(0,s.jsx)("div",{className:"w-32",children:(0,s.jsx)(h.default,{value:l.includes(e)&&a[e]||"MASK",onChange:t=>n(e,t),style:{width:120},disabled:!l.includes(e),className:"".concat(l.includes(e)?"":"opacity-50"),dropdownMatchSelectWidth:!1,children:r.map(e=>(0,s.jsx)(eP,{value:e,children:(0,s.jsxs)("div",{className:"flex items-center",children:[eA(e),e]})},e))})})]},e))})]})},{Title:eT,Text:ez}=x.default;var eE=e=>{let{entities:t,actions:l,selectedEntities:a,selectedActions:r,onEntitySelect:i,onActionSelect:n,entityCategories:d=[]}=e,[c,m]=(0,o.useState)([]),u=new Map;d.forEach(e=>{e.entities.forEach(t=>{u.set(t,e.category)})});let p=t.filter(e=>0===c.length||c.includes(u.get(e)||""));return(0,s.jsxs)("div",{className:"pii-configuration",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(eT,{level:4,className:"!m-0 font-semibold text-gray-800",children:"Configure PII Protection"})}),(0,s.jsxs)(ez,{className:"text-gray-500",children:[a.length," items selected"]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)(eO,{categories:d,selectedCategories:c,onChange:m}),(0,s.jsx)(eL,{onSelectAll:e=>{t.forEach(t=>{a.includes(t)||i(t),n(t,e)})},onUnselectAll:()=>{a.forEach(e=>{i(e)})},hasSelectedEntities:a.length>0})]}),(0,s.jsx)(eB,{entities:p,selectedEntities:a,selectedActions:r,actions:l,onEntitySelect:i,onActionSelect:n,entityToCategoryMap:u})]})},eF=l(78801),eG=l(23496),eM=l(85180),eR=l(15424);let eD={rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""},eK=e=>({...eD,...e||{},rules:(null==e?void 0:e.rules)?[...e.rules]:[]});var eJ=e=>{let{value:t,onChange:l,disabled:a=!1}=e,r=eK(t),i=e=>{let t={...r,...e};null==l||l(t)},n=(e,t)=>{i({rules:r.rules.map((l,a)=>a===e?{...l,...t}:l)})},o=e=>{i({rules:r.rules.filter((t,l)=>l!==e)})},d=(e,t)=>{let l=r.rules[e];if(!l)return;let a=Object.entries(l.allowed_param_patterns||{});t(a);let i={};a.forEach(e=>{let[t,l]=e;i[t]=l}),n(e,{allowed_param_patterns:Object.keys(i).length>0?i:void 0})},c=(e,t,l)=>{d(e,e=>{if(!e[t])return;let[,a]=e[t];e[t]=[l,a]})},u=(e,t,l)=>{d(e,e=>{if(!e[t])return;let[a]=e[t];e[t]=[a,l]})},p=(e,t)=>{let l=Object.entries(e.allowed_param_patterns||{});return 0===l.length?(0,s.jsx)(j.ZP,{disabled:a,size:"small",onClick:()=>n(t,{allowed_param_patterns:{"":""}}),children:"+ Restrict tool arguments (optional)"}):(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(eF.x,{className:"text-sm text-gray-600",children:"Argument constraints (dot or array paths)"}),l.map((l,r)=>{let[i,n]=l;return(0,s.jsxs)(N.Z,{align:"start",children:[(0,s.jsx)(y.default,{disabled:a,placeholder:"messages[0].content",value:i,onChange:e=>c(t,r,e.target.value)}),(0,s.jsx)(y.default,{disabled:a,placeholder:"^email@.*$",value:n,onChange:e=>u(t,r,e.target.value)}),(0,s.jsx)(j.ZP,{disabled:a,icon:(0,s.jsx)(E.Z,{}),danger:!0,onClick:()=>d(t,e=>{e.splice(r,1)})})]},"".concat(e.id||t,"-").concat(r))}),(0,s.jsx)(j.ZP,{disabled:a,size:"small",onClick:()=>n(t,{allowed_param_patterns:{...e.allowed_param_patterns||{},"":""}}),children:"+ Add another constraint"})]})};return(0,s.jsxs)(eF.Z,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(eF.x,{className:"text-lg font-semibold",children:"LiteLLM Tool Permission Guardrail"}),(0,s.jsx)(eF.x,{className:"text-sm text-gray-500",children:"Provide regex patterns (e.g., ^mcp__github_.*$) for tool names or types and optionally constrain payload fields."})]}),!a&&(0,s.jsx)(j.ZP,{icon:(0,s.jsx)(m.Z,{}),type:"primary",onClick:()=>{i({rules:[...r.rules,{id:"rule_".concat(Math.random().toString(36).slice(2,8)),decision:"allow",allowed_param_patterns:void 0}]})},className:"!bg-blue-600 !text-white hover:!bg-blue-500",children:"Add Rule"})]}),(0,s.jsx)(eG.Z,{}),0===r.rules.length?(0,s.jsx)(eM.Z,{description:"No tool rules added yet"}):(0,s.jsx)("div",{className:"space-y-4",children:r.rules.map((e,t)=>{var l,r;return(0,s.jsxs)(eF.Z,{className:"bg-gray-50",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)(eF.x,{className:"font-semibold",children:["Rule ",t+1]}),(0,s.jsx)(j.ZP,{icon:(0,s.jsx)(E.Z,{}),danger:!0,type:"text",disabled:a,onClick:()=>o(t),children:"Remove"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(eF.x,{className:"text-sm font-medium",children:"Rule ID"}),(0,s.jsx)(y.default,{disabled:a,placeholder:"unique_rule_id",value:e.id,onChange:e=>n(t,{id:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(eF.x,{className:"text-sm font-medium",children:"Tool Name (optional)"}),(0,s.jsx)(y.default,{disabled:a,placeholder:"^mcp__github_.*$",value:null!==(l=e.tool_name)&&void 0!==l?l:"",onChange:e=>n(t,{tool_name:""===e.target.value.trim()?void 0:e.target.value})})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 mt-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(eF.x,{className:"text-sm font-medium",children:"Tool Type (optional)"}),(0,s.jsx)(y.default,{disabled:a,placeholder:"^function$",value:null!==(r=e.tool_type)&&void 0!==r?r:"",onChange:e=>n(t,{tool_type:""===e.target.value.trim()?void 0:e.target.value})})]})}),(0,s.jsxs)("div",{className:"mt-4 flex flex-col gap-2",children:[(0,s.jsx)(eF.x,{className:"text-sm font-medium",children:"Decision"}),(0,s.jsxs)(h.default,{disabled:a,value:e.decision,style:{width:200},onChange:e=>n(t,{decision:e}),children:[(0,s.jsx)(h.default.Option,{value:"allow",children:"Allow"}),(0,s.jsx)(h.default.Option,{value:"deny",children:"Deny"})]})]}),(0,s.jsx)("div",{className:"mt-4",children:p(e,t)})]},e.id||t)})}),(0,s.jsx)(eG.Z,{}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(eF.x,{className:"text-sm font-medium",children:"Default action"}),(0,s.jsxs)(h.default,{disabled:a,value:r.default_action,onChange:e=>i({default_action:e}),children:[(0,s.jsx)(h.default.Option,{value:"allow",children:"Allow"}),(0,s.jsx)(h.default.Option,{value:"deny",children:"Deny"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(eF.x,{className:"text-sm font-medium flex items-center gap-1",children:["On disallowed action",(0,s.jsx)(eb.Z,{title:"Block returns an error when a forbidden tool is invoked. Rewrite strips the tool call but lets the rest of the response continue.",children:(0,s.jsx)(eR.Z,{})})]}),(0,s.jsxs)(h.default,{disabled:a,value:r.on_disallowed_action,onChange:e=>i({on_disallowed_action:e}),children:[(0,s.jsx)(h.default.Option,{value:"block",children:"Block"}),(0,s.jsx)(h.default.Option,{value:"rewrite",children:"Rewrite"})]})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)(eF.x,{className:"text-sm font-medium",children:"Violation message (optional)"}),(0,s.jsx)(y.default.TextArea,{disabled:a,rows:3,placeholder:"This violates our org policy...",value:r.violation_message_template,onChange:e=>i({violation_message_template:e.target.value})})]})]})};let{Title:eq,Text:eW,Link:eH}=x.default,{Option:eU}=h.default,eV={pre_call:"Before LLM Call - Runs before the LLM call and checks the input (Recommended)",during_call:"During LLM Call - Runs in parallel with the LLM call, with response held until check completes",post_call:"After LLM Call - Runs after the LLM call and checks only the output",logging_only:"Logging Only - Only runs on logging callbacks without affecting the LLM call",pre_mcp_call:"Before MCP Tool Call - Runs before MCP tool execution and validates tool calls",during_mcp_call:"During MCP Tool Call - Runs in parallel with MCP tool execution for monitoring"};var eY=e=>{let{visible:t,onClose:l,accessToken:a,onSuccess:r,preset:i}=e,[n]=f.Z.useForm(),[d,c]=(0,o.useState)(!1),[m,u]=(0,o.useState)(null),[p,x]=(0,o.useState)(null),[C,N]=(0,o.useState)([]),[w,S]=(0,o.useState)({}),[k,Z]=(0,o.useState)(0),[P,I]=(0,o.useState)(null),[A,O]=(0,o.useState)([]),[L,B]=(0,o.useState)(2),[T,z]=(0,o.useState)({}),[E,F]=(0,o.useState)([]),[G,M]=(0,o.useState)([]),[R,D]=(0,o.useState)([]),[K,J]=(0,o.useState)(""),[q,W]=(0,o.useState)(!1),[H,U]=(0,o.useState)(null),[V,Y]=(0,o.useState)({rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""}),Q=(0,o.useMemo)(()=>!!m&&"tool_permission"===(ed[m]||"").toLowerCase(),[m]);(0,o.useEffect)(()=>{a&&(async()=>{try{let[e,t]=await Promise.all([(0,g.getGuardrailUISettings)(a),(0,g.getGuardrailProviderSpecificParams)(a)]);x(e),I(t),es(t),ec(t)}catch(e){console.error("Error fetching guardrail data:",e),b.ZP.fromBackend("Failed to load guardrail configuration")}})()},[a]),(0,o.useEffect)(()=>{var e;if(i&&t&&p&&(u(i.provider),n.setFieldsValue({provider:i.provider,guardrail_name:i.guardrailNameSuggestion,mode:i.mode,default_on:i.defaultOn}),i.categoryName&&(null===(e=p.content_filter_settings)||void 0===e?void 0:e.content_categories))){let e=p.content_filter_settings.content_categories.find(e=>e.name===i.categoryName);e&&D([{id:"category-".concat(Date.now()),category:e.name,display_name:e.display_name,action:e.default_action,severity_threshold:"medium"}])}},[i,t,p]);let $=e=>{u(e),n.setFieldsValue({config:void 0,presidio_analyzer_api_base:void 0,presidio_anonymizer_api_base:void 0}),N([]),S({}),O([]),B(2),z({}),F([]),M([]),D([]),J(""),W(!1),U(null),Y({rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""})},X=e=>{N(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},ee=(e,t)=>{S(l=>({...l,[e]:t}))},et=async()=>{try{if(0===k&&(await n.validateFields(["guardrail_name","provider","mode","default_on"]),m)){let e=["guardrail_name","provider","mode","default_on"];"PresidioPII"===m&&e.push("presidio_analyzer_api_base","presidio_anonymizer_api_base"),await n.validateFields(e)}if(1===k&&em(m)&&0===C.length){b.ZP.fromBackend("Please select at least one PII entity to continue");return}Z(k+1)}catch(e){console.error("Form validation failed:",e)}},el=()=>{n.resetFields(),u(null),N([]),S({}),O([]),B(2),z({}),F([]),M([]),D([]),J(""),Y({rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""}),Z(0)},ea=()=>{el(),l()},er=async()=>{try{var e,t,i,s,o,d;c(!0),await n.validateFields();let u=n.getFieldsValue(!0),p=ed[u.provider],x={guardrail_name:u.guardrail_name,litellm_params:{guardrail:p,mode:u.mode,default_on:u.default_on},guardrail_info:{}};if("PresidioPII"===u.provider&&C.length>0){let e={};C.forEach(t=>{e[t]=w[t]||"MASK"}),x.litellm_params.pii_entities_config=e,u.presidio_analyzer_api_base&&(x.litellm_params.presidio_analyzer_api_base=u.presidio_analyzer_api_base),u.presidio_anonymizer_api_base&&(x.litellm_params.presidio_anonymizer_api_base=u.presidio_anonymizer_api_base)}if(eu(u.provider)){let l=q&&(null==H?void 0:null===(e=H.brand_self)||void 0===e?void 0:e.length)>0;if(0===E.length&&0===G.length&&0===R.length&&!l){b.ZP.fromBackend("Please configure at least one content filter setting (category, pattern, keyword, or competitor intent)"),c(!1);return}E.length>0&&(x.litellm_params.patterns=E.map(e=>({pattern_type:"prebuilt"===e.type?"prebuilt":"regex",pattern_name:"prebuilt"===e.type?e.name:void 0,pattern:"custom"===e.type?e.pattern:void 0,name:e.name,action:e.action}))),G.length>0&&(x.litellm_params.blocked_words=G.map(e=>({keyword:e.keyword,action:e.action,description:e.description}))),R.length>0&&(x.litellm_params.categories=R.map(e=>({category:e.category,enabled:!0,action:e.action,severity_threshold:e.severity_threshold||"medium"}))),q&&(null==H?void 0:null===(t=H.brand_self)||void 0===t?void 0:t.length)>0&&(x.litellm_params.competitor_intent_config={competitor_intent_type:null!==(o=H.competitor_intent_type)&&void 0!==o?o:"airline",brand_self:H.brand_self,locations:(null===(i=H.locations)||void 0===i?void 0:i.length)>0?H.locations:void 0,competitors:"generic"===H.competitor_intent_type&&(null===(s=H.competitors)||void 0===s?void 0:s.length)>0?H.competitors:void 0,policy:H.policy,threshold_high:H.threshold_high,threshold_medium:H.threshold_medium,threshold_low:H.threshold_low})}else if(u.config)try{let e=JSON.parse(u.config);x.guardrail_info=e}catch(e){b.ZP.fromBackend("Invalid JSON in configuration"),c(!1);return}if("tool_permission"===p){if(0===V.rules.length){b.ZP.fromBackend("Add at least one tool permission rule"),c(!1);return}x.litellm_params.rules=V.rules,x.litellm_params.default_action=V.default_action,x.litellm_params.on_disallowed_action=V.on_disallowed_action,V.violation_message_template&&(x.litellm_params.violation_message_template=V.violation_message_template)}if(console.log("values: ",JSON.stringify(u)),P&&m){let e=null===(d=ed[m])||void 0===d?void 0:d.toLowerCase();console.log("providerKey: ",e);let t=P[e]||{},l=new Set;console.log("providerSpecificParams: ",JSON.stringify(t)),Object.keys(t).forEach(e=>{"optional_params"!==e&&l.add(e)}),t.optional_params&&t.optional_params.fields&&Object.keys(t.optional_params.fields).forEach(e=>{l.add(e)}),console.log("allowedParams: ",l),l.forEach(e=>{let t=u[e];if(null==t||""===t){var l;t=null===(l=u.optional_params)||void 0===l?void 0:l[e]}null!=t&&""!==t&&(x.litellm_params[e]=t)})}if(!a)throw Error("No access token available");console.log("Sending guardrail data:",JSON.stringify(x)),await (0,g.createGuardrailCall)(a,x),b.ZP.success("Guardrail created successfully"),el(),r(),l()}catch(e){console.error("Failed to create guardrail:",e),b.ZP.fromBackend("Failed to create guardrail: "+(e instanceof Error?e.message:String(e)))}finally{c(!1)}},en=()=>{var e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,s.jsx)(y.default,{placeholder:"Enter a name for this guardrail"})}),(0,s.jsx)(f.Z.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,s.jsx)(h.default,{placeholder:"Select a guardrail provider",onChange:$,labelInValue:!1,optionLabelProp:"label",dropdownRender:e=>e,showSearch:!0,children:Object.entries(eo()).map(e=>{let[t,l]=e;return(0,s.jsx)(eU,{value:t,label:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[eg[l]&&(0,s.jsx)("img",{src:eg[l],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,s.jsx)("span",{children:l})]}),children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[eg[l]&&(0,s.jsx)("img",{src:eg[l],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,s.jsx)("span",{children:l})]})},t)})})}),(0,s.jsx)(f.Z.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,s.jsx)(h.default,{optionLabelProp:"label",mode:"multiple",children:(null==p?void 0:null===(e=p.supported_modes)||void 0===e?void 0:e.map(e=>(0,s.jsx)(eU,{value:e,label:e,children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:e}),"pre_call"===e&&(0,s.jsx)(v.Z,{color:"green",style:{marginLeft:"8px"},children:"Recommended"})]}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eV[e]})]})},e)))||(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eU,{value:"pre_call",label:"pre_call",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"pre_call"})," ",(0,s.jsx)(v.Z,{color:"green",children:"Recommended"})]}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eV.pre_call})]})}),(0,s.jsx)(eU,{value:"during_call",label:"during_call",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:(0,s.jsx)("strong",{children:"during_call"})}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eV.during_call})]})}),(0,s.jsx)(eU,{value:"post_call",label:"post_call",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:(0,s.jsx)("strong",{children:"post_call"})}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eV.post_call})]})}),(0,s.jsx)(eU,{value:"logging_only",label:"logging_only",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:(0,s.jsx)("strong",{children:"logging_only"})}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eV.logging_only})]})})]})})}),(0,s.jsx)(f.Z.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default.",children:(0,s.jsxs)(h.default,{children:[(0,s.jsx)(h.default.Option,{value:!0,children:"Yes"}),(0,s.jsx)(h.default.Option,{value:!1,children:"No"})]})}),!Q&&!eu(m)&&(0,s.jsx)(e_,{selectedProvider:m,accessToken:a,providerParams:P})]})},ep=()=>p&&"PresidioPII"===m?(0,s.jsx)(eE,{entities:p.supported_entities,actions:p.supported_actions,selectedEntities:C,selectedActions:w,onEntitySelect:X,onActionSelect:ee,entityCategories:p.pii_entity_categories}):null,ex=e=>{if(!p||!eu(m))return null;let t=p.content_filter_settings;return t?(0,s.jsx)(ei,{prebuiltPatterns:t.prebuilt_patterns||[],categories:t.pattern_categories||[],selectedPatterns:E,blockedWords:G,onPatternAdd:e=>F([...E,e]),onPatternRemove:e=>F(E.filter(t=>t.id!==e)),onPatternActionChange:(e,t)=>{F(E.map(l=>l.id===e?{...l,action:t}:l))},onBlockedWordAdd:e=>M([...G,e]),onBlockedWordRemove:e=>M(G.filter(t=>t.id!==e)),onBlockedWordUpdate:(e,t,l)=>{M(G.map(a=>a.id===e?{...a,[t]:l}:a))},contentCategories:t.content_categories||[],selectedContentCategories:R,onContentCategoryAdd:e=>D([...R,e]),onContentCategoryRemove:e=>D(R.filter(t=>t.id!==e)),onContentCategoryUpdate:(e,t,l)=>{D(R.map(a=>a.id===e?{...a,[t]:l}:a))},pendingCategorySelection:K,onPendingCategorySelectionChange:J,accessToken:a,showStep:e,competitorIntentEnabled:q,competitorIntentConfig:H,onCompetitorIntentChange:(e,t)=>{W(e),U(t)}}):null},eh=()=>{var e;if(!m)return null;if(Q)return(0,s.jsx)(eJ,{value:V,onChange:Y});if(!P)return null;console.log("guardrail_provider_map: ",ed),console.log("selectedProvider: ",m);let t=null===(e=ed[m])||void 0===e?void 0:e.toLowerCase(),l=P&&P[t];return l&&l.optional_params?(0,s.jsx)(ev,{optionalParams:l.optional_params,parentFieldKey:"optional_params"}):null},ef=()=>{switch(k){case 0:return en();case 1:if(em(m))return ep();if(eu(m))return ex("categories");return eh();case 2:if(eu(m))return ex("patterns");return null;case 3:if(eu(m))return ex("keywords");return null;default:return null}},ey=eu(m)?[{title:"Basic Info",optional:!1},{title:"Default Categories",optional:!1},{title:"Patterns",optional:!1},{title:"Keywords",optional:!1}]:em(m)?[{title:"Basic Info",optional:!1},{title:"PII Configuration",optional:!1}]:[{title:"Basic Info",optional:!1},{title:"Provider Configuration",optional:!1}];return(0,s.jsx)(_.Z,{title:null,open:t,onCancel:ea,footer:null,width:1e3,closable:!1,className:"top-8",styles:{body:{padding:0}},children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[(0,s.jsx)("h3",{className:"text-base font-semibold text-gray-900 m-0",children:"Create guardrail"}),(0,s.jsx)("button",{onClick:ea,className:"text-gray-400 hover:text-gray-600 bg-transparent border-none cursor-pointer text-base leading-none p-1",children:"✕"})]}),(0,s.jsx)("div",{className:"overflow-auto px-6 py-4",style:{maxHeight:"calc(80vh - 120px)"},children:(0,s.jsx)(f.Z,{form:n,layout:"vertical",initialValues:{mode:"pre_call",default_on:!1},children:ey.map((e,t)=>{let l=t<k,a=t===k,r=t===ey.length-1;return(0,s.jsxs)("div",{className:"relative flex gap-4",style:{paddingBottom:r?0:8},children:[(0,s.jsxs)("div",{className:"flex flex-col items-center flex-shrink-0",style:{width:24},children:[(0,s.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium flex-shrink-0",style:{background:l?"#4f46e5":a?"#fff":"#f8fafc",color:l?"#fff":a?"#4f46e5":"#94a3b8",border:a?"2px solid #4f46e5":l?"none":"1px solid #e2e8f0"},children:l?"✓":t+1}),!r&&(0,s.jsx)("div",{className:"flex-1",style:{width:1,background:l?"#4f46e5":"#e2e8f0",minHeight:16}})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",style:{paddingBottom:r?0:16},children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 ".concat(l?"cursor-pointer":""),onClick:()=>{l&&Z(t)},style:{minHeight:24},children:[(0,s.jsx)("span",{className:"text-sm",style:{fontWeight:a?600:500,color:a?"#1e293b":l?"#4f46e5":"#94a3b8"},children:e.title}),e.optional&&!a&&(0,s.jsx)("span",{className:"text-[11px] text-slate-400",children:"optional"}),l&&(0,s.jsx)("span",{className:"text-[11px] text-indigo-500 hover:underline",children:"Edit"})]}),a&&(0,s.jsx)("div",{className:"mt-3",children:ef()})]})]},t)})})}),(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-3 px-6 py-3 border-t border-gray-200",children:[(0,s.jsx)(j.ZP,{onClick:ea,children:"Cancel"}),k>0&&(0,s.jsx)(j.ZP,{onClick:()=>{Z(k-1)},children:"Previous"}),k<ey.length-1?(0,s.jsx)(j.ZP,{type:"primary",onClick:et,children:"Next"}):(0,s.jsx)(j.ZP,{type:"primary",onClick:er,loading:d,children:"Create Guardrail"})]})]})})},eQ=l(78489),e$=l(47323),eX=l(21626),e0=l(97214),e1=l(28241),e2=l(58834),e4=l(69552),e8=l(71876),e6=l(74998),e5=l(44633),e3=l(86462),e9=l(49084),e7=l(1309),te=l(71594),tt=l(24525),tl=l(64504);let{Title:ta,Text:tr}=x.default,{Option:ti}=h.default;var tn=e=>{var t;let{visible:l,onClose:a,accessToken:r,onSuccess:i,guardrailId:n,initialValues:d}=e,[c]=f.Z.useForm(),[m,u]=(0,o.useState)(!1),[p,x]=(0,o.useState)((null==d?void 0:d.provider)||null),[v,j]=(0,o.useState)(null),[C,N]=(0,o.useState)([]),[w,S]=(0,o.useState)({});(0,o.useEffect)(()=>{(async()=>{try{if(!r)return;let e=await (0,g.getGuardrailUISettings)(r);j(e)}catch(e){console.error("Error fetching guardrail settings:",e),b.ZP.fromBackend("Failed to load guardrail settings")}})()},[r]),(0,o.useEffect)(()=>{(null==d?void 0:d.pii_entities_config)&&Object.keys(d.pii_entities_config).length>0&&(N(Object.keys(d.pii_entities_config)),S(d.pii_entities_config))},[d]);let k=e=>{N(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},Z=(e,t)=>{S(l=>({...l,[e]:t}))},P=async()=>{try{u(!0);let e=await c.validateFields(),t=ed[e.provider],l={guardrail_id:n,guardrail:{guardrail_name:e.guardrail_name,litellm_params:{guardrail:t,mode:e.mode,default_on:e.default_on},guardrail_info:{}}};if("PresidioPII"===e.provider&&C.length>0){let e={};C.forEach(t=>{e[t]=w[t]||"MASK"}),l.guardrail.litellm_params.pii_entities_config=e}else if(e.config)try{let t=JSON.parse(e.config);"Bedrock"===e.provider&&t?(t.guardrail_id&&(l.guardrail.litellm_params.guardrailIdentifier=t.guardrail_id),t.guardrail_version&&(l.guardrail.litellm_params.guardrailVersion=t.guardrail_version)):l.guardrail.guardrail_info=t}catch(e){b.ZP.fromBackend("Invalid JSON in configuration"),u(!1);return}if(!r)throw Error("No access token available");console.log("Sending guardrail update data:",JSON.stringify(l));let s=await fetch("/guardrails/".concat(n),{method:"PUT",headers:{[(0,g.getGlobalLitellmHeaderName)()]:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify(l)});if(!s.ok){let e=await s.text();throw Error(e||"Failed to update guardrail")}b.ZP.success("Guardrail updated successfully"),i(),a()}catch(e){console.error("Failed to update guardrail:",e),b.ZP.fromBackend("Failed to update guardrail: "+(e instanceof Error?e.message:String(e)))}finally{u(!1)}},I=()=>v&&p&&"PresidioPII"===p?(0,s.jsx)(eE,{entities:v.supported_entities,actions:v.supported_actions,selectedEntities:C,selectedActions:w,onEntitySelect:k,onActionSelect:Z,entityCategories:v.pii_entity_categories}):null;return(0,s.jsx)(_.Z,{title:"Edit Guardrail",open:l,onCancel:a,footer:null,width:700,children:(0,s.jsxs)(f.Z,{form:c,layout:"vertical",initialValues:d,children:[(0,s.jsx)(f.Z.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,s.jsx)(tl.o,{placeholder:"Enter a name for this guardrail"})}),(0,s.jsx)(f.Z.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,s.jsx)(h.default,{placeholder:"Select a guardrail provider",onChange:e=>{x(e),c.setFieldsValue({config:void 0}),N([]),S({})},disabled:!0,optionLabelProp:"label",children:Object.entries(eo()).map(e=>{let[t,l]=e;return(0,s.jsx)(ti,{value:t,label:l,children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[eg[l]&&(0,s.jsx)("img",{src:eg[l],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,s.jsx)("span",{children:l})]})},t)})})}),(0,s.jsx)(f.Z.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,s.jsx)(h.default,{children:(null==v?void 0:null===(t=v.supported_modes)||void 0===t?void 0:t.map(e=>(0,s.jsx)(ti,{value:e,children:e},e)))||(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ti,{value:"pre_call",children:"pre_call"}),(0,s.jsx)(ti,{value:"post_call",children:"post_call"})]})})}),(0,s.jsx)(f.Z.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default",valuePropName:"checked",children:(0,s.jsx)(Y.Z,{})}),(()=>{if(!p)return null;if("PresidioPII"===p)return I();switch(p){case"Aporia":return(0,s.jsx)(f.Z.Item,{label:"Aporia Configuration",name:"config",tooltip:"JSON configuration for Aporia",children:(0,s.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_aporia_api_key",\n  "project_name": "your_project_name"\n}'})});case"AimSecurity":return(0,s.jsx)(f.Z.Item,{label:"Aim Security Configuration",name:"config",tooltip:"JSON configuration for Aim Security",children:(0,s.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_aim_api_key"\n}'})});case"Bedrock":return(0,s.jsx)(f.Z.Item,{label:"Amazon Bedrock Configuration",name:"config",tooltip:"JSON configuration for Amazon Bedrock guardrails",children:(0,s.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "guardrail_id": "your_guardrail_id",\n  "guardrail_version": "your_guardrail_version"\n}'})});case"GuardrailsAI":return(0,s.jsx)(f.Z.Item,{label:"Guardrails.ai Configuration",name:"config",tooltip:"JSON configuration for Guardrails.ai",children:(0,s.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_guardrails_api_key",\n  "guardrail_id": "your_guardrail_id"\n}'})});case"LakeraAI":return(0,s.jsx)(f.Z.Item,{label:"Lakera AI Configuration",name:"config",tooltip:"JSON configuration for Lakera AI",children:(0,s.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_lakera_api_key"\n}'})});case"PromptInjection":return(0,s.jsx)(f.Z.Item,{label:"Prompt Injection Configuration",name:"config",tooltip:"JSON configuration for prompt injection detection",children:(0,s.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "threshold": 0.8\n}'})});default:return(0,s.jsx)(f.Z.Item,{label:"Custom Configuration",name:"config",tooltip:"JSON configuration for your custom guardrail",children:(0,s.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "key1": "value1",\n  "key2": "value2"\n}'})})}})(),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,s.jsx)(tl.z,{variant:"secondary",onClick:a,children:"Cancel"}),(0,s.jsx)(tl.z,{onClick:P,loading:m,children:"Update Guardrail"})]})]})})};(r=n||(n={})).DB="db",r.CONFIG="config";var ts=e=>{let{guardrailsList:t,isLoading:l,onDeleteClick:a,accessToken:r,onGuardrailUpdated:i,isAdmin:d=!1,onGuardrailClick:c}=e,[m,u]=(0,o.useState)([{id:"created_at",desc:!0}]),[p,g]=(0,o.useState)(!1),[x,h]=(0,o.useState)(null),f=e=>e?new Date(e).toLocaleString():"-",y=[{header:"Guardrail ID",accessorKey:"guardrail_id",cell:e=>(0,s.jsx)(eb.Z,{title:String(e.getValue()||""),children:(0,s.jsx)(eQ.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>e.getValue()&&c(e.getValue()),children:e.getValue()?"".concat(String(e.getValue()).slice(0,7),"..."):""})})},{header:"Name",accessorKey:"guardrail_name",cell:e=>{let{row:t}=e,l=t.original;return(0,s.jsx)(eb.Z,{title:l.guardrail_name,children:(0,s.jsx)("span",{className:"text-xs font-medium",children:l.guardrail_name||"-"})})}},{header:"Provider",accessorKey:"litellm_params.guardrail",cell:e=>{let{row:t}=e,{logo:l,displayName:a}=ex(t.original.litellm_params.guardrail);return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[l&&(0,s.jsx)("img",{src:l,alt:"".concat(a," logo"),className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,s.jsx)("span",{className:"text-xs",children:a})]})}},{header:"Mode",accessorKey:"litellm_params.mode",cell:e=>{let{row:t}=e,l=t.original;return(0,s.jsx)("span",{className:"text-xs",children:l.litellm_params.mode})}},{header:"Default On",accessorKey:"litellm_params.default_on",cell:e=>{var t,l;let{row:a}=e,r=a.original;return(0,s.jsx)(e7.C,{color:(null===(t=r.litellm_params)||void 0===t?void 0:t.default_on)?"green":"gray",className:"text-xs font-normal",size:"xs",children:(null===(l=r.litellm_params)||void 0===l?void 0:l.default_on)?"Default On":"Default Off"})}},{header:"Created At",accessorKey:"created_at",cell:e=>{let{row:t}=e,l=t.original;return(0,s.jsx)(eb.Z,{title:l.created_at,children:(0,s.jsx)("span",{className:"text-xs",children:f(l.created_at)})})}},{header:"Updated At",accessorKey:"updated_at",cell:e=>{let{row:t}=e,l=t.original;return(0,s.jsx)(eb.Z,{title:l.updated_at,children:(0,s.jsx)("span",{className:"text-xs",children:f(l.updated_at)})})}},{id:"actions",header:"Actions",cell:e=>{let{row:t}=e,l=t.original,r=l.guardrail_definition_location===n.CONFIG;return(0,s.jsx)("div",{className:"flex space-x-2",children:r?(0,s.jsx)(eb.Z,{title:"Config guardrail cannot be deleted on the dashboard. Please delete it from the config file.",children:(0,s.jsx)(e$.Z,{"data-testid":"config-delete-icon",icon:e6.Z,size:"sm",className:"cursor-not-allowed text-gray-400",title:"Config guardrail cannot be deleted on the dashboard. Please delete it from the config file.","aria-label":"Delete guardrail (config)"})}):(0,s.jsx)(eb.Z,{title:"Delete guardrail",children:(0,s.jsx)(e$.Z,{icon:e6.Z,size:"sm",onClick:()=>l.guardrail_id&&a(l.guardrail_id,l.guardrail_name||"Unnamed Guardrail"),className:"cursor-pointer hover:text-red-500"})})})}}],v=(0,te.b7)({data:t,columns:y,state:{sorting:m},onSortingChange:u,getCoreRowModel:(0,tt.sC)(),getSortedRowModel:(0,tt.tj)(),enableSorting:!0});return(0,s.jsxs)("div",{className:"rounded-lg custom-border relative",children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(eX.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,s.jsx)(e2.Z,{children:v.getHeaderGroups().map(e=>(0,s.jsx)(e8.Z,{children:e.headers.map(e=>(0,s.jsx)(e4.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,s.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,te.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,s.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,s.jsx)(e5.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,s.jsx)(e3.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,s.jsx)(e9.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,s.jsx)(e0.Z,{children:l?(0,s.jsx)(e8.Z,{children:(0,s.jsx)(e1.Z,{colSpan:y.length,className:"h-8 text-center",children:(0,s.jsx)("div",{className:"text-center text-gray-500",children:(0,s.jsx)("p",{children:"Loading..."})})})}):t.length>0?v.getRowModel().rows.map(e=>(0,s.jsx)(e8.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,s.jsx)(e1.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,te.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,s.jsx)(e8.Z,{children:(0,s.jsx)(e1.Z,{colSpan:y.length,className:"h-8 text-center",children:(0,s.jsx)("div",{className:"text-center text-gray-500",children:(0,s.jsx)("p",{children:"No guardrails found"})})})})})]})}),x&&(0,s.jsx)(tn,{visible:p,onClose:()=>g(!1),accessToken:r,onSuccess:()=>{g(!1),h(null),i()},guardrailId:x.guardrail_id||"",initialValues:{guardrail_name:x.guardrail_name||"",provider:Object.keys(ed).find(e=>ed[e]===(null==x?void 0:x.litellm_params.guardrail))||"",mode:x.litellm_params.mode,default_on:x.litellm_params.default_on,pii_entities_config:x.litellm_params.pii_entities_config,...x.guardrail_info}})]})},to=l(20347),td=l(59872),tc=l(10900),tm=l(41649),tu=l(12514),tp=l(67101),tg=l(12485),tx=l(18135),th=l(35242),tf=l(29706),ty=l(77991),tv=l(84264),tj=l(96761),t_=l(30401),tb=l(78867),tC=l(51653);let{Text:tN}=x.default,{Option:tw}=h.default;var tS=e=>{let{categories:t,onActionChange:l,onSeverityChange:a,onRemove:r,readOnly:i=!1}=e,n=[{title:"Category",dataIndex:"display_name",key:"display_name",render:(e,t)=>(0,s.jsxs)("div",{children:[(0,s.jsx)(tN,{strong:!0,children:e}),e!==t.category&&(0,s.jsx)("div",{children:(0,s.jsx)(tN,{type:"secondary",style:{fontSize:12},children:t.category})})]})},{title:"Severity Threshold",dataIndex:"severity_threshold",key:"severity_threshold",width:180,render:(e,t)=>i?(0,s.jsx)(v.Z,{color:{high:"red",medium:"orange",low:"yellow"}[e],children:e.toUpperCase()}):(0,s.jsxs)(h.default,{value:e,onChange:e=>null==a?void 0:a(t.id,e),style:{width:150},size:"small",children:[(0,s.jsx)(tw,{value:"high",children:"High"}),(0,s.jsx)(tw,{value:"medium",children:"Medium"}),(0,s.jsx)(tw,{value:"low",children:"Low"})]})},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,t)=>i?(0,s.jsx)(v.Z,{color:"BLOCK"===e?"red":"blue",children:e}):(0,s.jsxs)(h.default,{value:e,onChange:e=>null==l?void 0:l(t.id,e),style:{width:120},size:"small",children:[(0,s.jsx)(tw,{value:"BLOCK",children:"Block"}),(0,s.jsx)(tw,{value:"MASK",children:"Mask"})]})}];return(i||n.push({title:"",key:"actions",width:100,render:(e,t)=>(0,s.jsx)(j.ZP,{type:"text",danger:!0,size:"small",icon:(0,s.jsx)(E.Z,{}),onClick:()=>null==r?void 0:r(t.id),children:"Delete"})}),0===t.length)?(0,s.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:"No categories configured."}):(0,s.jsx)(z.Z,{dataSource:t,columns:n,rowKey:"id",pagination:!1,size:"small"})},tk=e=>{let{patterns:t,blockedWords:l,categories:a=[],readOnly:r=!0,onPatternActionChange:i,onPatternRemove:n,onBlockedWordUpdate:o,onBlockedWordRemove:d,onCategoryActionChange:c,onCategorySeverityChange:m,onCategoryRemove:u}=e;if(0===t.length&&0===l.length&&0===a.length)return null;let p=()=>{};return(0,s.jsxs)(s.Fragment,{children:[a.length>0&&(0,s.jsxs)(tu.Z,{className:"mt-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)(tv.Z,{className:"text-lg font-semibold",children:"Content Categories"}),(0,s.jsxs)(tm.Z,{color:"blue",children:[a.length," categories configured"]})]}),(0,s.jsx)(tS,{categories:a,onActionChange:r?void 0:c,onSeverityChange:r?void 0:m,onRemove:r?void 0:u,readOnly:r})]}),t.length>0&&(0,s.jsxs)(tu.Z,{className:"mt-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)(tv.Z,{className:"text-lg font-semibold",children:"Pattern Detection"}),(0,s.jsxs)(tm.Z,{color:"blue",children:[t.length," patterns configured"]})]}),(0,s.jsx)(M,{patterns:t,onActionChange:r?p:i||p,onRemove:r?p:n||p})]}),l.length>0&&(0,s.jsxs)(tu.Z,{className:"mt-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)(tv.Z,{className:"text-lg font-semibold",children:"Blocked Keywords"}),(0,s.jsxs)(tm.Z,{color:"blue",children:[l.length," keywords configured"]})]}),(0,s.jsx)(K,{keywords:l,onActionChange:r?p:o||p,onRemove:r?p:d||p})]})]})};let{Text:tZ}=x.default;var tP=e=>{var t,l;let{guardrailData:a,guardrailSettings:r,isEditing:i,accessToken:n,onDataChange:d,onUnsavedChanges:c}=e,[m,u]=(0,o.useState)([]),[p,g]=(0,o.useState)([]),[x,h]=(0,o.useState)([]),[f,y]=(0,o.useState)([]),[v,j]=(0,o.useState)([]),[_,b]=(0,o.useState)([]),[C,N]=(0,o.useState)(!1),[w,S]=(0,o.useState)(null),[k,Z]=(0,o.useState)(!1),[P,I]=(0,o.useState)(null);(0,o.useEffect)(()=>{var e,t,l,i,n,s,o,d;if(null==a?void 0:null===(e=a.litellm_params)||void 0===e?void 0:e.patterns){let e=a.litellm_params.patterns.map((e,t)=>({id:"pattern-".concat(t),type:"prebuilt"===e.pattern_type?"prebuilt":"custom",name:e.pattern_name||e.name,display_name:e.display_name,pattern:e.pattern,action:e.action||"BLOCK"}));u(e),y(e)}else u([]),y([]);if(null==a?void 0:null===(t=a.litellm_params)||void 0===t?void 0:t.blocked_words){let e=a.litellm_params.blocked_words.map((e,t)=>({id:"word-".concat(t),keyword:e.keyword,action:e.action||"BLOCK",description:e.description}));g(e),j(e)}else g([]),j([]);if((null==a?void 0:null===(i=a.litellm_params)||void 0===i?void 0:null===(l=i.categories)||void 0===l?void 0:l.length)>0){let e=(null==r?void 0:null===(s=r.content_filter_settings)||void 0===s?void 0:s.content_categories)?Object.fromEntries(r.content_filter_settings.content_categories.map(e=>[e.name,e])):{},t=a.litellm_params.categories.map((t,l)=>{var a;let r=e[t.category];return{id:"category-".concat(l),category:t.category,display_name:null!==(a=null==r?void 0:r.display_name)&&void 0!==a?a:t.category,action:t.action||"BLOCK",severity_threshold:t.severity_threshold||"medium"}});h(t),b(t)}else h([]),b([]);let c=null==a?void 0:null===(n=a.litellm_params)||void 0===n?void 0:n.competitor_intent_config;if(c&&"object"==typeof c){let e=!!(c.brand_self&&Array.isArray(c.brand_self)&&c.brand_self.length>0),t={competitor_intent_type:null!==(o=c.competitor_intent_type)&&void 0!==o?o:"airline",brand_self:Array.isArray(c.brand_self)?c.brand_self:[],locations:Array.isArray(c.locations)?c.locations:[],competitors:Array.isArray(c.competitors)?c.competitors:[],policy:null!==(d=c.policy)&&void 0!==d?d:{competitor_comparison:"refuse",possible_competitor_comparison:"reframe"},threshold_high:"number"==typeof c.threshold_high?c.threshold_high:.7,threshold_medium:"number"==typeof c.threshold_medium?c.threshold_medium:.45,threshold_low:"number"==typeof c.threshold_low?c.threshold_low:.3};N(e),S(t),Z(e),I(t)}else N(!1),S(null),Z(!1),I(null)},[a,null==r?void 0:null===(t=r.content_filter_settings)||void 0===t?void 0:t.content_categories]),(0,o.useEffect)(()=>{d&&d(m,p,x,C,w)},[m,p,x,C,w,d]);let A=o.useMemo(()=>{let e=JSON.stringify(m)!==JSON.stringify(f),t=JSON.stringify(p)!==JSON.stringify(v),l=JSON.stringify(x)!==JSON.stringify(_),a=C!==k||JSON.stringify(w)!==JSON.stringify(P);return e||t||l||a},[m,p,x,C,w,f,v,_,k,P]);return((0,o.useEffect)(()=>{i&&c&&c(A)},[A,i,c]),(null==a?void 0:null===(l=a.litellm_params)||void 0===l?void 0:l.guardrail)!=="litellm_content_filter")?null:i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eG.Z,{orientation:"left",children:"Content Filter Configuration"}),A&&(0,s.jsx)(tC.Z,{type:"warning",showIcon:!0,className:"mb-4",message:(0,s.jsx)(tZ,{children:'You have unsaved changes to patterns or keywords. Remember to click "Save Changes" at the bottom.'})}),(0,s.jsx)("div",{className:"mb-6",children:r&&r.content_filter_settings&&(0,s.jsx)(ei,{prebuiltPatterns:r.content_filter_settings.prebuilt_patterns||[],categories:r.content_filter_settings.pattern_categories||[],selectedPatterns:m,blockedWords:p,onPatternAdd:e=>u([...m,e]),onPatternRemove:e=>u(m.filter(t=>t.id!==e)),onPatternActionChange:(e,t)=>u(m.map(l=>l.id===e?{...l,action:t}:l)),onBlockedWordAdd:e=>g([...p,e]),onBlockedWordRemove:e=>g(p.filter(t=>t.id!==e)),onBlockedWordUpdate:(e,t,l)=>g(p.map(a=>a.id===e?{...a,[t]:l}:a)),onFileUpload:e=>{console.log("File uploaded:",e)},accessToken:n,contentCategories:r.content_filter_settings.content_categories||[],selectedContentCategories:x,onContentCategoryAdd:e=>h([...x,e]),onContentCategoryRemove:e=>h(x.filter(t=>t.id!==e)),onContentCategoryUpdate:(e,t,l)=>h(x.map(a=>a.id===e?{...a,[t]:l}:a)),competitorIntentEnabled:C,competitorIntentConfig:w,onCompetitorIntentChange:(e,t)=>{N(e),S(t)}})})]}):(0,s.jsx)(tk,{patterns:m,blockedWords:p,categories:x,readOnly:!0})};let tI=(e,t,l,a,r)=>{let i={patterns:e.map(e=>({pattern_type:"prebuilt"===e.type?"prebuilt":"regex",pattern_name:"prebuilt"===e.type?e.name:void 0,pattern:"custom"===e.type?e.pattern:void 0,name:e.name,action:e.action})),blocked_words:t.map(e=>({keyword:e.keyword,action:e.action,description:e.description}))};if(void 0!==l&&(i.categories=l.map(e=>({category:e.category,enabled:!0,action:e.action,severity_threshold:e.severity_threshold||"medium"}))),a&&r&&r.brand_self.length>0){var n,s;i.competitor_intent_config={competitor_intent_type:r.competitor_intent_type,brand_self:r.brand_self,locations:(null===(n=r.locations)||void 0===n?void 0:n.length)?r.locations:void 0,competitors:"generic"===r.competitor_intent_type&&(null===(s=r.competitors)||void 0===s?void 0:s.length)?r.competitors:void 0,policy:r.policy,threshold_high:r.threshold_high,threshold_medium:r.threshold_medium,threshold_low:r.threshold_low}}return i};var tA=l(83683),tO=l(11741),tL=l(28291),tB=l(28595),tT=l(81770),tz=l(83669),tE=l(78355);let{Panel:tF}=J.default,{TextArea:tG}=y.default,tM={empty:{name:"Empty Template",code:'async def apply_guardrail(inputs, request_data, input_type):\n    # inputs: {texts, images, tools, tool_calls, structured_messages, model}\n    # request_data: {model, user_id, team_id, end_user_id, metadata}\n    # input_type: "request" or "response"\n    return allow()'},blockSSN:{name:"Block SSN",code:'def apply_guardrail(inputs, request_data, input_type):\n    for text in inputs["texts"]:\n        if regex_match(text, r"\\d{3}-\\d{2}-\\d{4}"):\n            return block("SSN detected")\n    return allow()'},redactEmail:{name:"Redact Emails",code:'def apply_guardrail(inputs, request_data, input_type):\n    pattern = r"[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"\n    modified = []\n    for text in inputs["texts"]:\n        modified.append(regex_replace(text, pattern, "[EMAIL REDACTED]"))\n    return modify(texts=modified)'},blockSQL:{name:"Block SQL Injection",code:'def apply_guardrail(inputs, request_data, input_type):\n    if input_type != "request":\n        return allow()\n    for text in inputs["texts"]:\n        if contains_code_language(text, ["sql"]):\n            return block("SQL code not allowed")\n    return allow()'},validateJSON:{name:"Validate JSON",code:'def apply_guardrail(inputs, request_data, input_type):\n    if input_type != "response":\n        return allow()\n    \n    schema = {"type": "object", "required": ["name", "value"]}\n    \n    for text in inputs["texts"]:\n        obj = json_parse(text)\n        if obj is None:\n            return block("Invalid JSON response")\n        if not json_schema_valid(obj, schema):\n            return block("Response missing required fields")\n    return allow()'},externalAPI:{name:"External API Check (async)",code:'async def apply_guardrail(inputs, request_data, input_type):\n    # Call an external moderation API (async for non-blocking)\n    for text in inputs["texts"]:\n        response = await http_post(\n            "https://api.example.com/moderate",\n            body={"text": text, "user_id": request_data["user_id"]},\n            headers={"Authorization": "Bearer YOUR_API_KEY"},\n            timeout=10\n        )\n        \n        if not response["success"]:\n            # API call failed, allow by default or block\n            return allow()\n        \n        if response["body"].get("flagged"):\n            return block(response["body"].get("reason", "Content flagged"))\n    \n    return allow()'}},tR={"Return Values":[{name:"allow()",desc:"Let request/response through"},{name:"block(reason)",desc:"Reject with message"},{name:"modify(texts=[], images=[], tool_calls=[])",desc:"Transform content"}],"HTTP Requests (async)":[{name:"await http_request(url, method, headers, body)",desc:"Make async HTTP request"},{name:"await http_get(url, headers)",desc:"Async GET request"},{name:"await http_post(url, body, headers)",desc:"Async POST request"}],"Regex Functions":[{name:"regex_match(text, pattern)",desc:"Returns True if pattern found"},{name:"regex_replace(text, pattern, replacement)",desc:"Replace all matches"},{name:"regex_find_all(text, pattern)",desc:"Return list of matches"}],"JSON Functions":[{name:"json_parse(text)",desc:"Parse JSON string, returns None on error"},{name:"json_stringify(obj)",desc:"Convert to JSON string"},{name:"json_schema_valid(obj, schema)",desc:"Validate against JSON schema"}],"URL Functions":[{name:"extract_urls(text)",desc:"Extract all URLs from text"},{name:"is_valid_url(url)",desc:"Check if URL is valid"},{name:"all_urls_valid(text)",desc:"Check all URLs in text are valid"}],"Code Detection":[{name:"detect_code(text)",desc:"Returns True if code detected"},{name:"detect_code_languages(text)",desc:"Returns list of detected languages"},{name:'contains_code_language(text, ["sql"])',desc:"Check for specific languages"}],"Text Utilities":[{name:"contains(text, substring)",desc:"Check if substring exists"},{name:"contains_any(text, [substr1, substr2])",desc:"Check if any substring exists"},{name:"word_count(text)",desc:"Count words"},{name:"char_count(text)",desc:"Count characters"},{name:"lower(text) / upper(text) / trim(text)",desc:"String transforms"}]},tD=[{value:"pre_call",label:"pre_call (Request)"},{value:"post_call",label:"post_call (Response)"},{value:"during_call",label:"during_call (Parallel)"},{value:"logging_only",label:"logging_only"},{value:"pre_mcp_call",label:"pre_mcp_call (Before MCP Tool Call)"},{value:"post_mcp_call",label:"post_mcp_call (After MCP Tool Call)"},{value:"during_mcp_call",label:"during_mcp_call (During MCP Tool Call)"}];var tK=e=>{let{visible:t,onClose:l,onSuccess:a,accessToken:r,editData:i}=e,n=!!i,[d,c]=(0,o.useState)(""),[m,p]=(0,o.useState)(["pre_call"]),[x,f]=(0,o.useState)(!1),[y,v]=(0,o.useState)("empty"),[j,C]=(0,o.useState)(tM.empty.code),[N,w]=(0,o.useState)(!1),[S,k]=(0,o.useState)(!1),[Z,P]=(0,o.useState)(!1),I={texts:["Hello, my SSN is 123-45-6789"],images:[],tools:[{type:"function",function:{name:"get_weather",description:"Get the current weather in a location",parameters:{type:"object",properties:{location:{type:"string",description:"City name"}},required:["location"]}}}],tool_calls:[],structured_messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:"Hello, my SSN is 123-45-6789"}],model:"gpt-4"},A={texts:["The weather in San Francisco is 72\xb0F and sunny."],images:[],tools:[],tool_calls:[{id:"call_abc123",type:"function",function:{name:"get_weather",arguments:'{"location": "San Francisco"}'}}],structured_messages:[],model:"gpt-4"},O={texts:['Tool: read_wiki_structure\nArguments: {"repoName": "BerriAI/litellm"}'],images:[],tools:[{type:"function",function:{name:"read_wiki_structure",description:"Read the structure of a GitHub repository (MCP tool passed as OpenAI tool)",parameters:{type:"object",properties:{repoName:{type:"string",description:"Repository name, e.g. BerriAI/litellm"}},required:["repoName"]}}}],tool_calls:[{id:"call_mcp_001",type:"function",function:{name:"read_wiki_structure",arguments:'{"repoName": "BerriAI/litellm"}'}}],structured_messages:[{role:"user",content:'Tool: read_wiki_structure\nArguments: {"repoName": "BerriAI/litellm"}'}],model:"mcp-tool-call"},[L,B]=(0,o.useState)(JSON.stringify(I,null,2)),[T,z]=(0,o.useState)(null),[E,F]=(0,o.useState)(null),G=(0,o.useRef)(null),M=e=>null==e?["pre_call"]:Array.isArray(e)?e.length?e:["pre_call"]:[e];(0,o.useEffect)(()=>{if(t){if(i){var e,l,a;c(i.guardrail_name||""),p(M(null===(e=i.litellm_params)||void 0===e?void 0:e.mode)),f((null===(l=i.litellm_params)||void 0===l?void 0:l.default_on)||!1),C((null===(a=i.litellm_params)||void 0===a?void 0:a.custom_code)||tM.empty.code),v("")}else c(""),p(["pre_call"]),f(!1),v("empty"),C(tM.empty.code);z(null),P(!1)}},[t,i]);let R=async e=>{try{await navigator.clipboard.writeText(e),F(e),setTimeout(()=>F(null),2e3)}catch(e){console.error("Failed to copy:",e)}},D=async()=>{if(!d.trim()){b.ZP.fromBackend("Please enter a guardrail name");return}if(!j.trim()){b.ZP.fromBackend("Please enter custom code");return}if(!r){b.ZP.fromBackend("No access token available");return}w(!0);try{if(n&&i){var e,t;let l={litellm_params:{custom_code:j}};d!==i.guardrail_name&&(l.guardrail_name=d);let a=M(null===(e=i.litellm_params)||void 0===e?void 0:e.mode);(m.length!==a.length||m.some((e,t)=>e!==a[t]))&&(l.litellm_params.mode=m),x!==(null===(t=i.litellm_params)||void 0===t?void 0:t.default_on)&&(l.litellm_params.default_on=x),await (0,g.updateGuardrailCall)(r,i.guardrail_id,l),b.ZP.success("Custom code guardrail updated successfully")}else await (0,g.createGuardrailCall)(r,{guardrail_name:d,litellm_params:{guardrail:"custom_code",mode:m,default_on:x,custom_code:j},guardrail_info:{}}),b.ZP.success("Custom code guardrail created successfully");a(),l()}catch(e){console.error("Failed to save guardrail:",e),b.ZP.fromBackend("Failed to ".concat(n?"update":"create"," guardrail: ")+(e instanceof Error?e.message:String(e)))}finally{w(!1)}},K=async()=>{if(!r){z({error:"No access token available"});return}k(!0),z(null);try{let e;try{e=JSON.parse(L)}catch(e){z({error:"Invalid test input JSON"}),k(!1);return}e.texts||(e.texts=[]);let t=["pre_call","pre_mcp_call"],l=["post_call","post_mcp_call"],a=m.some(e=>t.includes(e))?"request":m.some(e=>l.includes(e))?"response":"request",i=await (0,g.testCustomCodeGuardrail)(r,{custom_code:j,test_input:e,input_type:a,request_data:{model:"test-model",metadata:{}}});i.success&&i.result?z(i.result):i.error?z({error:i.error,error_type:i.error_type}):z({error:"Unknown error occurred"})}catch(e){console.error("Failed to test custom code:",e),z({error:e instanceof Error?e.message:"Failed to test custom code"})}finally{k(!1)}},q=j.split("\n").length;return(0,s.jsxs)(_.Z,{open:t,onCancel:l,footer:null,width:1400,className:"custom-code-modal",closable:!0,destroyOnClose:!0,children:[(0,s.jsxs)("div",{className:"flex flex-col h-[80vh]",children:[(0,s.jsxs)("div",{className:"pb-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Custom Guardrail":"Create Custom Guardrail"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Define custom logic using Python-like syntax"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 py-4 border-b border-gray-100",children:[(0,s.jsxs)("div",{className:"flex-1 max-w-[200px]",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Guardrail Name"}),(0,s.jsx)(tl.o,{value:d,onValueChange:c,placeholder:"e.g., block-pii-custom"})]}),(0,s.jsxs)("div",{className:"w-[280px]",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Mode (can select multiple)"}),(0,s.jsx)(h.default,{mode:"multiple",value:m,onChange:p,options:tD,className:"w-full",size:"middle",placeholder:"Select modes"})]}),(0,s.jsxs)("div",{className:"w-[180px]",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Template"}),(0,s.jsx)(h.default,{value:y,onChange:e=>{v(e),C(tM[e].code)},className:"w-full",size:"middle",dropdownRender:e=>(0,s.jsxs)(s.Fragment,{children:[e,(0,s.jsx)(eG.Z,{style:{margin:"8px 0"}}),(0,s.jsxs)("div",{style:{padding:"8px 12px",cursor:"pointer",color:"#1890ff",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},onClick:e=>{e.preventDefault(),window.open("https://models.litellm.ai/guardrails","_blank")},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f0f0f0"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[(0,s.jsx)(tA.Z,{}),(0,s.jsx)("span",{children:"Browse Community templates"}),(0,s.jsx)(tO.Z,{style:{fontSize:"10px"}})]})]}),children:(0,s.jsx)(h.default.OptGroup,{label:"STANDARD",children:Object.entries(tM).map(e=>{let[t,l]=e;return(0,s.jsx)(h.default.Option,{value:t,children:l.name},t)})})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 pt-5",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Default On"}),(0,s.jsx)(Y.Z,{checked:x,onChange:f})]})]}),(0,s.jsxs)("div",{className:"flex flex-1 overflow-hidden mt-4 gap-6",children:[(0,s.jsxs)("div",{className:"flex-[2] flex flex-col min-w-0 overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2 flex-shrink-0",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Python Logic"}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"Restricted environment (no imports)"})]}),(0,s.jsxs)("div",{className:"relative rounded-lg overflow-hidden border border-gray-700 bg-[#1e1e1e] flex-shrink-0",style:{minHeight:"300px",maxHeight:"400px"},children:[(0,s.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-12 bg-[#1e1e1e] border-r border-gray-700 text-right pr-3 pt-3 select-none overflow-hidden",style:{fontFamily:"'Fira Code', 'Monaco', 'Consolas', monospace",fontSize:"14px",lineHeight:"1.6"},children:Array.from({length:Math.max(q,20)},(e,t)=>(0,s.jsx)("div",{className:"text-gray-500 h-[22.4px]",children:t+1},t+1))}),(0,s.jsx)("textarea",{ref:G,value:j,onChange:e=>C(e.target.value),onKeyDown:e=>{if("Tab"===e.key){e.preventDefault();let t=e.currentTarget,l=t.selectionStart,a=t.selectionEnd;C(j.substring(0,l)+"    "+j.substring(a)),setTimeout(()=>{t.selectionStart=t.selectionEnd=l+4},0)}},spellCheck:!1,className:"w-full h-full pl-14 pr-4 pt-3 pb-3 resize-none focus:outline-none bg-transparent text-gray-200",style:{fontFamily:"'Fira Code', 'Monaco', 'Consolas', monospace",fontSize:"14px",lineHeight:"1.6",tabSize:4}})]}),(0,s.jsx)(J.default,{activeKey:Z?["test"]:[],onChange:e=>P(e.includes("test")),className:"mt-3 bg-white border border-gray-200 rounded-lg flex-shrink-0",expandIcon:e=>{let{isActive:t}=e;return(0,s.jsx)(tL.Z,{rotate:t?90:0})},children:(0,s.jsx)(tF,{header:(0,s.jsxs)("span",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,s.jsx)(tB.Z,{className:"text-blue-500"}),"Test Your Guardrail"]}),children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-600",children:"Test Input (JSON)"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Load example:"}),(0,s.jsx)("button",{type:"button",onClick:()=>B(JSON.stringify(I,null,2)),className:"px-2 py-1 text-xs rounded border border-orange-200 bg-orange-50 text-orange-700 hover:bg-orange-100 transition-colors",children:"Pre-call"}),(0,s.jsx)("button",{type:"button",onClick:()=>B(JSON.stringify(O,null,2)),className:"px-2 py-1 text-xs rounded border border-purple-200 bg-purple-50 text-purple-700 hover:bg-purple-100 transition-colors",children:"Pre MCP"}),(0,s.jsx)("button",{type:"button",onClick:()=>B(JSON.stringify(A,null,2)),className:"px-2 py-1 text-xs rounded border border-green-200 bg-green-50 text-green-700 hover:bg-green-100 transition-colors",children:"Post-call"})]})]}),(0,s.jsx)("div",{className:"mb-2 p-2 bg-gray-50 rounded text-xs text-gray-600 border border-gray-200",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"texts"}),": Message content (always)"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"images"}),": Base64 images (vision)"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"tools"}),": Tool definitions ",(0,s.jsx)("span",{className:"text-orange-600",children:"(pre_call)"}),", MCP as OpenAI tool ",(0,s.jsx)("span",{className:"text-purple-600",children:"(pre_mcp_call)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"tool_calls"}),": LLM tool calls ",(0,s.jsx)("span",{className:"text-green-600",children:"(post_call)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"structured_messages"}),": Full messages ",(0,s.jsx)("span",{className:"text-orange-600",children:"(pre_call)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"model"}),": Model name (always)"]})]})}),(0,s.jsx)(tG,{value:L,onChange:e=>B(e.target.value),rows:8,className:"font-mono text-xs",placeholder:'{"texts": ["test message"], ...}'})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(tl.z,{size:"xs",onClick:K,disabled:S,icon:tB.Z,children:S?"Running...":"Run Test"}),T&&(0,s.jsx)("div",{className:"flex items-center gap-2 text-sm ".concat(T.error?"text-red-600":"allow"===T.action?"text-green-600":"block"===T.action?"text-orange-600":"text-blue-600"),children:T.error?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tT.Z,{}),(0,s.jsxs)("span",{children:[T.error_type&&(0,s.jsxs)("span",{className:"font-medium",children:["[",T.error_type,"] "]}),T.error]})]}):"allow"===T.action?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tz.Z,{})," Allowed"]}):"block"===T.action?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tT.Z,{})," Blocked: ",T.reason]}):"modify"===T.action?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tz.Z,{})," Modified",T.texts&&T.texts.length>0&&(0,s.jsxs)("span",{className:"text-xs text-gray-500 ml-1",children:["→ ",T.texts[0].substring(0,50),T.texts[0].length>50?"...":""]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tz.Z,{})," ",T.action||"Unknown"]})})]})]})},"test")}),(0,s.jsxs)("div",{className:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg flex items-center justify-between flex-shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"bg-blue-100 rounded-full p-2",children:(0,s.jsx)(tA.Z,{className:"text-blue-600 text-lg"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Built a useful guardrail?"}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Share it with the community and help others build faster"})]})]}),(0,s.jsx)(tl.z,{size:"xs",onClick:()=>window.open("https://github.com/BerriAI/litellm-guardrails","_blank"),icon:tO.Z,className:"bg-blue-600 hover:bg-blue-700 text-white border-0",children:"Contribute Template"})]})]}),(0,s.jsxs)("div",{className:"w-[300px] flex-shrink-0 overflow-auto border-l border-gray-200 pl-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(u.Z,{className:"text-blue-500"}),(0,s.jsx)("span",{className:"font-semibold text-gray-700",children:"Available Primitives"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:"Click to copy functions to clipboard"}),(0,s.jsx)(J.default,{defaultActiveKey:["Return Values"],className:"primitives-collapse bg-transparent border-0",expandIconPosition:"end",children:Object.entries(tR).map(e=>{let[t,l]=e;return(0,s.jsx)(tF,{header:(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:t}),className:"bg-white mb-2 rounded-lg border border-gray-200",children:(0,s.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,s.jsx)("button",{onClick:()=>R(e.name),className:"w-full text-left px-2 py-2 rounded transition-colors ".concat(E===e.name?"bg-green-100":"bg-gray-50 hover:bg-blue-50"),children:E===e.name?(0,s.jsxs)("span",{className:"flex items-center gap-1 text-xs font-mono text-green-700",children:[(0,s.jsx)(tz.Z,{})," Copied!"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-xs font-mono text-gray-800",children:e.name}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500 mt-0.5",children:e.desc})]})},e.name))})},t)})})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-4 mt-4 border-t border-gray-200",children:[(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"Changes are auto-saved to local draft"}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(tl.z,{variant:"secondary",onClick:l,children:"Cancel"}),(0,s.jsx)(tl.z,{onClick:D,loading:N,disabled:N||!d.trim(),icon:tE.Z,children:n?"Update Guardrail":"Save Guardrail"})]})]})]}),(0,s.jsx)("style",{children:"\n        .custom-code-modal .ant-modal-content {\n          padding: 24px;\n        }\n        .custom-code-modal .ant-modal-close {\n          top: 20px;\n          right: 20px;\n        }\n        .primitives-collapse .ant-collapse-item {\n          border: none !important;\n        }\n        .primitives-collapse .ant-collapse-header {\n          padding: 8px 12px !important;\n        }\n        .primitives-collapse .ant-collapse-content-box {\n          padding: 8px 12px !important;\n        }\n      "})]})},tJ=e=>{var t,l,a,r,i,n,d,c,m,p,x,v,_,C,N,w,S,k,Z,P;let{guardrailId:I,onClose:A,accessToken:O,isAdmin:L}=e,[B,T]=(0,o.useState)(null),[z,E]=(0,o.useState)(null),[F,G]=(0,o.useState)(!0),[M,R]=(0,o.useState)(!1),[D]=f.Z.useForm(),[K,J]=(0,o.useState)([]),[q,W]=(0,o.useState)({}),[H,U]=(0,o.useState)(null),[V,Y]=(0,o.useState)({}),[Q,$]=(0,o.useState)(!1),X={rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""},[ee,et]=(0,o.useState)(X),[el,ea]=(0,o.useState)(!1),[er,ei]=(0,o.useState)(!1),en=o.useRef({patterns:[],blockedWords:[],categories:[]}),es=(0,o.useCallback)((e,t,l,a,r)=>{en.current={patterns:e,blockedWords:t,categories:l||[],competitorIntentEnabled:a,competitorIntentConfig:r}},[]),eo=async()=>{try{var e;if(G(!0),!O)return;let t=await (0,g.getGuardrailInfo)(O,I);if(T(t),null===(e=t.litellm_params)||void 0===e?void 0:e.pii_entities_config){let e=t.litellm_params.pii_entities_config;if(J([]),W({}),Object.keys(e).length>0){let t=[],l={};Object.entries(e).forEach(e=>{let[a,r]=e;t.push(a),l[a]="string"==typeof r?r:"MASK"}),J(t),W(l)}}else J([]),W({})}catch(e){b.ZP.fromBackend("Failed to load guardrail information"),console.error("Error fetching guardrail info:",e)}finally{G(!1)}},ec=async()=>{try{if(!O)return;let e=await (0,g.getGuardrailProviderSpecificParams)(O);E(e)}catch(e){console.error("Error fetching guardrail provider specific params:",e)}},em=async()=>{try{if(!O)return;let e=await (0,g.getGuardrailUISettings)(O);U(e)}catch(e){console.error("Error fetching guardrail UI settings:",e)}};(0,o.useEffect)(()=>{ec()},[O]),(0,o.useEffect)(()=>{eo(),em()},[I,O]),(0,o.useEffect)(()=>{if(B&&D){var e;D.setFieldsValue({guardrail_name:B.guardrail_name,...B.litellm_params,guardrail_info:B.guardrail_info?JSON.stringify(B.guardrail_info,null,2):"",...(null===(e=B.litellm_params)||void 0===e?void 0:e.optional_params)&&{optional_params:B.litellm_params.optional_params}})}},[B,z,D]);let eu=(0,o.useCallback)(()=>{var e,t,l,a,r;(null==B?void 0:null===(e=B.litellm_params)||void 0===e?void 0:e.guardrail)==="tool_permission"?et({rules:(null===(t=B.litellm_params)||void 0===t?void 0:t.rules)||[],default_action:((null===(l=B.litellm_params)||void 0===l?void 0:l.default_action)||"deny").toLowerCase(),on_disallowed_action:((null===(a=B.litellm_params)||void 0===a?void 0:a.on_disallowed_action)||"block").toLowerCase(),violation_message_template:(null===(r=B.litellm_params)||void 0===r?void 0:r.violation_message_template)||""}):et(X),ea(!1)},[B]);(0,o.useEffect)(()=>{eu()},[eu]);let ep=async e=>{try{var t,l,a,r,i,n,s,o,d,c,m;if(!O)return;let u={litellm_params:{}};e.guardrail_name!==B.guardrail_name&&(u.guardrail_name=e.guardrail_name),e.default_on!==(null===(t=B.litellm_params)||void 0===t?void 0:t.default_on)&&(u.litellm_params.default_on=e.default_on);let p=B.guardrail_info,x=e.guardrail_info?JSON.parse(e.guardrail_info):void 0;JSON.stringify(p)!==JSON.stringify(x)&&(u.guardrail_info=x);let h=(null===(l=B.litellm_params)||void 0===l?void 0:l.pii_entities_config)||{},f={};if(K.forEach(e=>{f[e]=q[e]||"MASK"}),JSON.stringify(h)!==JSON.stringify(f)&&(u.litellm_params.pii_entities_config=f),(null===(a=B.litellm_params)||void 0===a?void 0:a.guardrail)==="litellm_content_filter"&&Q){let e=tI(en.current.patterns||[],en.current.blockedWords||[],en.current.categories||[],en.current.competitorIntentEnabled,en.current.competitorIntentConfig);u.litellm_params.patterns=e.patterns,u.litellm_params.blocked_words=e.blocked_words,u.litellm_params.categories=e.categories,u.litellm_params.competitor_intent_config=null!==(n=e.competitor_intent_config)&&void 0!==n?n:null}if((null===(r=B.litellm_params)||void 0===r?void 0:r.guardrail)==="tool_permission"){let e=(null===(s=B.litellm_params)||void 0===s?void 0:s.rules)||[],t=ee.rules||[],l=JSON.stringify(e)!==JSON.stringify(t),a=((null===(o=B.litellm_params)||void 0===o?void 0:o.default_action)||"deny").toLowerCase(),r=(ee.default_action||"deny").toLowerCase(),i=a!==r,n=((null===(d=B.litellm_params)||void 0===d?void 0:d.on_disallowed_action)||"block").toLowerCase(),m=(ee.on_disallowed_action||"block").toLowerCase(),p=n!==m,g=(null===(c=B.litellm_params)||void 0===c?void 0:c.violation_message_template)||"",x=ee.violation_message_template||"",h=g!==x;(el||l||i||p||h)&&(u.litellm_params.rules=t,u.litellm_params.default_action=r,u.litellm_params.on_disallowed_action=m,u.litellm_params.violation_message_template=x||null)}let y=Object.keys(ed).find(e=>{var t;return ed[e]===(null===(t=B.litellm_params)||void 0===t?void 0:t.guardrail)});console.log("values: ",JSON.stringify(e)),console.log("currentProvider: ",y);let v=(null===(i=B.litellm_params)||void 0===i?void 0:i.guardrail)==="tool_permission";if(z&&y&&!v){let t=z[null===(m=ed[y])||void 0===m?void 0:m.toLowerCase()]||{},l=new Set;console.log("providerSpecificParams: ",JSON.stringify(t)),Object.keys(t).forEach(e=>{"optional_params"!==e&&l.add(e)}),t.optional_params&&t.optional_params.fields&&Object.keys(t.optional_params.fields).forEach(e=>{l.add(e)}),console.log("allowedParams: ",l),l.forEach(t=>{var l,a;if("patterns"===t||"blocked_words"===t||"categories"===t)return;let r=e[t];(null==r||""===r)&&(r=null===(a=e.optional_params)||void 0===a?void 0:a[t]);let i=null===(l=B.litellm_params)||void 0===l?void 0:l[t];JSON.stringify(r)!==JSON.stringify(i)&&(null!=r&&""!==r?u.litellm_params[t]=r:null!=i&&""!==i&&(u.litellm_params[t]=null))})}if(0===Object.keys(u.litellm_params).length&&delete u.litellm_params,0===Object.keys(u).length){b.ZP.info("No changes detected"),R(!1);return}await (0,g.updateGuardrailCall)(O,I,u),b.ZP.success("Guardrail updated successfully"),$(!1),eo(),R(!1)}catch(e){console.error("Error updating guardrail:",e),b.ZP.fromBackend("Failed to update guardrail")}};if(F)return(0,s.jsx)("div",{className:"p-4",children:"Loading..."});if(!B)return(0,s.jsx)("div",{className:"p-4",children:"Guardrail not found"});let eg=e=>e?new Date(e).toLocaleString():"-",{logo:eh,displayName:ef}=ex((null===(t=B.litellm_params)||void 0===t?void 0:t.guardrail)||""),ey=async(e,t)=>{await (0,td.vQ)(e)&&(Y(e=>({...e,[t]:!0})),setTimeout(()=>{Y(e=>({...e,[t]:!1}))},2e3))},ej="config"===B.guardrail_definition_location;return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(j.ZP,{type:"text",icon:(0,s.jsx)(tc.Z,{className:"w-4 h-4"}),onClick:A,className:"mb-4",children:"Back to Guardrails"}),(0,s.jsx)(tj.Z,{children:B.guardrail_name||"Unnamed Guardrail"}),(0,s.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,s.jsx)(tv.Z,{className:"text-gray-500 font-mono",children:B.guardrail_id}),(0,s.jsx)(j.ZP,{type:"text",size:"small",icon:V["guardrail-id"]?(0,s.jsx)(t_.Z,{size:12}):(0,s.jsx)(tb.Z,{size:12}),onClick:()=>ey(B.guardrail_id,"guardrail-id"),className:"left-2 z-10 transition-all duration-200 ".concat(V["guardrail-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),(0,s.jsxs)(tx.Z,{children:[(0,s.jsxs)(th.Z,{className:"mb-4",children:[(0,s.jsx)(tg.Z,{children:"Overview"},"overview"),L?(0,s.jsx)(tg.Z,{children:"Settings"},"settings"):(0,s.jsx)(s.Fragment,{})]}),(0,s.jsxs)(ty.Z,{children:[(0,s.jsxs)(tf.Z,{children:[(0,s.jsxs)(tp.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,s.jsxs)(tu.Z,{children:[(0,s.jsx)(tv.Z,{children:"Provider"}),(0,s.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[eh&&(0,s.jsx)("img",{src:eh,alt:"".concat(ef," logo"),className:"w-6 h-6",onError:e=>{e.target.style.display="none"}}),(0,s.jsx)(tj.Z,{children:ef})]})]}),(0,s.jsxs)(tu.Z,{children:[(0,s.jsx)(tv.Z,{children:"Mode"}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)(tj.Z,{children:(null===(l=B.litellm_params)||void 0===l?void 0:l.mode)||"-"}),(0,s.jsx)(tm.Z,{color:(null===(a=B.litellm_params)||void 0===a?void 0:a.default_on)?"green":"gray",children:(null===(r=B.litellm_params)||void 0===r?void 0:r.default_on)?"Default On":"Default Off"})]})]}),(0,s.jsxs)(tu.Z,{children:[(0,s.jsx)(tv.Z,{children:"Created At"}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)(tj.Z,{children:eg(B.created_at)}),(0,s.jsxs)(tv.Z,{children:["Last Updated: ",eg(B.updated_at)]})]})]})]}),(null===(i=B.litellm_params)||void 0===i?void 0:i.pii_entities_config)&&Object.keys(B.litellm_params.pii_entities_config).length>0&&(0,s.jsx)(tu.Z,{className:"mt-6",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(tv.Z,{className:"font-medium",children:"PII Protection"}),(0,s.jsxs)(tm.Z,{color:"blue",children:[Object.keys(B.litellm_params.pii_entities_config).length," PII entities configured"]})]})}),(null===(n=B.litellm_params)||void 0===n?void 0:n.pii_entities_config)&&Object.keys(B.litellm_params.pii_entities_config).length>0&&(0,s.jsxs)(tu.Z,{className:"mt-6",children:[(0,s.jsx)(tv.Z,{className:"mb-4 text-lg font-semibold",children:"PII Entity Configuration"}),(0,s.jsxs)("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[(0,s.jsxs)("div",{className:"bg-gray-50 px-5 py-3 border-b flex",children:[(0,s.jsx)(tv.Z,{className:"flex-1 font-semibold text-gray-700",children:"Entity Type"}),(0,s.jsx)(tv.Z,{className:"flex-1 font-semibold text-gray-700",children:"Configuration"})]}),(0,s.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:Object.entries(null===(d=B.litellm_params)||void 0===d?void 0:d.pii_entities_config).map(e=>{let[t,l]=e;return(0,s.jsxs)("div",{className:"px-5 py-3 flex border-b hover:bg-gray-50 transition-colors",children:[(0,s.jsx)(tv.Z,{className:"flex-1 font-medium text-gray-900",children:t}),(0,s.jsx)(tv.Z,{className:"flex-1",children:(0,s.jsxs)("span",{className:"inline-flex items-center gap-1.5 ".concat("MASK"===l?"text-blue-600":"text-red-600"),children:["MASK"===l?(0,s.jsx)(eN.Z,{}):(0,s.jsx)(ew.Z,{}),String(l)]})})]},t)})})]})]}),(null===(c=B.litellm_params)||void 0===c?void 0:c.guardrail)==="tool_permission"&&(0,s.jsx)(tu.Z,{className:"mt-6",children:(0,s.jsx)(eJ,{value:ee,disabled:!0})}),(null===(m=B.litellm_params)||void 0===m?void 0:m.guardrail)==="custom_code"&&(null===(p=B.litellm_params)||void 0===p?void 0:p.custom_code)&&(0,s.jsxs)(tu.Z,{className:"mt-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.Z,{className:"text-blue-500"}),(0,s.jsx)(tv.Z,{className:"font-medium text-lg",children:"Custom Code"})]}),L&&!ej&&(0,s.jsx)(j.ZP,{size:"small",icon:(0,s.jsx)(u.Z,{}),onClick:()=>ei(!0),children:"Edit Code"})]}),(0,s.jsx)("div",{className:"relative rounded-lg overflow-hidden border border-gray-700 bg-[#1e1e1e]",children:(0,s.jsx)("pre",{className:"p-4 text-sm text-gray-200 overflow-x-auto",style:{fontFamily:"'Fira Code', 'Monaco', 'Consolas', monospace"},children:(0,s.jsx)("code",{children:B.litellm_params.custom_code})})})]}),(0,s.jsx)(tP,{guardrailData:B,guardrailSettings:H,isEditing:!1,accessToken:O})]}),L&&(0,s.jsx)(tf.Z,{children:(0,s.jsxs)(tu.Z,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)(tj.Z,{children:"Guardrail Settings"}),ej&&(0,s.jsx)(eb.Z,{title:"Guardrail is defined in the config file and cannot be edited.",children:(0,s.jsx)(eR.Z,{})}),!M&&!ej&&((null===(x=B.litellm_params)||void 0===x?void 0:x.guardrail)==="custom_code"?(0,s.jsx)(j.ZP,{icon:(0,s.jsx)(u.Z,{}),onClick:()=>ei(!0),children:"Edit Code"}):(0,s.jsx)(j.ZP,{onClick:()=>R(!0),children:"Edit Settings"}))]}),M?(0,s.jsxs)(f.Z,{form:D,onFinish:ep,initialValues:{guardrail_name:B.guardrail_name,...B.litellm_params,guardrail_info:B.guardrail_info?JSON.stringify(B.guardrail_info,null,2):"",...(null===(v=B.litellm_params)||void 0===v?void 0:v.optional_params)&&{optional_params:B.litellm_params.optional_params}},layout:"vertical",children:[(0,s.jsx)(f.Z.Item,{label:"Guardrail Name",name:"guardrail_name",rules:[{required:!0,message:"Please input a guardrail name"}],children:(0,s.jsx)(y.default,{placeholder:"Enter guardrail name"})}),(0,s.jsx)(f.Z.Item,{label:"Default On",name:"default_on",children:(0,s.jsxs)(h.default,{children:[(0,s.jsx)(h.default.Option,{value:!0,children:"Yes"}),(0,s.jsx)(h.default.Option,{value:!1,children:"No"})]})}),(null===(_=B.litellm_params)||void 0===_?void 0:_.guardrail)==="presidio"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eG.Z,{orientation:"left",children:"PII Protection"}),(0,s.jsx)("div",{className:"mb-6",children:H&&(0,s.jsx)(eE,{entities:H.supported_entities,actions:H.supported_actions,selectedEntities:K,selectedActions:q,onEntitySelect:e=>{J(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},onActionSelect:(e,t)=>{W(l=>({...l,[e]:t}))},entityCategories:H.pii_entity_categories})})]}),(0,s.jsx)(tP,{guardrailData:B,guardrailSettings:H,isEditing:!0,accessToken:O,onDataChange:es,onUnsavedChanges:$}),((null===(C=B.litellm_params)||void 0===C?void 0:C.guardrail)==="tool_permission"||z)&&(0,s.jsx)(eG.Z,{orientation:"left",children:"Provider Settings"}),(null===(N=B.litellm_params)||void 0===N?void 0:N.guardrail)==="tool_permission"?(0,s.jsx)(eJ,{value:ee,onChange:et}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e_,{selectedProvider:Object.keys(ed).find(e=>{var t;return ed[e]===(null===(t=B.litellm_params)||void 0===t?void 0:t.guardrail)})||null,accessToken:O,providerParams:z,value:B.litellm_params}),z&&(()=>{var e;let t=Object.keys(ed).find(e=>{var t;return ed[e]===(null===(t=B.litellm_params)||void 0===t?void 0:t.guardrail)});if(!t)return null;let l=z[null===(e=ed[t])||void 0===e?void 0:e.toLowerCase()];return l&&l.optional_params?(0,s.jsx)(ev,{optionalParams:l.optional_params,parentFieldKey:"optional_params",values:B.litellm_params}):null})()]}),(0,s.jsx)(eG.Z,{orientation:"left",children:"Advanced Settings"}),(0,s.jsx)(f.Z.Item,{label:"Guardrail Information",name:"guardrail_info",children:(0,s.jsx)(y.default.TextArea,{rows:5})}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,s.jsx)(j.ZP,{onClick:()=>{R(!1),$(!1),eu()},children:"Cancel"}),(0,s.jsx)(j.ZP,{type:"primary",htmlType:"submit",children:"Save Changes"})]})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(tv.Z,{className:"font-medium",children:"Guardrail ID"}),(0,s.jsx)("div",{className:"font-mono",children:B.guardrail_id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(tv.Z,{className:"font-medium",children:"Guardrail Name"}),(0,s.jsx)("div",{children:B.guardrail_name||"Unnamed Guardrail"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(tv.Z,{className:"font-medium",children:"Provider"}),(0,s.jsx)("div",{children:ef})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(tv.Z,{className:"font-medium",children:"Mode"}),(0,s.jsx)("div",{children:(null===(w=B.litellm_params)||void 0===w?void 0:w.mode)||"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(tv.Z,{className:"font-medium",children:"Default On"}),(0,s.jsx)(tm.Z,{color:(null===(S=B.litellm_params)||void 0===S?void 0:S.default_on)?"green":"gray",children:(null===(k=B.litellm_params)||void 0===k?void 0:k.default_on)?"Yes":"No"})]}),(null===(Z=B.litellm_params)||void 0===Z?void 0:Z.pii_entities_config)&&Object.keys(B.litellm_params.pii_entities_config).length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)(tv.Z,{className:"font-medium",children:"PII Protection"}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)(tm.Z,{color:"blue",children:[Object.keys(B.litellm_params.pii_entities_config).length," PII entities configured"]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(tv.Z,{className:"font-medium",children:"Created At"}),(0,s.jsx)("div",{children:eg(B.created_at)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(tv.Z,{className:"font-medium",children:"Last Updated"}),(0,s.jsx)("div",{children:eg(B.updated_at)})]}),(null===(P=B.litellm_params)||void 0===P?void 0:P.guardrail)==="tool_permission"&&(0,s.jsx)(eJ,{value:ee,disabled:!0})]})]})})]})]}),(0,s.jsx)(tK,{visible:er,onClose:()=>ei(!1),onSuccess:()=>{ei(!1),eo()},accessToken:O,editData:B?{guardrail_id:B.guardrail_id,guardrail_name:B.guardrail_name,litellm_params:B.litellm_params}:null})]})},tq=l(49566),tW=l(35631),tH=l(29436),tU=l(41169),tV=l(16312),tY=l(23639),tQ=l(13271),t$=l(77565),tX=l(5540);let{Text:t0}=x.default;var t1=function(e){let{results:t,errors:l}=e,[a,r]=(0,o.useState)(new Set),i=e=>{let t=new Set(a);t.has(e)?t.delete(e):t.add(e),r(t)},n=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select();let l=document.execCommand("copy");if(document.body.removeChild(t),!l)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}};return t||l?(0,s.jsxs)("div",{className:"space-y-3 pt-4 border-t border-gray-200",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Results"}),t&&t.map(e=>{let t=a.has(e.guardrailName);return(0,s.jsx)(tQ.Z,{className:"bg-green-50 border-green-200",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer flex-1",onClick:()=>i(e.guardrailName),children:[t?(0,s.jsx)(t$.Z,{className:"text-gray-500 text-xs"}):(0,s.jsx)(p.Z,{className:"text-gray-500 text-xs"}),(0,s.jsx)(tz.Z,{className:"text-green-600 text-lg"}),(0,s.jsx)("span",{className:"text-sm font-medium text-green-800",children:e.guardrailName})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-600",children:[(0,s.jsx)(tX.Z,{}),(0,s.jsxs)("span",{className:"font-medium",children:[e.latency,"ms"]})]}),!t&&(0,s.jsx)(tQ.z,{size:"xs",variant:"secondary",icon:tY.Z,onClick:async()=>{await n(e.response_text)?b.ZP.success("Result copied to clipboard"):b.ZP.fromBackend("Failed to copy result")},children:"Copy"})]})]}),!t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-white border border-green-200 rounded p-3",children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-600 mb-2 block",children:"Output Text"}),(0,s.jsx)("div",{className:"font-mono text-sm text-gray-900 whitespace-pre-wrap break-words",children:e.response_text})]}),(0,s.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,s.jsx)("span",{className:"font-medium",children:"Characters:"})," ",e.response_text.length]})]})]})},e.guardrailName)}),l&&l.map(e=>{let t=a.has(e.guardrailName);return(0,s.jsx)(tQ.Z,{className:"bg-red-50 border-red-200",children:(0,s.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,s.jsx)("div",{className:"cursor-pointer mt-0.5",onClick:()=>i(e.guardrailName),children:t?(0,s.jsx)(t$.Z,{className:"text-gray-500 text-xs"}):(0,s.jsx)(p.Z,{className:"text-gray-500 text-xs"})}),(0,s.jsx)("div",{className:"text-red-600 mt-0.5",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsxs)("p",{className:"text-sm font-medium text-red-800 cursor-pointer",onClick:()=>i(e.guardrailName),children:[e.guardrailName," - Error"]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-600",children:[(0,s.jsx)(tX.Z,{}),(0,s.jsxs)("span",{className:"font-medium",children:[e.latency,"ms"]})]})]}),!t&&(0,s.jsx)("p",{className:"text-sm text-red-700 mt-1",children:e.error.message})]})]})},e.guardrailName)})]}):null};let{TextArea:t2}=y.default,{Text:t4}=x.default;var t8=function(e){let{guardrailNames:t,onSubmit:l,isLoading:a,results:r,errors:i,onClose:n}=e,[d,c]=(0,o.useState)(""),m=()=>{if(!d.trim()){b.ZP.fromBackend("Please enter text to test");return}l(d)},u=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select();let l=document.execCommand("copy");if(document.body.removeChild(t),!l)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}},p=async()=>{await u(d)?b.ZP.success("Input copied to clipboard"):b.ZP.fromBackend("Failed to copy input")};return(0,s.jsxs)("div",{className:"space-y-4 h-full flex flex-col",children:[(0,s.jsx)("div",{className:"flex items-center justify-between pb-3 border-b border-gray-200",children:(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Test Guardrails:"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(e=>(0,s.jsx)("div",{className:"inline-flex items-center space-x-1 bg-blue-50 px-3 py-1 rounded-md border border-blue-200",children:(0,s.jsx)("span",{className:"font-mono text-blue-700 font-medium text-sm",children:e})},e))})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Test ",t.length>1?"guardrails":"guardrail"," and compare results"]})]})})}),(0,s.jsxs)("div",{className:"flex-1 overflow-auto space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Input Text"}),(0,s.jsx)(eb.Z,{title:"Press Enter to submit. Use Shift+Enter for new line.",children:(0,s.jsx)(eR.Z,{className:"text-gray-400 cursor-help"})})]}),d&&(0,s.jsx)(tV.z,{size:"xs",variant:"secondary",icon:tY.Z,onClick:p,children:"Copy Input"})]}),(0,s.jsx)(t2,{value:d,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||e.ctrlKey||e.metaKey||(e.preventDefault(),m())},placeholder:"Enter text to test with guardrails...",rows:8,className:"font-mono text-sm"}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,s.jsxs)(t4,{className:"text-xs text-gray-500",children:["Press ",(0,s.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"Enter"})," to submit • ",(0,s.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"Shift+Enter"})," for new line"]}),(0,s.jsxs)(t4,{className:"text-xs text-gray-500",children:["Characters: ",d.length]})]})]}),(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsx)(tV.z,{onClick:m,loading:a,disabled:!d.trim(),className:"w-full",children:a?"Testing ".concat(t.length," guardrail").concat(t.length>1?"s":"","..."):"Test ".concat(t.length," guardrail").concat(t.length>1?"s":"")})})]}),(0,s.jsx)(t1,{results:r,errors:i})]})]})},t6=e=>{let{guardrailsList:t,isLoading:l,accessToken:a,onClose:r}=e,[i,n]=(0,o.useState)(new Set),[d,c]=(0,o.useState)(""),[m,u]=(0,o.useState)([]),[p,x]=(0,o.useState)([]),[h,f]=(0,o.useState)(!1),y=t.filter(e=>{var t;return null===(t=e.guardrail_name)||void 0===t?void 0:t.toLowerCase().includes(d.toLowerCase())}),v=e=>{let t=new Set(i);t.has(e)?t.delete(e):t.add(e),n(t)},j=async e=>{if(0===i.size||!a)return;f(!0),u([]),x([]);let t=[],l=[];await Promise.all(Array.from(i).map(async r=>{let i=Date.now();try{let l=await (0,g.applyGuardrail)(a,r,e,null,null),n=Date.now()-i;t.push({guardrailName:r,response_text:l.response_text,latency:n})}catch(t){let e=Date.now()-i;console.error("Error testing guardrail ".concat(r,":"),t),l.push({guardrailName:r,error:t,latency:e})}})),u(t),x(l),f(!1),t.length>0&&b.ZP.success("".concat(t.length," guardrail").concat(t.length>1?"s":""," applied successfully")),l.length>0&&b.ZP.fromBackend("".concat(l.length," guardrail").concat(l.length>1?"s":""," failed"))};return(0,s.jsx)("div",{className:"w-full h-[calc(100vh-200px)]",children:(0,s.jsx)(tu.Z,{className:"h-full",children:(0,s.jsxs)("div",{className:"flex h-full",children:[(0,s.jsxs)("div",{className:"w-1/4 border-r border-gray-200 flex flex-col overflow-hidden",children:[(0,s.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)(tj.Z,{className:"text-lg font-semibold mb-3",children:"Guardrails"}),(0,s.jsx)(tq.Z,{icon:tH.Z,placeholder:"Search guardrails...",value:d,onValueChange:c})]})}),(0,s.jsx)("div",{className:"flex-1 overflow-auto",children:l?(0,s.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,s.jsx)(ej.Z,{})}):0===y.length?(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(eM.Z,{description:d?"No guardrails match your search":"No guardrails available"})}):(0,s.jsx)(tW.Z,{dataSource:y,renderItem:e=>(0,s.jsx)(tW.Z.Item,{onClick:()=>{e.guardrail_name&&v(e.guardrail_name)},className:"cursor-pointer hover:bg-gray-50 transition-colors px-4 ".concat(i.has(e.guardrail_name||"")?"bg-blue-50 border-l-4 border-l-blue-500":"border-l-4 border-l-transparent"),children:(0,s.jsx)(tW.Z.Item.Meta,{avatar:(0,s.jsx)(eC.Z,{checked:i.has(e.guardrail_name||""),onClick:t=>{t.stopPropagation(),e.guardrail_name&&v(e.guardrail_name)}}),title:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(tU.Z,{className:"text-gray-400"}),(0,s.jsx)("span",{className:"font-medium text-gray-900",children:e.guardrail_name})]}),description:(0,s.jsxs)("div",{className:"text-xs space-y-1 mt-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Type: "}),(0,s.jsx)("span",{className:"text-gray-600",children:e.litellm_params.guardrail})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Mode: "}),(0,s.jsx)("span",{className:"text-gray-600",children:e.litellm_params.mode})]})]})})})})}),(0,s.jsx)("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:(0,s.jsxs)(tv.Z,{className:"text-xs text-gray-600",children:[i.size," of ",y.length," selected"]})})]}),(0,s.jsxs)("div",{className:"w-3/4 flex flex-col bg-white",children:[(0,s.jsx)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:(0,s.jsx)(tj.Z,{className:"text-xl font-semibold mb-0",children:"Guardrail Testing Playground"})}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-4",children:0===i.size?(0,s.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,s.jsx)(tU.Z,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,s.jsx)(tv.Z,{className:"text-lg font-medium text-gray-600 mb-2",children:"Select Guardrails to Test"}),(0,s.jsx)(tv.Z,{className:"text-center text-gray-500 max-w-md",children:"Choose one or more guardrails from the left sidebar to start testing and comparing results."})]}):(0,s.jsx)("div",{className:"h-full",children:(0,s.jsx)(t8,{guardrailNames:Array.from(i),onSubmit:j,results:m.length>0?m:null,errors:p.length>0?p:null,isLoading:h,onClose:()=>n(new Set)})})})]})]})})})},t5=l(21609),t3=l(25073);let t9="../ui/assets/logos/",t7=[{id:"cf_denied_financial",name:"Denied Financial Advice",description:"Detects requests for personalized financial advice, investment recommendations, or financial planning.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Topic Blocker"],eval:{f1:100,precision:100,recall:100,testCases:207,latency:"<0.1ms"}},{id:"cf_denied_insults",name:"Insults & Personal Attacks",description:"Detects insults, name-calling, and personal attacks directed at the chatbot, staff, or other people.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Topic Blocker"],eval:{f1:100,precision:100,recall:100,testCases:299,latency:"<0.1ms"}},{id:"cf_denied_legal",name:"Denied Legal Advice",description:"Detects requests for unauthorized legal advice, case analysis, or legal recommendations.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Topic Blocker"]},{id:"cf_denied_medical",name:"Denied Medical Advice",description:"Detects requests for medical diagnosis, treatment recommendations, or health advice.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Topic Blocker"]},{id:"cf_harmful_violence",name:"Harmful Violence",description:"Detects content related to violence, criminal planning, attacks, and violent threats.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Safety"]},{id:"cf_harmful_self_harm",name:"Harmful Self-Harm",description:"Detects content related to self-harm, suicide, and dangerous self-destructive behavior.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Safety"]},{id:"cf_harmful_child_safety",name:"Harmful Child Safety",description:"Detects content that could endanger child safety or exploit minors.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Safety"]},{id:"cf_harmful_illegal_weapons",name:"Harmful Illegal Weapons",description:"Detects content related to illegal weapons manufacturing, distribution, or acquisition.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Safety"]},{id:"cf_bias_gender",name:"Bias: Gender",description:"Detects gender-based discrimination, stereotypes, and biased language.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Bias"]},{id:"cf_bias_racial",name:"Bias: Racial",description:"Detects racial discrimination, stereotypes, and racially biased content.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Bias"]},{id:"cf_bias_religious",name:"Bias: Religious",description:"Detects religious discrimination, intolerance, and religiously biased content.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Bias"]},{id:"cf_bias_sexual_orientation",name:"Bias: Sexual Orientation",description:"Detects discrimination based on sexual orientation and related biased content.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Bias"]},{id:"cf_prompt_injection_jailbreak",name:"Prompt Injection: Jailbreak",description:"Detects jailbreak attempts designed to bypass AI safety guidelines and restrictions.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Prompt Injection"]},{id:"cf_prompt_injection_data_exfil",name:"Prompt Injection: Data Exfiltration",description:"Detects attempts to extract sensitive data through prompt manipulation.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Prompt Injection"]},{id:"cf_prompt_injection_sql",name:"Prompt Injection: SQL",description:"Detects SQL injection attempts embedded in prompts.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Prompt Injection"]},{id:"cf_prompt_injection_malicious_code",name:"Prompt Injection: Malicious Code",description:"Detects attempts to inject malicious code through prompts.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Prompt Injection"]},{id:"cf_prompt_injection_system_prompt",name:"Prompt Injection: System Prompt",description:"Detects attempts to extract or override system prompts.",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Prompt Injection"]},{id:"cf_toxic_abuse",name:"Toxic & Abusive Language",description:"Detects toxic, abusive, and hateful language across multiple languages (EN, AU, DE, ES, FR).",category:"litellm",subcategory:"Content Category",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Content Category","Toxicity"]},{id:"cf_patterns",name:"Pattern Matching",description:"Detect and block sensitive data patterns like SSNs, credit card numbers, API keys, and custom regex patterns.",category:"litellm",subcategory:"Patterns",logo:"".concat(t9,"litellm_logo.jpg"),tags:["PII","Regex","Data Protection"]},{id:"cf_keywords",name:"Keyword Blocking",description:"Block or mask content containing specific keywords or phrases. Upload custom word lists or add individual terms.",category:"litellm",subcategory:"Keywords",logo:"".concat(t9,"litellm_logo.jpg"),tags:["Keywords","Blocklist"]},{id:"presidio",name:"Presidio PII",description:"Microsoft Presidio for PII detection and anonymization. Supports 30+ entity types with configurable actions.",category:"partner",logo:"".concat(t9,"microsoft_azure.svg"),tags:["PII","Microsoft"],providerKey:"PresidioPII"},{id:"bedrock",name:"Bedrock Guardrail",description:"AWS Bedrock Guardrails for content filtering, topic avoidance, and sensitive information detection.",category:"partner",logo:"".concat(t9,"bedrock.svg"),tags:["AWS","Content Safety"],providerKey:"Bedrock"},{id:"lakera",name:"Lakera",description:"AI security platform protecting against prompt injections, data leakage, and harmful content.",category:"partner",logo:"".concat(t9,"lakeraai.jpeg"),tags:["Security","Prompt Injection"],providerKey:"Lakera"},{id:"openai_moderation",name:"OpenAI Moderation",description:"OpenAI's content moderation API for detecting harmful content across multiple categories.",category:"partner",logo:"".concat(t9,"openai_small.svg"),tags:["Content Moderation","OpenAI"]},{id:"google_model_armor",name:"Google Cloud Model Armor",description:"Google Cloud's model protection service for safe and responsible AI deployments.",category:"partner",logo:"".concat(t9,"google.svg"),tags:["Google Cloud","Safety"]},{id:"guardrails_ai",name:"Guardrails AI",description:"Open-source framework for adding structural, type, and quality guarantees to LLM outputs.",category:"partner",logo:"".concat(t9,"guardrails_ai.jpeg"),tags:["Open Source","Validation"]},{id:"zscaler",name:"Zscaler AI Guard",description:"Enterprise AI security from Zscaler for monitoring and protecting AI/ML workloads.",category:"partner",logo:"".concat(t9,"zscaler.svg"),tags:["Enterprise","Security"]},{id:"panw",name:"PANW Prisma AIRS",description:"Palo Alto Networks Prisma AI Runtime Security for securing AI applications in production.",category:"partner",logo:"".concat(t9,"palo_alto_networks.jpeg"),tags:["Enterprise","Security"]},{id:"noma",name:"Noma Security",description:"AI security platform for detecting and preventing AI-specific threats and vulnerabilities.",category:"partner",logo:"".concat(t9,"noma_security.png"),tags:["Security","Threat Detection"]},{id:"aporia",name:"Aporia AI",description:"Real-time AI guardrails for hallucination detection, topic control, and policy enforcement.",category:"partner",logo:"".concat(t9,"aporia.png"),tags:["Hallucination","Policy"]},{id:"aim",name:"AIM Guardrail",description:"AIM Security guardrails for comprehensive AI threat detection and mitigation.",category:"partner",logo:"".concat(t9,"aim_security.jpeg"),tags:["Security","Threat Detection"]},{id:"prompt_security",name:"Prompt Security",description:"Protect against prompt injection attacks, data leakage, and other LLM security threats.",category:"partner",logo:"".concat(t9,"prompt_security.png"),tags:["Prompt Injection","Security"]},{id:"lasso",name:"Lasso Guardrail",description:"Content moderation and safety guardrails for responsible AI deployments.",category:"partner",logo:"".concat(t9,"lasso.png"),tags:["Content Moderation"]},{id:"pangea",name:"Pangea Guardrail",description:"Pangea's AI guardrails for secure, compliant, and trustworthy AI applications.",category:"partner",logo:"".concat(t9,"pangea.png"),tags:["Compliance","Security"]},{id:"enkryptai",name:"EnkryptAI",description:"AI security and governance platform for enterprise AI safety and compliance.",category:"partner",logo:"".concat(t9,"enkrypt_ai.avif"),tags:["Enterprise","Governance"]},{id:"javelin",name:"Javelin Guardrails",description:"AI gateway with built-in guardrails for secure and compliant AI operations.",category:"partner",logo:"".concat(t9,"javelin.png"),tags:["Gateway","Security"]},{id:"pillar",name:"Pillar Guardrail",description:"AI safety platform for monitoring, testing, and securing AI systems.",category:"partner",logo:"".concat(t9,"pillar.jpeg"),tags:["Monitoring","Safety"]}];var le=l(8900);let lt=e=>{let{src:t,name:l}=e,[a,r]=(0,o.useState)(!1);return a||!t?(0,s.jsx)("div",{style:{width:28,height:28,borderRadius:6,backgroundColor:"#e5e7eb",display:"flex",alignItems:"center",justifyContent:"center",fontSize:13,fontWeight:600,color:"#6b7280",flexShrink:0},children:(null==l?void 0:l.charAt(0))||"?"}):(0,s.jsx)("img",{src:t,alt:"",style:{width:28,height:28,borderRadius:6,objectFit:"contain",flexShrink:0},onError:()=>r(!0)})};var ll=e=>{let{card:t,onClick:l}=e,[a,r]=(0,o.useState)(!1);return(0,s.jsxs)("div",{onClick:l,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),style:{borderRadius:12,border:a?"1px solid #93c5fd":"1px solid #e5e7eb",backgroundColor:"#ffffff",padding:"20px 20px 16px 20px",cursor:"pointer",transition:"border-color 0.15s, box-shadow 0.15s",display:"flex",flexDirection:"column",minHeight:170,boxShadow:a?"0 1px 6px rgba(59,130,246,0.08)":"none"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[(0,s.jsx)(lt,{src:t.logo,name:t.name}),(0,s.jsx)("span",{style:{fontSize:14,fontWeight:600,color:"#111827",lineHeight:1.3},children:t.name})]}),(0,s.jsx)("p",{className:"line-clamp-3",style:{fontSize:12,color:"#6b7280",lineHeight:1.6,margin:0,flex:1},children:t.description}),t.eval&&(0,s.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"center",gap:4},children:[(0,s.jsx)(le.Z,{style:{color:"#16a34a",fontSize:12}}),(0,s.jsxs)("span",{style:{fontSize:11,color:"#16a34a",fontWeight:500},children:["F1: ",t.eval.f1,"% \xb7 ",t.eval.testCases," test cases"]})]})]})},la=l(17588);let lr={cf_denied_financial:{provider:"LitellmContentFilter",categoryName:"denied_financial_advice",guardrailNameSuggestion:"Denied Financial Advice",mode:"pre_call",defaultOn:!1},cf_denied_legal:{provider:"LitellmContentFilter",categoryName:"denied_legal_advice",guardrailNameSuggestion:"Denied Legal Advice",mode:"pre_call",defaultOn:!1},cf_denied_medical:{provider:"LitellmContentFilter",categoryName:"denied_medical_advice",guardrailNameSuggestion:"Denied Medical Advice",mode:"pre_call",defaultOn:!1},cf_denied_insults:{provider:"LitellmContentFilter",categoryName:"denied_insults",guardrailNameSuggestion:"Insults & Personal Attacks",mode:"pre_call",defaultOn:!1},cf_harmful_violence:{provider:"LitellmContentFilter",categoryName:"harmful_violence",guardrailNameSuggestion:"Harmful Violence",mode:"pre_call",defaultOn:!1},cf_harmful_self_harm:{provider:"LitellmContentFilter",categoryName:"harmful_self_harm",guardrailNameSuggestion:"Harmful Self-Harm",mode:"pre_call",defaultOn:!1},cf_harmful_child_safety:{provider:"LitellmContentFilter",categoryName:"harmful_child_safety",guardrailNameSuggestion:"Harmful Child Safety",mode:"pre_call",defaultOn:!1},cf_harmful_illegal_weapons:{provider:"LitellmContentFilter",categoryName:"harmful_illegal_weapons",guardrailNameSuggestion:"Harmful Illegal Weapons",mode:"pre_call",defaultOn:!1},cf_bias_gender:{provider:"LitellmContentFilter",categoryName:"bias_gender",guardrailNameSuggestion:"Bias: Gender",mode:"pre_call",defaultOn:!1},cf_bias_racial:{provider:"LitellmContentFilter",categoryName:"bias_racial",guardrailNameSuggestion:"Bias: Racial",mode:"pre_call",defaultOn:!1},cf_bias_religious:{provider:"LitellmContentFilter",categoryName:"bias_religious",guardrailNameSuggestion:"Bias: Religious",mode:"pre_call",defaultOn:!1},cf_bias_sexual_orientation:{provider:"LitellmContentFilter",categoryName:"bias_sexual_orientation",guardrailNameSuggestion:"Bias: Sexual Orientation",mode:"pre_call",defaultOn:!1},cf_prompt_injection_jailbreak:{provider:"LitellmContentFilter",categoryName:"prompt_injection_jailbreak",guardrailNameSuggestion:"Prompt Injection: Jailbreak",mode:"pre_call",defaultOn:!1},cf_prompt_injection_data_exfil:{provider:"LitellmContentFilter",categoryName:"prompt_injection_data_exfiltration",guardrailNameSuggestion:"Prompt Injection: Data Exfiltration",mode:"pre_call",defaultOn:!1},cf_prompt_injection_sql:{provider:"LitellmContentFilter",categoryName:"prompt_injection_sql",guardrailNameSuggestion:"Prompt Injection: SQL",mode:"pre_call",defaultOn:!1},cf_prompt_injection_malicious_code:{provider:"LitellmContentFilter",categoryName:"prompt_injection_malicious_code",guardrailNameSuggestion:"Prompt Injection: Malicious Code",mode:"pre_call",defaultOn:!1},cf_prompt_injection_system_prompt:{provider:"LitellmContentFilter",categoryName:"prompt_injection_system_prompt",guardrailNameSuggestion:"Prompt Injection: System Prompt",mode:"pre_call",defaultOn:!1},cf_toxic_abuse:{provider:"LitellmContentFilter",categoryName:"harm_toxic_abuse",guardrailNameSuggestion:"Toxic & Abusive Language",mode:"pre_call",defaultOn:!1},cf_patterns:{provider:"LitellmContentFilter",guardrailNameSuggestion:"Pattern Matching",mode:"pre_call",defaultOn:!1},cf_keywords:{provider:"LitellmContentFilter",guardrailNameSuggestion:"Keyword Blocking",mode:"pre_call",defaultOn:!1},presidio:{provider:"PresidioPII",guardrailNameSuggestion:"Presidio PII",mode:"pre_call",defaultOn:!1},bedrock:{provider:"Bedrock",guardrailNameSuggestion:"Bedrock Guardrail",mode:"pre_call",defaultOn:!1},lakera:{provider:"Lakera",guardrailNameSuggestion:"Lakera",mode:"pre_call",defaultOn:!1},openai_moderation:{provider:"OpenaiModeration",guardrailNameSuggestion:"OpenAI Moderation",mode:"pre_call",defaultOn:!1},google_model_armor:{provider:"ModelArmor",guardrailNameSuggestion:"Google Cloud Model Armor",mode:"pre_call",defaultOn:!1},guardrails_ai:{provider:"GuardrailsAi",guardrailNameSuggestion:"Guardrails AI",mode:"pre_call",defaultOn:!1},zscaler:{provider:"ZscalerAiGuard",guardrailNameSuggestion:"Zscaler AI Guard",mode:"pre_call",defaultOn:!1},panw:{provider:"PanwPrismaAirs",guardrailNameSuggestion:"PANW Prisma AIRS",mode:"pre_call",defaultOn:!1},noma:{provider:"Noma",guardrailNameSuggestion:"Noma Security",mode:"pre_call",defaultOn:!1},aporia:{provider:"AporiaAi",guardrailNameSuggestion:"Aporia AI",mode:"pre_call",defaultOn:!1},aim:{provider:"Aim",guardrailNameSuggestion:"AIM Guardrail",mode:"pre_call",defaultOn:!1},prompt_security:{provider:"PromptSecurity",guardrailNameSuggestion:"Prompt Security",mode:"pre_call",defaultOn:!1},lasso:{provider:"Lasso",guardrailNameSuggestion:"Lasso Guardrail",mode:"pre_call",defaultOn:!1},pangea:{provider:"Pangea",guardrailNameSuggestion:"Pangea Guardrail",mode:"pre_call",defaultOn:!1},enkryptai:{provider:"Enkryptai",guardrailNameSuggestion:"EnkryptAI",mode:"pre_call",defaultOn:!1},javelin:{provider:"Javelin",guardrailNameSuggestion:"Javelin Guardrails",mode:"pre_call",defaultOn:!1},pillar:{provider:"Pillar",guardrailNameSuggestion:"Pillar Guardrail",mode:"pre_call",defaultOn:!1}};var li=e=>{var t;let{card:l,onBack:a,accessToken:r,onGuardrailCreated:i}=e,[n,d]=(0,o.useState)(!1),[c,m]=(0,o.useState)("overview"),u=[{property:"Provider",value:"litellm"===l.category?"LiteLLM Content Filter":"Partner Guardrail"},...l.subcategory?[{property:"Subcategory",value:l.subcategory}]:[],..."litellm"===l.category?[{property:"Cost",value:"$0 / request"}]:[],..."litellm"===l.category?[{property:"External Dependencies",value:"None"}]:[],..."litellm"===l.category?[{property:"Latency",value:(null===(t=l.eval)||void 0===t?void 0:t.latency)||"<1ms"}]:[]],p=l.eval?[{metric:"Precision",value:"".concat(l.eval.precision,"%")},{metric:"Recall",value:"".concat(l.eval.recall,"%")},{metric:"F1 Score",value:"".concat(l.eval.f1,"%")},{metric:"Test Cases",value:String(l.eval.testCases)},{metric:"False Positives",value:"0"},{metric:"False Negatives",value:"0"},{metric:"Latency (p50)",value:l.eval.latency}]:[],g=[{key:"overview",label:"Overview"},...l.eval?[{key:"eval",label:"Eval Results"}]:[]];return(0,s.jsxs)("div",{style:{maxWidth:960,margin:"0 auto"},children:[(0,s.jsxs)("div",{onClick:a,style:{display:"inline-flex",alignItems:"center",gap:6,color:"#5f6368",cursor:"pointer",fontSize:14,marginBottom:24},children:[(0,s.jsx)(la.Z,{style:{fontSize:11}}),(0,s.jsx)("span",{children:l.name})]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:8},children:[(0,s.jsx)("img",{src:l.logo,alt:"",style:{width:40,height:40,borderRadius:8,objectFit:"contain"},onError:e=>{e.target.style.display="none"}}),(0,s.jsx)("h1",{style:{fontSize:28,fontWeight:400,color:"#202124",margin:0,lineHeight:1.2},children:l.name})]}),(0,s.jsx)("p",{style:{fontSize:14,color:"#5f6368",margin:"0 0 20px 0",lineHeight:1.6},children:l.description}),(0,s.jsx)("div",{style:{display:"flex",gap:10,marginBottom:32},children:(0,s.jsx)(j.ZP,{onClick:()=>d(!0),style:{borderRadius:20,padding:"4px 20px",height:36,borderColor:"#dadce0",color:"#1a73e8",fontWeight:500,fontSize:14},children:"Create Guardrail"})}),(0,s.jsx)("div",{style:{borderBottom:"1px solid #dadce0",marginBottom:28},children:(0,s.jsx)("div",{style:{display:"flex",gap:0},children:g.map(e=>(0,s.jsx)("div",{onClick:()=>m(e.key),style:{padding:"12px 20px",fontSize:14,color:c===e.key?"#1a73e8":"#5f6368",borderBottom:c===e.key?"3px solid #1a73e8":"3px solid transparent",cursor:"pointer",fontWeight:c===e.key?500:400,marginBottom:-1},children:e.label},e.key))})}),"overview"===c&&(0,s.jsxs)("div",{style:{display:"flex",gap:64},children:[(0,s.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,s.jsx)("h2",{style:{fontSize:18,fontWeight:400,color:"#202124",margin:"0 0 12px 0"},children:"Overview"}),(0,s.jsx)("p",{style:{fontSize:14,color:"#3c4043",lineHeight:1.7,margin:"0 0 32px 0"},children:l.description}),(0,s.jsx)("h2",{style:{fontSize:18,fontWeight:400,color:"#202124",margin:"0 0 4px 0"},children:"Guardrail Details"}),(0,s.jsx)("p",{style:{fontSize:13,color:"#5f6368",margin:"0 0 16px 0"},children:"Details are as follows"}),(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #dadce0"},children:[(0,s.jsx)("th",{style:{textAlign:"left",padding:"12px 0",color:"#5f6368",fontWeight:500,width:200},children:"Property"}),(0,s.jsx)("th",{style:{textAlign:"left",padding:"12px 0",color:"#5f6368",fontWeight:500},children:l.name})]})}),(0,s.jsx)("tbody",{children:u.map((e,t)=>(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #f1f3f4"},children:[(0,s.jsx)("td",{style:{padding:"12px 0",color:"#3c4043"},children:e.property}),(0,s.jsx)("td",{style:{padding:"12px 0",color:"#202124"},children:e.value})]},t))})]})]}),(0,s.jsxs)("div",{style:{width:240,flexShrink:0},children:[(0,s.jsxs)("div",{style:{marginBottom:28},children:[(0,s.jsx)("div",{style:{fontSize:12,color:"#5f6368",marginBottom:4},children:"Guardrail ID"}),(0,s.jsxs)("div",{style:{fontSize:13,color:"#202124",wordBreak:"break-all"},children:["litellm/",l.id]})]}),(0,s.jsxs)("div",{style:{marginBottom:28},children:[(0,s.jsx)("div",{style:{fontSize:12,color:"#5f6368",marginBottom:4},children:"Type"}),(0,s.jsx)("div",{style:{fontSize:13,color:"#202124"},children:"litellm"===l.category?"Content Filter":"Partner"})]}),l.tags.length>0&&(0,s.jsxs)("div",{style:{marginBottom:28},children:[(0,s.jsx)("div",{style:{fontSize:12,color:"#5f6368",marginBottom:8},children:"Tags"}),(0,s.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:l.tags.map(e=>(0,s.jsx)("span",{style:{fontSize:12,padding:"4px 12px",borderRadius:16,border:"1px solid #dadce0",color:"#3c4043",backgroundColor:"#fff"},children:e},e))})]})]})]}),"eval"===c&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{style:{fontSize:18,fontWeight:400,color:"#202124",margin:"0 0 16px 0"},children:"Eval Results"}),(0,s.jsxs)("table",{style:{width:"100%",maxWidth:560,borderCollapse:"collapse",fontSize:14},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{backgroundColor:"#f8f9fa",borderBottom:"1px solid #dadce0"},children:[(0,s.jsx)("th",{style:{textAlign:"left",padding:"12px 16px",color:"#5f6368",fontWeight:500},children:"Metric"}),(0,s.jsx)("th",{style:{textAlign:"left",padding:"12px 16px",color:"#5f6368",fontWeight:500},children:"Value"})]})}),(0,s.jsx)("tbody",{children:p.map((e,t)=>(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #f1f3f4"},children:[(0,s.jsx)("td",{style:{padding:"12px 16px",color:"#3c4043"},children:e.metric}),(0,s.jsx)("td",{style:{padding:"12px 16px",color:"#202124",fontWeight:500},children:e.value})]},t))})]})]}),(0,s.jsx)(eY,{visible:n,onClose:()=>d(!1),accessToken:r,onSuccess:()=>{d(!1),i()},preset:lr[l.id]})]})},ln=e=>{let{accessToken:t,onGuardrailCreated:l}=e,[a,r]=(0,o.useState)(""),[i,n]=(0,o.useState)(null),[d,c]=(0,o.useState)(!1),m=t7.filter(e=>{if(!a)return!0;let t=a.toLowerCase();return e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t))}),u=m.filter(e=>"litellm"===e.category),p=m.filter(e=>"partner"===e.category);return i?(0,s.jsx)(li,{card:i,onBack:()=>n(null),accessToken:t,onGuardrailCreated:l}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{marginBottom:24},children:(0,s.jsx)(y.default,{size:"large",placeholder:"Search guardrails",prefix:(0,s.jsx)(tH.Z,{style:{color:"#9ca3af"}}),value:a,onChange:e=>r(e.target.value),style:{borderRadius:8}})}),(0,s.jsxs)("div",{style:{marginBottom:40},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:4},children:[(0,s.jsx)("h2",{style:{fontSize:20,fontWeight:600,color:"#111827",margin:0},children:"LiteLLM Content Filter"}),(0,s.jsx)("span",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:14,color:"#1a73e8",cursor:"pointer"},onClick:()=>c(!d),children:d?(0,s.jsx)(s.Fragment,{children:"Show less"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t3.Z,{style:{fontSize:12}}),"Show all (".concat(u.length,")")]})})]}),(0,s.jsx)("p",{style:{fontSize:13,color:"#6b7280",margin:"4px 0 20px 0"},children:"Built-in guardrails powered by LiteLLM. Zero latency, no external dependencies, no additional cost."}),(0,s.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:16},children:(d?u:u.slice(0,10)).map(e=>(0,s.jsx)(ll,{card:e,onClick:()=>n(e)},e.id))})]}),(0,s.jsxs)("div",{style:{marginBottom:40},children:[(0,s.jsx)("h2",{style:{fontSize:20,fontWeight:600,color:"#111827",margin:"0 0 4px 0"},children:"Partner Guardrails"}),(0,s.jsx)("p",{style:{fontSize:13,color:"#6b7280",margin:"4px 0 20px 0"},children:"Third-party guardrail integrations from leading AI security providers."}),(0,s.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:16},children:p.map(e=>(0,s.jsx)(ll,{card:e,onClick:()=>n(e)},e.id))})]})]})},ls=e=>{let{accessToken:t,userRole:l}=e,[a,r]=(0,o.useState)([]),[i,n]=(0,o.useState)(!1),[x,h]=(0,o.useState)(!1),[f,y]=(0,o.useState)(!1),[v,j]=(0,o.useState)(!1),[_,C]=(0,o.useState)(null),[N,w]=(0,o.useState)(!1),[S,k]=(0,o.useState)(null),[Z,P]=(0,o.useState)(0),I=!!l&&(0,to.tY)(l),A=async()=>{if(t){y(!0);try{let e=await (0,g.getGuardrailsList)(t);console.log("guardrails: ".concat(JSON.stringify(e))),r(e.guardrails)}catch(e){console.error("Error fetching guardrails:",e)}finally{y(!1)}}};(0,o.useEffect)(()=>{A()},[t]);let O=()=>{A()},L=async()=>{if(_&&t){j(!0);try{await (0,g.deleteGuardrailCall)(t,_.guardrail_id),b.ZP.success('Guardrail "'.concat(_.guardrail_name,'" deleted successfully')),await A()}catch(e){console.error("Error deleting guardrail:",e),b.ZP.fromBackend("Failed to delete guardrail")}finally{j(!1),w(!1),C(null)}}},B=_&&_.litellm_params?ex(_.litellm_params.guardrail).displayName:void 0;return(0,s.jsx)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:(0,s.jsxs)(d.v0,{index:Z,onIndexChange:P,children:[(0,s.jsxs)(d.td,{className:"mb-4",children:[(0,s.jsx)(d.OK,{children:"Guardrail Garden"}),(0,s.jsx)(d.OK,{children:"Guardrails"}),(0,s.jsx)(d.OK,{disabled:!t||0===a.length,children:"Test Playground"})]}),(0,s.jsxs)(d.nP,{children:[(0,s.jsx)(d.x4,{children:(0,s.jsx)(ln,{accessToken:t,onGuardrailCreated:O})}),(0,s.jsxs)(d.x4,{children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,s.jsx)(c.Z,{menu:{items:[{key:"provider",icon:(0,s.jsx)(m.Z,{}),label:"Add Provider Guardrail",onClick:()=>{S&&k(null),n(!0)}},{key:"custom_code",icon:(0,s.jsx)(u.Z,{}),label:"Create Custom Code Guardrail",onClick:()=>{S&&k(null),h(!0)}}]},trigger:["click"],disabled:!t,children:(0,s.jsxs)(d.zx,{disabled:!t,children:["+ Add New Guardrail ",(0,s.jsx)(p.Z,{className:"ml-2"})]})})}),S?(0,s.jsx)(tJ,{guardrailId:S,onClose:()=>k(null),accessToken:t,isAdmin:I}):(0,s.jsx)(ts,{guardrailsList:a,isLoading:f,onDeleteClick:(e,t)=>{C(a.find(t=>t.guardrail_id===e)||null),w(!0)},accessToken:t,onGuardrailUpdated:A,isAdmin:I,onGuardrailClick:e=>k(e)}),(0,s.jsx)(eY,{visible:i,onClose:()=>{n(!1)},accessToken:t,onSuccess:O}),(0,s.jsx)(tK,{visible:x,onClose:()=>{h(!1)},accessToken:t,onSuccess:O}),(0,s.jsx)(t5.Z,{isOpen:N,title:"Delete Guardrail",message:"Are you sure you want to delete guardrail: ".concat(null==_?void 0:_.guardrail_name,"? This action cannot be undone."),resourceInformationTitle:"Guardrail Information",resourceInformation:[{label:"Name",value:null==_?void 0:_.guardrail_name},{label:"ID",value:null==_?void 0:_.guardrail_id,code:!0},{label:"Provider",value:B},{label:"Mode",value:null==_?void 0:_.litellm_params.mode},{label:"Default On",value:(null==_?void 0:_.litellm_params.default_on)?"Yes":"No"}],onCancel:()=>{w(!1),C(null)},onOk:L,confirmLoading:v})]}),(0,s.jsx)(d.x4,{children:(0,s.jsx)(t6,{guardrailsList:a,isLoading:f,accessToken:t,onClose:()=>P(0)})})]})]})})}}}]);