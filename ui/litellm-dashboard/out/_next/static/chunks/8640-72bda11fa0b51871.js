"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8640],{16312:function(e,s,t){t.d(s,{z:function(){return l.Z}});var l=t(78489)},19431:function(e,s,t){t.d(s,{x:function(){return a.Z},z:function(){return l.Z}});var l=t(78489),a=t(84264)},58643:function(e,s,t){t.d(s,{OK:function(){return l.Z},nP:function(){return n.Z},td:function(){return r.Z},v0:function(){return a.Z},x4:function(){return i.Z}});var l=t(12485),a=t(18135),r=t(35242),i=t(29706),n=t(77991)},25407:function(e,s,t){t.d(s,{v:function(){return $}});var l=t(57437),a=t(15424),r=t(56531),i=t(29827),n=t(87452),d=t(88829),o=t(72208),c=t(78489),m=t(57365),u=t(49566),x=t(37592),h=t(57840),f=t(10032),p=t(51653),j=t(4260),g=t(5545),v=t(22116),b=t(55590),y=t(99981),N=t(2265),w=t(19431),_=t(65319),C=t(56609),k=t(73879),S=t(34310),Z=t(38434),U=t(26349),I=t(35291),P=t(3632),V=t(19250),L=t(15452),E=t.n(L),R=t(71157),O=t(44643),T=t(88532),z=t(29233),F=t(9114),B=e=>{let{accessToken:s,teams:t,possibleUIRoles:a,onUsersCreated:r}=e,[i,n]=(0,N.useState)(!1),[d,o]=(0,N.useState)([]),[c,m]=(0,N.useState)(!1),[u,x]=(0,N.useState)(null),[f,p]=(0,N.useState)(null),[j,g]=(0,N.useState)(null),[b,y]=(0,N.useState)(null),[L,B]=(0,N.useState)(null),[D,M]=(0,N.useState)("http://localhost:4000");(0,N.useEffect)(()=>{(async()=>{try{let e=await (0,V.getProxyUISettings)(s);B(e)}catch(e){console.error("Error fetching UI settings:",e)}})(),M(new URL("/",window.location.href).toString())},[s]);let A=async()=>{m(!0);let e=d.map(e=>({...e,status:"pending"}));o(e);let t=!1;for(let r=0;r<e.length;r++){var l,a,i;let n=e[r];try{let e={user_email:n.user_email,user_role:n.user_role};if(n.teams&&"string"==typeof n.teams&&""!==n.teams.trim()&&(e.teams=n.teams.split(",").map(e=>e.trim()).filter(Boolean),0===e.teams.length&&delete e.teams),n.models&&"string"==typeof n.models&&""!==n.models.trim()&&(e.models=n.models.split(",").map(e=>e.trim()).filter(Boolean),0===e.models.length&&delete e.models),n.max_budget&&""!==n.max_budget.toString().trim()){let s=parseFloat(n.max_budget.toString());!isNaN(s)&&s>0&&(e.max_budget=s)}n.budget_duration&&""!==n.budget_duration.trim()&&(e.budget_duration=n.budget_duration.trim()),n.metadata&&"string"==typeof n.metadata&&""!==n.metadata.trim()&&(e.metadata=n.metadata.trim()),console.log("Sending user data:",e);let a=await (0,V.userCreateCall)(s,null,e);if(console.log("Full response:",a),a&&(a.key||a.user_id)){t=!0,console.log("Success case triggered");let e=(null===(l=a.data)||void 0===l?void 0:l.user_id)||a.user_id;try{if(null==L?void 0:L.SSO_ENABLED){let e=new URL("/ui",D).toString();o(s=>s.map((s,t)=>t===r?{...s,status:"success",key:a.key||a.user_id,invitation_link:e}:s))}else{let t=await (0,V.invitationCreateCall)(s,e),l=new URL("/ui?invitation_id=".concat(t.id),D).toString();o(e=>e.map((e,s)=>s===r?{...e,status:"success",key:a.key||a.user_id,invitation_link:l}:e))}}catch(e){console.error("Error creating invitation:",e),o(e=>e.map((e,s)=>s===r?{...e,status:"success",key:a.key||a.user_id,error:"User created but failed to generate invitation link"}:e))}}else{console.log("Error case triggered");let e=(null==a?void 0:a.error)||"Failed to create user";console.log("Error message:",e),o(s=>s.map((s,t)=>t===r?{...s,status:"failed",error:e}:s))}}catch(s){console.error("Caught error:",s);let e=(null==s?void 0:null===(i=s.response)||void 0===i?void 0:null===(a=i.data)||void 0===a?void 0:a.error)||(null==s?void 0:s.message)||String(s);o(s=>s.map((s,t)=>t===r?{...s,status:"failed",error:e}:s))}}m(!1),t&&r&&r()};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w.z,{className:"mb-0",onClick:()=>n(!0),children:"+ Bulk Invite Users"}),(0,l.jsx)(v.Z,{title:"Bulk Invite Users",open:i,width:800,onCancel:()=>n(!1),bodyStyle:{maxHeight:"70vh",overflow:"auto"},footer:null,children:(0,l.jsx)("div",{className:"flex flex-col",children:0===d.length?(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center mb-4",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"1"}),(0,l.jsx)("h3",{className:"text-lg font-medium",children:"Download and fill the template"})]}),(0,l.jsxs)("div",{className:"ml-11 mb-6",children:[(0,l.jsx)("p",{className:"mb-4",children:"Add multiple users at once by following these steps:"}),(0,l.jsxs)("ol",{className:"list-decimal list-inside space-y-2 ml-2 mb-4",children:[(0,l.jsx)("li",{children:"Download our CSV template"}),(0,l.jsx)("li",{children:"Add your users' information to the spreadsheet"}),(0,l.jsx)("li",{children:"Save the file and upload it here"}),(0,l.jsx)("li",{children:"After creation, download the results file containing the Virtual Keys for each user"})]}),(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200 mb-4",children:[(0,l.jsx)("h4",{className:"font-medium mb-2",children:"Template Column Names"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"user_email"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"User's email address (required)"})]})]}),(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"user_role"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:'User\'s role (one of: "proxy_admin", "proxy_admin_viewer", "internal_user", "internal_user_viewer")'})]})]}),(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"teams"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated team IDs (e.g., "team-1,team-2")'})]})]}),(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"max_budget"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:'Maximum budget as a number (e.g., "100")'})]})]}),(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"budget_duration"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:'Budget reset period (e.g., "30d", "1mo")'})]})]}),(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"models"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated allowed models (e.g., "gpt-3.5-turbo,gpt-4")'})]})]})]})]}),(0,l.jsxs)(w.z,{onClick:()=>{let e=new Blob([E().unparse([["user_email","user_role","teams","max_budget","budget_duration","models"],["user@example.com","internal_user","team-id-1,team-id-2","100","30d","gpt-3.5-turbo,gpt-4"]])],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="bulk_users_template.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(s)},size:"lg",className:"w-full md:w-auto",children:[(0,l.jsx)(k.Z,{className:"mr-2"})," Download CSV Template"]})]}),(0,l.jsxs)("div",{className:"flex items-center mb-4",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"2"}),(0,l.jsx)("h3",{className:"text-lg font-medium",children:"Upload your completed CSV"})]}),(0,l.jsxs)("div",{className:"ml-11",children:[b?(0,l.jsxs)("div",{className:"mb-4 p-4 rounded-md border ".concat(j?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[j?(0,l.jsx)(S.Z,{className:"text-red-500 text-xl mr-3"}):(0,l.jsx)(Z.Z,{className:"text-blue-500 text-xl mr-3"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.default.Text,{strong:!0,className:j?"text-red-800":"text-blue-800",children:b.name}),(0,l.jsxs)(h.default.Text,{className:"block text-xs ".concat(j?"text-red-600":"text-blue-600"),children:[(b.size/1024).toFixed(1)," KB â€¢ ",new Date().toLocaleDateString()]})]})]}),(0,l.jsxs)(w.z,{size:"xs",variant:"secondary",onClick:()=>{y(null),o([]),x(null),p(null),g(null)},className:"flex items-center",children:[(0,l.jsx)(U.Z,{className:"mr-1"})," Remove"]})]}),j?(0,l.jsxs)("div",{className:"mt-3 text-red-600 text-sm flex items-start",children:[(0,l.jsx)(I.Z,{className:"mr-2 mt-0.5"}),(0,l.jsx)("span",{children:j})]}):!f&&(0,l.jsxs)("div",{className:"mt-3 flex items-center",children:[(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,l.jsx)("div",{className:"bg-blue-500 h-1.5 rounded-full w-full animate-pulse"})}),(0,l.jsx)("span",{className:"ml-2 text-xs text-blue-600",children:"Processing..."})]})]}):(0,l.jsx)(_.default,{beforeUpload:e=>((x(null),p(null),g(null),y(e),"text/csv"===e.type||e.name.endsWith(".csv"))?e.size>5242880?g("File is too large (".concat((e.size/1048576).toFixed(1)," MB). Please upload a CSV file smaller than 5MB.")):E().parse(e,{complete:e=>{if(!e.data||0===e.data.length){p("The CSV file appears to be empty. Please upload a file with data."),o([]);return}if(1===e.data.length){p("The CSV file only contains headers but no user data. Please add user data to your CSV."),o([]);return}let s=e.data[0];if(0===s.length||1===s.length&&""===s[0]){p("The CSV file doesn't contain any column headers. Please make sure your CSV has headers."),o([]);return}let l=["user_email","user_role"].filter(e=>!s.includes(e));if(l.length>0){p("Your CSV is missing these required columns: ".concat(l.join(", "),". Please add these columns to your CSV file.")),o([]);return}try{let l=e.data.slice(1).map((e,l)=>{var a,r,i,n,d,o;if(0===e.length||1===e.length&&""===e[0])return null;if(e.length<s.length)return{rowNumber:l+2,isValid:!1,error:"Row ".concat(l+2," has fewer columns than the header row. Please ensure all data is properly formatted."),user_email:"",user_role:""};let c={user_email:(null===(a=e[s.indexOf("user_email")])||void 0===a?void 0:a.trim())||"",user_role:(null===(r=e[s.indexOf("user_role")])||void 0===r?void 0:r.trim())||"",teams:null===(i=e[s.indexOf("teams")])||void 0===i?void 0:i.trim(),max_budget:null===(n=e[s.indexOf("max_budget")])||void 0===n?void 0:n.trim(),budget_duration:null===(d=e[s.indexOf("budget_duration")])||void 0===d?void 0:d.trim(),models:null===(o=e[s.indexOf("models")])||void 0===o?void 0:o.trim(),rowNumber:l+2,isValid:!0,error:""},m=[];if(c.user_email?c.user_email.includes("@")&&c.user_email.includes(".")||m.push("Invalid email format (must contain @ and domain)"):m.push("Email is required"),c.user_role){let e=["proxy_admin","proxy_admin_viewer","internal_user","internal_user_viewer"];e.includes(c.user_role)||m.push('Invalid role "'.concat(c.user_role,'". Must be one of: ').concat(e.join(", ")))}else m.push("Role is required");if(c.max_budget&&""!==c.max_budget.toString().trim()&&(isNaN(parseFloat(c.max_budget.toString()))?m.push('Max budget "'.concat(c.max_budget,'" must be a number')):0>=parseFloat(c.max_budget.toString())&&m.push("Max budget must be greater than 0")),c.budget_duration&&!c.budget_duration.match(/^\d+[dhmwy]$|^\d+mo$/)&&m.push('Invalid budget duration format "'.concat(c.budget_duration,'". Use format like "30d", "1mo", "2w", "6h"')),c.teams&&"string"==typeof c.teams&&t&&t.length>0){let e=t.map(e=>e.team_id),s=c.teams.split(",").map(e=>e.trim()).filter(s=>!e.includes(s));s.length>0&&m.push("Unknown team(s): ".concat(s.join(", ")))}return m.length>0&&(c.isValid=!1,c.error=m.join(", ")),c}).filter(Boolean),a=l.filter(e=>e.isValid);o(l),0===l.length?p("No valid data rows found in the CSV file. Please check your file format."):0===a.length?x("No valid users found in the CSV. Please check the errors below and fix your CSV file."):a.length<l.length?x("Found ".concat(l.length-a.length," row(s) with errors out of ").concat(l.length," total rows. Please correct them before proceeding.")):F.ZP.success("Successfully parsed ".concat(a.length," users"))}catch(s){let e=s instanceof Error?s.message:"Unknown error";x("Error parsing CSV: ".concat(e)),o([])}},error:e=>{x("Failed to parse CSV file: ".concat(e.message)),o([])},header:!1}):(g("Invalid file type: ".concat(e.name,". Please upload a CSV file (.csv extension).")),F.ZP.fromBackend("Invalid file type. Please upload a CSV file.")),!1),accept:".csv",maxCount:1,showUploadList:!1,children:(0,l.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-colors cursor-pointer",children:[(0,l.jsx)(P.Z,{className:"text-3xl text-gray-400 mb-2"}),(0,l.jsx)("p",{className:"mb-1",children:"Drag and drop your CSV file here"}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"or"}),(0,l.jsx)(w.z,{size:"sm",children:"Browse files"}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"Only CSV files (.csv) are supported"})]})}),f&&(0,l.jsx)("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)(T.Z,{className:"h-5 w-5 text-yellow-500 mr-2 mt-0.5"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.default.Text,{strong:!0,className:"text-yellow-800",children:"CSV Structure Error"}),(0,l.jsx)(h.default.Paragraph,{className:"text-yellow-700 mt-1 mb-0",children:f}),(0,l.jsx)(h.default.Paragraph,{className:"text-yellow-700 mt-2 mb-0",children:"Please download our template and ensure your CSV follows the required format."})]})]})})]})]}):(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center mb-4",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"3"}),(0,l.jsx)("h3",{className:"text-lg font-medium",children:d.some(e=>"success"===e.status||"failed"===e.status)?"User Creation Results":"Review and create users"})]}),u&&(0,l.jsx)("div",{className:"ml-11 mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)(I.Z,{className:"text-red-500 mr-2 mt-1"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(w.x,{className:"text-red-600 font-medium",children:u}),d.some(e=>!e.isValid)&&(0,l.jsxs)("ul",{className:"mt-2 list-disc list-inside text-red-600 text-sm",children:[(0,l.jsx)("li",{children:"Check the table below for specific errors in each row"}),(0,l.jsx)("li",{children:"Common issues include invalid email formats, missing required fields, or incorrect role values"}),(0,l.jsx)("li",{children:"Fix these issues in your CSV file and upload again"})]})]})]})}),(0,l.jsxs)("div",{className:"ml-11",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,l.jsx)("div",{className:"flex items-center",children:d.some(e=>"success"===e.status||"failed"===e.status)?(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(w.x,{className:"text-lg font-medium mr-3",children:"Creation Summary"}),(0,l.jsxs)(w.x,{className:"text-sm bg-green-100 text-green-800 px-2 py-1 rounded mr-2",children:[d.filter(e=>"success"===e.status).length," Successful"]}),d.some(e=>"failed"===e.status)&&(0,l.jsxs)(w.x,{className:"text-sm bg-red-100 text-red-800 px-2 py-1 rounded",children:[d.filter(e=>"failed"===e.status).length," Failed"]})]}):(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(w.x,{className:"text-lg font-medium mr-3",children:"User Preview"}),(0,l.jsxs)(w.x,{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded",children:[d.filter(e=>e.isValid).length," of ",d.length," users valid"]})]})}),!d.some(e=>"success"===e.status||"failed"===e.status)&&(0,l.jsxs)("div",{className:"flex space-x-3",children:[(0,l.jsx)(w.z,{onClick:()=>{o([]),x(null)},variant:"secondary",children:"Back"}),(0,l.jsx)(w.z,{onClick:A,disabled:0===d.filter(e=>e.isValid).length||c,children:c?"Creating...":"Create ".concat(d.filter(e=>e.isValid).length," Users")})]})]}),d.some(e=>"success"===e.status)&&(0,l.jsx)("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("div",{className:"mr-3 mt-1",children:(0,l.jsx)(O.Z,{className:"h-5 w-5 text-blue-500"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(w.x,{className:"font-medium text-blue-800",children:"User creation complete"}),(0,l.jsxs)(w.x,{className:"block text-sm text-blue-700 mt-1",children:[(0,l.jsx)("span",{className:"font-medium",children:"Next step:"})," Download the credentials file containing Virtual Keys and invitation links. Users will need these Virtual Keys to make LLM requests through LiteLLM."]})]})]})}),(0,l.jsx)(C.Z,{dataSource:d,columns:[{title:"Row",dataIndex:"rowNumber",key:"rowNumber",width:80},{title:"Email",dataIndex:"user_email",key:"user_email"},{title:"Role",dataIndex:"user_role",key:"user_role"},{title:"Teams",dataIndex:"teams",key:"teams"},{title:"Budget",dataIndex:"max_budget",key:"max_budget"},{title:"Status",key:"status",render:(e,s)=>s.isValid?s.status&&"pending"!==s.status?"success"===s.status?(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(O.Z,{className:"h-5 w-5 text-green-500 mr-2"}),(0,l.jsx)("span",{className:"text-green-500",children:"Success"})]}),s.invitation_link&&(0,l.jsx)("div",{className:"mt-1",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:s.invitation_link}),(0,l.jsx)(z.CopyToClipboard,{text:s.invitation_link,onCopy:()=>F.ZP.success("Invitation link copied!"),children:(0,l.jsx)("button",{className:"ml-1 text-blue-500 text-xs hover:text-blue-700",children:"Copy"})})]})})]}):(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(R.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,l.jsx)("span",{className:"text-red-500",children:"Failed"})]}),s.error&&(0,l.jsx)("span",{className:"text-sm text-red-500 ml-7",children:JSON.stringify(s.error)})]}):(0,l.jsx)("span",{className:"text-gray-500",children:"Pending"}):(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(R.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,l.jsx)("span",{className:"text-red-500",children:"Invalid"})]}),s.error&&(0,l.jsx)("span",{className:"text-sm text-red-500 ml-7",children:s.error})]})}],size:"small",pagination:{pageSize:5},scroll:{y:300},rowClassName:e=>e.isValid?"":"bg-red-50"}),!d.some(e=>"success"===e.status||"failed"===e.status)&&(0,l.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,l.jsx)(w.z,{onClick:()=>{o([]),x(null)},variant:"secondary",className:"mr-3",children:"Back"}),(0,l.jsx)(w.z,{onClick:A,disabled:0===d.filter(e=>e.isValid).length||c,children:c?"Creating...":"Create ".concat(d.filter(e=>e.isValid).length," Users")})]}),d.some(e=>"success"===e.status||"failed"===e.status)&&(0,l.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,l.jsx)(w.z,{onClick:()=>{o([]),x(null)},variant:"secondary",className:"mr-3",children:"Start New Bulk Import"}),(0,l.jsxs)(w.z,{onClick:()=>{let e=d.map(e=>({user_email:e.user_email,user_role:e.user_role,status:e.status,key:e.key||"",invitation_link:e.invitation_link||"",error:e.error||""})),s=new Blob([E().unparse(e)],{type:"text/csv"}),t=window.URL.createObjectURL(s),l=document.createElement("a");l.href=t,l.download="bulk_users_results.csv",document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(t)},variant:"primary",className:"flex items-center",children:[(0,l.jsx)(k.Z,{className:"mr-2"})," Download User Credentials"]})]})]})]})})})]})},D=t(84376),M=t(46468),A=t(98187);let{Option:q}=x.default,{Text:K,Link:G,Title:J}=h.default,W=()=>"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let s=16*Math.random()|0;return("x"==e?s:3&s|8).toString(16)}),$=e=>{let{userID:s,accessToken:t,teams:h,possibleUIRoles:w,onUserCreated:_,isEmbedded:C=!1}=e,k=(0,i.NL)(),[S,Z]=(0,N.useState)(null),[U]=f.Z.useForm(),[I,P]=(0,N.useState)(!1),[L,E]=(0,N.useState)(!1),[R,O]=(0,N.useState)([]),[T,z]=(0,N.useState)(!1),[q,J]=(0,N.useState)(null),[$,H]=(0,N.useState)(null);(0,N.useEffect)(()=>{let e=async()=>{try{let e=await (0,V.modelAvailableCall)(t,s,"any"),l=[];for(let s=0;s<e.data.length;s++){let t=e.data[s];l.push(t.id)}O(l);let a=await (0,V.getProxyUISettings)(t);Z(a)}catch(e){console.error("Error fetching model data:",e)}};H((0,V.getProxyBaseUrl)()),e()},[]);let Q=async e=>{var l,a,r;try{F.ZP.info("Making API Call"),C||P(!0),e.models&&0!==e.models.length||"proxy_admin"===e.user_role||(e.models=["no-default-models"]);let a=await (0,V.userCreateCall)(t,null,e);await k.invalidateQueries({queryKey:["userList"]}),E(!0);let r=(null===(l=a.data)||void 0===l?void 0:l.user_id)||a.user_id;if(_&&C){_(r),U.resetFields();return}if(null==S?void 0:S.SSO_ENABLED){let e={id:W(),user_id:r,is_accepted:!1,accepted_at:null,expires_at:new Date(Date.now()+6048e5),created_at:new Date,created_by:s,updated_at:new Date,updated_by:s,has_user_setup_sso:!0};J(e),z(!0)}else(0,V.invitationCreateCall)(t,r).then(e=>{e.has_user_setup_sso=!1,J(e),z(!0)});F.ZP.success("API user Created"),U.resetFields(),localStorage.removeItem("userData"+s)}catch(s){let e=(null===(r=s.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.detail)||(null==s?void 0:s.message)||"Error creating the user";F.ZP.fromBackend(e),console.error("Error creating the user:",s)}};return C?(0,l.jsxs)(f.Z,{form:U,onFinish:Q,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsx)(p.Z,{message:"Email invitations",description:(0,l.jsxs)(l.Fragment,{children:["New users receive an email invite only when an email integration (SMTP, Resend, or SendGrid) is configured."," ",(0,l.jsx)(G,{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",children:"Learn how to set up email notifications"})]}),type:"info",showIcon:!0,className:"mb-4"}),(0,l.jsx)(f.Z.Item,{label:"User Email",name:"user_email",children:(0,l.jsx)(u.Z,{placeholder:""})}),(0,l.jsx)(f.Z.Item,{label:"User Role",name:"user_role",children:(0,l.jsx)(x.default,{children:w&&Object.entries(w).map(e=>{let[s,{ui_label:t,description:a}]=e;return(0,l.jsx)(m.Z,{value:s,title:t,children:(0,l.jsxs)("div",{className:"flex",children:[t," ",(0,l.jsx)(K,{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:a})]})},s)})})}),(0,l.jsx)(f.Z.Item,{label:"Team",name:"team_id",children:(0,l.jsx)(x.default,{placeholder:"Select Team",style:{width:"100%"},children:(0,l.jsx)(D.Z,{teams:h})})}),(0,l.jsx)(f.Z.Item,{label:"Metadata",name:"metadata",children:(0,l.jsx)(j.default.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(g.ZP,{htmlType:"submit",children:"Create User"})})]}):(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(c.Z,{className:"mb-0",onClick:()=>P(!0),children:"+ Invite User"}),(0,l.jsx)(B,{accessToken:t,teams:h,possibleUIRoles:w}),(0,l.jsxs)(v.Z,{title:"Invite User",open:I,width:800,footer:null,onOk:()=>{P(!1),U.resetFields()},onCancel:()=>{P(!1),E(!1),U.resetFields()},children:[(0,l.jsxs)(b.Z,{direction:"vertical",size:"middle",children:[(0,l.jsx)(K,{className:"mb-1",children:"Create a User who can own keys"}),(0,l.jsx)(p.Z,{message:"Email invitations",description:(0,l.jsxs)(l.Fragment,{children:["New users receive an email invite only when an email integration (SMTP, Resend, or SendGrid) is configured."," ",(0,l.jsx)(G,{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",children:"Learn how to set up email notifications"})]}),type:"info",showIcon:!0,className:"mb-4"})]}),(0,l.jsxs)(f.Z,{form:U,onFinish:Q,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsx)(f.Z.Item,{label:"User Email",name:"user_email",children:(0,l.jsx)(j.default,{})}),(0,l.jsx)(f.Z.Item,{label:(0,l.jsxs)("span",{children:["Global Proxy Role"," ",(0,l.jsx)(y.Z,{title:"This role is independent of any team/org specific roles. Configure Team / Organization Admins in the Settings",children:(0,l.jsx)(a.Z,{})})]}),name:"user_role",children:(0,l.jsx)(x.default,{children:w&&Object.entries(w).map(e=>{let[s,{ui_label:t,description:a}]=e;return(0,l.jsxs)(m.Z,{value:s,title:t,children:[(0,l.jsx)(K,{children:t}),(0,l.jsxs)(K,{type:"secondary",children:[" - ",a]})]},s)})})}),(0,l.jsx)(f.Z.Item,{label:"Team",className:"gap-2",name:"team_id",help:"If selected, user will be added as a 'user' role to the team.",children:(0,l.jsx)(D.Z,{teams:h})}),(0,l.jsx)(f.Z.Item,{label:"Metadata",name:"metadata",children:(0,l.jsx)(j.default.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,l.jsxs)(n.Z,{children:[(0,l.jsx)(o.Z,{children:(0,l.jsx)(K,{strong:!0,children:"Personal Key Creation"})}),(0,l.jsx)(d.Z,{children:(0,l.jsx)(f.Z.Item,{className:"gap-2",label:(0,l.jsxs)("span",{children:["Models"," ",(0,l.jsx)(y.Z,{title:"Models user has access to, outside of team scope.",children:(0,l.jsx)(a.Z,{style:{marginLeft:"4px"}})})]}),name:"models",help:"Models user has access to, outside of team scope.",children:(0,l.jsxs)(x.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,l.jsx)(x.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),(0,l.jsx)(x.default.Option,{value:"no-default-models",children:"No Default Models"},"no-default-models"),R.map(e=>(0,l.jsx)(x.default.Option,{value:e,children:(0,M.W0)(e)},e))]})})})]}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(g.ZP,{type:"primary",icon:(0,l.jsx)(r.Z,{}),htmlType:"submit",children:"Invite User"})})]})]}),L&&(0,l.jsx)(A.Z,{isInvitationLinkModalVisible:T,setIsInvitationLinkModalVisible:z,baseUrl:$||"",invitationLinkData:q})]})}},65925:function(e,s,t){t.d(s,{m:function(){return i}});var l=t(57437);t(2265);var a=t(37592);let{Option:r}=a.default,i=e=>e?({"24h":"daily","7d":"weekly","30d":"monthly"})[e]||e:"Not set";s.Z=e=>{let{value:s,onChange:t,className:i="",style:n={}}=e;return(0,l.jsxs)(a.default,{style:{width:"100%",...n},value:s||void 0,onChange:t,className:i,placeholder:"n/a",allowClear:!0,children:[(0,l.jsx)(r,{value:"24h",children:"daily"}),(0,l.jsx)(r,{value:"7d",children:"weekly"}),(0,l.jsx)(r,{value:"30d",children:"monthly"})]})}},84376:function(e,s,t){var l=t(57437);t(2265);var a=t(37592);s.Z=e=>{let{teams:s,value:t,onChange:r,disabled:i}=e;return console.log("disabled",i),(0,l.jsx)(a.default,{showSearch:!0,placeholder:"Search or select a team",value:t,onChange:r,disabled:i,allowClear:!0,filterOption:(e,t)=>{if(!t)return!1;let l=null==s?void 0:s.find(e=>e.team_id===t.key);if(!l)return!1;let a=e.toLowerCase().trim(),r=(l.team_alias||"").toLowerCase(),i=(l.team_id||"").toLowerCase();return r.includes(a)||i.includes(a)},optionFilterProp:"children",children:null==s?void 0:s.map(e=>(0,l.jsxs)(a.default.Option,{value:e.team_id,children:[(0,l.jsx)("span",{className:"font-medium",children:e.team_alias})," ",(0,l.jsxs)("span",{className:"text-gray-500",children:["(",e.team_id,")"]})]},e.team_id))})}},98187:function(e,s,t){t.d(s,{Z:function(){return o}});var l=t(57437);t(2265);var a=t(57840),r=t(22116),i=t(29233),n=t(19431),d=t(9114);function o(e){let{isInvitationLinkModalVisible:s,setIsInvitationLinkModalVisible:t,baseUrl:o,invitationLinkData:c,modalType:m="invitation"}=e,{Title:u,Paragraph:x}=a.default,h=()=>{if(!o)return"";let e=new URL(o).pathname,s=e&&"/"!==e?"".concat(e,"/ui"):"ui";if(null==c?void 0:c.has_user_setup_sso)return new URL(s,o).toString();let t="".concat(s,"?invitation_id=").concat(null==c?void 0:c.id);return"resetPassword"===m&&(t+="&action=reset_password"),new URL(t,o).toString()};return(0,l.jsxs)(r.Z,{title:"invitation"===m?"Invitation Link":"Reset Password Link",open:s,width:800,footer:null,onOk:()=>{t(!1)},onCancel:()=>{t(!1)},children:[(0,l.jsx)(x,{children:"invitation"===m?"Copy and send the generated link to onboard this user to the proxy.":"Copy and send the generated link to the user to reset their password."}),(0,l.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,l.jsx)(n.x,{className:"text-base",children:"User ID"}),(0,l.jsx)(n.x,{children:null==c?void 0:c.user_id})]}),(0,l.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,l.jsx)(n.x,{children:"invitation"===m?"Invitation Link":"Reset Password Link"}),(0,l.jsx)(n.x,{children:(0,l.jsx)(n.x,{children:h()})})]}),(0,l.jsx)("div",{className:"flex justify-end mt-5",children:(0,l.jsx)(i.CopyToClipboard,{text:h(),onCopy:()=>d.ZP.success("Copied!"),children:(0,l.jsx)(n.z,{variant:"primary",children:"invitation"===m?"Copy invitation link":"Copy password reset link"})})})]})}}}]);