"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1125],{44803:function(e,s,t){t.d(s,{Dx:function(){return a.Z},Zb:function(){return r.Z},xv:function(){return l.Z}});var r=t(12514),l=t(84264),a=t(96761)},71125:function(e,s,t){t.d(s,{d:function(){return sZ},o:function(){return sE}});var r=t(57437),l=t(20347),a=t(67187),n=t(78489),i=t(12485),o=t(18135),c=t(35242),d=t(29706),u=t(77991),m=t(84264),x=t(96761),h=t(57840),p=t(37592),g=t(22116),f=t(76188),v=t(99981),j=t(2265),b=t(68474),y=t(71632),N=t(90246),_=t(19250),w=t(39760);let C=(0,N.n)("mcpServerHealth"),S=e=>{let{accessToken:s}=(0,w.Z)();return(0,y.a)({queryKey:[...C.lists(),{serverIds:e}],queryFn:async()=>await (0,_.fetchMCPServerHealth)(s,e),enabled:!!s,refetchInterval:3e4})};var Z=t(9114),k=t(12322),P=t(10032),A=t(4260),I=t(15424),T=t(64504);let M={NONE:"none",API_KEY:"api_key",BEARER_TOKEN:"bearer_token",BASIC:"basic",OAUTH2:"oauth2"},O={INTERACTIVE:"interactive",M2M:"m2m"},E={SSE:"sse",STDIO:"stdio",OPENAPI:"openapi"},L=(e,s)=>null==e?E.SSE:s&&e!==E.STDIO?E.OPENAPI:e,z=e=>null==e?M.NONE:e,F="rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",R=e=>{let{label:s,tooltip:t}=e;return(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:[s,(0,r.jsx)(v.Z,{title:t,children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]})};var q=e=>{var s,t;let{isM2M:l,isEditing:a=!1,oauthFlow:n,initialFlowType:i}=e,o=a?" (leave blank to keep existing)":"";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"OAuth Flow Type",tooltip:"Choose how the proxy authenticates with this MCP server. M2M is for server-to-server communication using client credentials. Interactive (PKCE) is for user-facing flows that require browser-based authorization."}),name:"oauth_flow_type",...i?{initialValue:i}:{},children:(0,r.jsxs)(p.default,{className:"rounded-lg",size:"large",children:[(0,r.jsx)(p.default.Option,{value:O.M2M,children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Machine-to-Machine (M2M)"}),(0,r.jsx)("span",{className:"text-gray-400 text-xs ml-2",children:"server-to-server, no user interaction"})]})}),(0,r.jsx)(p.default.Option,{value:O.INTERACTIVE,children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Interactive (PKCE)"}),(0,r.jsx)("span",{className:"text-gray-400 text-xs ml-2",children:"browser-based user authorization"})]})})]})}),l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"Client ID",tooltip:"OAuth2 client ID for the client_credentials grant."}),name:["credentials","client_id"],rules:[{required:!0,message:"Client ID is required for M2M OAuth"}],children:(0,r.jsx)(T.o,{type:"password",placeholder:"Enter OAuth client ID".concat(o),className:F})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"Client Secret",tooltip:"OAuth2 client secret for the client_credentials grant."}),name:["credentials","client_secret"],rules:[{required:!0,message:"Client Secret is required for M2M OAuth"}],children:(0,r.jsx)(T.o,{type:"password",placeholder:"Enter OAuth client secret".concat(o),className:F})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"Token URL",tooltip:"Token endpoint URL for the client_credentials grant."}),name:"token_url",rules:[{required:!0,message:"Token URL is required for M2M OAuth"}],children:(0,r.jsx)(T.o,{placeholder:"https://auth.example.com/oauth/token",className:F})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"Scopes (optional)",tooltip:"Optional scopes to request with the client_credentials grant."}),name:["credentials","scopes"],children:(0,r.jsx)(p.default,{mode:"tags",tokenSeparators:[","],placeholder:"Add scopes",className:"rounded-lg",size:"large"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"Client ID (optional)",tooltip:"Provide only if your MCP server cannot handle dynamic client registration."}),name:["credentials","client_id"],children:(0,r.jsx)(T.o,{type:"password",placeholder:"Enter client ID".concat(o),className:F})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"Client Secret (optional)",tooltip:"Provide only if your MCP server cannot handle dynamic client registration."}),name:["credentials","client_secret"],children:(0,r.jsx)(T.o,{type:"password",placeholder:"Enter client secret".concat(o),className:F})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"Scopes (optional)",tooltip:"Optional scopes requested during token exchange. Separate multiple scopes with enter or commas."}),name:["credentials","scopes"],children:(0,r.jsx)(p.default,{mode:"tags",tokenSeparators:[","],placeholder:"Add scopes",className:"rounded-lg",size:"large"})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"Authorization URL (optional)",tooltip:"Optional override for the authorization endpoint."}),name:"authorization_url",children:(0,r.jsx)(T.o,{placeholder:"https://example.com/oauth/authorize",className:F})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"Token URL (optional)",tooltip:"Optional override for the token endpoint."}),name:"token_url",children:(0,r.jsx)(T.o,{placeholder:"https://example.com/oauth/token",className:F})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)(R,{label:"Registration URL (optional)",tooltip:"Optional override for the dynamic client registration endpoint."}),name:"registration_url",children:(0,r.jsx)(T.o,{placeholder:"https://example.com/oauth/register",className:F})}),n&&(0,r.jsxs)("div",{className:"rounded-lg border border-dashed border-gray-300 p-4 space-y-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Use OAuth to fetch a fresh access token and temporarily save it in the session as the authentication value."}),(0,r.jsx)(T.z,{variant:"secondary",onClick:n.startOAuthFlow,disabled:"authorizing"===n.status||"exchanging"===n.status,children:"authorizing"===n.status?"Waiting for authorization...":"exchanging"===n.status?"Exchanging authorization code...":"Authorize & Fetch Token"}),n.error&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:n.error}),"success"===n.status&&(null===(s=n.tokenResponse)||void 0===s?void 0:s.access_token)&&(0,r.jsxs)("p",{className:"text-sm text-green-600",children:["Token fetched. Expires in ",null!==(t=n.tokenResponse.expires_in)&&void 0!==t?t:"?"," seconds."]})]})]})]})},U=t(12221),V=t(44851),B=t(33866),D=t(62670),H=t(58630),K=t(44803),J=e=>{let{value:s={},onChange:t,tools:l=[],disabled:a=!1}=e,n=(e,r)=>{let l={...s,tool_name_to_cost_per_query:{...s.tool_name_to_cost_per_query,[e]:r}};null==t||t(l)};return(0,r.jsx)(K.Zb,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)(D.Z,{className:"text-green-600"}),(0,r.jsx)(K.Dx,{children:"Cost Configuration"}),(0,r.jsx)(v.Z,{title:"Configure costs for this MCP server's tool calls. Set a default rate and per-tool overrides.",children:(0,r.jsx)(I.Z,{className:"text-gray-400"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Default Cost per Query ($)",(0,r.jsx)(v.Z,{title:"Default cost charged for each tool call to this server.",children:(0,r.jsx)(I.Z,{className:"ml-1 text-gray-400"})})]}),(0,r.jsx)(U.Z,{min:0,step:1e-4,precision:4,placeholder:"0.0000",value:s.default_cost_per_query,onChange:e=>{let r={...s,default_cost_per_query:e};null==t||t(r)},disabled:a,style:{width:"200px"},addonBefore:"$"}),(0,r.jsx)(K.xv,{className:"block mt-1 text-gray-500 text-sm",children:"Set a default cost for all tool calls to this server"})]}),l.length>0&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Tool-Specific Costs ($)",(0,r.jsx)(v.Z,{title:"Override the default cost for specific tools. Leave blank to use the default rate.",children:(0,r.jsx)(I.Z,{className:"ml-1 text-gray-400"})})]}),(0,r.jsx)(V.default,{items:[{key:"1",label:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(H.Z,{className:"mr-2 text-blue-500"}),(0,r.jsx)("span",{className:"font-medium",children:"Available Tools"}),(0,r.jsx)(B.Z,{count:l.length,style:{backgroundColor:"#52c41a",marginLeft:"8px"}})]}),children:(0,r.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:l.map((e,t)=>{var l;return(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(K.xv,{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,r.jsx)(K.xv,{className:"text-gray-500 text-sm block mt-1",children:e.description})]}),(0,r.jsx)("div",{className:"ml-4",children:(0,r.jsx)(U.Z,{min:0,step:1e-4,precision:4,placeholder:"Use default",value:null===(l=s.tool_name_to_cost_per_query)||void 0===l?void 0:l[e.name],onChange:s=>n(e.name,s),disabled:a,style:{width:"120px"},addonBefore:"$"})})]},t)})})}]})]})]}),(s.default_cost_per_query||s.tool_name_to_cost_per_query&&Object.keys(s.tool_name_to_cost_per_query).length>0)&&(0,r.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,r.jsx)(K.xv,{className:"text-blue-800 font-medium",children:"Cost Summary:"}),(0,r.jsxs)("div",{className:"mt-2 space-y-1",children:[s.default_cost_per_query&&(0,r.jsxs)(K.xv,{className:"text-blue-700",children:["• Default cost: $",s.default_cost_per_query.toFixed(4)," per query"]}),s.tool_name_to_cost_per_query&&Object.entries(s.tool_name_to_cost_per_query).map(e=>{let[s,t]=e;return null!=t&&(0,r.jsxs)(K.xv,{className:"text-blue-700",children:["• ",s,": $",t.toFixed(4)," per query"]},s)})]})]})]})})},Y=t(10353),G=t(51653),W=t(5545),$=t(83669),Q=t(29271),X=t(89245);let ee=e=>{var s,t;let{accessToken:r,oauthAccessToken:l,formValues:a,enabled:n=!0}=e,[i,o]=(0,j.useState)([]),[c,d]=(0,j.useState)(!1),[u,m]=(0,j.useState)(null),[x,h]=(0,j.useState)(null),[p,g]=(0,j.useState)(!1),f=a.auth_type===M.OAUTH2&&a.oauth_flow_type===O.M2M,v=a.auth_type===M.OAUTH2&&!f,b=!!((a.transport===E.OPENAPI?!!a.spec_path:!!a.url)&&a.transport&&a.auth_type&&r&&(!v||l)),y=JSON.stringify(null!==(s=a.static_headers)&&void 0!==s?s:{}),N=JSON.stringify(null!==(t=a.credentials)&&void 0!==t?t:{}),w=async()=>{if(r&&(a.url||a.spec_path)&&(!v||l)){d(!0),m(null);try{let e=Array.isArray(a.static_headers)?a.static_headers.reduce((e,s)=>{var t;let r=null==s?void 0:null===(t=s.header)||void 0===t?void 0:t.trim();return r&&(e[r]=(null==s?void 0:s.value)!=null?String(s.value):""),e},{}):!Array.isArray(a.static_headers)&&a.static_headers&&"object"==typeof a.static_headers?Object.entries(a.static_headers).reduce((e,s)=>{let[t,r]=s;return t&&(e[t]=null!=r?String(r):""),e},{}):{},s=a.credentials&&"object"==typeof a.credentials?Object.entries(a.credentials).reduce((e,s)=>{let[t,r]=s;if(null==r||""===r)return e;if("scopes"===t){if(Array.isArray(r)){let s=r.filter(e=>null!=e&&""!==e);s.length>0&&(e[t]=s)}}else e[t]=r;return e},{}):void 0,t=a.transport===E.OPENAPI?"http":a.transport,n={server_id:a.server_id||"",server_name:a.server_name||"",url:a.url,spec_path:a.spec_path,transport:t,auth_type:a.auth_type,authorization_url:a.authorization_url,token_url:a.token_url,registration_url:a.registration_url,mcp_info:a.mcp_info,static_headers:e};s&&Object.keys(s).length>0&&(n.credentials=s);let i=await (0,_.testMCPToolsListRequest)(r,n,l);if(i.tools&&!i.error)o(i.tools),m(null),h(null),i.tools.length>0&&!p&&g(!0);else{let e=i.message||"Failed to retrieve tools list";m(e),h(i.stack_trace||null),o([]),g(!1)}}catch(e){console.error("Tools fetch error:",e),m(e instanceof Error?e.message:String(e)),h(null),o([]),g(!1)}finally{d(!1)}}},C=()=>{o([]),m(null),h(null),g(!1)};return(0,j.useEffect)(()=>{n&&(b?w():C())},[a.url,a.spec_path,a.transport,a.auth_type,r,n,l,b,y,N]),{tools:i,isLoadingTools:c,toolsError:u,toolsErrorStackTrace:x,hasShownSuccessMessage:p,canFetchTools:b,fetchTools:w,clearTools:C}};var es=e=>{let{accessToken:s,oauthAccessToken:t,formValues:l,onToolsLoaded:a}=e,{tools:n,isLoadingTools:i,toolsError:o,toolsErrorStackTrace:c,canFetchTools:d,fetchTools:u}=ee({accessToken:s,oauthAccessToken:t,formValues:l,enabled:!0});return((0,j.useEffect)(()=>{null==a||a(n)},[n,a]),d||l.url||l.spec_path)?(0,r.jsx)(K.Zb,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)($.Z,{className:"text-blue-600"}),(0,r.jsx)(K.Dx,{children:"Connection Status"})]}),!d&&(l.url||l.spec_path)&&(0,r.jsxs)("div",{className:"text-center py-6 text-gray-400 border rounded-lg border-dashed",children:[(0,r.jsx)(H.Z,{className:"text-2xl mb-2"}),(0,r.jsx)(K.xv,{children:"Complete required fields to test connection"}),(0,r.jsx)("br",{}),(0,r.jsx)(K.xv,{className:"text-sm",children:"Fill in URL, Transport, and Authentication to test MCP server connection"})]}),d&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(K.xv,{className:"text-gray-700 font-medium",children:i?"Testing connection to MCP server...":n.length>0?"Connection successful":o?"Connection failed":"Ready to test connection"}),(0,r.jsx)("br",{}),(0,r.jsxs)(K.xv,{className:"text-gray-500 text-sm",children:["Server: ",l.url||l.spec_path]})]}),i&&(0,r.jsxs)("div",{className:"flex items-center text-blue-600",children:[(0,r.jsx)(Y.Z,{size:"small",className:"mr-2"}),(0,r.jsx)(K.xv,{className:"text-blue-600",children:"Connecting..."})]}),!i&&!o&&n.length>0&&(0,r.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,r.jsx)($.Z,{className:"mr-1"}),(0,r.jsx)(K.xv,{className:"text-green-600 font-medium",children:"Connected"})]}),o&&(0,r.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,r.jsx)(Q.Z,{className:"mr-1"}),(0,r.jsx)(K.xv,{className:"text-red-600 font-medium",children:"Failed"})]})]}),i&&(0,r.jsxs)("div",{className:"flex items-center justify-center py-6",children:[(0,r.jsx)(Y.Z,{size:"large"}),(0,r.jsx)(K.xv,{className:"ml-3",children:"Testing connection and loading tools..."})]}),o&&(0,r.jsx)(G.Z,{message:"Connection Failed",description:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:o}),c&&(0,r.jsx)(V.default,{items:[{key:"stack-trace",label:"Stack Trace",children:(0,r.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:"12px",fontFamily:"monospace",margin:0,padding:"8px",backgroundColor:"#f5f5f5",borderRadius:"4px",maxHeight:"400px",overflow:"auto"},children:c})}],style:{marginTop:"12px"}})]}),type:"error",showIcon:!0,action:(0,r.jsx)(W.ZP,{icon:(0,r.jsx)(X.Z,{}),onClick:u,size:"small",children:"Retry"})}),!i&&0===n.length&&!o&&(0,r.jsxs)("div",{className:"text-center py-6 text-gray-500 border rounded-lg border-dashed",children:[(0,r.jsx)($.Z,{className:"text-2xl mb-2 text-green-500"}),(0,r.jsx)(K.xv,{className:"text-green-600 font-medium",children:"Connection successful!"}),(0,r.jsx)("br",{}),(0,r.jsx)(K.xv,{className:"text-gray-500",children:"No tools found for this MCP server"})]})]})]})}):null},et=t(29436),er=t(61994),el=e=>{let{accessToken:s,oauthAccessToken:t,formValues:l,allowedTools:a,existingAllowedTools:n,onAllowedToolsChange:i}=e,o=(0,j.useRef)(0),[c,d]=(0,j.useState)(""),{tools:u,isLoadingTools:m,toolsError:x,canFetchTools:h}=ee({accessToken:s,oauthAccessToken:t,formValues:l,enabled:!0}),p=u.filter(e=>{let s=c.toLowerCase();return e.name.toLowerCase().includes(s)||e.description&&e.description.toLowerCase().includes(s)});(0,j.useEffect)(()=>{if(u.length>0&&u.length!==o.current&&0===a.length){if(n&&n.length>0){let e=u.map(e=>e.name);i(n.filter(s=>e.includes(s)))}else i(u.map(e=>e.name))}o.current=u.length},[u,a.length,n,i]);let g=e=>{a.includes(e)?i(a.filter(s=>s!==e)):i([...a,e])};return h||l.url||l.spec_path?(0,r.jsx)(K.Zb,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(H.Z,{className:"text-blue-600"}),(0,r.jsx)(K.Dx,{children:"Tool Configuration"}),u.length>0&&(0,r.jsx)(B.Z,{count:u.length,style:{backgroundColor:"#52c41a"}})]})}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,r.jsxs)(K.xv,{className:"text-blue-800 text-sm",children:[(0,r.jsx)("strong",{children:"Select which tools users can call:"})," Only checked tools will be available for users to invoke. Unchecked tools will be blocked from execution."]})}),m&&(0,r.jsxs)("div",{className:"flex items-center justify-center py-6",children:[(0,r.jsx)(Y.Z,{size:"large"}),(0,r.jsx)(K.xv,{className:"ml-3",children:"Loading tools..."})]}),x&&!m&&(0,r.jsxs)("div",{className:"text-center py-6 text-red-500 border rounded-lg border-dashed border-red-300 bg-red-50",children:[(0,r.jsx)(H.Z,{className:"text-2xl mb-2"}),(0,r.jsx)(K.xv,{className:"text-red-600 font-medium",children:"Unable to load tools"}),(0,r.jsx)("br",{}),(0,r.jsx)(K.xv,{className:"text-sm text-red-500",children:x})]}),!m&&!x&&0===u.length&&h&&(0,r.jsxs)("div",{className:"text-center py-6 text-gray-400 border rounded-lg border-dashed",children:[(0,r.jsx)(H.Z,{className:"text-2xl mb-2"}),(0,r.jsx)(K.xv,{children:"No tools available for configuration"}),(0,r.jsx)("br",{}),(0,r.jsx)(K.xv,{className:"text-sm",children:"Connect to an MCP server with tools to configure them"})]}),!h&&(l.url||l.spec_path)&&(0,r.jsxs)("div",{className:"text-center py-6 text-gray-400 border rounded-lg border-dashed",children:[(0,r.jsx)(H.Z,{className:"text-2xl mb-2"}),(0,r.jsx)(K.xv,{children:"Complete required fields to configure tools"}),(0,r.jsx)("br",{}),(0,r.jsx)(K.xv,{className:"text-sm",children:"Fill in URL, Transport, and Authentication to load available tools"})]}),!m&&!x&&u.length>0&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 rounded-lg border border-green-200 flex-1",children:[(0,r.jsx)($.Z,{className:"text-green-600"}),(0,r.jsxs)(K.xv,{className:"text-green-700 font-medium",children:[a.length," of ",u.length," ",1===u.length?"tool":"tools"," enabled for user access"]})]}),(0,r.jsxs)("div",{className:"flex gap-2 ml-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{i(u.map(e=>e.name))},className:"px-3 py-1.5 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-md transition-colors",children:"Enable All"}),(0,r.jsx)("button",{type:"button",onClick:()=>{i([])},className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-700 hover:bg-gray-100 rounded-md transition-colors",children:"Disable All"})]})]}),(0,r.jsx)(A.default,{placeholder:"Search tools by name or description...",prefix:(0,r.jsx)(et.Z,{className:"text-gray-400"}),value:c,onChange:e=>d(e.target.value),allowClear:!0,className:"rounded-lg",size:"large"}),(0,r.jsx)("div",{className:"space-y-2",children:0===p.length?(0,r.jsxs)("div",{className:"text-center py-6 text-gray-400 border rounded-lg border-dashed",children:[(0,r.jsx)(et.Z,{className:"text-2xl mb-2"}),(0,r.jsxs)(K.xv,{children:['No tools found matching "',c,'"']})]}):p.map((e,s)=>(0,r.jsx)("div",{className:"p-4 rounded-lg border transition-colors cursor-pointer ".concat(a.includes(e.name)?"bg-blue-50 border-blue-300 hover:border-blue-400":"bg-gray-50 border-gray-200 hover:border-gray-300"),onClick:()=>g(e.name),children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(er.Z,{checked:a.includes(e.name),onChange:()=>g(e.name)}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(K.xv,{className:"font-medium text-gray-900",children:e.name}),(0,r.jsx)("span",{className:"px-2 py-0.5 text-xs rounded-full font-medium ".concat(a.includes(e.name)?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.includes(e.name)?"Enabled":"Disabled"})]}),e.description&&(0,r.jsx)(K.xv,{className:"text-gray-500 text-sm block mt-1",children:e.description}),(0,r.jsx)(K.xv,{className:"text-gray-400 text-xs block mt-1",children:a.includes(e.name)?"✓ Users can call this tool":"✗ Users cannot call this tool"})]})]})},s))})]})]})}):null},ea=e=>{let{isVisible:s,required:t=!0}=e;return s?(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Stdio Configuration (JSON)",(0,r.jsx)(v.Z,{title:"Paste your stdio MCP server configuration in JSON format. You can use the full mcpServers structure from config.yaml or just the inner server configuration.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"stdio_config",rules:[...t?[{required:!0,message:"Please enter stdio configuration"}]:[],{validator:(e,s)=>{if(!s)return Promise.resolve();try{return JSON.parse(s),Promise.resolve()}catch(e){return Promise.reject("Please enter valid JSON")}}}],children:(0,r.jsx)(A.default.TextArea,{placeholder:'{\n  "mcpServers": {\n    "circleci-mcp-server": {\n      "command": "npx",\n      "args": ["-y", "@circleci/mcp-server-circleci"],\n      "env": {\n        "CIRCLECI_TOKEN": "your-circleci-token",\n        "CIRCLECI_BASE_URL": "https://circleci.com"\n      }\n    }\n  }\n}',rows:12,className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500 font-mono text-sm"})}):null},en=t(63709),ei=t(55590),eo=t(45246),ec=t(96473);let{Panel:ed}=V.default;var eu=e=>{var s,t;let{availableAccessGroups:l,mcpServer:a,searchValue:n,setSearchValue:i,getAccessGroupOptions:o}=e,c=P.Z.useFormInstance();return(0,j.useEffect)(()=>{if(a){if(a.extra_headers&&c.setFieldValue("extra_headers",a.extra_headers),a.static_headers){let e=Object.entries(a.static_headers).map(e=>{let[s,t]=e;return{header:s,value:null!=t?String(t):""}});c.setFieldValue("static_headers",e)}"boolean"==typeof a.allow_all_keys&&c.setFieldValue("allow_all_keys",a.allow_all_keys),"boolean"==typeof a.available_on_public_internet&&c.setFieldValue("available_on_public_internet",a.available_on_public_internet)}else c.setFieldValue("allow_all_keys",!1),c.setFieldValue("available_on_public_internet",!1)},[a,c]),(0,r.jsx)(V.default,{className:"bg-gray-50 border border-gray-200 rounded-lg",expandIconPosition:"end",ghost:!1,children:(0,r.jsx)(ed,{header:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Permission Management / Access Control"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 ml-4",children:"Configure access permissions and security settings (Optional)"})]}),className:"border-0",children:(0,r.jsxs)("div",{className:"space-y-6 pt-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Allow All LiteLLM Keys",(0,r.jsx)(v.Z,{title:"When enabled, every API key can access this MCP server.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:'Enable if this server should be "public" to all keys.'})]}),(0,r.jsx)(P.Z.Item,{name:"allow_all_keys",valuePropName:"checked",initialValue:null!==(s=null==a?void 0:a.allow_all_keys)&&void 0!==s&&s,className:"mb-0",children:(0,r.jsx)(en.Z,{})})]}),(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Available on Public Internet",(0,r.jsx)(v.Z,{title:"When enabled, this MCP server is accessible from external/public IPs (e.g., ChatGPT). When disabled, only callers from internal/private networks can access it.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Enable if this server should be reachable from the public internet."})]}),(0,r.jsx)(P.Z.Item,{name:"available_on_public_internet",valuePropName:"checked",initialValue:null!==(t=null==a?void 0:a.available_on_public_internet)&&void 0!==t&&t,className:"mb-0",children:(0,r.jsx)(en.Z,{})})]}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["MCP Access Groups",(0,r.jsx)(v.Z,{title:"Specify access groups for this MCP server. Users must be in at least one of these groups to access the server.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"mcp_access_groups",className:"mb-4",children:(0,r.jsx)(p.default,{mode:"tags",showSearch:!0,placeholder:"Select existing groups or type to create new ones",optionFilterProp:"value",filterOption:(e,s)=>{var t;return(null!==(t=null==s?void 0:s.value)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},onSearch:e=>i(e),tokenSeparators:[","],options:o(),maxTagCount:"responsive",allowClear:!0})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Extra Headers",(0,r.jsx)(v.Z,{title:"Forward custom headers from incoming requests to this MCP server (e.g., Authorization, X-Custom-Header, User-Agent)",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})}),(null==a?void 0:a.extra_headers)&&a.extra_headers.length>0&&(0,r.jsxs)("span",{className:"ml-2 text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full",children:[a.extra_headers.length," configured"]})]}),name:"extra_headers",children:(0,r.jsx)(p.default,{mode:"tags",placeholder:(null==a?void 0:a.extra_headers)&&a.extra_headers.length>0?"Currently: ".concat(a.extra_headers.join(", ")):"Enter header names (e.g., Authorization, X-Custom-Header)",className:"rounded-lg",size:"large",tokenSeparators:[","],allowClear:!0})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Static Headers",(0,r.jsx)(v.Z,{title:"Send these key-value headers with every request to this MCP server.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),required:!1,children:(0,r.jsx)(P.Z.List,{name:"static_headers",children:(e,s)=>{let{add:t,remove:l}=s;return(0,r.jsxs)("div",{className:"space-y-3",children:[e.map(e=>{let{key:s,name:t,...a}=e;return(0,r.jsxs)(ei.Z,{className:"flex w-full",align:"baseline",size:"middle",children:[(0,r.jsx)(P.Z.Item,{...a,name:[t,"header"],className:"flex-1",rules:[{required:!0,message:"Header name is required"}],children:(0,r.jsx)(A.default,{size:"large",allowClear:!0,className:"rounded-lg",placeholder:"Header name (e.g., X-API-Key)"})}),(0,r.jsx)(P.Z.Item,{...a,name:[t,"value"],className:"flex-1",rules:[{required:!0,message:"Header value is required"}],children:(0,r.jsx)(A.default,{size:"large",allowClear:!0,className:"rounded-lg",placeholder:"Header value"})}),(0,r.jsx)(eo.Z,{onClick:()=>l(t),className:"text-gray-500 hover:text-red-500 cursor-pointer"})]},s)}),(0,r.jsx)(W.ZP,{type:"dashed",onClick:()=>t(),icon:(0,r.jsx)(ec.Z,{}),block:!0,children:"Add Static Header"})]})}})})]})},"permissions")})};let em=e=>{try{let s=e.indexOf("/mcp/");if(-1===s)return{token:null,baseUrl:e};let t=e.split("/mcp/");if(2!==t.length)return{token:null,baseUrl:e};let r=t[0]+"/mcp/",l=t[1];if(!l)return{token:null,baseUrl:e};return{token:l,baseUrl:r}}catch(s){return console.error("Error parsing MCP URL:",s),{token:null,baseUrl:e}}},ex=e=>{let{token:s,baseUrl:t}=em(e);return s?t+"...":e},eh=e=>{let{token:s}=em(e);return{maskedUrl:ex(e),hasToken:!!s}},ep=e=>e?/^https?:\/\/[^\s/$.?#].[^\s]*$/i.test(e)?Promise.resolve():Promise.reject("Please enter a valid URL (e.g., http://service-name.domain:1234/path or https://example.com)"):Promise.resolve(),eg=e=>e&&(e.includes("-")||e.includes(" "))?Promise.reject("Cannot contain '-' (hyphen) or spaces. Please use '_' (underscore) instead."):Promise.resolve(),ef=e=>{let s=new Uint8Array(e),t="";return s.forEach(e=>t+=String.fromCharCode(e)),btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},ev=()=>{let e=new Uint8Array(32);return window.crypto.getRandomValues(e),ef(e.buffer)},ej=async e=>{let s=new TextEncoder().encode(e);return ef(await window.crypto.subtle.digest("SHA-256",s))},eb=e=>{let{accessToken:s,getCredentials:t,getTemporaryPayload:r,onTokenReceived:l,onBeforeRedirect:a}=e,[n,i]=(0,j.useState)("idle"),[o,c]=(0,j.useState)(null),[d,u]=(0,j.useState)(null),m=(0,j.useRef)(!1),x="litellm-mcp-oauth-flow-state",h="litellm-mcp-oauth-result",p="litellm-mcp-oauth-return-url",g=(e,s)=>{try{window.sessionStorage.setItem(e,s),window.localStorage.setItem(e,s)}catch(s){console.warn("Failed to set storage item ".concat(e),s)}},f=e=>{try{return window.sessionStorage.getItem(e)||window.localStorage.getItem(e)}catch(s){return console.warn("Failed to get storage item ".concat(e),s),null}},v=()=>{try{window.sessionStorage.removeItem(x),window.sessionStorage.removeItem(h),window.sessionStorage.removeItem(p),window.localStorage.removeItem(x),window.localStorage.removeItem(h),window.localStorage.removeItem(p)}catch(e){console.warn("Failed to clear OAuth storage",e)}},b=()=>{{let e=window.location.pathname||"",s=e.indexOf("/ui"),t=(s>=0?e.slice(0,s+3):"").replace(/\/+$/,"");return"".concat(window.location.origin).concat(t,"/mcp/oauth/callback")}},y=()=>b(),N=(0,j.useCallback)(async()=>{let e=t()||{};if(!s){c("Missing admin token"),Z.ZP.error("Access token missing. Please re-authenticate and try again.");return}let l=r();if(!l||!l.url||!l.transport){let e="Please complete server URL and transport before starting OAuth.";c(e),Z.ZP.error(e);return}try{var n,o,d;i("authorizing"),c(null);let t=await (0,_.cacheTemporaryMcpServer)(s,l),r=null==t?void 0:null===(n=t.server_id)||void 0===n?void 0:n.trim();if(!r)throw Error("Temporary MCP server identifier missing. Please retry.");let u={};if(!((null===(o=l.credentials)||void 0===o?void 0:o.client_id)&&(null===(d=l.credentials)||void 0===d?void 0:d.client_secret))){let e=await (0,_.registerMcpOAuthClient)(s,r,{client_name:l.alias||l.server_name||r,grant_types:["authorization_code","refresh_token"],response_types:["code"],token_endpoint_auth_method:l.credentials&&l.credentials.client_secret?"client_secret_post":"none"});u={clientId:null==e?void 0:e.client_id,clientSecret:null==e?void 0:e.client_secret}}let m=ev(),h=await ej(m),f=crypto.randomUUID(),v=u.clientId||e.client_id,j=Array.isArray(e.scopes)?e.scopes.filter(e=>e&&e.trim().length>0).join(" "):void 0,b=(0,_.buildMcpOAuthAuthorizeUrl)({serverId:r,clientId:v,redirectUri:y(),state:f,codeChallenge:h,scope:j}),N={state:f,codeVerifier:m,clientId:v,clientSecret:u.clientSecret||e.client_secret,serverId:r,redirectUri:y()};if(a)try{a()}catch(e){console.error("Failed to prepare for OAuth redirect",e)}try{g(x,JSON.stringify(N)),g(p,window.location.href)}catch(e){throw Error("Unable to access browser storage for OAuth. Please enable storage and retry.")}window.location.href=b}catch(s){console.error("Failed to start OAuth flow",s),i("error");let e=s instanceof Error?s.message:String(s);c(e),Z.ZP.error(e)}},[s,t,r,a]),w=(0,j.useCallback)(async()=>{if(m.current)return;let e=null,s=null;try{let t=f(h);if(!t)return;m.current=!0,e=JSON.parse(t);let r=f(x);s=r?JSON.parse(r):null}catch(e){v(),m.current=!1,c("Failed to resume OAuth flow. Please retry."),i("error"),Z.ZP.error("Failed to resume OAuth flow. Please retry.");return}if(!e){m.current=!1;return}try{window.sessionStorage.removeItem(h),window.localStorage.removeItem(h)}catch(e){}try{if(!s||!s.state||!s.codeVerifier||!s.serverId)throw Error("OAuth session state was lost. This can happen if you have strict browser privacy settings. Please try again and ensure cookies/storage is enabled.");if(!e.state||e.state!==s.state)throw Error("OAuth state mismatch. Please retry.");if(e.error)throw Error(e.error_description||e.error);if(!e.code)throw Error("Authorization code missing in callback.");i("exchanging");let t=await (0,_.exchangeMcpOAuthToken)({serverId:s.serverId,code:e.code,clientId:s.clientId,clientSecret:s.clientSecret,codeVerifier:s.codeVerifier,redirectUri:s.redirectUri});l(t),u(t),i("success"),c(null),Z.ZP.success("OAuth token retrieved successfully")}catch(s){let e=s instanceof Error?s.message:String(s);c(e),i("error"),Z.ZP.error(e)}finally{v(),setTimeout(()=>{m.current=!1},1e3)}},[l]);return(0,j.useEffect)(()=>{w()},[w]),{startOAuthFlow:N,status:n,error:o,tokenResponse:d}},ey="".concat("../ui/assets/logos/","mcp_logo.png"),eN=[M.API_KEY,M.BEARER_TOKEN,M.BASIC],e_=[...eN,M.OAUTH2],ew="litellm-mcp-oauth-create-state";var eC=e=>{let{userRole:s,accessToken:t,onCreateSuccess:a,isModalVisible:n,setModalVisible:i,availableAccessGroups:o,prefillData:c,onBackToDiscovery:d}=e,[u]=P.Z.useForm(),[m,x]=(0,j.useState)(!1),[h,f]=(0,j.useState)({}),[b,y]=(0,j.useState)({}),[N,w]=(0,j.useState)(null),[C,S]=(0,j.useState)(!1),[k,L]=(0,j.useState)([]),[z,F]=(0,j.useState)([]),[R,U]=(0,j.useState)(""),[V,B]=(0,j.useState)(""),[D,H]=(0,j.useState)(null),K=b.auth_type,Y=!!K&&eN.includes(K),G=K===M.OAUTH2,W=G&&b.oauth_flow_type===O.M2M,{startOAuthFlow:$,status:Q,error:X,tokenResponse:ee}=eb({accessToken:t,getCredentials:()=>u.getFieldValue("credentials"),getTemporaryPayload:()=>{let e=u.getFieldsValue(!0),s=e.url,t=e.transport||R;if(!s||!t)return null;let r=Array.isArray(e.static_headers)?e.static_headers.reduce((e,s)=>{var t,r;let l=null==s?void 0:null===(t=s.header)||void 0===t?void 0:t.trim();return l&&(e[l]=null!==(r=null==s?void 0:s.value)&&void 0!==r?r:""),e},{}):{};return{server_id:void 0,server_name:e.server_name,alias:e.alias,description:e.description,url:s,transport:t,auth_type:M.OAUTH2,credentials:e.credentials,authorization_url:e.authorization_url,token_url:e.token_url,registration_url:e.registration_url,mcp_access_groups:e.mcp_access_groups,static_headers:r,command:e.command,args:e.args,env:e.env}},onTokenReceived:e=>{var s;if(H(null!==(s=null==e?void 0:e.access_token)&&void 0!==s?s:null),null==e?void 0:e.access_token){let s={access_token:e.access_token,...e.refresh_token&&{refresh_token:e.refresh_token},...e.expires_in&&{expires_in:e.expires_in},...e.scope&&{scope:e.scope}};u.setFieldsValue({credentials:s}),Z.ZP.success("OAuth authorization successful! Please click 'Create MCP Server' to save the configuration.")}},onBeforeRedirect:()=>{try{let e=u.getFieldsValue(!0);window.sessionStorage.setItem(ew,JSON.stringify({modalVisible:n,formValues:e,transportType:R,costConfig:h,allowedTools:z,searchValue:V,aliasManuallyEdited:C}))}catch(e){console.warn("Failed to persist MCP create state",e)}}});j.useEffect(()=>{let e=window.sessionStorage.getItem(ew);if(e)try{var s;let t=JSON.parse(e);t.modalVisible&&i(!0);let r=(null===(s=t.formValues)||void 0===s?void 0:s.transport)||t.transportType||"";r&&U(r),t.formValues&&w({values:t.formValues,transport:r}),t.costConfig&&f(t.costConfig),t.allowedTools&&F(t.allowedTools),t.searchValue&&B(t.searchValue),"boolean"==typeof t.aliasManuallyEdited&&S(t.aliasManuallyEdited)}catch(e){console.error("Failed to restore MCP create state",e)}finally{window.sessionStorage.removeItem(ew)}},[u,i]),j.useEffect(()=>{N&&(R||N.transport,(!N.transport||R)&&(u.setFieldsValue(N.values),y(N.values),w(null)))},[N,u,R]),j.useEffect(()=>{if(!n||!c)return;let e=(c.name||"").replace(/[^a-zA-Z0-9_]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),s=c.transport||"";U(s);let t={server_name:e,alias:e,description:c.description||"",transport:s};if("stdio"===s){let e={};if(c.command&&(e.command=c.command),c.args&&c.args.length>0&&(e.args=c.args),c.env_vars&&c.env_vars.length>0){let s={};for(let e of c.env_vars)s[e.name]=e.description?"<".concat(e.description,">"):"";e.env=s}Object.keys(e).length>0&&(t.stdio_config=JSON.stringify(e,null,2))}else c.url&&(t.url=c.url);u.setFieldsValue(t),y(t),S(!1)},[n,c,u]);let et=async e=>{x(!0);try{let{static_headers:s,stdio_config:r,credentials:l,allow_all_keys:n,available_on_public_internet:o,...c}=e,d=c.mcp_access_groups,m=Array.isArray(s)?s.reduce((e,s)=>{var t,r;let l=null==s?void 0:null===(t=s.header)||void 0===t?void 0:t.trim();return l&&(e[l]=null!==(r=null==s?void 0:s.value)&&void 0!==r?r:""),e},{}):{},x=l&&"object"==typeof l?Object.entries(l).reduce((e,s)=>{let[t,r]=s;if(null==r||""===r)return e;if("scopes"===t){if(Array.isArray(r)){let s=r.filter(e=>null!=e&&""!==e);s.length>0&&(e[t]=s)}}else e[t]=r;return e},{}):void 0,p={};if(r&&"stdio"===R)try{let e=JSON.parse(r),s=e;if(e.mcpServers&&"object"==typeof e.mcpServers){let t=Object.keys(e.mcpServers);if(t.length>0){let r=t[0];s=e.mcpServers[r],c.server_name||(c.server_name=r.replace(/-/g,"_"))}}p={command:s.command,args:s.args,env:s.env},console.log("Parsed stdio config:",p)}catch(e){Z.ZP.fromBackend("Invalid JSON in stdio configuration");return}c.transport===E.OPENAPI&&(c.transport="http");let g={...c,...p,stdio_config:void 0,mcp_info:{server_name:c.server_name||c.url,description:c.description,mcp_server_cost_info:Object.keys(h).length>0?h:null},mcp_access_groups:d,alias:c.alias,allowed_tools:z.length>0?z:null,allow_all_keys:!!n,available_on_public_internet:!!o,static_headers:m};if(g.static_headers=m,c.auth_type&&e_.includes(c.auth_type)&&x&&Object.keys(x).length>0&&(g.credentials=x),console.log("Payload: ".concat(JSON.stringify(g))),null!=t){let e=await (0,_.createMCPServer)(t,g);Z.ZP.success("MCP Server created successfully"),u.resetFields(),f({}),L([]),F([]),S(!1),i(!1),a(e)}}catch(e){Z.ZP.fromBackend("Error creating MCP Server: "+e)}finally{x(!1)}},er=()=>{u.resetFields(),f({}),L([]),F([]),S(!1),i(!1)};return(j.useEffect(()=>{if(!C&&b.server_name){let e=b.server_name.replace(/\s+/g,"_");u.setFieldsValue({alias:e}),y(s=>({...s,alias:e}))}},[b.server_name]),j.useEffect(()=>{n||y({})},[n]),(0,l.tY)(s))?(0,r.jsx)(g.Z,{title:(0,r.jsxs)("div",{className:"flex items-center pb-4 border-b border-gray-100",style:{gap:12},children:[d&&(0,r.jsx)("button",{onClick:d,className:"text-sm text-blue-600 hover:text-blue-800 cursor-pointer bg-transparent border-none",style:{flexShrink:0},children:"←"}),(0,r.jsx)("img",{src:ey,alt:"MCP Logo",className:"w-8 h-8 object-contain",style:{height:"20px",width:"20px",objectFit:"contain"}}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New MCP Server"})]}),open:n,width:1e3,onCancel:er,footer:null,className:"top-8",styles:{body:{padding:"24px"},header:{padding:"24px 24px 0 24px",border:"none"}},children:(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsxs)(P.Z,{form:u,onFinish:et,onValuesChange:(e,s)=>y(s),layout:"vertical",className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["MCP Server Name",(0,r.jsx)(v.Z,{title:"Best practice: Use a descriptive name that indicates the server's purpose (e.g., 'GitHub_MCP', 'Email_Service'). Cannot contain spaces or hyphens; use underscores instead. Names must comply with SEP-986 and will be rejected if invalid (https://modelcontextprotocol.io/specification/2025-11-25/server/tools#tool-names).",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"server_name",rules:[{required:!1,message:"Please enter a server name"},{validator:(e,s)=>eg(s)}],children:(0,r.jsx)(T.o,{placeholder:"e.g., GitHub_MCP, Zapier_MCP, etc.",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Alias",(0,r.jsx)(v.Z,{title:"A short, unique identifier for this server. Defaults to the server name if not provided. Cannot contain spaces or hyphens; use underscores instead.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"alias",rules:[{required:!1},{validator:(e,s)=>eg(s)}],children:(0,r.jsx)(T.o,{placeholder:"e.g., GitHub_MCP, Zapier_MCP, etc.",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",onChange:()=>S(!0)})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Description"}),name:"description",rules:[{required:!1,message:"Please enter a server description"}],children:(0,r.jsx)(T.o,{placeholder:"Brief description of what this server does",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Transport Type"}),name:"transport",rules:[{required:!0,message:"Please select a transport type"}],children:(0,r.jsxs)(p.default,{placeholder:"Select transport",className:"rounded-lg",size:"large",onChange:e=>{U(e),"stdio"===e?u.setFieldsValue({url:void 0,spec_path:void 0,auth_type:void 0,credentials:void 0}):e===E.OPENAPI?u.setFieldsValue({url:void 0,command:void 0,args:void 0,env:void 0}):u.setFieldsValue({spec_path:void 0,command:void 0,args:void 0,env:void 0})},value:R,children:[(0,r.jsx)(p.default.Option,{value:"http",children:"Streamable HTTP (Recommended)"}),(0,r.jsx)(p.default.Option,{value:"sse",children:"Server-Sent Events (SSE)"}),(0,r.jsx)(p.default.Option,{value:"stdio",children:"Standard Input/Output (stdio)"}),(0,r.jsx)(p.default.Option,{value:E.OPENAPI,children:"OpenAPI Spec"})]})}),("http"===R||"sse"===R)&&(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"MCP Server URL"}),name:"url",rules:[{required:!0,message:"Please enter a server URL"},{validator:(e,s)=>ep(s)}],children:(0,r.jsx)(A.default,{placeholder:"https://your-mcp-server.com",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),R===E.OPENAPI&&(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["OpenAPI Spec URL",(0,r.jsx)(v.Z,{title:"URL to an OpenAPI specification (JSON or YAML). MCP tools will be automatically generated from the API endpoints defined in the spec.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"spec_path",rules:[{required:!0,message:"Please enter an OpenAPI spec URL"}],children:(0,r.jsx)(A.default,{placeholder:"https://petstore3.swagger.io/api/v3/openapi.json",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),"stdio"!==R&&""!==R&&(0,r.jsx)(P.Z.Item,{label:(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Authentication"}),name:"auth_type",rules:[{required:!0,message:"Please select an auth type"}],children:(0,r.jsxs)(p.default,{placeholder:"Select auth type",className:"rounded-lg",size:"large",children:[(0,r.jsx)(p.default.Option,{value:"none",children:"None"}),(0,r.jsx)(p.default.Option,{value:"api_key",children:"API Key"}),(0,r.jsx)(p.default.Option,{value:"bearer_token",children:"Bearer Token"}),(0,r.jsx)(p.default.Option,{value:"basic",children:"Basic Auth"}),(0,r.jsx)(p.default.Option,{value:"oauth2",children:"OAuth"})]})}),"stdio"!==R&&""!==R&&Y&&(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Authentication Value",(0,r.jsx)(v.Z,{title:"Token, password, or header value to send with each request for the selected auth type.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:["credentials","auth_value"],rules:[{required:!0,message:"Please enter the authentication value"}],children:(0,r.jsx)(T.o,{type:"password",placeholder:"Enter token or secret",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),"stdio"!==R&&""!==R&&G&&(0,r.jsx)(q,{isM2M:W,initialFlowType:O.INTERACTIVE,oauthFlow:{startOAuthFlow:$,status:Q,error:X,tokenResponse:ee}}),(0,r.jsx)(ea,{isVisible:"stdio"===R})]}),(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)(eu,{availableAccessGroups:o,mcpServer:null,searchValue:V,setSearchValue:B,getAccessGroupOptions:()=>{let e=o.map(e=>({value:e,label:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:e})]})}));return V&&!o.some(e=>e.toLowerCase().includes(V.toLowerCase()))&&e.push({value:V,label:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:V}),(0,r.jsx)("span",{className:"text-gray-400 text-xs ml-1",children:"create new group"})]})}),e}})}),(0,r.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,r.jsx)(es,{accessToken:t,oauthAccessToken:D,formValues:b,onToolsLoaded:L})}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(el,{accessToken:t,oauthAccessToken:D,formValues:b,allowedTools:z,existingAllowedTools:null,onAllowedToolsChange:F})}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(J,{value:h,onChange:f,tools:k.filter(e=>z.includes(e.name)),disabled:!1})}),(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-100",children:[(0,r.jsx)(T.z,{variant:"secondary",onClick:er,children:"Cancel"}),(0,r.jsx)(T.z,{variant:"primary",loading:m,children:m?"Creating...":"Add MCP Server"})]})]})})}):null},eS=t(5945),eZ=t(64935),ek=t(30401),eP=t(78867),eA=t(11239),eI=t(54001),eT=t(96137),eM=t(96362),eO=t(80221),eE=t(29202),eL=t(59872);let{Title:ez,Text:eF}=h.default,{Panel:eR}=V.default,eq=e=>{let{icon:s,title:t,description:l,children:a,serverName:n,accessGroups:i=["dev-group"]}=e,[o,c]=(0,j.useState)(!1),d=()=>{let e={"x-litellm-api-key":"Bearer YOUR_LITELLM_API_KEY"};if(o&&n){let s=[n.replace(/\s+/g,"_"),...i].join(",");e["x-mcp-servers"]=s}return e};return(0,r.jsxs)(eS.Z,{className:"border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("span",{className:"p-2 rounded-lg bg-gray-50",children:s}),(0,r.jsxs)("div",{children:[(0,r.jsx)(ez,{level:5,className:"mb-0",children:t}),(0,r.jsx)(eF,{className:"text-gray-600",children:l})]})]}),n&&("Implementation Example"===t||"Configuration"===t)&&(0,r.jsxs)(P.Z.Item,{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(en.Z,{size:"small",checked:o,onChange:c}),(0,r.jsxs)(eF,{className:"text-sm",children:["Limit tools to specific MCP servers or MCP groups by passing the ",(0,r.jsx)("code",{children:"x-mcp-servers"})," header"]})]}),o&&(0,r.jsx)(G.Z,{className:"mt-2",type:"info",showIcon:!0,message:"Two Options",description:(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Option 1:"})," Get a specific server: ",(0,r.jsxs)("code",{children:['"',n.replace(/\s+/g,"_"),'"']})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Option 2:"})," Get a group of MCPs: ",(0,r.jsx)("code",{children:'"dev-group"'})]}),(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["You can also mix both: ",(0,r.jsx)("code",{children:'"Server1,dev-group"'})]})]})})]}),j.Children.map(a,e=>{if(j.isValidElement(e)&&e.props.hasOwnProperty("code")&&e.props.hasOwnProperty("copyKey")){let s=e.props.code;if(s&&s.includes('"headers":'))return j.cloneElement(e,{code:s.replace(/"headers":\s*{[^}]*}/,'"headers": '.concat(JSON.stringify(d(),null,8)))})}return e})]})};var eU=e=>{let{currentServerAccessGroups:s=[]}=e,t=(0,_.getProxyBaseUrl)(),[l,a]=(0,j.useState)({}),[n,h]=(0,j.useState)({openai:[],litellm:[],cursor:[],http:[]}),[p]=(0,j.useState)("Zapier_MCP"),g=async(e,s)=>{await (0,eL.vQ)(e)&&(a(e=>({...e,[s]:!0})),setTimeout(()=>{a(e=>({...e,[s]:!1}))},2e3))},f=e=>{let{code:s,copyKey:t,title:a,className:n=""}=e;return(0,r.jsxs)("div",{className:"relative group",children:[a&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(eZ.Z,{size:16,className:"text-blue-600"}),(0,r.jsx)(eF,{strong:!0,className:"text-gray-700",children:a})]}),(0,r.jsxs)(eS.Z,{className:"bg-gray-50 border border-gray-200 relative ".concat(n),children:[(0,r.jsx)(W.ZP,{type:"text",size:"small",icon:l[t]?(0,r.jsx)(ek.Z,{size:12}):(0,r.jsx)(eP.Z,{size:12}),onClick:()=>g(s,t),className:"absolute top-2 right-2 z-10 transition-all duration-200 ".concat(l[t]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")}),(0,r.jsx)("pre",{className:"text-sm overflow-x-auto pr-10 text-gray-800 font-mono leading-relaxed",children:s})]})]})},v=e=>{let{step:s,title:t,children:l}=e;return(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:s})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(eF,{strong:!0,className:"text-gray-800 block mb-2",children:t}),l]})]})};return(0,r.jsx)("div",{children:(0,r.jsxs)(ei.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(x.Z,{className:"text-3xl font-bold text-gray-900 mb-3",children:"Connect to your MCP client"}),(0,r.jsx)(m.Z,{className:"text-lg text-gray-600",children:"Use tools directly from any MCP client with LiteLLM MCP. Enable your AI assistant to perform real-world tasks through a simple, secure connection."})]}),(0,r.jsxs)(o.Z,{className:"w-full",children:[(0,r.jsx)(c.Z,{className:"flex justify-start mt-8 mb-6",children:(0,r.jsxs)("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[(0,r.jsx)(i.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,r.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,r.jsx)(eZ.Z,{size:18}),"OpenAI API"]})}),(0,r.jsx)(i.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,r.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,r.jsx)(eA.Z,{size:18}),"LiteLLM Proxy"]})}),(0,r.jsx)(i.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,r.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,r.jsx)(eO.Z,{size:18}),"Cursor"]})}),(0,r.jsx)(i.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,r.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,r.jsx)(eE.Z,{size:18}),"Streamable HTTP"]})})]})}),(0,r.jsxs)(u.Z,{children:[(0,r.jsx)(d.Z,{className:"mt-6",children:(0,r.jsx)(()=>(0,r.jsxs)(ei.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-100",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)(eZ.Z,{className:"text-blue-600",size:24}),(0,r.jsx)(ez,{level:4,className:"mb-0 text-blue-900",children:"OpenAI Responses API Integration"})]}),(0,r.jsx)(eF,{className:"text-blue-700",children:"Connect OpenAI Responses API to your LiteLLM MCP server for seamless tool integration"})]}),(0,r.jsxs)(ei.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,r.jsx)(eq,{icon:(0,r.jsx)(eI.Z,{className:"text-blue-600",size:16}),title:"API Key Setup",description:"Configure your OpenAI API key for authentication",children:(0,r.jsxs)(ei.Z,{direction:"vertical",size:"middle",className:"w-full",children:[(0,r.jsx)("div",{children:(0,r.jsxs)(eF,{children:["Get your API key from the"," ",(0,r.jsxs)("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["OpenAI platform ",(0,r.jsx)(eM.Z,{size:12})]})]})}),(0,r.jsx)(f,{title:"Environment Variable",code:'export OPENAI_API_KEY="sk-..."',copyKey:"openai-env"})]})}),(0,r.jsx)(eq,{icon:(0,r.jsx)(eT.Z,{className:"text-blue-600",size:16}),title:"MCP Server Information",description:"Connection details for your LiteLLM MCP server",children:(0,r.jsx)(f,{title:"Server URL",code:"".concat(t,"/mcp"),copyKey:"openai-server-url"})}),(0,r.jsx)(eq,{icon:(0,r.jsx)(eZ.Z,{className:"text-blue-600",size:16}),title:"Implementation Example",description:"Complete cURL example for using the Responses API",serverName:"Zapier Gmail",accessGroups:["dev-group"],children:(0,r.jsx)(f,{code:'curl --location \'https://api.openai.com/v1/responses\' \\\n--header \'Content-Type: application/json\' \\\n--header "Authorization: Bearer $OPENAI_API_KEY" \\\n--data \'{\n    "model": "gpt-4.1",\n    "tools": [\n        {\n            "type": "mcp",\n            "server_label": "litellm",\n            "server_url": "'.concat(t,'/mcp",\n            "require_approval": "never",\n            "headers": {\n                "x-litellm-api-key": "Bearer YOUR_LITELLM_API_KEY",\n                "x-mcp-servers": "Zapier_MCP,dev-group"\n            }\n        }\n    ],\n    "input": "Run available tools",\n    "tool_choice": "required"\n}\''),copyKey:"openai-curl",className:"text-xs"})})]})]}),{})}),(0,r.jsx)(d.Z,{className:"mt-6",children:(0,r.jsx)(()=>(0,r.jsxs)(ei.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-emerald-50 to-green-50 p-6 rounded-lg border border-emerald-100",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)(eA.Z,{className:"text-emerald-600",size:24}),(0,r.jsx)(ez,{level:4,className:"mb-0 text-emerald-900",children:"LiteLLM Proxy API Integration"})]}),(0,r.jsx)(eF,{className:"text-emerald-700",children:"Connect to LiteLLM Proxy Responses API for seamless tool integration with multiple model providers"})]}),(0,r.jsxs)(ei.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,r.jsx)(eq,{icon:(0,r.jsx)(eI.Z,{className:"text-emerald-600",size:16}),title:"Virtual Key Setup",description:"Configure your LiteLLM Proxy Virtual Key for authentication",children:(0,r.jsxs)(ei.Z,{direction:"vertical",size:"middle",className:"w-full",children:[(0,r.jsx)("div",{children:(0,r.jsx)(eF,{children:"Get your Virtual Key from your LiteLLM Proxy dashboard or contact your administrator"})}),(0,r.jsx)(f,{title:"Environment Variable",code:'export LITELLM_API_KEY="sk-..."',copyKey:"litellm-env"})]})}),(0,r.jsx)(eq,{icon:(0,r.jsx)(eT.Z,{className:"text-emerald-600",size:16}),title:"MCP Server Information",description:"Connection details for your LiteLLM MCP server",children:(0,r.jsx)(f,{title:"Server URL",code:"".concat(t,"/mcp"),copyKey:"litellm-server-url"})}),(0,r.jsx)(eq,{icon:(0,r.jsx)(eZ.Z,{className:"text-emerald-600",size:16}),title:"Implementation Example",description:"Complete cURL example for using the LiteLLM Proxy Responses API",serverName:p,accessGroups:["dev-group"],children:(0,r.jsx)(f,{code:"curl --location '".concat(t,'/v1/responses\' \\\n--header \'Content-Type: application/json\' \\\n--header "Authorization: Bearer $LITELLM_VIRTUAL_KEY" \\\n--data \'{\n    "model": "gpt-4",\n    "tools": [\n        {\n            "type": "mcp",\n            "server_label": "litellm",\n            "server_url": "').concat(t,'/mcp",\n            "require_approval": "never",\n            "headers": {\n                "x-litellm-api-key": "Bearer YOUR_LITELLM_VIRTUAL_KEY",\n                "x-mcp-servers": "Zapier_MCP,dev-group"\n            }\n        }\n    ],\n    "input": "Run available tools",\n    "tool_choice": "required"\n}\''),copyKey:"litellm-curl",className:"text-xs"})})]})]}),{})}),(0,r.jsx)(d.Z,{className:"mt-6",children:(0,r.jsx)(()=>(0,r.jsxs)(ei.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-lg border border-purple-100",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)(eO.Z,{className:"text-purple-600",size:24}),(0,r.jsx)(ez,{level:4,className:"mb-0 text-purple-900",children:"Cursor IDE Integration"})]}),(0,r.jsx)(eF,{className:"text-purple-700",children:"Use tools directly from Cursor IDE with LiteLLM MCP. Enable your AI assistant to perform real-world tasks without leaving your coding environment."})]}),(0,r.jsxs)(eS.Z,{className:"border border-gray-200",children:[(0,r.jsx)(ez,{level:5,className:"mb-4 text-gray-800",children:"Setup Instructions"}),(0,r.jsxs)(ei.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,r.jsx)(v,{step:1,title:"Open Cursor Settings",children:(0,r.jsxs)(eF,{className:"text-gray-600",children:["Use the keyboard shortcut ",(0,r.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"⇧+⌘+J"})," (Mac) or"," ",(0,r.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Ctrl+Shift+J"})," (Windows/Linux)"]})}),(0,r.jsx)(v,{step:2,title:"Navigate to MCP Tools",children:(0,r.jsx)(eF,{className:"text-gray-600",children:'Go to the "MCP Tools" tab and click "New MCP Server"'})}),(0,r.jsxs)(v,{step:3,title:"Add Configuration",children:[(0,r.jsxs)(eF,{className:"text-gray-600 mb-3",children:["Copy the JSON configuration below and paste it into Cursor, then save with"," ",(0,r.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Cmd+S"})," or"," ",(0,r.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Ctrl+S"})]}),(0,r.jsx)(eq,{icon:(0,r.jsx)(eZ.Z,{className:"text-purple-600",size:16}),title:"Configuration",description:"Cursor MCP configuration",serverName:"Zapier Gmail",accessGroups:["dev-group"],children:(0,r.jsx)(f,{code:'{\n  "mcpServers": {\n    "Zapier_MCP": {\n      "url": "'.concat(t,'/mcp",\n      "headers": {\n        "x-litellm-api-key": "Bearer YOUR_LITELLM_API_KEY",\n        "x-mcp-servers": "Zapier_MCP,dev-group"\n      }\n    }\n  }\n}'),copyKey:"cursor-config",className:"text-xs"})})]})]})]})]}),{})}),(0,r.jsx)(d.Z,{className:"mt-6",children:(0,r.jsx)(()=>(0,r.jsxs)(ei.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-teal-50 p-6 rounded-lg border border-green-100",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)(eE.Z,{className:"text-green-600",size:24}),(0,r.jsx)(ez,{level:4,className:"mb-0 text-green-900",children:"Streamable HTTP Transport"})]}),(0,r.jsx)(eF,{className:"text-green-700",children:"Connect to LiteLLM MCP using HTTP transport. Compatible with any MCP client that supports HTTP streaming."})]}),(0,r.jsx)(eq,{icon:(0,r.jsx)(eE.Z,{className:"text-green-600",size:16}),title:"Universal MCP Connection",description:"Use this URL with any MCP client that supports HTTP transport",children:(0,r.jsxs)(ei.Z,{direction:"vertical",size:"middle",className:"w-full",children:[(0,r.jsx)("div",{children:(0,r.jsx)(eF,{children:"Each MCP client supports different transports. Refer to your client documentation to determine the appropriate transport method."})}),(0,r.jsx)(f,{title:"Server URL",code:"".concat(t,"/mcp"),copyKey:"http-server-url"}),(0,r.jsx)(f,{title:"Headers Configuration",code:JSON.stringify({"x-litellm-api-key":"Bearer YOUR_LITELLM_API_KEY"},null,2),copyKey:"http-headers"}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(W.ZP,{type:"link",className:"p-0 h-auto text-blue-600 hover:text-blue-700",href:"https://modelcontextprotocol.io/docs/concepts/transports",icon:(0,r.jsx)(eM.Z,{size:14}),children:"Learn more about MCP transports"})})]})})]}),{})})]})]})]})})},eV=t(58927),eB=t(53410),eD=t(74998);let eH=(e,s,t,l,a)=>[{accessorKey:"server_id",header:"Server ID",cell:e=>{let{row:t}=e;return(0,r.jsxs)("button",{onClick:()=>s(t.original.server_id),className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left w-full truncate whitespace-nowrap cursor-pointer max-w-[15ch]",children:[t.original.server_id.slice(0,7),"..."]})}},{accessorKey:"server_name",header:"Name"},{accessorKey:"alias",header:"Alias"},{id:"url",header:"URL",cell:e=>{let{row:s}=e,t=s.original.url;if(!t)return(0,r.jsx)("span",{className:"text-gray-400",children:"—"});let{maskedUrl:l}=eh(t);return(0,r.jsx)("span",{className:"font-mono text-sm",children:l})}},{accessorKey:"transport",header:"Transport",cell:e=>{let{row:s}=e,t=s.original.transport||"http",l=s.original.spec_path;return(0,r.jsx)("span",{children:(l&&"stdio"!==t?"OPENAPI":t).toUpperCase()})}},{accessorKey:"auth_type",header:"Auth Type",cell:e=>{let{getValue:s}=e;return(0,r.jsx)("span",{children:s()||"none"})}},{id:"health_status",header:"Health Status",cell:e=>{let{row:s}=e,t=s.original,l=t.status||"unknown",n=t.last_health_check,i=t.health_check_error;if(a)return(0,r.jsxs)("div",{className:"flex items-center text-gray-500",children:[(0,r.jsxs)("svg",{className:"animate-spin h-4 w-4 mr-1",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("span",{className:"text-xs",children:"Loading..."})]});let o=(0,r.jsxs)("div",{className:"max-w-xs",children:[(0,r.jsxs)("div",{className:"font-semibold mb-1",children:["Health Status: ",l]}),n&&(0,r.jsxs)("div",{className:"text-xs mb-1",children:["Last Check: ",new Date(n).toLocaleString()]}),i&&(0,r.jsxs)("div",{className:"text-xs",children:[(0,r.jsx)("div",{className:"font-medium text-red-400 mb-1",children:"Error:"}),(0,r.jsx)("div",{className:"break-words",children:i})]}),!n&&!i&&(0,r.jsx)("div",{className:"text-xs text-gray-400",children:"No health check data available"})]});return(0,r.jsx)(v.Z,{title:o,placement:"top",children:(0,r.jsxs)("button",{className:"font-mono text-xs font-normal px-2 py-0.5 text-left w-full truncate whitespace-nowrap cursor-pointer max-w-[10ch] ".concat((e=>{switch(e){case"healthy":return"text-green-500 bg-green-50 hover:bg-green-100";case"unhealthy":return"text-red-500 bg-red-50 hover:bg-red-100";default:return"text-gray-500 bg-gray-50 hover:bg-gray-100"}})(l)),children:[(0,r.jsx)("span",{className:"mr-1",children:"●"}),l.charAt(0).toUpperCase()+l.slice(1)]})})}},{id:"mcp_access_groups",header:"Access Groups",cell:e=>{let{row:s}=e,t=s.original.mcp_access_groups;if(Array.isArray(t)&&t.length>0&&"string"==typeof t[0]){let e=t.join(", ");return(0,r.jsx)(v.Z,{title:e,children:(0,r.jsx)("span",{className:"max-w-[200px] truncate block",children:e.length>30?"".concat(e.slice(0,30),"..."):e})})}return(0,r.jsx)("span",{className:"text-gray-400 italic",children:"None"})}},{id:"available_on_public_internet",header:"Network Access",cell:e=>{let{row:s}=e;return s.original.available_on_public_internet?(0,r.jsx)("span",{className:"px-2 py-0.5 bg-green-50 text-green-700 rounded text-xs font-medium",children:"Public"}):(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded text-xs font-medium",children:"Internal"})}},{header:"Created At",accessorKey:"created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,r.jsx)("span",{className:"text-xs",children:t.created_at?new Date(t.created_at).toLocaleDateString():"-"})}},{header:"Updated At",accessorKey:"updated_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,r.jsx)("span",{className:"text-xs",children:t.updated_at?new Date(t.updated_at).toLocaleDateString():"-"})}},{id:"actions",header:"Actions",cell:e=>{let{row:s}=e;return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(v.Z,{title:"Edit MCP Server",children:(0,r.jsx)(eV.J,{icon:eB.Z,size:"sm",onClick:()=>t(s.original.server_id),className:"cursor-pointer hover:text-blue-600"})}),(0,r.jsx)(v.Z,{title:"Delete MCP Server",children:(0,r.jsx)(eV.J,{icon:eD.Z,size:"sm",onClick:()=>l(s.original.server_id),className:"cursor-pointer hover:text-red-600"})})]})}}];var eK=t(10900),eJ=t(82376),eY=t(71437),eG=t(12514),eW=t(67101),e$=t(47323),eQ=t(71618);let eX=[M.API_KEY,M.BEARER_TOKEN,M.BASIC],e0=[...eX,M.OAUTH2],e2="litellm-mcp-oauth-edit-state";var e1=e=>{var s;let{mcpServer:t,accessToken:l,onCancel:a,onSuccess:n,availableAccessGroups:i}=e,[o]=P.Z.useForm(),[c,d]=(0,j.useState)({}),[u,m]=(0,j.useState)([]),[x,h]=(0,j.useState)(!1),[g,f]=(0,j.useState)(""),[b,y]=(0,j.useState)(!1),[N,w]=(0,j.useState)([]),[C,S]=(0,j.useState)(null),k=P.Z.useWatch("auth_type",o),T=P.Z.useWatch("transport",o),L="stdio"===T,z=T===E.OPENAPI,F=!!k&&eX.includes(k),R=k===M.OAUTH2;P.Z.useWatch("oauth_flow_type",o),R&&O.M2M;let[q,U]=(0,j.useState)(null),{startOAuthFlow:V,status:B,error:D,tokenResponse:H}=eb({accessToken:l,getCredentials:()=>o.getFieldValue("credentials"),getTemporaryPayload:()=>{let e=o.getFieldsValue(!0),s=e.url||t.url,r=e.transport||t.transport;if(!s||!r)return null;let l=Array.isArray(e.static_headers)?e.static_headers.reduce((e,s)=>{var t,r;let l=null==s?void 0:null===(t=s.header)||void 0===t?void 0:t.trim();return l&&(e[l]=null!==(r=null==s?void 0:s.value)&&void 0!==r?r:""),e},{}):{};return{server_id:t.server_id,server_name:e.server_name||t.server_name||t.alias,alias:e.alias||t.alias,description:e.description||t.description,url:s,transport:r,auth_type:M.OAUTH2,credentials:e.credentials,mcp_access_groups:e.mcp_access_groups||t.mcp_access_groups,static_headers:l,command:e.command,args:e.args,env:e.env}},onTokenReceived:e=>{var s;if(U(null!==(s=null==e?void 0:e.access_token)&&void 0!==s?s:null),null==e?void 0:e.access_token){let s={access_token:e.access_token,...e.refresh_token&&{refresh_token:e.refresh_token},...e.expires_in&&{expires_in:e.expires_in},...e.scope&&{scope:e.scope}};o.setFieldsValue({credentials:s}),Z.ZP.success("OAuth authorization successful! Please click 'Update MCP Server' to save the credentials.")}},onBeforeRedirect:()=>{try{let e=o.getFieldsValue(!0);window.sessionStorage.setItem(e2,JSON.stringify({serverId:t.server_id,formValues:e,costConfig:c,allowedTools:N,searchValue:g,aliasManuallyEdited:b}))}catch(e){console.warn("Failed to persist MCP edit state",e)}}}),K=j.useMemo(()=>t.static_headers?Object.entries(t.static_headers).map(e=>{let[s,t]=e;return{header:s,value:null!=t?String(t):""}}):[],[t.static_headers]),Y=j.useMemo(()=>{var e;let s=null!==(e=t.env)&&void 0!==e?e:void 0;if(!s||0===Object.keys(s).length)return"";try{return JSON.stringify(s,null,2)}catch(e){return""}},[t.env]),G=j.useMemo(()=>t.spec_path&&"stdio"!==t.transport?E.OPENAPI:t.transport,[t]),$=j.useMemo(()=>({...t,transport:G,static_headers:K,oauth_flow_type:t.token_url?O.M2M:O.INTERACTIVE}),[t,G,K,Y]);(0,j.useEffect)(()=>{var e;(null===(e=t.mcp_info)||void 0===e?void 0:e.mcp_server_cost_info)&&d(t.mcp_info.mcp_server_cost_info)},[t]),(0,j.useEffect)(()=>{t.allowed_tools&&w(t.allowed_tools)},[t]),(0,j.useEffect)(()=>{let e=window.sessionStorage.getItem(e2);if(e)try{let s=JSON.parse(e);if(!s||s.serverId!==t.server_id)return;s.formValues&&S({...t,...s.formValues}),s.costConfig&&d(s.costConfig),s.allowedTools&&w(s.allowedTools),s.searchValue&&f(s.searchValue),"boolean"==typeof s.aliasManuallyEdited&&y(s.aliasManuallyEdited)}catch(e){console.error("Failed to restore MCP edit state",e)}finally{window.sessionStorage.removeItem(e2)}},[o,t]),(0,j.useEffect)(()=>{if(!C)return;let e=C.transport||t.transport;if(e&&e!==o.getFieldValue("transport")){o.setFieldsValue({transport:e});return}o.setFieldsValue(C),S(null)},[C,o,t.transport]),(0,j.useEffect)(()=>{if(t.mcp_access_groups){let e=t.mcp_access_groups.map(e=>"string"==typeof e?e:e.name||String(e));o.setFieldValue("mcp_access_groups",e)}},[t]),(0,j.useEffect)(()=>{t.server_id&&""!==t.server_id.trim()&&Q()},[t,l,q]);let Q=async()=>{if(!l||"stdio"!==t.transport&&!t.url&&!t.spec_path)return;let e=t.auth_type===M.OAUTH2&&!!t.token_url;if(t.auth_type!==M.OAUTH2||e||q){h(!0);try{let e={server_id:t.server_id,server_name:t.server_name,url:t.url,transport:t.transport,auth_type:t.auth_type,mcp_info:t.mcp_info,authorization_url:t.authorization_url,token_url:t.token_url,registration_url:t.registration_url,command:t.command,args:t.args,env:t.env},s=await (0,_.testMCPToolsListRequest)(l,e,q);s.tools&&!s.error?m(s.tools):(console.error("Failed to fetch tools:",s.message),m([]))}catch(e){console.error("Tools fetch error:",e),m([])}finally{h(!1)}}},X=async e=>{if(l)try{let{static_headers:s,credentials:r,stdio_config:a,env_json:i,command:o,args:d,allow_all_keys:u,available_on_public_internet:m,...x}=e,h=(x.mcp_access_groups||[]).map(e=>"string"==typeof e?e:e.name||String(e)),p=Array.isArray(s)?s.reduce((e,s)=>{var t,r;let l=null==s?void 0:null===(t=s.header)||void 0===t?void 0:t.trim();return l&&(e[l]=null!==(r=null==s?void 0:s.value)&&void 0!==r?r:""),e},{}):{},g=r&&"object"==typeof r?Object.entries(r).reduce((e,s)=>{let[t,r]=s;if(null==r||""===r)return e;if("scopes"===t){if(Array.isArray(r)){let s=r.filter(e=>null!=e&&""!==e);s.length>0&&(e[t]=s)}}else e[t]=r;return e},{}):void 0,f={};if("stdio"===x.transport){if(a)try{let e=JSON.parse(a),s=e;if((null==e?void 0:e.mcpServers)&&"object"==typeof e.mcpServers){let t=Object.keys(e.mcpServers);t.length>0&&(s=e.mcpServers[t[0]])}let t=Array.isArray(null==s?void 0:s.args)?s.args.map(e=>String(e)).filter(e=>""!==e.trim()):[],r=(null==s?void 0:s.env)&&"object"==typeof s.env&&!Array.isArray(s.env)?Object.entries(s.env).reduce((e,s)=>{let[t,r]=s;return null==t||""===String(t).trim()||(e[String(t)]=null==r?"":String(r)),e},{}):{};if(!(f={command:(null==s?void 0:s.command)?String(s.command):void 0,args:t,env:r}).command){Z.ZP.fromBackend("Stdio configuration must include a command");return}}catch(e){Z.ZP.fromBackend("Invalid JSON in stdio configuration");return}else{let e={};if(i)try{let s=JSON.parse(i);s&&"object"==typeof s&&!Array.isArray(s)&&(e=Object.entries(s).reduce((e,s)=>{let[t,r]=s;return null==t||""===String(t).trim()||(e[String(t)]=null==r?"":String(r)),e},{}))}catch(e){Z.ZP.fromBackend("Invalid JSON in stdio env configuration");return}let s=Array.isArray(d)?d.map(e=>String(e)).filter(e=>""!==e.trim()):[],t=o?String(o).trim():"";if(!t){Z.ZP.fromBackend("Stdio transport requires a command");return}f={command:t,args:s,env:e}}}x.transport===E.OPENAPI&&(x.transport="http");let v=x.server_name||x.url||t.server_name||t.url||x.alias||t.alias||"unknown",j={...x,...f,stdio_config:void 0,env_json:void 0,server_id:t.server_id,mcp_info:{server_name:v,description:x.description,mcp_server_cost_info:Object.keys(c).length>0?c:null},mcp_access_groups:h,alias:x.alias,extra_headers:x.extra_headers||[],allowed_tools:N.length>0?N:null,disallowed_tools:x.disallowed_tools||[],static_headers:p,allow_all_keys:!!(null!=u?u:t.allow_all_keys),available_on_public_internet:!!(null!=m?m:t.available_on_public_internet)};x.auth_type&&e0.includes(x.auth_type)&&g&&Object.keys(g).length>0&&(j.credentials=g);let b=await (0,_.updateMCPServer)(l,j);Z.ZP.success("MCP Server updated successfully"),n(b)}catch(e){Z.ZP.fromBackend("Failed to update MCP Server"+((null==e?void 0:e.message)?": ".concat(e.message):""))}};return(0,r.jsxs)(eQ.v0,{children:[(0,r.jsxs)(eQ.td,{className:"grid w-full grid-cols-2",children:[(0,r.jsx)(eQ.OK,{children:"Server Configuration"}),(0,r.jsx)(eQ.OK,{children:"Cost Configuration"})]}),(0,r.jsxs)(eQ.nP,{className:"mt-6",children:[(0,r.jsx)(eQ.x4,{children:(0,r.jsxs)(P.Z,{form:o,onFinish:X,initialValues:$,layout:"vertical",children:[(0,r.jsx)(P.Z.Item,{label:"MCP Server Name",name:"server_name",rules:[{validator:(e,s)=>eg(s)}],children:(0,r.jsx)(A.default,{className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsx)(P.Z.Item,{label:"Alias",name:"alias",rules:[{validator:(e,s)=>eg(s)}],children:(0,r.jsx)(A.default,{onChange:()=>y(!0),className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsx)(P.Z.Item,{label:"Description",name:"description",children:(0,r.jsx)(A.default,{className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsx)(P.Z.Item,{label:"Transport Type",name:"transport",rules:[{required:!0}],children:(0,r.jsxs)(p.default,{onChange:e=>{"stdio"===e?o.setFieldsValue({url:void 0,spec_path:void 0,auth_type:void 0,credentials:void 0,authorization_url:void 0,token_url:void 0,registration_url:void 0}):e===E.OPENAPI?o.setFieldsValue({url:void 0,command:void 0,args:void 0,env_json:void 0,stdio_config:void 0}):o.setFieldsValue({spec_path:void 0,command:void 0,args:void 0,env_json:void 0,stdio_config:void 0})},children:[(0,r.jsx)(p.default.Option,{value:"http",children:"Streamable HTTP (Recommended)"}),(0,r.jsx)(p.default.Option,{value:"sse",children:"Server-Sent Events (SSE)"}),(0,r.jsx)(p.default.Option,{value:"stdio",children:"Standard Input/Output (stdio)"}),(0,r.jsx)(p.default.Option,{value:E.OPENAPI,children:"OpenAPI Spec"})]})}),!L&&!z&&(0,r.jsx)(P.Z.Item,{label:"MCP Server URL",name:"url",rules:[{required:!0,message:"Please enter a server URL"},{validator:(e,s)=>ep(s)}],children:(0,r.jsx)(A.default,{placeholder:"https://your-mcp-server.com",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),z&&(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["OpenAPI Spec URL",(0,r.jsx)(v.Z,{title:"URL to an OpenAPI specification (JSON or YAML). MCP tools will be automatically generated from the API endpoints defined in the spec.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"spec_path",rules:[{required:!0,message:"Please enter an OpenAPI spec URL"}],children:(0,r.jsx)(A.default,{placeholder:"https://petstore3.swagger.io/api/v3/openapi.json",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),!L&&(0,r.jsx)(P.Z.Item,{label:"Authentication",name:"auth_type",rules:[{required:!0}],children:(0,r.jsxs)(p.default,{children:[(0,r.jsx)(p.default.Option,{value:"none",children:"None"}),(0,r.jsx)(p.default.Option,{value:"api_key",children:"API Key"}),(0,r.jsx)(p.default.Option,{value:"bearer_token",children:"Bearer Token"}),(0,r.jsx)(p.default.Option,{value:"basic",children:"Basic Auth"}),(0,r.jsx)(p.default.Option,{value:"oauth2",children:"OAuth"})]})}),L&&(0,r.jsxs)("div",{className:"rounded-lg border border-gray-200 p-4 space-y-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Configure the stdio transport used to launch the MCP server process. You can either fill in the fields below or paste a JSON configuration."}),(0,r.jsx)(P.Z.Item,{label:"Command",name:"command",rules:[{required:!0,message:"Please enter a command for stdio transport"}],children:(0,r.jsx)(A.default,{placeholder:"e.g., npx",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsx)(P.Z.Item,{label:"Args",name:"args",children:(0,r.jsx)(p.default,{mode:"tags",size:"large",tokenSeparators:[","],placeholder:"Add args (press enter or comma)",className:"rounded-lg"})}),(0,r.jsx)(P.Z.Item,{label:"Environment (JSON object)",name:"env_json",rules:[{validator:(e,s)=>{if(!s)return Promise.resolve();try{let e=JSON.parse(s);if(e&&"object"==typeof e&&!Array.isArray(e))return Promise.resolve();return Promise.reject(Error("Env must be a JSON object"))}catch(e){return Promise.reject(Error("Please enter valid JSON"))}}}],children:(0,r.jsx)(A.default.TextArea,{rows:6,className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500 font-mono text-sm",placeholder:'{\n  "KEY": "value"\n}'})}),(0,r.jsx)(ea,{isVisible:!0,required:!1})]}),!L&&F&&(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Authentication Value",(0,r.jsx)(v.Z,{title:"Token, password, or header value to send with each request for the selected auth type.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:["credentials","auth_value"],rules:[{validator:(e,s)=>s&&"string"==typeof s&&""===s.trim()?Promise.reject(Error("Authentication value cannot be empty")):Promise.resolve()}],children:(0,r.jsx)(A.default.Password,{placeholder:"Enter token or secret (leave blank to keep existing)",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),!L&&R&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["OAuth Client ID (optional)",(0,r.jsx)(v.Z,{title:"Provide only if your MCP server cannot handle dynamic client registration.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:["credentials","client_id"],children:(0,r.jsx)(A.default.Password,{placeholder:"Enter OAuth client ID (leave blank to keep existing)",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["OAuth Client Secret (optional)",(0,r.jsx)(v.Z,{title:"Provide only if your MCP server cannot handle dynamic client registration.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:["credentials","client_secret"],children:(0,r.jsx)(A.default.Password,{placeholder:"Enter OAuth client secret (leave blank to keep existing)",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["OAuth Scopes (optional)",(0,r.jsx)(v.Z,{title:"Add scopes to override the default scope list used for this MCP server.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:["credentials","scopes"],children:(0,r.jsx)(p.default,{mode:"tags",tokenSeparators:[","],placeholder:"Add scopes",className:"rounded-lg",size:"large"})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Authorization URL Override (optional)",(0,r.jsx)(v.Z,{title:"Optional override for the authorization endpoint.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"authorization_url",children:(0,r.jsx)(A.default,{placeholder:"https://example.com/oauth/authorize",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Token URL Override (optional)",(0,r.jsx)(v.Z,{title:"Optional override for the token endpoint.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"token_url",children:(0,r.jsx)(A.default,{placeholder:"https://example.com/oauth/token",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Registration URL Override (optional)",(0,r.jsx)(v.Z,{title:"Optional override for the dynamic client registration endpoint.",children:(0,r.jsx)(I.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"registration_url",children:(0,r.jsx)(A.default,{placeholder:"https://example.com/oauth/register",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,r.jsxs)("div",{className:"rounded-lg border border-dashed border-gray-300 p-4 space-y-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Use OAuth to fetch a fresh access token and temporarily save it in the session as the authentication value."}),(0,r.jsx)(eQ.zx,{variant:"secondary",onClick:V,disabled:"authorizing"===B||"exchanging"===B,children:"authorizing"===B?"Waiting for authorization...":"exchanging"===B?"Exchanging authorization code...":"Authorize & Fetch Token"}),D&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:D}),"success"===B&&(null==H?void 0:H.access_token)&&(0,r.jsxs)("p",{className:"text-sm text-green-600",children:["Token fetched. Expires in ",null!==(s=H.expires_in)&&void 0!==s?s:"?"," seconds."]})]})]}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(eu,{availableAccessGroups:i,mcpServer:t,searchValue:g,setSearchValue:f,getAccessGroupOptions:()=>{let e=i.map(e=>({value:e,label:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:e})]})}));return g&&!i.some(e=>e.toLowerCase().includes(g.toLowerCase()))&&e.push({value:g,label:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:g}),(0,r.jsx)("span",{className:"text-gray-400 text-xs ml-1",children:"create new group"})]})}),e}})}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(el,{accessToken:l,oauthAccessToken:q,formValues:{server_id:t.server_id,server_name:t.server_name,url:t.url,transport:t.transport,auth_type:t.auth_type,mcp_info:t.mcp_info,oauth_flow_type:t.token_url?O.M2M:O.INTERACTIVE},allowedTools:N,existingAllowedTools:t.allowed_tools||null,onAllowedToolsChange:w})}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(W.ZP,{onClick:a,children:"Cancel"}),(0,r.jsx)(eQ.zx,{type:"submit",children:"Save Changes"})]})]})}),(0,r.jsx)(eQ.x4,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(J,{value:c,onChange:d,tools:u,disabled:x}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(W.ZP,{onClick:a,children:"Cancel"}),(0,r.jsx)(eQ.zx,{onClick:()=>o.submit(),children:"Save Changes"})]})]})})]})]})},e4=t(92280),e5=e=>{let{costConfig:s}=e,t=(null==s?void 0:s.default_cost_per_query)!==void 0&&(null==s?void 0:s.default_cost_per_query)!==null,l=(null==s?void 0:s.tool_name_to_cost_per_query)&&Object.keys(s.tool_name_to_cost_per_query).length>0;return t||l?(0,r.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"space-y-4",children:[t&&(null==s?void 0:s.default_cost_per_query)!==void 0&&(null==s?void 0:s.default_cost_per_query)!==null&&(0,r.jsxs)("div",{children:[(0,r.jsx)(e4.x,{className:"font-medium",children:"Default Cost per Query"}),(0,r.jsxs)("div",{className:"text-green-600 font-mono",children:["$",s.default_cost_per_query.toFixed(4)]})]}),l&&(null==s?void 0:s.tool_name_to_cost_per_query)&&(0,r.jsxs)("div",{children:[(0,r.jsx)(e4.x,{className:"font-medium",children:"Tool-Specific Costs"}),(0,r.jsx)("div",{className:"mt-2 space-y-2",children:Object.entries(s.tool_name_to_cost_per_query).map(e=>{let[s,t]=e;return null!=t&&(0,r.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)(e4.x,{className:"font-medium",children:s}),(0,r.jsxs)(e4.x,{className:"text-green-600 font-mono",children:["$",t.toFixed(4)," per query"]})]},s)})})]}),(0,r.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,r.jsx)(e4.x,{className:"text-blue-800 font-medium",children:"Cost Summary:"}),(0,r.jsxs)("div",{className:"mt-2 space-y-1",children:[t&&(null==s?void 0:s.default_cost_per_query)!==void 0&&(null==s?void 0:s.default_cost_per_query)!==null&&(0,r.jsxs)(e4.x,{className:"text-blue-700",children:["• Default cost: $",s.default_cost_per_query.toFixed(4)," per query"]}),l&&(null==s?void 0:s.tool_name_to_cost_per_query)&&(0,r.jsxs)(e4.x,{className:"text-blue-700",children:["• ",Object.keys(s.tool_name_to_cost_per_query).length," tool(s) with custom pricing"]})]})]})]})}):(0,r.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:(0,r.jsx)(e4.x,{className:"text-gray-600",children:"No cost configuration set for this server. Tool calls will be charged at $0.00 per tool call."})})})})};let e6=e=>{var s,t,l,a,h,p,g;let{mcpServer:f,onBack:v,isEditing:b,isProxyAdmin:y,accessToken:N,userRole:_,userID:w,availableAccessGroups:C}=e,[S,Z]=(0,j.useState)(b),[k,P]=(0,j.useState)(!1),[A,I]=(0,j.useState)({}),[T,M]=(0,j.useState)(0),O=null!==(a=f.url)&&void 0!==a?a:"",{maskedUrl:E,hasToken:F}=O?eh(O):{maskedUrl:"—",hasToken:!1},R=(e,s)=>e?F?s?e:E:e:"—",q=async(e,s)=>{await (0,eL.vQ)(e)&&(I(e=>({...e,[s]:!0})),setTimeout(()=>{I(e=>({...e,[s]:!1}))},2e3))};return(0,r.jsxs)("div",{className:"p-4 max-w-full",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(n.Z,{icon:eK.Z,variant:"light",className:"mb-4",onClick:v,children:"Back to All Servers"}),(0,r.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)(x.Z,{children:f.server_name}),(0,r.jsx)(W.ZP,{type:"text",size:"small",icon:A["mcp-server_name"]?(0,r.jsx)(ek.Z,{size:12}):(0,r.jsx)(eP.Z,{size:12}),onClick:()=>q(f.server_name,"mcp-server_name"),className:"left-2 z-10 transition-all duration-200 ".concat(A["mcp-server_name"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")}),f.alias&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"ml-4 text-gray-500",children:"Alias:"}),(0,r.jsx)("span",{className:"ml-1 font-mono text-blue-600",children:f.alias}),(0,r.jsx)(W.ZP,{type:"text",size:"small",icon:A["mcp-alias"]?(0,r.jsx)(ek.Z,{size:12}):(0,r.jsx)(eP.Z,{size:12}),onClick:()=>q(f.alias,"mcp-alias"),className:"left-2 z-10 transition-all duration-200 ".concat(A["mcp-alias"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),(0,r.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)(m.Z,{className:"text-gray-500 font-mono",children:f.server_id}),(0,r.jsx)(W.ZP,{type:"text",size:"small",icon:A["mcp-server-id"]?(0,r.jsx)(ek.Z,{size:12}):(0,r.jsx)(eP.Z,{size:12}),onClick:()=>q(f.server_id,"mcp-server-id"),className:"left-2 z-10 transition-all duration-200 ".concat(A["mcp-server-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]})}),(0,r.jsxs)(o.Z,{index:T,onIndexChange:M,children:[(0,r.jsx)(c.Z,{className:"mb-4",children:[(0,r.jsx)(i.Z,{children:"Overview"},"overview"),(0,r.jsx)(i.Z,{children:"MCP Tools"},"tools"),...y?[(0,r.jsx)(i.Z,{children:"Settings"},"settings")]:[]]}),(0,r.jsxs)(u.Z,{children:[(0,r.jsxs)(d.Z,{children:[(0,r.jsxs)(eW.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,r.jsxs)(eG.Z,{children:[(0,r.jsx)(m.Z,{children:"Transport"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(x.Z,{children:L(null!==(h=f.transport)&&void 0!==h?h:void 0,null!==(p=f.spec_path)&&void 0!==p?p:void 0).toUpperCase()})})]}),(0,r.jsxs)(eG.Z,{children:[(0,r.jsx)(m.Z,{children:"Auth Type"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(m.Z,{children:z(null!==(g=f.auth_type)&&void 0!==g?g:void 0)})})]}),(0,r.jsxs)(eG.Z,{children:[(0,r.jsx)(m.Z,{children:"Host Url"}),(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,r.jsx)(m.Z,{className:"break-all overflow-wrap-anywhere",children:R(f.url,k)}),F&&(0,r.jsx)("button",{onClick:()=>P(!k),className:"p-1 hover:bg-gray-100 rounded",children:(0,r.jsx)(e$.Z,{icon:k?eJ.Z:eY.Z,size:"sm",className:"text-gray-500"})})]})]})]}),(0,r.jsxs)(eG.Z,{className:"mt-2",children:[(0,r.jsx)(x.Z,{children:"Cost Configuration"}),(0,r.jsx)(e5,{costConfig:null===(s=f.mcp_info)||void 0===s?void 0:s.mcp_server_cost_info})]})]}),(0,r.jsx)(d.Z,{children:(0,r.jsx)(sE,{serverId:f.server_id,accessToken:N,auth_type:f.auth_type,userRole:_,userID:w,serverAlias:f.alias,extraHeaders:f.extra_headers})}),(0,r.jsx)(d.Z,{children:(0,r.jsxs)(eG.Z,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(x.Z,{children:"MCP Server Settings"}),S?null:(0,r.jsx)(n.Z,{variant:"light",onClick:()=>Z(!0),children:"Edit Settings"})]}),S?(0,r.jsx)(e1,{mcpServer:f,accessToken:N,onCancel:()=>Z(!1),onSuccess:e=>{Z(!1),v()},availableAccessGroups:C}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Server Name"}),(0,r.jsx)("div",{children:f.server_name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Alias"}),(0,r.jsx)("div",{children:f.alias})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Description"}),(0,r.jsx)("div",{children:f.description})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"URL"}),(0,r.jsxs)("div",{className:"font-mono break-all overflow-wrap-anywhere max-w-full flex items-center gap-2",children:[R(f.url,k),F&&(0,r.jsx)("button",{onClick:()=>P(!k),className:"p-1 hover:bg-gray-100 rounded",children:(0,r.jsx)(e$.Z,{icon:k?eJ.Z:eY.Z,size:"sm",className:"text-gray-500"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Transport"}),(0,r.jsx)("div",{children:L(f.transport,f.spec_path).toUpperCase()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Extra Headers"}),(0,r.jsx)("div",{children:null===(t=f.extra_headers)||void 0===t?void 0:t.join(", ")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Auth Type"}),(0,r.jsx)("div",{children:z(f.auth_type)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Allow All LiteLLM Keys"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[f.allow_all_keys?(0,r.jsx)("span",{className:"px-2 py-1 bg-green-50 text-green-700 rounded-md text-sm",children:"Enabled"}):(0,r.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded-md text-sm",children:"Disabled"}),f.allow_all_keys&&(0,r.jsx)(m.Z,{className:"text-xs text-gray-500",children:"All keys can access this MCP server"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Available on Public Internet"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[f.available_on_public_internet?(0,r.jsx)("span",{className:"px-2 py-1 bg-green-50 text-green-700 rounded-md text-sm",children:"Public"}):(0,r.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded-md text-sm",children:"Internal"}),f.available_on_public_internet&&(0,r.jsx)(m.Z,{className:"text-xs text-gray-500",children:"Accessible from external/public IPs"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Access Groups"}),(0,r.jsx)("div",{children:f.mcp_access_groups&&f.mcp_access_groups.length>0?(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:f.mcp_access_groups.map((e,s)=>{var t;return(0,r.jsx)("span",{className:"px-2 py-1 bg-gray-100 rounded-md text-sm",children:"string"==typeof e?e:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:""},s)})}):(0,r.jsx)(m.Z,{className:"text-gray-500",children:"No access groups defined"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Allowed Tools"}),(0,r.jsx)("div",{children:f.allowed_tools&&f.allowed_tools.length>0?(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:f.allowed_tools.map((e,s)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-50 border border-blue-200 rounded-md text-sm",children:e},s))}):(0,r.jsx)(m.Z,{className:"text-gray-500",children:"All tools enabled"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Z,{className:"font-medium",children:"Cost Configuration"}),(0,r.jsx)(e5,{costConfig:null===(l=f.mcp_info)||void 0===l?void 0:l.mcp_server_cost_info})]})]})]})})]})]})]})},e3=(0,N.n)("mcpSemanticFilterSettings"),e8=()=>{let{accessToken:e}=(0,w.Z)();return(0,y.a)({queryKey:e3.list({}),queryFn:async()=>await (0,_.getMCPSemanticFilterSettings)(e),enabled:!!e,staleTime:36e5,gcTime:36e5})};var e7=t(29827),e9=t(21770);let se=(0,N.n)("mcpSemanticFilterSettings"),ss=e=>{let s=(0,e7.NL)();return(0,e9.D)({mutationFn:async s=>{if(!e)throw Error("Access token is required");return(0,_.updateMCPSemanticFilterSettings)(e,s)},onSuccess:()=>{s.invalidateQueries({queryKey:se.all})}})};var st=t(50337),sr=t(47451),sl=t(69410),sa=t(85847),sn=t(78355),si=t(10703),so=t(28595),sc=t(11894),sd=t(65869),su=t(76593);function sm(e){let{accessToken:s,testQuery:t,setTestQuery:l,testModel:a,setTestModel:n,isTesting:i,onTest:o,filterEnabled:c,testResult:d,curlCommand:u}=e;return(0,r.jsx)(eS.Z,{title:"Test Configuration",style:{marginBottom:16},children:(0,r.jsx)(sd.default,{defaultActiveKey:"test",items:[{key:"test",label:"Test",children:(0,r.jsxs)(ei.Z,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(h.default.Text,{strong:!0,style:{display:"block",marginBottom:8},children:[(0,r.jsx)(so.Z,{})," Test Query"]}),(0,r.jsx)(A.default.TextArea,{placeholder:"Enter a test query to see which tools would be selected...",value:t,onChange:e=>l(e.target.value),rows:4,disabled:i})]}),(0,r.jsx)("div",{children:(0,r.jsx)(su.Z,{accessToken:s||"",value:a,onChange:n,disabled:i,showLabel:!0,labelText:"Select Model"})}),(0,r.jsx)(W.ZP,{type:"primary",icon:(0,r.jsx)(so.Z,{}),onClick:o,loading:i,disabled:!t||!a||!c,block:!0,children:"Test Filter"}),!c&&(0,r.jsx)(G.Z,{type:"warning",message:"Semantic filtering is disabled",description:"Enable semantic filtering and save settings to test the filter.",showIcon:!0}),d&&(0,r.jsxs)("div",{children:[(0,r.jsx)(h.default.Title,{level:5,children:"Results"}),(0,r.jsx)(G.Z,{type:"success",message:"".concat(d.selectedTools," tools selected"),description:"Filtered from ".concat(d.totalTools," available tools"),showIcon:!0,style:{marginBottom:16}}),(0,r.jsxs)("div",{children:[(0,r.jsx)(h.default.Text,{strong:!0,style:{display:"block",marginBottom:8},children:"Selected Tools:"}),(0,r.jsx)("ul",{style:{paddingLeft:20,margin:0},children:d.tools.map((e,s)=>(0,r.jsx)("li",{style:{marginBottom:4},children:(0,r.jsx)(h.default.Text,{children:e})},s))})]})]})]})},{key:"api",label:"API Usage",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)(ei.Z,{style:{marginBottom:8},children:[(0,r.jsx)(sc.Z,{}),(0,r.jsx)(h.default.Text,{strong:!0,children:"API Usage"})]}),(0,r.jsx)(h.default.Text,{type:"secondary",style:{display:"block",marginBottom:8},children:"Use this curl command to test the semantic filter with your current configuration."}),(0,r.jsx)(h.default.Text,{strong:!0,style:{display:"block",marginBottom:8},children:"Response headers to check:"}),(0,r.jsxs)("ul",{style:{paddingLeft:20,margin:"0 0 12px 0"},children:[(0,r.jsxs)("li",{children:[(0,r.jsx)(h.default.Text,{children:"x-litellm-semantic-filter: shows total tools → selected tools"}),(0,r.jsx)(h.default.Text,{type:"secondary",style:{display:"block"},children:"Example: 10→3"})]}),(0,r.jsxs)("li",{children:[(0,r.jsx)(h.default.Text,{children:"x-litellm-semantic-filter-tools: CSV of selected tool names"}),(0,r.jsx)(h.default.Text,{type:"secondary",style:{display:"block"},children:"Example: wikipedia-fetch,github-search,slack-post"})]})]}),(0,r.jsx)("pre",{style:{background:"#f5f5f5",padding:12,borderRadius:4,overflow:"auto",fontSize:12,margin:0},children:u})]})}]})})}let sx=e=>{if(!e.filter)return null;let[s,t]=e.filter.split("->").map(Number);return{totalTools:s,selectedTools:t,tools:e.tools?e.tools.split(",").map(e=>e.trim()):[]}},sh=async e=>{let{accessToken:s,testModel:t,testQuery:r,setIsTesting:l,setTestResult:a}=e;if(!r||!t||!s){Z.ZP.error("Please enter a query and select a model");return}l(!0),a(null);try{let{headers:e}=await (0,_.testMCPSemanticFilter)(s,t,r),l=sx(e);if(!l){Z.ZP.warning("Semantic filter is not enabled or no tools were filtered");return}a(l),Z.ZP.success("Semantic filter test completed successfully")}catch(e){console.error("Test failed:",e),Z.ZP.error("Failed to test semantic filter")}finally{l(!1)}},sp=(e,s)=>"curl --location 'http://localhost:4000/v1/responses' \\\n--header 'Content-Type: application/json' \\\n--header 'Authorization: Bearer sk-1234' \\\n--data '{\n    \"model\": \"".concat(e,'",\n    "input": [\n    {\n      "role": "user",\n      "content": "').concat(s||"Your query here",'",\n      "type": "message"\n    }\n  ],\n    "tools": [\n        {\n            "type": "mcp",\n            "server_url": "litellm_proxy",\n            "require_approval": "never"\n        }\n    ],\n    "tool_choice": "required"\n}\'');function sg(e){var s,t,l;let{accessToken:n}=e,{data:i,isLoading:o,isError:c,error:d}=e8(),{mutate:u,isPending:m,error:x}=ss(n||""),[g]=P.Z.useForm(),[f,b]=(0,j.useState)(!1),[y,N]=(0,j.useState)(!1),[_,w]=(0,j.useState)([]),[C,S]=(0,j.useState)(!0),[k,A]=(0,j.useState)(""),[I,T]=(0,j.useState)("gpt-4o"),[M,O]=(0,j.useState)(null),[E,L]=(0,j.useState)(!1),z=null==i?void 0:i.field_schema,F=null!==(l=null==i?void 0:i.values)&&void 0!==l?l:{};(0,j.useEffect)(()=>{(async()=>{if(n)try{S(!0);let e=(await (0,si.p)(n)).filter(e=>"embedding"===e.mode);w(e)}catch(e){console.error("Error fetching embedding models:",e)}finally{S(!1)}})()},[n]),(0,j.useEffect)(()=>{if(F){var e,s,t,r;g.setFieldsValue({enabled:null!==(e=F.enabled)&&void 0!==e&&e,embedding_model:null!==(s=F.embedding_model)&&void 0!==s?s:"text-embedding-3-small",top_k:null!==(t=F.top_k)&&void 0!==t?t:10,similarity_threshold:null!==(r=F.similarity_threshold)&&void 0!==r?r:.3}),N(!1)}},[F,g]);let R=async()=>{try{let e=await g.validateFields();u(e,{onSuccess:()=>{N(!1),b(!0),setTimeout(()=>b(!1),3e3),Z.ZP.success("Settings updated successfully. Changes will be applied across all pods within 10 seconds.")},onError:e=>{Z.ZP.fromBackend(e)}})}catch(e){console.error("Form validation failed:",e)}},q=async()=>{n&&await sh({accessToken:n,testModel:I,testQuery:k,setIsTesting:L,setTestResult:O})};return n?(0,r.jsx)("div",{style:{width:"100%"},children:o?(0,r.jsx)(st.Z,{active:!0}):c?(0,r.jsx)(G.Z,{type:"error",message:"Could not load MCP Semantic Filter settings",description:d instanceof Error?d.message:void 0,style:{marginBottom:24}}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(G.Z,{type:"info",message:"Semantic Tool Filtering",description:"Filter MCP tools semantically based on query relevance. This reduces context window size and improves tool selection accuracy. Click 'Save Settings' to apply changes across all pods (takes effect within 10 seconds).",showIcon:!0,style:{marginBottom:24}}),f&&(0,r.jsx)(G.Z,{type:"success",message:"Settings saved successfully",icon:(0,r.jsx)($.Z,{}),showIcon:!0,closable:!0,style:{marginBottom:16}}),x&&(0,r.jsx)(G.Z,{type:"error",message:"Could not update settings",description:x instanceof Error?x.message:void 0,style:{marginBottom:16}}),(0,r.jsxs)(sr.Z,{gutter:24,children:[(0,r.jsx)(sl.Z,{xs:24,lg:12,children:(0,r.jsxs)(P.Z,{form:g,layout:"vertical",disabled:m,onValuesChange:()=>{N(!0)},children:[(0,r.jsxs)(eS.Z,{style:{marginBottom:16},children:[(0,r.jsx)(P.Z.Item,{name:"enabled",label:(0,r.jsxs)(ei.Z,{children:[(0,r.jsx)(h.default.Text,{strong:!0,children:"Enable Semantic Filtering"}),(0,r.jsx)(v.Z,{title:"When enabled, only the most relevant MCP tools will be included in requests based on semantic similarity",children:(0,r.jsx)(a.Z,{style:{color:"#8c8c8c"}})})]}),valuePropName:"checked",children:(0,r.jsx)(en.Z,{disabled:m})}),(0,r.jsx)(h.default.Text,{type:"secondary",style:{display:"block",marginTop:-16,marginBottom:16},children:null==z?void 0:null===(t=z.properties)||void 0===t?void 0:null===(s=t.enabled)||void 0===s?void 0:s.description})]}),(0,r.jsxs)(eS.Z,{title:"Configuration",style:{marginBottom:16},children:[(0,r.jsx)(P.Z.Item,{name:"embedding_model",label:(0,r.jsxs)(ei.Z,{children:[(0,r.jsx)(h.default.Text,{strong:!0,children:"Embedding Model"}),(0,r.jsx)(v.Z,{title:"The model used to generate embeddings for semantic matching",children:(0,r.jsx)(a.Z,{style:{color:"#8c8c8c"}})})]}),children:(0,r.jsx)(p.default,{options:_.map(e=>({label:e.model_group,value:e.model_group})),placeholder:C?"Loading models...":"Select embedding model",showSearch:!0,disabled:m||C,loading:C,notFoundContent:C?"Loading...":"No embedding models available"})}),(0,r.jsx)(P.Z.Item,{name:"top_k",label:(0,r.jsxs)(ei.Z,{children:[(0,r.jsx)(h.default.Text,{strong:!0,children:"Top K Results"}),(0,r.jsx)(v.Z,{title:"Maximum number of tools to return after filtering",children:(0,r.jsx)(a.Z,{style:{color:"#8c8c8c"}})})]}),children:(0,r.jsx)(U.Z,{min:1,max:100,style:{width:"100%"},disabled:m})}),(0,r.jsx)(P.Z.Item,{name:"similarity_threshold",label:(0,r.jsxs)(ei.Z,{children:[(0,r.jsx)(h.default.Text,{strong:!0,children:"Similarity Threshold"}),(0,r.jsx)(v.Z,{title:"Minimum similarity score (0-1) for a tool to be included",children:(0,r.jsx)(a.Z,{style:{color:"#8c8c8c"}})})]}),children:(0,r.jsx)(sa.Z,{min:0,max:1,step:.05,marks:{0:"0.0",.3:"0.3",.5:"0.5",.7:"0.7",1:"1.0"},disabled:m})})]}),(0,r.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:(0,r.jsx)(W.ZP,{type:"primary",icon:(0,r.jsx)(sn.Z,{}),onClick:R,loading:m,disabled:!y,children:"Save Settings"})})]})}),(0,r.jsx)(sl.Z,{xs:24,lg:12,children:(0,r.jsx)(sm,{accessToken:n,testQuery:k,setTestQuery:A,testModel:I,setTestModel:T,isTesting:E,onTest:q,filterEnabled:!!F.enabled,testResult:M,curlCommand:sp(I,k)})})]})]})}):(0,r.jsx)("div",{className:"p-6 text-center text-gray-500",children:"Please log in to configure semantic filter settings."})}var sf=t(3810);let{Text:sv}=h.default;var sj=e=>{let{accessToken:s}=e,[t,l]=(0,j.useState)(!0),[a,n]=(0,j.useState)(!1),[i,o]=(0,j.useState)([]),[c,d]=(0,j.useState)(null);(0,j.useEffect)(()=>{u(),m()},[s]);let u=async()=>{if(s){l(!0);try{for(let e of(await (0,_.getGeneralSettingsCall)(s)))"mcp_internal_ip_ranges"===e.field_name&&e.field_value&&o(e.field_value)}catch(e){console.error("Failed to load MCP network settings:",e)}finally{l(!1)}}},m=async()=>{if(!s)return;let e=await (0,_.fetchMCPClientIp)(s);e&&d(e)},x=async()=>{if(s){n(!0);try{i.length>0?await (0,_.updateConfigFieldSetting)(s,"mcp_internal_ip_ranges",i):await (0,_.deleteConfigFieldSetting)(s,"mcp_internal_ip_ranges")}catch(e){console.error("Failed to save MCP network settings:",e)}finally{n(!1)}}},h=e=>{i.includes(e)||o([...i,e])};if(t)return(0,r.jsx)("div",{className:"flex justify-center py-12",children:(0,r.jsx)(Y.Z,{})});let g=c?function(e){let s=e.split(".");return 4!==s.length?e+"/32":"".concat(s[0],".").concat(s[1],".").concat(s[2],".0/24")}(c):null;return(0,r.jsxs)("div",{className:"space-y-6 p-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(sv,{className:"text-lg font-semibold",children:"Private IP Ranges"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:'Define which IP ranges are part of your private network. Callers from these IPs can see all MCP servers. Callers from any other IP can only see servers marked "Available on Public Internet".'})]}),(0,r.jsxs)(eS.Z,{children:[c&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[(0,r.jsxs)(sv,{className:"text-sm text-blue-700",children:["Your current IP: ",(0,r.jsx)("span",{className:"font-mono font-medium",children:c})]}),g&&!i.includes(g)&&(0,r.jsxs)("div",{className:"mt-1",children:[(0,r.jsx)(sv,{className:"text-sm text-blue-600",children:"Suggested range: "}),(0,r.jsx)(sf.Z,{className:"cursor-pointer font-mono",color:"blue",icon:(0,r.jsx)(ec.Z,{}),onClick:()=>h(g),children:g})]})]}),(0,r.jsx)("div",{className:"flex items-center mb-2",children:(0,r.jsx)(sv,{className:"font-medium",children:"Your Private Network Ranges"})}),(0,r.jsx)(p.default,{mode:"tags",value:i,onChange:o,placeholder:"Leave empty to use defaults: 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 127.0.0.0/8",tokenSeparators:[","],className:"w-full",size:"large",allowClear:!0}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"Enter CIDR ranges (e.g., 10.0.0.0/8). When empty, standard private IP ranges are used."})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(W.ZP,{type:"primary",icon:(0,r.jsx)(sn.Z,{}),onClick:x,loading:a,children:"Save"})})]})};let{Search:sb}=A.default,{Text:sy}=h.default,sN=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16"];var s_=e=>{let{isVisible:s,onClose:t,onSelectServer:l,onCustomServer:a,accessToken:n}=e,[i,o]=(0,j.useState)([]),[c,d]=(0,j.useState)([]),[u,m]=(0,j.useState)(!1),[x,h]=(0,j.useState)(null),[p,f]=(0,j.useState)(""),[v,b]=(0,j.useState)("All");(0,j.useEffect)(()=>{s&&n&&(m(!0),h(null),(0,_.fetchDiscoverableMCPServers)(n).then(e=>{o(e.servers||[]),d(e.categories||[])}).catch(e=>{h(e.message||"Failed to load MCP servers")}).finally(()=>{m(!1)}))},[s,n]),(0,j.useEffect)(()=>{s&&(f(""),b("All"))},[s]);let y=(0,j.useMemo)(()=>{let e=i;if("All"!==v&&(e=e.filter(e=>e.category===v)),p.trim()){let s=p.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(s)||e.title.toLowerCase().includes(s)||e.description.toLowerCase().includes(s))}return e},[i,v,p]),N=(0,j.useMemo)(()=>{let e={};for(let s of y){let t=s.category||"Other";e[t]||(e[t]=[]),e[t].push(s)}return e},[y]);return(0,r.jsxs)(g.Z,{title:(0,r.jsxs)("div",{className:"flex items-center justify-between pb-4 border-b border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("img",{src:ey,alt:"MCP Logo",className:"w-8 h-8 object-contain",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"}}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add MCP Server"})]}),(0,r.jsx)("button",{onClick:a,className:"text-sm text-blue-600 hover:text-blue-800 cursor-pointer bg-transparent border-none font-medium",children:"+ Custom Server"})]}),open:s,onCancel:t,footer:null,width:1e3,className:"top-8",styles:{body:{padding:"24px",maxHeight:"70vh",overflowY:"auto"},header:{padding:"24px 24px 0 24px",border:"none"}},children:[(0,r.jsx)("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginBottom:12},children:["All",...c].map(e=>{let s=v===e;return(0,r.jsx)("button",{onClick:()=>b(e),style:{padding:"4px 12px",borderRadius:4,border:s?"1px solid #111827":"1px solid #e5e7eb",background:s?"#111827":"#fff",color:s?"#fff":"#4b5563",cursor:"pointer",fontSize:12,fontWeight:s?500:400,lineHeight:"20px"},children:e},e)})}),(0,r.jsx)(sb,{placeholder:"Search servers...",value:p,onChange:e=>f(e.target.value),style:{marginBottom:16},allowClear:!0}),u&&(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:Array.from({length:8}).map((e,s)=>(0,r.jsx)("div",{style:{height:36,borderRadius:6,background:"#f9fafb"}},s))}),x&&(0,r.jsx)("div",{style:{textAlign:"center",padding:"32px 0",color:"#9ca3af"},children:(0,r.jsxs)(sy,{children:["Failed to load servers: ",x]})}),!u&&!x&&0===y.length&&(0,r.jsx)("div",{style:{textAlign:"center",padding:"32px 0",color:"#9ca3af"},children:(0,r.jsxs)(sy,{children:["No servers found."," ",(0,r.jsx)("a",{onClick:a,style:{color:"#2563eb",cursor:"pointer"},children:"Add a custom server"})]})}),!u&&!x&&Object.entries(N).map(e=>{let[s,t]=e;return(0,r.jsxs)("div",{style:{marginBottom:16},children:[(0,r.jsx)("div",{style:{fontSize:11,fontWeight:500,color:"#9ca3af",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid #f3f4f6",marginBottom:4},children:s}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0 16px"},children:t.map(e=>{let s=function(e){let s=e.charAt(0).toUpperCase(),t=e.split("").reduce((e,s)=>e+s.charCodeAt(0),0)%sN.length;return{initial:s,backgroundColor:sN[t]}}(e.title||e.name);return(0,r.jsxs)("div",{onClick:()=>l(e),style:{display:"flex",alignItems:"center",padding:"8px 10px",borderRadius:6,cursor:"pointer",transition:"background 0.1s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#f9fafb"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:[e.icon_url?(0,r.jsx)("img",{src:e.icon_url,alt:e.title,style:{width:20,height:20,objectFit:"contain",flexShrink:0,marginRight:12},onError:e=>{let s=e.currentTarget;s.style.display="none";let t=s.nextElementSibling;t&&(t.style.display="flex")}}):null,(0,r.jsx)("div",{style:{width:20,height:20,borderRadius:4,backgroundColor:s.backgroundColor,color:"#fff",display:e.icon_url?"none":"flex",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:11,flexShrink:0,marginRight:12},children:s.initial}),(0,r.jsx)("span",{style:{fontSize:14,fontWeight:400,color:"#111827",flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title||e.name}),(0,r.jsx)("span",{style:{color:"#d1d5db",fontSize:14,flexShrink:0,marginLeft:8},children:"›"})]},e.name)})})]},s)})]})};let{Text:sw,Title:sC}=h.default,{Option:sS}=p.default;var sZ=e=>{let{accessToken:s,userRole:t,userID:h}=e,{data:y,isLoading:N,refetch:w}=(0,b.F)(),{data:C,isLoading:P}=S((0,j.useMemo)(()=>null==y?void 0:y.map(e=>e.server_id),[y])),A=(0,j.useMemo)(()=>{if(!y)return[];if(!C)return y;let e=new Map(C.map(e=>[e.server_id,e.status]));return y.map(s=>{let t=e.get(s.server_id);return{...s,status:t||s.status}})},[y,C]);j.useEffect(()=>{y&&(console.log("MCP Servers fetched:",y),y.forEach(e=>{console.log("Server: ".concat(e.server_name||e.server_id)),console.log("  allowed_tools:",e.allowed_tools)}))},[y]);let[I,T]=(0,j.useState)(null),[M,O]=(0,j.useState)(!1),[E,L]=(0,j.useState)(null),[z,F]=(0,j.useState)(!1),[R,q]=(0,j.useState)("all"),[U,V]=(0,j.useState)("all"),[B,D]=(0,j.useState)([]),[H,K]=(0,j.useState)(!1),[J,Y]=(0,j.useState)(!1),[G,W]=(0,j.useState)(null),[$,Q]=(0,j.useState)(!1),X="Internal User"===t;(0,j.useEffect)(()=>{try{let e=window.sessionStorage.getItem("litellm-mcp-oauth-edit-state");if(!e)return;let s=JSON.parse(e);(null==s?void 0:s.serverId)&&(L(s.serverId),F(!0))}catch(e){console.error("Failed to restore MCP edit view state",e)}},[]);let ee=j.useMemo(()=>{if(!A)return[];let e=new Set,s=[];return A.forEach(t=>{t.teams&&t.teams.forEach(t=>{let r=t.team_id;e.has(r)||(e.add(r),s.push(t))})}),s},[A]),es=j.useMemo(()=>A?Array.from(new Set(A.flatMap(e=>e.mcp_access_groups).filter(e=>null!=e))):[],[A]),et=(0,j.useCallback)((e,s)=>{if(!A)return D([]);let t=A;if("personal"===e){D([]);return}"all"!==e&&(t=t.filter(s=>{var t;return null===(t=s.teams)||void 0===t?void 0:t.some(s=>s.team_id===e)})),"all"!==s&&(t=t.filter(e=>{var t;return null===(t=e.mcp_access_groups)||void 0===t?void 0:t.some(e=>"string"==typeof e?e===s:e&&e.name===s)})),D(t)},[A]);(0,j.useEffect)(()=>{et(R,U)},[A,R,U,et]);let er=j.useMemo(()=>eH(null!=t?t:"",e=>{L(e),F(!1)},e=>{L(e),F(!0)},el,P),[t,P]);function el(e){T(e),O(!0)}let ea=async()=>{if(null!=I&&null!=s)try{Q(!0),await (0,_.deleteMCPServer)(s,I),Z.ZP.success("Deleted MCP Server successfully"),w()}catch(e){console.error("Error deleting the mcp server:",e)}finally{Q(!1),O(!1),T(null)}},en=I?(y||[]).find(e=>e.server_id===I):null,ei=j.useMemo(()=>B.find(e=>e.server_id===E)||{server_id:"",server_name:"",alias:"",url:"",transport:"",auth_type:"",created_at:"",created_by:"",updated_at:"",updated_by:""},[B,E]),eo=j.useCallback(()=>{F(!1),L(null),w()},[w]);return s&&t&&h?(0,r.jsxs)("div",{className:"w-full h-full p-6",children:[(0,r.jsx)(g.Z,{open:M,title:"Delete MCP Server?",onOk:ea,okText:$?"Deleting...":"Delete",onCancel:()=>{O(!1),T(null)},cancelText:"Cancel",cancelButtonProps:{disabled:$},okButtonProps:{danger:!0},confirmLoading:$,children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(sw,{children:"Are you sure you want to delete this MCP Server? This action cannot be undone."}),en&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-red-50 rounded-lg border border-red-200",children:[(0,r.jsx)(sC,{level:5,className:"mb-3 text-gray-900",children:"Server Information"}),(0,r.jsxs)(f.Z,{column:1,size:"small",children:[en.server_name&&(0,r.jsx)(f.Z.Item,{label:(0,r.jsx)("span",{className:"font-semibold text-gray-700",children:"Server Name"}),children:(0,r.jsx)(sw,{className:"text-sm",children:en.server_name})}),en.alias&&(0,r.jsx)(f.Z.Item,{label:(0,r.jsx)("span",{className:"font-semibold text-gray-700",children:"Alias"}),children:(0,r.jsx)(sw,{className:"text-sm",children:en.alias})}),(0,r.jsx)(f.Z.Item,{label:(0,r.jsx)("span",{className:"font-semibold text-gray-700",children:"Server ID"}),children:(0,r.jsx)(sw,{code:!0,className:"text-sm",children:en.server_id})}),(0,r.jsx)(f.Z.Item,{label:(0,r.jsx)("span",{className:"font-semibold text-gray-700",children:"URL"}),children:(0,r.jsx)(sw,{code:!0,className:"text-sm",children:en.url})})]})]})]})}),(0,r.jsx)(eC,{userRole:t,accessToken:s,onCreateSuccess:e=>{D(s=>[...s,e]),K(!1)},isModalVisible:H,setModalVisible:K,availableAccessGroups:es,prefillData:G,onBackToDiscovery:()=>{K(!1),W(null),Y(!0)}}),(0,r.jsx)(x.Z,{children:"MCP Servers"}),(0,r.jsx)(m.Z,{className:"text-tremor-content mt-2",children:"Configure and manage your MCP servers"}),(0,l.tY)(t)&&(0,r.jsx)(n.Z,{className:"mt-4 mb-4",onClick:()=>Y(!0),children:"+ Add New MCP Server"}),(0,r.jsx)(s_,{isVisible:J,onClose:()=>Y(!1),onSelectServer:e=>{W(e),Y(!1),K(!0)},onCustomServer:()=>{W(null),Y(!1),K(!0)},accessToken:s}),(0,r.jsxs)(o.Z,{className:"w-full h-full",children:[(0,r.jsx)(c.Z,{className:"flex justify-between mt-2 w-full items-center",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(i.Z,{children:"All Servers"}),(0,r.jsx)(i.Z,{children:"Connect"}),(0,r.jsx)(i.Z,{children:"Semantic Filter"}),(0,r.jsx)(i.Z,{children:"Network Settings"})]})}),(0,r.jsxs)(u.Z,{children:[(0,r.jsx)(d.Z,{children:E?(0,r.jsx)(e6,{mcpServer:ei,onBack:eo,isProxyAdmin:(0,l.tY)(t),isEditing:z,accessToken:s,userID:h,userRole:t,availableAccessGroups:es},E):(0,r.jsxs)("div",{className:"w-full h-full",children:[(0,r.jsx)("div",{className:"w-full px-6",children:(0,r.jsx)("div",{className:"flex flex-col space-y-4",children:(0,r.jsx)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-4 border-2 border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(m.Z,{className:"text-lg font-semibold text-gray-900",children:"Current Team:"}),(0,r.jsxs)(p.default,{value:R,onChange:e=>{q(e),et(e,U)},style:{width:300},children:[(0,r.jsx)(sS,{value:"all",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:X?"All Available Servers":"All Servers"})]})}),(0,r.jsx)(sS,{value:"personal",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:"Personal"})]})}),ee.map(e=>(0,r.jsx)(sS,{value:e.team_id,children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:e.team_alias||e.team_id})]})},e.team_id))]}),(0,r.jsxs)(m.Z,{className:"text-lg font-semibold text-gray-900 ml-6",children:["Access Group:",(0,r.jsx)(v.Z,{title:"An MCP Access Group is a set of users or teams that have permission to access specific MCP servers. Use access groups to control and organize who can connect to which servers.",children:(0,r.jsx)(a.Z,{style:{marginLeft:4,color:"#888"}})})]}),(0,r.jsxs)(p.default,{value:U,onChange:e=>{V(e),et(R,e)},style:{width:300},children:[(0,r.jsx)(sS,{value:"all",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:"All Access Groups"})]})}),es.map(e=>(0,r.jsx)(sS,{value:e,children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,r.jsx)("span",{className:"font-medium",children:e})]})},e))]})]})})})}),(0,r.jsx)("div",{className:"w-full px-6 mt-6",children:(0,r.jsx)(k.w,{data:B,columns:er,renderSubComponent:()=>(0,r.jsx)("div",{}),getRowCanExpand:()=>!1,isLoading:N,noDataMessage:"No MCP servers configured",loadingMessage:"\uD83D\uDE85 Loading MCP servers..."})})]})}),(0,r.jsx)(d.Z,{children:(0,r.jsx)(eU,{})}),(0,r.jsx)(d.Z,{children:(0,r.jsx)(sg,{accessToken:s})}),(0,r.jsx)(d.Z,{children:(0,r.jsx)(sj,{accessToken:s})})]})]})]}):(console.log("Missing required authentication parameters",{accessToken:s,userRole:t,userID:h}),(0,r.jsx)("div",{className:"p-6 text-center text-gray-500",children:"Missing required authentication parameters."}))};let sk=e=>"object"==typeof e&&null!==e&&!Array.isArray(e);function sP(e){if(!e)return[];if(Array.isArray(e))return e.map(e=>sA(e)).filter(e=>void 0!==e);let s=sA(e);return void 0===s?[]:[s]}function sA(e,s){if(!e)return;let t=void 0!==s?s:e.default;if("object"===e.type){let s=sk(t)?{...t}:{};return e.properties&&Object.entries(e.properties).forEach(e=>{let[t,r]=e;s[t]=sA(r,s[t])}),s}if("array"===e.type){if(Array.isArray(t)){let s=e.items;if(!s)return t;if(0===t.length){let e=sP(s);return e.length?e:t}return Array.isArray(s)?t.map((e,t)=>{var r;return sA(null!==(r=s[t])&&void 0!==r?r:s[s.length-1],e)}):t.map(e=>sA(s,e))}return void 0!==t?t:sP(e.items)}if(void 0!==t)return t;switch(e.type){case"integer":case"number":return 0;case"boolean":return!1;default:return""}}let sI=e=>{let s=sA(e);if("object"===e.type||"array"===e.type){let t="array"===e.type?[]:{};return JSON.stringify(null!=s?s:t,null,2)}return s};function sT(e){let{tool:s,onSubmit:t,isLoading:l,result:a,error:n,onClose:i}=e,[o]=P.Z.useForm(),[c,d]=j.useState("formatted"),[u,m]=j.useState(null),[x,h]=j.useState(null),p=j.useMemo(()=>"string"==typeof s.inputSchema?{type:"object",properties:{input:{type:"string",description:"Input for this tool"}},required:["input"]}:s.inputSchema,[s.inputSchema]),g=j.useMemo(()=>p.properties&&p.properties.params&&"object"===p.properties.params.type&&p.properties.params.properties?{type:"object",properties:p.properties.params.properties,required:p.properties.params.required||[]}:p,[p]);j.useEffect(()=>{if(o.resetFields(),!g.properties)return;let e={};Object.entries(g.properties).forEach(s=>{let[t,r]=s;e[t]=sI(r)}),o.setFieldsValue(e)},[o,g,s]),j.useEffect(()=>{u&&(a||n)&&h(Date.now()-u)},[a,n,u]);let f=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select();let t=document.execCommand("copy");if(document.body.removeChild(s),!t)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}},b=async()=>{await f(JSON.stringify(a,null,2))?Z.ZP.success("Result copied to clipboard"):Z.ZP.fromBackend("Failed to copy result")},y=async()=>{await f(s.name)?Z.ZP.success("Tool name copied to clipboard"):Z.ZP.fromBackend("Failed to copy tool name")};return(0,r.jsxs)("div",{className:"space-y-4 h-full",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between pb-3 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[s.mcp_info.logo_url&&(0,r.jsx)("img",{src:s.mcp_info.logo_url,alt:"".concat(s.mcp_info.server_name," logo"),className:"w-6 h-6 object-contain"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Test Tool:"}),(0,r.jsxs)("div",{className:"group inline-flex items-center space-x-1 bg-slate-50 hover:bg-slate-100 px-3 py-1 rounded-md cursor-pointer transition-colors border border-slate-200",onClick:y,title:"Click to copy tool name",children:[(0,r.jsx)("span",{className:"font-mono text-slate-700 font-medium text-sm",children:s.name}),(0,r.jsx)("svg",{className:"w-3 h-3 text-slate-400 group-hover:text-slate-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-600",children:s.description}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Provider: ",s.mcp_info.server_name]})]})]}),(0,r.jsx)(T.z,{onClick:i,variant:"light",size:"sm",className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 h-full",children:[(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg",children:[(0,r.jsx)("div",{className:"border-b border-gray-100 px-4 py-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Input Parameters"}),(0,r.jsx)(v.Z,{title:"Configure the input parameters for this tool call",children:(0,r.jsx)(I.Z,{className:"text-gray-400 hover:text-gray-600"})})]})}),(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)(P.Z,{form:o,onFinish:e=>{m(Date.now()),h(null);let s={};Object.entries(e).forEach(e=>{var t;let[r,l]=e,a=null===(t=g.properties)||void 0===t?void 0:t[r];if(a&&null!=l&&""!==l)switch(a.type){case"boolean":s[r]="true"===l||!0===l;break;case"number":case"integer":{let e=Number(l);s[r]=Number.isNaN(e)?l:"integer"===a.type?Math.trunc(e):e;break}case"object":case"array":try{let e="string"==typeof l?JSON.parse(l):l,t="object"===a.type&&null!==e&&"object"==typeof e&&!Array.isArray(e),n="array"===a.type&&Array.isArray(e);"object"===a.type&&t||"array"===a.type&&n?s[r]=e:s[r]=l}catch(e){s[r]=l}break;case"string":s[r]=String(l);break;default:s[r]=l}else null!=l&&""!==l&&(s[r]=l)}),t(p.properties&&p.properties.params&&"object"===p.properties.params.type&&p.properties.params.properties?{params:s}:s)},layout:"vertical",className:"space-y-3",children:["string"==typeof s.inputSchema?(0,r.jsx)("div",{className:"space-y-3",children:(0,r.jsx)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Input ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),name:"input",rules:[{required:!0,message:"Please enter input for this tool"}],className:"mb-3",children:(0,r.jsx)(T.o,{placeholder:"Enter input for this tool",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})})}):void 0===g.properties?(0,r.jsx)("div",{className:"text-center py-6 bg-gray-50 rounded-lg border border-gray-200",children:(0,r.jsxs)("div",{className:"max-w-sm mx-auto",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"No Parameters Required"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"This tool can be called without any input parameters."})]})}):(0,r.jsx)("div",{className:"space-y-3",children:Object.entries(g.properties).map(e=>{var t,l,a,n;let[i,o]=e,c=sI(o),d="".concat(s.name,"-").concat(i);return(0,r.jsxs)(P.Z.Item,{label:(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:[i," ",(null===(t=g.required)||void 0===t?void 0:t.includes(i))&&(0,r.jsx)("span",{className:"text-red-500",children:"*"}),o.description&&(0,r.jsx)(v.Z,{title:o.description,children:(0,r.jsx)(I.Z,{className:"ml-2 text-gray-400 hover:text-gray-600"})})]}),name:i,initialValue:c,rules:[{required:null===(l=g.required)||void 0===l?void 0:l.includes(i),message:"Please enter ".concat(i)},..."object"===o.type||"array"===o.type?[{validator:(e,s)=>{var t;if((null==s||""===s)&&!(null===(t=g.required)||void 0===t?void 0:t.includes(i)))return Promise.resolve();try{let e="string"==typeof s?JSON.parse(s):s,t="object"===o.type&&null!==e&&"object"==typeof e&&!Array.isArray(e),r="array"===o.type&&Array.isArray(e);if("object"===o.type&&t||"array"===o.type&&r)return Promise.resolve();return Promise.reject(Error("object"===o.type?"Please enter a JSON object":"Please enter a JSON array"))}catch(e){return Promise.reject(Error("Invalid JSON"))}}}]:[]],className:"mb-3",children:["string"===o.type&&o.enum&&(0,r.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors",defaultValue:null!=c?c:"",children:[!(null===(a=g.required)||void 0===a?void 0:a.includes(i))&&(0,r.jsxs)("option",{value:"",children:["Select ",i]}),o.enum.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),"string"===o.type&&!o.enum&&(0,r.jsx)(T.o,{placeholder:o.description||"Enter ".concat(i),defaultValue:null!=c?c:"",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"}),("number"===o.type||"integer"===o.type)&&(0,r.jsx)("input",{type:"number",step:"integer"===o.type?1:"any",placeholder:o.description||"Enter ".concat(i),defaultValue:null!=c?c:0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors"}),"boolean"===o.type&&(0,r.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors",defaultValue:(null!=c&&c).toString(),children:[!(null===(n=g.required)||void 0===n?void 0:n.includes(i))&&(0,r.jsxs)("option",{value:"",children:["Select ",i]}),(0,r.jsx)("option",{value:"true",children:"True"}),(0,r.jsx)("option",{value:"false",children:"False"})]}),("object"===o.type||"array"===o.type)&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("textarea",{rows:"object"===o.type?6:4,placeholder:o.description||("object"===o.type?"Enter JSON object for ".concat(i):"Enter JSON array for ".concat(i)),defaultValue:null!=c?c:"object"===o.type?"{}":"[]",spellCheck:!1,"data-testid":"textarea-".concat(i),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm font-mono"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"object"===o.type?"Provide a valid JSON object.":"Provide a valid JSON array."})]})]},d)})}),(0,r.jsx)("div",{className:"pt-3 border-t border-gray-100",children:(0,r.jsx)(T.z,{onClick:()=>o.submit(),disabled:l,variant:"primary",className:"w-full",loading:l,children:l?"Calling Tool...":a||n?"Call Again":"Call Tool"})})]})})]}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg",children:[(0,r.jsx)("div",{className:"border-b border-gray-100 px-4 py-2",children:(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Tool Result"})}),(0,r.jsx)("div",{className:"p-4",children:a||n||l?(0,r.jsxs)("div",{className:"space-y-3",children:[a&&!l&&!n&&(0,r.jsx)("div",{className:"p-2 bg-green-50 border border-green-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"h-4 w-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("h4",{className:"text-xs font-medium text-green-900",children:"Tool executed successfully"}),null!==x&&(0,r.jsxs)("span",{className:"text-xs text-green-600 ml-1",children:["• ",(x/1e3).toFixed(2),"s"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsxs)("div",{className:"flex bg-white rounded border border-green-300 p-0.5",children:[(0,r.jsx)("button",{onClick:()=>d("formatted"),className:"px-2 py-1 text-xs font-medium rounded transition-colors ".concat("formatted"===c?"bg-green-100 text-green-800":"text-green-600 hover:text-green-800"),children:"Formatted"}),(0,r.jsx)("button",{onClick:()=>d("json"),className:"px-2 py-1 text-xs font-medium rounded transition-colors ".concat("json"===c?"bg-green-100 text-green-800":"text-green-600 hover:text-green-800"),children:"JSON"})]}),(0,r.jsx)("button",{onClick:b,className:"p-1 hover:bg-green-100 rounded text-green-700",title:"Copy response",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]})]})}),(0,r.jsxs)("div",{className:"max-h-96 overflow-y-auto",children:[l&&(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center h-48 text-gray-500",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200"}),(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-600 border-t-transparent absolute top-0"})]}),(0,r.jsx)("p",{className:"text-sm font-medium mt-3",children:"Calling tool..."}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Please wait while we process your request"})]}),n&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,r.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-4 w-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,r.jsx)("h4",{className:"text-xs font-medium text-red-900",children:"Tool Call Failed"}),null!==x&&(0,r.jsxs)("span",{className:"text-xs text-red-600",children:["• ",(x/1e3).toFixed(2),"s"]})]}),(0,r.jsx)("div",{className:"bg-white border border-red-200 rounded p-2 max-h-48 overflow-y-auto",children:(0,r.jsx)("pre",{className:"text-xs whitespace-pre-wrap text-red-700 font-mono",children:n.message})})]})]})}),a&&!l&&!n&&(0,r.jsx)("div",{className:"space-y-3",children:"formatted"===c?a.map((e,s)=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:["text"===e.type&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"bg-gray-50 px-3 py-1 border-b border-gray-200",children:(0,r.jsx)("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Text Response"})}),(0,r.jsx)("div",{className:"p-3",children:(0,r.jsx)("div",{className:"bg-white rounded border border-gray-200 max-h-64 overflow-y-auto",children:(0,r.jsx)("div",{className:"p-3 space-y-2",children:e.text.split("\n\n").map((e,s)=>{if(""===e.trim())return null;if(e.startsWith("##")){let t=e.replace(/^#+\s/,"");return(0,r.jsx)("div",{className:"border-b border-gray-200 pb-1 mb-2",children:(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:t})},s)}let t=/(https?:\/\/[^\s\)]+)/g;if(t.test(e)){let l=e.split(t);return(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded p-2",children:(0,r.jsx)("div",{className:"text-xs text-gray-700 leading-relaxed whitespace-pre-wrap",children:l.map((e,s)=>t.test(e)?(0,r.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline break-all",children:e},s):e)})},s)}return e.includes("Score:")?(0,r.jsx)("div",{className:"bg-green-50 border-l-4 border-green-400 p-2 rounded-r",children:(0,r.jsx)("p",{className:"text-xs text-green-800 font-medium whitespace-pre-wrap",children:e})},s):(0,r.jsx)("div",{className:"bg-gray-50 rounded p-2 border border-gray-200",children:(0,r.jsx)("div",{className:"text-xs text-gray-700 leading-relaxed whitespace-pre-wrap font-mono",children:e})},s)}).filter(Boolean)})})})]}),"image"===e.type&&e.url&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"bg-gray-50 px-3 py-1 border-b border-gray-200",children:(0,r.jsx)("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Image Response"})}),(0,r.jsx)("div",{className:"p-3",children:(0,r.jsx)("div",{className:"bg-gray-50 rounded p-3 border border-gray-200",children:(0,r.jsx)("img",{src:e.url,alt:"Tool result",className:"max-w-full h-auto rounded shadow-sm"})})})]}),"embedded_resource"===e.type&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"bg-gray-50 px-3 py-1 border-b border-gray-200",children:(0,r.jsx)("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Embedded Resource"})}),(0,r.jsx)("div",{className:"p-3",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 p-3 bg-blue-50 border border-blue-200 rounded",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("p",{className:"text-xs font-medium text-blue-900",children:["Resource Type: ",e.resource_type]}),e.url&&(0,r.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-blue-600 hover:text-blue-800 hover:underline mt-1 transition-colors",children:["View Resource",(0,r.jsxs)("svg",{className:"ml-1 h-3 w-3",fill:"currentColor",viewBox:"0 0 20 20",children:[(0,r.jsx)("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),(0,r.jsx)("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]})]})]})]})})]})]},s)):(0,r.jsx)("div",{className:"bg-white rounded border border-gray-200",children:(0,r.jsx)("div",{className:"p-3 overflow-auto max-h-80 bg-gray-50",children:(0,r.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all text-gray-800",children:JSON.stringify(a,null,2)})})})})]})]}):(0,r.jsx)("div",{className:"flex flex-col justify-center items-center h-48 text-gray-500",children:(0,r.jsxs)("div",{className:"text-center max-w-sm",children:[(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Ready to Call Tool"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 leading-relaxed",children:'Configure the input parameters and click "Call Tool" to see the results here.'})]})})})]})]})]})}var sM=t(92403),sO=t(69993),sE=e=>{let{serverId:s,accessToken:t,auth_type:l,userRole:a,userID:n,serverAlias:i,extraHeaders:o}=e,[c,d]=(0,j.useState)(null),[u,m]=(0,j.useState)(null),[x,h]=(0,j.useState)(null),[p,g]=(0,j.useState)(""),[f,v]=(0,j.useState)({}),[b,N]=(0,j.useState)(!1),w=o&&o.length>0,C=()=>{if(!i||!w)return;let e={};return Object.entries(f).forEach(s=>{let[t,r]=s;r&&r.trim()&&(e["x-mcp-".concat(i,"-").concat(t.toLowerCase())]=r)}),Object.keys(e).length>0?e:void 0},{data:S,isLoading:Z,error:k,refetch:P}=(0,y.a)({queryKey:["mcpTools",s,f],queryFn:()=>{if(!t)throw Error("Access Token required");return(0,_.listMCPTools)(t,s,C())},enabled:!!t,staleTime:3e4}),{mutate:I,isPending:T}=(0,e9.D)({mutationFn:async e=>{if(!t)throw Error("Access Token required");try{return await (0,_.callMCPTool)(t,s,e.tool.name,e.arguments,{customHeaders:C()})}catch(e){throw e}},onSuccess:e=>{m(e.content),h(null)},onError:e=>{h(e),m(null)}}),M=(null==S?void 0:S.tools)||[],O=M.filter(e=>{let s=p.toLowerCase();return e.name.toLowerCase().includes(s)||e.description&&e.description.toLowerCase().includes(s)||e.mcp_info.server_name&&e.mcp_info.server_name.toLowerCase().includes(s)});return(0,r.jsx)("div",{className:"w-full h-screen p-4 bg-white",children:(0,r.jsx)(K.Zb,{className:"w-full rounded-xl shadow-md overflow-hidden",children:(0,r.jsxs)("div",{className:"flex h-auto w-full gap-4",children:[(0,r.jsxs)("div",{className:"w-1/4 p-4 bg-gray-50 flex flex-col",children:[(0,r.jsx)(K.Dx,{className:"text-xl font-semibold mb-6 mt-2",children:"MCP Tools"}),(0,r.jsxs)("div",{className:"flex flex-col flex-1",children:[w&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(sM.Z,{className:"text-blue-600 mr-2"}),(0,r.jsx)(K.xv,{className:"text-sm font-medium text-blue-800",children:"Additional Headers"})]}),(0,r.jsx)(W.ZP,{size:"small",type:"link",onClick:()=>N(!b),className:"text-blue-700 p-0 h-auto",children:b?"Hide":"Configure"})]}),!b&&0===Object.keys(f).length&&(0,r.jsx)(K.xv,{className:"text-xs text-blue-700",children:'This server requires additional headers. Click "Configure" to provide values.'}),b&&(0,r.jsxs)("div",{className:"mt-3 space-y-2",children:[null==o?void 0:o.map(e=>(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e}),(0,r.jsx)(A.default,{size:"small",placeholder:"Enter ".concat(e),value:f[e]||"",onChange:s=>{v({...f,[e]:s.target.value})},prefix:(0,r.jsx)(sM.Z,{className:"text-gray-400"}),className:"rounded"})]},e)),(0,r.jsx)(W.ZP,{size:"small",type:"primary",onClick:()=>{P(),N(!1)},disabled:Object.values(f).every(e=>!e||!e.trim()),className:"w-full mt-2",children:"Load Tools"})]}),!b&&Object.keys(f).length>0&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)(K.xv,{className:"text-xs text-green-700 flex items-center",children:[(0,r.jsx)("span",{className:"inline-block w-2 h-2 bg-green-500 rounded-full mr-2"}),Object.keys(f).length," header(s) configured"]})})]}),(0,r.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,r.jsxs)(K.xv,{className:"font-medium block mb-3 text-gray-700 flex items-center",children:[(0,r.jsx)(H.Z,{className:"mr-2"})," Available Tools",M.length>0&&(0,r.jsx)("span",{className:"ml-2 bg-blue-100 text-blue-800 text-xs font-medium px-2 py-0.5 rounded-full",children:M.length})]}),M.length>0&&(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsx)(A.default,{placeholder:"Search tools...",prefix:(0,r.jsx)(et.Z,{className:"text-gray-400"}),value:p,onChange:e=>g(e.target.value),allowClear:!0,className:"rounded-lg",size:"middle"})}),Z&&(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 bg-white border border-gray-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"relative mb-3",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-gray-200"}),(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-blue-600 border-t-transparent absolute top-0"})]}),(0,r.jsx)("p",{className:"text-xs font-medium text-gray-700",children:"Loading tools..."})]}),(null==S?void 0:S.error)&&!Z&&!M.length&&(0,r.jsx)("div",{className:"p-3 text-xs text-red-800 rounded-lg bg-red-50 border border-red-200",children:(0,r.jsxs)("p",{className:"font-medium",children:["Error: ",S.message]})}),!Z&&!(null==S?void 0:S.error)&&(!M||0===M.length)&&(0,r.jsxs)("div",{className:"p-4 text-center bg-white border border-gray-200 rounded-lg",children:[(0,r.jsx)("div",{className:"mx-auto w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mb-2",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 8.172V5L8 4z"})})}),(0,r.jsx)("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"No tools available"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"No tools found for this server"})]}),!Z&&!(null==S?void 0:S.error)&&M.length>0&&(0,r.jsx)(r.Fragment,{children:0===O.length?(0,r.jsxs)("div",{className:"p-4 text-center bg-white border border-gray-200 rounded-lg",children:[(0,r.jsx)(et.Z,{className:"text-2xl text-gray-400 mb-2"}),(0,r.jsx)("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"No tools found"}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:['No tools match "',p,'"']})]}):(0,r.jsx)("div",{className:"space-y-2 flex-1 overflow-y-auto min-h-0 mcp-tools-scrollable",style:{maxHeight:"400px",scrollbarWidth:"auto",scrollbarColor:"#cbd5e0 #f7fafc"},children:O.map(e=>(0,r.jsxs)("div",{className:"border rounded-lg p-3 cursor-pointer transition-all hover:shadow-sm ".concat((null==c?void 0:c.name)===e.name?"border-blue-500 bg-blue-50 ring-1 ring-blue-200":"border-gray-200 bg-white hover:border-gray-300"),onClick:()=>{d(e),m(null),h(null)},children:[(0,r.jsxs)("div",{className:"flex items-start space-x-2",children:[e.mcp_info.logo_url&&(0,r.jsx)("img",{src:e.mcp_info.logo_url,alt:"".concat(e.mcp_info.server_name," logo"),className:"w-4 h-4 object-contain flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h4",{className:"font-mono text-xs font-medium text-gray-900 truncate",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.mcp_info.server_name}),(0,r.jsx)("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2 leading-relaxed",children:e.description})]})]}),(null==c?void 0:c.name)===e.name&&(0,r.jsx)("div",{className:"mt-2 pt-2 border-t border-blue-200",children:(0,r.jsxs)("div",{className:"flex items-center text-xs font-medium text-blue-700",children:[(0,r.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Selected"]})})]},e.name))})})]})]})]}),(0,r.jsxs)("div",{className:"w-3/4 flex flex-col bg-white",children:[(0,r.jsx)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:(0,r.jsx)(K.Dx,{className:"text-xl font-semibold mb-0",children:"Tool Testing Playground"})}),(0,r.jsx)("div",{className:"flex-1 overflow-auto p-4",children:c?(0,r.jsx)("div",{className:"h-full",children:(0,r.jsx)(sT,{tool:c,onSubmit:e=>{I({tool:c,arguments:e})},result:u,error:x,isLoading:T,onClose:()=>d(null)})}):(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,r.jsx)(sO.Z,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,r.jsx)(K.xv,{className:"text-lg font-medium text-gray-600 mb-2",children:"Select a Tool to Test"}),(0,r.jsx)(K.xv,{className:"text-center text-gray-500 max-w-md",children:"Choose a tool from the left sidebar to start testing its functionality with custom inputs."})]})})]})]})})})}}}]);