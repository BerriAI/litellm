(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,621482,e=>{"use strict";var r=e.i(869230),t=e.i(992571),l=class extends r.QueryObserver{constructor(e,r){super(e,r)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e){super.setOptions({...e,behavior:(0,t.infiniteQueryBehavior)()})}getOptimisticResult(e){return e.behavior=(0,t.infiniteQueryBehavior)(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,r){let{state:l}=e,a=super.createResult(e,r),{isFetching:i,isRefetching:s,isError:n,isRefetchError:o}=a,d=l.fetchMeta?.fetchMore?.direction,c=n&&"forward"===d,m=i&&"forward"===d,u=n&&"backward"===d,h=i&&"backward"===d;return{...a,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,t.hasNextPage)(r,l.data),hasPreviousPage:(0,t.hasPreviousPage)(r,l.data),isFetchNextPageError:c,isFetchingNextPage:m,isFetchPreviousPageError:u,isFetchingPreviousPage:h,isRefetchError:o&&!c&&!u,isRefetching:s&&!m&&!h}}},a=e.i(469637);function i(e,r){return(0,a.useBaseQuery)(e,l,r)}e.s(["useInfiniteQuery",()=>i],621482)},785242,e=>{"use strict";var r=e.i(619273),t=e.i(266027),l=e.i(912598),a=e.i(135214),i=e.i(270345),s=e.i(243652),n=e.i(764205);let o=(0,s.createQueryKeys)("teams"),d=async(e,r,t,l={})=>{try{let a=(0,n.getProxyBaseUrl)(),i=new URLSearchParams(Object.entries({team_id:l.teamID,organization_id:l.organizationID,team_alias:l.team_alias,user_id:l.userID,page:r,page_size:t,sort_by:l.sortBy,sort_order:l.sortOrder,status:"deleted"}).filter(([,e])=>null!=e).map(([e,r])=>[e,String(r)])),s=`${a?`${a}/v2/team/list`:"/v2/team/list"}?${i}`,o=await fetch(s,{method:"GET",headers:{[(0,n.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"}});if(!o.ok){let e=await o.json(),r=(0,n.deriveErrorMessage)(e);throw(0,n.handleError)(r),Error(r)}let d=await o.json();if(console.log("/team/list?status=deleted API Response:",d),d&&"object"==typeof d&&"teams"in d)return d.teams;return d}catch(e){throw console.error("Failed to list deleted teams:",e),e}},c=(0,s.createQueryKeys)("deletedTeams");e.s(["useDeletedTeams",0,(e,l,i={})=>{let{accessToken:s}=(0,a.default)();return(0,t.useQuery)({queryKey:c.list({page:e,limit:l,...i}),queryFn:async()=>await d(s,e,l,i),enabled:!!s,staleTime:3e4,placeholderData:r.keepPreviousData})},"useTeam",0,e=>{let{accessToken:r}=(0,a.default)(),i=(0,l.useQueryClient)();return(0,t.useQuery)({queryKey:o.detail(e),enabled:!!(r&&e),queryFn:async()=>{if(!r||!e)throw Error("Missing auth or teamId");return(0,n.teamInfoCall)(r,e)},initialData:()=>{if(!e)return;let r=i.getQueryData(o.list({}));return r?.find(r=>r.team_id===e)}})},"useTeams",0,()=>{let{accessToken:e,userId:r,userRole:l}=(0,a.default)();return(0,t.useQuery)({queryKey:o.list({}),queryFn:async()=>await (0,i.fetchTeams)(e,r,l,null),enabled:!!e})}])},738014,e=>{"use strict";var r=e.i(135214),t=e.i(764205),l=e.i(266027);let a=(0,e.i(243652).createQueryKeys)("users");e.s(["useCurrentUser",0,()=>{let{accessToken:e,userId:i,userRole:s}=(0,r.default)();return(0,l.useQuery)({queryKey:a.detail(i),queryFn:async()=>{let r=await (0,t.userInfoCall)(e,i,s,!1,null,null);return console.log(`userInfo: ${JSON.stringify(r)}`),r.user_info},enabled:!!(e&&i&&s)})}])},980187,e=>{"use strict";e.s(["createTeamAliasMap",0,e=>e?e.reduce((e,r)=>(e[r.team_id]=r.team_alias,e),{}):{},"resolveTeamAliasFromTeamID",0,(e,r)=>{let t=r.find(r=>r.team_id===e);return t?t.team_alias:null}])},434626,e=>{"use strict";var r=e.i(271645);let t=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"}))});e.s(["ExternalLinkIcon",0,t],434626)},902555,e=>{"use strict";var r=e.i(843476),t=e.i(591935),l=e.i(122577),a=e.i(278587),i=e.i(68155),s=e.i(360820),n=e.i(871943),o=e.i(434626),d=e.i(592968),c=e.i(115504),m=e.i(752978);function u({icon:e,onClick:t,className:l,disabled:a,dataTestId:i}){return a?(0,r.jsx)(m.Icon,{icon:e,size:"sm",className:"opacity-50 cursor-not-allowed","data-testid":i}):(0,r.jsx)(m.Icon,{icon:e,size:"sm",onClick:t,className:(0,c.cx)("cursor-pointer",l),"data-testid":i})}let h={Edit:{icon:t.PencilAltIcon,className:"hover:text-blue-600"},Delete:{icon:i.TrashIcon,className:"hover:text-red-600"},Test:{icon:l.PlayIcon,className:"hover:text-blue-600"},Regenerate:{icon:a.RefreshIcon,className:"hover:text-green-600"},Up:{icon:s.ChevronUpIcon,className:"hover:text-blue-600"},Down:{icon:n.ChevronDownIcon,className:"hover:text-blue-600"},Open:{icon:o.ExternalLinkIcon,className:"hover:text-green-600"}};function g({onClick:e,tooltipText:t,disabled:l=!1,disabledTooltipText:a,dataTestId:i,variant:s}){let{icon:n,className:o}=h[s];return(0,r.jsx)(d.Tooltip,{title:l?a:t,children:(0,r.jsx)("span",{children:(0,r.jsx)(u,{icon:n,onClick:e,className:o,disabled:l,dataTestId:i})})})}e.s(["default",()=>g],902555)},122577,e=>{"use strict";var r=e.i(271645);let t=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))});e.s(["PlayIcon",0,t],122577)},278587,e=>{"use strict";var r=e.i(271645);let t=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"}))});e.s(["RefreshIcon",0,t],278587)},207670,e=>{"use strict";function r(){for(var e,r,t=0,l="",a=arguments.length;t<a;t++)(e=arguments[t])&&(r=function e(r){var t,l,a="";if("string"==typeof r||"number"==typeof r)a+=r;else if("object"==typeof r)if(Array.isArray(r)){var i=r.length;for(t=0;t<i;t++)r[t]&&(l=e(r[t]))&&(a&&(a+=" "),a+=l)}else for(l in r)r[l]&&(a&&(a+=" "),a+=l);return a}(e))&&(l&&(l+=" "),l+=r);return l}e.s(["clsx",()=>r,"default",0,r])},728889,e=>{"use strict";var r=e.i(290571),t=e.i(271645),l=e.i(829087),a=e.i(480731),i=e.i(444755),s=e.i(673706),n=e.i(95779);let o={xs:{paddingX:"px-1.5",paddingY:"py-1.5"},sm:{paddingX:"px-1.5",paddingY:"py-1.5"},md:{paddingX:"px-2",paddingY:"py-2"},lg:{paddingX:"px-2",paddingY:"py-2"},xl:{paddingX:"px-2.5",paddingY:"py-2.5"}},d={xs:{height:"h-3",width:"w-3"},sm:{height:"h-5",width:"w-5"},md:{height:"h-5",width:"w-5"},lg:{height:"h-7",width:"w-7"},xl:{height:"h-9",width:"w-9"}},c={simple:{rounded:"",border:"",ring:"",shadow:""},light:{rounded:"rounded-tremor-default",border:"",ring:"",shadow:""},shadow:{rounded:"rounded-tremor-default",border:"border",ring:"",shadow:"shadow-tremor-card dark:shadow-dark-tremor-card"},solid:{rounded:"rounded-tremor-default",border:"border-2",ring:"ring-1",shadow:""},outlined:{rounded:"rounded-tremor-default",border:"border",ring:"ring-2",shadow:""}},m=(0,s.makeClassName)("Icon"),u=t.default.forwardRef((e,u)=>{let{icon:h,variant:g="simple",tooltip:x,size:p=a.Sizes.SM,color:b,className:_}=e,f=(0,r.__rest)(e,["icon","variant","tooltip","size","color","className"]),j=((e,r)=>{switch(e){case"simple":return{textColor:r?(0,s.getColorClassNames)(r,n.colorPalette.text).textColor:"text-tremor-brand dark:text-dark-tremor-brand",bgColor:"",borderColor:"",ringColor:""};case"light":return{textColor:r?(0,s.getColorClassNames)(r,n.colorPalette.text).textColor:"text-tremor-brand dark:text-dark-tremor-brand",bgColor:r?(0,i.tremorTwMerge)((0,s.getColorClassNames)(r,n.colorPalette.background).bgColor,"bg-opacity-20"):"bg-tremor-brand-muted dark:bg-dark-tremor-brand-muted",borderColor:"",ringColor:""};case"shadow":return{textColor:r?(0,s.getColorClassNames)(r,n.colorPalette.text).textColor:"text-tremor-brand dark:text-dark-tremor-brand",bgColor:r?(0,i.tremorTwMerge)((0,s.getColorClassNames)(r,n.colorPalette.background).bgColor,"bg-opacity-20"):"bg-tremor-background dark:bg-dark-tremor-background",borderColor:"border-tremor-border dark:border-dark-tremor-border",ringColor:""};case"solid":return{textColor:r?(0,s.getColorClassNames)(r,n.colorPalette.text).textColor:"text-tremor-brand-inverted dark:text-dark-tremor-brand-inverted",bgColor:r?(0,i.tremorTwMerge)((0,s.getColorClassNames)(r,n.colorPalette.background).bgColor,"bg-opacity-20"):"bg-tremor-brand dark:bg-dark-tremor-brand",borderColor:"border-tremor-brand-inverted dark:border-dark-tremor-brand-inverted",ringColor:"ring-tremor-ring dark:ring-dark-tremor-ring"};case"outlined":return{textColor:r?(0,s.getColorClassNames)(r,n.colorPalette.text).textColor:"text-tremor-brand dark:text-dark-tremor-brand",bgColor:r?(0,i.tremorTwMerge)((0,s.getColorClassNames)(r,n.colorPalette.background).bgColor,"bg-opacity-20"):"bg-tremor-background dark:bg-dark-tremor-background",borderColor:r?(0,s.getColorClassNames)(r,n.colorPalette.ring).borderColor:"border-tremor-brand-subtle dark:border-dark-tremor-brand-subtle",ringColor:r?(0,i.tremorTwMerge)((0,s.getColorClassNames)(r,n.colorPalette.ring).ringColor,"ring-opacity-40"):"ring-tremor-brand-muted dark:ring-dark-tremor-brand-muted"}}})(g,b),{tooltipProps:v,getReferenceProps:y}=(0,l.useTooltip)();return t.default.createElement("span",Object.assign({ref:(0,s.mergeRefs)([u,v.refs.setReference]),className:(0,i.tremorTwMerge)(m("root"),"inline-flex shrink-0 items-center justify-center",j.bgColor,j.textColor,j.borderColor,j.ringColor,c[g].rounded,c[g].border,c[g].shadow,c[g].ring,o[p].paddingX,o[p].paddingY,_)},y,f),t.default.createElement(l.default,Object.assign({text:x},v)),t.default.createElement(h,{className:(0,i.tremorTwMerge)(m("icon"),"shrink-0",d[p].height,d[p].width)}))});u.displayName="Icon",e.s(["default",()=>u],728889)},752978,e=>{"use strict";var r=e.i(728889);e.s(["Icon",()=>r.default])},591935,e=>{"use strict";var r=e.i(271645);let t=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"}))});e.s(["PencilAltIcon",0,t],591935)},109799,e=>{"use strict";var r=e.i(135214),t=e.i(764205),l=e.i(266027),a=e.i(912598);let i=(0,e.i(243652).createQueryKeys)("organizations");e.s(["useOrganization",0,e=>{let s=(0,a.useQueryClient)(),{accessToken:n}=(0,r.default)();return(0,l.useQuery)({queryKey:i.detail(e),enabled:!!(n&&e),queryFn:async()=>{if(!n||!e)throw Error("Missing auth or teamId");return(0,t.organizationInfoCall)(n,e)},initialData:()=>{if(!e)return;let r=s.getQueryData(i.list({}));return r?.find(r=>r.organization_id===e)}})},"useOrganizations",0,()=>{let{accessToken:e,userId:a,userRole:s}=(0,r.default)();return(0,l.useQuery)({queryKey:i.list({}),queryFn:async()=>await (0,t.organizationListCall)(e),enabled:!!(e&&a&&s)})}])},625901,e=>{"use strict";var r=e.i(266027),t=e.i(621482),l=e.i(243652),a=e.i(764205),i=e.i(135214);let s=(0,l.createQueryKeys)("models"),n=(0,l.createQueryKeys)("modelHub"),o=(0,l.createQueryKeys)("allProxyModels");(0,l.createQueryKeys)("selectedTeamModels");let d=(0,l.createQueryKeys)("infiniteModels");e.s(["useAllProxyModels",0,()=>{let{accessToken:e,userId:t,userRole:l}=(0,i.default)();return(0,r.useQuery)({queryKey:o.list({}),queryFn:async()=>await (0,a.modelAvailableCall)(e,t,l,!0,null,!0,!1,"expand"),enabled:!!(e&&t&&l)})},"useInfiniteModelInfo",0,(e=50,r)=>{let{accessToken:l,userId:s,userRole:n}=(0,i.default)();return(0,t.useInfiniteQuery)({queryKey:d.list({filters:{...s&&{userId:s},...n&&{userRole:n},size:e,...r&&{search:r}}}),queryFn:async({pageParam:t})=>await (0,a.modelInfoCall)(l,s,n,t,e,r),initialPageParam:1,getNextPageParam:e=>{if(e.current_page<e.total_pages)return e.current_page+1},enabled:!!(l&&s&&n)})},"useModelHub",0,()=>{let{accessToken:e}=(0,i.default)();return(0,r.useQuery)({queryKey:n.list({}),queryFn:async()=>await (0,a.modelHubCall)(e),enabled:!!e})},"useModelsInfo",0,(e=1,t=50,l,n,o,d,c)=>{let{accessToken:m,userId:u,userRole:h}=(0,i.default)();return(0,r.useQuery)({queryKey:s.list({filters:{...u&&{userId:u},...h&&{userRole:h},page:e,size:t,...l&&{search:l},...n&&{modelId:n},...o&&{teamId:o},...d&&{sortBy:d},...c&&{sortOrder:c}}}),queryFn:async()=>await (0,a.modelInfoCall)(m,u,h,e,t,l,n,o,d,c),enabled:!!(m&&u&&h)})}])},907308,e=>{"use strict";var r=e.i(843476),t=e.i(271645),l=e.i(212931),a=e.i(808613),i=e.i(464571),s=e.i(199133),n=e.i(592968),o=e.i(374009),d=e.i(764205);e.s(["default",0,({isVisible:e,onCancel:c,onSubmit:m,accessToken:u,title:h="Add Team Member",roles:g=[{label:"admin",value:"admin",description:"Admin role. Can create team keys, add members, and manage settings."},{label:"user",value:"user",description:"User role. Can view team info, but not manage it."}],defaultRole:x="user"})=>{let[p]=a.Form.useForm(),[b,_]=(0,t.useState)([]),[f,j]=(0,t.useState)(!1),[v,y]=(0,t.useState)("user_email"),w=async(e,r)=>{if(!e)return void _([]);j(!0);try{let t=new URLSearchParams;if(t.append(r,e),null==u)return;let l=(await (0,d.userFilterUICall)(u,t)).map(e=>({label:"user_email"===r?`${e.user_email}`:`${e.user_id}`,value:"user_email"===r?e.user_email:e.user_id,user:e}));_(l)}catch(e){console.error("Error fetching users:",e)}finally{j(!1)}},C=(0,t.useCallback)((0,o.default)((e,r)=>w(e,r),300),[]),T=(e,r)=>{y(r),C(e,r)},N=(e,r)=>{let t=r.user;p.setFieldsValue({user_email:t.user_email,user_id:t.user_id,role:p.getFieldValue("role")})};return(0,r.jsx)(l.Modal,{title:h,open:e,onCancel:()=>{p.resetFields(),_([]),c()},footer:null,width:800,children:(0,r.jsxs)(a.Form,{form:p,onFinish:m,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",initialValues:{role:x},children:[(0,r.jsx)(a.Form.Item,{label:"Email",name:"user_email",className:"mb-4",children:(0,r.jsx)(s.Select,{showSearch:!0,className:"w-full",placeholder:"Search by email",filterOption:!1,onSearch:e=>T(e,"user_email"),onSelect:(e,r)=>N(e,r),options:"user_email"===v?b:[],loading:f,allowClear:!0})}),(0,r.jsx)("div",{className:"text-center mb-4",children:"OR"}),(0,r.jsx)(a.Form.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,r.jsx)(s.Select,{showSearch:!0,className:"w-full",placeholder:"Search by user ID",filterOption:!1,onSearch:e=>T(e,"user_id"),onSelect:(e,r)=>N(e,r),options:"user_id"===v?b:[],loading:f,allowClear:!0})}),(0,r.jsx)(a.Form.Item,{label:"Member Role",name:"role",className:"mb-4",children:(0,r.jsx)(s.Select,{defaultValue:x,children:g.map(e=>(0,r.jsx)(s.Select.Option,{value:e.value,children:(0,r.jsxs)(n.Tooltip,{title:e.description,children:[(0,r.jsx)("span",{className:"font-medium",children:e.label}),(0,r.jsxs)("span",{className:"ml-2 text-gray-500 text-sm",children:["- ",e.description]})]})},e.value))})}),(0,r.jsx)("div",{className:"text-right mt-4",children:(0,r.jsx)(i.Button,{type:"default",htmlType:"submit",children:"Add Member"})})]})})}])},162386,e=>{"use strict";var r=e.i(843476),t=e.i(625901),l=e.i(109799),a=e.i(785242),i=e.i(738014),s=e.i(199133),n=e.i(981339),o=e.i(592968);let d={label:"All Proxy Models",value:"all-proxy-models"},c={label:"No Default Models",value:"no-default-models"},m=[d,c],u={user:({allProxyModels:e,userModels:r,options:t})=>r&&t?.includeUserModels?r:[],team:({allProxyModels:e,selectedOrganization:r,userModels:t})=>r?r.models.includes(d.value)||0===r.models.length?e:e.filter(e=>r.models.includes(e)):e??[],organization:({allProxyModels:e})=>e,global:({allProxyModels:e})=>e};e.s(["ModelSelect",0,e=>{let{teamID:h,organizationID:g,options:x,context:p,dataTestId:b,value:_=[],onChange:f,style:j}=e,{includeUserModels:v,showAllTeamModelsOption:y,showAllProxyModelsOverride:w,includeSpecialOptions:C}=x||{},{data:T,isLoading:N}=(0,t.useAllProxyModels)(),{data:z,isLoading:k}=(0,a.useTeam)(h),{data:S,isLoading:I}=(0,l.useOrganization)(g),{data:M,isLoading:O}=(0,i.useCurrentUser)(),F=e=>m.some(r=>r.value===e),P=_.some(F),A=S?.models.includes(d.value)||S?.models.length===0;if(N||k||I||O)return(0,r.jsx)(n.Skeleton.Input,{active:!0,block:!0});let{wildcard:D,regular:R}=(e=>{let r=[],t=[];for(let l of e)l.endsWith("/*")?r.push(l):t.push(l);return{wildcard:r,regular:t}})(((e,r,t)=>{let l=Array.from(new Map(e.map(e=>[e.id,e])).values()).map(e=>e.id);if(r.options?.showAllProxyModelsOverride)return l;let a=u[r.context];return a?a({allProxyModels:l,...t,options:r.options}):[]})(T?.data??[],e,{selectedTeam:z,selectedOrganization:S,userModels:M?.models}));return(0,r.jsx)(s.Select,{"data-testid":b,value:_,onChange:e=>{let r=e.filter(F);f(r.length>0?[r[r.length-1]]:e)},style:j,options:[C?{label:(0,r.jsx)("span",{children:"Special Options"}),title:"Special Options",options:[...w||A&&C||"global"===p?[{label:(0,r.jsx)("span",{children:"All Proxy Models"}),value:d.value,disabled:_.length>0&&_.some(e=>F(e)&&e!==d.value),key:d.value}]:[],{label:(0,r.jsx)("span",{children:"No Default Models"}),value:c.value,disabled:_.length>0&&_.some(e=>F(e)&&e!==c.value),key:c.value}]}:[],...D.length>0?[{label:(0,r.jsx)("span",{children:"Wildcard Options"}),title:"Wildcard Options",options:D.map(e=>{let t=e.replace("/*",""),l=t.charAt(0).toUpperCase()+t.slice(1);return{label:(0,r.jsx)("span",{children:`All ${l} models`}),value:e,disabled:P}})}]:[],{label:(0,r.jsx)("span",{children:"Models"}),title:"Models",options:R.map(e=>({label:(0,r.jsx)("span",{children:e}),value:e,disabled:P}))}],mode:"multiple",placeholder:"Select Models",allowClear:!0,maxTagCount:"responsive",maxTagPlaceholder:e=>(0,r.jsx)(o.Tooltip,{styles:{root:{pointerEvents:"none"}},title:e.map(({value:e})=>e).join(", "),children:(0,r.jsxs)("span",{children:["+",e.length," more"]})})})}],162386)},276173,e=>{"use strict";var r=e.i(843476),t=e.i(599724),l=e.i(779241),a=e.i(464571),i=e.i(808613),s=e.i(212931),n=e.i(199133),o=e.i(271645),d=e.i(435451);e.s(["default",0,({visible:e,onCancel:c,onSubmit:m,initialData:u,mode:h,config:g})=>{let x,[p]=i.Form.useForm(),[b,_]=(0,o.useState)(!1);console.log("Initial Data:",u),(0,o.useEffect)(()=>{if(e)if("edit"===h&&u){let e={...u,role:u.role||g.defaultRole,max_budget_in_team:u.max_budget_in_team||null,tpm_limit:u.tpm_limit||null,rpm_limit:u.rpm_limit||null};console.log("Setting form values:",e),p.setFieldsValue(e)}else p.resetFields(),p.setFieldsValue({role:g.defaultRole||g.roleOptions[0]?.value})},[e,u,h,p,g.defaultRole,g.roleOptions]);let f=async e=>{try{_(!0);let r=Object.entries(e).reduce((e,[r,t])=>{if("string"==typeof t){let l=t.trim();return""===l&&("max_budget_in_team"===r||"tpm_limit"===r||"rpm_limit"===r)?{...e,[r]:null}:{...e,[r]:l}}return{...e,[r]:t}},{});console.log("Submitting form data:",r),await Promise.resolve(m(r)),p.resetFields()}catch(e){console.error("Form submission error:",e)}finally{_(!1)}};return(0,r.jsx)(s.Modal,{title:g.title||("add"===h?"Add Member":"Edit Member"),open:e,width:1e3,footer:null,onCancel:c,children:(0,r.jsxs)(i.Form,{form:p,onFinish:f,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[g.showEmail&&(0,r.jsx)(i.Form.Item,{label:"Email",name:"user_email",className:"mb-4",rules:[{type:"email",message:"Please enter a valid email!"}],children:(0,r.jsx)(l.TextInput,{placeholder:"user@example.com"})}),g.showEmail&&g.showUserId&&(0,r.jsx)("div",{className:"text-center mb-4",children:(0,r.jsx)(t.Text,{children:"OR"})}),g.showUserId&&(0,r.jsx)(i.Form.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,r.jsx)(l.TextInput,{placeholder:"user_123"})}),(0,r.jsx)(i.Form.Item,{label:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:"Role"}),"edit"===h&&u&&(0,r.jsxs)("span",{className:"text-gray-500 text-sm",children:["(Current: ",(x=u.role,g.roleOptions.find(e=>e.value===x)?.label||x),")"]})]}),name:"role",className:"mb-4",rules:[{required:!0,message:"Please select a role!"}],children:(0,r.jsx)(n.Select,{children:"edit"===h&&u?[...g.roleOptions.filter(e=>e.value===u.role),...g.roleOptions.filter(e=>e.value!==u.role)].map(e=>(0,r.jsx)(n.Select.Option,{value:e.value,children:e.label},e.value)):g.roleOptions.map(e=>(0,r.jsx)(n.Select.Option,{value:e.value,children:e.label},e.value))})}),g.additionalFields?.map(e=>(0,r.jsx)(i.Form.Item,{label:e.label,name:e.name,className:"mb-4",rules:e.rules,children:(e=>{switch(e.type){case"input":return(0,r.jsx)(l.TextInput,{placeholder:e.placeholder});case"numerical":return(0,r.jsx)(d.default,{step:e.step||1,min:e.min||0,style:{width:"100%"},placeholder:e.placeholder||"Enter a numerical value"});case"select":return(0,r.jsx)(n.Select,{children:e.options?.map(e=>(0,r.jsx)(n.Select.Option,{value:e.value,children:e.label},e.value))});default:return null}})(e)},e.name)),(0,r.jsxs)("div",{className:"text-right mt-6",children:[(0,r.jsx)(a.Button,{onClick:c,className:"mr-2",disabled:b,children:"Cancel"}),(0,r.jsx)(a.Button,{type:"default",htmlType:"submit",loading:b,children:"add"===h?b?"Adding...":"Add Member":b?"Saving...":"Save Changes"})]})]})})}])},294612,e=>{"use strict";var r=e.i(843476),t=e.i(100486),l=e.i(827252),a=e.i(213205),i=e.i(771674),s=e.i(464571),n=e.i(770914),o=e.i(291542),d=e.i(262218),c=e.i(592968),m=e.i(898586),u=e.i(902555);let{Text:h}=m.Typography;function g({members:e,canEdit:m,onEdit:g,onDelete:x,onAddMember:p,roleColumnTitle:b="Role",roleTooltip:_,extraColumns:f=[],showDeleteForMember:j,emptyText:v}){let y=[{title:"User Email",dataIndex:"user_email",key:"user_email",render:e=>(0,r.jsx)(h,{children:e||"-"})},{title:"User ID",dataIndex:"user_id",key:"user_id",render:e=>"default_user_id"===e?(0,r.jsx)(d.Tag,{color:"blue",children:"Default Proxy Admin"}):(0,r.jsx)(h,{children:e||"-"})},{title:_?(0,r.jsxs)(n.Space,{direction:"horizontal",children:[b,(0,r.jsx)(c.Tooltip,{title:_,children:(0,r.jsx)(l.InfoCircleOutlined,{})})]}):b,dataIndex:"role",key:"role",render:e=>(0,r.jsxs)(n.Space,{children:[e?.toLowerCase()==="admin"||e?.toLowerCase()==="org_admin"?(0,r.jsx)(t.CrownOutlined,{}):(0,r.jsx)(i.UserOutlined,{}),(0,r.jsx)(h,{style:{textTransform:"capitalize"},children:e||"-"})]})},...f,{title:"Actions",key:"actions",fixed:"right",width:120,render:(e,t)=>m?(0,r.jsxs)(n.Space,{children:[(0,r.jsx)(u.default,{variant:"Edit",tooltipText:"Edit member",dataTestId:"edit-member",onClick:()=>g(t)}),(!j||j(t))&&(0,r.jsx)(u.default,{variant:"Delete",tooltipText:"Delete member",dataTestId:"delete-member",onClick:()=>x(t)})]}):null}];return(0,r.jsxs)(n.Space,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(o.Table,{columns:y,dataSource:e,rowKey:e=>e.user_id??e.user_email??JSON.stringify(e),pagination:!1,size:"small",scroll:{x:"max-content"},locale:v?{emptyText:v}:void 0}),p&&m&&(0,r.jsx)(s.Button,{icon:(0,r.jsx)(a.UserAddOutlined,{}),type:"primary",onClick:p,children:"Add Member"})]})}e.s(["default",()=>g])},846835,e=>{"use strict";var r=e.i(843476),t=e.i(655913),l=e.i(38419),a=e.i(78334),i=e.i(555436),s=e.i(284614);let n=({filters:e,showFilters:n,onToggleFilters:o,onChange:d,onReset:c})=>{let m=!!(e.org_id||e.org_alias);return(0,r.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,r.jsx)(t.FilterInput,{placeholder:"Search by Organization Name",value:e.org_alias,onChange:e=>d("org_alias",e),icon:i.Search,className:"w-64"}),(0,r.jsx)(l.FiltersButton,{onClick:()=>o(!n),active:n,hasActiveFilters:m}),(0,r.jsx)(a.ResetFiltersButton,{onClick:c})]}),n&&(0,r.jsx)("div",{className:"flex flex-wrap items-center gap-3 mt-3",children:(0,r.jsx)(t.FilterInput,{placeholder:"Search by Organization ID",value:e.org_id,onChange:e=>d("org_id",e),icon:s.User,className:"w-64"})})]})};var o=e.i(827252),d=e.i(871943),c=e.i(502547),m=e.i(278587),u=e.i(389083),h=e.i(994388),g=e.i(304967),x=e.i(309426),p=e.i(350967),b=e.i(752978),_=e.i(197647),f=e.i(653824),j=e.i(269200),v=e.i(942232),y=e.i(977572),w=e.i(427612),C=e.i(64848),T=e.i(496020),N=e.i(881073),z=e.i(404206),k=e.i(723731),S=e.i(599724),I=e.i(779241),M=e.i(808613),O=e.i(311451),F=e.i(212931),P=e.i(199133),A=e.i(592968),D=e.i(271645),R=e.i(500330),L=e.i(127952),E=e.i(902555),B=e.i(355619),U=e.i(75921),q=e.i(162386),Q=e.i(727749),V=e.i(764205),K=e.i(785242),H=e.i(980187),$=e.i(530212),G=e.i(629569),W=e.i(464571),Y=e.i(653496),X=e.i(898586),J=e.i(678784),Z=e.i(118366),ee=e.i(294612),er=e.i(907308),et=e.i(384767),el=e.i(435451),ea=e.i(276173),ei=e.i(916940);let es=({organizationId:e,onClose:t,accessToken:l,is_org_admin:a,is_proxy_admin:i,userModels:s,editOrg:n})=>{let[o,d]=(0,D.useState)(null),[c,m]=(0,D.useState)(!0),[x]=M.Form.useForm(),[b,_]=(0,D.useState)(!1),[f,j]=(0,D.useState)(!1),[v,y]=(0,D.useState)(!1),[w,C]=(0,D.useState)(null),[T,N]=(0,D.useState)({}),[z,k]=(0,D.useState)(!1),F=a||i,{data:A}=(0,K.useTeams)(),L=(0,D.useMemo)(()=>(0,H.createTeamAliasMap)(A),[A]),E=async()=>{try{if(m(!0),!l)return;let r=await (0,V.organizationInfoCall)(l,e);d(r)}catch(e){Q.default.fromBackend("Failed to load organization information"),console.error("Error fetching organization info:",e)}finally{m(!1)}};(0,D.useEffect)(()=>{E()},[e,l]);let B=async r=>{try{if(null==l)return;let t={user_email:r.user_email,user_id:r.user_id,role:r.role};await (0,V.organizationMemberAddCall)(l,e,t),Q.default.success("Organization member added successfully"),j(!1),x.resetFields(),E()}catch(e){Q.default.fromBackend("Failed to add organization member"),console.error("Error adding organization member:",e)}},es=async r=>{try{if(!l)return;let t={user_email:r.user_email,user_id:r.user_id,role:r.role};await (0,V.organizationMemberUpdateCall)(l,e,t),Q.default.success("Organization member updated successfully"),y(!1),x.resetFields(),E()}catch(e){Q.default.fromBackend("Failed to update organization member"),console.error("Error updating organization member:",e)}},en=async r=>{try{if(!l)return;await (0,V.organizationMemberDeleteCall)(l,e,r.user_id),Q.default.success("Organization member deleted successfully"),y(!1),x.resetFields(),E()}catch(e){Q.default.fromBackend("Failed to delete organization member"),console.error("Error deleting organization member:",e)}},eo=async r=>{try{if(!l)return;k(!0);let t={organization_id:e,organization_alias:r.organization_alias,models:r.models,litellm_budget_table:{tpm_limit:r.tpm_limit,rpm_limit:r.rpm_limit,max_budget:r.max_budget,budget_duration:r.budget_duration},metadata:r.metadata?JSON.parse(r.metadata):null};if((void 0!==r.vector_stores||void 0!==r.mcp_servers_and_groups)&&(t.object_permission={...o?.object_permission,vector_stores:r.vector_stores||[]},void 0!==r.mcp_servers_and_groups)){let{servers:e,accessGroups:l}=r.mcp_servers_and_groups||{servers:[],accessGroups:[]};e&&e.length>0&&(t.object_permission.mcp_servers=e),l&&l.length>0&&(t.object_permission.mcp_access_groups=l)}await (0,V.organizationUpdateCall)(l,t),Q.default.success("Organization settings updated successfully"),_(!1),E()}catch(e){Q.default.fromBackend("Failed to update organization settings"),console.error("Error updating organization:",e)}finally{k(!1)}};if(c)return(0,r.jsx)("div",{className:"p-4",children:"Loading..."});if(!o)return(0,r.jsx)("div",{className:"p-4",children:"Organization not found"});let ed=async(e,r)=>{await (0,R.copyToClipboard)(e)&&(N(e=>({...e,[r]:!0})),setTimeout(()=>{N(e=>({...e,[r]:!1}))},2e3))},ec=[{title:"Spend (USD)",key:"spend",render:(e,t)=>{let l=null!=t.user_id?(o.members||[]).find(e=>e.user_id===t.user_id):void 0;return(0,r.jsxs)(X.Typography.Text,{children:["$",(0,R.formatNumberWithCommas)(l?.spend??0,4)]})}},{title:"Created At",key:"created_at",render:(e,t)=>{let l=null!=t.user_id?(o.members||[]).find(e=>e.user_id===t.user_id):void 0;return(0,r.jsx)(X.Typography.Text,{children:l?.created_at?new Date(l.created_at).toLocaleString():"-"})}}];return(0,r.jsxs)("div",{className:"w-full h-screen p-4 bg-white",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(h.Button,{icon:$.ArrowLeftIcon,onClick:t,variant:"light",className:"mb-4",children:"Back to Organizations"}),(0,r.jsx)(G.Title,{children:o.organization_alias}),(0,r.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)(S.Text,{className:"text-gray-500 font-mono",children:o.organization_id}),(0,r.jsx)(W.Button,{type:"text",size:"small",icon:T["org-id"]?(0,r.jsx)(J.CheckIcon,{size:12}):(0,r.jsx)(Z.CopyIcon,{size:12}),onClick:()=>ed(o.organization_id,"org-id"),className:`left-2 z-10 transition-all duration-200 ${T["org-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`})]})]})}),(0,r.jsx)(Y.Tabs,{defaultActiveKey:n?"settings":"overview",className:"mb-4",items:[{key:"overview",label:"Overview",children:(0,r.jsxs)(p.Grid,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,r.jsxs)(g.Card,{children:[(0,r.jsx)(S.Text,{children:"Organization Details"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(S.Text,{children:["Created: ",new Date(o.created_at).toLocaleDateString()]}),(0,r.jsxs)(S.Text,{children:["Updated: ",new Date(o.updated_at).toLocaleDateString()]}),(0,r.jsxs)(S.Text,{children:["Created By: ",o.created_by]})]})]}),(0,r.jsxs)(g.Card,{children:[(0,r.jsx)(S.Text,{children:"Budget Status"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(G.Title,{children:["$",(0,R.formatNumberWithCommas)(o.spend,4)]}),(0,r.jsxs)(S.Text,{children:["of"," ",null===o.litellm_budget_table.max_budget?"Unlimited":`$${(0,R.formatNumberWithCommas)(o.litellm_budget_table.max_budget,4)}`]}),o.litellm_budget_table.budget_duration&&(0,r.jsxs)(S.Text,{className:"text-gray-500",children:["Reset: ",o.litellm_budget_table.budget_duration]})]})]}),(0,r.jsxs)(g.Card,{children:[(0,r.jsx)(S.Text,{children:"Rate Limits"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(S.Text,{children:["TPM: ",o.litellm_budget_table.tpm_limit||"Unlimited"]}),(0,r.jsxs)(S.Text,{children:["RPM: ",o.litellm_budget_table.rpm_limit||"Unlimited"]}),o.litellm_budget_table.max_parallel_requests&&(0,r.jsxs)(S.Text,{children:["Max Parallel Requests: ",o.litellm_budget_table.max_parallel_requests]})]})]}),(0,r.jsxs)(g.Card,{children:[(0,r.jsx)(S.Text,{children:"Models"}),(0,r.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:0===o.models.length?(0,r.jsx)(u.Badge,{color:"red",children:"All proxy models"}):o.models.map((e,t)=>(0,r.jsx)(u.Badge,{color:"red",children:e},t))})]}),(0,r.jsxs)(g.Card,{children:[(0,r.jsx)(S.Text,{children:"Teams"}),(0,r.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:o.teams?.map((e,t)=>(0,r.jsx)(u.Badge,{color:"red",children:L[e.team_id]||e.team_id},t))})]}),(0,r.jsx)(et.default,{objectPermission:o.object_permission,variant:"card",accessToken:l})]})},{key:"members",label:"Members",children:(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(ee.default,{members:(o.members||[]).map(e=>({role:e.user_role||"",user_id:e.user_id,user_email:e.user_email})),canEdit:F,onEdit:e=>{C(e),y(!0)},onDelete:e=>en(e),onAddMember:()=>j(!0),roleColumnTitle:"Organization Role",extraColumns:ec,emptyText:"No members found"})})},{key:"settings",label:"Settings",children:(0,r.jsxs)(g.Card,{className:"overflow-y-auto max-h-[65vh]",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(G.Title,{children:"Organization Settings"}),F&&!b&&(0,r.jsx)(h.Button,{onClick:()=>_(!0),children:"Edit Settings"})]}),b?(0,r.jsxs)(M.Form,{form:x,onFinish:eo,initialValues:{organization_alias:o.organization_alias,models:o.models,tpm_limit:o.litellm_budget_table.tpm_limit,rpm_limit:o.litellm_budget_table.rpm_limit,max_budget:o.litellm_budget_table.max_budget,budget_duration:o.litellm_budget_table.budget_duration,metadata:o.metadata?JSON.stringify(o.metadata,null,2):"",vector_stores:o.object_permission?.vector_stores||[],mcp_servers_and_groups:{servers:o.object_permission?.mcp_servers||[],accessGroups:o.object_permission?.mcp_access_groups||[]}},layout:"vertical",children:[(0,r.jsx)(M.Form.Item,{label:"Organization Name",name:"organization_alias",rules:[{required:!0,message:"Please input an organization name"}],children:(0,r.jsx)(I.TextInput,{})}),(0,r.jsx)(M.Form.Item,{label:"Models",name:"models",children:(0,r.jsx)(q.ModelSelect,{value:x.getFieldValue("models"),onChange:e=>x.setFieldValue("models",e),context:"organization",options:{includeSpecialOptions:!0,showAllProxyModelsOverride:!0}})}),(0,r.jsx)(M.Form.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,r.jsx)(el.default,{step:.01,precision:2,style:{width:"100%"}})}),(0,r.jsx)(M.Form.Item,{label:"Reset Budget",name:"budget_duration",children:(0,r.jsxs)(P.Select,{placeholder:"n/a",children:[(0,r.jsx)(P.Select.Option,{value:"24h",children:"daily"}),(0,r.jsx)(P.Select.Option,{value:"7d",children:"weekly"}),(0,r.jsx)(P.Select.Option,{value:"30d",children:"monthly"})]})}),(0,r.jsx)(M.Form.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,r.jsx)(el.default,{step:1,style:{width:"100%"}})}),(0,r.jsx)(M.Form.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,r.jsx)(el.default,{step:1,style:{width:"100%"}})}),(0,r.jsx)(M.Form.Item,{label:"Vector Stores",name:"vector_stores",children:(0,r.jsx)(ei.default,{onChange:e=>x.setFieldValue("vector_stores",e),value:x.getFieldValue("vector_stores"),accessToken:l||"",placeholder:"Select vector stores"})}),(0,r.jsx)(M.Form.Item,{label:"MCP Servers & Access Groups",name:"mcp_servers_and_groups",children:(0,r.jsx)(U.default,{onChange:e=>x.setFieldValue("mcp_servers_and_groups",e),value:x.getFieldValue("mcp_servers_and_groups"),accessToken:l||"",placeholder:"Select MCP servers and access groups"})}),(0,r.jsx)(M.Form.Item,{label:"Metadata",name:"metadata",children:(0,r.jsx)(O.Input.TextArea,{rows:4})}),(0,r.jsx)("div",{className:"sticky z-10 bg-white p-4 border-t border-gray-200 bottom-[-1.5rem] inset-x-[-1.5rem]",children:(0,r.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,r.jsx)(h.Button,{variant:"secondary",onClick:()=>_(!1),disabled:z,children:"Cancel"}),(0,r.jsx)(h.Button,{type:"submit",loading:z,children:"Save Changes"})]})})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Text,{className:"font-medium",children:"Organization Name"}),(0,r.jsx)("div",{children:o.organization_alias})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Text,{className:"font-medium",children:"Organization ID"}),(0,r.jsx)("div",{className:"font-mono",children:o.organization_id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Text,{className:"font-medium",children:"Created At"}),(0,r.jsx)("div",{children:new Date(o.created_at).toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Text,{className:"font-medium",children:"Models"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:o.models.map((e,t)=>(0,r.jsx)(u.Badge,{color:"red",children:e},t))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Text,{className:"font-medium",children:"Rate Limits"}),(0,r.jsxs)("div",{children:["TPM: ",o.litellm_budget_table.tpm_limit||"Unlimited"]}),(0,r.jsxs)("div",{children:["RPM: ",o.litellm_budget_table.rpm_limit||"Unlimited"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Text,{className:"font-medium",children:"Budget"}),(0,r.jsxs)("div",{children:["Max:"," ",null!==o.litellm_budget_table.max_budget?`$${(0,R.formatNumberWithCommas)(o.litellm_budget_table.max_budget,4)}`:"No Limit"]}),(0,r.jsxs)("div",{children:["Reset: ",o.litellm_budget_table.budget_duration||"Never"]})]}),(0,r.jsx)(et.default,{objectPermission:o.object_permission,variant:"inline",className:"pt-4 border-t border-gray-200",accessToken:l})]})]})}]}),(0,r.jsx)(er.default,{isVisible:f,onCancel:()=>j(!1),onSubmit:B,accessToken:l,title:"Add Organization Member",roles:[{label:"org_admin",value:"org_admin",description:"Can add and remove members, and change their roles."},{label:"internal_user",value:"internal_user",description:"Can view/create keys for themselves within organization."},{label:"internal_user_viewer",value:"internal_user_viewer",description:"Can only view their keys within organization."}],defaultRole:"internal_user"}),(0,r.jsx)(ea.default,{visible:v,onCancel:()=>y(!1),onSubmit:es,initialData:w,mode:"edit",config:{title:"Edit Member",showEmail:!0,showUserId:!0,roleOptions:[{label:"Org Admin",value:"org_admin"},{label:"Internal User",value:"internal_user"},{label:"Internal User Viewer",value:"internal_user_viewer"}]}})]})},en=async(e,r,t=null,l=null)=>{r(await (0,V.organizationListCall)(e,t,l))};e.s(["default",0,({organizations:e,userRole:t,userModels:l,accessToken:a,lastRefreshed:i,handleRefreshClick:s,currentOrg:K,guardrailsList:H=[],setOrganizations:$,premiumUser:G})=>{let[W,Y]=(0,D.useState)(null),[X,J]=(0,D.useState)(!1),[Z,ee]=(0,D.useState)(!1),[er,et]=(0,D.useState)(null),[ea,eo]=(0,D.useState)(!1),[ed,ec]=(0,D.useState)(!1),[em]=M.Form.useForm(),[eu,eh]=(0,D.useState)({}),[eg,ex]=(0,D.useState)(!1),[ep,eb]=(0,D.useState)({org_id:"",org_alias:"",sort_by:"created_at",sort_order:"desc"}),e_=async()=>{if(er&&a)try{eo(!0),await (0,V.organizationDeleteCall)(a,er),Q.default.success("Organization deleted successfully"),ee(!1),et(null),await en(a,$,ep.org_id||null,ep.org_alias||null)}catch(e){console.error("Error deleting organization:",e)}finally{eo(!1)}},ef=async e=>{try{if(!a)return;console.log(`values in organizations new create call: ${JSON.stringify(e)}`),(e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0||e.allowed_mcp_servers_and_groups&&(e.allowed_mcp_servers_and_groups.servers?.length>0||e.allowed_mcp_servers_and_groups.accessGroups?.length>0))&&(e.object_permission={},e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0&&(e.object_permission.vector_stores=e.allowed_vector_store_ids,delete e.allowed_vector_store_ids),e.allowed_mcp_servers_and_groups&&(e.allowed_mcp_servers_and_groups.servers?.length>0&&(e.object_permission.mcp_servers=e.allowed_mcp_servers_and_groups.servers),e.allowed_mcp_servers_and_groups.accessGroups?.length>0&&(e.object_permission.mcp_access_groups=e.allowed_mcp_servers_and_groups.accessGroups),delete e.allowed_mcp_servers_and_groups)),await (0,V.organizationCreateCall)(a,e),Q.default.success("Organization created successfully"),ec(!1),em.resetFields(),en(a,$,ep.org_id||null,ep.org_alias||null)}catch(e){console.error("Error creating organization:",e)}};return G?(0,r.jsxs)("div",{className:"w-full mx-4 h-[75vh]",children:[(0,r.jsx)(p.Grid,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,r.jsxs)(x.Col,{numColSpan:1,className:"flex flex-col gap-2",children:[("Admin"===t||"Org Admin"===t)&&(0,r.jsx)(h.Button,{className:"w-fit",onClick:()=>ec(!0),children:"+ Create New Organization"}),W?(0,r.jsx)(es,{organizationId:W,onClose:()=>{Y(null),J(!1)},accessToken:a,is_org_admin:!0,is_proxy_admin:"Admin"===t,userModels:l,editOrg:X}):(0,r.jsxs)(f.TabGroup,{className:"gap-2 h-[75vh] w-full",children:[(0,r.jsxs)(N.TabList,{className:"flex justify-between mt-2 w-full items-center",children:[(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)(_.Tab,{children:"Your Organizations"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[i&&(0,r.jsxs)(S.Text,{children:["Last Refreshed: ",i]}),(0,r.jsx)(b.Icon,{icon:m.RefreshIcon,variant:"shadow",size:"xs",className:"self-center",onClick:s})]})]}),(0,r.jsx)(k.TabPanels,{children:(0,r.jsxs)(z.TabPanel,{children:[(0,r.jsx)(S.Text,{children:"Click on “Organization ID” to view organization details."}),(0,r.jsx)(p.Grid,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:(0,r.jsx)(x.Col,{numColSpan:1,children:(0,r.jsxs)(g.Card,{className:"w-full mx-auto flex-auto overflow-hidden overflow-y-auto max-h-[50vh]",children:[(0,r.jsx)("div",{className:"border-b px-6 py-4",children:(0,r.jsx)("div",{className:"flex flex-col space-y-4",children:(0,r.jsx)(n,{filters:ep,showFilters:eg,onToggleFilters:ex,onChange:(e,r)=>{let t={...ep,[e]:r};eb(t),a&&(0,V.organizationListCall)(a,t.org_id||null,t.org_alias||null).then(e=>{e&&$(e)}).catch(e=>{console.error("Error fetching organizations:",e)})},onReset:()=>{eb({org_id:"",org_alias:"",sort_by:"created_at",sort_order:"desc"}),a&&(0,V.organizationListCall)(a,null,null).then(e=>{e&&$(e)}).catch(e=>{console.error("Error fetching organizations:",e)})}})})}),(0,r.jsxs)(j.Table,{children:[(0,r.jsx)(w.TableHead,{children:(0,r.jsxs)(T.TableRow,{children:[(0,r.jsx)(C.TableHeaderCell,{children:"Organization ID"}),(0,r.jsx)(C.TableHeaderCell,{children:"Organization Name"}),(0,r.jsx)(C.TableHeaderCell,{children:"Created"}),(0,r.jsx)(C.TableHeaderCell,{children:"Spend (USD)"}),(0,r.jsx)(C.TableHeaderCell,{children:"Budget (USD)"}),(0,r.jsx)(C.TableHeaderCell,{children:"Models"}),(0,r.jsx)(C.TableHeaderCell,{children:"TPM / RPM Limits"}),(0,r.jsx)(C.TableHeaderCell,{children:"Info"}),(0,r.jsx)(C.TableHeaderCell,{children:"Actions"})]})}),(0,r.jsx)(v.TableBody,{children:e&&e.length>0?e.sort((e,r)=>new Date(r.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>(0,r.jsxs)(T.TableRow,{children:[(0,r.jsx)(y.TableCell,{children:(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)(A.Tooltip,{title:e.organization_id,children:(0,r.jsxs)(h.Button,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>Y(e.organization_id),children:[e.organization_id?.slice(0,7),"..."]})})})}),(0,r.jsx)(y.TableCell,{children:e.organization_alias}),(0,r.jsx)(y.TableCell,{children:e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"}),(0,r.jsx)(y.TableCell,{children:(0,R.formatNumberWithCommas)(e.spend,4)}),(0,r.jsx)(y.TableCell,{children:e.litellm_budget_table?.max_budget!==null&&e.litellm_budget_table?.max_budget!==void 0?e.litellm_budget_table?.max_budget:"No limit"}),(0,r.jsx)(y.TableCell,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:e.models.length>3?"px-0":"",children:(0,r.jsx)("div",{className:"flex flex-col",children:Array.isArray(e.models)?(0,r.jsx)("div",{className:"flex flex-col",children:0===e.models.length?(0,r.jsx)(u.Badge,{size:"xs",className:"mb-1",color:"red",children:(0,r.jsx)(S.Text,{children:"All Proxy Models"})}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex items-start",children:[e.models.length>3&&(0,r.jsx)("div",{children:(0,r.jsx)(b.Icon,{icon:eu[e.organization_id||""]?d.ChevronDownIcon:c.ChevronRightIcon,className:"cursor-pointer",size:"xs",onClick:()=>{eh(r=>({...r,[e.organization_id||""]:!r[e.organization_id||""]}))}})}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.models.slice(0,3).map((e,t)=>"all-proxy-models"===e?(0,r.jsx)(u.Badge,{size:"xs",color:"red",children:(0,r.jsx)(S.Text,{children:"All Proxy Models"})},t):(0,r.jsx)(u.Badge,{size:"xs",color:"blue",children:(0,r.jsx)(S.Text,{children:e.length>30?`${(0,B.getModelDisplayName)(e).slice(0,30)}...`:(0,B.getModelDisplayName)(e)})},t)),e.models.length>3&&!eu[e.organization_id||""]&&(0,r.jsx)(u.Badge,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,r.jsxs)(S.Text,{children:["+",e.models.length-3," ",e.models.length-3==1?"more model":"more models"]})}),eu[e.organization_id||""]&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:e.models.slice(3).map((e,t)=>"all-proxy-models"===e?(0,r.jsx)(u.Badge,{size:"xs",color:"red",children:(0,r.jsx)(S.Text,{children:"All Proxy Models"})},t+3):(0,r.jsx)(u.Badge,{size:"xs",color:"blue",children:(0,r.jsx)(S.Text,{children:e.length>30?`${(0,B.getModelDisplayName)(e).slice(0,30)}...`:(0,B.getModelDisplayName)(e)})},t+3))})]})]})})}):null})}),(0,r.jsx)(y.TableCell,{children:(0,r.jsxs)(S.Text,{children:["TPM:"," ",e.litellm_budget_table?.tpm_limit?e.litellm_budget_table?.tpm_limit:"Unlimited",(0,r.jsx)("br",{}),"RPM:"," ",e.litellm_budget_table?.rpm_limit?e.litellm_budget_table?.rpm_limit:"Unlimited"]})}),(0,r.jsx)(y.TableCell,{children:(0,r.jsxs)(S.Text,{children:[e.members?.length||0," Members"]})}),(0,r.jsx)(y.TableCell,{children:"Admin"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.default,{variant:"Edit",tooltipText:"Edit organization",onClick:()=>{Y(e.organization_id),J(!0)}}),(0,r.jsx)(E.default,{variant:"Delete",tooltipText:"Delete organization",onClick:()=>{var r;(r=e.organization_id)&&(et(r),ee(!0))}})]})})]},e.organization_id)):null})]})]})})})]})})]})]})}),(0,r.jsx)(F.Modal,{title:"Create Organization",visible:ed,width:800,footer:null,onCancel:()=>{ec(!1),em.resetFields()},children:(0,r.jsxs)(M.Form,{form:em,onFinish:ef,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsx)(M.Form.Item,{label:"Organization Name",name:"organization_alias",rules:[{required:!0,message:"Please input an organization name"}],children:(0,r.jsx)(I.TextInput,{placeholder:""})}),(0,r.jsx)(M.Form.Item,{label:"Models",name:"models",children:(0,r.jsx)(q.ModelSelect,{options:{showAllProxyModelsOverride:!0,includeSpecialOptions:!0},value:em.getFieldValue("models"),onChange:e=>em.setFieldValue("models",e),context:"organization"})}),(0,r.jsx)(M.Form.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,r.jsx)(el.default,{step:.01,precision:2,width:200})}),(0,r.jsx)(M.Form.Item,{label:"Reset Budget",name:"budget_duration",children:(0,r.jsxs)(P.Select,{defaultValue:null,placeholder:"n/a",children:[(0,r.jsx)(P.Select.Option,{value:"24h",children:"daily"}),(0,r.jsx)(P.Select.Option,{value:"7d",children:"weekly"}),(0,r.jsx)(P.Select.Option,{value:"30d",children:"monthly"})]})}),(0,r.jsx)(M.Form.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,r.jsx)(el.default,{step:1,width:400})}),(0,r.jsx)(M.Form.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,r.jsx)(el.default,{step:1,width:400})}),(0,r.jsx)(M.Form.Item,{label:(0,r.jsxs)("span",{children:["Allowed Vector Stores"," ",(0,r.jsx)(A.Tooltip,{title:"Select which vector stores this organization can access by default. Leave empty for access to all vector stores",children:(0,r.jsx)(o.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-4",help:"Select vector stores this organization can access. Leave empty for access to all vector stores",children:(0,r.jsx)(ei.default,{onChange:e=>em.setFieldValue("allowed_vector_store_ids",e),value:em.getFieldValue("allowed_vector_store_ids"),accessToken:a||"",placeholder:"Select vector stores (optional)"})}),(0,r.jsx)(M.Form.Item,{label:(0,r.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,r.jsx)(A.Tooltip,{title:"Select which MCP servers and access groups this organization can access by default.",children:(0,r.jsx)(o.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_servers_and_groups",className:"mt-4",help:"Select MCP servers and access groups this organization can access.",children:(0,r.jsx)(U.default,{onChange:e=>em.setFieldValue("allowed_mcp_servers_and_groups",e),value:em.getFieldValue("allowed_mcp_servers_and_groups"),accessToken:a||"",placeholder:"Select MCP servers and access groups (optional)"})}),(0,r.jsx)(M.Form.Item,{label:"Metadata",name:"metadata",children:(0,r.jsx)(O.Input.TextArea,{rows:4})}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(h.Button,{type:"submit",children:"Create Organization"})})]})}),(0,r.jsx)(L.default,{isOpen:Z,title:"Delete Organization?",message:"Are you sure you want to delete this organization? This action cannot be undone.",resourceInformationTitle:"Organization Information",resourceInformation:[{label:"Organization ID",value:er,code:!0}],onCancel:()=>{ee(!1),et(null)},onOk:e_,confirmLoading:ea})]}):(0,r.jsx)("div",{children:(0,r.jsxs)(S.Text,{children:["This is a LiteLLM Enterprise feature, and requires a valid key to use. Get a trial key"," ",(0,r.jsx)("a",{href:"https://www.litellm.ai/#pricing",target:"_blank",rel:"noopener noreferrer",children:"here"}),"."]})})},"fetchOrganizations",0,en],846835)}]);