(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{20661:function(e,t,l){Promise.resolve().then(l.bind(l,72729))},72729:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return eU}});var s=l(3827),r=l(64090),a=l(47907),n=l(8792),o=l(40491),i=l(65270),c=e=>{let{userID:t,userRole:l,userEmail:r,showSSOBanner:a}=e;console.log("User ID:",t),console.log("userEmail:",r);let c=[{key:"1",label:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["Role: ",l]}),(0,s.jsxs)("p",{children:["ID: ",t]})]})}];return(0,s.jsxs)("nav",{className:"left-0 right-0 top-0 flex justify-between items-center h-12 mb-4",children:[(0,s.jsx)("div",{className:"text-left my-2 absolute top-0 left-0",children:(0,s.jsx)("div",{className:"flex flex-col items-center",children:(0,s.jsx)(n.default,{href:"/",children:(0,s.jsx)("button",{className:"text-gray-800 text-2xl py-1 rounded text-center",children:(0,s.jsx)("img",{src:"/get_image",width:200,height:200,alt:"LiteLLM Brand",className:"mr-2"})})})})}),(0,s.jsxs)("div",{className:"text-right mx-4 my-2 absolute top-0 right-0 flex items-center justify-end space-x-2",children:[a?(0,s.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/ui#setup-ssoauth-for-ui",target:"_blank",className:"mr-2"}):null,(0,s.jsx)("div",{style:{border:"1px solid #391085",padding:"6px",borderRadius:"8px"},children:(0,s.jsx)(o.Z,{menu:{items:c},children:(0,s.jsx)(i.Z,{children:r})})})]})]})},d=l(80588);let m=async(e,t,l)=>{try{if(console.log("Form Values in keyCreateCall:",l),l.description&&(l.metadata||(l.metadata={}),l.metadata.description=l.description,delete l.description,l.metadata=JSON.stringify(l.metadata)),l.metadata){console.log("formValues.metadata:",l.metadata);try{l.metadata=JSON.parse(l.metadata)}catch(e){throw d.ZP.error("Failed to parse metadata: "+e),Error("Failed to parse metadata: "+e)}}console.log("Form Values after check:",l);let s=await fetch("/key/generate",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({user_id:t,...l})});if(!s.ok){let e=await s.text();throw d.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let r=await s.json();return console.log("API Response:",r),r}catch(e){throw console.error("Failed to create key:",e),e}},h=async(e,t,l)=>{try{if(console.log("Form Values in keyCreateCall:",l),l.description&&(l.metadata||(l.metadata={}),l.metadata.description=l.description,delete l.description,l.metadata=JSON.stringify(l.metadata)),l.metadata){console.log("formValues.metadata:",l.metadata);try{l.metadata=JSON.parse(l.metadata)}catch(e){throw d.ZP.error("Failed to parse metadata: "+e),Error("Failed to parse metadata: "+e)}}console.log("Form Values after check:",l);let s=await fetch("/user/new",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({user_id:t,...l})});if(!s.ok){let e=await s.text();throw d.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let r=await s.json();return console.log("API Response:",r),r}catch(e){throw console.error("Failed to create key:",e),e}},u=async(e,t)=>{try{console.log("in keyDeleteCall:",t);let l=await fetch("/key/delete",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({keys:[t]})});if(!l.ok){let e=await l.text();throw d.ZP.error("Failed to delete key: "+e),Error("Network response was not ok")}let s=await l.json();return console.log(s),s}catch(e){throw console.error("Failed to create key:",e),e}},x=async function(e,t,l){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{let r="/user/info";"App Owner"==l&&t&&(r="".concat(r,"?user_id=").concat(t)),console.log("in userInfoCall viewAll=",s),s&&(r="".concat(r,"?view_all=true"));let a=await fetch(r,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok){let e=await a.text();throw d.ZP.error(e),Error("Network response was not ok")}let n=await a.json();return console.log("API Response:",n),n}catch(e){throw console.error("Failed to create key:",e),e}},p=async e=>{try{let t=await fetch("/global/spend",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw d.ZP.error(e),Error("Network response was not ok")}return await t.json()}catch(e){throw console.error("Failed to create key:",e),e}},j=async(e,t,l)=>{try{let t=await fetch("/v2/model/info",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw d.ZP.error(e),Error("Network response was not ok")}return await t.json()}catch(e){throw console.error("Failed to create key:",e),e}},g=async(e,t,l)=>{try{let t=await fetch("/model/metrics",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw d.ZP.error(e),Error("Network response was not ok")}return await t.json()}catch(e){throw console.error("Failed to create key:",e),e}},y=async(e,t,l)=>{try{let t=await fetch("/models",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw d.ZP.error(e),Error("Network response was not ok")}return await t.json()}catch(e){throw console.error("Failed to create key:",e),e}},w=async(e,t)=>{try{let l="/global/spend/logs";console.log("in keySpendLogsCall:",l);let s=await fetch("".concat(l,"?api_key=").concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok){let e=await s.text();throw d.ZP.error(e),Error("Network response was not ok")}let r=await s.json();return console.log(r),r}catch(e){throw console.error("Failed to create key:",e),e}},Z=async e=>{try{let t="/global/spend/teams";console.log("in teamSpendLogsCall:",t);let l=await fetch("".concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!l.ok){let e=await l.text();throw d.ZP.error(e),Error("Network response was not ok")}let s=await l.json();return console.log(s),s}catch(e){throw console.error("Failed to create key:",e),e}},f=async(e,t,l,s,r,a)=>{try{console.log("user role in spend logs call: ".concat(l));let t="/spend/logs";t="App Owner"==l?"".concat(t,"?user_id=").concat(s,"&start_date=").concat(r,"&end_date=").concat(a):"".concat(t,"?start_date=").concat(r,"&end_date=").concat(a);let n=await fetch(t,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!n.ok){let e=await n.text();throw d.ZP.error(e),Error("Network response was not ok")}let o=await n.json();return console.log(o),o}catch(e){throw console.error("Failed to create key:",e),e}},k=async e=>{try{let t=await fetch("/global/spend/logs",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw d.ZP.error(e),Error("Network response was not ok")}let l=await t.json();return console.log(l),l}catch(e){throw console.error("Failed to create key:",e),e}},_=async e=>{try{let t=await fetch("/global/spend/keys?limit=5",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw d.ZP.error(e),Error("Network response was not ok")}let l=await t.json();return console.log(l),l}catch(e){throw console.error("Failed to create key:",e),e}},b=async(e,t)=>{try{t&&JSON.stringify({api_key:t});let l={method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}};t&&(l.body=JSON.stringify({api_key:t}));let s=await fetch("/global/spend/end_users",l);if(!s.ok){let e=await s.text();throw d.ZP.error(e),Error("Network response was not ok")}let r=await s.json();return console.log(r),r}catch(e){throw console.error("Failed to create key:",e),e}},v=async e=>{try{let t=await fetch("/global/spend/models?limit=5",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw d.ZP.error(e),Error("Network response was not ok")}let l=await t.json();return console.log(l),l}catch(e){throw console.error("Failed to create key:",e),e}},S=async(e,t)=>{try{let l=await fetch("/v2/key/info",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({keys:t})});if(!l.ok){let e=await l.text();throw d.ZP.error(e),Error("Network response was not ok")}let s=await l.json();return console.log(s),s}catch(e){throw console.error("Failed to create key:",e),e}},N=async(e,t,l,s)=>{try{let r=await fetch("/user/request_model",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({models:[t],user_id:l,justification:s})});if(!r.ok){let e=await r.text();throw d.ZP.error("Failed to delete key: "+e),Error("Network response was not ok")}let a=await r.json();return console.log(a),a}catch(e){throw console.error("Failed to create key:",e),e}},A=async e=>{try{let t="/user/get_requests";console.log("in userGetRequesedtModelsCall:",t);let l=await fetch(t,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!l.ok){let e=await l.text();throw d.ZP.error("Failed to delete key: "+e),Error("Network response was not ok")}let s=await l.json();return console.log(s),s}catch(e){throw console.error("Failed to get requested models:",e),e}},C=async(e,t)=>{try{let l="/user/get_users?role=".concat(t);console.log("in userGetAllUsersCall:",l);let s=await fetch(l,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok){let e=await s.text();throw d.ZP.error("Failed to delete key: "+e),Error("Network response was not ok")}let r=await s.json();return console.log(r),r}catch(e){throw console.error("Failed to get requested models:",e),e}},T=async(e,t)=>{try{console.log("Form Values in teamCreateCall:",t);let l=await fetch("/team/new",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({...t})});if(!l.ok){let e=await l.text();throw d.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let s=await l.json();return console.log("API Response:",s),s}catch(e){throw console.error("Failed to create key:",e),e}},I=async(e,t,l)=>{try{console.log("Form Values in teamMemberAddCall:",l);let s=await fetch("/team/member_add",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({team_id:t,member:l})});if(!s.ok){let e=await s.text();throw d.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let r=await s.json();return console.log("API Response:",r),r}catch(e){throw console.error("Failed to create key:",e),e}},P=async(e,t)=>{try{console.log("Form Values in userUpdateUserCall:",t);let l=await fetch("/user/update",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({user_role:"proxy_admin_viewer",...t})});if(!l.ok){let e=await l.text();throw d.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let s=await l.json();return console.log("API Response:",s),s}catch(e){throw console.error("Failed to create key:",e),e}},E=async(e,t)=>{try{let l=await fetch("/global/predict/spend/logs",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({data:t})});if(!l.ok){let e=await l.text();throw d.ZP.error(e),Error("Network response was not ok")}let s=await l.json();return console.log(s),s}catch(e){throw console.error("Failed to create key:",e),e}},F=async e=>{try{console.log("Checking Slack Budget Alerts service health");let t=await fetch("/health/services?service=slack_budget_alerts",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw d.ZP.error("Failed Slack Alert test: "+e),Error(e)}let l=await t.json();return d.ZP.success("Test Slack Alert worked - check your Slack!"),console.log("Service Health Response:",l),l}catch(e){throw console.error("Failed to perform health check:",e),e}};var M=l(10384),R=l(46453),O=l(42440),D=l(2179),U=l(13810),B=l(71801),L=l(50670),z=l(12143),K=l(77171),W=l(42539),q=l(88707),V=l(1861);let{Option:G}=L.default;var J=e=>{let{userID:t,team:l,userRole:a,accessToken:n,data:o,setData:i}=e,[c]=z.Z.useForm(),[h,u]=(0,r.useState)(!1),[x,p]=(0,r.useState)(null),[j,g]=(0,r.useState)(null),[w,Z]=(0,r.useState)([]),f=()=>{u(!1),c.resetFields()},k=()=>{u(!1),p(null),c.resetFields()};(0,r.useEffect)(()=>{(async()=>{try{if(null===t||null===a)return;if(null!==n){let e=(await y(n,t,a)).data.map(e=>e.id);console.log("available_model_names:",e),Z(e)}}catch(e){console.error("Error fetching user models:",e)}})()},[n,t,a]);let _=async e=>{try{d.ZP.info("Making API Call"),u(!0);let l=await m(n,t,e);console.log("key create Response:",l),i(e=>e?[...e,l]:[l]),p(l.key),g(l.soft_budget),d.ZP.success("API Key Created"),c.resetFields(),localStorage.removeItem("userData"+t)}catch(e){console.error("Error creating the key:",e)}},b=async()=>{try{console.log("Sending Slack alert...");let e=await F(n);console.log("slackBudgetAlertsHealthCheck Response:",e),console.log("Testing Slack alert successful")}catch(e){console.error("Error sending Slack alert:",e)}};return(0,s.jsxs)("div",{children:[(0,s.jsx)(D.Z,{className:"mx-auto",onClick:()=>u(!0),children:"+ Create New Key"}),(0,s.jsx)(K.Z,{title:"Create Key",visible:h,width:800,footer:null,onOk:f,onCancel:k,children:(0,s.jsxs)(z.Z,{form:c,onFinish:_,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:["App Owner"===a||"Admin"===a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.Z.Item,{label:"Key Name",name:"key_alias",rules:[{required:!0,message:"Please input a key name"}],help:"required",children:(0,s.jsx)(W.Z,{})}),(0,s.jsx)(z.Z.Item,{label:"Team ID",name:"team_id",initialValue:l?l.team_id:null,valuePropName:"team_id",className:"mt-8",children:(0,s.jsx)(W.Z,{value:l?l.team_alias:"",disabled:!0})}),(0,s.jsx)(z.Z.Item,{label:"Models",name:"models",children:(0,s.jsx)(L.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:l&&l.models?l.models.map(e=>(0,s.jsx)(G,{value:e,children:e},e)):w.map(e=>(0,s.jsx)(G,{value:e,children:e},e))})}),(0,s.jsx)(z.Z.Item,{className:"mt-8",label:"Max Budget (USD)",name:"max_budget",help:"Budget cannot exceed team max budget: $".concat((null==l?void 0:l.max_budget)!==null&&(null==l?void 0:l.max_budget)!==void 0?null==l?void 0:l.max_budget:"unlimited"),rules:[{validator:async(e,t)=>{if(t&&l&&null!==l.max_budget&&t>l.max_budget)throw Error("Budget cannot exceed team max budget: $".concat(l.max_budget))}}],children:(0,s.jsx)(q.Z,{step:.01,precision:2,width:200})}),(0,s.jsx)(z.Z.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",help:"Team Reset Budget: ".concat((null==l?void 0:l.budget_duration)!==null&&(null==l?void 0:l.budget_duration)!==void 0?null==l?void 0:l.budget_duration:"None"),children:(0,s.jsxs)(L.default,{defaultValue:null,placeholder:"n/a",children:[(0,s.jsx)(L.default.Option,{value:"24h",children:"daily"}),(0,s.jsx)(L.default.Option,{value:"30d",children:"monthly"})]})}),(0,s.jsx)(z.Z.Item,{className:"mt-8",label:"Tokens per minute Limit (TPM)",name:"tpm_limit",help:"TPM cannot exceed team TPM limit: ".concat((null==l?void 0:l.tpm_limit)!==null&&(null==l?void 0:l.tpm_limit)!==void 0?null==l?void 0:l.tpm_limit:"unlimited"),rules:[{validator:async(e,t)=>{if(t&&l&&null!==l.tpm_limit&&t>l.tpm_limit)throw Error("TPM limit cannot exceed team TPM limit: ".concat(l.tpm_limit))}}],children:(0,s.jsx)(q.Z,{step:1,width:400})}),(0,s.jsx)(z.Z.Item,{className:"mt-8",label:"Requests per minute Limit (RPM)",name:"rpm_limit",help:"RPM cannot exceed team RPM limit: ".concat((null==l?void 0:l.rpm_limit)!==null&&(null==l?void 0:l.rpm_limit)!==void 0?null==l?void 0:l.rpm_limit:"unlimited"),rules:[{validator:async(e,t)=>{if(t&&l&&null!==l.rpm_limit&&t>l.rpm_limit)throw Error("RPM limit cannot exceed team RPM limit: ".concat(l.rpm_limit))}}],children:(0,s.jsx)(q.Z,{step:1,width:400})}),(0,s.jsx)(z.Z.Item,{label:"Expire Key (eg: 30s, 30h, 30d)",name:"duration",className:"mt-8",children:(0,s.jsx)(W.Z,{})}),(0,s.jsx)(z.Z.Item,{label:"Metadata",name:"metadata",children:(0,s.jsx)(W.Z.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.Z.Item,{label:"Key Name",name:"key_alias",children:(0,s.jsx)(W.Z,{})}),(0,s.jsx)(z.Z.Item,{label:"Team ID (Contact Group)",name:"team_id",children:(0,s.jsx)(W.Z,{placeholder:"default team (create a new team)"})}),(0,s.jsx)(z.Z.Item,{label:"Description",name:"description",children:(0,s.jsx)(W.Z.TextArea,{placeholder:"Enter description",rows:4})})]}),(0,s.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,s.jsx)(V.ZP,{htmlType:"submit",children:"Create Key"})})]})}),x&&(0,s.jsx)(K.Z,{visible:h,onOk:f,onCancel:k,footer:null,children:(0,s.jsx)(R.Z,{numItems:1,className:"gap-2 w-full",children:(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(O.Z,{children:"Save your Key"}),(0,s.jsx)(M.Z,{numColSpan:1,children:(0,s.jsxs)("p",{children:["Please save this secret key somewhere safe and accessible. For security reasons, ",(0,s.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,s.jsx)(M.Z,{numColSpan:1,children:null!=x?(0,s.jsxs)("div",{children:[(0,s.jsxs)(B.Z,{children:["API Key: ",x]}),(0,s.jsx)(O.Z,{className:"mt-6",children:"Budgets"}),(0,s.jsxs)(B.Z,{children:["Soft Limit Budget: $",j]}),(0,s.jsx)(D.Z,{className:"mt-3",onClick:b,children:"Test Slack Alert"}),(0,s.jsxs)(B.Z,{className:"mt-2",children:["(LiteLLM Docs -",(0,s.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/alerting",target:"_blank",className:"text-blue-500",children:"Set Up Slack Alerting)"})]})]}):(0,s.jsx)(B.Z,{children:"Key being created, this might take 30s"})})]})})})]})},$=l(33393),H=l(5),Y=l(61244),X=l(10827),Q=l(3851),ee=l(2044),et=l(64167),el=l(74480),es=l(7178),er=l(9853),ea=l(56863),en=e=>{let{token:t,accessToken:l,keySpend:a,keyBudget:n,keyName:o}=e,[i,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(null),[h,u]=(0,r.useState)(""),[x,p]=(0,r.useState)(null),j=async()=>{try{if(null==l||null==t)return;console.log("accessToken: ".concat(l,"; token: ").concat(t));let e=await w(l,t);console.log("Response:",e),m(e);let s=await E(l,e);console.log("Response2:",s);let r=[...e,...s.response];m(r),u(s.predicted_spend),console.log("Combined Data:",r)}catch(e){console.error("There was an error fetching the data",e)}};return t?(0,s.jsxs)("div",{children:[(0,s.jsx)(D.Z,{size:"xs",onClick:()=>{console.log("Show Modal triggered"),c(!0),j()},variant:"secondary",children:"Spend Report"}),(0,s.jsxs)(K.Z,{visible:i,width:1400,onOk:()=>{c(!1)},onCancel:()=>{c(!1)},footer:null,children:[(0,s.jsxs)(O.Z,{style:{textAlign:"left"},children:["Key Name: ",o]}),(0,s.jsxs)(ea.Z,{children:["Monthly Spend $",a]}),(0,s.jsx)(O.Z,{children:h}),(0,s.jsx)(U.Z,{className:"mt-6 mb-6",children:d&&(0,s.jsx)(er.Z,{className:"mt-6",data:d,colors:["blue","amber"],index:"date",categories:["spend","predicted_spend"],yAxisWidth:80})})]})]}):null},eo=e=>{let{userID:t,accessToken:l,data:a,setData:n}=e,[o,i]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[m,h]=(0,r.useState)(null),x=async e=>{null!=a&&(h(e),localStorage.removeItem("userData"+t),d(!0))},p=async()=>{if(null!=m&&null!=a){try{await u(l,m);let e=a.filter(e=>e.token!==m);n(e)}catch(e){console.error("Error deleting the key:",e)}d(!1),h(null)}};if(null!=a)return console.log("RERENDER TRIGGERED"),(0,s.jsx)("div",{children:(0,s.jsxs)(U.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh] mb-4 mt-2",children:[(0,s.jsxs)(X.Z,{className:"mt-5",children:[(0,s.jsx)(et.Z,{children:(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(el.Z,{children:"Key Alias"}),(0,s.jsx)(el.Z,{children:"Secret Key"}),(0,s.jsx)(el.Z,{children:"Spend (USD)"}),(0,s.jsx)(el.Z,{children:"Budget (USD)"}),(0,s.jsx)(el.Z,{children:"Spend Report"}),(0,s.jsx)(el.Z,{children:"Team"}),(0,s.jsx)(el.Z,{children:"Metadata"}),(0,s.jsx)(el.Z,{children:"Models"}),(0,s.jsx)(el.Z,{children:"TPM / RPM Limits"}),(0,s.jsx)(el.Z,{children:"Expires"})]})}),(0,s.jsx)(Q.Z,{children:a.map(e=>(console.log(e),"litellm-dashboard"===e.team_id)?null:(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(ee.Z,{style:{maxWidth:"2px",whiteSpace:"pre-wrap",overflow:"hidden"},children:null!=e.key_alias?(0,s.jsx)(B.Z,{children:e.key_alias}):(0,s.jsx)(B.Z,{children:"Not Set"})}),(0,s.jsx)(ee.Z,{style:{maxWidth:"2px",whiteSpace:"pre-wrap",overflow:"hidden"},children:(0,s.jsx)(B.Z,{children:e.key_name})}),(0,s.jsx)(ee.Z,{style:{maxWidth:"2px",whiteSpace:"pre-wrap",overflow:"hidden"},children:(0,s.jsx)(B.Z,{children:(()=>{try{return parseFloat(e.spend).toFixed(4)}catch(t){return e.spend}})()})}),(0,s.jsx)(ee.Z,{style:{maxWidth:"2px",whiteSpace:"pre-wrap",overflow:"hidden"},children:null!=e.max_budget?(0,s.jsx)(B.Z,{children:e.max_budget}):(0,s.jsx)(B.Z,{children:"Unlimited"})}),(0,s.jsx)(ee.Z,{style:{maxWidth:"2px"},children:(0,s.jsx)(en,{token:e.token,accessToken:l,keySpend:e.spend,keyBudget:e.max_budget,keyName:e.key_name})}),(0,s.jsx)(ee.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:(0,s.jsx)(B.Z,{children:e.team_alias&&"None"!=e.team_alias?e.team_alias:e.team_id})}),(0,s.jsx)(ee.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:(0,s.jsx)(B.Z,{children:JSON.stringify(e.metadata).slice(0,400)})}),(0,s.jsx)(ee.Z,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},children:Array.isArray(e.models)?(0,s.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:e.models.map((e,t)=>(0,s.jsx)(H.Z,{size:"xs",className:"mb-1",color:"blue",children:e.length>30?"".concat(e.slice(0,30),"..."):e},t))}):null}),(0,s.jsx)(ee.Z,{style:{maxWidth:"2px",overflowWrap:"break-word"},children:(0,s.jsxs)(B.Z,{children:["TPM: ",e.tpm_limit?e.tpm_limit:"Unlimited"," ",(0,s.jsx)("br",{})," RPM:"," ",e.rpm_limit?e.rpm_limit:"Unlimited"]})}),(0,s.jsx)(ee.Z,{style:{maxWidth:"2px",wordWrap:"break-word"},children:null!=e.expires?(0,s.jsx)(B.Z,{children:e.expires}):(0,s.jsx)(B.Z,{children:"Never"})}),(0,s.jsx)(ee.Z,{style:{maxWidth:"2px",wordWrap:"break-word"},children:(0,s.jsx)(Y.Z,{onClick:()=>x(e.token),icon:$.Z,size:"sm"})})]},e.token))})]}),c&&(0,s.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,s.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,s.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,s.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,s.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,s.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,s.jsx)("div",{className:"sm:flex sm:items-start",children:(0,s.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,s.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Key"}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this key ?"})})]})})}),(0,s.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,s.jsx)(D.Z,{onClick:p,color:"red",className:"ml-2",children:"Delete"}),(0,s.jsx)(D.Z,{onClick:()=>{d(!1),h(null)},children:"Cancel"})]})]})]})})]})})},ei=l(88117),ec=e=>{let{userID:t,userSpendData:l,userRole:a,accessToken:n}=e,[o,i]=(0,r.useState)(null==l?void 0:l.spend),[c,d]=(0,r.useState)((null==l?void 0:l.max_budget)||null);(0,r.useEffect)(()=>{(async()=>{if("Admin"===a)try{let e=await p(n);i(e.spend),d(e.max_budget||null)}catch(e){console.error("Error fetching global spend data:",e)}})()},[a,n]);let m=void 0!==o?o.toFixed(4):null;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ei.Z,{title:"Total Spend",value:null!==m?m:0})," / ",null!==c?"$".concat(c," limit"):"No limit"]})},ed=l(68967),em=l(27166),eh=e=>{let{teams:t,setSelectedTeam:l}=e,[a,n]=(0,r.useState)("");return(0,s.jsxs)("div",{className:"mt-5 mb-5",children:[(0,s.jsx)(O.Z,{children:"Select Team"}),(0,s.jsx)(B.Z,{children:"If you belong to multiple teams, this setting controls which team is used by default when creating new API Keys."}),t&&t.length>0?(0,s.jsx)(ed.Z,{defaultValue:"0",children:t.map((e,t)=>(0,s.jsx)(em.Z,{value:String(t),onClick:()=>l(e),children:e.team_alias},t))}):(0,s.jsxs)(B.Z,{children:["No team created. ",(0,s.jsx)("b",{children:"Defaulting to personal account."})]})]})},eu=l(37963),ex=l(36083);console.log("isLocal:",!1);var ep=e=>{let{userID:t,userRole:l,teams:n,keys:o,setUserRole:i,userEmail:c,setUserEmail:d,setTeams:m,setKeys:h}=e,[u,j]=(0,r.useState)(null),g=(0,a.useSearchParams)();g.get("viewSpend"),(0,a.useRouter)();let w=g.get("token"),[Z,f]=(0,r.useState)(null),[k,_]=(0,r.useState)([]),[b,v]=(0,r.useState)(n?n[0]:null);if(window.addEventListener("beforeunload",function(){sessionStorage.clear()}),(0,r.useEffect)(()=>{if(w){let e=(0,eu.o)(w);if(e){if(console.log("Decoded token:",e),console.log("Decoded key:",e.key),f(e.key),e.user_role){let t=function(e){if(!e)return"Undefined Role";switch(console.log("Received user role: ".concat(e)),e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"app_user":return"App User";default:return"Unknown Role"}}(e.user_role);console.log("Decoded user_role:",t),i(t)}else console.log("User role not defined");e.user_email?d(e.user_email):console.log("User Email is not set ".concat(e))}}if(t&&Z&&l&&!o&&!u){let e=sessionStorage.getItem("userModels"+t);e?_(JSON.parse(e)):(async()=>{try{let e=await x(Z,t,l);if(console.log("received teams in user dashboard: ".concat(Object.keys(e),"; team values: ").concat(Object.entries(e.teams))),"Admin"==l){let e=await p(Z);j(e),console.log("globalSpend:",e)}else j(e.user_info);h(e.keys),m(e.teams),v(e.teams?e.teams[0]:null),sessionStorage.setItem("userData"+t,JSON.stringify(e.keys)),sessionStorage.setItem("userSpendData"+t,JSON.stringify(e.user_info));let s=(await y(Z,t,l)).data.map(e=>e.id);console.log("available_model_names:",s),_(s),console.log("userModels:",k),sessionStorage.setItem("userModels"+t,JSON.stringify(s))}catch(e){console.error("There was an error fetching the data",e)}})()}},[t,w,Z,o,l]),null==t||null==w){let e="/sso/key/generate";return console.log("Full URL:",e),window.location.href=e,null}if(null==Z)return null;if(null==l&&i("App Owner"),l&&"Admin Viewer"==l){let{Title:e,Paragraph:t}=ex.default;return(0,s.jsxs)("div",{children:[(0,s.jsx)(e,{level:1,children:"Access Denied"}),(0,s.jsx)(t,{children:"Ask your proxy admin for access to create keys"})]})}return console.log("inside user dashboard, selected team",b),(0,s.jsx)("div",{className:"w-full mx-4",children:(0,s.jsx)(R.Z,{numItems:1,className:"gap-2 p-8 h-[75vh] w-full mt-2",children:(0,s.jsxs)(M.Z,{numColSpan:1,children:[(0,s.jsx)(ec,{userID:t,userSpendData:u,userRole:l,accessToken:Z}),(0,s.jsx)(eh,{teams:n,setSelectedTeam:v}),(0,s.jsx)(O.Z,{children:"API Keys"}),(0,s.jsx)(J,{userID:t,team:b||null,userRole:l,accessToken:Z,data:o,setData:h},b?b.team_id:null),(0,s.jsx)(eo,{userID:t,accessToken:Z,data:o,setData:h})]})})})};let{Option:ej}=L.default;var eg=e=>{let{userModels:t,accessToken:l,userID:a}=e,[n]=z.Z.useForm(),[o,i]=(0,r.useState)(!1),c=async e=>{try{d.ZP.info("Requesting access");let{selectedModel:t,accessReason:s}=e;await N(l,t,a,s),i(!0)}catch(e){console.error("Error requesting access:",e)}};return(0,s.jsxs)("div",{children:[(0,s.jsx)(D.Z,{size:"xs",onClick:()=>i(!0),children:"Request Access"}),(0,s.jsx)(K.Z,{title:"Request Access",visible:o,width:800,footer:null,onOk:()=>{i(!1),n.resetFields()},onCancel:()=>{i(!1),n.resetFields()},children:(0,s.jsxs)(z.Z,{form:n,onFinish:c,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,s.jsx)(z.Z.Item,{label:"Select Model",name:"selectedModel",children:(0,s.jsx)(L.default,{placeholder:"Select model",style:{width:"100%"},children:t.map(e=>(0,s.jsx)(ej,{value:e,children:e},e))})}),(0,s.jsx)(z.Z.Item,{label:"Reason for Access",name:"accessReason",children:(0,s.jsx)(W.Z.TextArea,{rows:4,placeholder:"Enter reason for access"})}),(0,s.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,s.jsx)(D.Z,{children:"Request Access"})})]})})]})},ey=e=>{let{accessToken:t,token:l,userRole:a,userID:n}=e,[o,i]=(0,r.useState)({data:[]}),[c,d]=(0,r.useState)([]),[m,h]=(0,r.useState)([]);if((0,r.useEffect)(()=>{if(!t||!l||!a||!n)return;let e=async()=>{try{let e=await j(t,n,a);console.log("Model data response:",e.data),i(e);let l=await g(t,n,a);if(console.log("Model metrics response:",l),d(l),"Admin"===a&&t){let e=await A(t);console.log("Pending Requests:",m),h(e.requests||[])}}catch(e){console.error("There was an error fetching the model data",e)}};t&&l&&a&&n&&e()},[t,l,a,n]),!o||!t||!l||!a||!n)return(0,s.jsx)("div",{children:"Loading..."});let u=[];for(let e=0;e<o.data.length;e++){var x,p;let t=o.data[e],l=null==t?void 0:null===(x=t.litellm_params)||void 0===x?void 0:x.mode,s=null==t?void 0:t.model_info,r="openai",a="",n="Undefined",i="Undefined",c="Undefined";if(l){let e=l.split("/"),t=e[0];a=1===e.length?r:t}else a=r;s&&(n=null==s?void 0:s.input_cost_per_token,i=null==s?void 0:s.output_cost_per_token,c=null==s?void 0:s.max_tokens),o.data[e].provider=a,o.data[e].input_cost=n,o.data[e].output_cost=i,o.data[e].max_tokens=c,o.data[e].api_base=null==t?void 0:null===(p=t.litellm_params)||void 0===p?void 0:p.api_base,u.push(t.model_name),console.log(o.data[e])}if(a&&"Admin Viewer"==a){let{Title:e,Paragraph:t}=ex.default;return(0,s.jsxs)("div",{children:[(0,s.jsx)(e,{level:1,children:"Access Denied"}),(0,s.jsx)(t,{children:"Ask your proxy admin for access to view all models"})]})}return(0,s.jsx)("div",{style:{width:"100%"},children:(0,s.jsxs)(R.Z,{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,s.jsx)(U.Z,{children:(0,s.jsxs)(X.Z,{className:"mt-5",children:[(0,s.jsx)(et.Z,{children:(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(ee.Z,{children:(0,s.jsx)(O.Z,{children:"Model Name "})}),(0,s.jsx)(ee.Z,{children:(0,s.jsx)(O.Z,{children:"Provider"})}),"Admin"===a&&(0,s.jsx)(ee.Z,{children:(0,s.jsx)(O.Z,{children:"API Base"})}),(0,s.jsx)(ee.Z,{children:(0,s.jsx)(O.Z,{children:"Access"})}),(0,s.jsx)(ee.Z,{children:(0,s.jsx)(O.Z,{children:"Input Price per token ($)"})}),(0,s.jsx)(ee.Z,{children:(0,s.jsx)(O.Z,{children:"Output Price per token ($)"})}),(0,s.jsx)(ee.Z,{children:(0,s.jsx)(O.Z,{children:"Max Tokens"})})]})}),(0,s.jsx)(Q.Z,{children:o.data.map(e=>(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(ee.Z,{children:(0,s.jsx)(O.Z,{children:e.model_name})}),(0,s.jsx)(ee.Z,{children:e.provider}),"Admin"===a&&(0,s.jsx)(ee.Z,{children:e.api_base}),(0,s.jsx)(ee.Z,{children:e.user_access?(0,s.jsx)(H.Z,{color:"green",children:"Yes"}):(0,s.jsx)(eg,{userModels:u,accessToken:t,userID:n})}),(0,s.jsx)(ee.Z,{children:e.input_cost}),(0,s.jsx)(ee.Z,{children:e.output_cost}),(0,s.jsx)(ee.Z,{children:e.max_tokens})]},e.model_name))})]})}),(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(O.Z,{children:"Model Statistics (Number Requests)"}),(0,s.jsx)(er.Z,{data:c,index:"model",categories:["num_requests"],colors:["blue"],yAxisWidth:400,layout:"vertical",tickGap:5})]}),(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(O.Z,{children:"Model Statistics (Latency)"}),(0,s.jsx)(er.Z,{data:c,index:"model",categories:["avg_latency_seconds"],colors:["red"],yAxisWidth:400,layout:"vertical",tickGap:5})]})]})})},ew=l(92836),eZ=l(26734),ef=l(41608),ek=l(32126),e_=l(23682);let{Option:eb}=L.default;var ev=e=>{let{userID:t,accessToken:l}=e,[a]=z.Z.useForm(),[n,o]=(0,r.useState)(!1),[i,c]=(0,r.useState)(null),[m,u]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{try{let e=await y(l,t,"any"),s=[];for(let t=0;t<e.data.length;t++){let l=e.data[t];s.push(l.id)}console.log("Model data response:",e.data),console.log("Available models:",s),u(s)}catch(e){console.error("Error fetching model data:",e)}})()},[]);let x=()=>{o(!1),a.resetFields()},p=()=>{o(!1),c(null),a.resetFields()},j=async e=>{try{d.ZP.info("Making API Call"),o(!0),console.log("formValues in create user:",e);let s=await h(l,t,e);console.log("user create Response:",s),c(s.key),d.ZP.success("API user Created"),a.resetFields(),localStorage.removeItem("userData"+t)}catch(e){console.error("Error creating the user:",e)}};return(0,s.jsxs)("div",{children:[(0,s.jsx)(D.Z,{className:"mx-auto",onClick:()=>o(!0),children:"+ Create New User"}),(0,s.jsx)(K.Z,{title:"Create User",visible:n,width:800,footer:null,onOk:x,onCancel:p,children:(0,s.jsxs)(z.Z,{form:a,onFinish:j,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,s.jsx)(z.Z.Item,{label:"User ID",name:"user_id",children:(0,s.jsx)(W.Z,{placeholder:"Enter User ID"})}),(0,s.jsx)(z.Z.Item,{label:"Team ID",name:"team_id",children:(0,s.jsx)(W.Z,{placeholder:"ai_team"})}),(0,s.jsx)(z.Z.Item,{label:"Models",name:"models",children:(0,s.jsx)(L.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:m.map(e=>(0,s.jsx)(eb,{value:e,children:e},e))})}),(0,s.jsx)(z.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,s.jsx)(q.Z,{step:.01,precision:2,width:200})}),(0,s.jsx)(z.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,s.jsx)(q.Z,{step:1,width:400})}),(0,s.jsx)(z.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,s.jsx)(q.Z,{step:1,width:400})}),(0,s.jsx)(z.Z.Item,{label:"Duration (eg: 30s, 30h, 30d)",name:"duration",children:(0,s.jsx)(W.Z,{})}),(0,s.jsx)(z.Z.Item,{label:"Metadata",name:"metadata",children:(0,s.jsx)(W.Z.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,s.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,s.jsx)(V.ZP,{htmlType:"submit",children:"Create User"})})]})}),i&&(0,s.jsxs)(K.Z,{title:"Save Your User",visible:n,onOk:x,onCancel:p,footer:null,children:[(0,s.jsxs)("p",{children:["Please save this secret user somewhere safe and accessible. For security reasons, ",(0,s.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret user, you will need to generate a new one."]}),(0,s.jsx)("p",{children:null!=i?"API user: ".concat(i):"User being created, this might take 30s"})]})]})},eS=e=>{let{accessToken:t,token:l,keys:a,userRole:n,userID:o,setKeys:i}=e,[c,d]=(0,r.useState)(null),[m,h]=(0,r.useState)(null),[u,p]=(0,r.useState)(1);if((0,r.useEffect)(()=>{if(!t||!l||!n||!o)return;let e=async()=>{try{let e=await x(t,null,n,!0);console.log("user data response:",e),d(e)}catch(e){console.error("There was an error fetching the model data",e)}};t&&l&&n&&o&&!c&&e();let s=async()=>{try{let e=await b(t,null);console.log("user data response:",e),h(e)}catch(e){console.error("There was an error fetching the model data",e)}};n&&("Admin"==n||"Admin Viewer"==n)&&!m&&s()},[t,l,n,o]),!c||!t||!l||!n||!o)return(0,s.jsx)("div",{children:"Loading..."});let j=async e=>{try{let l=await b(t,e);console.log("user data response:",l),h(l)}catch(e){console.error("There was an error fetching the model data",e)}};return(0,s.jsx)("div",{style:{width:"100%"},children:(0,s.jsxs)(R.Z,{className:"gap-2 p-2 h-[75vh] w-full mt-8",children:[(0,s.jsx)(ev,{userID:o,accessToken:t}),(0,s.jsx)(U.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh] mb-4",children:(0,s.jsxs)(eZ.Z,{children:[(0,s.jsxs)(ef.Z,{variant:"line",defaultValue:"1",children:[(0,s.jsx)(ew.Z,{value:"1",children:"Key Owners"}),(0,s.jsx)(ew.Z,{value:"2",children:"End-Users"})]}),(0,s.jsxs)(e_.Z,{children:[(0,s.jsx)(ek.Z,{children:(0,s.jsxs)(X.Z,{className:"mt-5",children:[(0,s.jsx)(et.Z,{children:(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(el.Z,{children:"User ID"}),(0,s.jsx)(el.Z,{children:"User Role"}),(0,s.jsx)(el.Z,{children:"User Models"}),(0,s.jsx)(el.Z,{children:"User Spend ($ USD)"}),(0,s.jsx)(el.Z,{children:"User Max Budget ($ USD)"})]})}),(0,s.jsx)(Q.Z,{children:c.map(e=>(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(ee.Z,{children:e.user_id}),(0,s.jsx)(ee.Z,{children:e.user_role?e.user_role:"app_owner"}),(0,s.jsx)(ee.Z,{children:e.models&&e.models.length>0?e.models:"All Models"}),(0,s.jsx)(ee.Z,{children:e.spend?e.spend:0}),(0,s.jsx)(ee.Z,{children:e.max_budget?e.max_budget:"Unlimited"})]},e.user_id))})]})}),(0,s.jsxs)(ek.Z,{children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,s.jsx)(B.Z,{className:"w-1/4 mr-2 text-right",children:"Key"}),(0,s.jsx)(ed.Z,{defaultValue:"1",className:"w-3/4",children:null==a?void 0:a.map((e,t)=>{if(e&&null!==e.key_name&&e.key_name.length>0)return(0,s.jsx)(em.Z,{value:String(t),onClick:()=>j(e.token),children:e.key_name},t)})})]})]}),(0,s.jsxs)(X.Z,{children:[(0,s.jsx)(et.Z,{children:(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(el.Z,{children:"End User"}),(0,s.jsx)(el.Z,{children:"Spend"}),(0,s.jsx)(el.Z,{children:"Total Events"})]})}),(0,s.jsx)(Q.Z,{children:null==m?void 0:m.map((e,t)=>(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(ee.Z,{children:e.end_user}),(0,s.jsx)(ee.Z,{children:e.total_spend}),(0,s.jsx)(ee.Z,{children:e.total_events})]},t))})]})]})]})]})}),function(){if(!c)return null;let e=Math.ceil(c.length/25),t=Math.min(25*u,c.length);return(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:["Showing ",(u-1)*25+1," – ",t," of ",c.length]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-l focus:outline-none",disabled:1===u,onClick:()=>p(u-1),children:"← Prev"}),(0,s.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-r focus:outline-none",disabled:u===e,onClick:()=>p(u+1),children:"Next →"})]})]})}()]})})},eN=e=>{let{teams:t,searchParams:l,accessToken:a,setTeams:n,userID:o,userRole:i}=e,[c]=z.Z.useForm(),[m]=z.Z.useForm(),{Title:h,Paragraph:u}=ex.default,[x,p]=(0,r.useState)(""),[j,g]=(0,r.useState)(t?t[0]:null),[w,Z]=(0,r.useState)(!1),[f,k]=(0,r.useState)(!1),[_,b]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{try{if(null===o||null===i)return;if(null!==a){let e=(await y(a,o,i)).data.map(e=>e.id);console.log("available_model_names:",e),b(e)}}catch(e){console.error("Error fetching user models:",e)}})()},[a,o,i]);let v=async e=>{try{if(null!=a){d.ZP.info("Creating Team");let l=await T(a,e);null!==t?n([...t,l]):n([l]),console.log("response for team create call: ".concat(l)),d.ZP.success("Team created"),Z(!1)}}catch(e){console.error("Error creating the key:",e),d.ZP.error("Error creating the team: "+e)}},S=async e=>{try{if(null!=a&&null!=t){d.ZP.info("Adding Member");let l={role:"user",user_email:e.user_email,user_id:e.user_id},s=await I(a,j.team_id,l);console.log("response for team create call: ".concat(s.data));let r=t.findIndex(e=>(console.log("team.team_id=".concat(e.team_id,"; response.data.team_id=").concat(s.data.team_id)),e.team_id===s.data.team_id));if(console.log("foundIndex: ".concat(r)),-1!==r){let e=[...t];e[r]=s.data,n(e),g(s.data)}k(!1)}}catch(e){console.error("Error creating the key:",e)}};return console.log("received teams ".concat(t)),(0,s.jsx)("div",{className:"w-full mx-4",children:(0,s.jsxs)(R.Z,{numItems:1,className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,s.jsxs)(M.Z,{numColSpan:1,children:[(0,s.jsx)(h,{level:4,children:"All Teams"}),(0,s.jsx)(U.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,s.jsxs)(X.Z,{children:[(0,s.jsx)(et.Z,{children:(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(el.Z,{children:"Team Name"}),(0,s.jsx)(el.Z,{children:"Spend (USD)"}),(0,s.jsx)(el.Z,{children:"Budget (USD)"}),(0,s.jsx)(el.Z,{children:"Models"}),(0,s.jsx)(el.Z,{children:"TPM / RPM Limits"})]})}),(0,s.jsx)(Q.Z,{children:t&&t.length>0?t.map(e=>(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(ee.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.team_alias}),(0,s.jsx)(ee.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.spend}),(0,s.jsx)(ee.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.max_budget?e.max_budget:"No limit"}),(0,s.jsx)(ee.Z,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},children:Array.isArray(e.models)?(0,s.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:e.models.map((e,t)=>(0,s.jsx)(H.Z,{size:"xs",className:"mb-1",color:"blue",children:e.length>30?"".concat(e.slice(0,30),"..."):e},t))}):null}),(0,s.jsx)(ee.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:(0,s.jsxs)(B.Z,{children:["TPM:"," ",e.tpm_limit?e.tpm_limit:"Unlimited"," ",(0,s.jsx)("br",{}),"RPM:"," ",e.rpm_limit?e.rpm_limit:"Unlimited"]})})]},e.team_id)):null})]})})]}),(0,s.jsxs)(M.Z,{numColSpan:1,children:[(0,s.jsx)(D.Z,{className:"mx-auto",onClick:()=>Z(!0),children:"+ Create New Team"}),(0,s.jsx)(K.Z,{title:"Create Team",visible:w,width:800,footer:null,onOk:()=>{Z(!1),c.resetFields()},onCancel:()=>{Z(!1),c.resetFields()},children:(0,s.jsxs)(z.Z,{form:c,onFinish:v,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.Z.Item,{label:"Team Name",name:"team_alias",rules:[{required:!0,message:"Please input a team name"}],children:(0,s.jsx)(W.Z,{})}),(0,s.jsx)(z.Z.Item,{label:"Models",name:"models",children:(0,s.jsx)(L.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:_.map(e=>(0,s.jsx)(L.default.Option,{value:e,children:e},e))})}),(0,s.jsx)(z.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,s.jsx)(q.Z,{step:.01,precision:2,width:200})}),(0,s.jsx)(z.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,s.jsx)(q.Z,{step:1,width:400})}),(0,s.jsx)(z.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,s.jsx)(q.Z,{step:1,width:400})})]}),(0,s.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,s.jsx)(V.ZP,{htmlType:"submit",children:"Create Team"})})]})})]}),(0,s.jsxs)(M.Z,{numColSpan:1,children:[(0,s.jsx)(h,{level:4,children:"Team Members"}),(0,s.jsx)(u,{children:"If you belong to multiple teams, this setting controls which teams members you see."}),t&&t.length>0?(0,s.jsx)(ed.Z,{defaultValue:"0",children:t.map((e,t)=>(0,s.jsx)(em.Z,{value:String(t),onClick:()=>{g(e)},children:e.team_alias},t))}):(0,s.jsxs)(u,{children:["No team created. ",(0,s.jsx)("b",{children:"Defaulting to personal account."})]})]}),(0,s.jsx)(M.Z,{numColSpan:1,children:(0,s.jsx)(U.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,s.jsxs)(X.Z,{children:[(0,s.jsx)(et.Z,{children:(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(el.Z,{children:"Member Name"}),(0,s.jsx)(el.Z,{children:"Role"})]})}),(0,s.jsx)(Q.Z,{children:j?j.members_with_roles.map((e,t)=>(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(ee.Z,{children:e.user_email?e.user_email:e.user_id?e.user_id:null}),(0,s.jsx)(ee.Z,{children:e.role})]},t)):null})]})})}),(0,s.jsxs)(M.Z,{numColSpan:1,children:[(0,s.jsx)(D.Z,{className:"mx-auto mb-5",onClick:()=>k(!0),children:"+ Add member"}),(0,s.jsx)(K.Z,{title:"Add member",visible:f,width:800,footer:null,onOk:()=>{k(!1),m.resetFields()},onCancel:()=>{k(!1),m.resetFields()},children:(0,s.jsxs)(z.Z,{form:c,onFinish:S,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.Z.Item,{label:"Email",name:"user_email",className:"mb-4",children:(0,s.jsx)(W.Z,{name:"user_email",className:"px-3 py-2 border rounded-md w-full"})}),(0,s.jsx)("div",{className:"text-center mb-4",children:"OR"}),(0,s.jsx)(z.Z.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,s.jsx)(W.Z,{name:"user_id",className:"px-3 py-2 border rounded-md w-full"})})]}),(0,s.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,s.jsx)(V.ZP,{htmlType:"submit",children:"Add member"})})]})})]})]})})},eA=l(8510),eC=e=>{let{searchParams:t,accessToken:l}=e,[a]=z.Z.useForm(),[n]=z.Z.useForm(),{Title:o,Paragraph:i}=ex.default,[c,m]=(0,r.useState)(""),[h,u]=(0,r.useState)(null),[x,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{if(null!=l){let e=[],t=await C(l,"proxy_admin_viewer");t.forEach(t=>{e.push({user_role:t.user_role,user_id:t.user_id,user_email:t.user_email})}),console.log("proxy viewers: ".concat(t));let s=await C(l,"proxy_admin");s.forEach(t=>{e.push({user_role:t.user_role,user_id:t.user_id,user_email:t.user_email})}),console.log("proxy admins: ".concat(s)),console.log("combinedList: ".concat(e)),u(e)}})()},[l]);let j=async e=>{try{if(null!=l&&null!=h){d.ZP.info("Making API Call"),e.user_email,e.user_id;let t=await P(l,e);console.log("response for team create call: ".concat(t));let s=h.findIndex(e=>(console.log("user.user_id=".concat(e.user_id,"; response.user_id=").concat(t.user_id)),e.user_id===t.user_id));console.log("foundIndex: ".concat(s)),-1==s&&(console.log("updates admin with new user"),h.push(t),u(h)),p(!1)}}catch(e){console.error("Error creating the key:",e)}};return console.log("admins: ".concat(null==h?void 0:h.length)),(0,s.jsxs)("div",{className:"w-full m-2 mt-2 p-8",children:[(0,s.jsx)(o,{level:4,children:"Restricted Access"}),(0,s.jsxs)(i,{children:["Add other people to just view spend. They cannot create keys, teams or grant users access to new models."," ",(0,s.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/ui#restrict-ui-access",children:"Requires SSO Setup"})]}),(0,s.jsxs)(R.Z,{numItems:1,className:"gap-2 p-2 w-full",children:[(0,s.jsx)(M.Z,{numColSpan:1,children:(0,s.jsx)(U.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,s.jsxs)(X.Z,{children:[(0,s.jsx)(et.Z,{children:(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(el.Z,{children:"Member Name"}),(0,s.jsx)(el.Z,{children:"Role"}),(0,s.jsx)(el.Z,{children:"Action"})]})}),(0,s.jsx)(Q.Z,{children:h?h.map((e,t)=>(0,s.jsxs)(es.Z,{children:[(0,s.jsx)(ee.Z,{children:e.user_email?e.user_email:e.user_id?e.user_id:null}),(0,s.jsx)(ee.Z,{children:e.user_role}),(0,s.jsx)(ee.Z,{children:(0,s.jsx)(Y.Z,{icon:eA.Z,size:"sm"})})]},t)):null})]})})}),(0,s.jsxs)(M.Z,{numColSpan:1,children:[(0,s.jsx)(D.Z,{className:"mx-auto mb-5",onClick:()=>p(!0),children:"+ Add viewer"}),(0,s.jsx)(K.Z,{title:"Add viewer",visible:x,width:800,footer:null,onOk:()=>{p(!1),n.resetFields()},onCancel:()=>{p(!1),n.resetFields()},children:(0,s.jsxs)(z.Z,{form:a,onFinish:j,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.Z.Item,{label:"Email",name:"user_email",className:"mb-4",children:(0,s.jsx)(W.Z,{name:"user_email",className:"px-3 py-2 border rounded-md w-full"})}),(0,s.jsx)("div",{className:"text-center mb-4",children:"OR"}),(0,s.jsx)(z.Z.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,s.jsx)(W.Z,{name:"user_id",className:"px-3 py-2 border rounded-md w-full"})})]}),(0,s.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,s.jsx)(V.ZP,{htmlType:"submit",children:"Add member"})})]})})]})]})]})},eT=l(12968),eI=l(67951);async function eP(e,t,l,s){console.log("isLocal:",!1);let r=window.location.origin,a=new eT.ZP.OpenAI({apiKey:s,baseURL:r,dangerouslyAllowBrowser:!0});for await(let s of(await a.chat.completions.create({model:l,stream:!0,messages:[{role:"user",content:e}]})))console.log(s),s.choices[0].delta.content&&t(s.choices[0].delta.content)}var eE=e=>{let{accessToken:t,token:l,userRole:a,userID:n}=e,[o,i]=(0,r.useState)(""),[c,d]=(0,r.useState)([]),[m,h]=(0,r.useState)(void 0),[u,x]=(0,r.useState)(null);(0,r.useEffect)(()=>{t&&l&&a&&n&&(async()=>{let e=await y(t,n,a);console.log("model_info:",e),(null==e?void 0:e.data.length)>0&&(x(e.data),h(e.data[0].id))})()},[t,n,a]);let p=(e,t)=>{d(l=>{let s=l[l.length-1];return s&&s.role===e?[...l.slice(0,l.length-1),{role:e,content:s.content+t}]:[...l,{role:e,content:t}]})},j=async()=>{if(""!==o.trim()&&t&&l&&a&&n){d(e=>[...e,{role:"user",content:o}]);try{m&&await eP(o,e=>p("assistant",e),m,t)}catch(e){console.error("Error fetching model response",e),p("assistant","Error fetching model response")}i("")}};if(a&&"Admin Viewer"==a){let{Title:e,Paragraph:t}=ex.default;return(0,s.jsxs)("div",{children:[(0,s.jsx)(e,{level:1,children:"Access Denied"}),(0,s.jsx)(t,{children:"Ask your proxy admin for access to test models"})]})}return(0,s.jsx)("div",{style:{width:"100%",position:"relative"},children:(0,s.jsx)(R.Z,{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:(0,s.jsx)(U.Z,{children:(0,s.jsxs)(eZ.Z,{children:[(0,s.jsxs)(ef.Z,{className:"mt-4",children:[(0,s.jsx)(ew.Z,{children:"Chat"}),(0,s.jsx)(ew.Z,{children:"API Reference"})]}),(0,s.jsxs)(e_.Z,{children:[(0,s.jsxs)(ek.Z,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Select Model:"}),(0,s.jsx)("select",{value:m||"",onChange:e=>h(e.target.value),children:null==u?void 0:u.map(e=>(0,s.jsx)("option",{value:e.id,children:e.id},e.id))})]}),(0,s.jsxs)(X.Z,{className:"mt-5",style:{display:"block",maxHeight:"60vh",overflowY:"auto"},children:[(0,s.jsx)(et.Z,{children:(0,s.jsx)(es.Z,{children:(0,s.jsx)(ee.Z,{children:(0,s.jsx)(O.Z,{children:"Chat"})})})}),(0,s.jsx)(Q.Z,{children:c.map((e,t)=>(0,s.jsx)(es.Z,{children:(0,s.jsx)(ee.Z,{children:"".concat(e.role,": ").concat(e.content)})},t))})]}),(0,s.jsx)("div",{className:"mt-3",style:{position:"absolute",bottom:5,width:"95%"},children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("input",{type:"text",value:o,onChange:e=>i(e.target.value),className:"flex-1 p-2 border rounded-md mr-2",placeholder:"Type your message..."}),(0,s.jsx)("button",{onClick:j,className:"p-2 bg-blue-500 text-white rounded-md",children:"Send"})]})})]}),(0,s.jsx)(ek.Z,{children:(0,s.jsxs)(eZ.Z,{children:[(0,s.jsxs)(ef.Z,{children:[(0,s.jsx)(ew.Z,{children:"OpenAI Python SDK"}),(0,s.jsx)(ew.Z,{children:"LlamaIndex"}),(0,s.jsx)(ew.Z,{children:"Langchain Py"})]}),(0,s.jsxs)(e_.Z,{children:[(0,s.jsx)(ek.Z,{children:(0,s.jsx)(eI.Z,{language:"python",children:'\nimport openai\nclient = openai.OpenAI(\n    api_key="your_api_key",\n    base_url="http://0.0.0.0:4000" # proxy base url\n)\n\nresponse = client.chat.completions.create(\n    model="gpt-3.5-turbo", # model to use from Models Tab\n    messages = [\n        {\n            "role": "user",\n            "content": "this is a test request, write a short poem"\n        }\n    ],\n    extra_body={\n        "metadata": {\n            "generation_name": "ishaan-generation-openai-client",\n            "generation_id": "openai-client-gen-id22",\n            "trace_id": "openai-client-trace-id22",\n            "trace_user_id": "openai-client-user-id2"\n        }\n    }\n)\n\nprint(response)\n            '})}),(0,s.jsx)(ek.Z,{children:(0,s.jsx)(eI.Z,{language:"python",children:'\nimport os, dotenv\n\nfrom llama_index.llms import AzureOpenAI\nfrom llama_index.embeddings import AzureOpenAIEmbedding\nfrom llama_index import VectorStoreIndex, SimpleDirectoryReader, ServiceContext\n\nllm = AzureOpenAI(\n    engine="azure-gpt-3.5",               # model_name on litellm proxy\n    temperature=0.0,\n    azure_endpoint="http://0.0.0.0:4000", # litellm proxy endpoint\n    api_key="sk-1234",                    # litellm proxy API Key\n    api_version="2023-07-01-preview",\n)\n\nembed_model = AzureOpenAIEmbedding(\n    deployment_name="azure-embedding-model",\n    azure_endpoint="http://0.0.0.0:4000",\n    api_key="sk-1234",\n    api_version="2023-07-01-preview",\n)\n\n\ndocuments = SimpleDirectoryReader("llama_index_data").load_data()\nservice_context = ServiceContext.from_defaults(llm=llm, embed_model=embed_model)\nindex = VectorStoreIndex.from_documents(documents, service_context=service_context)\n\nquery_engine = index.as_query_engine()\nresponse = query_engine.query("What did the author do growing up?")\nprint(response)\n\n            '})}),(0,s.jsx)(ek.Z,{children:(0,s.jsx)(eI.Z,{language:"python",children:'\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.prompts.chat import (\n    ChatPromptTemplate,\n    HumanMessagePromptTemplate,\n    SystemMessagePromptTemplate,\n)\nfrom langchain.schema import HumanMessage, SystemMessage\n\nchat = ChatOpenAI(\n    openai_api_base="http://0.0.0.0:8000",\n    model = "gpt-3.5-turbo",\n    temperature=0.1,\n    extra_body={\n        "metadata": {\n            "generation_name": "ishaan-generation-langchain-client",\n            "generation_id": "langchain-client-gen-id22",\n            "trace_id": "langchain-client-trace-id22",\n            "trace_user_id": "langchain-client-user-id2"\n        }\n    }\n)\n\nmessages = [\n    SystemMessage(\n        content="You are a helpful assistant that im using to make a test request to."\n    ),\n    HumanMessage(\n        content="test from litellm. tell me why it\'s amazing in 1 sentence"\n    ),\n]\nresponse = chat(messages)\n\nprint(response)\n\n            '})})]})]})})]})]})})})})},eF=l(33509),eM=l(95781);let{Sider:eR}=eF.default;var eO=e=>{let{setPage:t,userRole:l,defaultSelectedKey:r}=e;return"Admin Viewer"==l?(0,s.jsx)(eF.default,{style:{minHeight:"100vh",maxWidth:"120px"},children:(0,s.jsx)(eR,{width:120,children:(0,s.jsxs)(eM.Z,{mode:"inline",defaultSelectedKeys:r||["4"],style:{height:"100%",borderRight:0},children:[(0,s.jsx)(eM.Z.Item,{onClick:()=>t("api-keys"),children:"API Keys"},"4"),(0,s.jsx)(eM.Z.Item,{onClick:()=>t("models"),children:"Models"},"2"),(0,s.jsx)(eM.Z.Item,{onClick:()=>t("llm-playground"),children:"Chat UI"},"3"),(0,s.jsx)(eM.Z.Item,{onClick:()=>t("usage"),children:"Usage"},"1")]})})}):(0,s.jsx)(eF.default,{style:{minHeight:"100vh",maxWidth:"120px"},children:(0,s.jsx)(eR,{width:120,children:(0,s.jsxs)(eM.Z,{mode:"inline",defaultSelectedKeys:r||["1"],style:{height:"100%",borderRight:0},children:[(0,s.jsx)(eM.Z.Item,{onClick:()=>t("api-keys"),children:"API Keys"},"1"),(0,s.jsx)(eM.Z.Item,{onClick:()=>t("models"),children:"Models"},"2"),(0,s.jsx)(eM.Z.Item,{onClick:()=>t("llm-playground"),children:"Chat UI"},"3"),(0,s.jsx)(eM.Z.Item,{onClick:()=>t("usage"),children:"Usage"},"4"),"Admin"==l?(0,s.jsx)(eM.Z.Item,{onClick:()=>t("users"),children:"Users"},"5"):null,"Admin"==l?(0,s.jsx)(eM.Z.Item,{onClick:()=>t("teams"),children:"Teams"},"6"):null,"Admin"==l?(0,s.jsx)(eM.Z.Item,{onClick:()=>t("admin-panel"),children:"Admin"},"7"):null]})})})},eD=e=>{let{accessToken:t,token:l,userRole:a,userID:n}=e,o=new Date,[i,c]=(0,r.useState)([]),[d,m]=(0,r.useState)([]),[h,u]=(0,r.useState)([]),[x,p]=(0,r.useState)([]),[j,g]=(0,r.useState)([]),[y,w]=(0,r.useState)([]),[b,N]=(0,r.useState)([]),A=new Date(o.getFullYear(),o.getMonth(),1),C=new Date(o.getFullYear(),o.getMonth()+1,0),T=P(A),I=P(C);function P(e){let t=e.getFullYear(),l=e.getMonth()+1,s=e.getDate();return"".concat(t,"-").concat(l<10?"0"+l:l,"-").concat(s<10?"0"+s:s)}return console.log("Start date is ".concat(T)),console.log("End date is ".concat(I)),(0,r.useEffect)(()=>{t&&l&&a&&n&&(async()=>{try{if(console.log("user role: ".concat(a)),"Admin"==a||"Admin Viewer"==a){let e=await k(t);c(e);let l=(await _(t)).map(e=>({key:(e.key_name||e.key_alias||e.api_key).substring(0,7),spend:e.total_spend}));m(l);let s=(await v(t)).map(e=>({key:e.model,spend:e.total_spend}));u(s);let r=await Z(t);console.log("teamSpend",r),g(r.daily_spend),w(r.teams),N(r.total_spend_per_team)}else"App Owner"==a&&await f(t,l,a,n,T,I).then(async e=>{if(console.log("result from spend logs call",e),"daily_spend"in e){let t=e.daily_spend;console.log("daily spend",t),c(t);let l=e.top_api_keys;m(l)}else{let l=(await S(t,function(e){let t=[];e.forEach(e=>{Object.entries(e).forEach(e=>{let[l,s]=e;"spend"!==l&&"startTime"!==l&&"models"!==l&&"users"!==l&&t.push({key:l,spend:s})})}),t.sort((e,t)=>Number(t.spend)-Number(e.spend));let l=t.slice(0,5).map(e=>e.key);return console.log("topKeys: ".concat(Object.keys(l[0]))),l}(e))).info.map(e=>({key:(e.key_name||e.key_alias||e.token).substring(0,7),spend:e.spend}));m(l),p(function(e){let t={};e.forEach(e=>{Object.entries(e.users).forEach(e=>{let[l,s]=e;""!==l&&null!=l&&"None"!=l&&(t[l]||(t[l]=0),t[l]+=s)})});let l=Object.entries(t).map(e=>{let[t,l]=e;return{user_id:t,spend:l}});l.sort((e,t)=>t.spend-e.spend);let s=l.slice(0,5);return console.log("topKeys: ".concat(Object.values(s[0]))),s}(e)),c(e)}})}catch(e){console.error("There was an error fetching the data",e)}})()},[t,l,a,n,T,I]),(0,s.jsx)("div",{style:{width:"100%"},className:"p-8",children:(0,s.jsxs)(eZ.Z,{children:[(0,s.jsxs)(ef.Z,{className:"mt-2",children:[(0,s.jsx)(ew.Z,{children:"All Up"}),(0,s.jsx)(ew.Z,{children:"Team Based Usage"})]}),(0,s.jsxs)(e_.Z,{children:[(0,s.jsx)(ek.Z,{children:(0,s.jsxs)(R.Z,{numItems:2,className:"gap-2 h-[75vh] w-full",children:[(0,s.jsx)(M.Z,{numColSpan:2,children:(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(O.Z,{children:"Monthly Spend"}),(0,s.jsx)(er.Z,{data:i,index:"date",categories:["spend"],colors:["blue"],valueFormatter:e=>"$ ".concat(new Intl.NumberFormat("us").format(e).toString()),yAxisWidth:100,tickGap:5})]})}),(0,s.jsx)(M.Z,{numColSpan:1,children:(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(O.Z,{children:"Top API Keys"}),(0,s.jsx)(er.Z,{className:"mt-4 h-40",data:d,index:"key",categories:["spend"],colors:["blue"],yAxisWidth:80,tickGap:5,layout:"vertical",showXAxis:!1,showLegend:!1})]})}),(0,s.jsx)(M.Z,{numColSpan:1,children:(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(O.Z,{children:"Top Users"}),(0,s.jsx)(er.Z,{className:"mt-4 h-40",data:x,index:"user_id",categories:["spend"],colors:["blue"],yAxisWidth:200,layout:"vertical",showXAxis:!1,showLegend:!1})]})}),(0,s.jsx)(M.Z,{numColSpan:1,children:(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(O.Z,{children:"Top Models"}),(0,s.jsx)(er.Z,{className:"mt-4 h-40",data:h,index:"key",categories:["spend"],colors:["blue"],yAxisWidth:200,layout:"vertical",showXAxis:!1,showLegend:!1})]})})]})}),(0,s.jsx)(ek.Z,{children:(0,s.jsxs)(R.Z,{numItems:2,className:"gap-2 p-10 h-[75vh] w-full",children:[(0,s.jsx)(M.Z,{numColSpan:2,children:(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(O.Z,{children:"Daily Spend Per Team"}),(0,s.jsx)(er.Z,{className:"h-72",data:j,index:"date",categories:y,yAxisWidth:30,stack:!0})]})}),(0,s.jsx)(M.Z,{numColSpan:2,children:(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(O.Z,{children:"Total Spend Per Team"}),(0,s.jsx)(er.Z,{className:"h-72",data:b,index:"team_id",categories:["total_spend"],yAxisWidth:30})]})})]})})]})]})})},eU=()=>{let{Title:e,Paragraph:t}=ex.default,[l,n]=(0,r.useState)(""),[o,i]=(0,r.useState)(null),[d,m]=(0,r.useState)(null),[h,u]=(0,r.useState)(null),[x,p]=(0,r.useState)(!0),j=(0,a.useSearchParams)(),g=j.get("userID"),y=j.get("token"),[w,Z]=(0,r.useState)("api-keys"),[f,k]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(y){let e=(0,eu.o)(y);if(e){if(console.log("Decoded token:",e),console.log("Decoded key:",e.key),k(e.key),e.user_role){let t=function(e){if(!e)return"Undefined Role";switch(console.log("Received user role: ".concat(e.toLowerCase())),console.log("Received user role length: ".concat(e.toLowerCase().length)),e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"app_user":return"App User";default:return"Unknown Role"}}(e.user_role);console.log("Decoded user_role:",t),n(t),"Admin Viewer"==t&&Z("usage")}else console.log("User role not defined");e.user_email?i(e.user_email):console.log("User Email is not set ".concat(e)),e.login_method?p("username_password"==e.login_method):console.log("User Email is not set ".concat(e))}}},[y]),(0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,s.jsx)(c,{userID:g,userRole:l,userEmail:o,showSSOBanner:x}),(0,s.jsxs)("div",{className:"flex flex-1 overflow-auto",children:[(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(eO,{setPage:Z,userRole:l,defaultSelectedKey:null})}),"api-keys"==w?(0,s.jsx)(ep,{userID:g,userRole:l,teams:d,keys:h,setUserRole:n,userEmail:o,setUserEmail:i,setTeams:m,setKeys:u}):"models"==w?(0,s.jsx)(ey,{userID:g,userRole:l,token:y,accessToken:f}):"llm-playground"==w?(0,s.jsx)(eE,{userID:g,userRole:l,token:y,accessToken:f}):"users"==w?(0,s.jsx)(eS,{userID:g,userRole:l,token:y,keys:h,accessToken:f,setKeys:u}):"teams"==w?(0,s.jsx)(eN,{teams:d,setTeams:m,searchParams:j,accessToken:f,userID:g,userRole:l}):"admin-panel"==w?(0,s.jsx)(eC,{setTeams:m,searchParams:j,accessToken:f}):(0,s.jsx)(eD,{userID:g,userRole:l,token:y,accessToken:f})]})]})})}}},function(e){e.O(0,[65,971,69,744],function(){return e(e.s=20661)}),_N_E=e.O()}]);