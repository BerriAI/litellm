(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{36362:function(e,s,t){Promise.resolve().then(t.bind(t,58193))},12011:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return _}});var l=t(57437),a=t(2265),r=t(99376),i=t(20831),n=t(94789),o=t(12514),c=t(49804),d=t(67101),m=t(84264),u=t(49566),x=t(96761),h=t(84566),p=t(19250),g=t(14474),j=t(13634),f=t(73002),v=t(3914);function _(){let[e]=j.Z.useForm(),s=(0,r.useSearchParams)();(0,v.e)("token");let t=s.get("invitation_id"),_=s.get("action"),[y,b]=(0,a.useState)(null),[N,Z]=(0,a.useState)(""),[w,k]=(0,a.useState)(""),[S,C]=(0,a.useState)(null),[I,P]=(0,a.useState)(""),[A,E]=(0,a.useState)(""),[T,L]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(0,p.getUiConfig)().then(e=>{console.log("ui config in onboarding.tsx:",e),L(!1)})},[]),(0,a.useEffect)(()=>{t&&!T&&(0,p.getOnboardingCredentials)(t).then(e=>{let s=e.login_url;console.log("login_url:",s),P(s);let t=e.token,l=(0,g.o)(t);E(t),console.log("decoded:",l),b(l.key),console.log("decoded user email:",l.user_email),k(l.user_email),C(l.user_id)})},[t,T]),(0,l.jsx)("div",{className:"mx-auto w-full max-w-md mt-10",children:(0,l.jsxs)(o.Z,{children:[(0,l.jsx)(x.Z,{className:"text-sm mb-5 text-center",children:"\uD83D\uDE85 LiteLLM"}),(0,l.jsx)(x.Z,{className:"text-xl",children:"reset_password"===_?"Reset Password":"Sign up"}),(0,l.jsx)(m.Z,{children:"reset_password"===_?"Reset your password to access Admin UI.":"Claim your user account to login to Admin UI."}),"reset_password"!==_&&(0,l.jsx)(n.Z,{className:"mt-4",title:"SSO",icon:h.GH$,color:"sky",children:(0,l.jsxs)(d.Z,{numItems:2,className:"flex justify-between items-center",children:[(0,l.jsx)(c.Z,{children:"SSO is under the Enterprise Tier."}),(0,l.jsx)(c.Z,{children:(0,l.jsx)(i.Z,{variant:"primary",className:"mb-2",children:(0,l.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"Get Free Trial"})})})]})}),(0,l.jsxs)(j.Z,{className:"mt-10 mb-5 mx-auto",layout:"vertical",onFinish:e=>{console.log("in handle submit. accessToken:",y,"token:",A,"formValues:",e),y&&A&&(e.user_email=w,S&&t&&(0,p.claimOnboardingToken)(y,t,S,e.password).then(e=>{let s="/ui/";s+="?login=success",document.cookie="token="+A,console.log("redirecting to:",s);let t=(0,p.getProxyBaseUrl)();console.log("proxyBaseUrl:",t),t?window.location.href=t+s:window.location.href=s}))},children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.Z.Item,{label:"Email Address",name:"user_email",children:(0,l.jsx)(u.Z,{type:"email",disabled:!0,value:w,defaultValue:w,className:"max-w-md"})}),(0,l.jsx)(j.Z.Item,{label:"Password",name:"password",rules:[{required:!0,message:"password required to sign up"}],help:"reset_password"===_?"Enter your new password":"Create a password for your account",children:(0,l.jsx)(u.Z,{placeholder:"",type:"password",className:"max-w-md"})})]}),(0,l.jsx)("div",{className:"mt-10",children:(0,l.jsx)(f.ZP,{htmlType:"submit",children:"reset_password"===_?"Reset Password":"Sign Up"})})]})]})})}},58193:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return nI}});var l,a,r,i,n,o,c=t(57437),d=t(2265),m=t(99376),u=t(14474),x=t(21623),h=t(29827),p=t(65373),g=t(19250);let j=async(e,s,t,l,a)=>{let r;r="Admin"!=t&&"Admin Viewer"!=t?await (0,g.teamListCall)(e,(null==l?void 0:l.organization_id)||null,s):await (0,g.teamListCall)(e,(null==l?void 0:l.organization_id)||null),console.log("givenTeams: ".concat(r)),a(r)};var f=t(49804),v=t(67101),_=t(20831),y=t(49566),b=t(87452),N=t(88829),Z=t(72208),w=t(84264),k=t(96761),S=t(29233),C=t(52787),I=t(13634),P=t(41021),A=t(91679),E=t(29967),T=t(73002),L=t(64482),O=t(30150),M=e=>{let{step:s=.01,style:t={width:"100%"},placeholder:l="Enter a numerical value",min:a,max:r,onChange:i,...n}=e;return(0,c.jsx)(O.Z,{onWheel:e=>e.currentTarget.blur(),step:s,style:t,placeholder:l,min:a,max:r,onChange:i,...n})};let D=async(e,s,t)=>{try{if(null===e||null===s)return;if(null!==t){let l=(await (0,g.modelAvailableCall)(t,e,s,!0,null,!0)).data.map(e=>e.id),a=[],r=[];return l.forEach(e=>{e.endsWith("/*")?a.push(e):r.push(e)}),[...a,...r]}}catch(e){console.error("Error fetching user models:",e)}},F=e=>{if(e.endsWith("/*")){let s=e.replace("/*","");return"All ".concat(s," models")}return e},R=(e,s)=>{let t=[],l=[];return console.log("teamModels",e),console.log("allModels",s),e.forEach(e=>{if(e.endsWith("/*")){let a=e.replace("/*",""),r=s.filter(e=>e.startsWith(a+"/"));l.push(...r),t.push(e)}else l.push(e)}),[...t,...l].filter((e,s,t)=>t.indexOf(e)===s)};var q=t(20577),U=t(15424),z=t(89970);let V=(e,s)=>["metadata","config","enforced_params","aliases"].includes(e)||"json"===s.format,K=e=>{if(!e)return!0;try{return JSON.parse(e),!0}catch(e){return!1}},B=(e,s,t)=>{let l={max_budget:"Enter maximum budget in USD (e.g., 100.50)",budget_duration:"Select a time period for budget reset",tpm_limit:"Enter maximum tokens per minute (whole number)",rpm_limit:"Enter maximum requests per minute (whole number)",duration:"Enter duration (e.g., 30s, 24h, 7d)",metadata:'Enter JSON object with key-value pairs\nExample: {"team": "research", "project": "nlp"}',config:'Enter configuration as JSON object\nExample: {"setting": "value"}',permissions:"Enter comma-separated permission strings",enforced_params:'Enter parameters as JSON object\nExample: {"param": "value"}',blocked:"Enter true/false or specific block conditions",aliases:'Enter aliases as JSON object\nExample: {"alias1": "value1", "alias2": "value2"}',models:"Select one or more model names",key_alias:"Enter a unique identifier for this key",tags:"Enter comma-separated tag strings"}[e]||({string:"Text input",number:"Numeric input",integer:"Whole number input",boolean:"True/False value"})[t]||"Text input";return V(e,s)?"".concat(l,"\nMust be valid JSON format"):s.enum?"Select from available options\nAllowed values: ".concat(s.enum.join(", ")):l};var G=e=>{let{schemaComponent:s,excludedFields:t=[],form:l,overrideLabels:a={},overrideTooltips:r={},customValidation:i={},defaultValues:n={}}=e,[o,m]=(0,d.useState)(null),[u,x]=(0,d.useState)(null);(0,d.useEffect)(()=>{(async()=>{try{let e=(await (0,g.getOpenAPISchema)()).components.schemas[s];if(!e)throw Error('Schema component "'.concat(s,'" not found'));m(e);let a={};Object.keys(e.properties).filter(e=>!t.includes(e)&&void 0!==n[e]).forEach(e=>{a[e]=n[e]}),l.setFieldsValue(a)}catch(e){console.error("Schema fetch error:",e),x(e instanceof Error?e.message:"Failed to fetch schema")}})()},[s,l,t]);let h=e=>{if(e.type)return e.type;if(e.anyOf){let s=e.anyOf.map(e=>e.type);if(s.includes("number")||s.includes("integer"))return"number";s.includes("string")}return"string"},p=(e,s)=>{var t;let l;let d=h(s),m=null==o?void 0:null===(t=o.required)||void 0===t?void 0:t.includes(e),u=a[e]||s.title||e,x=r[e]||s.description,p=[];m&&p.push({required:!0,message:"".concat(u," is required")}),i[e]&&p.push({validator:i[e]}),V(e,s)&&p.push({validator:async(e,s)=>{if(s&&!K(s))throw Error("Please enter valid JSON")}});let g=x?(0,c.jsxs)("span",{children:[u," ",(0,c.jsx)(z.Z,{title:x,children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}):u;return l=V(e,s)?(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:"Enter as JSON",className:"font-mono"}):s.enum?(0,c.jsx)(C.default,{children:s.enum.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:e},e))}):"number"===d||"integer"===d?(0,c.jsx)(q.Z,{style:{width:"100%"},precision:"integer"===d?0:void 0}):"duration"===e?(0,c.jsx)(y.Z,{placeholder:"eg: 30s, 30h, 30d"}):(0,c.jsx)(y.Z,{placeholder:x||""}),(0,c.jsx)(I.Z.Item,{label:g,name:e,className:"mt-8",rules:p,initialValue:n[e],help:(0,c.jsx)("div",{className:"text-xs text-gray-500",children:B(e,s,d)}),children:l},e)};return u?(0,c.jsxs)("div",{className:"text-red-500",children:["Error: ",u]}):(null==o?void 0:o.properties)?(0,c.jsx)("div",{children:Object.entries(o.properties).filter(e=>{let[s]=e;return!t.includes(s)}).map(e=>{let[s,t]=e;return p(s,t)})}):null},H=e=>{let{onChange:s,value:t,className:l,accessToken:a,placeholder:r="Select vector stores",disabled:i=!1}=e,[n,o]=(0,d.useState)([]),[m,u]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{(async()=>{if(a){u(!0);try{let e=await (0,g.vectorStoreListCall)(a);e.data&&o(e.data)}catch(e){console.error("Error fetching vector stores:",e)}finally{u(!1)}}})()},[a]),(0,c.jsx)("div",{children:(0,c.jsx)(C.default,{mode:"multiple",placeholder:r,onChange:s,value:t,loading:m,className:l,options:n.map(e=>({label:"".concat(e.vector_store_name||e.vector_store_id," (").concat(e.vector_store_id,")"),value:e.vector_store_id,title:e.vector_store_description||e.vector_store_id})),optionFilterProp:"label",showSearch:!0,style:{width:"100%"},disabled:i})})},J=e=>{let{teams:s,value:t,onChange:l,disabled:a}=e;return console.log("disabled",a),(0,c.jsx)(C.default,{showSearch:!0,placeholder:"Search or select a team",value:t,onChange:l,disabled:a,filterOption:(e,t)=>{if(!t)return!1;let l=null==s?void 0:s.find(e=>e.team_id===t.key);if(!l)return!1;let a=e.toLowerCase().trim(),r=(l.team_alias||"").toLowerCase(),i=(l.team_id||"").toLowerCase();return r.includes(a)||i.includes(a)},optionFilterProp:"children",children:null==s?void 0:s.map(e=>(0,c.jsxs)(C.default.Option,{value:e.team_id,children:[(0,c.jsx)("span",{className:"font-medium",children:e.team_alias})," ",(0,c.jsxs)("span",{className:"text-gray-500",children:["(",e.team_id,")"]})]},e.team_id))})},Y=t(23496),W=t(12514),$=t(91777),Q=t(82182),X=t(22452),ee=t(74998);(l=i||(i={})).Braintrust="Braintrust",l.CustomCallbackAPI="Custom Callback API",l.Datadog="Datadog",l.Langfuse="Langfuse",l.LangSmith="LangSmith",l.Lago="Lago",l.OpenMeter="OpenMeter",l.OTel="Open Telemetry",l.S3="S3",l.Arize="Arize";let es={Braintrust:"braintrust",CustomCallbackAPI:"custom_callback_api",Datadog:"datadog",Langfuse:"langfuse",LangSmith:"langsmith",Lago:"lago",OpenMeter:"openmeter",OTel:"otel",S3:"s3",Arize:"arize"},et=Object.fromEntries(Object.entries(es).map(e=>{let[s,t]=e;return[t,s]})),el=e=>e.map(e=>et[e]||e),ea=e=>e.map(e=>es[e]||e),er="/assets/logos/",ei={Langfuse:{logo:"".concat(er,"langfuse.png"),supports_key_team_logging:!0,dynamic_params:{langfuse_public_key:"text",langfuse_secret_key:"password",langfuse_host:"text"}},Arize:{logo:"".concat(er,"arize.png"),supports_key_team_logging:!0,dynamic_params:{arize_api_key:"password",arize_space_id:"text"}},LangSmith:{logo:"".concat(er,"langsmith.png"),supports_key_team_logging:!0,dynamic_params:{langsmith_api_key:"password",langsmith_project:"text",langsmith_base_url:"text"}},Braintrust:{logo:"".concat(er,"braintrust.png"),supports_key_team_logging:!1,dynamic_params:{}},"Custom Callback API":{logo:"".concat(er,"custom.svg"),supports_key_team_logging:!0,dynamic_params:{}},Datadog:{logo:"".concat(er,"datadog.png"),supports_key_team_logging:!1,dynamic_params:{}},Lago:{logo:"".concat(er,"lago.svg"),supports_key_team_logging:!1,dynamic_params:{}},OpenMeter:{logo:"".concat(er,"openmeter.png"),supports_key_team_logging:!1,dynamic_params:{}},"Open Telemetry":{logo:"".concat(er,"otel.png"),supports_key_team_logging:!1,dynamic_params:{}},S3:{logo:"".concat(er,"aws.svg"),supports_key_team_logging:!1,dynamic_params:{}}},{Option:en}=C.default;var eo=e=>{let{value:s=[],onChange:t,disabledCallbacks:l=[],onDisabledCallbacksChange:a}=e,r=Object.entries(ei).filter(e=>{let[s,t]=e;return t.supports_key_team_logging}).map(e=>{let[s,t]=e;return s}),i=Object.keys(ei),n=e=>{null==t||t(e)},o=e=>{n(s.filter((s,t)=>t!==e))},d=(e,t,l)=>{let a=[...s];if("callback_name"===t){let s=es[l]||l;a[e]={...a[e],[t]:s,callback_vars:{}}}else a[e]={...a[e],[t]:l};n(a)},m=(e,t,l)=>{let a=[...s];a[e]={...a[e],callback_vars:{...a[e].callback_vars,[t]:l}},n(a)},u=(e,s)=>{var t,l;if(!e.callback_name)return null;let a=null===(t=Object.entries(es).find(s=>{let[t,l]=s;return l===e.callback_name}))||void 0===t?void 0:t[0];if(!a)return null;let r=(null===(l=ei[a])||void 0===l?void 0:l.dynamic_params)||{};return 0===Object.keys(r).length?null:(0,c.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-100",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,c.jsx)("div",{className:"w-3 h-3 bg-blue-100 rounded-full flex items-center justify-center",children:(0,c.jsx)("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"})}),(0,c.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Integration Parameters"})]}),(0,c.jsx)("div",{className:"grid grid-cols-1 gap-4",children:Object.entries(r).map(t=>{let[l,a]=t;return(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("label",{className:"text-sm font-medium text-gray-700 capitalize flex items-center space-x-1",children:[(0,c.jsx)("span",{children:l.replace(/_/g," ")}),(0,c.jsx)(z.Z,{title:"Environment variable reference recommended: os.environ/".concat(l.toUpperCase()),children:(0,c.jsx)(U.Z,{className:"text-gray-400 cursor-help text-xs"})}),"password"===a&&(0,c.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800",children:"Sensitive"})]}),(0,c.jsx)(y.Z,{type:"password"===a?"password":"text",placeholder:"os.environ/".concat(l.toUpperCase()),value:e.callback_vars[l]||"",onChange:e=>m(s,l,e.target.value)})]},l)})})]})};return(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)($.Z,{className:"w-5 h-5 text-red-500"}),(0,c.jsx)("span",{className:"text-base font-semibold text-gray-800",children:"Disabled Callbacks"}),(0,c.jsx)(z.Z,{title:"Select callbacks to disable for this key. Disabled callbacks will not receive any logging data.",children:(0,c.jsx)(U.Z,{className:"text-gray-400 cursor-help"})})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Disabled Callbacks"}),(0,c.jsx)(C.default,{mode:"multiple",placeholder:"Select callbacks to disable",value:l,onChange:e=>{let s=ea(e);null==a||a(s)},style:{width:"100%"},optionLabelProp:"label",children:i.map(e=>{var s;let t=null===(s=ei[e])||void 0===s?void 0:s.logo;return(0,c.jsx)(en,{value:e,label:e,children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,c.jsx)("img",{src:t,alt:e,className:"w-4 h-4 object-contain"}),(0,c.jsx)("span",{children:e})]})},e)})}),(0,c.jsx)("div",{className:"text-xs text-gray-500",children:"Select callbacks that should be disabled for this key. These callbacks will not receive any logging data."})]})]}),(0,c.jsx)(Y.Z,{}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(Q.Z,{className:"w-5 h-5 text-blue-500"}),(0,c.jsx)("span",{className:"text-base font-semibold text-gray-800",children:"Logging Integrations"}),(0,c.jsx)(z.Z,{title:"Configure callback logging integrations for this team.",children:(0,c.jsx)(U.Z,{className:"text-gray-400 cursor-help"})})]}),(0,c.jsx)(_.Z,{variant:"secondary",onClick:()=>{n([...s,{callback_name:"",callback_type:"success",callback_vars:{}}])},icon:X.Z,size:"sm",className:"hover:border-blue-400 hover:text-blue-500",type:"button",children:"Add Integration"})]}),(0,c.jsx)("div",{className:"space-y-4",children:s.map((e,s)=>{var t,l;let a=e.callback_name?null===(t=Object.entries(es).find(s=>{let[t,l]=s;return l===e.callback_name}))||void 0===t?void 0:t[0]:void 0,i=a?null===(l=ei[a])||void 0===l?void 0:l.logo:null;return(0,c.jsxs)(W.Z,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200",decoration:"top",decorationColor:"blue",children:[(0,c.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[i&&(0,c.jsx)("img",{src:i,alt:a,className:"w-5 h-5 object-contain"}),(0,c.jsxs)("span",{className:"text-sm font-medium",children:[a||"New Integration"," Configuration"]})]}),(0,c.jsx)(_.Z,{variant:"light",onClick:()=>o(s),icon:ee.Z,size:"xs",color:"red",className:"hover:bg-red-50",type:"button",children:"Remove"})]}),(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Integration Type"}),(0,c.jsx)(C.default,{value:a,placeholder:"Select integration",onChange:e=>d(s,"callback_name",e),className:"w-full",optionLabelProp:"label",children:r.map(e=>{var s;let t=null===(s=ei[e])||void 0===s?void 0:s.logo;return(0,c.jsx)(en,{value:e,label:e,children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,c.jsx)("img",{src:t,alt:e,className:"w-4 h-4 object-contain"}),(0,c.jsx)("span",{children:e})]})},e)})})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Event Type"}),(0,c.jsxs)(C.default,{value:e.callback_type,onChange:e=>d(s,"callback_type",e),className:"w-full",children:[(0,c.jsx)(en,{value:"success",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,c.jsx)("span",{children:"Success Only"})]})}),(0,c.jsx)(en,{value:"failure",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),(0,c.jsx)("span",{children:"Failure Only"})]})}),(0,c.jsx)(en,{value:"success_and_failure",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,c.jsx)("span",{children:"Success & Failure"})]})})]})]})]}),u(e,s)]})]},s)})}),0===s.length&&(0,c.jsxs)("div",{className:"text-center py-12 text-gray-500 border-2 border-dashed border-gray-200 rounded-lg bg-gray-50/50",children:[(0,c.jsx)(Q.Z,{className:"w-12 h-12 text-gray-300 mb-3 mx-auto"}),(0,c.jsx)("div",{className:"text-base font-medium mb-1",children:"No logging integrations configured"}),(0,c.jsx)("div",{className:"text-sm text-gray-400",children:'Click "Add Integration" to configure logging for this team'})]})]})},ec=function(e){let{value:s,onChange:t,premiumUser:l=!1,disabledCallbacks:a=[],onDisabledCallbacksChange:r}=e;return l?(0,c.jsx)(eo,{value:s,onChange:t,disabledCallbacks:a,onDisabledCallbacksChange:r}):(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[(0,c.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-green-50 border border-green-200 text-green-800 text-sm font-medium opacity-50",children:"✨ langfuse-logging"}),(0,c.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-green-50 border border-green-200 text-green-800 text-sm font-medium opacity-50",children:"✨ datadog-logging"})]}),(0,c.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,c.jsxs)(w.Z,{className:"text-sm text-yellow-800",children:["Setting Key/Team logging settings is a LiteLLM Enterprise feature. Global Logging Settings are available for all free users. Get a trial key ",(0,c.jsx)("a",{href:"https://www.litellm.ai/#pricing",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"here"}),"."]})})]})},ed=t(57365),em=t(93192);function eu(e){let{isInvitationLinkModalVisible:s,setIsInvitationLinkModalVisible:t,baseUrl:l,invitationLinkData:a,modalType:r="invitation"}=e,{Title:i,Paragraph:n}=em.default,o=()=>{if(!l)return"";let e=new URL(l).pathname,s=e&&"/"!==e?"".concat(e,"/ui"):"ui";if(null==a?void 0:a.has_user_setup_sso)return new URL(s,l).toString();let t="".concat(s,"?invitation_id=").concat(null==a?void 0:a.id);return"resetPassword"===r&&(t+="&action=reset_password"),new URL(t,l).toString()};return(0,c.jsxs)(A.Z,{title:"invitation"===r?"Invitation Link":"Reset Password Link",visible:s,width:800,footer:null,onOk:()=>{t(!1)},onCancel:()=>{t(!1)},children:[(0,c.jsx)(n,{children:"invitation"===r?"Copy and send the generated link to onboard this user to the proxy.":"Copy and send the generated link to the user to reset their password."}),(0,c.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,c.jsx)(w.Z,{className:"text-base",children:"User ID"}),(0,c.jsx)(w.Z,{children:null==a?void 0:a.user_id})]}),(0,c.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,c.jsx)(w.Z,{children:"invitation"===r?"Invitation Link":"Reset Password Link"}),(0,c.jsx)(w.Z,{children:(0,c.jsx)(w.Z,{children:o()})})]}),(0,c.jsx)("div",{className:"flex justify-end mt-5",children:(0,c.jsx)(S.CopyToClipboard,{text:o(),onCopy:()=>P.ZP.success("Copied!"),children:(0,c.jsx)(_.Z,{variant:"primary",children:"invitation"===r?"Copy invitation link":"Copy password reset link"})})})]})}var ex=t(85010),eh=t(72188),ep=t(73879),eg=t(34310),ej=t(38434),ef=t(26349),ev=t(35291),e_=t(3632),ey=t(15452),eb=t.n(ey),eN=t(71157),eZ=t(44643),ew=t(88532),ek=e=>{let{accessToken:s,teams:t,possibleUIRoles:l,onUsersCreated:a}=e,[r,i]=(0,d.useState)(!1),[n,o]=(0,d.useState)([]),[m,u]=(0,d.useState)(!1),[x,h]=(0,d.useState)(null),[p,j]=(0,d.useState)(null),[f,v]=(0,d.useState)(null),[y,b]=(0,d.useState)(null),[N,Z]=(0,d.useState)(null),[k,C]=(0,d.useState)("http://localhost:4000");(0,d.useEffect)(()=>{(async()=>{try{let e=await (0,g.getProxyUISettings)(s);Z(e)}catch(e){console.error("Error fetching UI settings:",e)}})(),C(new URL("/",window.location.href).toString())},[s]);let I=async()=>{u(!0);let e=n.map(e=>({...e,status:"pending"}));o(e);let t=!1;for(let a=0;a<e.length;a++){var l,r,i;let n=e[a];try{let e={user_email:n.user_email,user_role:n.user_role};if(n.teams&&"string"==typeof n.teams&&""!==n.teams.trim()&&(e.teams=n.teams.split(",").map(e=>e.trim()).filter(Boolean),0===e.teams.length&&delete e.teams),n.models&&"string"==typeof n.models&&""!==n.models.trim()&&(e.models=n.models.split(",").map(e=>e.trim()).filter(Boolean),0===e.models.length&&delete e.models),n.max_budget&&""!==n.max_budget.toString().trim()){let s=parseFloat(n.max_budget.toString());!isNaN(s)&&s>0&&(e.max_budget=s)}n.budget_duration&&""!==n.budget_duration.trim()&&(e.budget_duration=n.budget_duration.trim()),n.metadata&&"string"==typeof n.metadata&&""!==n.metadata.trim()&&(e.metadata=n.metadata.trim()),console.log("Sending user data:",e);let r=await (0,g.userCreateCall)(s,null,e);if(console.log("Full response:",r),r&&(r.key||r.user_id)){t=!0,console.log("Success case triggered");let e=(null===(l=r.data)||void 0===l?void 0:l.user_id)||r.user_id;try{if(null==N?void 0:N.SSO_ENABLED){let e=new URL("/ui",k).toString();o(s=>s.map((s,t)=>t===a?{...s,status:"success",key:r.key||r.user_id,invitation_link:e}:s))}else{let t=await (0,g.invitationCreateCall)(s,e),l=new URL("/ui?invitation_id=".concat(t.id),k).toString();o(e=>e.map((e,s)=>s===a?{...e,status:"success",key:r.key||r.user_id,invitation_link:l}:e))}}catch(e){console.error("Error creating invitation:",e),o(e=>e.map((e,s)=>s===a?{...e,status:"success",key:r.key||r.user_id,error:"User created but failed to generate invitation link"}:e))}}else{console.log("Error case triggered");let e=(null==r?void 0:r.error)||"Failed to create user";console.log("Error message:",e),o(s=>s.map((s,t)=>t===a?{...s,status:"failed",error:e}:s))}}catch(s){console.error("Caught error:",s);let e=(null==s?void 0:null===(i=s.response)||void 0===i?void 0:null===(r=i.data)||void 0===r?void 0:r.error)||(null==s?void 0:s.message)||String(s);o(s=>s.map((s,t)=>t===a?{...s,status:"failed",error:e}:s))}}u(!1),t&&a&&a()};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(_.Z,{className:"mb-0",onClick:()=>i(!0),children:"+ Bulk Invite Users"}),(0,c.jsx)(A.Z,{title:"Bulk Invite Users",visible:r,width:800,onCancel:()=>i(!1),bodyStyle:{maxHeight:"70vh",overflow:"auto"},footer:null,children:(0,c.jsx)("div",{className:"flex flex-col",children:0===n.length?(0,c.jsxs)("div",{className:"mb-6",children:[(0,c.jsxs)("div",{className:"flex items-center mb-4",children:[(0,c.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"1"}),(0,c.jsx)("h3",{className:"text-lg font-medium",children:"Download and fill the template"})]}),(0,c.jsxs)("div",{className:"ml-11 mb-6",children:[(0,c.jsx)("p",{className:"mb-4",children:"Add multiple users at once by following these steps:"}),(0,c.jsxs)("ol",{className:"list-decimal list-inside space-y-2 ml-2 mb-4",children:[(0,c.jsx)("li",{children:"Download our CSV template"}),(0,c.jsx)("li",{children:"Add your users' information to the spreadsheet"}),(0,c.jsx)("li",{children:"Save the file and upload it here"}),(0,c.jsx)("li",{children:"After creation, download the results file containing the API keys for each user"})]}),(0,c.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200 mb-4",children:[(0,c.jsx)("h4",{className:"font-medium mb-2",children:"Template Column Names"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"font-medium",children:"user_email"}),(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"User's email address (required)"})]})]}),(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"font-medium",children:"user_role"}),(0,c.jsx)("p",{className:"text-sm text-gray-600",children:'User\'s role (one of: "proxy_admin", "proxy_admin_view_only", "internal_user", "internal_user_view_only")'})]})]}),(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"font-medium",children:"teams"}),(0,c.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated team IDs (e.g., "team-1,team-2")'})]})]}),(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"font-medium",children:"max_budget"}),(0,c.jsx)("p",{className:"text-sm text-gray-600",children:'Maximum budget as a number (e.g., "100")'})]})]}),(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"font-medium",children:"budget_duration"}),(0,c.jsx)("p",{className:"text-sm text-gray-600",children:'Budget reset period (e.g., "30d", "1mo")'})]})]}),(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"font-medium",children:"models"}),(0,c.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated allowed models (e.g., "gpt-3.5-turbo,gpt-4")'})]})]})]})]}),(0,c.jsxs)(_.Z,{onClick:()=>{let e=new Blob([eb().unparse([["user_email","user_role","teams","max_budget","budget_duration","models"],["user@example.com","internal_user","team-id-1,team-id-2","100","30d","gpt-3.5-turbo,gpt-4"]])],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="bulk_users_template.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(s)},size:"lg",className:"w-full md:w-auto",children:[(0,c.jsx)(ep.Z,{className:"mr-2"})," Download CSV Template"]})]}),(0,c.jsxs)("div",{className:"flex items-center mb-4",children:[(0,c.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"2"}),(0,c.jsx)("h3",{className:"text-lg font-medium",children:"Upload your completed CSV"})]}),(0,c.jsxs)("div",{className:"ml-11",children:[y?(0,c.jsxs)("div",{className:"mb-4 p-4 rounded-md border ".concat(f?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"),children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center",children:[f?(0,c.jsx)(eg.Z,{className:"text-red-500 text-xl mr-3"}):(0,c.jsx)(ej.Z,{className:"text-blue-500 text-xl mr-3"}),(0,c.jsxs)("div",{children:[(0,c.jsx)(em.default.Text,{strong:!0,className:f?"text-red-800":"text-blue-800",children:y.name}),(0,c.jsxs)(em.default.Text,{className:"block text-xs ".concat(f?"text-red-600":"text-blue-600"),children:[(y.size/1024).toFixed(1)," KB • ",new Date().toLocaleDateString()]})]})]}),(0,c.jsxs)(_.Z,{size:"xs",variant:"secondary",onClick:()=>{b(null),o([]),h(null),j(null),v(null)},className:"flex items-center",children:[(0,c.jsx)(ef.Z,{className:"mr-1"})," Remove"]})]}),f?(0,c.jsxs)("div",{className:"mt-3 text-red-600 text-sm flex items-start",children:[(0,c.jsx)(ev.Z,{className:"mr-2 mt-0.5"}),(0,c.jsx)("span",{children:f})]}):!p&&(0,c.jsxs)("div",{className:"mt-3 flex items-center",children:[(0,c.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,c.jsx)("div",{className:"bg-blue-500 h-1.5 rounded-full w-full animate-pulse"})}),(0,c.jsx)("span",{className:"ml-2 text-xs text-blue-600",children:"Processing..."})]})]}):(0,c.jsx)(ex.default,{beforeUpload:e=>((h(null),j(null),v(null),b(e),"text/csv"===e.type||e.name.endsWith(".csv"))?e.size>5242880?v("File is too large (".concat((e.size/1048576).toFixed(1)," MB). Please upload a CSV file smaller than 5MB.")):eb().parse(e,{complete:e=>{if(!e.data||0===e.data.length){j("The CSV file appears to be empty. Please upload a file with data."),o([]);return}if(1===e.data.length){j("The CSV file only contains headers but no user data. Please add user data to your CSV."),o([]);return}let s=e.data[0];if(0===s.length||1===s.length&&""===s[0]){j("The CSV file doesn't contain any column headers. Please make sure your CSV has headers."),o([]);return}let l=["user_email","user_role"].filter(e=>!s.includes(e));if(l.length>0){j("Your CSV is missing these required columns: ".concat(l.join(", "),". Please add these columns to your CSV file.")),o([]);return}try{let l=e.data.slice(1).map((e,l)=>{var a,r,i,n,o,c;if(0===e.length||1===e.length&&""===e[0])return null;if(e.length<s.length)return{rowNumber:l+2,isValid:!1,error:"Row ".concat(l+2," has fewer columns than the header row. Please ensure all data is properly formatted."),user_email:"",user_role:""};let d={user_email:(null===(a=e[s.indexOf("user_email")])||void 0===a?void 0:a.trim())||"",user_role:(null===(r=e[s.indexOf("user_role")])||void 0===r?void 0:r.trim())||"",teams:null===(i=e[s.indexOf("teams")])||void 0===i?void 0:i.trim(),max_budget:null===(n=e[s.indexOf("max_budget")])||void 0===n?void 0:n.trim(),budget_duration:null===(o=e[s.indexOf("budget_duration")])||void 0===o?void 0:o.trim(),models:null===(c=e[s.indexOf("models")])||void 0===c?void 0:c.trim(),rowNumber:l+2,isValid:!0,error:""},m=[];if(d.user_email?d.user_email.includes("@")&&d.user_email.includes(".")||m.push("Invalid email format (must contain @ and domain)"):m.push("Email is required"),d.user_role){let e=["proxy_admin","proxy_admin_view_only","internal_user","internal_user_view_only"];e.includes(d.user_role)||m.push('Invalid role "'.concat(d.user_role,'". Must be one of: ').concat(e.join(", ")))}else m.push("Role is required");if(d.max_budget&&""!==d.max_budget.toString().trim()&&(isNaN(parseFloat(d.max_budget.toString()))?m.push('Max budget "'.concat(d.max_budget,'" must be a number')):0>=parseFloat(d.max_budget.toString())&&m.push("Max budget must be greater than 0")),d.budget_duration&&!d.budget_duration.match(/^\d+[dhmwy]$|^\d+mo$/)&&m.push('Invalid budget duration format "'.concat(d.budget_duration,'". Use format like "30d", "1mo", "2w", "6h"')),d.teams&&"string"==typeof d.teams&&t&&t.length>0){let e=t.map(e=>e.team_id),s=d.teams.split(",").map(e=>e.trim()).filter(s=>!e.includes(s));s.length>0&&m.push("Unknown team(s): ".concat(s.join(", ")))}return m.length>0&&(d.isValid=!1,d.error=m.join(", ")),d}).filter(Boolean),a=l.filter(e=>e.isValid);o(l),0===l.length?j("No valid data rows found in the CSV file. Please check your file format."):0===a.length?h("No valid users found in the CSV. Please check the errors below and fix your CSV file."):a.length<l.length?h("Found ".concat(l.length-a.length," row(s) with errors out of ").concat(l.length," total rows. Please correct them before proceeding.")):P.ZP.success("Successfully parsed ".concat(a.length," users"))}catch(s){let e=s instanceof Error?s.message:"Unknown error";h("Error parsing CSV: ".concat(e)),o([])}},error:e=>{h("Failed to parse CSV file: ".concat(e.message)),o([])},header:!1}):(v("Invalid file type: ".concat(e.name,". Please upload a CSV file (.csv extension).")),P.ZP.error("Invalid file type. Please upload a CSV file.")),!1),accept:".csv",maxCount:1,showUploadList:!1,children:(0,c.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-colors cursor-pointer",children:[(0,c.jsx)(e_.Z,{className:"text-3xl text-gray-400 mb-2"}),(0,c.jsx)("p",{className:"mb-1",children:"Drag and drop your CSV file here"}),(0,c.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"or"}),(0,c.jsx)(_.Z,{size:"sm",children:"Browse files"}),(0,c.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"Only CSV files (.csv) are supported"})]})}),p&&(0,c.jsx)("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)(ew.Z,{className:"h-5 w-5 text-yellow-500 mr-2 mt-0.5"}),(0,c.jsxs)("div",{children:[(0,c.jsx)(em.default.Text,{strong:!0,className:"text-yellow-800",children:"CSV Structure Error"}),(0,c.jsx)(em.default.Paragraph,{className:"text-yellow-700 mt-1 mb-0",children:p}),(0,c.jsx)(em.default.Paragraph,{className:"text-yellow-700 mt-2 mb-0",children:"Please download our template and ensure your CSV follows the required format."})]})]})})]})]}):(0,c.jsxs)("div",{className:"mb-6",children:[(0,c.jsxs)("div",{className:"flex items-center mb-4",children:[(0,c.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"3"}),(0,c.jsx)("h3",{className:"text-lg font-medium",children:n.some(e=>"success"===e.status||"failed"===e.status)?"User Creation Results":"Review and create users"})]}),x&&(0,c.jsx)("div",{className:"ml-11 mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)(ev.Z,{className:"text-red-500 mr-2 mt-1"}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"text-red-600 font-medium",children:x}),n.some(e=>!e.isValid)&&(0,c.jsxs)("ul",{className:"mt-2 list-disc list-inside text-red-600 text-sm",children:[(0,c.jsx)("li",{children:"Check the table below for specific errors in each row"}),(0,c.jsx)("li",{children:"Common issues include invalid email formats, missing required fields, or incorrect role values"}),(0,c.jsx)("li",{children:"Fix these issues in your CSV file and upload again"})]})]})]})}),(0,c.jsxs)("div",{className:"ml-11",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,c.jsx)("div",{className:"flex items-center",children:n.some(e=>"success"===e.status||"failed"===e.status)?(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(w.Z,{className:"text-lg font-medium mr-3",children:"Creation Summary"}),(0,c.jsxs)(w.Z,{className:"text-sm bg-green-100 text-green-800 px-2 py-1 rounded mr-2",children:[n.filter(e=>"success"===e.status).length," Successful"]}),n.some(e=>"failed"===e.status)&&(0,c.jsxs)(w.Z,{className:"text-sm bg-red-100 text-red-800 px-2 py-1 rounded",children:[n.filter(e=>"failed"===e.status).length," Failed"]})]}):(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(w.Z,{className:"text-lg font-medium mr-3",children:"User Preview"}),(0,c.jsxs)(w.Z,{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded",children:[n.filter(e=>e.isValid).length," of ",n.length," users valid"]})]})}),!n.some(e=>"success"===e.status||"failed"===e.status)&&(0,c.jsxs)("div",{className:"flex space-x-3",children:[(0,c.jsx)(_.Z,{onClick:()=>{o([]),h(null)},variant:"secondary",children:"Back"}),(0,c.jsx)(_.Z,{onClick:I,disabled:0===n.filter(e=>e.isValid).length||m,children:m?"Creating...":"Create ".concat(n.filter(e=>e.isValid).length," Users")})]})]}),n.some(e=>"success"===e.status)&&(0,c.jsx)("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)("div",{className:"mr-3 mt-1",children:(0,c.jsx)(eZ.Z,{className:"h-5 w-5 text-blue-500"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium text-blue-800",children:"User creation complete"}),(0,c.jsxs)(w.Z,{className:"block text-sm text-blue-700 mt-1",children:[(0,c.jsx)("span",{className:"font-medium",children:"Next step:"})," Download the credentials file containing API keys and invitation links. Users will need these API keys to make LLM requests through LiteLLM."]})]})]})}),(0,c.jsx)(eh.Z,{dataSource:n,columns:[{title:"Row",dataIndex:"rowNumber",key:"rowNumber",width:80},{title:"Email",dataIndex:"user_email",key:"user_email"},{title:"Role",dataIndex:"user_role",key:"user_role"},{title:"Teams",dataIndex:"teams",key:"teams"},{title:"Budget",dataIndex:"max_budget",key:"max_budget"},{title:"Status",key:"status",render:(e,s)=>s.isValid?s.status&&"pending"!==s.status?"success"===s.status?(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(eZ.Z,{className:"h-5 w-5 text-green-500 mr-2"}),(0,c.jsx)("span",{className:"text-green-500",children:"Success"})]}),s.invitation_link&&(0,c.jsx)("div",{className:"mt-1",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("span",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:s.invitation_link}),(0,c.jsx)(S.CopyToClipboard,{text:s.invitation_link,onCopy:()=>P.ZP.success("Invitation link copied!"),children:(0,c.jsx)("button",{className:"ml-1 text-blue-500 text-xs hover:text-blue-700",children:"Copy"})})]})})]}):(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(eN.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,c.jsx)("span",{className:"text-red-500",children:"Failed"})]}),s.error&&(0,c.jsx)("span",{className:"text-sm text-red-500 ml-7",children:JSON.stringify(s.error)})]}):(0,c.jsx)("span",{className:"text-gray-500",children:"Pending"}):(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(eN.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,c.jsx)("span",{className:"text-red-500",children:"Invalid"})]}),s.error&&(0,c.jsx)("span",{className:"text-sm text-red-500 ml-7",children:s.error})]})}],size:"small",pagination:{pageSize:5},scroll:{y:300},rowClassName:e=>e.isValid?"":"bg-red-50"}),!n.some(e=>"success"===e.status||"failed"===e.status)&&(0,c.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,c.jsx)(_.Z,{onClick:()=>{o([]),h(null)},variant:"secondary",className:"mr-3",children:"Back"}),(0,c.jsx)(_.Z,{onClick:I,disabled:0===n.filter(e=>e.isValid).length||m,children:m?"Creating...":"Create ".concat(n.filter(e=>e.isValid).length," Users")})]}),n.some(e=>"success"===e.status||"failed"===e.status)&&(0,c.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,c.jsx)(_.Z,{onClick:()=>{o([]),h(null)},variant:"secondary",className:"mr-3",children:"Start New Bulk Import"}),(0,c.jsxs)(_.Z,{onClick:()=>{let e=n.map(e=>({user_email:e.user_email,user_role:e.user_role,status:e.status,key:e.key||"",invitation_link:e.invitation_link||"",error:e.error||""})),s=new Blob([eb().unparse(e)],{type:"text/csv"}),t=window.URL.createObjectURL(s),l=document.createElement("a");l.href=t,l.download="bulk_users_results.csv",document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(t)},variant:"primary",className:"flex items-center",children:[(0,c.jsx)(ep.Z,{className:"mr-2"})," Download User Credentials"]})]})]})]})})})]})};let{Option:eS}=C.default,eC=()=>"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let s=16*Math.random()|0;return("x"==e?s:3&s|8).toString(16)});var eI=e=>{let{userID:s,accessToken:t,teams:l,possibleUIRoles:a,onUserCreated:r,isEmbedded:i=!1}=e,n=(0,h.NL)(),[o,m]=(0,d.useState)(null),[u]=I.Z.useForm(),[x,p]=(0,d.useState)(!1),[j,f]=(0,d.useState)(!1),[v,S]=(0,d.useState)([]),[E,O]=(0,d.useState)(!1),[M,D]=(0,d.useState)(null),[R,q]=(0,d.useState)(null);(0,d.useEffect)(()=>{let e=async()=>{try{let e=await (0,g.modelAvailableCall)(t,s,"any"),l=[];for(let s=0;s<e.data.length;s++){let t=e.data[s];l.push(t.id)}console.log("Model data response:",e.data),console.log("Available models:",l),S(l);let a=await (0,g.getProxyUISettings)(t);console.log("uiSettingsResponse:",a),m(a)}catch(e){console.error("Error fetching model data:",e)}};q((0,g.getProxyBaseUrl)()),e()},[]);let V=async e=>{var l,a,c;try{P.ZP.info("Making API Call"),i||p(!0),e.models&&0!==e.models.length||"proxy_admin"===e.user_role||(console.log("formValues.user_role",e.user_role),e.models=["no-default-models"]),console.log("formValues in create user:",e);let a=await (0,g.userCreateCall)(t,null,e);await n.invalidateQueries({queryKey:["userList"]}),console.log("user create Response:",a),f(!0);let c=(null===(l=a.data)||void 0===l?void 0:l.user_id)||a.user_id;if(r&&i){r(c),u.resetFields();return}if(null==o?void 0:o.SSO_ENABLED){let e={id:eC(),user_id:c,is_accepted:!1,accepted_at:null,expires_at:new Date(Date.now()+6048e5),created_at:new Date,created_by:s,updated_at:new Date,updated_by:s,has_user_setup_sso:!0};D(e),O(!0)}else(0,g.invitationCreateCall)(t,c).then(e=>{e.has_user_setup_sso=!1,D(e),O(!0)});P.ZP.success("API user Created"),u.resetFields(),localStorage.removeItem("userData"+s)}catch(s){let e=(null===(c=s.response)||void 0===c?void 0:null===(a=c.data)||void 0===a?void 0:a.detail)||(null==s?void 0:s.message)||"Error creating the user";P.ZP.error(e),console.error("Error creating the user:",s)}};return i?(0,c.jsxs)(I.Z,{form:u,onFinish:V,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsx)(I.Z.Item,{label:"User Email",name:"user_email",children:(0,c.jsx)(y.Z,{placeholder:""})}),(0,c.jsx)(I.Z.Item,{label:"User Role",name:"user_role",children:(0,c.jsx)(C.default,{children:a&&Object.entries(a).map(e=>{let[s,{ui_label:t,description:l}]=e;return(0,c.jsx)(ed.Z,{value:s,title:t,children:(0,c.jsxs)("div",{className:"flex",children:[t," ",(0,c.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:l})]})},s)})})}),(0,c.jsx)(I.Z.Item,{label:"Team ID",name:"team_id",children:(0,c.jsx)(C.default,{placeholder:"Select Team ID",style:{width:"100%"},children:l?l.map(e=>(0,c.jsx)(eS,{value:e.team_id,children:e.team_alias},e.team_id)):(0,c.jsx)(eS,{value:null,children:"Default Team"},"default")})}),(0,c.jsx)(I.Z.Item,{label:"Metadata",name:"metadata",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Create User"})})]}):(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(_.Z,{className:"mb-0",onClick:()=>p(!0),children:"+ Invite User"}),(0,c.jsx)(ek,{accessToken:t,teams:l,possibleUIRoles:a}),(0,c.jsxs)(A.Z,{title:"Invite User",visible:x,width:800,footer:null,onOk:()=>{p(!1),u.resetFields()},onCancel:()=>{p(!1),f(!1),u.resetFields()},children:[(0,c.jsx)(w.Z,{className:"mb-1",children:"Create a User who can own keys"}),(0,c.jsxs)(I.Z,{form:u,onFinish:V,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsx)(I.Z.Item,{label:"User Email",name:"user_email",children:(0,c.jsx)(y.Z,{placeholder:""})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Global Proxy Role"," ",(0,c.jsx)(z.Z,{title:"This is the role that the user will globally on the proxy. This role is independent of any team/org specific roles.",children:(0,c.jsx)(U.Z,{})})]}),name:"user_role",children:(0,c.jsx)(C.default,{children:a&&Object.entries(a).map(e=>{let[s,{ui_label:t,description:l}]=e;return(0,c.jsx)(ed.Z,{value:s,title:t,children:(0,c.jsxs)("div",{className:"flex",children:[t," ",(0,c.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:l})]})},s)})})}),(0,c.jsx)(I.Z.Item,{label:"Team ID",className:"gap-2",name:"team_id",help:"If selected, user will be added as a 'user' role to the team.",children:(0,c.jsx)(C.default,{placeholder:"Select Team ID",style:{width:"100%"},children:l?l.map(e=>(0,c.jsx)(eS,{value:e.team_id,children:e.team_alias},e.team_id)):(0,c.jsx)(eS,{value:null,children:"Default Team"},"default")})}),(0,c.jsx)(I.Z.Item,{label:"Metadata",name:"metadata",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,c.jsxs)(b.Z,{children:[(0,c.jsx)(Z.Z,{children:(0,c.jsx)(k.Z,{children:"Personal Key Creation"})}),(0,c.jsx)(N.Z,{children:(0,c.jsx)(I.Z.Item,{className:"gap-2",label:(0,c.jsxs)("span",{children:["Models"," ",(0,c.jsx)(z.Z,{title:"Models user has access to, outside of team scope.",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"models",help:"Models user has access to, outside of team scope.",children:(0,c.jsxs)(C.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,c.jsx)(C.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),v.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:F(e)},e))]})})})]}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Create User"})})]})]}),j&&(0,c.jsx)(eu,{isInvitationLinkModalVisible:E,setIsInvitationLinkModalVisible:O,baseUrl:R||"",invitationLinkData:M})]})},eP=t(7310),eA=t.n(eP),eE=t(20347);let{Option:eT}=C.default,eL=e=>e?({"24h":"daily","7d":"weekly","30d":"monthly"})[e]||e:"Not set";var eO=e=>{let{value:s,onChange:t,className:l="",style:a={}}=e;return(0,c.jsxs)(C.default,{style:{width:"100%",...a},value:s||void 0,onChange:t,className:l,placeholder:"n/a",children:[(0,c.jsx)(eT,{value:"24h",children:"daily"}),(0,c.jsx)(eT,{value:"7d",children:"weekly"}),(0,c.jsx)(eT,{value:"30d",children:"monthly"})]})};function eM(e,s){let t=structuredClone(e);for(let[e,l]of Object.entries(s))e in t&&(t[e]=l);return t}let eD=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e?"-":e.toLocaleString("en-US",{minimumFractionDigits:s,maximumFractionDigits:s})},eF=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Copied to clipboard";if(!e)return!1;try{return await navigator.clipboard.writeText(e),P.ZP.success(s),!0}catch(e){return P.ZP.error("Failed to copy to clipboard"),console.error("Failed to copy: ",e),!1}};var eR=e=>{let{onChange:s,value:t,className:l,accessToken:a,placeholder:r="Select MCP servers",disabled:i=!1}=e,[n,o]=(0,d.useState)([]),[m,u]=(0,d.useState)([]),[x,h]=(0,d.useState)(!1);(0,d.useEffect)(()=>{(async()=>{if(a){h(!0);try{let[e,s]=await Promise.all([(0,g.fetchMCPServers)(a),(0,g.fetchMCPAccessGroups)(a)]),t=Array.isArray(e)?e:e.data||[],l=Array.isArray(s)?s:s.data||[];o(t),u(l)}catch(e){console.error("Error fetching MCP servers or access groups:",e)}finally{h(!1)}}})()},[a]);let p=[...m.map(e=>({label:e,value:e,isAccessGroup:!0,searchText:"".concat(e," Access Group")})),...n.map(e=>({label:"".concat(e.server_name||e.server_id," (").concat(e.server_id,")"),value:e.server_id,isAccessGroup:!1,searchText:"".concat(e.server_name||e.server_id," ").concat(e.server_id," MCP Server")}))],j=[...(null==t?void 0:t.servers)||[],...(null==t?void 0:t.accessGroups)||[]];return(0,c.jsx)("div",{children:(0,c.jsx)(C.default,{mode:"multiple",placeholder:r,onChange:e=>{s({servers:e.filter(e=>!m.includes(e)),accessGroups:e.filter(e=>m.includes(e))})},value:j,loading:x,className:l,showSearch:!0,style:{width:"100%"},disabled:i,filterOption:(e,s)=>{var t;return((null===(t=p.find(e=>e.value===(null==s?void 0:s.value)))||void 0===t?void 0:t.searchText)||"").toLowerCase().includes(e.toLowerCase())},children:p.map(e=>(0,c.jsx)(C.default.Option,{value:e.value,label:e.label,children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("span",{style:{display:"inline-block",width:8,height:8,borderRadius:"50%",background:e.isAccessGroup?"#52c41a":"#1890ff",flexShrink:0}}),(0,c.jsx)("span",{style:{flex:1},children:e.label}),(0,c.jsx)("span",{style:{color:e.isAccessGroup?"#52c41a":"#1890ff",fontSize:"12px",fontWeight:500,opacity:.8},children:e.isAccessGroup?"Access Group":"MCP Server"})]})},e.value))})})};let{Option:eq}=C.default,eU=e=>{let s=[];if(console.log("data:",JSON.stringify(e)),e)for(let t of e)t.metadata&&t.metadata.tags&&s.push(...t.metadata.tags);let t=Array.from(new Set(s)).map(e=>({value:e,label:e}));return console.log("uniqueTags:",t),t},ez=async(e,s,t,l)=>{try{if(null===e||null===s)return[];if(null!==t){let a=(await (0,g.modelAvailableCall)(t,e,s,!0,l,!0)).data.map(e=>e.id);return console.log("available_model_names:",a),a}return[]}catch(e){return console.error("Error fetching user models:",e),[]}},eV=async(e,s,t,l)=>{try{if(null===e||null===s)return;if(null!==t){let a=(await (0,g.modelAvailableCall)(t,e,s)).data.map(e=>e.id);console.log("available_model_names:",a),l(a)}}catch(e){console.error("Error fetching user models:",e)}};var eK=e=>{let{userID:s,team:t,teams:l,userRole:a,accessToken:r,data:i,addKey:n,premiumUser:o=!1}=e,[m]=I.Z.useForm(),[u,x]=(0,d.useState)(!1),[h,p]=(0,d.useState)(null),[j,O]=(0,d.useState)(null),[D,R]=(0,d.useState)([]),[q,V]=(0,d.useState)([]),[K,B]=(0,d.useState)("you"),[Y,W]=(0,d.useState)(eU(i)),[$,Q]=(0,d.useState)([]),[X,ee]=(0,d.useState)([]),[es,et]=(0,d.useState)(t),[el,er]=(0,d.useState)(!1),[ei,en]=(0,d.useState)(null),[eo,ed]=(0,d.useState)({}),[em,eu]=(0,d.useState)([]),[ex,eh]=(0,d.useState)(!1),[ep,eg]=(0,d.useState)([]),[ej,ef]=(0,d.useState)(!1),[ev,e_]=(0,d.useState)([]),[ey,eb]=(0,d.useState)("default"),eN=()=>{x(!1),m.resetFields(),ee([]),e_([]),eb("default")},eZ=()=>{x(!1),p(null),et(null),m.resetFields(),ee([]),e_([]),eb("default")};(0,d.useEffect)(()=>{s&&a&&r&&eV(s,a,r,R)},[r,s,a]);let ew=async()=>{try{if(null==r)return;let e=await (0,g.fetchMCPAccessGroups)(r);eg(e)}catch(e){console.error("Failed to fetch MCP access groups:",e)}};(0,d.useEffect)(()=>{ew()},[r]),(0,d.useEffect)(()=>{(async()=>{try{let e=(await (0,g.getGuardrailsList)(r)).guardrails.map(e=>e.guardrail_name);Q(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})()},[r]),(0,d.useEffect)(()=>{(async()=>{try{if(r){let e=sessionStorage.getItem("possibleUserRoles");if(e)ed(JSON.parse(e));else{let e=await (0,g.getPossibleUserRoles)(r);sessionStorage.setItem("possibleUserRoles",JSON.stringify(e)),ed(e)}}}catch(e){console.error("Error fetching possible user roles:",e)}})()},[r]);let ek=q.includes("no-default-models")&&!es,eS=async e=>{try{var t,l,a,o,c;let d;let u=null!==(a=null==e?void 0:e.key_alias)&&void 0!==a?a:"",h=null!==(o=null==e?void 0:e.team_id)&&void 0!==o?o:null;if((null!==(c=null==i?void 0:i.filter(e=>e.team_id===h).map(e=>e.key_alias))&&void 0!==c?c:[]).includes(u))throw Error("Key alias ".concat(u," already exists for team with ID ").concat(h,", please provide another key alias"));P.ZP.info("Making API Call"),x(!0),"you"===K&&(e.user_id=s);let j={};try{j=JSON.parse(e.metadata||"{}")}catch(e){console.error("Error parsing metadata:",e)}if("service_account"===K&&(j.service_account_id=e.key_alias),X.length>0&&(j={...j,logging:X.filter(e=>e.callback_name)}),ev.length>0){let e=ea(ev);j={...j,litellm_disabled_callbacks:e}}if(e.metadata=JSON.stringify(j),e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0&&(e.object_permission={vector_stores:e.allowed_vector_store_ids},delete e.allowed_vector_store_ids),e.allowed_mcp_servers_and_groups&&((null===(t=e.allowed_mcp_servers_and_groups.servers)||void 0===t?void 0:t.length)>0||(null===(l=e.allowed_mcp_servers_and_groups.accessGroups)||void 0===l?void 0:l.length)>0)){e.object_permission||(e.object_permission={});let{servers:s,accessGroups:t}=e.allowed_mcp_servers_and_groups;s&&s.length>0&&(e.object_permission.mcp_servers=s),t&&t.length>0&&(e.object_permission.mcp_access_groups=t),delete e.allowed_mcp_servers_and_groups}e.allowed_mcp_access_groups&&e.allowed_mcp_access_groups.length>0&&(e.object_permission||(e.object_permission={}),e.object_permission.mcp_access_groups=e.allowed_mcp_access_groups,delete e.allowed_mcp_access_groups),d="service_account"===K?await (0,g.keyCreateServiceAccountCall)(r,e):await (0,g.keyCreateCall)(r,s,e),console.log("key create Response:",d),n(d),p(d.key),O(d.soft_budget),P.ZP.success("API Key Created"),m.resetFields(),localStorage.removeItem("userData"+s)}catch(e){console.log("error in create key:",e),P.ZP.error("Error creating the key: ".concat(e))}};(0,d.useEffect)(()=>{if(s&&a&&r){var e;ez(s,a,r,null!==(e=null==es?void 0:es.team_id)&&void 0!==e?e:null).then(e=>{var s;V(Array.from(new Set([...null!==(s=null==es?void 0:es.models)&&void 0!==s?s:[],...e])))})}m.setFieldValue("models",[])},[es,r,s,a]);let eC=async e=>{if(!e){eu([]);return}eh(!0);try{let s=new URLSearchParams;if(s.append("user_email",e),null==r)return;let t=(await (0,g.userFilterUICall)(r,s)).map(e=>({label:"".concat(e.user_email," (").concat(e.user_id,")"),value:e.user_id,user:e}));eu(t)}catch(e){console.error("Error fetching users:",e),P.ZP.error("Failed to search for users")}finally{eh(!1)}},eP=(0,d.useCallback)(eA()(e=>eC(e),300),[r]),eT=(e,s)=>{let t=s.user;m.setFieldsValue({user_id:t.user_id})};return(0,c.jsxs)("div",{children:[a&&eE.LQ.includes(a)&&(0,c.jsx)(_.Z,{className:"mx-auto",onClick:()=>x(!0),children:"+ Create New Key"}),(0,c.jsx)(A.Z,{visible:u,width:1e3,footer:null,onOk:eN,onCancel:eZ,children:(0,c.jsxs)(I.Z,{form:m,onFinish:eS,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsxs)("div",{className:"mb-8",children:[(0,c.jsx)(k.Z,{className:"mb-4",children:"Key Ownership"}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Owned By"," ",(0,c.jsx)(z.Z,{title:"Select who will own this API key",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),className:"mb-4",children:(0,c.jsxs)(E.ZP.Group,{onChange:e=>B(e.target.value),value:K,children:[(0,c.jsx)(E.ZP,{value:"you",children:"You"}),(0,c.jsx)(E.ZP,{value:"service_account",children:"Service Account"}),"Admin"===a&&(0,c.jsx)(E.ZP,{value:"another_user",children:"Another User"})]})}),"another_user"===K&&(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["User ID"," ",(0,c.jsx)(z.Z,{title:"The user who will own this key and be responsible for its usage",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"user_id",className:"mt-4",rules:[{required:"another_user"===K,message:"Please input the user ID of the user you are assigning the key to"}],children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",marginBottom:"8px"},children:[(0,c.jsx)(C.default,{showSearch:!0,placeholder:"Type email to search for users",filterOption:!1,onSearch:e=>{eP(e)},onSelect:(e,s)=>eT(e,s),options:em,loading:ex,allowClear:!0,style:{width:"100%"},notFoundContent:ex?"Searching...":"No users found"}),(0,c.jsx)(T.ZP,{onClick:()=>er(!0),style:{marginLeft:"8px"},children:"Create User"})]}),(0,c.jsx)("div",{className:"text-xs text-gray-500",children:"Search by email to find users"})]})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Team"," ",(0,c.jsx)(z.Z,{title:"The team this key belongs to, which determines available models and budget limits",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"team_id",initialValue:t?t.team_id:null,className:"mt-4",children:(0,c.jsx)(J,{teams:l,onChange:e=>{et((null==l?void 0:l.find(s=>s.team_id===e))||null)}})})]}),ek&&(0,c.jsx)("div",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,c.jsx)(w.Z,{className:"text-blue-800 text-sm",children:"Please select a team to continue configuring your API key. If you do not see any teams, please contact your Proxy Admin to either provide you with access to models or to add you to a team."})}),!ek&&(0,c.jsxs)("div",{className:"mb-8",children:[(0,c.jsx)(k.Z,{className:"mb-4",children:"Key Details"}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["you"===K||"another_user"===K?"Key Name":"Service Account ID"," ",(0,c.jsx)(z.Z,{title:"you"===K||"another_user"===K?"A descriptive name to identify this key":"Unique identifier for this service account",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"key_alias",rules:[{required:!0,message:"Please input a ".concat("you"===K?"key name":"service account ID")}],help:"required",children:(0,c.jsx)(y.Z,{placeholder:""})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Models"," ",(0,c.jsx)(z.Z,{title:"Select which models this key can access. Choose 'All Team Models' to grant access to all models available to the team",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"models",rules:"management"===ey||"read_only"===ey?[]:[{required:!0,message:"Please select a model"}],help:"management"===ey||"read_only"===ey?"Models field is disabled for this key type":"required",className:"mt-4",children:(0,c.jsxs)(C.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},disabled:"management"===ey||"read_only"===ey,onChange:e=>{e.includes("all-team-models")&&m.setFieldsValue({models:["all-team-models"]})},children:[(0,c.jsx)(eq,{value:"all-team-models",children:"All Team Models"},"all-team-models"),q.map(e=>(0,c.jsx)(eq,{value:e,children:F(e)},e))]})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Key Type"," ",(0,c.jsx)(z.Z,{title:"Select the type of key to determine what routes and operations this key can access",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"key_type",initialValue:"default",className:"mt-4",children:(0,c.jsxs)(C.default,{defaultValue:"default",placeholder:"Select key type",style:{width:"100%"},optionLabelProp:"label",onChange:e=>{eb(e),("management"===e||"read_only"===e)&&m.setFieldsValue({models:[]})},children:[(0,c.jsx)(eq,{value:"default",label:"Default",children:(0,c.jsxs)("div",{style:{padding:"4px 0"},children:[(0,c.jsx)("div",{style:{fontWeight:500},children:"Default"}),(0,c.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:"Can call LLM API + Management routes"})]})}),(0,c.jsx)(eq,{value:"llm_api",label:"LLM API",children:(0,c.jsxs)("div",{style:{padding:"4px 0"},children:[(0,c.jsx)("div",{style:{fontWeight:500},children:"LLM API"}),(0,c.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:"Can call only LLM API routes (chat/completions, embeddings, etc.)"})]})}),(0,c.jsx)(eq,{value:"management",label:"Management",children:(0,c.jsxs)("div",{style:{padding:"4px 0"},children:[(0,c.jsx)("div",{style:{fontWeight:500},children:"Management"}),(0,c.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:"Can call only management routes (user/team/key management)"})]})})]})})]}),!ek&&(0,c.jsx)("div",{className:"mb-8",children:(0,c.jsxs)(b.Z,{className:"mt-4 mb-4",onClick:()=>{ej||(ew(),ef(!0))},children:[(0,c.jsx)(Z.Z,{children:(0,c.jsx)(k.Z,{className:"m-0",children:"Optional Settings"})}),(0,c.jsxs)(N.Z,{children:[(0,c.jsx)(I.Z.Item,{className:"mt-4",label:(0,c.jsxs)("span",{children:["Max Budget (USD)"," ",(0,c.jsx)(z.Z,{title:"Maximum amount in USD this key can spend. When reached, the key will be blocked from making further requests",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"max_budget",help:"Budget cannot exceed team max budget: $".concat((null==t?void 0:t.max_budget)!==null&&(null==t?void 0:t.max_budget)!==void 0?null==t?void 0:t.max_budget:"unlimited"),rules:[{validator:async(e,s)=>{if(s&&t&&null!==t.max_budget&&s>t.max_budget)throw Error("Budget cannot exceed team max budget: $".concat(eD(t.max_budget,4)))}}],children:(0,c.jsx)(M,{step:.01,precision:2,width:200})}),(0,c.jsx)(I.Z.Item,{className:"mt-4",label:(0,c.jsxs)("span",{children:["Reset Budget"," ",(0,c.jsx)(z.Z,{title:"How often the budget should reset. For example, setting 'daily' will reset the budget every 24 hours",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"budget_duration",help:"Team Reset Budget: ".concat((null==t?void 0:t.budget_duration)!==null&&(null==t?void 0:t.budget_duration)!==void 0?null==t?void 0:t.budget_duration:"None"),children:(0,c.jsx)(eO,{onChange:e=>m.setFieldValue("budget_duration",e)})}),(0,c.jsx)(I.Z.Item,{className:"mt-4",label:(0,c.jsxs)("span",{children:["Tokens per minute Limit (TPM)"," ",(0,c.jsx)(z.Z,{title:"Maximum number of tokens this key can process per minute. Helps control usage and costs",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"tpm_limit",help:"TPM cannot exceed team TPM limit: ".concat((null==t?void 0:t.tpm_limit)!==null&&(null==t?void 0:t.tpm_limit)!==void 0?null==t?void 0:t.tpm_limit:"unlimited"),rules:[{validator:async(e,s)=>{if(s&&t&&null!==t.tpm_limit&&s>t.tpm_limit)throw Error("TPM limit cannot exceed team TPM limit: ".concat(t.tpm_limit))}}],children:(0,c.jsx)(M,{step:1,width:400})}),(0,c.jsx)(I.Z.Item,{className:"mt-4",label:(0,c.jsxs)("span",{children:["Requests per minute Limit (RPM)"," ",(0,c.jsx)(z.Z,{title:"Maximum number of API requests this key can make per minute. Helps prevent abuse and manage load",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"rpm_limit",help:"RPM cannot exceed team RPM limit: ".concat((null==t?void 0:t.rpm_limit)!==null&&(null==t?void 0:t.rpm_limit)!==void 0?null==t?void 0:t.rpm_limit:"unlimited"),rules:[{validator:async(e,s)=>{if(s&&t&&null!==t.rpm_limit&&s>t.rpm_limit)throw Error("RPM limit cannot exceed team RPM limit: ".concat(t.rpm_limit))}}],children:(0,c.jsx)(M,{step:1,width:400})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Expire Key"," ",(0,c.jsx)(z.Z,{title:"Set when this key should expire. Format: 30s (seconds), 30m (minutes), 30h (hours), 30d (days)",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"duration",className:"mt-4",children:(0,c.jsx)(y.Z,{placeholder:"e.g., 30d"})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Guardrails"," ",(0,c.jsx)(z.Z,{title:"Apply safety guardrails to this key to filter content or enforce policies",children:(0,c.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",className:"mt-4",help:"Select existing guardrails or enter new ones",children:(0,c.jsx)(C.default,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails",options:$.map(e=>({value:e,label:e}))})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Allowed Vector Stores"," ",(0,c.jsx)(z.Z,{title:"Select which vector stores this key can access. If none selected, the key will have access to all available vector stores",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-4",help:"Select vector stores this key can access. Leave empty for access to all vector stores",children:(0,c.jsx)(H,{onChange:e=>m.setFieldValue("allowed_vector_store_ids",e),value:m.getFieldValue("allowed_vector_store_ids"),accessToken:r,placeholder:"Select vector stores (optional)"})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,c.jsx)(z.Z,{title:"Select which MCP servers or access groups this key can access. ",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_servers_and_groups",className:"mt-4",help:"Select MCP servers or access groups this key can access. ",children:(0,c.jsx)(eR,{onChange:e=>m.setFieldValue("allowed_mcp_servers_and_groups",e),value:m.getFieldValue("allowed_mcp_servers_and_groups"),accessToken:r,placeholder:"Select MCP servers or access groups (optional)"})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Metadata"," ",(0,c.jsx)(z.Z,{title:"JSON object with additional information about this key. Used for tracking or custom logic",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"metadata",className:"mt-4",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Tags"," ",(0,c.jsx)(z.Z,{title:"Tags for tracking spend and/or doing tag-based routing. Used for analytics and filtering",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"tags",className:"mt-4",help:"Tags for tracking spend and/or doing tag-based routing.",children:(0,c.jsx)(C.default,{mode:"tags",style:{width:"100%"},placeholder:"Enter tags",tokenSeparators:[","],options:Y})}),(0,c.jsxs)(b.Z,{className:"mt-4 mb-4",children:[(0,c.jsx)(Z.Z,{children:(0,c.jsx)("b",{children:"Logging Settings"})}),(0,c.jsx)(N.Z,{children:(0,c.jsx)("div",{className:"mt-4",children:(0,c.jsx)(ec,{value:X,onChange:ee,premiumUser:o,disabledCallbacks:ev,onDisabledCallbacksChange:e_})})})]}),(0,c.jsxs)(b.Z,{className:"mt-4 mb-4",children:[(0,c.jsx)(Z.Z,{children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("b",{children:"Advanced Settings"}),(0,c.jsx)(z.Z,{title:(0,c.jsxs)("span",{children:["Learn more about advanced settings in our"," ",(0,c.jsx)("a",{href:g.proxyBaseUrl?"".concat(g.proxyBaseUrl,"/#/key%20management/generate_key_fn_key_generate_post"):"/#/key%20management/generate_key_fn_key_generate_post",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300",children:"documentation"})]}),children:(0,c.jsx)(U.Z,{className:"text-gray-400 hover:text-gray-300 cursor-help"})})]})}),(0,c.jsx)(N.Z,{children:(0,c.jsx)(G,{schemaComponent:"GenerateKeyRequest",form:m,excludedFields:["key_alias","team_id","models","duration","metadata","tags","guardrails","max_budget","budget_duration","tpm_limit","rpm_limit"]})})]})]})]})}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{htmlType:"submit",disabled:ek,style:{opacity:ek?.5:1},children:"Create Key"})})]})}),el&&(0,c.jsx)(A.Z,{title:"Create New User",visible:el,onCancel:()=>er(!1),footer:null,width:800,children:(0,c.jsx)(eI,{userID:s,accessToken:r,teams:l,possibleUIRoles:eo,onUserCreated:e=>{en(e),m.setFieldsValue({user_id:e}),er(!1)},isEmbedded:!0})}),h&&(0,c.jsx)(A.Z,{visible:u,onOk:eN,onCancel:eZ,footer:null,children:(0,c.jsxs)(v.Z,{numItems:1,className:"gap-2 w-full",children:[(0,c.jsx)(k.Z,{children:"Save your Key"}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)("p",{children:["Please save this secret key somewhere safe and accessible. For security reasons, ",(0,c.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,c.jsx)(f.Z,{numColSpan:1,children:null!=h?(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"mt-3",children:"API Key:"}),(0,c.jsx)("div",{style:{background:"#f8f8f8",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:(0,c.jsx)("pre",{style:{wordWrap:"break-word",whiteSpace:"normal"},children:h})}),(0,c.jsx)(S.CopyToClipboard,{text:h,onCopy:()=>{P.ZP.success("API Key copied to clipboard")},children:(0,c.jsx)(_.Z,{className:"mt-3",children:"Copy API Key"})})]}):(0,c.jsx)(w.Z,{children:"Key being created, this might take 30s"})})]})})]})},eB=t(7366),eG=e=>{let{selectedTeam:s,currentOrg:t,selectedKeyAlias:l,accessToken:a,createClicked:r}=e,[i,n]=(0,d.useState)({keys:[],total_count:0,current_page:1,total_pages:0}),[o,c]=(0,d.useState)(!0),[m,u]=(0,d.useState)(null),x=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(console.log("calling fetchKeys"),!a){console.log("accessToken",a);return}c(!0);let s="number"==typeof e.page?e.page:1,t="number"==typeof e.pageSize?e.pageSize:100,l=await (0,g.keyListCall)(a,null,null,null,null,null,s,t);console.log("data",l),n(l),u(null)}catch(e){u(e instanceof Error?e:Error("An error occurred"))}finally{c(!1)}};return(0,d.useEffect)(()=>{x(),console.log("selectedTeam",s,"currentOrg",t,"accessToken",a,"selectedKeyAlias",l)},[s,t,a,l,r]),{keys:i.keys,isLoading:o,error:m,pagination:{currentPage:i.current_page,totalPages:i.total_pages,totalCount:i.total_count},refresh:x,setKeys:e=>{n(s=>{let t="function"==typeof e?e(s.keys):e;return{...s,keys:t}})}}},eH=t(27281),eJ=t(41649),eY=t(12485),eW=t(18135),e$=t(35242),eQ=t(29706),eX=t(77991),e0=t(10900),e1=t(23628),e2=e=>{let{value:s,onChange:t,disabledCallbacks:l=[],onDisabledCallbacksChange:a}=e;return(0,c.jsx)(eo,{value:s,onChange:t,disabledCallbacks:l,onDisabledCallbacksChange:a})};let e4=["logging"],e5=e=>e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(e=>{let[s]=e;return!e4.includes(s)})):{},e6=e=>e&&"object"==typeof e&&Array.isArray(e.logging)?e.logging:[],e3=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return JSON.stringify(e5(e),null,s)};function e8(e){var s,t,l,a,r,i,n;let{keyData:o,onCancel:m,onSubmit:u,teams:x,accessToken:h,userID:p,userRole:j,premiumUser:f=!1}=e,[v]=I.Z.useForm(),[b,N]=(0,d.useState)([]),Z=null==x?void 0:x.find(e=>e.team_id===o.team_id),[w,k]=(0,d.useState)([]),[S,P]=(0,d.useState)([]),[A,E]=(0,d.useState)(!1),[O,D]=(0,d.useState)(Array.isArray(null===(s=o.metadata)||void 0===s?void 0:s.litellm_disabled_callbacks)?el(o.metadata.litellm_disabled_callbacks):[]);(0,d.useEffect)(()=>{(async()=>{if(p&&j&&h)try{if(null===o.team_id){let e=(await (0,g.modelAvailableCall)(h,p,j)).data.map(e=>e.id);k(e)}else if(null==Z?void 0:Z.team_id){let e=await ez(p,j,h,Z.team_id);k(Array.from(new Set([...Z.models,...e])))}}catch(e){console.error("Error fetching models:",e)}})()},[p,j,h,Z,o.team_id]),(0,d.useEffect)(()=>{v.setFieldValue("disabled_callbacks",O)},[v,O]);let F={...o,budget_duration:(n=o.budget_duration)&&({"24h":"daily","7d":"weekly","30d":"monthly"})[n]||null,metadata:e3(o.metadata),guardrails:(null===(t=o.metadata)||void 0===t?void 0:t.guardrails)||[],vector_stores:(null===(l=o.object_permission)||void 0===l?void 0:l.vector_stores)||[],mcp_servers_and_groups:{servers:(null===(a=o.object_permission)||void 0===a?void 0:a.mcp_servers)||[],accessGroups:(null===(r=o.object_permission)||void 0===r?void 0:r.mcp_access_groups)||[]},logging_settings:e6(o.metadata),disabled_callbacks:Array.isArray(null===(i=o.metadata)||void 0===i?void 0:i.litellm_disabled_callbacks)?el(o.metadata.litellm_disabled_callbacks):[]};return(0,c.jsxs)(I.Z,{form:v,onFinish:u,initialValues:F,layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{label:"Key Alias",name:"key_alias",children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"Models",name:"models",children:(0,c.jsxs)(C.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[w.length>0&&(0,c.jsx)(C.default.Option,{value:"all-team-models",children:"All Team Models"}),w.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:e},e))]})}),(0,c.jsx)(I.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,c.jsx)(M,{step:.01,style:{width:"100%"},placeholder:"Enter a numerical value"})}),(0,c.jsx)(I.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,c.jsxs)(C.default,{placeholder:"n/a",children:[(0,c.jsx)(C.default.Option,{value:"daily",children:"Daily"}),(0,c.jsx)(C.default.Option,{value:"weekly",children:"Weekly"}),(0,c.jsx)(C.default.Option,{value:"monthly",children:"Monthly"})]})}),(0,c.jsx)(I.Z.Item,{label:"TPM Limit",name:"tpm_limit",children:(0,c.jsx)(M,{min:0})}),(0,c.jsx)(I.Z.Item,{label:"RPM Limit",name:"rpm_limit",children:(0,c.jsx)(M,{min:0})}),(0,c.jsx)(I.Z.Item,{label:"Max Parallel Requests",name:"max_parallel_requests",children:(0,c.jsx)(M,{min:0})}),(0,c.jsx)(I.Z.Item,{label:"Model TPM Limit",name:"model_tpm_limit",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:'{"gpt-4": 100, "claude-v1": 200}'})}),(0,c.jsx)(I.Z.Item,{label:"Model RPM Limit",name:"model_rpm_limit",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:'{"gpt-4": 100, "claude-v1": 200}'})}),(0,c.jsx)(I.Z.Item,{label:"Guardrails",name:"guardrails",children:(0,c.jsx)(C.default,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails"})}),(0,c.jsx)(I.Z.Item,{label:"Vector Stores",name:"vector_stores",children:(0,c.jsx)(H,{onChange:e=>v.setFieldValue("vector_stores",e),value:v.getFieldValue("vector_stores"),accessToken:h||"",placeholder:"Select vector stores"})}),(0,c.jsx)(I.Z.Item,{label:"MCP Servers / Access Groups",name:"mcp_servers_and_groups",children:(0,c.jsx)(eR,{onChange:e=>v.setFieldValue("mcp_servers_and_groups",e),value:v.getFieldValue("mcp_servers_and_groups"),accessToken:h||"",placeholder:"Select MCP servers or access groups (optional)"})}),(0,c.jsx)(I.Z.Item,{label:"Team ID",name:"team_id",children:(0,c.jsx)(C.default,{placeholder:"Select team",style:{width:"100%"},children:null==x?void 0:x.map(e=>(0,c.jsx)(C.default.Option,{value:e.team_id,children:"".concat(e.team_alias," (").concat(e.team_id,")")},e.team_id))})}),(0,c.jsx)(I.Z.Item,{label:"Logging Settings",name:"logging_settings",children:(0,c.jsx)(e2,{value:v.getFieldValue("logging_settings"),onChange:e=>v.setFieldValue("logging_settings",e),disabledCallbacks:O,onDisabledCallbacksChange:e=>{D(el(e)),v.setFieldValue("disabled_callbacks",e)}})}),(0,c.jsx)(I.Z.Item,{label:"Metadata",name:"metadata",children:(0,c.jsx)(L.default.TextArea,{rows:10})}),(0,c.jsx)(I.Z.Item,{name:"token",hidden:!0,children:(0,c.jsx)(L.default,{})}),(0,c.jsx)(I.Z.Item,{name:"disabled_callbacks",hidden:!0,children:(0,c.jsx)(L.default,{})}),(0,c.jsx)("div",{className:"sticky z-10 bg-white p-4 border-t border-gray-200 bottom-[-1.5rem] inset-x-[-1.5rem]",children:(0,c.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,c.jsx)(T.ZP,{onClick:m,children:"Cancel"}),(0,c.jsx)(_.Z,{type:"submit",children:"Save Changes"})]})})]})}function e7(e){let{selectedToken:s,visible:t,onClose:l,accessToken:a,premiumUser:r,setAccessToken:i,onKeyUpdate:n}=e,[o]=I.Z.useForm(),[m,u]=(0,d.useState)(null),[x,h]=(0,d.useState)(null),[p,j]=(0,d.useState)(null),[b,N]=(0,d.useState)(!1),[Z,C]=(0,d.useState)(!1),[E,T]=(0,d.useState)(null);(0,d.useEffect)(()=>{t&&s&&a&&(o.setFieldsValue({key_alias:s.key_alias,max_budget:s.max_budget,tpm_limit:s.tpm_limit,rpm_limit:s.rpm_limit,duration:s.duration||""}),T(a),C(s.key_name===a))},[t,s,o,a]),(0,d.useEffect)(()=>{t||(u(null),N(!1),C(!1),T(null),o.resetFields())},[t,o]);let L=e=>{if(!e)return null;try{let s;let t=new Date;if(e.endsWith("s"))s=(0,eB.Z)(t,{seconds:parseInt(e)});else if(e.endsWith("h"))s=(0,eB.Z)(t,{hours:parseInt(e)});else if(e.endsWith("d"))s=(0,eB.Z)(t,{days:parseInt(e)});else throw Error("Invalid duration format");return s.toLocaleString()}catch(e){return null}};(0,d.useEffect)(()=>{(null==x?void 0:x.duration)?j(L(x.duration)):j(null)},[null==x?void 0:x.duration]);let O=async()=>{if(s&&E){N(!0);try{let e=await o.validateFields(),t=await (0,g.regenerateKeyCall)(E,s.token||s.token_id,e);u(t.key),P.ZP.success("API Key regenerated successfully"),console.log("Full regenerate response:",t);let l={token:t.token||t.key_id||s.token,key_name:t.key,max_budget:e.max_budget,tpm_limit:e.tpm_limit,rpm_limit:e.rpm_limit,expires:e.duration?L(e.duration):s.expires,...t};console.log("Updated key data with new token:",l),Z&&(T(t.key),i&&i(t.key)),n&&n(l),N(!1)}catch(e){console.error("Error regenerating key:",e),P.ZP.error("Failed to regenerate API Key"),N(!1)}}},M=()=>{u(null),N(!1),C(!1),T(null),o.resetFields(),l()};return(0,c.jsx)(A.Z,{title:"Regenerate API Key",open:t,onCancel:M,footer:m?[(0,c.jsx)(_.Z,{onClick:M,children:"Close"},"close")]:[(0,c.jsx)(_.Z,{onClick:M,className:"mr-2",children:"Cancel"},"cancel"),(0,c.jsx)(_.Z,{onClick:O,disabled:b,children:b?"Regenerating...":"Regenerate"},"regenerate")],children:m?(0,c.jsxs)(v.Z,{numItems:1,className:"gap-2 w-full",children:[(0,c.jsx)(k.Z,{children:"Regenerated Key"}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)("p",{children:["Please replace your old key with the new key generated. For security reasons, ",(0,c.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,c.jsxs)(f.Z,{numColSpan:1,children:[(0,c.jsx)(w.Z,{className:"mt-3",children:"Key Alias:"}),(0,c.jsx)("div",{className:"bg-gray-100 p-2 rounded mb-2",children:(0,c.jsx)("pre",{className:"break-words whitespace-normal",children:(null==s?void 0:s.key_alias)||"No alias set"})}),(0,c.jsx)(w.Z,{className:"mt-3",children:"New API Key:"}),(0,c.jsx)("div",{className:"bg-gray-100 p-2 rounded mb-2",children:(0,c.jsx)("pre",{className:"break-words whitespace-normal",children:m})}),(0,c.jsx)(S.CopyToClipboard,{text:m,onCopy:()=>P.ZP.success("API Key copied to clipboard"),children:(0,c.jsx)(_.Z,{className:"mt-3",children:"Copy API Key"})})]})]}):(0,c.jsxs)(I.Z,{form:o,layout:"vertical",onValuesChange:e=>{"duration"in e&&h(s=>({...s,duration:e.duration}))},children:[(0,c.jsx)(I.Z.Item,{name:"key_alias",label:"Key Alias",children:(0,c.jsx)(y.Z,{disabled:!0})}),(0,c.jsx)(I.Z.Item,{name:"max_budget",label:"Max Budget (USD)",children:(0,c.jsx)(q.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{name:"tpm_limit",label:"TPM Limit",children:(0,c.jsx)(q.Z,{style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{name:"rpm_limit",label:"RPM Limit",children:(0,c.jsx)(q.Z,{style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{name:"duration",label:"Expire Key (eg: 30s, 30h, 30d)",className:"mt-8",children:(0,c.jsx)(y.Z,{placeholder:""})}),(0,c.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Current expiry: ",(null==s?void 0:s.expires)?new Date(s.expires).toLocaleString():"Never"]}),p&&(0,c.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["New expiry: ",p]})]})})}var e9=t(79814),se=function(e){let{vectorStores:s,accessToken:t}=e,[l,a]=(0,d.useState)([]);(0,d.useEffect)(()=>{(async()=>{if(t&&0!==s.length)try{let e=await (0,g.vectorStoreListCall)(t);e.data&&a(e.data.map(e=>({vector_store_id:e.vector_store_id,vector_store_name:e.vector_store_name})))}catch(e){console.error("Error fetching vector stores:",e)}})()},[t,s.length]);let r=e=>{let s=l.find(s=>s.vector_store_id===e);return s?"".concat(s.vector_store_name||s.vector_store_id," (").concat(s.vector_store_id,")"):e};return(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(e9.Z,{className:"h-4 w-4 text-blue-600"}),(0,c.jsx)(w.Z,{className:"font-semibold text-gray-900",children:"Vector Stores"}),(0,c.jsx)(eJ.Z,{color:"blue",size:"xs",children:s.length})]}),s.length>0?(0,c.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map((e,s)=>(0,c.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-50 border border-blue-200 text-blue-800 text-sm font-medium",children:r(e)},s))}):(0,c.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-50 border border-gray-200",children:[(0,c.jsx)(e9.Z,{className:"h-4 w-4 text-gray-400"}),(0,c.jsx)(w.Z,{className:"text-gray-500 text-sm",children:"No vector stores configured"})]})]})},ss=t(25327),st=function(e){let{mcpServers:s,mcpAccessGroups:l=[],accessToken:a}=e,[r,i]=(0,d.useState)([]),[n,o]=(0,d.useState)([]);(0,d.useEffect)(()=>{(async()=>{if(a&&s.length>0)try{let e=await (0,g.fetchMCPServers)(a);e&&Array.isArray(e)?i(e):e.data&&Array.isArray(e.data)&&i(e.data)}catch(e){console.error("Error fetching MCP servers:",e)}})()},[a,s.length]),(0,d.useEffect)(()=>{(async()=>{if(a&&l.length>0)try{let e=await Promise.resolve().then(t.bind(t,19250)).then(e=>e.fetchMCPAccessGroups(a));o(Array.isArray(e)?e:e.data||[])}catch(e){console.error("Error fetching MCP access groups:",e)}})()},[a,l.length]);let m=e=>{let s=r.find(s=>s.server_id===e);if(s){let t=e.length>7?"".concat(e.slice(0,3),"...").concat(e.slice(-4)):e;return"".concat(s.alias," (").concat(t,")")}return e},u=e=>e,x=[...s.map(e=>({type:"server",value:e})),...l.map(e=>({type:"accessGroup",value:e}))],h=x.length;return(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(ss.Z,{className:"h-4 w-4 text-gray-600"}),(0,c.jsx)(w.Z,{className:"font-semibold text-gray-900",children:"MCP Servers"}),(0,c.jsx)(eJ.Z,{color:"gray",size:"xs",children:h})]}),h>0?(0,c.jsx)("div",{className:"flex flex-wrap gap-2",children:x.map((e,s)=>"server"===e.type?(0,c.jsx)(z.Z,{title:"Full ID: ".concat(e.value),placement:"top",children:(0,c.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-50 border border-blue-200 text-blue-800 text-sm font-medium cursor-help",children:m(e.value)})},s):(0,c.jsxs)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-green-50 border border-green-200 text-green-800 text-sm font-medium",children:[(0,c.jsx)("span",{className:"inline-block w-2 h-2 bg-green-500 rounded-full mr-2"}),u(e.value)," ",(0,c.jsx)("span",{className:"ml-1 text-xs text-green-500",children:"(Access Group)"})]},s))}):(0,c.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-50 border border-gray-200",children:[(0,c.jsx)(ss.Z,{className:"h-4 w-4 text-gray-400"}),(0,c.jsx)(w.Z,{className:"text-gray-500 text-sm",children:"No MCP servers or access groups configured"})]})]})},sl=function(e){let{objectPermission:s,variant:t="card",className:l="",accessToken:a}=e,r=(null==s?void 0:s.vector_stores)||[],i=(null==s?void 0:s.mcp_servers)||[],n=(null==s?void 0:s.mcp_access_groups)||[],o=(0,c.jsxs)("div",{className:"card"===t?"grid grid-cols-1 md:grid-cols-2 gap-6":"space-y-4",children:[(0,c.jsx)(se,{vectorStores:r,accessToken:a}),(0,c.jsx)(st,{mcpServers:i,mcpAccessGroups:n,accessToken:a})]});return"card"===t?(0,c.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 ".concat(l),children:[(0,c.jsx)("div",{className:"flex items-center gap-2 mb-6",children:(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-semibold text-gray-900",children:"Object Permissions"}),(0,c.jsx)(w.Z,{className:"text-xs text-gray-500",children:"Access control for Vector Stores and MCP Servers"})]})}),o]}):(0,c.jsxs)("div",{className:"".concat(l),children:[(0,c.jsx)(w.Z,{className:"font-medium text-gray-900 mb-3",children:"Object Permissions"}),o]})},sa=function(e){let{loggingConfigs:s=[],disabledCallbacks:t=[],variant:l="card",className:a=""}=e,r=e=>{var s;return(null===(s=Object.entries(es).find(s=>{let[t,l]=s;return l===e}))||void 0===s?void 0:s[0])||e},i=e=>{switch(e){case"success":return"green";case"failure":return"red";case"success_and_failure":return"blue";default:return"gray"}},n=e=>{switch(e){case"success":return"Success Only";case"failure":return"Failure Only";case"success_and_failure":return"Success & Failure";default:return e}},o=(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(Q.Z,{className:"h-4 w-4 text-blue-600"}),(0,c.jsx)(w.Z,{className:"font-semibold text-gray-900",children:"Logging Integrations"}),(0,c.jsx)(eJ.Z,{color:"blue",size:"xs",children:s.length})]}),s.length>0?(0,c.jsx)("div",{className:"space-y-3",children:s.map((e,s)=>{var t;let l=r(e.callback_name),a=null===(t=ei[l])||void 0===t?void 0:t.logo;return(0,c.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 border border-blue-200",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[a?(0,c.jsx)("img",{src:a,alt:l,className:"w-5 h-5 object-contain"}):(0,c.jsx)(Q.Z,{className:"h-5 w-5 text-gray-400"}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium text-blue-800",children:l}),(0,c.jsxs)(w.Z,{className:"text-xs text-blue-600",children:[Object.keys(e.callback_vars).length," parameters configured"]})]})]}),(0,c.jsx)(eJ.Z,{color:i(e.callback_type),size:"sm",children:n(e.callback_type)})]},s)})}):(0,c.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-50 border border-gray-200",children:[(0,c.jsx)(Q.Z,{className:"h-4 w-4 text-gray-400"}),(0,c.jsx)(w.Z,{className:"text-gray-500 text-sm",children:"No logging integrations configured"})]})]}),(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)($.Z,{className:"h-4 w-4 text-red-600"}),(0,c.jsx)(w.Z,{className:"font-semibold text-gray-900",children:"Disabled Callbacks"}),(0,c.jsx)(eJ.Z,{color:"red",size:"xs",children:t.length})]}),t.length>0?(0,c.jsx)("div",{className:"space-y-3",children:t.map((e,s)=>{var t;let l=et[e]||e,a=null===(t=ei[l])||void 0===t?void 0:t.logo;return(0,c.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-red-50 border border-red-200",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[a?(0,c.jsx)("img",{src:a,alt:l,className:"w-5 h-5 object-contain"}):(0,c.jsx)($.Z,{className:"h-5 w-5 text-gray-400"}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium text-red-800",children:l}),(0,c.jsx)(w.Z,{className:"text-xs text-red-600",children:"Disabled for this key"})]})]}),(0,c.jsx)(eJ.Z,{color:"red",size:"sm",children:"Disabled"})]},s)})}):(0,c.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-50 border border-gray-200",children:[(0,c.jsx)($.Z,{className:"h-4 w-4 text-gray-400"}),(0,c.jsx)(w.Z,{className:"text-gray-500 text-sm",children:"No callbacks disabled"})]})]})]});return"card"===l?(0,c.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 ".concat(a),children:[(0,c.jsx)("div",{className:"flex items-center gap-2 mb-6",children:(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-semibold text-gray-900",children:"Logging Settings"}),(0,c.jsx)(w.Z,{className:"text-xs text-gray-500",children:"Active logging integrations and disabled callbacks for this key"})]})}),o]}):(0,c.jsxs)("div",{className:"".concat(a),children:[(0,c.jsx)(w.Z,{className:"font-medium text-gray-900 mb-3",children:"Logging Settings"}),o]})},sr=t(30401),si=t(78867);function sn(e){var s,t,l,a;let{keyId:r,onClose:i,keyData:n,accessToken:o,userID:m,userRole:u,teams:x,onKeyDataUpdate:h,onDelete:p,premiumUser:j,setAccessToken:f}=e,[y,b]=(0,d.useState)(!1),[N]=I.Z.useForm(),[Z,S]=(0,d.useState)(!1),[C,A]=(0,d.useState)(!1),[E,L]=(0,d.useState)({}),[O,M]=(0,d.useState)(n),[D,F]=(0,d.useState)(null),[R,q]=(0,d.useState)(!1);if((0,d.useEffect)(()=>{n&&M(n)},[n]),(0,d.useEffect)(()=>{if(R){let e=setTimeout(()=>{q(!1)},5e3);return()=>clearTimeout(e)}},[R]),!O)return(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",onClick:i,className:"mb-4",children:"Back to Keys"}),(0,c.jsx)(w.Z,{children:"Key not found"})]});let U=async e=>{try{var s,t,l,a;if(!o)return;let r=e.token;if(e.key=r,void 0!==e.vector_stores&&(e.object_permission={...O.object_permission,vector_stores:e.vector_stores||[]},delete e.vector_stores),void 0!==e.mcp_servers_and_groups){let{servers:s,accessGroups:t}=e.mcp_servers_and_groups||{servers:[],accessGroups:[]};e.object_permission={...O.object_permission,mcp_servers:s||[],mcp_access_groups:t||[]},delete e.mcp_servers_and_groups}if(e.metadata&&"string"==typeof e.metadata)try{let l=JSON.parse(e.metadata);e.metadata={...l,...(null===(s=e.guardrails)||void 0===s?void 0:s.length)>0?{guardrails:e.guardrails}:{},...e.logging_settings?{logging:e.logging_settings}:{},...(null===(t=e.disabled_callbacks)||void 0===t?void 0:t.length)>0?{litellm_disabled_callbacks:ea(e.disabled_callbacks)}:{}}}catch(e){console.error("Error parsing metadata JSON:",e),P.ZP.error("Invalid metadata JSON");return}else e.metadata={...e.metadata||{},...(null===(l=e.guardrails)||void 0===l?void 0:l.length)>0?{guardrails:e.guardrails}:{},...e.logging_settings?{logging:e.logging_settings}:{},...(null===(a=e.disabled_callbacks)||void 0===a?void 0:a.length)>0?{litellm_disabled_callbacks:ea(e.disabled_callbacks)}:{}};delete e.logging_settings,e.budget_duration&&(e.budget_duration=({daily:"24h",weekly:"7d",monthly:"30d"})[e.budget_duration]);let i=await (0,g.keyUpdateCall)(o,e);M(e=>e?{...e,...i}:void 0),h&&h(i),P.ZP.success("Key updated successfully"),b(!1)}catch(e){P.ZP.error("Failed to update key"),console.error("Error updating key:",e)}},V=async()=>{try{if(!o)return;await (0,g.keyDeleteCall)(o,O.token||O.token_id),P.ZP.success("Key deleted successfully"),p&&p(),i()}catch(e){console.error("Error deleting the key:",e),P.ZP.error("Failed to delete key")}},K=async(e,s)=>{await eF(e)&&(L(e=>({...e,[s]:!0})),setTimeout(()=>{L(e=>({...e,[s]:!1}))},2e3))},B=e=>{let s=new Date(e),t=s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),l=s.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return"".concat(t," at ").concat(l)};return(0,c.jsxs)("div",{className:"w-full h-screen p-4",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",onClick:i,className:"mb-4",children:"Back to Keys"}),(0,c.jsx)(k.Z,{children:O.key_alias||"API Key"}),(0,c.jsxs)("div",{className:"flex items-center cursor-pointer mb-2 space-y-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"text-xs text-gray-400 uppercase tracking-wide mt-2",children:"Key ID"}),(0,c.jsx)(w.Z,{className:"text-gray-500 font-mono text-sm",children:O.token_id||O.token})]}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:E["key-id"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>K(O.token_id||O.token,"key-id"),className:"ml-2 transition-all duration-200".concat(E["key-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]}),(0,c.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,c.jsx)(w.Z,{className:"text-sm text-gray-500",children:O.updated_at&&O.updated_at!==O.created_at?"Updated: ".concat(B(O.updated_at)):"Created: ".concat(B(O.created_at))}),R&&(0,c.jsx)(eJ.Z,{color:"green",size:"xs",className:"animate-pulse",children:"Recently Regenerated"}),D&&(0,c.jsx)(eJ.Z,{color:"blue",size:"xs",children:"Regenerated"})]})]}),u&&eE.LQ.includes(u)&&(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(z.Z,{title:j?"":"This is a LiteLLM Enterprise feature, and requires a valid key to use.",children:(0,c.jsx)("span",{className:"inline-block",children:(0,c.jsx)(_.Z,{icon:e1.Z,variant:"secondary",onClick:()=>A(!0),className:"flex items-center",disabled:!j,children:"Regenerate Key"})})}),(0,c.jsx)(_.Z,{icon:ee.Z,variant:"secondary",onClick:()=>S(!0),className:"flex items-center",children:"Delete Key"})]})]}),(0,c.jsx)(e7,{selectedToken:O,visible:C,onClose:()=>A(!1),accessToken:o,premiumUser:j,setAccessToken:f,onKeyUpdate:e=>{M(s=>{if(s)return{...s,...e,created_at:new Date().toLocaleString()}}),F(new Date),q(!0),h&&h({...e,created_at:new Date().toLocaleString()})}}),Z&&(0,c.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,c.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,c.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,c.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,c.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,c.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,c.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,c.jsx)("div",{className:"sm:flex sm:items-start",children:(0,c.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,c.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Key"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this key?"})})]})})}),(0,c.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,c.jsx)(_.Z,{onClick:V,color:"red",className:"ml-2",children:"Delete"}),(0,c.jsx)(_.Z,{onClick:()=>S(!1),children:"Cancel"})]})]})]})}),(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{className:"mb-4",children:[(0,c.jsx)(eY.Z,{children:"Overview"}),(0,c.jsx)(eY.Z,{children:"Settings"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Spend"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)(k.Z,{children:["$",eD(O.spend,4)]}),(0,c.jsxs)(w.Z,{children:["of"," ",null!==O.max_budget?"$".concat(eD(O.max_budget)):"Unlimited"]})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Rate Limits"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)(w.Z,{children:["TPM: ",null!==O.tpm_limit?O.tpm_limit:"Unlimited"]}),(0,c.jsxs)(w.Z,{children:["RPM: ",null!==O.rpm_limit?O.rpm_limit:"Unlimited"]})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Models"}),(0,c.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:O.models&&O.models.length>0?O.models.map((e,s)=>(0,c.jsx)(eJ.Z,{color:"red",children:e},s)):(0,c.jsx)(w.Z,{children:"No models specified"})})]}),(0,c.jsx)(W.Z,{children:(0,c.jsx)(sl,{objectPermission:O.object_permission,variant:"inline",accessToken:o})}),(0,c.jsx)(sa,{loggingConfigs:e6(O.metadata),disabledCallbacks:Array.isArray(null===(s=O.metadata)||void 0===s?void 0:s.litellm_disabled_callbacks)?el(O.metadata.litellm_disabled_callbacks):[],variant:"card"})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(W.Z,{className:"overflow-y-auto max-h-[65vh]",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"Key Settings"}),!y&&u&&eE.LQ.includes(u)&&(0,c.jsx)(_.Z,{variant:"light",onClick:()=>b(!0),children:"Edit Settings"})]}),y?(0,c.jsx)(e8,{keyData:O,onCancel:()=>b(!1),onSubmit:U,teams:x,accessToken:o,userID:m,userRole:u}):(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Key ID"}),(0,c.jsx)(w.Z,{className:"font-mono",children:O.token_id||O.token})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Key Alias"}),(0,c.jsx)(w.Z,{children:O.key_alias||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Secret Key"}),(0,c.jsx)(w.Z,{className:"font-mono",children:O.key_name})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Team ID"}),(0,c.jsx)(w.Z,{children:O.team_id||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Organization"}),(0,c.jsx)(w.Z,{children:O.organization_id||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Created"}),(0,c.jsx)(w.Z,{children:B(O.created_at)})]}),D&&(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Last Regenerated"}),(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(w.Z,{children:B(D)}),(0,c.jsx)(eJ.Z,{color:"green",size:"xs",children:"Recent"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Expires"}),(0,c.jsx)(w.Z,{children:O.expires?B(O.expires):"Never"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Spend"}),(0,c.jsxs)(w.Z,{children:["$",eD(O.spend,4)," USD"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Budget"}),(0,c.jsx)(w.Z,{children:null!==O.max_budget?"$".concat(eD(O.max_budget,2)):"Unlimited"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Models"}),(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:O.models&&O.models.length>0?O.models.map((e,s)=>(0,c.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:e},s)):(0,c.jsx)(w.Z,{children:"No models specified"})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Rate Limits"}),(0,c.jsxs)(w.Z,{children:["TPM: ",null!==O.tpm_limit?O.tpm_limit:"Unlimited"]}),(0,c.jsxs)(w.Z,{children:["RPM: ",null!==O.rpm_limit?O.rpm_limit:"Unlimited"]}),(0,c.jsxs)(w.Z,{children:["Max Parallel Requests:"," ",null!==O.max_parallel_requests?O.max_parallel_requests:"Unlimited"]}),(0,c.jsxs)(w.Z,{children:["Model TPM Limits:"," ",(null===(t=O.metadata)||void 0===t?void 0:t.model_tpm_limit)?JSON.stringify(O.metadata.model_tpm_limit):"Unlimited"]}),(0,c.jsxs)(w.Z,{children:["Model RPM Limits:"," ",(null===(l=O.metadata)||void 0===l?void 0:l.model_rpm_limit)?JSON.stringify(O.metadata.model_rpm_limit):"Unlimited"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Metadata"}),(0,c.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:e3(O.metadata)})]}),(0,c.jsx)(sl,{objectPermission:O.object_permission,variant:"inline",className:"pt-4 border-t border-gray-200",accessToken:o}),(0,c.jsx)(sa,{loggingConfigs:e6(O.metadata),disabledCallbacks:Array.isArray(null===(a=O.metadata)||void 0===a?void 0:a.litellm_disabled_callbacks)?el(O.metadata.litellm_disabled_callbacks):[],variant:"inline",className:"pt-4 border-t border-gray-200"})]})]})})]})]})]})}var so=t(2356),sc=e=>{let{options:s,onApplyFilters:t,onResetFilters:l,initialValues:a={},buttonLabel:r="Filters"}=e,[i,n]=(0,d.useState)(!1),[o,m]=(0,d.useState)(a),[u,x]=(0,d.useState)({}),[h,p]=(0,d.useState)({}),[g,j]=(0,d.useState)({}),f=(0,d.useCallback)(eA()(async(e,s)=>{if(s.isSearchable&&s.searchFn){p(e=>({...e,[s.name]:!0}));try{let t=await s.searchFn(e);x(e=>({...e,[s.name]:t}))}catch(e){console.error("Error searching:",e),x(e=>({...e,[s.name]:[]}))}finally{p(e=>({...e,[s.name]:!1}))}}},300),[]),v=(e,s)=>{let l={...o,[e]:s};m(l),t(l)};return(0,c.jsxs)("div",{className:"w-full",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,c.jsx)(T.ZP,{icon:(0,c.jsx)(so.Z,{className:"h-4 w-4"}),onClick:()=>n(!i),className:"flex items-center gap-2",children:r}),(0,c.jsx)(T.ZP,{onClick:()=>{let e={};s.forEach(s=>{e[s.name]=""}),m(e),l()},children:"Reset Filters"})]}),i&&(0,c.jsx)("div",{className:"grid grid-cols-3 gap-x-6 gap-y-4 mb-6",children:["Team ID","Status","Organization ID","Key Alias","User ID","End User","Key Hash","Model"].map(e=>{let t=s.find(s=>s.label===e||s.name===e);return t?(0,c.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,c.jsx)("label",{className:"text-sm text-gray-600",children:t.label||t.name}),t.isSearchable?(0,c.jsx)(C.default,{showSearch:!0,className:"w-full",placeholder:"Search ".concat(t.label||t.name,"..."),value:o[t.name]||void 0,onChange:e=>v(t.name,e),onSearch:e=>{j(s=>({...s,[t.name]:e})),t.searchFn&&f(e,t)},filterOption:!1,loading:h[t.name],options:u[t.name]||[],allowClear:!0}):t.options?(0,c.jsx)(C.default,{className:"w-full",placeholder:"Select ".concat(t.label||t.name,"..."),value:o[t.name]||void 0,onChange:e=>v(t.name,e),allowClear:!0,children:t.options.map(e=>(0,c.jsx)(C.default.Option,{value:e.value,children:e.label},e.value))}):(0,c.jsx)(L.default,{className:"w-full",placeholder:"Enter ".concat(t.label||t.name,"..."),value:o[t.name]||"",onChange:e=>v(t.name,e.target.value),allowClear:!0})]},t.name):null})})]})},sd=t(16593);let sm=async e=>{if(!e)return[];try{let s=[],t=1,l=!0;for(;l;){let a=await (0,g.keyListCall)(e,null,"",null,null,null,t,100),r=a.keys.map(e=>e.key_alias).filter(Boolean);s=[...s,...r],t<a.total_pages?t++:l=!1}return Array.from(new Set(s))}catch(e){return console.error("Error fetching all key aliases:",e),[]}},su=async(e,s)=>{if(!e)return[];try{let t=[],l=1,a=!0;for(;a;){let r=await (0,g.teamListCall)(e,s||null,null);t=[...t,...r],l<r.total_pages?l++:a=!1}return t}catch(e){return console.error("Error fetching all teams:",e),[]}},sx=async e=>{if(!e)return[];try{let s=[],t=1,l=!0;for(;l;){let a=await (0,g.organizationListCall)(e);s=[...s,...a],t<a.total_pages?t++:l=!1}return s}catch(e){return console.error("Error fetching all organizations:",e),[]}},sh=()=>{let[e,s]=(0,d.useState)("http://localhost:4000");return(0,d.useEffect)(()=>{{let{protocol:e,host:t}=window.location;s("".concat(e,"//").concat(t))}},[]),e};var sp=t(71594),sg=t(24525),sj=t(47323),sf=t(21626),sv=t(97214),s_=t(28241),sy=t(58834),sb=t(69552),sN=t(71876),sZ=t(86462),sw=t(47686),sk=t(44633),sS=t(49084);function sC(e){let{keys:s,setKeys:t,isLoading:l=!1,pagination:a,onPageChange:r,pageSize:i=50,teams:n,selectedTeam:o,setSelectedTeam:m,selectedKeyAlias:u,setSelectedKeyAlias:x,accessToken:h,userID:p,userRole:j,organizations:f,setCurrentOrg:v,refresh:y,onSortChange:b,currentSort:N,premiumUser:Z,setAccessToken:k}=e,[S,C]=(0,d.useState)(null),[I,P]=(0,d.useState)([]),[A,E]=d.useState(()=>N?[{id:N.sortBy,desc:"desc"===N.sortOrder}]:[{id:"created_at",desc:!0}]),[T,L]=(0,d.useState)({}),{filters:O,filteredKeys:M,allKeyAliases:D,allTeams:R,allOrganizations:q,handleFilterChange:U,handleFilterReset:V}=function(e){let{keys:s,teams:t,organizations:l,accessToken:a}=e,r={"Team ID":"","Organization ID":"","Key Alias":"","User ID":"","Sort By":"created_at","Sort Order":"desc"},[i,n]=(0,d.useState)(r),[o,c]=(0,d.useState)(t||[]),[m,u]=(0,d.useState)(l||[]),[x,h]=(0,d.useState)(s),p=(0,d.useRef)(0),j=(0,d.useCallback)(eA()(async e=>{if(!a)return;let s=Date.now();p.current=s;try{let t=await (0,g.keyListCall)(a,e["Organization ID"]||null,e["Team ID"]||null,e["Key Alias"]||null,e["User ID"]||null,e["Key Hash"]||null,1,25,e["Sort By"]||null,e["Sort Order"]||null);s===p.current&&t&&(h(t.keys),console.log("called from debouncedSearch filters:",JSON.stringify(e)),console.log("called from debouncedSearch data:",JSON.stringify(t)))}catch(e){console.error("Error searching users:",e)}},300),[a]);(0,d.useEffect)(()=>{if(!s){h([]);return}let e=[...s];i["Team ID"]&&(e=e.filter(e=>e.team_id===i["Team ID"])),i["Organization ID"]&&(e=e.filter(e=>e.organization_id===i["Organization ID"])),h(e)},[s,i]),(0,d.useEffect)(()=>{let e=async()=>{let e=await su(a);e.length>0&&c(e);let s=await sx(a);s.length>0&&u(s)};a&&e()},[a]);let f=(0,sd.a)({queryKey:["allKeys"],queryFn:async()=>{if(!a)throw Error("Access token required");return await sm(a)},enabled:!!a}).data||[];return(0,d.useEffect)(()=>{t&&t.length>0&&c(e=>e.length<t.length?t:e)},[t]),(0,d.useEffect)(()=>{l&&l.length>0&&u(e=>e.length<l.length?l:e)},[l]),{filters:i,filteredKeys:x,allKeyAliases:f,allTeams:o,allOrganizations:m,handleFilterChange:e=>{n({"Team ID":e["Team ID"]||"","Organization ID":e["Organization ID"]||"","Key Alias":e["Key Alias"]||"","User ID":e["User ID"]||"","Sort By":e["Sort By"]||"created_at","Sort Order":e["Sort Order"]||"desc"}),j({...i,...e})},handleFilterReset:()=>{n(r),j(r)}}}({keys:s,teams:n,organizations:f,accessToken:h});(0,d.useEffect)(()=>{if(h){let e=s.map(e=>e.user_id).filter(e=>null!==e);(async()=>{P((await (0,g.userListCall)(h,e,1,100)).users)})()}},[h,s]),(0,d.useEffect)(()=>{if(y){let e=()=>{y()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}},[y]);let K=[{id:"expander",header:()=>null,cell:e=>{let{row:s}=e;return s.getCanExpand()?(0,c.jsx)("button",{onClick:s.getToggleExpandedHandler(),style:{cursor:"pointer"},children:s.getIsExpanded()?"▼":"▶"}):null}},{id:"token",accessorKey:"token",header:"Key ID",cell:e=>(0,c.jsx)("div",{className:"overflow-hidden",children:(0,c.jsx)(z.Z,{title:e.getValue(),children:(0,c.jsx)(_.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>C(e.getValue()),children:e.getValue()?"".concat(e.getValue().slice(0,7),"..."):"-"})})})},{id:"key_alias",accessorKey:"key_alias",header:"Key Alias",cell:e=>{let s=e.getValue();return(0,c.jsx)(z.Z,{title:s,children:s?s.length>20?"".concat(s.slice(0,20),"..."):s:"-"})}},{id:"key_name",accessorKey:"key_name",header:"Secret Key",cell:e=>(0,c.jsx)("span",{className:"font-mono text-xs",children:e.getValue()})},{id:"team_alias",accessorKey:"team_id",header:"Team Alias",cell:e=>{let{row:s,getValue:t}=e,l=t(),a=null==n?void 0:n.find(e=>e.team_id===l);return(null==a?void 0:a.team_alias)||"Unknown"}},{id:"team_id",accessorKey:"team_id",header:"Team ID",cell:e=>(0,c.jsx)(z.Z,{title:e.getValue(),children:e.getValue()?"".concat(e.getValue().slice(0,7),"..."):"-"})},{id:"organization_id",accessorKey:"organization_id",header:"Organization ID",cell:e=>e.getValue()?e.renderValue():"-"},{id:"user_email",accessorKey:"user_id",header:"User Email",cell:e=>{let s=e.getValue(),t=I.find(e=>e.user_id===s);return(null==t?void 0:t.user_email)?(0,c.jsx)(z.Z,{title:null==t?void 0:t.user_email,children:(0,c.jsxs)("span",{children:[null==t?void 0:t.user_email.slice(0,20),"..."]})}):"-"}},{id:"user_id",accessorKey:"user_id",header:"User ID",cell:e=>{let s=e.getValue();return s&&s.length>15?(0,c.jsx)(z.Z,{title:s,children:(0,c.jsxs)("span",{children:[s.slice(0,7),"..."]})}):s||"-"}},{id:"created_at",accessorKey:"created_at",header:"Created At",cell:e=>{let s=e.getValue();return s?new Date(s).toLocaleDateString():"-"}},{id:"created_by",accessorKey:"created_by",header:"Created By",cell:e=>{let s=e.getValue();return s&&s.length>15?(0,c.jsx)(z.Z,{title:s,children:(0,c.jsxs)("span",{children:[s.slice(0,7),"..."]})}):s}},{id:"updated_at",accessorKey:"updated_at",header:"Updated At",cell:e=>{let s=e.getValue();return s?new Date(s).toLocaleDateString():"Never"}},{id:"expires",accessorKey:"expires",header:"Expires",cell:e=>{let s=e.getValue();return s?new Date(s).toLocaleDateString():"Never"}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",cell:e=>eD(e.getValue(),4)},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",cell:e=>{let s=e.getValue();return null===s?"Unlimited":"$".concat(eD(s))}},{id:"budget_reset_at",accessorKey:"budget_reset_at",header:"Budget Reset",cell:e=>{let s=e.getValue();return s?new Date(s).toLocaleString():"Never"}},{id:"models",accessorKey:"models",header:"Models",cell:e=>{let s=e.getValue();return(0,c.jsx)("div",{className:"flex flex-col py-2",children:Array.isArray(s)?(0,c.jsx)("div",{className:"flex flex-col",children:0===s.length?(0,c.jsx)(eJ.Z,{size:"xs",className:"mb-1",color:"red",children:(0,c.jsx)(w.Z,{children:"All Proxy Models"})}):(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"flex items-start",children:[s.length>3&&(0,c.jsx)("div",{children:(0,c.jsx)(sj.Z,{icon:T[e.row.id]?sZ.Z:sw.Z,className:"cursor-pointer",size:"xs",onClick:()=>{L(s=>({...s,[e.row.id]:!s[e.row.id]}))}})}),(0,c.jsxs)("div",{className:"flex flex-wrap gap-1",children:[s.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,c.jsx)(eJ.Z,{size:"xs",color:"red",children:(0,c.jsx)(w.Z,{children:"All Proxy Models"})},s):(0,c.jsx)(eJ.Z,{size:"xs",color:"blue",children:(0,c.jsx)(w.Z,{children:e.length>30?"".concat(F(e).slice(0,30),"..."):F(e)})},s)),s.length>3&&!T[e.row.id]&&(0,c.jsx)(eJ.Z,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,c.jsxs)(w.Z,{children:["+",s.length-3," ",s.length-3==1?"more model":"more models"]})}),T[e.row.id]&&(0,c.jsx)("div",{className:"flex flex-wrap gap-1",children:s.slice(3).map((e,s)=>"all-proxy-models"===e?(0,c.jsx)(eJ.Z,{size:"xs",color:"red",children:(0,c.jsx)(w.Z,{children:"All Proxy Models"})},s+3):(0,c.jsx)(eJ.Z,{size:"xs",color:"blue",children:(0,c.jsx)(w.Z,{children:e.length>30?"".concat(F(e).slice(0,30),"..."):F(e)})},s+3))})]})]})})}):null})}},{id:"rate_limits",header:"Rate Limits",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{children:["TPM: ",null!==t.tpm_limit?t.tpm_limit:"Unlimited"]}),(0,c.jsxs)("div",{children:["RPM: ",null!==t.rpm_limit?t.rpm_limit:"Unlimited"]})]})}}];console.log("keys: ".concat(JSON.stringify(s)));let B=(0,sp.b7)({data:M,columns:K.filter(e=>"expander"!==e.id),state:{sorting:A},onSortingChange:e=>{let s="function"==typeof e?e(A):e;if(console.log("newSorting: ".concat(JSON.stringify(s))),E(s),s&&s.length>0){let e=s[0],t=e.id,l=e.desc?"desc":"asc";console.log("sortBy: ".concat(t,", sortOrder: ").concat(l)),U({...O,"Sort By":t,"Sort Order":l}),null==b||b(t,l)}},getCoreRowModel:(0,sg.sC)(),getSortedRowModel:(0,sg.tj)(),enableSorting:!0,manualSorting:!1});return d.useEffect(()=>{N&&E([{id:N.sortBy,desc:"desc"===N.sortOrder}])},[N]),(0,c.jsx)("div",{className:"w-full h-full overflow-hidden",children:S?(0,c.jsx)(sn,{keyId:S,onClose:()=>C(null),keyData:M.find(e=>e.token===S),onKeyDataUpdate:e=>{t(s=>s.map(s=>s.token===e.token?eM(s,e):s)),y&&y()},onDelete:()=>{t(e=>e.filter(e=>e.token!==S)),y&&y()},accessToken:h,userID:p,userRole:j,teams:R,premiumUser:Z,setAccessToken:k}):(0,c.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,c.jsx)("div",{className:"w-full mb-6",children:(0,c.jsx)(sc,{options:[{name:"Team ID",label:"Team ID",isSearchable:!0,searchFn:async e=>R&&0!==R.length?R.filter(s=>s.team_id.toLowerCase().includes(e.toLowerCase())||s.team_alias&&s.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:"".concat(e.team_alias||e.team_id," (").concat(e.team_id,")"),value:e.team_id})):[]},{name:"Organization ID",label:"Organization ID",isSearchable:!0,searchFn:async e=>q&&0!==q.length?q.filter(s=>{var t,l;return null!==(l=null===(t=s.organization_id)||void 0===t?void 0:t.toLowerCase().includes(e.toLowerCase()))&&void 0!==l&&l}).filter(e=>null!==e.organization_id&&void 0!==e.organization_id).map(e=>({label:"".concat(e.organization_id||"Unknown"," (").concat(e.organization_id,")"),value:e.organization_id})):[]},{name:"Key Alias",label:"Key Alias",isSearchable:!0,searchFn:async e=>D.filter(s=>s.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e}))},{name:"User ID",label:"User ID",isSearchable:!1},{name:"Key Hash",label:"Key Hash",isSearchable:!1}],onApplyFilters:U,initialValues:O,onResetFilters:V})}),(0,c.jsxs)("div",{className:"flex items-center justify-between w-full mb-4",children:[(0,c.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",l?"...":"".concat((a.currentPage-1)*i+1," - ").concat(Math.min(a.currentPage*i,a.totalCount))," of ",l?"...":a.totalCount," results"]}),(0,c.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,c.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",l?"...":a.currentPage," of ",l?"...":a.totalPages]}),(0,c.jsx)("button",{onClick:()=>r(a.currentPage-1),disabled:l||1===a.currentPage,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,c.jsx)("button",{onClick:()=>r(a.currentPage+1),disabled:l||a.currentPage===a.totalPages,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),(0,c.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,c.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,c.jsx)("div",{className:"overflow-x-auto",children:(0,c.jsxs)(sf.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,c.jsx)(sy.Z,{children:B.getHeaderGroups().map(e=>(0,c.jsx)(sN.Z,{children:e.headers.map(e=>(0,c.jsx)(sb.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,c.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,sp.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,c.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,c.jsx)(sk.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,c.jsx)(sZ.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,c.jsx)(sS.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,c.jsx)(sv.Z,{children:l?(0,c.jsx)(sN.Z,{children:(0,c.jsx)(s_.Z,{colSpan:K.length,className:"h-8 text-center",children:(0,c.jsx)("div",{className:"text-center text-gray-500",children:(0,c.jsx)("p",{children:"\uD83D\uDE85 Loading keys..."})})})}):M.length>0?B.getRowModel().rows.map(e=>(0,c.jsx)(sN.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,c.jsx)(s_.Z,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("models"===e.column.id&&e.getValue().length>3?"px-0":""),children:(0,sp.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,c.jsx)(sN.Z,{children:(0,c.jsx)(s_.Z,{colSpan:K.length,className:"h-8 text-center",children:(0,c.jsx)("div",{className:"text-center text-gray-500",children:(0,c.jsx)("p",{children:"No keys found"})})})})})]})})})})]})})}var sI=e=>{let{userID:s,userRole:t,accessToken:l,selectedTeam:a,setSelectedTeam:r,data:i,setData:n,teams:o,premiumUser:m,currentOrg:u,organizations:x,setCurrentOrg:h,selectedKeyAlias:p,setSelectedKeyAlias:j,createClicked:b,setAccessToken:N}=e,[Z,C]=(0,d.useState)(!1),[E,T]=(0,d.useState)(!1),[L,O]=(0,d.useState)(null),[M,F]=(0,d.useState)(null),[R,U]=(0,d.useState)(null),[z,V]=(0,d.useState)((null==a?void 0:a.team_id)||"");(0,d.useEffect)(()=>{V((null==a?void 0:a.team_id)||"")},[a]);let{keys:K,isLoading:B,error:G,pagination:H,refresh:J,setKeys:Y}=eG({selectedTeam:a||void 0,currentOrg:u,selectedKeyAlias:p,accessToken:l||"",createClicked:b}),[W,$]=(0,d.useState)(!1),[Q,X]=(0,d.useState)(!1),[ee,es]=(0,d.useState)(null),[et,el]=(0,d.useState)([]),ea=new Set,[er,ei]=(0,d.useState)(!1),[en,eo]=(0,d.useState)(!1),[ec,ed]=(0,d.useState)(null),[em,eu]=(0,d.useState)(null),[ex]=I.Z.useForm(),[eh,ep]=(0,d.useState)(null),[eg,ej]=(0,d.useState)(ea),[ef,ev]=(0,d.useState)([]);(0,d.useEffect)(()=>{console.log("in calculateNewExpiryTime for selectedToken",ee),(null==em?void 0:em.duration)?ep((e=>{if(!e)return null;try{let s;let t=new Date;if(e.endsWith("s"))s=(0,eB.Z)(t,{seconds:parseInt(e)});else if(e.endsWith("h"))s=(0,eB.Z)(t,{hours:parseInt(e)});else if(e.endsWith("d"))s=(0,eB.Z)(t,{days:parseInt(e)});else throw Error("Invalid duration format");return s.toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})}catch(e){return null}})(em.duration)):ep(null),console.log("calculateNewExpiryTime:",eh)},[ee,null==em?void 0:em.duration]),(0,d.useEffect)(()=>{(async()=>{try{if(null===s||null===t||null===l)return;let e=await D(s,t,l);e&&el(e)}catch(e){console.error("Error fetching user models:",e)}})()},[l,s,t]),(0,d.useEffect)(()=>{if(o){let e=new Set;o.forEach((s,t)=>{let l=s.team_id;e.add(l)}),ej(e)}},[o]);let e_=async()=>{if(null!=L&&null!=i){try{if(!l)return;await (0,g.keyDeleteCall)(l,L);let e=i.filter(e=>e.token!==L);n(e)}catch(e){console.error("Error deleting the key:",e)}T(!1),O(null)}},ey=(e,s)=>{eu(t=>({...t,[e]:s}))},eb=async()=>{if(!m){P.ZP.error("Regenerate API Key is an Enterprise feature. Please upgrade to use this feature.");return}if(null!=ee)try{let e=await ex.validateFields();if(!l)return;let s=await (0,g.regenerateKeyCall)(l,ee.token||ee.token_id,e);if(ed(s.key),i){let t=i.map(t=>t.token===(null==ee?void 0:ee.token)?{...t,key_name:s.key_name,...e}:t);n(t)}eo(!1),ex.resetFields(),P.ZP.success("API Key regenerated successfully")}catch(e){console.error("Error regenerating key:",e),P.ZP.error("Failed to regenerate API Key")}};return(0,c.jsxs)("div",{children:[(0,c.jsx)(sC,{keys:K,setKeys:Y,isLoading:B,pagination:H,onPageChange:e=>{J({page:e})},pageSize:100,teams:o,selectedTeam:a,setSelectedTeam:r,accessToken:l,userID:s,userRole:t,organizations:x,setCurrentOrg:h,refresh:J,selectedKeyAlias:p,setSelectedKeyAlias:j,premiumUser:m,setAccessToken:N}),E&&(0,c.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,c.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,c.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,c.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,c.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,c.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,c.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,c.jsx)("div",{className:"sm:flex sm:items-start",children:(0,c.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,c.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Key"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this key ?"})})]})})}),(0,c.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,c.jsx)(_.Z,{onClick:e_,color:"red",className:"ml-2",children:"Delete"}),(0,c.jsx)(_.Z,{onClick:()=>{T(!1),O(null)},children:"Cancel"})]})]})]})}),(0,c.jsx)(A.Z,{title:"Regenerate API Key",visible:en,onCancel:()=>{eo(!1),ex.resetFields()},footer:[(0,c.jsx)(_.Z,{onClick:()=>{eo(!1),ex.resetFields()},className:"mr-2",children:"Cancel"},"cancel"),(0,c.jsx)(_.Z,{onClick:eb,disabled:!m,children:m?"Regenerate":"Upgrade to Regenerate"},"regenerate")],children:m?(0,c.jsxs)(I.Z,{form:ex,layout:"vertical",onValuesChange:(e,s)=>{"duration"in e&&ey("duration",e.duration)},children:[(0,c.jsx)(I.Z.Item,{name:"key_alias",label:"Key Alias",children:(0,c.jsx)(y.Z,{disabled:!0})}),(0,c.jsx)(I.Z.Item,{name:"max_budget",label:"Max Budget (USD)",children:(0,c.jsx)(q.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{name:"tpm_limit",label:"TPM Limit",children:(0,c.jsx)(q.Z,{style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{name:"rpm_limit",label:"RPM Limit",children:(0,c.jsx)(q.Z,{style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{name:"duration",label:"Expire Key (eg: 30s, 30h, 30d)",className:"mt-8",children:(0,c.jsx)(y.Z,{placeholder:""})}),(0,c.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Current expiry:"," ",(null==ee?void 0:ee.expires)!=null?new Date(ee.expires).toLocaleString():"Never"]}),eh&&(0,c.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["New expiry: ",eh]})]}):(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"mb-2 text-gray-500 italic text-[12px]",children:"Upgrade to use this feature"}),(0,c.jsx)(_.Z,{variant:"primary",className:"mb-2",children:(0,c.jsx)("a",{href:"https://calendly.com/d/4mp-gd3-k5k/litellm-1-1-onboarding-chat",target:"_blank",children:"Get Free Trial"})})]})}),ec&&(0,c.jsx)(A.Z,{visible:!!ec,onCancel:()=>ed(null),footer:[(0,c.jsx)(_.Z,{onClick:()=>ed(null),children:"Close"},"close")],children:(0,c.jsxs)(v.Z,{numItems:1,className:"gap-2 w-full",children:[(0,c.jsx)(k.Z,{children:"Regenerated Key"}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)("p",{children:["Please replace your old key with the new key generated. For security reasons, ",(0,c.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,c.jsxs)(f.Z,{numColSpan:1,children:[(0,c.jsx)(w.Z,{className:"mt-3",children:"Key Alias:"}),(0,c.jsx)("div",{style:{background:"#f8f8f8",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:(0,c.jsx)("pre",{style:{wordWrap:"break-word",whiteSpace:"normal"},children:(null==ee?void 0:ee.key_alias)||"No alias set"})}),(0,c.jsx)(w.Z,{className:"mt-3",children:"New API Key:"}),(0,c.jsx)("div",{style:{background:"#f8f8f8",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:(0,c.jsx)("pre",{style:{wordWrap:"break-word",whiteSpace:"normal"},children:ec})}),(0,c.jsx)(S.CopyToClipboard,{text:ec,onCopy:()=>P.ZP.success("API Key copied to clipboard"),children:(0,c.jsx)(_.Z,{className:"mt-3",children:"Copy API Key"})})]})]})})]})},sP=t(12011),sA=t(3914),sE=e=>{let{userID:s,userRole:t,teams:l,keys:a,setUserRole:r,userEmail:i,setUserEmail:n,setTeams:o,setKeys:x,premiumUser:h,organizations:p,addKey:_,createClicked:y}=e,[b,N]=(0,d.useState)(null),[Z,w]=(0,d.useState)(null),k=(0,m.useSearchParams)(),S=function(e){console.log("COOKIES",document.cookie);let s=document.cookie.split("; ").find(s=>s.startsWith(e+"="));return s?s.split("=")[1]:null}("token"),C=k.get("invitation_id"),[I,P]=(0,d.useState)(null),[A,E]=(0,d.useState)(null),[T,L]=(0,d.useState)([]),[O,M]=(0,d.useState)(null),[D,F]=(0,d.useState)(null),[R,q]=(0,d.useState)(null);if(window.addEventListener("beforeunload",function(){sessionStorage.clear()}),(0,d.useEffect)(()=>{if(S){let e=(0,u.o)(S);if(e){if(console.log("Decoded token:",e),console.log("Decoded key:",e.key),P(e.key),e.user_role){let s=function(e){if(!e)return"Undefined Role";switch(console.log("Received user role: ".concat(e)),e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"app_user":return"App User";case"internal_user":return"Internal User";case"internal_user_viewer":return"Internal Viewer";default:return"Unknown Role"}}(e.user_role);console.log("Decoded user_role:",s),r(s)}else console.log("User role not defined");e.user_email?n(e.user_email):console.log("User Email is not set ".concat(e))}}if(s&&I&&t&&!a&&!b){let e=sessionStorage.getItem("userModels"+s);e?L(JSON.parse(e)):(console.log("currentOrg: ".concat(JSON.stringify(Z))),(async()=>{try{let e=await (0,g.getProxyUISettings)(I);M(e);let l=await (0,g.userInfoCall)(I,s,t,!1,null,null);N(l.user_info),console.log("userSpendData: ".concat(JSON.stringify(b))),(null==l?void 0:l.teams[0].keys)?x(l.keys.concat(l.teams.filter(e=>"Admin"===t||e.user_id===s).flatMap(e=>e.keys))):x(l.keys),sessionStorage.setItem("userData"+s,JSON.stringify(l.keys)),sessionStorage.setItem("userSpendData"+s,JSON.stringify(l.user_info));let a=(await (0,g.modelAvailableCall)(I,s,t)).data.map(e=>e.id);console.log("available_model_names:",a),L(a),console.log("userModels:",T),sessionStorage.setItem("userModels"+s,JSON.stringify(a))}catch(e){console.error("There was an error fetching the data",e),e.message.includes("Invalid proxy server token passed")&&U()}})(),j(I,s,t,Z,o))}},[s,S,I,a,t]),(0,d.useEffect)(()=>{I&&(async()=>{try{let e=await (0,g.keyInfoCall)(I,[I]);console.log("keyInfo: ",e)}catch(e){e.message.includes("Invalid proxy server token passed")&&U()}})()},[I]),(0,d.useEffect)(()=>{console.log("currentOrg: ".concat(JSON.stringify(Z),", accessToken: ").concat(I,", userID: ").concat(s,", userRole: ").concat(t)),I&&(console.log("fetching teams"),j(I,s,t,Z,o))},[Z]),(0,d.useEffect)(()=>{if(null!==a&&null!=D&&null!==D.team_id){let e=0;for(let s of(console.log("keys: ".concat(JSON.stringify(a))),a))D.hasOwnProperty("team_id")&&null!==s.team_id&&s.team_id===D.team_id&&(e+=s.spend);console.log("sum: ".concat(e)),E(e)}else if(null!==a){let e=0;for(let s of a)e+=s.spend;E(e)}},[D]),null!=C)return(0,c.jsx)(sP.default,{});function U(){(0,sA.b)();let e=(0,g.getProxyBaseUrl)();console.log("proxyBaseUrl:",e);let s=e?"".concat(e,"/sso/key/generate"):"/sso/key/generate";return console.log("Full URL:",s),window.location.href=s,null}if(null==S)return console.log("All cookies before redirect:",document.cookie),U(),null;try{let e=(0,u.o)(S);console.log("Decoded token:",e);let s=e.exp,t=Math.floor(Date.now()/1e3);if(s&&t>=s)return console.log("Token expired, redirecting to login"),U(),null}catch(e){return console.error("Error decoding token:",e),(0,sA.b)(),U(),null}if(null==I)return null;if(null==s)return(0,c.jsx)("h1",{children:"User ID is not set"});if(null==t&&r("App Owner"),t&&"Admin Viewer"==t){let{Title:e,Paragraph:s}=em.default;return(0,c.jsxs)("div",{children:[(0,c.jsx)(e,{level:1,children:"Access Denied"}),(0,c.jsx)(s,{children:"Ask your proxy admin for access to create keys"})]})}return console.log("inside user dashboard, selected team",D),console.log("All cookies after redirect:",document.cookie),(0,c.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,c.jsx)(v.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,c.jsxs)(f.Z,{numColSpan:1,className:"flex flex-col gap-2",children:[(0,c.jsx)(eK,{userID:s,team:D,teams:l,userRole:t,accessToken:I,data:a,addKey:_,premiumUser:h},D?D.team_id:null),(0,c.jsx)(sI,{userID:s,userRole:t,accessToken:I,selectedTeam:D||null,setSelectedTeam:F,selectedKeyAlias:R,setSelectedKeyAlias:q,data:a,setData:x,premiumUser:h,teams:l,currentOrg:Z,setCurrentOrg:w,organizations:p,createClicked:y,setAccessToken:P})]})})})},sT=t(97765),sL=t(42673);let sO=async(e,s,t)=>{try{console.log("handling submit for formValues:",e);let s=e.model_mappings||[];if("model_mappings"in e&&delete e.model_mappings,e.model&&e.model.includes("all-wildcard")){let t=e.custom_llm_provider,l=sL.fK[t]+"/*";e.model_name=l,s.push({public_name:l,litellm_model:l}),e.model=l}let t=[];for(let l of s){let s={},a={},r=l.public_name;for(let[t,r]of(s.model=l.litellm_model,e.input_cost_per_token&&(e.input_cost_per_token=Number(e.input_cost_per_token)/1e6),e.output_cost_per_token&&(e.output_cost_per_token=Number(e.output_cost_per_token)/1e6),s.model=l.litellm_model,console.log("formValues add deployment:",e),Object.entries(e)))if(""!==r&&"custom_pricing"!==t&&"pricing_model"!==t&&"cache_control"!==t){if("model_name"==t)s.model=r;else if("custom_llm_provider"==t){console.log("custom_llm_provider:",r);let e=sL.fK[r];s.custom_llm_provider=e,console.log("custom_llm_provider mappingResult:",e)}else if("model"==t)continue;else if("base_model"===t)a[t]=r;else if("team_id"===t)a.team_id=r;else if("model_access_group"===t)a.access_groups=r;else if("mode"==t)console.log("placing mode in modelInfo"),a.mode=r,delete s.mode;else if("custom_model_name"===t)s.model=r;else if("litellm_extra_params"==t){console.log("litellm_extra_params:",r);let e={};if(r&&void 0!=r){try{e=JSON.parse(r)}catch(e){throw P.ZP.error("Failed to parse LiteLLM Extra Params: "+e,10),Error("Failed to parse litellm_extra_params: "+e)}for(let[t,l]of Object.entries(e))s[t]=l}}else if("model_info_params"==t){console.log("model_info_params:",r);let e={};if(r&&void 0!=r){try{e=JSON.parse(r)}catch(e){throw P.ZP.error("Failed to parse LiteLLM Extra Params: "+e,10),Error("Failed to parse litellm_extra_params: "+e)}for(let[s,t]of Object.entries(e))a[s]=t}}else if("input_cost_per_token"===t||"output_cost_per_token"===t||"input_cost_per_second"===t){r&&(s[t]=Number(r));continue}else s[t]=r}t.push({litellmParamsObj:s,modelInfoObj:a,modelName:r})}return t}catch(e){P.ZP.error("Failed to create model: "+e,10)}},sM=async(e,s,t,l)=>{try{let a=await sO(e,s,t);if(!a||0===a.length)return;for(let e of a){let{litellmParamsObj:t,modelInfoObj:l,modelName:a}=e,r={model_name:a,litellm_params:t,model_info:l},i=await (0,g.modelCreateCall)(s,r);console.log("response for model create call: ".concat(i.data))}l&&l(),t.resetFields()}catch(e){P.ZP.error("Failed to add model: "+e,10)}};var sD=t(53410),sF=t(47451),sR=t(69410);let{Link:sq}=em.default,sU={[sL.Cl.OpenAI]:[{key:"api_base",label:"API Base",type:"select",options:["https://api.openai.com/v1","https://eu.api.openai.com"],defaultValue:"https://api.openai.com/v1"},{key:"organization",label:"OpenAI Organization ID",placeholder:"[OPTIONAL] my-unique-org"},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[sL.Cl.OpenAI_Text]:[{key:"api_base",label:"API Base",type:"select",options:["https://api.openai.com/v1","https://eu.api.openai.com"],defaultValue:"https://api.openai.com/v1"},{key:"organization",label:"OpenAI Organization ID",placeholder:"[OPTIONAL] my-unique-org"},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[sL.Cl.Vertex_AI]:[{key:"vertex_project",label:"Vertex Project",placeholder:"adroit-cadet-1234..",required:!0},{key:"vertex_location",label:"Vertex Location",placeholder:"us-east-1",required:!0},{key:"vertex_credentials",label:"Vertex Credentials",required:!0,type:"upload"}],[sL.Cl.AssemblyAI]:[{key:"api_base",label:"API Base",type:"select",required:!0,options:["https://api.assemblyai.com","https://api.eu.assemblyai.com"]},{key:"api_key",label:"AssemblyAI API Key",type:"password",required:!0}],[sL.Cl.Azure]:[{key:"api_base",label:"API Base",placeholder:"https://...",required:!0},{key:"api_version",label:"API Version",placeholder:"2023-07-01-preview",tooltip:"By default litellm will use the latest version. If you want to use a different version, you can specify it here"},{key:"base_model",label:"Base Model",placeholder:"azure/gpt-3.5-turbo"},{key:"api_key",label:"Azure API Key",type:"password",required:!0}],[sL.Cl.Azure_AI_Studio]:[{key:"api_base",label:"API Base",placeholder:"https://<test>.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-10-21",tooltip:"Enter your full Target URI from Azure Foundry here. Example:  https://litellm8397336933.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-10-21",required:!0},{key:"api_key",label:"Azure API Key",type:"password",required:!0}],[sL.Cl.OpenAI_Compatible]:[{key:"api_base",label:"API Base",placeholder:"https://...",required:!0},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[sL.Cl.OpenAI_Text_Compatible]:[{key:"api_base",label:"API Base",placeholder:"https://...",required:!0},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[sL.Cl.Bedrock]:[{key:"aws_access_key_id",label:"AWS Access Key ID",type:"password",required:!1,tooltip:"You can provide the raw key or the environment variable (e.g. `os.environ/MY_SECRET_KEY`)."},{key:"aws_secret_access_key",label:"AWS Secret Access Key",type:"password",required:!1,tooltip:"You can provide the raw key or the environment variable (e.g. `os.environ/MY_SECRET_KEY`)."},{key:"aws_region_name",label:"AWS Region Name",placeholder:"us-east-1",required:!1,tooltip:"You can provide the raw key or the environment variable (e.g. `os.environ/MY_SECRET_KEY`)."}],[sL.Cl.Ollama]:[{key:"api_base",label:"API Base",placeholder:"http://localhost:11434",defaultValue:"http://localhost:11434",required:!1,tooltip:"The base URL for your Ollama server. Defaults to http://localhost:11434 if not specified."}],[sL.Cl.Anthropic]:[{key:"api_key",label:"API Key",placeholder:"sk-",type:"password",required:!0}],[sL.Cl.Deepgram]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.ElevenLabs]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.Google_AI_Studio]:[{key:"api_key",label:"API Key",placeholder:"aig-",type:"password",required:!0}],[sL.Cl.Groq]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.MistralAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.Deepseek]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.Cohere]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.Databricks]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.xAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.Cerebras]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.Sambanova]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.Perplexity]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.TogetherAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.Openrouter]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.FireworksAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[sL.Cl.Triton]:[{key:"api_key",label:"API Key",type:"password",required:!1},{key:"api_base",label:"API Base",placeholder:"http://localhost:8000/generate",required:!1}]};var sz=e=>{let{selectedProvider:s,uploadProps:t}=e,l=sL.Cl[s],a=I.Z.useFormInstance(),r=d.useMemo(()=>sU[l]||[],[l]),i={name:"file",accept:".json",beforeUpload:e=>{if("application/json"===e.type){let s=new FileReader;s.onload=e=>{if(e.target){let s=e.target.result;console.log("Setting field value from JSON, length: ".concat(s.length)),a.setFieldsValue({vertex_credentials:s}),console.log("Form values after setting:",a.getFieldsValue())}},s.readAsText(e)}return!1},onChange(e){console.log("Upload onChange triggered in ProviderSpecificFields"),console.log("Current form values:",a.getFieldsValue()),"uploading"!==e.file.status&&console.log(e.file,e.fileList)}};return(0,c.jsx)(c.Fragment,{children:r.map(e=>{var s;return(0,c.jsxs)(d.Fragment,{children:[(0,c.jsx)(I.Z.Item,{label:e.label,name:e.key,rules:e.required?[{required:!0,message:"Required"}]:void 0,tooltip:e.tooltip,className:"vertex_credentials"===e.key?"mb-0":void 0,children:"select"===e.type?(0,c.jsx)(C.default,{placeholder:e.placeholder,defaultValue:e.defaultValue,children:null===(s=e.options)||void 0===s?void 0:s.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:e},e))}):"upload"===e.type?(0,c.jsx)(ex.default,{...i,onChange:s=>{(null==t?void 0:t.onChange)&&t.onChange(s),setTimeout(()=>{let s=a.getFieldValue(e.key);console.log("".concat(e.key," value after upload:"),JSON.stringify(s))},500)},children:(0,c.jsx)(T.ZP,{icon:(0,c.jsx)(e_.Z,{}),children:"Click to Upload"})}):(0,c.jsx)(y.Z,{placeholder:e.placeholder,type:"password"===e.type?"password":"text"})}),"vertex_credentials"===e.key&&(0,c.jsx)(sF.Z,{children:(0,c.jsx)(sR.Z,{children:(0,c.jsx)(w.Z,{className:"mb-3 mt-1",children:"Give a gcp service account(.json file)"})})}),"base_model"===e.key&&(0,c.jsxs)(sF.Z,{children:[(0,c.jsx)(sR.Z,{span:10}),(0,c.jsx)(sR.Z,{span:10,children:(0,c.jsxs)(w.Z,{className:"mb-2",children:["The actual model your azure deployment uses. Used for accurate cost tracking. Select name from"," ",(0,c.jsx)(sq,{href:"https://github.com/BerriAI/litellm/blob/main/model_prices_and_context_window.json",target:"_blank",children:"here"})]})})]})]},e.key)})})};let{Title:sV,Link:sK}=em.default;var sB=e=>{let{isVisible:s,onCancel:t,onAddCredential:l,onUpdateCredential:a,uploadProps:r,addOrEdit:i,existingCredential:n}=e,[o]=I.Z.useForm(),[m,u]=(0,d.useState)(sL.Cl.OpenAI),[x,h]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{n&&(o.setFieldsValue({credential_name:n.credential_name,custom_llm_provider:n.credential_info.custom_llm_provider,api_base:n.credential_values.api_base,api_version:n.credential_values.api_version,base_model:n.credential_values.base_model,api_key:n.credential_values.api_key}),u(n.credential_info.custom_llm_provider))},[n]),(0,c.jsx)(A.Z,{title:"add"===i?"Add New Credential":"Edit Credential",visible:s,onCancel:()=>{t(),o.resetFields()},footer:null,width:600,children:(0,c.jsxs)(I.Z,{form:o,onFinish:e=>{let s=Object.entries(e).reduce((e,s)=>{let[t,l]=s;return""!==l&&null!=l&&(e[t]=l),e},{});"add"===i?l(s):a(s),o.resetFields()},layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{label:"Credential Name:",name:"credential_name",rules:[{required:!0,message:"Credential name is required"}],initialValue:null==n?void 0:n.credential_name,children:(0,c.jsx)(y.Z,{placeholder:"Enter a friendly name for these credentials",disabled:null!=n&&!!n.credential_name})}),(0,c.jsx)(I.Z.Item,{rules:[{required:!0,message:"Required"}],label:"Provider:",name:"custom_llm_provider",tooltip:"Helper to auto-populate provider specific fields",children:(0,c.jsx)(C.default,{showSearch:!0,onChange:e=>{u(e),o.setFieldValue("custom_llm_provider",e)},children:Object.entries(sL.Cl).map(e=>{let[s,t]=e;return(0,c.jsx)(C.default.Option,{value:s,children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("img",{src:sL.cd[t],alt:"".concat(s," logo"),className:"w-5 h-5",onError:e=>{let s=e.target,l=s.parentElement;if(l){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=t.charAt(0),l.replaceChild(e,s)}}}),(0,c.jsx)("span",{children:t})]})},s)})})}),(0,c.jsx)(sz,{selectedProvider:m,uploadProps:r}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(z.Z,{title:"Get help on our github",children:(0,c.jsx)(sK,{href:"https://github.com/BerriAI/litellm/issues",children:"Need Help?"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)(T.ZP,{onClick:()=>{t(),o.resetFields()},style:{marginRight:10},children:"Cancel"}),(0,c.jsx)(T.ZP,{htmlType:"submit",children:"add"===i?"Add Credential":"Update Credential"})]})]})]})})},sG=e=>{let{accessToken:s,uploadProps:t,credentialList:l,fetchCredentials:a}=e,[r,i]=(0,d.useState)(!1),[n,o]=(0,d.useState)(!1),[m,u]=(0,d.useState)(null),[x]=I.Z.useForm(),h=["credential_name","custom_llm_provider"],p=async e=>{if(!s)return;let t=Object.entries(e).filter(e=>{let[s]=e;return!h.includes(s)}).reduce((e,s)=>{let[t,l]=s;return{...e,[t]:l}},{}),l={credential_name:e.credential_name,credential_values:t,credential_info:{custom_llm_provider:e.custom_llm_provider}};await (0,g.credentialUpdateCall)(s,e.credential_name,l),P.ZP.success("Credential updated successfully"),o(!1),a(s)},j=async e=>{if(!s)return;let t=Object.entries(e).filter(e=>{let[s]=e;return!h.includes(s)}).reduce((e,s)=>{let[t,l]=s;return{...e,[t]:l}},{}),l={credential_name:e.credential_name,credential_values:t,credential_info:{custom_llm_provider:e.custom_llm_provider}};await (0,g.credentialCreateCall)(s,l),P.ZP.success("Credential added successfully"),i(!1),a(s)};(0,d.useEffect)(()=>{s&&a(s)},[s]);let f=e=>{let s={openai:"blue",azure:"indigo",anthropic:"purple",default:"gray"},t=s[e.toLowerCase()]||s.default;return(0,c.jsx)(eJ.Z,{color:t,size:"xs",children:e})},v=async e=>{s&&(await (0,g.credentialDeleteCall)(s,e),P.ZP.success("Credential deleted successfully"),a(s))};return(0,c.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[(0,c.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,c.jsx)(w.Z,{children:"Configured credentials for different AI providers. Add and manage your API credentials."})}),(0,c.jsx)(W.Z,{children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Credential Name"}),(0,c.jsx)(sb.Z,{children:"Provider"}),(0,c.jsx)(sb.Z,{children:"Description"})]})}),(0,c.jsx)(sv.Z,{children:l&&0!==l.length?l.map((e,s)=>{var t,l;return(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:e.credential_name}),(0,c.jsx)(s_.Z,{children:f((null===(t=e.credential_info)||void 0===t?void 0:t.custom_llm_provider)||"-")}),(0,c.jsx)(s_.Z,{children:(null===(l=e.credential_info)||void 0===l?void 0:l.description)||"-"}),(0,c.jsxs)(s_.Z,{children:[(0,c.jsx)(_.Z,{icon:sD.Z,variant:"light",size:"sm",onClick:()=>{u(e),o(!0)}}),(0,c.jsx)(_.Z,{icon:ee.Z,variant:"light",size:"sm",onClick:()=>v(e.credential_name)})]})]},s)}):(0,c.jsx)(sN.Z,{children:(0,c.jsx)(s_.Z,{colSpan:4,className:"text-center py-4 text-gray-500",children:"No credentials configured"})})})]})}),(0,c.jsx)(_.Z,{onClick:()=>i(!0),className:"mt-4",children:"Add Credential"}),r&&(0,c.jsx)(sB,{onAddCredential:j,isVisible:r,onCancel:()=>i(!1),uploadProps:t,addOrEdit:"add",onUpdateCredential:p,existingCredential:null}),n&&(0,c.jsx)(sB,{onAddCredential:j,isVisible:n,existingCredential:m,onUpdateCredential:p,uploadProps:t,onCancel:()=>o(!1),addOrEdit:"edit"})]})};let sH=e=>{var s;return(null==e?void 0:null===(s=e.model_info)||void 0===s?void 0:s.team_public_model_name)?e.model_info.team_public_model_name:(null==e?void 0:e.model_name)||"-"};var sJ=t(53003),sY=e=>{let{value:s,onValueChange:t,label:l="Select Time Range",className:a="",showTimeRange:r=!0}=e;return(0,c.jsxs)("div",{className:a,children:[l&&(0,c.jsx)(w.Z,{className:"mb-2",children:l}),(0,c.jsx)(sJ.Z,{enableSelect:!0,value:s,onValueChange:e=>{if(e.from){let s;let l={...e},a=new Date(e.from);s=new Date(e.to?e.to:e.from),a.toDateString(),s.toDateString(),a.setHours(0,0,0,0),s.setHours(23,59,59,999),l.from=a,l.to=s,t(l)}else t(e)}}),r&&s.from&&s.to&&(0,c.jsx)(w.Z,{className:"mt-1 text-xs text-gray-500",children:((e,s)=>{if(!e||!s)return"";let t=e=>e.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0,timeZoneName:"short"});if(e.toDateString()!==s.toDateString())return"".concat(t(e)," - ").concat(t(s));{let t=e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),l=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),a=s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZoneName:"short"});return"".concat(t,": ").concat(l," - ").concat(a)}})(s.from,s.to)})]})},sW=t(75105),s$=t(40278),sQ=t(14301),sX=t(59664),s0=e=>{let{modelMetrics:s,modelMetricsCategories:t,customTooltip:l,premiumUser:a}=e;return(0,c.jsx)(sX.Z,{title:"Time to First token (s)",className:"h-72",data:s,index:"date",showLegend:!1,categories:t,colors:["indigo","rose"],connectNulls:!0,customTooltip:l})},s1=e=>{let{teamData:s,canEditTeam:t,handleMemberDelete:l,setSelectedEditMember:a,setIsEditMemberModalVisible:r,setIsAddMemberModalVisible:i}=e,n=e=>{if(null==e)return"0";if("number"==typeof e){let s=Number(e);return s===Math.floor(s)?s.toString():eD(s,8).replace(/\.?0+$/,"")}return"0"},o=e=>{if(!e)return 0;let t=s.team_memberships.find(s=>s.user_id===e);return(null==t?void 0:t.spend)||0},d=e=>{var t;if(!e)return null;let l=s.team_memberships.find(s=>s.user_id===e);console.log("membership=".concat(l));let a=null==l?void 0:null===(t=l.litellm_budget_table)||void 0===t?void 0:t.max_budget;return null==a?null:n(a)};return(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsx)(W.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"User ID"}),(0,c.jsx)(sb.Z,{children:"User Email"}),(0,c.jsx)(sb.Z,{children:"Role"}),(0,c.jsxs)(sb.Z,{children:["Team Member Spend (USD)"," ",(0,c.jsx)(z.Z,{title:"This is the amount spent by a user in the team.",children:(0,c.jsx)(U.Z,{})})]}),(0,c.jsx)(sb.Z,{children:"Team Member Budget (USD)"}),(0,c.jsx)(sb.Z,{})]})}),(0,c.jsx)(sv.Z,{children:s.team_info.members_with_roles.map((e,s)=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{className:"font-mono",children:e.user_id})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{className:"font-mono",children:e.user_email?e.user_email:"No Email"})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{className:"font-mono",children:e.role})}),(0,c.jsx)(s_.Z,{children:(0,c.jsxs)(w.Z,{className:"font-mono",children:["$",eD(o(e.user_id),4)]})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{className:"font-mono",children:d(e.user_id)?"$".concat(eD(Number(d(e.user_id)),4)):"No Limit"})}),(0,c.jsx)(s_.Z,{children:t&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>{a(e),r(!0)}}),(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>l(e)})]})})]},s))})]})}),(0,c.jsx)(_.Z,{onClick:()=>i(!0),children:"Add Member"})]})},s2=t(61994),s4=t(85180),s5=t(89245),s6=t(78355);let s3={"/key/generate":"Member can generate a virtual key for this team","/key/service-account/generate":"Member can generate a service account key (not belonging to any user) for this team","/key/update":"Member can update a virtual key belonging to this team","/key/delete":"Member can delete a virtual key belonging to this team","/key/info":"Member can get info about a virtual key belonging to this team","/key/regenerate":"Member can regenerate a virtual key belonging to this team","/key/{key_id}/regenerate":"Member can regenerate a virtual key belonging to this team","/key/list":"Member can list virtual keys belonging to this team","/key/block":"Member can block a virtual key belonging to this team","/key/unblock":"Member can unblock a virtual key belonging to this team"},s8=e=>e.includes("/info")||e.includes("/list")?"GET":"POST",s7=e=>{let s=s8(e),t=s3[e];if(!t){for(let[s,l]of Object.entries(s3))if(e.includes(s)){t=l;break}}return t||(t="Access ".concat(e)),{method:s,endpoint:e,description:t,route:e}};var s9=e=>{let{teamId:s,accessToken:t,canEditTeam:l}=e,[a,r]=(0,d.useState)([]),[i,n]=(0,d.useState)([]),[o,m]=(0,d.useState)(!0),[u,x]=(0,d.useState)(!1),[h,p]=(0,d.useState)(!1),j=async()=>{try{if(m(!0),!t)return;let e=await (0,g.getTeamPermissionsCall)(t,s),l=e.all_available_permissions||[];r(l);let a=e.team_member_permissions||[];n(a),p(!1)}catch(e){P.ZP.error("Failed to load permissions"),console.error("Error fetching permissions:",e)}finally{m(!1)}};(0,d.useEffect)(()=>{j()},[s,t]);let f=(e,s)=>{n(s?[...i,e]:i.filter(s=>s!==e)),p(!0)},v=async()=>{try{if(!t)return;x(!0),await (0,g.teamPermissionsUpdateCall)(t,s,i),P.ZP.success("Permissions updated successfully"),p(!1)}catch(e){P.ZP.error("Failed to update permissions"),console.error("Error updating permissions:",e)}finally{x(!1)}};if(o)return(0,c.jsx)("div",{className:"p-6 text-center",children:"Loading permissions..."});let y=a.length>0;return(0,c.jsxs)(W.Z,{className:"bg-white shadow-md rounded-md p-6",children:[(0,c.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center border-b pb-4 mb-6",children:[(0,c.jsx)(k.Z,{className:"mb-2 sm:mb-0",children:"Member Permissions"}),l&&h&&(0,c.jsxs)("div",{className:"flex gap-3",children:[(0,c.jsx)(T.ZP,{icon:(0,c.jsx)(s5.Z,{}),onClick:()=>{j()},children:"Reset"}),(0,c.jsxs)(_.Z,{onClick:v,loading:u,className:"flex items-center gap-2",children:[(0,c.jsx)(s6.Z,{})," Save Changes"]})]})]}),(0,c.jsx)(w.Z,{className:"mb-6 text-gray-600",children:"Control what team members can do when they are not team admins."}),y?(0,c.jsxs)(sf.Z,{className:"mt-4",children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Method"}),(0,c.jsx)(sb.Z,{children:"Endpoint"}),(0,c.jsx)(sb.Z,{children:"Description"}),(0,c.jsx)(sb.Z,{className:"text-right",children:"Access"})]})}),(0,c.jsx)(sv.Z,{children:a.map(e=>{let s=s7(e);return(0,c.jsxs)(sN.Z,{className:"hover:bg-gray-50 transition-colors",children:[(0,c.jsx)(s_.Z,{children:(0,c.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("GET"===s.method?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:s.method})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)("span",{className:"font-mono text-sm text-gray-800",children:s.endpoint})}),(0,c.jsx)(s_.Z,{className:"text-gray-700",children:s.description}),(0,c.jsx)(s_.Z,{className:"text-right",children:(0,c.jsx)(s2.Z,{checked:i.includes(e),onChange:s=>f(e,s.target.checked),disabled:!l})})]},e)})})]}):(0,c.jsx)("div",{className:"py-12",children:(0,c.jsx)(s4.Z,{description:"No permissions available"})})]})},te=e=>{var s,t,l;let{visible:a,onCancel:r,onSubmit:i,initialData:n,mode:o,config:m}=e,[u]=I.Z.useForm();console.log("Initial Data:",n),(0,d.useEffect)(()=>{if(a){if("edit"===o&&n)u.setFieldsValue({...n,role:n.role||m.defaultRole});else{var e;u.resetFields(),u.setFieldsValue({role:m.defaultRole||(null===(e=m.roleOptions[0])||void 0===e?void 0:e.value)})}}},[a,n,o,u,m.defaultRole,m.roleOptions]);let x=async e=>{try{let s=Object.entries(e).reduce((e,s)=>{let[t,l]=s;return{...e,[t]:"string"==typeof l?l.trim():l}},{});i(s),u.resetFields()}catch(e){console.error("Form submission error:",e)}},h=e=>{switch(e.type){case"input":return(0,c.jsx)(L.default,{className:"px-3 py-2 border rounded-md w-full",onChange:e=>{e.target.value=e.target.value.trim()}});case"select":var s;return(0,c.jsx)(C.default,{children:null===(s=e.options)||void 0===s?void 0:s.map(e=>(0,c.jsx)(C.default.Option,{value:e.value,children:e.label},e.value))});default:return null}};return(0,c.jsx)(A.Z,{title:m.title||("add"===o?"Add Member":"Edit Member"),open:a,width:800,footer:null,onCancel:r,children:(0,c.jsxs)(I.Z,{form:u,onFinish:x,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[m.showEmail&&(0,c.jsx)(I.Z.Item,{label:"Email",name:"user_email",className:"mb-4",rules:[{type:"email",message:"Please enter a valid email!"}],children:(0,c.jsx)(L.default,{className:"px-3 py-2 border rounded-md w-full",placeholder:"user@example.com",onChange:e=>{e.target.value=e.target.value.trim()}})}),m.showEmail&&m.showUserId&&(0,c.jsx)("div",{className:"text-center mb-4",children:(0,c.jsx)(w.Z,{children:"OR"})}),m.showUserId&&(0,c.jsx)(I.Z.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,c.jsx)(L.default,{className:"px-3 py-2 border rounded-md w-full",placeholder:"user_123",onChange:e=>{e.target.value=e.target.value.trim()}})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("span",{children:"Role"}),"edit"===o&&n&&(0,c.jsxs)("span",{className:"text-gray-500 text-sm",children:["(Current: ",(t=n.role,(null===(l=m.roleOptions.find(e=>e.value===t))||void 0===l?void 0:l.label)||t),")"]})]}),name:"role",className:"mb-4",rules:[{required:!0,message:"Please select a role!"}],children:(0,c.jsx)(C.default,{children:"edit"===o&&n?[...m.roleOptions.filter(e=>e.value===n.role),...m.roleOptions.filter(e=>e.value!==n.role)].map(e=>(0,c.jsx)(C.default.Option,{value:e.value,children:e.label},e.value)):m.roleOptions.map(e=>(0,c.jsx)(C.default.Option,{value:e.value,children:e.label},e.value))})}),null===(s=m.additionalFields)||void 0===s?void 0:s.map(e=>(0,c.jsx)(I.Z.Item,{label:e.label,name:e.name,className:"mb-4",rules:e.rules,children:h(e)},e.name)),(0,c.jsxs)("div",{className:"text-right mt-6",children:[(0,c.jsx)(T.ZP,{onClick:r,className:"mr-2",children:"Cancel"}),(0,c.jsx)(T.ZP,{type:"default",htmlType:"submit",children:"add"===o?"Add Member":"Save Changes"})]})]})})},ts=e=>{let{isVisible:s,onCancel:t,onSubmit:l,accessToken:a,title:r="Add Team Member",roles:i=[{label:"admin",value:"admin",description:"Admin role. Can create team keys, add members, and manage settings."},{label:"user",value:"user",description:"User role. Can view team info, but not manage it."}],defaultRole:n="user"}=e,[o]=I.Z.useForm(),[m,u]=(0,d.useState)([]),[x,h]=(0,d.useState)(!1),[p,j]=(0,d.useState)("user_email"),f=async(e,s)=>{if(!e){u([]);return}h(!0);try{let t=new URLSearchParams;if(t.append(s,e),null==a)return;let l=(await (0,g.userFilterUICall)(a,t)).map(e=>({label:"user_email"===s?"".concat(e.user_email):"".concat(e.user_id),value:"user_email"===s?e.user_email:e.user_id,user:e}));u(l)}catch(e){console.error("Error fetching users:",e)}finally{h(!1)}},v=(0,d.useCallback)(eA()((e,s)=>f(e,s),300),[]),_=(e,s)=>{j(s),v(e,s)},y=(e,s)=>{let t=s.user;o.setFieldsValue({user_email:t.user_email,user_id:t.user_id,role:o.getFieldValue("role")})};return(0,c.jsx)(A.Z,{title:r,open:s,onCancel:()=>{o.resetFields(),u([]),t()},footer:null,width:800,children:(0,c.jsxs)(I.Z,{form:o,onFinish:l,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",initialValues:{role:n},children:[(0,c.jsx)(I.Z.Item,{label:"Email",name:"user_email",className:"mb-4",children:(0,c.jsx)(C.default,{showSearch:!0,className:"w-full",placeholder:"Search by email",filterOption:!1,onSearch:e=>_(e,"user_email"),onSelect:(e,s)=>y(e,s),options:"user_email"===p?m:[],loading:x,allowClear:!0})}),(0,c.jsx)("div",{className:"text-center mb-4",children:"OR"}),(0,c.jsx)(I.Z.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,c.jsx)(C.default,{showSearch:!0,className:"w-full",placeholder:"Search by user ID",filterOption:!1,onSearch:e=>_(e,"user_id"),onSelect:(e,s)=>y(e,s),options:"user_id"===p?m:[],loading:x,allowClear:!0})}),(0,c.jsx)(I.Z.Item,{label:"Member Role",name:"role",className:"mb-4",children:(0,c.jsx)(C.default,{defaultValue:n,children:i.map(e=>(0,c.jsx)(C.default.Option,{value:e.value,children:(0,c.jsxs)(z.Z,{title:e.description,children:[(0,c.jsx)("span",{className:"font-medium",children:e.label}),(0,c.jsxs)("span",{className:"ml-2 text-gray-500 text-sm",children:["- ",e.description]})]})},e.value))})}),(0,c.jsx)("div",{className:"text-right mt-4",children:(0,c.jsx)(T.ZP,{type:"default",htmlType:"submit",children:"Add Member"})})]})})},tt=e=>{var s,t,l,a,r,i,n,o,m,u,x;let{teamId:h,onClose:p,accessToken:j,is_team_admin:f,is_proxy_admin:b,userModels:N,editTeam:Z,premiumUser:S=!1,onUpdate:A}=e,[E,O]=(0,d.useState)(null),[D,R]=(0,d.useState)(!0),[q,V]=(0,d.useState)(!1),[K]=I.Z.useForm(),[B,G]=(0,d.useState)(!1),[J,Y]=(0,d.useState)(null),[$,Q]=(0,d.useState)(!1),[X,ee]=(0,d.useState)([]),[es,et]=(0,d.useState)(!1),[el,ea]=(0,d.useState)({}),[er,ei]=(0,d.useState)([]);console.log("userModels in team info",N);let en=f||b,eo=async()=>{try{if(R(!0),!j)return;let e=await (0,g.teamInfoCall)(j,h);O(e)}catch(e){P.ZP.error("Failed to load team information"),console.error("Error fetching team info:",e)}finally{R(!1)}};(0,d.useEffect)(()=>{eo()},[h,j]),(0,d.useEffect)(()=>{(async()=>{try{if(!j)return;let e=(await (0,g.getGuardrailsList)(j)).guardrails.map(e=>e.guardrail_name);ei(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})()},[j]);let ec=async e=>{try{if(null==j)return;let s={user_email:e.user_email,user_id:e.user_id,role:e.role};await (0,g.teamMemberAddCall)(j,h,s),P.ZP.success("Team member added successfully"),V(!1),K.resetFields();let t=await (0,g.teamInfoCall)(j,h);O(t),A(t)}catch(a){var s,t,l;let e="Failed to add team member";(null==a?void 0:null===(l=a.raw)||void 0===l?void 0:null===(t=l.detail)||void 0===t?void 0:null===(s=t.error)||void 0===s?void 0:s.includes("Assigning team admins is a premium feature"))?e="Assigning admins is an enterprise-only feature. Please upgrade your LiteLLM plan to enable this.":(null==a?void 0:a.message)&&(e=a.message),P.ZP.error(e),console.error("Error adding team member:",a)}},ed=async e=>{try{if(null==j)return;let s={user_email:e.user_email,user_id:e.user_id,role:e.role};P.ZP.destroy(),await (0,g.teamMemberUpdateCall)(j,h,s),P.ZP.success("Team member updated successfully"),G(!1);let t=await (0,g.teamInfoCall)(j,h);O(t),A(t)}catch(l){var s,t;let e="Failed to update team member";(null==l?void 0:null===(t=l.raw)||void 0===t?void 0:null===(s=t.detail)||void 0===s?void 0:s.includes("Assigning team admins is a premium feature"))?e="Assigning admins is an enterprise-only feature. Please upgrade your LiteLLM plan to enable this.":(null==l?void 0:l.message)&&(e=l.message),G(!1),P.ZP.destroy(),P.ZP.error(e),console.error("Error updating team member:",l)}},em=async e=>{try{if(null==j)return;await (0,g.teamMemberDeleteCall)(j,h,e),P.ZP.success("Team member removed successfully");let s=await (0,g.teamInfoCall)(j,h);O(s),A(s)}catch(e){P.ZP.error("Failed to remove team member"),console.error("Error removing team member:",e)}},eu=async e=>{try{if(!j)return;let s={};try{s=e.metadata?JSON.parse(e.metadata):{}}catch(e){P.ZP.error("Invalid JSON in metadata field");return}let t={team_id:h,team_alias:e.team_alias,models:e.models,tpm_limit:e.tpm_limit,rpm_limit:e.rpm_limit,max_budget:e.max_budget,budget_duration:e.budget_duration,metadata:{...s,guardrails:e.guardrails||[],logging:e.logging_settings||[]},organization_id:e.organization_id};void 0!==e.team_member_budget&&(t.team_member_budget=Number(e.team_member_budget)),void 0!==e.team_member_key_duration&&(t.team_member_key_duration=e.team_member_key_duration);let{servers:l,accessGroups:a}=e.mcp_servers_and_groups||{servers:[],accessGroups:[]};(l&&l.length>0||a&&a.length>0)&&(t.object_permission={},l&&l.length>0&&(t.object_permission.mcp_servers=l),a&&a.length>0&&(t.object_permission.mcp_access_groups=a)),delete e.mcp_servers_and_groups,await (0,g.teamUpdateCall)(j,t),P.ZP.success("Team settings updated successfully"),Q(!1),eo()}catch(e){console.error("Error updating team:",e)}};if(D)return(0,c.jsx)("div",{className:"p-4",children:"Loading..."});if(!(null==E?void 0:E.team_info))return(0,c.jsx)("div",{className:"p-4",children:"Team not found"});let{team_info:ex}=E,eh=async(e,s)=>{await eF(e)&&(ea(e=>({...e,[s]:!0})),setTimeout(()=>{ea(e=>({...e,[s]:!1}))},2e3))};return(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,c.jsxs)("div",{children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",onClick:p,className:"mb-4",children:"Back to Teams"}),(0,c.jsx)(k.Z,{children:ex.team_alias}),(0,c.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,c.jsx)(w.Z,{className:"text-gray-500 font-mono",children:ex.team_id}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:el["team-id"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>eh(ex.team_id,"team-id"),className:"left-2 z-10 transition-all duration-200 ".concat(el["team-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]})}),(0,c.jsxs)(eW.Z,{defaultIndex:Z?3:0,children:[(0,c.jsx)(e$.Z,{className:"mb-4",children:[(0,c.jsx)(eY.Z,{children:"Overview"},"overview"),...en?[(0,c.jsx)(eY.Z,{children:"Members"},"members"),(0,c.jsx)(eY.Z,{children:"Member Permissions"},"member-permissions"),(0,c.jsx)(eY.Z,{children:"Settings"},"settings")]:[]]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Budget Status"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)(k.Z,{children:["$",eD(ex.spend,4)]}),(0,c.jsxs)(w.Z,{children:["of"," ",null===ex.max_budget?"Unlimited":"$".concat(eD(ex.max_budget,4))]}),ex.budget_duration&&(0,c.jsxs)(w.Z,{className:"text-gray-500",children:["Reset: ",ex.budget_duration]}),(0,c.jsx)("br",{}),ex.team_member_budget_table&&(0,c.jsxs)(w.Z,{className:"text-gray-500",children:["Team Member Budget: $",eD(ex.team_member_budget_table.max_budget,4)]})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Rate Limits"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)(w.Z,{children:["TPM: ",ex.tpm_limit||"Unlimited"]}),(0,c.jsxs)(w.Z,{children:["RPM: ",ex.rpm_limit||"Unlimited"]}),ex.max_parallel_requests&&(0,c.jsxs)(w.Z,{children:["Max Parallel Requests: ",ex.max_parallel_requests]})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Models"}),(0,c.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:0===ex.models.length?(0,c.jsx)(eJ.Z,{color:"red",children:"All proxy models"}):ex.models.map((e,s)=>(0,c.jsx)(eJ.Z,{color:"red",children:e},s))})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{className:"font-semibold text-gray-900",children:"Virtual Keys"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)(w.Z,{children:["User Keys: ",E.keys.filter(e=>e.user_id).length]}),(0,c.jsxs)(w.Z,{children:["Service Account Keys: ",E.keys.filter(e=>!e.user_id).length]}),(0,c.jsxs)(w.Z,{className:"text-gray-500",children:["Total: ",E.keys.length]})]})]}),(0,c.jsx)(sl,{objectPermission:ex.object_permission,variant:"card",accessToken:j}),(0,c.jsx)(sa,{loggingConfigs:(null===(s=ex.metadata)||void 0===s?void 0:s.logging)||[],disabledCallbacks:[],variant:"card"})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(s1,{teamData:E,canEditTeam:en,handleMemberDelete:em,setSelectedEditMember:Y,setIsEditMemberModalVisible:G,setIsAddMemberModalVisible:V})}),en&&(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(s9,{teamId:h,accessToken:j,canEditTeam:en})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(W.Z,{className:"overflow-y-auto max-h-[65vh]",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"Team Settings"}),en&&!$&&(0,c.jsx)(_.Z,{onClick:()=>Q(!0),children:"Edit Settings"})]}),$?(0,c.jsxs)(I.Z,{form:K,onFinish:eu,initialValues:{...ex,team_alias:ex.team_alias,models:ex.models,tpm_limit:ex.tpm_limit,rpm_limit:ex.rpm_limit,max_budget:ex.max_budget,budget_duration:ex.budget_duration,guardrails:(null===(t=ex.metadata)||void 0===t?void 0:t.guardrails)||[],metadata:ex.metadata?JSON.stringify((e=>{let{logging:s,...t}=e;return t})(ex.metadata),null,2):"",logging_settings:(null===(l=ex.metadata)||void 0===l?void 0:l.logging)||[],organization_id:ex.organization_id,vector_stores:(null===(a=ex.object_permission)||void 0===a?void 0:a.vector_stores)||[],mcp_servers:(null===(r=ex.object_permission)||void 0===r?void 0:r.mcp_servers)||[],mcp_access_groups:(null===(i=ex.object_permission)||void 0===i?void 0:i.mcp_access_groups)||[],mcp_servers_and_groups:{servers:(null===(n=ex.object_permission)||void 0===n?void 0:n.mcp_servers)||[],accessGroups:(null===(o=ex.object_permission)||void 0===o?void 0:o.mcp_access_groups)||[]}},layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{label:"Team Name",name:"team_alias",rules:[{required:!0,message:"Please input a team name"}],children:(0,c.jsx)(L.default,{type:""})}),(0,c.jsx)(I.Z.Item,{label:"Models",name:"models",children:(0,c.jsxs)(C.default,{mode:"multiple",placeholder:"Select models",children:[(0,c.jsx)(C.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),Array.from(new Set(N)).map((e,s)=>(0,c.jsx)(C.default.Option,{value:e,children:F(e)},s))]})}),(0,c.jsx)(I.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,c.jsx)(M,{step:.01,precision:2,style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{label:"Team Member Budget (USD)",name:"team_member_budget",tooltip:"This is the individual budget for a user in the team.",children:(0,c.jsx)(M,{step:.01,precision:2,style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{label:"Team Member Key Duration (eg: 1d, 1mo)",name:"team_member_key_duration",tooltip:"Set a limit to the duration of a team member's key. Format: 30s (seconds), 30m (minutes), 30h (hours), 30d (days), 1mo (month)",children:(0,c.jsx)(y.Z,{placeholder:"e.g., 30d"})}),(0,c.jsx)(I.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,c.jsxs)(C.default,{placeholder:"n/a",children:[(0,c.jsx)(C.default.Option,{value:"24h",children:"daily"}),(0,c.jsx)(C.default.Option,{value:"7d",children:"weekly"}),(0,c.jsx)(C.default.Option,{value:"30d",children:"monthly"})]})}),(0,c.jsx)(I.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,c.jsx)(M,{step:1,style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,c.jsx)(M,{step:1,style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Guardrails"," ",(0,c.jsx)(z.Z,{title:"Setup your first guardrail",children:(0,c.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",help:"Select existing guardrails or enter new ones",children:(0,c.jsx)(C.default,{mode:"tags",placeholder:"Select or enter guardrails",options:er.map(e=>({value:e,label:e}))})}),(0,c.jsx)(I.Z.Item,{label:"Vector Stores",name:"vector_stores",children:(0,c.jsx)(H,{onChange:e=>K.setFieldValue("vector_stores",e),value:K.getFieldValue("vector_stores"),accessToken:j||"",placeholder:"Select vector stores"})}),(0,c.jsx)(I.Z.Item,{label:"MCP Servers / Access Groups",name:"mcp_servers_and_groups",children:(0,c.jsx)(eR,{onChange:e=>K.setFieldValue("mcp_servers_and_groups",e),value:K.getFieldValue("mcp_servers_and_groups"),accessToken:j||"",placeholder:"Select MCP servers or access groups (optional)"})}),(0,c.jsx)(I.Z.Item,{label:"Organization ID",name:"organization_id",children:(0,c.jsx)(L.default,{type:""})}),(0,c.jsx)(I.Z.Item,{label:"Logging Settings",name:"logging_settings",children:(0,c.jsx)(e2,{value:K.getFieldValue("logging_settings"),onChange:e=>K.setFieldValue("logging_settings",e)})}),(0,c.jsx)(I.Z.Item,{label:"Metadata",name:"metadata",children:(0,c.jsx)(L.default.TextArea,{rows:10})}),(0,c.jsx)("div",{className:"sticky z-10 bg-white p-4 border-t border-gray-200 bottom-[-1.5rem] inset-x-[-1.5rem]",children:(0,c.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,c.jsx)(T.ZP,{htmlType:"button",onClick:()=>Q(!1),children:"Cancel"}),(0,c.jsx)(_.Z,{type:"submit",children:"Save Changes"})]})})]}):(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Team Name"}),(0,c.jsx)("div",{children:ex.team_alias})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Team ID"}),(0,c.jsx)("div",{className:"font-mono",children:ex.team_id})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Created At"}),(0,c.jsx)("div",{children:new Date(ex.created_at).toLocaleString()})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Models"}),(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:ex.models.map((e,s)=>(0,c.jsx)(eJ.Z,{color:"red",children:e},s))})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Rate Limits"}),(0,c.jsxs)("div",{children:["TPM: ",ex.tpm_limit||"Unlimited"]}),(0,c.jsxs)("div",{children:["RPM: ",ex.rpm_limit||"Unlimited"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Team Budget"}),(0,c.jsxs)("div",{children:["Max Budget:"," ",null!==ex.max_budget?"$".concat(eD(ex.max_budget,4)):"No Limit"]}),(0,c.jsxs)("div",{children:["Budget Reset: ",ex.budget_duration||"Never"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)(w.Z,{className:"font-medium",children:["Team Member Settings"," ",(0,c.jsx)(z.Z,{title:"These are limits on individual team members",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),(0,c.jsxs)("div",{children:["Max Budget:"," ",(null===(m=ex.team_member_budget_table)||void 0===m?void 0:m.max_budget)||"No Limit"]}),(0,c.jsxs)("div",{children:["Key Duration:"," ",(null===(u=ex.metadata)||void 0===u?void 0:u.team_member_key_duration)||"No Limit"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Organization ID"}),(0,c.jsx)("div",{children:ex.organization_id})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Status"}),(0,c.jsx)(eJ.Z,{color:ex.blocked?"red":"green",children:ex.blocked?"Blocked":"Active"})]}),(0,c.jsx)(sl,{objectPermission:ex.object_permission,variant:"inline",className:"pt-4 border-t border-gray-200",accessToken:j}),(0,c.jsx)(sa,{loggingConfigs:(null===(x=ex.metadata)||void 0===x?void 0:x.logging)||[],disabledCallbacks:[],variant:"inline",className:"pt-4 border-t border-gray-200"})]})]})})]})]}),(0,c.jsx)(te,{visible:B,onCancel:()=>G(!1),onSubmit:ed,initialData:J,mode:"edit",config:{title:"Edit Member",showEmail:!0,showUserId:!0,roleOptions:[{label:"Admin",value:"admin"},{label:"User",value:"user"}]}}),(0,c.jsx)(ts,{isVisible:q,onCancel:()=>V(!1),onSubmit:ec,accessToken:j})]})},tl=t(45589);let{Title:ta,Link:tr}=em.default;var ti=e=>{let{isVisible:s,onCancel:t,onAddCredential:l,existingCredential:a,setIsCredentialModalOpen:r}=e,[i]=I.Z.useForm();return console.log("existingCredential in add credentials tab: ".concat(JSON.stringify(a))),(0,c.jsx)(A.Z,{title:"Reuse Credentials",visible:s,onCancel:()=>{t(),i.resetFields()},footer:null,width:600,children:(0,c.jsxs)(I.Z,{form:i,onFinish:e=>{l(e),i.resetFields(),r(!1)},layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{label:"Credential Name:",name:"credential_name",rules:[{required:!0,message:"Credential name is required"}],initialValue:null==a?void 0:a.credential_name,children:(0,c.jsx)(y.Z,{placeholder:"Enter a friendly name for these credentials"})}),Object.entries((null==a?void 0:a.credential_values)||{}).map(e=>{let[s,t]=e;return(0,c.jsx)(I.Z.Item,{label:s,name:s,initialValue:t,children:(0,c.jsx)(y.Z,{placeholder:"Enter ".concat(s),disabled:!0})},s)}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(z.Z,{title:"Get help on our github",children:(0,c.jsx)(tr,{href:"https://github.com/BerriAI/litellm/issues",children:"Need Help?"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)(T.ZP,{onClick:()=>{t(),i.resetFields()},style:{marginRight:10},children:"Cancel"}),(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Reuse Credentials"})]})]})]})})},tn=t(63709),to=t(45246),tc=t(96473);let{Text:td}=em.default;var tm=e=>{let{form:s,showCacheControl:t,onCacheControlChange:l}=e,a=e=>{let t=s.getFieldValue("litellm_extra_params");try{let l=t?JSON.parse(t):{};e.length>0?l.cache_control_injection_points=e:delete l.cache_control_injection_points,Object.keys(l).length>0?s.setFieldValue("litellm_extra_params",JSON.stringify(l,null,2)):s.setFieldValue("litellm_extra_params","")}catch(e){console.error("Error updating cache control points:",e)}};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{label:"Cache Control Injection Points",name:"cache_control",valuePropName:"checked",className:"mb-4",tooltip:"Tell litellm where to inject cache control checkpoints. You can specify either by role (to apply to all messages of that role) or by specific message index.",children:(0,c.jsx)(tn.Z,{onChange:l,className:"bg-gray-600"})}),t&&(0,c.jsxs)("div",{className:"ml-6 pl-4 border-l-2 border-gray-200",children:[(0,c.jsx)(td,{className:"text-sm text-gray-500 block mb-4",children:"Providers like Anthropic, Bedrock API require users to specify where to inject cache control checkpoints, litellm can automatically add them for you as a cost saving feature."}),(0,c.jsx)(I.Z.List,{name:"cache_control_injection_points",initialValue:[{location:"message"}],children:(e,t)=>{let{add:l,remove:r}=t;return(0,c.jsxs)(c.Fragment,{children:[e.map((t,l)=>(0,c.jsxs)("div",{className:"flex items-center mb-4 gap-4",children:[(0,c.jsx)(I.Z.Item,{...t,label:"Type",name:[t.name,"location"],initialValue:"message",className:"mb-0",style:{width:"180px"},children:(0,c.jsx)(C.default,{disabled:!0,options:[{value:"message",label:"Message"}]})}),(0,c.jsx)(I.Z.Item,{...t,label:"Role",name:[t.name,"role"],className:"mb-0",style:{width:"180px"},tooltip:"LiteLLM will mark all messages of this role as cacheable",children:(0,c.jsx)(C.default,{placeholder:"Select a role",allowClear:!0,options:[{value:"user",label:"User"},{value:"system",label:"System"},{value:"assistant",label:"Assistant"}],onChange:()=>{a(s.getFieldValue("cache_control_points"))}})}),(0,c.jsx)(I.Z.Item,{...t,label:"Index",name:[t.name,"index"],className:"mb-0",style:{width:"180px"},tooltip:"(Optional) If set litellm will mark the message at this index as cacheable",children:(0,c.jsx)(M,{type:"number",placeholder:"Optional",step:1,min:0,onChange:()=>{a(s.getFieldValue("cache_control_points"))}})}),e.length>1&&(0,c.jsx)(to.Z,{className:"text-red-500 cursor-pointer text-lg ml-12",onClick:()=>{r(t.name),setTimeout(()=>{a(s.getFieldValue("cache_control_points"))},0)}})]},t.key)),(0,c.jsx)(I.Z.Item,{children:(0,c.jsxs)("button",{type:"button",className:"flex items-center justify-center w-full border border-dashed border-gray-300 py-2 px-4 text-gray-600 hover:text-blue-600 hover:border-blue-300 transition-all rounded",onClick:()=>l(),children:[(0,c.jsx)(tc.Z,{className:"mr-2"}),"Add Injection Point"]})})]})}})]})]})};let tu=async e=>{try{let s=await (0,g.modelHubCall)(e);if(console.log("model_info:",s),(null==s?void 0:s.data.length)>0){let e=s.data.map(e=>({model_group:e.model_group,mode:null==e?void 0:e.mode}));return e.sort((e,s)=>e.model_group.localeCompare(s.model_group)),e}return[]}catch(e){throw console.error("Error fetching model info:",e),e}};var tx=t(44851),th=t(67960),tp=t(70464);let{TextArea:tg}=L.default,{Panel:tj}=tx.default;var tf=e=>{let{modelInfo:s,value:t,onChange:l}=e,[a,r]=(0,d.useState)([]),[i,n]=(0,d.useState)(!1),[o,m]=(0,d.useState)([]);(0,d.useEffect)(()=>{if(null==t?void 0:t.routes){let e=t.routes.map((e,s)=>({id:e.id||"route-".concat(s,"-").concat(Date.now()),model:e.name||e.model||"",utterances:e.utterances||[],description:e.description||"",score_threshold:e.score_threshold||.5}));r(e),m(e.map(e=>e.id))}else r([]),m([])},[t]);let u=e=>{let s=a.filter(s=>s.id!==e);r(s),h(s),m(s=>s.filter(s=>s!==e))},x=(e,s,t)=>{let l=a.map(l=>l.id===e?{...l,[s]:t}:l);r(l),h(l)},h=e=>{let s={routes:e.map(e=>({name:e.model,utterances:e.utterances,description:e.description,score_threshold:e.score_threshold}))};null==l||l(s)},p=s.map(e=>({value:e.model_group,label:e.model_group}));return(0,c.jsxs)("div",{className:"w-full max-w-none",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-6 w-full",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(w.Z,{className:"text-lg font-semibold",children:"Routes Configuration"}),(0,c.jsx)(z.Z,{title:"Configure routing logic to automatically select the best model based on user input patterns",children:(0,c.jsx)(U.Z,{className:"text-gray-400"})})]}),(0,c.jsx)(T.ZP,{type:"primary",icon:(0,c.jsx)(tc.Z,{}),onClick:()=>{let e="route-".concat(Date.now()),s=[...a,{id:e,model:"",utterances:[],description:"",score_threshold:.5}];r(s),h(s),m(s=>[...s,e])},className:"bg-blue-600 hover:bg-blue-700",children:"Add Route"})]}),0===a.length?(0,c.jsx)("div",{className:"text-center py-12 text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200 mb-6",children:(0,c.jsx)(w.Z,{children:"No routes configured. Click “Add Route” to get started."})}):(0,c.jsx)("div",{className:"space-y-3 mb-6 w-full",children:a.map((e,s)=>(0,c.jsx)(th.Z,{className:"border border-gray-200 shadow-sm w-full",bodyStyle:{padding:0},children:(0,c.jsx)(tx.default,{ghost:!0,expandIcon:e=>{let{isActive:s}=e;return(0,c.jsx)(tp.Z,{rotate:s?180:0})},activeKey:o,onChange:e=>m(Array.isArray(e)?e:[e].filter(Boolean)),items:[{key:e.id,label:(0,c.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,c.jsxs)(w.Z,{className:"font-medium text-base",children:["Route ",s+1,": ",e.model||"Unnamed"]}),(0,c.jsx)(T.ZP,{type:"text",danger:!0,icon:(0,c.jsx)(ef.Z,{}),onClick:s=>{s.stopPropagation(),u(e.id)},className:"mr-2"})]}),children:(0,c.jsxs)("div",{className:"px-6 pb-6 w-full",children:[(0,c.jsxs)("div",{className:"mb-4 w-full",children:[(0,c.jsx)(w.Z,{className:"text-sm font-medium mb-2 block",children:"Model"}),(0,c.jsx)(C.default,{value:e.model,onChange:s=>x(e.id,"model",s),placeholder:"Select model",showSearch:!0,style:{width:"100%"},options:p})]}),(0,c.jsxs)("div",{className:"mb-4 w-full",children:[(0,c.jsx)(w.Z,{className:"text-sm font-medium mb-2 block",children:"Description"}),(0,c.jsx)(tg,{value:e.description,onChange:s=>x(e.id,"description",s.target.value),placeholder:"Describe when this route should be used...",rows:2,style:{width:"100%"}})]}),(0,c.jsxs)("div",{className:"mb-4 w-full",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,c.jsx)(w.Z,{className:"text-sm font-medium",children:"Score Threshold"}),(0,c.jsx)(z.Z,{title:"Minimum similarity score to route to this model (0-1)",children:(0,c.jsx)(U.Z,{className:"text-gray-400"})})]}),(0,c.jsx)(q.Z,{value:e.score_threshold,onChange:s=>x(e.id,"score_threshold",s||0),min:0,max:1,step:.1,style:{width:"100%"},placeholder:"0.5"})]}),(0,c.jsxs)("div",{className:"w-full",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,c.jsx)(w.Z,{className:"text-sm font-medium",children:"Example Utterances"}),(0,c.jsx)(z.Z,{title:"Training examples for this route. Type an utterance and press Enter to add it.",children:(0,c.jsx)(U.Z,{className:"text-gray-400"})})]}),(0,c.jsx)(w.Z,{className:"text-xs text-gray-500 mb-2",children:"Type an utterance and press Enter to add it. You can also paste multiple lines."}),(0,c.jsx)(C.default,{mode:"tags",value:e.utterances,onChange:s=>x(e.id,"utterances",s),placeholder:"Type an utterance and press Enter...",style:{width:"100%"},tokenSeparators:["\n"],maxTagCount:"responsive",allowClear:!0})]})]})}]})},e.id))}),(0,c.jsxs)("div",{className:"border-t pt-6 w-full",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4 w-full",children:[(0,c.jsx)(w.Z,{className:"text-lg font-semibold",children:"JSON Preview"}),(0,c.jsx)(T.ZP,{type:"link",onClick:()=>n(!i),className:"text-blue-600 p-0",children:i?"Hide":"Show"})]}),i&&(0,c.jsx)(th.Z,{className:"bg-gray-50 w-full",children:(0,c.jsx)("pre",{className:"text-sm overflow-auto max-h-64 w-full",children:JSON.stringify({routes:a.map(e=>({name:e.model,utterances:e.utterances,description:e.description,score_threshold:e.score_threshold}))},null,2)})})]})]})},tv=e=>{let{isVisible:s,onCancel:t,onSuccess:l,modelData:a,accessToken:r,userRole:i}=e,[n]=I.Z.useForm(),[o,m]=(0,d.useState)(!1),[u,x]=(0,d.useState)([]),[h,p]=(0,d.useState)([]),[j,f]=(0,d.useState)(!1),[v,_]=(0,d.useState)(!1),[b,N]=(0,d.useState)(null);(0,d.useEffect)(()=>{s&&a&&Z()},[s,a]),(0,d.useEffect)(()=>{let e=async()=>{if(r)try{let e=await (0,g.modelAvailableCall)(r,"","",!1,null,!0,!0);x(e.data.map(e=>e.id))}catch(e){console.error("Error fetching model access groups:",e)}},t=async()=>{if(r)try{let e=await tu(r);p(e)}catch(e){console.error("Error fetching model info:",e)}};s&&(e(),t())},[s,r]);let Z=()=>{try{var e,s,t,l,r,i;let o=null;(null===(e=a.litellm_params)||void 0===e?void 0:e.auto_router_config)&&(o="string"==typeof a.litellm_params.auto_router_config?JSON.parse(a.litellm_params.auto_router_config):a.litellm_params.auto_router_config),N(o),n.setFieldsValue({auto_router_name:a.model_name,auto_router_default_model:(null===(s=a.litellm_params)||void 0===s?void 0:s.auto_router_default_model)||"",auto_router_embedding_model:(null===(t=a.litellm_params)||void 0===t?void 0:t.auto_router_embedding_model)||"",model_access_group:(null===(l=a.model_info)||void 0===l?void 0:l.access_groups)||[]});let c=new Set(h.map(e=>e.model_group));f(!c.has(null===(r=a.litellm_params)||void 0===r?void 0:r.auto_router_default_model)),_(!c.has(null===(i=a.litellm_params)||void 0===i?void 0:i.auto_router_embedding_model))}catch(e){console.error("Error parsing auto router config:",e),P.ZP.error("Error loading auto router configuration")}},k=async()=>{try{m(!0);let e=await n.validateFields(),s={...a.litellm_params,auto_router_config:JSON.stringify(b),auto_router_default_model:e.auto_router_default_model,auto_router_embedding_model:e.auto_router_embedding_model||void 0},i={...a.model_info,access_groups:e.model_access_group||[]},o={model_name:e.auto_router_name,litellm_params:s,model_info:i};await (0,g.modelPatchUpdateCall)(r,o,a.model_info.id);let c={...a,model_name:e.auto_router_name,litellm_params:s,model_info:i};P.ZP.success("Auto router configuration updated successfully"),l(c),t()}catch(e){console.error("Error updating auto router:",e),P.ZP.error("Failed to update auto router configuration")}finally{m(!1)}},S=h.map(e=>({value:e.model_group,label:e.model_group}));return(0,c.jsx)(A.Z,{title:"Edit Auto Router Configuration",open:s,onCancel:t,footer:[(0,c.jsx)(T.ZP,{onClick:t,children:"Cancel"},"cancel"),(0,c.jsx)(T.ZP,{loading:o,onClick:k,children:"Save Changes"},"submit")],width:1e3,destroyOnClose:!0,children:(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsx)(w.Z,{className:"text-gray-600",children:"Edit the auto router configuration including routing logic, default models, and access settings."}),(0,c.jsxs)(I.Z,{form:n,layout:"vertical",className:"space-y-4",children:[(0,c.jsx)(I.Z.Item,{label:"Auto Router Name",name:"auto_router_name",rules:[{required:!0,message:"Auto router name is required"}],children:(0,c.jsx)(y.Z,{placeholder:"e.g., auto_router_1, smart_routing"})}),(0,c.jsx)("div",{className:"w-full",children:(0,c.jsx)(tf,{modelInfo:h,value:b,onChange:e=>{N(e)}})}),(0,c.jsx)(I.Z.Item,{label:"Default Model",name:"auto_router_default_model",rules:[{required:!0,message:"Default model is required"}],children:(0,c.jsx)(C.default,{placeholder:"Select a default model",onChange:e=>{f("custom"===e)},options:[...S,{value:"custom",label:"Enter custom model name"}],showSearch:!0})}),(0,c.jsx)(I.Z.Item,{label:"Embedding Model",name:"auto_router_embedding_model",children:(0,c.jsx)(C.default,{placeholder:"Select an embedding model (optional)",onChange:e=>{_("custom"===e)},options:[...S,{value:"custom",label:"Enter custom model name"}],showSearch:!0,allowClear:!0})}),"Admin"===i&&(0,c.jsx)(I.Z.Item,{label:"Model Access Groups",name:"model_access_group",tooltip:"Control who can access this auto router",children:(0,c.jsx)(C.default,{mode:"tags",showSearch:!0,placeholder:"Select existing groups or type to create new ones",optionFilterProp:"children",tokenSeparators:[","],options:u.map(e=>({value:e,label:e})),maxTagCount:"responsive",allowClear:!0})})]})]})})};function t_(e){var s,t,l,a,r,i,n,o,m,u,x,h,p,j,f,b,N,Z,S,E,O,D,F,R,q,V,K,B;let{modelId:G,onClose:H,modelData:J,accessToken:Y,userID:$,userRole:Q,editModel:X,setEditModalVisible:es,setSelectedModel:et,onModelUpdate:el,modelAccessGroups:ea}=e,[er]=I.Z.useForm(),[ei,en]=(0,d.useState)(null),[eo,ec]=(0,d.useState)(!1),[ed,em]=(0,d.useState)(!1),[eu,ex]=(0,d.useState)(!1),[eh,ep]=(0,d.useState)(!1),[eg,ej]=(0,d.useState)(!1),[ef,ev]=(0,d.useState)(null),[e_,ey]=(0,d.useState)(!1),[eb,eN]=(0,d.useState)({}),[eZ,ew]=(0,d.useState)(!1),[ek,eS]=(0,d.useState)([]),eC="Admin"===Q||(null==J?void 0:null===(s=J.model_info)||void 0===s?void 0:s.created_by)===$,eI=(null==J?void 0:null===(t=J.litellm_params)||void 0===t?void 0:t.auto_router_config)!=null,eP=(null==J?void 0:null===(l=J.litellm_params)||void 0===l?void 0:l.litellm_credential_name)!=null&&(null==J?void 0:null===(a=J.litellm_params)||void 0===a?void 0:a.litellm_credential_name)!=void 0;console.log("usingExistingCredential, ",eP),console.log("modelData.litellm_params.litellm_credential_name, ",null==J?void 0:null===(r=J.litellm_params)||void 0===r?void 0:r.litellm_credential_name),(0,d.useEffect)(()=>{let e=async()=>{var e;if(!Y)return;let s=await (0,g.modelInfoV1Call)(Y,G);console.log("modelInfoResponse, ",s);let t=s.data[0];en(t),(null==t?void 0:null===(e=t.litellm_params)||void 0===e?void 0:e.cache_control_injection_points)&&ey(!0)},s=async()=>{if(Y)try{let e=(await (0,g.getGuardrailsList)(Y)).guardrails.map(e=>e.guardrail_name);eS(e)}catch(e){console.error("Failed to fetch guardrails:",e)}};(async()=>{if(console.log("accessToken, ",Y),!Y||eP)return;let e=await (0,g.credentialGetCall)(Y,null,G);console.log("existingCredentialResponse, ",e),ev({credential_name:e.credential_name,credential_values:e.credential_values,credential_info:e.credential_info})})(),e(),s()},[Y,G]);let eA=async e=>{var s;if(console.log("values, ",e),!Y)return;let t={credential_name:e.credential_name,model_id:G,credential_info:{custom_llm_provider:null===(s=ei.litellm_params)||void 0===s?void 0:s.custom_llm_provider}};P.ZP.info("Storing credential.."),console.log("credentialResponse, ",await (0,g.credentialCreateCall)(Y,t)),P.ZP.success("Credential stored successfully")},eE=async e=>{try{var s;let t;if(!Y)return;ep(!0),console.log("values.model_name, ",e.model_name);let l={...ei.litellm_params,model:e.litellm_model_name,api_base:e.api_base,custom_llm_provider:e.custom_llm_provider,organization:e.organization,tpm:e.tpm,rpm:e.rpm,max_retries:e.max_retries,timeout:e.timeout,stream_timeout:e.stream_timeout,input_cost_per_token:e.input_cost/1e6,output_cost_per_token:e.output_cost/1e6};e.guardrails&&(l.guardrails=e.guardrails),e.cache_control&&(null===(s=e.cache_control_injection_points)||void 0===s?void 0:s.length)>0?l.cache_control_injection_points=e.cache_control_injection_points:delete l.cache_control_injection_points;try{t=e.model_info?JSON.parse(e.model_info):J.model_info,e.model_access_group&&(t={...t,access_groups:e.model_access_group})}catch(e){P.ZP.error("Invalid JSON in Model Info");return}let a={model_name:e.model_name,litellm_params:l,model_info:t};await (0,g.modelPatchUpdateCall)(Y,a,G);let r={...ei,model_name:e.model_name,litellm_model_name:e.litellm_model_name,litellm_params:l,model_info:t};en(r),el&&el(r),P.ZP.success("Model settings updated successfully"),ex(!1),ej(!1)}catch(e){console.error("Error updating model:",e),P.ZP.error("Failed to update model settings")}finally{ep(!1)}};if(!J)return(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",onClick:H,className:"mb-4",children:"Back to Models"}),(0,c.jsx)(w.Z,{children:"Model not found"})]});let eT=async()=>{try{if(!Y)return;await (0,g.modelDeleteCall)(Y,G),P.ZP.success("Model deleted successfully"),el&&el({deleted:!0,model_info:{id:G}}),H()}catch(e){console.error("Error deleting the model:",e),P.ZP.error("Failed to delete model")}},eL=async(e,s)=>{await eF(e)&&(eN(e=>({...e,[s]:!0})),setTimeout(()=>{eN(e=>({...e,[s]:!1}))},2e3))};return(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",onClick:H,className:"mb-4",children:"Back to Models"}),(0,c.jsxs)(k.Z,{children:["Public Model Name: ",sH(J)]}),(0,c.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,c.jsx)(w.Z,{className:"text-gray-500 font-mono",children:J.model_info.id}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:eb["model-id"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>eL(J.model_info.id,"model-id"),className:"left-2 z-10 transition-all duration-200 ".concat(eb["model-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),(0,c.jsxs)("div",{className:"flex gap-2",children:["Admin"===Q&&(0,c.jsx)(_.Z,{icon:tl.Z,variant:"secondary",onClick:()=>em(!0),className:"flex items-center",children:"Re-use Credentials"}),eC&&(0,c.jsx)(_.Z,{icon:ee.Z,variant:"secondary",onClick:()=>ec(!0),className:"flex items-center",children:"Delete Model"})]})]}),(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{className:"mb-6",children:[(0,c.jsx)(eY.Z,{children:"Overview"}),(0,c.jsx)(eY.Z,{children:"Raw JSON"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6 mb-6",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Provider"}),(0,c.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[J.provider&&(0,c.jsx)("img",{src:(0,sL.dr)(J.provider).logo,alt:"".concat(J.provider," logo"),className:"w-4 h-4",onError:e=>{let s=e.target,t=s.parentElement;if(t){var l;let e=document.createElement("div");e.className="w-4 h-4 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=(null===(l=J.provider)||void 0===l?void 0:l.charAt(0))||"-",t.replaceChild(e,s)}}}),(0,c.jsx)(k.Z,{children:J.provider||"Not Set"})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"LiteLLM Model"}),(0,c.jsx)("pre",{children:(0,c.jsx)(k.Z,{children:J.litellm_model_name||"Not Set"})})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Pricing"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)(w.Z,{children:["Input: $",J.input_cost,"/1M tokens"]}),(0,c.jsxs)(w.Z,{children:["Output: $",J.output_cost,"/1M tokens"]})]})]})]}),(0,c.jsxs)("div",{className:"mb-6 text-sm text-gray-500 flex items-center gap-x-6",children:[(0,c.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,c.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Created At"," ",J.model_info.created_at?new Date(J.model_info.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Not Set"]}),(0,c.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,c.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Created By ",J.model_info.created_by||"Not Set"]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"Model Settings"}),(0,c.jsxs)("div",{className:"flex gap-2",children:[eI&&eC&&!eg&&(0,c.jsx)(_.Z,{variant:"primary",onClick:()=>ew(!0),className:"flex items-center",children:"Edit Auto Router"}),eC&&!eg&&(0,c.jsx)(_.Z,{variant:"secondary",onClick:()=>ej(!0),className:"flex items-center",children:"Edit Model"})]})]}),ei?(0,c.jsx)(I.Z,{form:er,onFinish:eE,initialValues:{model_name:ei.model_name,litellm_model_name:ei.litellm_model_name,api_base:ei.litellm_params.api_base,custom_llm_provider:ei.litellm_params.custom_llm_provider,organization:ei.litellm_params.organization,tpm:ei.litellm_params.tpm,rpm:ei.litellm_params.rpm,max_retries:ei.litellm_params.max_retries,timeout:ei.litellm_params.timeout,stream_timeout:ei.litellm_params.stream_timeout,input_cost:ei.litellm_params.input_cost_per_token?1e6*ei.litellm_params.input_cost_per_token:(null===(i=ei.model_info)||void 0===i?void 0:i.input_cost_per_token)*1e6||null,output_cost:(null===(n=ei.litellm_params)||void 0===n?void 0:n.output_cost_per_token)?1e6*ei.litellm_params.output_cost_per_token:(null===(o=ei.model_info)||void 0===o?void 0:o.output_cost_per_token)*1e6||null,cache_control:null!==(m=ei.litellm_params)&&void 0!==m&&!!m.cache_control_injection_points,cache_control_injection_points:(null===(u=ei.litellm_params)||void 0===u?void 0:u.cache_control_injection_points)||[],model_access_group:Array.isArray(null===(x=ei.model_info)||void 0===x?void 0:x.access_groups)?ei.model_info.access_groups:[],guardrails:Array.isArray(null===(h=ei.litellm_params)||void 0===h?void 0:h.guardrails)?ei.litellm_params.guardrails:[]},layout:"vertical",onValuesChange:()=>ex(!0),children:(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Model Name"}),eg?(0,c.jsx)(I.Z.Item,{name:"model_name",className:"mb-0",children:(0,c.jsx)(y.Z,{placeholder:"Enter model name"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:ei.model_name})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"LiteLLM Model Name"}),eg?(0,c.jsx)(I.Z.Item,{name:"litellm_model_name",className:"mb-0",children:(0,c.jsx)(y.Z,{placeholder:"Enter LiteLLM model name"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:ei.litellm_model_name})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Input Cost (per 1M tokens)"}),eg?(0,c.jsx)(I.Z.Item,{name:"input_cost",className:"mb-0",children:(0,c.jsx)(M,{placeholder:"Enter input cost"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null==ei?void 0:null===(p=ei.litellm_params)||void 0===p?void 0:p.input_cost_per_token)?((null===(j=ei.litellm_params)||void 0===j?void 0:j.input_cost_per_token)*1e6).toFixed(4):(null==ei?void 0:null===(f=ei.model_info)||void 0===f?void 0:f.input_cost_per_token)?(1e6*ei.model_info.input_cost_per_token).toFixed(4):null})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Output Cost (per 1M tokens)"}),eg?(0,c.jsx)(I.Z.Item,{name:"output_cost",className:"mb-0",children:(0,c.jsx)(M,{placeholder:"Enter output cost"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null==ei?void 0:null===(b=ei.litellm_params)||void 0===b?void 0:b.output_cost_per_token)?(1e6*ei.litellm_params.output_cost_per_token).toFixed(4):(null==ei?void 0:null===(N=ei.model_info)||void 0===N?void 0:N.output_cost_per_token)?(1e6*ei.model_info.output_cost_per_token).toFixed(4):null})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"API Base"}),eg?(0,c.jsx)(I.Z.Item,{name:"api_base",className:"mb-0",children:(0,c.jsx)(y.Z,{placeholder:"Enter API base"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(Z=ei.litellm_params)||void 0===Z?void 0:Z.api_base)||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Custom LLM Provider"}),eg?(0,c.jsx)(I.Z.Item,{name:"custom_llm_provider",className:"mb-0",children:(0,c.jsx)(y.Z,{placeholder:"Enter custom LLM provider"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(S=ei.litellm_params)||void 0===S?void 0:S.custom_llm_provider)||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Organization"}),eg?(0,c.jsx)(I.Z.Item,{name:"organization",className:"mb-0",children:(0,c.jsx)(y.Z,{placeholder:"Enter organization"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(E=ei.litellm_params)||void 0===E?void 0:E.organization)||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"TPM (Tokens per Minute)"}),eg?(0,c.jsx)(I.Z.Item,{name:"tpm",className:"mb-0",children:(0,c.jsx)(M,{placeholder:"Enter TPM"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(O=ei.litellm_params)||void 0===O?void 0:O.tpm)||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"RPM (Requests per Minute)"}),eg?(0,c.jsx)(I.Z.Item,{name:"rpm",className:"mb-0",children:(0,c.jsx)(M,{placeholder:"Enter RPM"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(D=ei.litellm_params)||void 0===D?void 0:D.rpm)||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Max Retries"}),eg?(0,c.jsx)(I.Z.Item,{name:"max_retries",className:"mb-0",children:(0,c.jsx)(M,{placeholder:"Enter max retries"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(F=ei.litellm_params)||void 0===F?void 0:F.max_retries)||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Timeout (seconds)"}),eg?(0,c.jsx)(I.Z.Item,{name:"timeout",className:"mb-0",children:(0,c.jsx)(M,{placeholder:"Enter timeout"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(R=ei.litellm_params)||void 0===R?void 0:R.timeout)||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Stream Timeout (seconds)"}),eg?(0,c.jsx)(I.Z.Item,{name:"stream_timeout",className:"mb-0",children:(0,c.jsx)(M,{placeholder:"Enter stream timeout"})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(q=ei.litellm_params)||void 0===q?void 0:q.stream_timeout)||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Model Access Groups"}),eg?(0,c.jsx)(I.Z.Item,{name:"model_access_group",className:"mb-0",children:(0,c.jsx)(C.default,{mode:"tags",showSearch:!0,placeholder:"Select existing groups or type to create new ones",optionFilterProp:"children",tokenSeparators:[","],maxTagCount:"responsive",allowClear:!0,style:{width:"100%"},options:null==ea?void 0:ea.map(e=>({value:e,label:e}))})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(V=ei.model_info)||void 0===V?void 0:V.access_groups)?Array.isArray(ei.model_info.access_groups)?ei.model_info.access_groups.length>0?(0,c.jsx)("div",{className:"flex flex-wrap gap-1",children:ei.model_info.access_groups.map((e,s)=>(0,c.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e},s))}):"No groups assigned":ei.model_info.access_groups:"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)(w.Z,{className:"font-medium",children:["Guardrails"," ",(0,c.jsx)(z.Z,{title:"Apply safety guardrails to this model to filter content or enforce policies",children:(0,c.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})})]}),eg?(0,c.jsx)(I.Z.Item,{name:"guardrails",className:"mb-0",children:(0,c.jsx)(C.default,{mode:"tags",showSearch:!0,placeholder:"Select existing guardrails or type to create new ones",optionFilterProp:"children",tokenSeparators:[","],maxTagCount:"responsive",allowClear:!0,style:{width:"100%"},options:ek.map(e=>({value:e,label:e}))})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(K=ei.litellm_params)||void 0===K?void 0:K.guardrails)?Array.isArray(ei.litellm_params.guardrails)?ei.litellm_params.guardrails.length>0?(0,c.jsx)("div",{className:"flex flex-wrap gap-1",children:ei.litellm_params.guardrails.map((e,s)=>(0,c.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:e},s))}):"No guardrails assigned":ei.litellm_params.guardrails:"Not Set"})]}),eg?(0,c.jsx)(tm,{form:er,showCacheControl:e_,onCacheControlChange:e=>ey(e)}):(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Cache Control"}),(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(B=ei.litellm_params)||void 0===B?void 0:B.cache_control_injection_points)?(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{children:"Enabled"}),(0,c.jsx)("div",{className:"mt-2",children:ei.litellm_params.cache_control_injection_points.map((e,s)=>(0,c.jsxs)("div",{className:"text-sm text-gray-600 mb-1",children:["Location: ",e.location,",",e.role&&(0,c.jsxs)("span",{children:[" Role: ",e.role]}),void 0!==e.index&&(0,c.jsxs)("span",{children:[" Index: ",e.index]})]},s))})]}):"Disabled"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Model Info"}),eg?(0,c.jsx)(I.Z.Item,{name:"model_info",className:"mb-0",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:'{"gpt-4": 100, "claude-v1": 200}',defaultValue:JSON.stringify(J.model_info,null,2)})}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(0,c.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:JSON.stringify(ei.model_info,null,2)})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Team ID"}),(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:J.model_info.team_id||"Not Set"})]})]}),eg&&(0,c.jsxs)("div",{className:"mt-6 flex justify-end gap-2",children:[(0,c.jsx)(_.Z,{variant:"secondary",onClick:()=>{er.resetFields(),ex(!1),ej(!1)},children:"Cancel"}),(0,c.jsx)(_.Z,{variant:"primary",onClick:()=>er.submit(),loading:eh,children:"Save Changes"})]})]})}):(0,c.jsx)(w.Z,{children:"Loading..."})]})]}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(W.Z,{children:(0,c.jsx)("pre",{className:"bg-gray-100 p-4 rounded text-xs overflow-auto",children:JSON.stringify(J,null,2)})})})]})]}),eo&&(0,c.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,c.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,c.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,c.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,c.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,c.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,c.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,c.jsx)("div",{className:"sm:flex sm:items-start",children:(0,c.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,c.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Model"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this model?"})})]})})}),(0,c.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,c.jsx)(T.ZP,{onClick:eT,className:"ml-2",danger:!0,children:"Delete"}),(0,c.jsx)(T.ZP,{onClick:()=>ec(!1),children:"Cancel"})]})]})]})}),ed&&!eP?(0,c.jsx)(ti,{isVisible:ed,onCancel:()=>em(!1),onAddCredential:eA,existingCredential:ef,setIsCredentialModalOpen:em}):(0,c.jsx)(A.Z,{open:ed,onCancel:()=>em(!1),title:"Using Existing Credential",children:(0,c.jsx)(w.Z,{children:J.litellm_params.litellm_credential_name})}),(0,c.jsx)(tv,{isVisible:eZ,onCancel:()=>ew(!1),onSuccess:e=>{en(e),el&&el(e)},modelData:ei||J,accessToken:Y||"",userRole:Q||""})]})}var ty=e=>{let{selectedProvider:s,providerModels:t,getPlaceholder:l}=e,a=I.Z.useFormInstance(),r=e=>{let s=e.target.value,t=(a.getFieldValue("model_mappings")||[]).map(e=>"custom"===e.public_name||"custom"===e.litellm_model?{public_name:s,litellm_model:s}:e);a.setFieldsValue({model_mappings:t})};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(I.Z.Item,{label:"LiteLLM Model Name(s)",tooltip:"Actual model name used for making litellm.completion() / litellm.embedding() call.",className:"mb-0",children:[(0,c.jsx)(I.Z.Item,{name:"model",rules:[{required:!0,message:"Please select at least one model."}],noStyle:!0,children:s===sL.Cl.Azure||s===sL.Cl.OpenAI_Compatible||s===sL.Cl.Ollama?(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(y.Z,{placeholder:l(s)})}):t.length>0?(0,c.jsx)(C.default,{mode:"multiple",allowClear:!0,showSearch:!0,placeholder:"Select models",onChange:e=>{let s=Array.isArray(e)?e:[e];if(s.includes("all-wildcard"))a.setFieldsValue({model_name:void 0,model_mappings:[]});else if(JSON.stringify(a.getFieldValue("model"))!==JSON.stringify(s)){let e=s.map(e=>({public_name:e,litellm_model:e}));a.setFieldsValue({model:s,model_mappings:e})}},optionFilterProp:"children",filterOption:(e,s)=>{var t;return(null!==(t=null==s?void 0:s.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},options:[{label:"Custom Model Name (Enter below)",value:"custom"},{label:"All ".concat(s," Models (Wildcard)"),value:"all-wildcard"},...t.map(e=>({label:e,value:e}))],style:{width:"100%"}}):(0,c.jsx)(y.Z,{placeholder:l(s)})}),(0,c.jsx)(I.Z.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.model!==s.model,children:e=>{let{getFieldValue:s}=e,t=s("model")||[];return(Array.isArray(t)?t:[t]).includes("custom")&&(0,c.jsx)(I.Z.Item,{name:"custom_model_name",rules:[{required:!0,message:"Please enter a custom model name."}],className:"mt-2",children:(0,c.jsx)(y.Z,{placeholder:"Enter custom model name",onChange:r})})}})]}),(0,c.jsxs)(sF.Z,{children:[(0,c.jsx)(sR.Z,{span:10}),(0,c.jsx)(sR.Z,{span:10,children:(0,c.jsx)(w.Z,{className:"mb-3 mt-1",children:"Actual model name used for making litellm.completion() call. We loadbalance models with the same public name"})})]})]})},tb=()=>{let e=I.Z.useFormInstance(),[s,t]=(0,d.useState)(0),l=I.Z.useWatch("model",e)||[],a=Array.isArray(l)?l:[l],r=I.Z.useWatch("custom_model_name",e),i=!a.includes("all-wildcard");if((0,d.useEffect)(()=>{if(r&&a.includes("custom")){let s=(e.getFieldValue("model_mappings")||[]).map(e=>"custom"===e.public_name||"custom"===e.litellm_model?{public_name:r,litellm_model:r}:e);e.setFieldValue("model_mappings",s),t(e=>e+1)}},[r,a,e]),(0,d.useEffect)(()=>{if(a.length>0&&!a.includes("all-wildcard")){let s=e.getFieldValue("model_mappings")||[];if(s.length!==a.length||!a.every(e=>s.some(s=>"custom"===e?"custom"===s.litellm_model||s.litellm_model===r:s.litellm_model===e))){let s=a.map(e=>"custom"===e&&r?{public_name:r,litellm_model:r}:{public_name:e,litellm_model:e});e.setFieldValue("model_mappings",s),t(e=>e+1)}}},[a,r,e]),!i)return null;let n=[{title:"Public Name",dataIndex:"public_name",key:"public_name",render:(s,t,l)=>(0,c.jsx)(y.Z,{value:s,onChange:s=>{let t=[...e.getFieldValue("model_mappings")];t[l].public_name=s.target.value,e.setFieldValue("model_mappings",t)}})},{title:"LiteLLM Model",dataIndex:"litellm_model",key:"litellm_model"}];return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(I.Z.Item,{label:"Model Mappings",name:"model_mappings",tooltip:"Map public model names to LiteLLM model names for load balancing",labelCol:{span:10},wrapperCol:{span:16},labelAlign:"left",rules:[{required:!0,validator:async(e,s)=>{if(!s||0===s.length)throw Error("At least one model mapping is required");if(s.filter(e=>!e.public_name||""===e.public_name.trim()).length>0)throw Error("All model mappings must have valid public names")}}],children:(0,c.jsx)(eh.Z,{dataSource:e.getFieldValue("model_mappings"),columns:n,pagination:!1,size:"small"},s)})})},tN=t(90464);let{Link:tZ}=em.default;var tw=e=>{let{showAdvancedSettings:s,setShowAdvancedSettings:t,teams:l,guardrailsList:a}=e,[r]=I.Z.useForm(),[i,n]=d.useState(!1),[o,m]=d.useState("per_token"),[u,x]=d.useState(!1),h=(e,s)=>s&&(isNaN(Number(s))||0>Number(s))?Promise.reject("Please enter a valid positive number"):Promise.resolve(),p=(e,s)=>{if(!s)return Promise.resolve();try{return JSON.parse(s),Promise.resolve()}catch(e){return Promise.reject("Please enter valid JSON")}};return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(b.Z,{className:"mt-2 mb-4",children:[(0,c.jsx)(Z.Z,{children:(0,c.jsx)("b",{children:"Advanced Settings"})}),(0,c.jsx)(N.Z,{children:(0,c.jsxs)("div",{className:"bg-white rounded-lg",children:[(0,c.jsx)(I.Z.Item,{label:"Custom Pricing",name:"custom_pricing",valuePropName:"checked",className:"mb-4",children:(0,c.jsx)(tn.Z,{onChange:e=>{n(e),e||r.setFieldsValue({input_cost_per_token:void 0,output_cost_per_token:void 0,input_cost_per_second:void 0})},className:"bg-gray-600"})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Guardrails"," ",(0,c.jsx)(z.Z,{title:"Apply safety guardrails to this key to filter content or enforce policies",children:(0,c.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",className:"mt-4",help:"Select existing guardrails. Go to 'Guardrails' tab to create new guardrails.",children:(0,c.jsx)(C.default,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails",options:a.map(e=>({value:e,label:e}))})}),i&&(0,c.jsxs)("div",{className:"ml-6 pl-4 border-l-2 border-gray-200",children:[(0,c.jsx)(I.Z.Item,{label:"Pricing Model",name:"pricing_model",className:"mb-4",children:(0,c.jsx)(C.default,{defaultValue:"per_token",onChange:e=>m(e),options:[{value:"per_token",label:"Per Million Tokens"},{value:"per_second",label:"Per Second"}]})}),"per_token"===o?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{label:"Input Cost (per 1M tokens)",name:"input_cost_per_token",rules:[{validator:h}],className:"mb-4",children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"Output Cost (per 1M tokens)",name:"output_cost_per_token",rules:[{validator:h}],className:"mb-4",children:(0,c.jsx)(y.Z,{})})]}):(0,c.jsx)(I.Z.Item,{label:"Cost Per Second",name:"input_cost_per_second",rules:[{validator:h}],className:"mb-4",children:(0,c.jsx)(y.Z,{})})]}),(0,c.jsx)(I.Z.Item,{label:"Use in pass through routes",name:"use_in_pass_through",valuePropName:"checked",className:"mb-4 mt-4",tooltip:(0,c.jsxs)("span",{children:["Allow using these credentials in pass through routes."," ",(0,c.jsx)(tZ,{href:"https://docs.litellm.ai/docs/pass_through/vertex_ai",target:"_blank",children:"Learn more"})]}),children:(0,c.jsx)(tn.Z,{onChange:e=>{let s=r.getFieldValue("litellm_extra_params");try{let t=s?JSON.parse(s):{};e?t.use_in_pass_through=!0:delete t.use_in_pass_through,Object.keys(t).length>0?r.setFieldValue("litellm_extra_params",JSON.stringify(t,null,2)):r.setFieldValue("litellm_extra_params","")}catch(s){e?r.setFieldValue("litellm_extra_params",JSON.stringify({use_in_pass_through:!0},null,2)):r.setFieldValue("litellm_extra_params","")}},className:"bg-gray-600"})}),(0,c.jsx)(tm,{form:r,showCacheControl:u,onCacheControlChange:e=>{if(x(e),!e){let e=r.getFieldValue("litellm_extra_params");try{let s=e?JSON.parse(e):{};delete s.cache_control_injection_points,Object.keys(s).length>0?r.setFieldValue("litellm_extra_params",JSON.stringify(s,null,2)):r.setFieldValue("litellm_extra_params","")}catch(e){r.setFieldValue("litellm_extra_params","")}}}}),(0,c.jsx)(I.Z.Item,{label:"LiteLLM Params",name:"litellm_extra_params",tooltip:"Optional litellm params used for making a litellm.completion() call.",className:"mb-4 mt-4",rules:[{validator:p}],children:(0,c.jsx)(tN.Z,{rows:4,placeholder:'{ "rpm": 100, "timeout": 0, "stream_timeout": 0 }'})}),(0,c.jsxs)(sF.Z,{className:"mb-4",children:[(0,c.jsx)(sR.Z,{span:10}),(0,c.jsx)(sR.Z,{span:10,children:(0,c.jsxs)(w.Z,{className:"text-gray-600 text-sm",children:["Pass JSON of litellm supported params"," ",(0,c.jsx)(tZ,{href:"https://docs.litellm.ai/docs/completion/input",target:"_blank",children:"litellm.completion() call"})]})})]}),(0,c.jsx)(I.Z.Item,{label:"Model Info",name:"model_info_params",tooltip:"Optional model info params. Returned when calling `/model/info` endpoint.",className:"mb-0",rules:[{validator:p}],children:(0,c.jsx)(tN.Z,{rows:4,placeholder:'{ "mode": "chat" }'})})]})})]})})},tk=t(29),tS=t.n(tk),tC=t(23639);let{Text:tI}=em.default;var tP=e=>{let{formValues:s,accessToken:t,testMode:l,modelName:a="this model",onClose:r,onTestComplete:i}=e,[n,o]=d.useState(null),[m,u]=d.useState(null),[x,h]=d.useState(null),[p,j]=d.useState(!0),[f,v]=d.useState(!1),[_,y]=d.useState(!1),b=async()=>{j(!0),y(!1),o(null),u(null),h(null),v(!1),await new Promise(e=>setTimeout(e,100));try{console.log("Testing connection with form values:",s);let a=await sO(s,t,null);if(!a){console.log("No result from prepareModelAddRequest"),o("Failed to prepare model data. Please check your form inputs."),v(!1),j(!1);return}console.log("Result from prepareModelAddRequest:",a);let{litellmParamsObj:r,modelInfoObj:i,modelName:n}=a[0],c=await (0,g.testConnectionRequest)(t,r,null==i?void 0:i.mode);if("success"===c.status)P.ZP.success("Connection test successful!"),o(null),v(!0);else{var e,l;let s=(null===(e=c.result)||void 0===e?void 0:e.error)||c.message||"Unknown error";o(s),u(r),h(null===(l=c.result)||void 0===l?void 0:l.raw_request_typed_dict),v(!1)}}catch(e){console.error("Test connection error:",e),o(e instanceof Error?e.message:String(e)),v(!1)}finally{j(!1),i&&i()}};d.useEffect(()=>{let e=setTimeout(()=>{b()},200);return()=>clearTimeout(e)},[]);let N=e=>e?e.split("stack trace:")[0].trim().replace(/^litellm\.(.*?)Error: /,""):"Unknown error",Z="string"==typeof n?N(n):(null==n?void 0:n.message)?N(n.message):"Unknown error",w=x?((e,s,t)=>{let l=JSON.stringify(s,null,2).split("\n").map(e=>"  ".concat(e)).join("\n"),a=Object.entries(t).map(e=>{let[s,t]=e;return"-H '".concat(s,": ").concat(t,"'")}).join(" \\\n  ");return"curl -X POST \\\n  ".concat(e," \\\n  ").concat(a?"".concat(a," \\\n  "):"","-H 'Content-Type: application/json' \\\n  -d '{\n").concat(l,"\n  }'")})(x.raw_request_api_base,x.raw_request_body,x.raw_request_headers||{}):"";return(0,c.jsxs)("div",{style:{padding:"24px",borderRadius:"8px",backgroundColor:"#fff"},children:[p?(0,c.jsxs)("div",{style:{textAlign:"center",padding:"32px 20px"},className:"jsx-776cdcbc0448e4ea",children:[(0,c.jsx)("div",{style:{marginBottom:"16px"},className:"jsx-776cdcbc0448e4ea loading-spinner",children:(0,c.jsx)("div",{style:{border:"3px solid #f3f3f3",borderTop:"3px solid #1890ff",borderRadius:"50%",width:"30px",height:"30px",animation:"spin 1s linear infinite",margin:"0 auto"},className:"jsx-776cdcbc0448e4ea"})}),(0,c.jsxs)(tI,{style:{fontSize:"16px"},children:["Testing connection to ",a,"..."]}),(0,c.jsx)(tS(),{id:"776cdcbc0448e4ea",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]}):f?(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"32px 20px"},children:[(0,c.jsx)("div",{style:{color:"#52c41a",fontSize:"24px",display:"flex",alignItems:"center"},children:(0,c.jsx)("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"check-circle",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",children:(0,c.jsx)("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"})})}),(0,c.jsxs)(tI,{type:"success",style:{fontSize:"18px",fontWeight:500,marginLeft:"10px"},children:["Connection to ",a," successful!"]})]}):(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px"},children:[(0,c.jsx)(ev.Z,{style:{color:"#ff4d4f",fontSize:"24px",marginRight:"12px"}}),(0,c.jsxs)(tI,{type:"danger",style:{fontSize:"18px",fontWeight:500},children:["Connection to ",a," failed"]})]}),(0,c.jsxs)("div",{style:{backgroundColor:"#fff2f0",border:"1px solid #ffccc7",borderRadius:"8px",padding:"16px",marginBottom:"20px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.03)"},children:[(0,c.jsx)(tI,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Error: "}),(0,c.jsx)(tI,{type:"danger",style:{fontSize:"14px",lineHeight:"1.5"},children:Z}),n&&(0,c.jsx)("div",{style:{marginTop:"12px"},children:(0,c.jsx)(T.ZP,{type:"link",onClick:()=>y(!_),style:{paddingLeft:0,height:"auto"},children:_?"Hide Details":"Show Details"})})]}),_&&(0,c.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,c.jsx)(tI,{strong:!0,style:{display:"block",marginBottom:"8px",fontSize:"15px"},children:"Troubleshooting Details"}),(0,c.jsx)("pre",{style:{backgroundColor:"#f5f5f5",padding:"16px",borderRadius:"8px",fontSize:"13px",maxHeight:"200px",overflow:"auto",border:"1px solid #e8e8e8",lineHeight:"1.5"},children:"string"==typeof n?n:JSON.stringify(n,null,2)})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(tI,{strong:!0,style:{display:"block",marginBottom:"8px",fontSize:"15px"},children:"API Request"}),(0,c.jsx)("pre",{style:{backgroundColor:"#f5f5f5",padding:"16px",borderRadius:"8px",fontSize:"13px",maxHeight:"250px",overflow:"auto",border:"1px solid #e8e8e8",lineHeight:"1.5"},children:w||"No request data available"}),(0,c.jsx)(T.ZP,{style:{marginTop:"8px"},icon:(0,c.jsx)(tC.Z,{}),onClick:()=>{navigator.clipboard.writeText(w||""),P.ZP.success("Copied to clipboard")},children:"Copy to Clipboard"})]})]})}),(0,c.jsx)(Y.Z,{style:{margin:"24px 0 16px"}}),(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,c.jsx)(T.ZP,{type:"link",href:"https://docs.litellm.ai/docs/providers",target:"_blank",icon:(0,c.jsx)(U.Z,{}),children:"View Documentation"})})]})};let tA=[{value:"chat",label:"Chat - /chat/completions"},{value:"completion",label:"Completion - /completions"},{value:"embedding",label:"Embedding - /embeddings"},{value:"audio_speech",label:"Audio Speech - /audio/speech"},{value:"audio_transcription",label:"Audio Transcription - /audio/transcriptions"},{value:"image_generation",label:"Image Generation - /images/generations"},{value:"rerank",label:"Rerank - /rerank"},{value:"realtime",label:"Realtime - /realtime"},{value:"batch",label:"Batch - /batch"}];var tE=t(92858);let tT=async(e,s,t,l)=>{try{console.log("=== AUTO ROUTER SUBMIT HANDLER CALLED ==="),console.log("handling auto router submit for formValues:",e),console.log("Access token:",s?"Present":"Missing"),console.log("Form:",t?"Present":"Missing"),console.log("Callback:",l?"Present":"Missing");let a={model_name:e.auto_router_name,litellm_params:{model:"auto_router/".concat(e.auto_router_name),auto_router_config:JSON.stringify(e.auto_router_config),auto_router_default_model:e.auto_router_default_model},model_info:{}};e.auto_router_embedding_model&&"custom"!==e.auto_router_embedding_model?a.litellm_params.auto_router_embedding_model=e.auto_router_embedding_model:e.custom_embedding_model&&(a.litellm_params.auto_router_embedding_model=e.custom_embedding_model),e.team_id&&(a.model_info.team_id=e.team_id),e.model_access_group&&e.model_access_group.length>0&&(a.model_info.access_groups=e.model_access_group),console.log("Auto router configuration to be created:",a),console.log("Auto router config (stringified):",a.litellm_params.auto_router_config),console.log("Calling modelCreateCall with:",{accessToken:s?"Present":"Missing",config:a});let r=await (0,g.modelCreateCall)(s,a);console.log("response for auto router create call:",r),t.resetFields()}catch(e){console.error("Failed to add auto router:",e),P.ZP.error("Failed to add auto router: "+e,10)}},{Title:tL,Link:tO}=em.default;var tM=e=>{let{form:s,handleOk:t,accessToken:l,userRole:a}=e,[r,i]=(0,d.useState)(!1),[n,o]=(0,d.useState)(!1),[m,u]=(0,d.useState)(""),[x,h]=(0,d.useState)([]),[p,j]=(0,d.useState)([]),[f,v]=(0,d.useState)(!1),[_,b]=(0,d.useState)(!1),[N,Z]=(0,d.useState)(null);(0,d.useEffect)(()=>{(async()=>{h((await (0,g.modelAvailableCall)(l,"","",!1,null,!0,!0)).data.map(e=>e.id))})()},[l]),(0,d.useEffect)(()=>{(async()=>{try{let e=await tu(l);console.log("Fetched models for auto router:",e),j(e)}catch(e){console.error("Error fetching model info for auto router:",e)}})()},[l]);let k=eE.ZL.includes(a),S=async()=>{o(!0),u("test-".concat(Date.now())),i(!0)},E=()=>{console.log("Auto router submit triggered!"),console.log("Router config:",N);let e=s.getFieldsValue();if(console.log("Form values:",e),!e.auto_router_name){P.ZP.error("Please enter an Auto Router Name");return}if(!e.auto_router_default_model){P.ZP.error("Please select a Default Model");return}if(s.setFieldsValue({custom_llm_provider:"auto_router",model:e.auto_router_name,api_key:"not_required_for_auto_router"}),!N||!N.routes||0===N.routes.length){P.ZP.error("Please configure at least one route for the auto router");return}if(N.routes.filter(e=>!e.name||!e.description||0===e.utterances.length).length>0){P.ZP.error("Please ensure all routes have a target model, description, and at least one utterance");return}s.validateFields().then(e=>{console.log("Form validation passed, submitting with values:",e);let a={...e,auto_router_config:N};console.log("Final submit values:",a),tT(a,l,s,t)}).catch(e=>{console.error("Validation failed:",e);let s=e.errorFields||[];if(s.length>0){let e=s.map(e=>{let s=e.name[0];return({auto_router_name:"Auto Router Name",auto_router_default_model:"Default Model",auto_router_embedding_model:"Embedding Model"})[s]||s});P.ZP.error("Please fill in the following required fields: ".concat(e.join(", ")))}else P.ZP.error("Please fill in all required fields")})};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(tL,{level:2,children:"Add Auto Router"}),(0,c.jsx)(w.Z,{className:"text-gray-600 mb-6",children:"Create an auto router with intelligent routing logic that automatically selects the best model based on user input patterns and semantic matching."}),(0,c.jsx)(th.Z,{children:(0,c.jsxs)(I.Z,{form:s,onFinish:E,labelCol:{span:10},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsx)(I.Z.Item,{rules:[{required:!0,message:"Auto router name is required"}],label:"Auto Router Name",name:"auto_router_name",tooltip:"Unique name for this auto router configuration",labelCol:{span:10},labelAlign:"left",children:(0,c.jsx)(y.Z,{placeholder:"e.g., auto_router_1, smart_routing"})}),(0,c.jsx)("div",{className:"w-full mb-4",children:(0,c.jsx)(tf,{modelInfo:p,value:N,onChange:e=>{Z(e),s.setFieldValue("auto_router_config",e)}})}),(0,c.jsx)(I.Z.Item,{rules:[{required:!0,message:"Default model is required"}],label:"Default Model",name:"auto_router_default_model",tooltip:"Fallback model to use when auto routing logic cannot determine the best model",labelCol:{span:10},labelAlign:"left",children:(0,c.jsx)(C.default,{placeholder:"Select a default model",onChange:e=>{v("custom"===e)},options:[...Array.from(new Set(p.map(e=>e.model_group))).map(e=>({value:e,label:e})),{value:"custom",label:"Enter custom model name"}],style:{width:"100%"},showSearch:!0})}),(0,c.jsx)(I.Z.Item,{label:"Embedding Model",name:"auto_router_embedding_model",tooltip:"Optional: Embedding model to use for semantic routing decisions",labelCol:{span:10},labelAlign:"left",children:(0,c.jsx)(C.default,{value:s.getFieldValue("auto_router_embedding_model"),placeholder:"Select an embedding model (optional)",onChange:e=>{b("custom"===e),s.setFieldValue("auto_router_embedding_model",e)},options:[...Array.from(new Set(p.map(e=>e.model_group))).map(e=>({value:e,label:e})),{value:"custom",label:"Enter custom model name"}],style:{width:"100%"},showSearch:!0,allowClear:!0})}),(0,c.jsxs)("div",{className:"flex items-center my-4",children:[(0,c.jsx)("div",{className:"flex-grow border-t border-gray-200"}),(0,c.jsx)("span",{className:"px-4 text-gray-500 text-sm",children:"Additional Settings"}),(0,c.jsx)("div",{className:"flex-grow border-t border-gray-200"})]}),k&&(0,c.jsx)(I.Z.Item,{label:"Model Access Group",name:"model_access_group",className:"mb-4",tooltip:"Use model access groups to control who can access this auto router",children:(0,c.jsx)(C.default,{mode:"tags",showSearch:!0,placeholder:"Select existing groups or type to create new ones",optionFilterProp:"children",tokenSeparators:[","],options:x.map(e=>({value:e,label:e})),maxTagCount:"responsive",allowClear:!0})}),(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(z.Z,{title:"Get help on our github",children:(0,c.jsx)(em.default.Link,{href:"https://github.com/BerriAI/litellm/issues",children:"Need Help?"})}),(0,c.jsxs)("div",{className:"space-x-2",children:[(0,c.jsx)(T.ZP,{onClick:S,loading:n,children:"Test Connect"}),(0,c.jsx)(T.ZP,{onClick:()=>{console.log("Add Auto Router button clicked!"),console.log("Current router config:",N),console.log("Current form values:",s.getFieldsValue()),E()},children:"Add Auto Router"})]})]})]})}),(0,c.jsx)(A.Z,{title:"Connection Test Results",open:r,onCancel:()=>{i(!1),o(!1)},footer:[(0,c.jsx)(T.ZP,{onClick:()=>{i(!1),o(!1)},children:"Close"},"close")],width:700,children:r&&(0,c.jsx)(tP,{formValues:s.getFieldsValue(),accessToken:l,testMode:"chat",modelName:s.getFieldValue("auto_router_name"),onClose:()=>{i(!1),o(!1)},onTestComplete:()=>o(!1)},m)})]})};let{Title:tD,Link:tF}=em.default;var tR=e=>{let{form:s,handleOk:t,selectedProvider:l,setSelectedProvider:a,providerModels:r,setProviderModelsFn:i,getPlaceholder:n,uploadProps:o,showAdvancedSettings:m,setShowAdvancedSettings:u,teams:x,credentials:h,accessToken:p,userRole:j,premiumUser:f}=e,[v]=I.Z.useForm(),[_,y]=(0,d.useState)("chat"),[b,N]=(0,d.useState)(!1),[Z,k]=(0,d.useState)(!1),[S,P]=(0,d.useState)([]),[E,L]=(0,d.useState)("");(0,d.useEffect)(()=>{(async()=>{try{let e=(await (0,g.getGuardrailsList)(p)).guardrails.map(e=>e.guardrail_name);P(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})()},[p]);let O=async()=>{k(!0),L("test-".concat(Date.now())),N(!0)},[M,D]=(0,d.useState)(!1),[F,R]=(0,d.useState)([]);(0,d.useEffect)(()=>{(async()=>{R((await (0,g.modelAvailableCall)(p,"","",!1,null,!0,!0)).data.map(e=>e.id))})()},[p]);let q=eE.ZL.includes(j);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(eW.Z,{className:"w-full",children:[(0,c.jsxs)(e$.Z,{className:"mb-4",children:[(0,c.jsx)(eY.Z,{children:"Add Model"}),(0,c.jsx)(eY.Z,{children:"Add Auto Router"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsx)(tD,{level:2,children:"Add Model"}),(0,c.jsx)(th.Z,{children:(0,c.jsx)(I.Z,{form:s,onFinish:e=>{console.log("\uD83D\uDD25 Form onFinish triggered with values:",e),t()},onFinishFailed:e=>{console.log("\uD83D\uDCA5 Form onFinishFailed triggered:",e)},labelCol:{span:10},wrapperCol:{span:16},labelAlign:"left",children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{rules:[{required:!0,message:"Required"}],label:"Provider:",name:"custom_llm_provider",tooltip:"E.g. OpenAI, Azure OpenAI, Anthropic, Bedrock, etc.",labelCol:{span:10},labelAlign:"left",children:(0,c.jsx)(C.default,{showSearch:!0,value:l,onChange:e=>{a(e),i(e),s.setFieldsValue({model:[],model_name:void 0})},children:Object.entries(sL.Cl).map(e=>{let[s,t]=e;return(0,c.jsx)(C.default.Option,{value:s,children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("img",{src:sL.cd[t],alt:"".concat(s," logo"),className:"w-5 h-5",onError:e=>{let s=e.target,l=s.parentElement;if(l){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=t.charAt(0),l.replaceChild(e,s)}}}),(0,c.jsx)("span",{children:t})]})},s)})})}),(0,c.jsx)(ty,{selectedProvider:l,providerModels:r,getPlaceholder:n}),(0,c.jsx)(tb,{}),(0,c.jsx)(I.Z.Item,{label:"Mode",name:"mode",className:"mb-1",children:(0,c.jsx)(C.default,{style:{width:"100%"},value:_,onChange:e=>y(e),options:tA})}),(0,c.jsxs)(sF.Z,{children:[(0,c.jsx)(sR.Z,{span:10}),(0,c.jsx)(sR.Z,{span:10,children:(0,c.jsxs)(w.Z,{className:"mb-5 mt-1",children:[(0,c.jsx)("strong",{children:"Optional"})," - LiteLLM endpoint to use when health checking this model ",(0,c.jsx)(tF,{href:"https://docs.litellm.ai/docs/proxy/health#health",target:"_blank",children:"Learn more"})]})})]}),(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsx)(em.default.Text,{className:"text-sm text-gray-500 mb-2",children:"Either select existing credentials OR enter new provider credentials below"})}),(0,c.jsx)(I.Z.Item,{label:"Existing Credentials",name:"litellm_credential_name",children:(0,c.jsx)(C.default,{showSearch:!0,placeholder:"Select or search for existing credentials",optionFilterProp:"children",filterOption:(e,s)=>{var t;return(null!==(t=null==s?void 0:s.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},options:[{value:null,label:"None"},...h.map(e=>({value:e.credential_name,label:e.credential_name}))],allowClear:!0})}),(0,c.jsxs)("div",{className:"flex items-center my-4",children:[(0,c.jsx)("div",{className:"flex-grow border-t border-gray-200"}),(0,c.jsx)("span",{className:"px-4 text-gray-500 text-sm",children:"OR"}),(0,c.jsx)("div",{className:"flex-grow border-t border-gray-200"})]}),(0,c.jsx)(I.Z.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.litellm_credential_name!==s.litellm_credential_name||e.provider!==s.provider,children:e=>{let{getFieldValue:s}=e,t=s("litellm_credential_name");return(console.log("\uD83D\uDD11 Credential Name Changed:",t),t)?(0,c.jsx)("div",{className:"text-gray-500 text-sm text-center",children:"Using existing credentials - no additional provider fields needed"}):(0,c.jsx)(sz,{selectedProvider:l,uploadProps:o})}}),(0,c.jsxs)("div",{className:"flex items-center my-4",children:[(0,c.jsx)("div",{className:"flex-grow border-t border-gray-200"}),(0,c.jsx)("span",{className:"px-4 text-gray-500 text-sm",children:"Additional Model Info Settings"}),(0,c.jsx)("div",{className:"flex-grow border-t border-gray-200"})]}),(0,c.jsx)(I.Z.Item,{label:"Team-BYOK Model",tooltip:"Only use this model + credential combination for this team. Useful when teams want to onboard their own OpenAI keys.",className:"mb-4",children:(0,c.jsx)(z.Z,{title:f?"":"This is an enterprise-only feature. Upgrade to premium to restrict model+credential combinations to a specific team.",placement:"top",children:(0,c.jsx)(tE.Z,{checked:M,onChange:e=>{D(e),e||s.setFieldValue("team_id",void 0)},disabled:!f})})}),M&&(0,c.jsx)(I.Z.Item,{label:"Select Team",name:"team_id",className:"mb-4",tooltip:"Only keys for this team will be able to call this model.",rules:[{required:M&&!q,message:"Please select a team."}],children:(0,c.jsx)(J,{teams:x,disabled:!f})}),q&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(I.Z.Item,{label:"Model Access Group",name:"model_access_group",className:"mb-4",tooltip:"Use model access groups to give users access to select models, and add new ones to the group over time.",children:(0,c.jsx)(C.default,{mode:"tags",showSearch:!0,placeholder:"Select existing groups or type to create new ones",optionFilterProp:"children",tokenSeparators:[","],options:F.map(e=>({value:e,label:e})),maxTagCount:"responsive",allowClear:!0})})}),(0,c.jsx)(tw,{showAdvancedSettings:m,setShowAdvancedSettings:u,teams:x,guardrailsList:S}),(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(z.Z,{title:"Get help on our github",children:(0,c.jsx)(em.default.Link,{href:"https://github.com/BerriAI/litellm/issues",children:"Need Help?"})}),(0,c.jsxs)("div",{className:"space-x-2",children:[(0,c.jsx)(T.ZP,{onClick:O,loading:Z,children:"Test Connect"}),(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Add Model"})]})]})]})})})]}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(tM,{form:v,handleOk:()=>{v.validateFields().then(e=>{tT(e,p,v,t)}).catch(e=>{console.error("Validation failed:",e)})},accessToken:p,userRole:j})})]})]}),(0,c.jsx)(A.Z,{title:"Connection Test Results",open:b,onCancel:()=>{N(!1),k(!1)},footer:[(0,c.jsx)(T.ZP,{onClick:()=>{N(!1),k(!1)},children:"Close"},"close")],width:700,children:b&&(0,c.jsx)(tP,{formValues:s.getFieldsValue(),accessToken:p,testMode:_,modelName:s.getFieldValue("model_name")||s.getFieldValue("model"),onClose:()=>{N(!1),k(!1)},onTestComplete:()=>k(!1)},E)})]})},tq=t(8048);let tU=(e,s,t,l,a,r,i,n,o,d,m)=>[{header:"Model ID",accessorKey:"model_info.id",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)(z.Z,{title:t.model_info.id,children:(0,c.jsx)("div",{className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left w-full truncate whitespace-nowrap cursor-pointer max-w-[15ch]",onClick:()=>l(t.model_info.id),children:t.model_info.id})})}},{header:"Public Model Name",accessorKey:"model_name",cell:e=>{let{row:s}=e,t=r(s.original)||"-";return(0,c.jsx)(z.Z,{title:t,children:(0,c.jsx)("div",{className:"text-xs truncate whitespace-nowrap",children:t})})}},{header:"Provider",accessorKey:"provider",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[t.provider&&(0,c.jsx)("img",{src:(0,sL.dr)(t.provider).logo,alt:"".concat(t.provider," logo"),className:"w-4 h-4",onError:e=>{let s=e.target,l=s.parentElement;if(l){var a;let e=document.createElement("div");e.className="w-4 h-4 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=(null===(a=t.provider)||void 0===a?void 0:a.charAt(0))||"-",l.replaceChild(e,s)}}}),(0,c.jsx)("p",{className:"text-xs",children:t.provider||"-"})]})}},{header:"LiteLLM Model Name",accessorKey:"litellm_model_name",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)(z.Z,{title:t.litellm_model_name,children:(0,c.jsx)("div",{className:"text-xs truncate whitespace-nowrap",children:t.litellm_model_name||"-"})})}},{header:"Created At",accessorKey:"model_info.created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("span",{className:"text-xs",children:t.model_info.created_at?new Date(t.model_info.created_at).toLocaleDateString():"-"})}},{header:"Updated At",accessorKey:"model_info.updated_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("span",{className:"text-xs",children:t.model_info.updated_at?new Date(t.model_info.updated_at).toLocaleDateString():"-"})}},{header:"Created By",accessorKey:"model_info.created_by",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("span",{className:"text-xs",children:t.model_info.created_by||"-"})}},{header:()=>(0,c.jsx)(z.Z,{title:"Cost per 1M tokens",children:(0,c.jsx)("span",{children:"Input Cost"})}),accessorKey:"input_cost",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("pre",{className:"text-xs",children:t.input_cost||"-"})}},{header:()=>(0,c.jsx)(z.Z,{title:"Cost per 1M tokens",children:(0,c.jsx)("span",{children:"Output Cost"})}),accessorKey:"output_cost",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("pre",{className:"text-xs",children:t.output_cost||"-"})}},{header:"Team ID",accessorKey:"model_info.team_id",cell:e=>{let{row:s}=e,t=s.original;return t.model_info.team_id?(0,c.jsx)("div",{className:"overflow-hidden",children:(0,c.jsx)(z.Z,{title:t.model_info.team_id,children:(0,c.jsxs)(_.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>a(t.model_info.team_id),children:[t.model_info.team_id.slice(0,7),"..."]})})}):"-"}},{header:"Model Access Group",accessorKey:"model_info.model_access_group",enableSorting:!1,cell:e=>{let{row:s}=e,t=s.original,l=t.model_info.access_groups;if(!l||0===l.length)return"-";let a=t.model_info.id,r=d.has(a),i=l.length>1,n=()=>{let e=new Set(d);r?e.delete(a):e.add(a),m(e)};return(0,c.jsxs)("div",{className:"flex items-center gap-1 overflow-hidden",children:[(0,c.jsx)(eJ.Z,{size:"xs",color:"blue",className:"text-xs px-1.5 py-0.5 h-5 leading-tight flex-shrink-0",children:l[0]}),(r||!i&&2===l.length)&&l.slice(1).map((e,s)=>(0,c.jsx)(eJ.Z,{size:"xs",color:"blue",className:"text-xs px-1.5 py-0.5 h-5 leading-tight flex-shrink-0",children:e},s+1)),i&&(0,c.jsx)("button",{onClick:e=>{e.stopPropagation(),n()},className:"text-xs text-blue-600 hover:text-blue-800 px-1 py-0.5 rounded hover:bg-blue-50 h-5 leading-tight flex-shrink-0 whitespace-nowrap",children:r?"−":"+".concat(l.length-1)})]})}},{header:"Credentials",accessorKey:"litellm_credential_name",cell:e=>{let{row:s}=e,t=s.original;return t.litellm_params&&t.litellm_params.litellm_credential_name?(0,c.jsx)("div",{className:"overflow-hidden",children:(0,c.jsxs)(z.Z,{title:t.litellm_params.litellm_credential_name,children:[t.litellm_params.litellm_credential_name.slice(0,7),"..."]})}):(0,c.jsx)("span",{className:"text-gray-400",children:"-"})}},{header:"Status",accessorKey:"model_info.db_model",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("div",{className:"\n          inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium\n          ".concat(t.model_info.db_model?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-600","\n        "),children:t.model_info.db_model?"DB Model":"Config Model"})}},{id:"actions",header:"",cell:t=>{var a;let{row:r}=t,i=r.original,n="Admin"===e||(null===(a=i.model_info)||void 0===a?void 0:a.created_by)===s;return(0,c.jsxs)("div",{className:"flex items-center justify-end gap-2 pr-4",children:[(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>{n&&(l(i.model_info.id),o(!0))},className:n?"cursor-pointer":"opacity-50 cursor-not-allowed"}),(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>{n&&(l(i.model_info.id),o(!1))},className:n?"cursor-pointer":"opacity-50 cursor-not-allowed"})]})}}];var tz=t(15731),tV=t(91126);let tK=(e,s,t,l,a,r,i,n,o,d,m)=>[{header:()=>(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(s2.Z,{checked:t,indeterminate:s.length>0&&!t,onChange:e=>a(e.target.checked),onClick:e=>e.stopPropagation()}),(0,c.jsx)("span",{children:"Model ID"})]}),accessorKey:"model_info.id",enableSorting:!0,sortingFn:"alphanumeric",cell:e=>{let{row:t}=e,a=t.original,r=a.model_name,i=s.includes(r);return(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(s2.Z,{checked:i,onChange:e=>l(r,e.target.checked),onClick:e=>e.stopPropagation()}),(0,c.jsx)(z.Z,{title:a.model_info.id,children:(0,c.jsx)("div",{className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left w-full truncate whitespace-nowrap cursor-pointer max-w-[15ch]",onClick:()=>m&&m(a.model_info.id),children:a.model_info.id})})]})}},{header:"Model Name",accessorKey:"model_name",enableSorting:!0,sortingFn:"alphanumeric",cell:e=>{let{row:s}=e,t=s.original,l=n(t)||t.model_name;return(0,c.jsx)("div",{className:"font-medium text-sm",children:(0,c.jsx)(z.Z,{title:l,children:(0,c.jsx)("div",{className:"truncate max-w-[200px]",children:l})})})}},{header:"Health Status",accessorKey:"health_status",enableSorting:!0,sortingFn:(e,s,t)=>{var l,a;let r=e.getValue("health_status")||"unknown",i=s.getValue("health_status")||"unknown",n={healthy:0,checking:1,unknown:2,unhealthy:3};return(null!==(l=n[r])&&void 0!==l?l:4)-(null!==(a=n[i])&&void 0!==a?a:4)},cell:s=>{var t;let{row:l}=s,a=l.original,r={status:a.health_status,loading:a.health_loading,error:a.health_error};if(r.loading)return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsxs)("div",{className:"flex space-x-1",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),(0,c.jsx)("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),(0,c.jsx)("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]}),(0,c.jsx)(w.Z,{className:"text-gray-600 text-sm",children:"Checking..."})]});let n=a.model_name,o="healthy"===r.status&&(null===(t=e[n])||void 0===t?void 0:t.successResponse);return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[i(r.status),o&&d&&(0,c.jsx)(z.Z,{title:"View response details",placement:"top",children:(0,c.jsx)("button",{onClick:()=>{var s;return d(n,null===(s=e[n])||void 0===s?void 0:s.successResponse)},className:"p-1 text-green-600 hover:text-green-800 hover:bg-green-50 rounded cursor-pointer transition-colors",children:(0,c.jsx)(tz.Z,{className:"h-4 w-4"})})})]})}},{header:"Error Details",accessorKey:"health_error",enableSorting:!1,cell:s=>{let{row:t}=s,l=t.original.model_name,a=e[l];if(!(null==a?void 0:a.error))return(0,c.jsx)(w.Z,{className:"text-gray-400 text-sm",children:"No errors"});let r=a.error,i=a.fullError||a.error;return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("div",{className:"max-w-[200px]",children:(0,c.jsx)(z.Z,{title:r,placement:"top",children:(0,c.jsx)(w.Z,{className:"text-red-600 text-sm truncate",children:r})})}),o&&i!==r&&(0,c.jsx)(z.Z,{title:"View full error details",placement:"top",children:(0,c.jsx)("button",{onClick:()=>o(l,r,i),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded cursor-pointer transition-colors",children:(0,c.jsx)(tz.Z,{className:"h-4 w-4"})})})]})}},{header:"Last Check",accessorKey:"last_check",enableSorting:!0,sortingFn:(e,s,t)=>{let l=e.getValue("last_check")||"Never checked",a=s.getValue("last_check")||"Never checked";if("Never checked"===l&&"Never checked"===a)return 0;if("Never checked"===l)return 1;if("Never checked"===a)return -1;if("Check in progress..."===l&&"Check in progress..."===a)return 0;if("Check in progress..."===l)return -1;if("Check in progress..."===a)return 1;let r=new Date(l),i=new Date(a);return isNaN(r.getTime())&&isNaN(i.getTime())?0:isNaN(r.getTime())?1:isNaN(i.getTime())?-1:i.getTime()-r.getTime()},cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)(w.Z,{className:"text-gray-600 text-sm",children:t.health_loading?"Check in progress...":t.last_check})}},{header:"Last Success",accessorKey:"last_success",enableSorting:!0,sortingFn:(e,s,t)=>{let l=e.getValue("last_success")||"Never succeeded",a=s.getValue("last_success")||"Never succeeded";if("Never succeeded"===l&&"Never succeeded"===a)return 0;if("Never succeeded"===l)return 1;if("Never succeeded"===a)return -1;if("None"===l&&"None"===a)return 0;if("None"===l)return 1;if("None"===a)return -1;let r=new Date(l),i=new Date(a);return isNaN(r.getTime())&&isNaN(i.getTime())?0:isNaN(r.getTime())?1:isNaN(i.getTime())?-1:i.getTime()-r.getTime()},cell:s=>{let{row:t}=s,l=e[t.original.model_name],a=(null==l?void 0:l.lastSuccess)||"None";return(0,c.jsx)(w.Z,{className:"text-gray-600 text-sm",children:a})}},{header:"Actions",id:"actions",cell:e=>{let{row:s}=e,t=s.original,l=t.model_name,a=t.health_status&&"none"!==t.health_status,i=t.health_loading?"Checking...":a?"Re-run Health Check":"Run Health Check";return(0,c.jsx)(z.Z,{title:i,placement:"top",children:(0,c.jsx)("button",{className:"p-2 rounded-md transition-colors ".concat(t.health_loading?"text-gray-400 cursor-not-allowed bg-gray-100":"text-indigo-600 hover:text-indigo-700 hover:bg-indigo-50"),onClick:()=>{t.health_loading||r(l)},disabled:t.health_loading,children:t.health_loading?(0,c.jsxs)("div",{className:"flex space-x-1",children:[(0,c.jsx)("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-pulse"}),(0,c.jsx)("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),(0,c.jsx)("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]}):a?(0,c.jsx)(e1.Z,{className:"h-4 w-4"}):(0,c.jsx)(tV.Z,{className:"h-4 w-4"})})})},enableSorting:!1}],tB=[{pattern:/Missing .* API Key/i,replacement:"Missing API Key"},{pattern:/Connection timeout/i,replacement:"Connection timeout"},{pattern:/Network.*not.*ok/i,replacement:"Network connection failed"},{pattern:/403.*Forbidden/i,replacement:"Access forbidden - check API key permissions"},{pattern:/401.*Unauthorized/i,replacement:"Unauthorized - invalid API key"},{pattern:/429.*rate limit/i,replacement:"Rate limit exceeded"},{pattern:/500.*Internal Server Error/i,replacement:"Provider internal server error"},{pattern:/litellm\.AuthenticationError/i,replacement:"Authentication failed"},{pattern:/litellm\.RateLimitError/i,replacement:"Rate limit exceeded"},{pattern:/litellm\.APIError/i,replacement:"API error"}];var tG=e=>{let{accessToken:s,modelData:t,all_models_on_proxy:l,getDisplayModelName:a,setSelectedModelId:r}=e,[i,n]=(0,d.useState)({}),[o,m]=(0,d.useState)([]),[u,x]=(0,d.useState)(!1),[h,p]=(0,d.useState)(!1),[j,f]=(0,d.useState)(null),[v,y]=(0,d.useState)(!1),[b,N]=(0,d.useState)(null),Z=(0,d.useRef)(null);(0,d.useEffect)(()=>{s&&(null==t?void 0:t.data)&&(async()=>{let e={};t.data.forEach(s=>{e[s.model_name]={status:"none",lastCheck:"None",lastSuccess:"None",loading:!1,error:void 0,fullError:void 0,successResponse:void 0}});try{let l=await (0,g.latestHealthChecksCall)(s);l&&l.latest_health_checks&&"object"==typeof l.latest_health_checks&&Object.entries(l.latest_health_checks).forEach(s=>{let[l,a]=s;if(!a)return;let r=null,i=t.data.find(e=>e.model_name===l);if(i)r=i.model_name;else{let e=t.data.find(e=>e.model_info&&e.model_info.id===l);if(e)r=e.model_name;else if(a.model_name){let e=t.data.find(e=>e.model_name===a.model_name);e&&(r=e.model_name)}}if(r){let s=a.error_message||void 0;e[r]={status:a.status||"unknown",lastCheck:a.checked_at?new Date(a.checked_at).toLocaleString():"None",lastSuccess:"healthy"===a.status&&a.checked_at?new Date(a.checked_at).toLocaleString():"None",loading:!1,error:s?S(s):void 0,fullError:s,successResponse:"healthy"===a.status?a:void 0}}})}catch(e){console.warn("Failed to load health check history (using default states):",e)}n(e)})()},[s,t]);let S=e=>{var s;if(!e)return"Health check failed";let t="string"==typeof e?e:JSON.stringify(e),l=t.match(/(\w+Error):\s*(\d{3})/i);if(l)return"".concat(l[1],": ").concat(l[2]);let a=t.match(/(AuthenticationError|RateLimitError|BadRequestError|InternalServerError|TimeoutError|NotFoundError|ForbiddenError|ServiceUnavailableError|BadGatewayError|ContentPolicyViolationError|\w+Error)/i),r=t.match(/\b(400|401|403|404|408|429|500|502|503|504)\b/);if(a&&r)return"".concat(a[1],": ").concat(r[1]);if(r){let e=r[1];return"".concat({400:"BadRequestError",401:"AuthenticationError",403:"ForbiddenError",404:"NotFoundError",408:"TimeoutError",429:"RateLimitError",500:"InternalServerError",502:"BadGatewayError",503:"ServiceUnavailableError",504:"GatewayTimeoutError"}[e],": ").concat(e)}if(a){let e=a[1],s={AuthenticationError:"401",RateLimitError:"429",BadRequestError:"400",InternalServerError:"500",TimeoutError:"408",NotFoundError:"404",ForbiddenError:"403",ServiceUnavailableError:"503",BadGatewayError:"502",GatewayTimeoutError:"504",ContentPolicyViolationError:"400"}[e];return s?"".concat(e,": ").concat(s):e}for(let{pattern:e,replacement:s}of tB)if(e.test(t))return s;if(/missing.*api.*key|invalid.*key|unauthorized/i.test(t))return"AuthenticationError: 401";if(/rate.*limit|too.*many.*requests/i.test(t))return"RateLimitError: 429";if(/timeout|timed.*out/i.test(t))return"TimeoutError: 408";if(/not.*found/i.test(t))return"NotFoundError: 404";if(/forbidden|access.*denied/i.test(t))return"ForbiddenError: 403";if(/internal.*server.*error/i.test(t))return"InternalServerError: 500";let i=t.replace(/[\n\r]+/g," ").replace(/\s+/g," ").trim(),n=null===(s=i.split(/[.!?]/)[0])||void 0===s?void 0:s.trim();return n&&n.length>0?n.length>100?n.substring(0,97)+"...":n:i.length>100?i.substring(0,97)+"...":i},C=async e=>{if(s){n(s=>({...s,[e]:{...s[e],loading:!0,status:"checking"}}));try{var l,a;let r=await (0,g.individualModelHealthCheckCall)(s,e),i=new Date().toLocaleString();if(r.unhealthy_count>0&&r.unhealthy_endpoints&&r.unhealthy_endpoints.length>0){let s=(null===(l=r.unhealthy_endpoints[0])||void 0===l?void 0:l.error)||"Health check failed",t=S(s);n(l=>{var a;return{...l,[e]:{status:"unhealthy",lastCheck:i,lastSuccess:(null===(a=l[e])||void 0===a?void 0:a.lastSuccess)||"None",loading:!1,error:t,fullError:s}}})}else n(s=>({...s,[e]:{status:"healthy",lastCheck:i,lastSuccess:i,loading:!1,successResponse:r}}));try{let l=await (0,g.latestHealthChecksCall)(s),r=t.data.find(s=>s.model_name===e);if(r){let s=r.model_info.id,t=null===(a=l.latest_health_checks)||void 0===a?void 0:a[s];if(t){let s=t.error_message||void 0;n(l=>{var a,r,i,n,o,c,d;return{...l,[e]:{status:t.status||(null===(a=l[e])||void 0===a?void 0:a.status)||"unknown",lastCheck:t.checked_at?new Date(t.checked_at).toLocaleString():(null===(r=l[e])||void 0===r?void 0:r.lastCheck)||"None",lastSuccess:"healthy"===t.status?t.checked_at?new Date(t.checked_at).toLocaleString():(null===(i=l[e])||void 0===i?void 0:i.lastSuccess)||"None":(null===(n=l[e])||void 0===n?void 0:n.lastSuccess)||"None",loading:!1,error:s?S(s):null===(o=l[e])||void 0===o?void 0:o.error,fullError:s||(null===(c=l[e])||void 0===c?void 0:c.fullError),successResponse:"healthy"===t.status?t:null===(d=l[e])||void 0===d?void 0:d.successResponse}}})}}}catch(e){console.debug("Could not fetch updated status from database (non-critical):",e)}}catch(a){let s=new Date().toLocaleString(),t=a instanceof Error?a.message:String(a),l=S(t);n(a=>{var r;return{...a,[e]:{status:"unhealthy",lastCheck:s,lastSuccess:(null===(r=a[e])||void 0===r?void 0:r.lastSuccess)||"None",loading:!1,error:l,fullError:t}}})}}},I=async()=>{let e=o.length>0?o:l,a=e.reduce((e,s)=>(e[s]={...i[s],loading:!0,status:"checking"},e),{});n(e=>({...e,...a}));let r={},c=e.map(async e=>{if(s)try{let l=await (0,g.individualModelHealthCheckCall)(s,e);r[e]=l;let a=new Date().toLocaleString();if(l.unhealthy_count>0&&l.unhealthy_endpoints&&l.unhealthy_endpoints.length>0){var t;let s=(null===(t=l.unhealthy_endpoints[0])||void 0===t?void 0:t.error)||"Health check failed",r=S(s);n(t=>{var l;return{...t,[e]:{status:"unhealthy",lastCheck:a,lastSuccess:(null===(l=t[e])||void 0===l?void 0:l.lastSuccess)||"None",loading:!1,error:r,fullError:s}}})}else n(s=>({...s,[e]:{status:"healthy",lastCheck:a,lastSuccess:a,loading:!1,successResponse:l}}))}catch(a){console.error("Health check failed for ".concat(e,":"),a);let s=new Date().toLocaleString(),t=a instanceof Error?a.message:String(a),l=S(t);n(a=>{var r;return{...a,[e]:{status:"unhealthy",lastCheck:s,lastSuccess:(null===(r=a[e])||void 0===r?void 0:r.lastSuccess)||"None",loading:!1,error:l,fullError:t}}})}});await Promise.allSettled(c);try{if(!s)return;let l=await (0,g.latestHealthChecksCall)(s);l.latest_health_checks&&Object.entries(l.latest_health_checks).forEach(s=>{let[l,a]=s,r=t.data.find(e=>e.model_info.id===l);if(r&&e.includes(r.model_name)&&a){let e=r.model_name,s=a.error_message||void 0;n(t=>{let l=t[e];return{...t,[e]:{status:a.status||(null==l?void 0:l.status)||"unknown",lastCheck:a.checked_at?new Date(a.checked_at).toLocaleString():(null==l?void 0:l.lastCheck)||"None",lastSuccess:"healthy"===a.status&&a.checked_at?new Date(a.checked_at).toLocaleString():(null==l?void 0:l.lastSuccess)||"None",loading:!1,error:s?S(s):null==l?void 0:l.error,fullError:s||(null==l?void 0:l.fullError),successResponse:"healthy"===a.status?a:null==l?void 0:l.successResponse}}})}})}catch(e){console.warn("Failed to fetch updated health statuses from database (non-critical):",e)}},P=e=>{x(e),e?m(l):m([])},E=()=>{p(!1),f(null)},L=()=>{y(!1),N(null)};return(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"mb-6",children:(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(k.Z,{children:"Model Health Status"}),(0,c.jsx)(w.Z,{className:"text-gray-600 mt-1",children:"Run health checks on individual models to verify they are working correctly"})]}),(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[o.length>0&&(0,c.jsx)(_.Z,{size:"sm",variant:"light",onClick:()=>P(!1),className:"px-3 py-1 text-sm",children:"Clear Selection"}),(0,c.jsx)(_.Z,{size:"sm",variant:"secondary",onClick:I,disabled:Object.values(i).some(e=>e.loading),className:"px-3 py-1 text-sm",children:o.length>0&&o.length<l.length?"Run Selected Checks":"Run All Checks"})]})]})}),(0,c.jsx)("div",{children:(0,c.jsx)(tq.C,{columns:tK(i,o,u,(e,s)=>{s?m(s=>[...s,e]):(m(s=>s.filter(s=>s!==e)),x(!1))},P,C,e=>{switch(e){case"healthy":return(0,c.jsx)(eJ.Z,{color:"emerald",children:"healthy"});case"unhealthy":return(0,c.jsx)(eJ.Z,{color:"red",children:"unhealthy"});case"checking":return(0,c.jsx)(eJ.Z,{color:"blue",children:"checking"});case"none":return(0,c.jsx)(eJ.Z,{color:"gray",children:"none"});default:return(0,c.jsx)(eJ.Z,{color:"gray",children:"unknown"})}},a,(e,s,t)=>{f({modelName:e,cleanedError:s,fullError:t}),p(!0)},(e,s)=>{N({modelName:e,response:s}),y(!0)},r),data:t.data.map(e=>{let s=i[e.model_name]||{status:"none",lastCheck:"None",loading:!1};return{model_name:e.model_name,model_info:e.model_info,provider:e.provider,litellm_model_name:e.litellm_model_name,health_status:s.status,last_check:s.lastCheck,last_success:s.lastSuccess||"None",health_loading:s.loading,health_error:s.error,health_full_error:s.fullError}}),isLoading:!1,table:Z})}),(0,c.jsx)(A.Z,{title:j?"Health Check Error - ".concat(j.modelName):"Error Details",open:h,onCancel:E,footer:[(0,c.jsx)(T.ZP,{onClick:E,children:"Close"},"close")],width:800,children:j&&(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Error:"}),(0,c.jsx)("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,c.jsx)(w.Z,{className:"text-red-800",children:j.cleanedError})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Full Error Details:"}),(0,c.jsx)("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md max-h-96 overflow-y-auto",children:(0,c.jsx)("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:j.fullError})})]})]})}),(0,c.jsx)(A.Z,{title:b?"Health Check Response - ".concat(b.modelName):"Response Details",open:v,onCancel:L,footer:[(0,c.jsx)(T.ZP,{onClick:L,children:"Close"},"close")],width:800,children:b&&(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Status:"}),(0,c.jsx)("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-md",children:(0,c.jsx)(w.Z,{className:"text-green-800",children:"Health check passed successfully"})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Response Details:"}),(0,c.jsx)("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md max-h-96 overflow-y-auto",children:(0,c.jsx)("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:JSON.stringify(b.response,null,2)})})]})]})})]})},tH=t(61778),tJ=t(12660),tY=t(93142),tW=e=>{let{value:s={},onChange:t}=e,[l,a]=(0,d.useState)(Object.entries(s)),r=e=>{let s=l.filter((s,t)=>t!==e);a(s),null==t||t(Object.fromEntries(s))},i=(e,s,r)=>{let i=[...l];i[e]=[s,r],a(i),null==t||t(Object.fromEntries(i))};return(0,c.jsxs)("div",{children:[l.map((e,s)=>{let[t,l]=e;return(0,c.jsxs)(tY.Z,{style:{display:"flex",marginBottom:8},align:"center",children:[(0,c.jsx)(y.Z,{placeholder:"Header Name",value:t,onChange:e=>i(s,e.target.value,l)}),(0,c.jsx)(y.Z,{placeholder:"Header Value",value:l,onChange:e=>i(s,t,e.target.value)}),(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:(0,c.jsx)(to.Z,{onClick:()=>r(s),style:{cursor:"pointer"}})})]},s)}),(0,c.jsx)(T.ZP,{type:"dashed",onClick:()=>{a([...l,["",""]])},icon:(0,c.jsx)(tc.Z,{}),children:"Add Header"})]})},t$=t(77565),tQ=e=>{let{pathValue:s,targetValue:t,includeSubpath:l}=e,a=(0,g.getProxyBaseUrl)();return s&&t?(0,c.jsxs)(W.Z,{className:"p-5",children:[(0,c.jsx)(k.Z,{className:"text-lg font-semibold text-gray-900 mb-2",children:"Route Preview"}),(0,c.jsx)(sT.Z,{className:"text-gray-600 mb-5",children:"How your requests will be routed"}),(0,c.jsxs)("div",{className:"space-y-5",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-base font-semibold text-gray-900 mb-3",children:"Basic routing:"}),(0,c.jsxs)("div",{className:"flex items-center gap-4",children:[(0,c.jsxs)("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,c.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Your endpoint"}),(0,c.jsx)("code",{className:"font-mono text-sm text-gray-900",children:s?"".concat(a).concat(s):""})]}),(0,c.jsx)("div",{className:"text-gray-400",children:(0,c.jsx)(t$.Z,{className:"text-lg"})}),(0,c.jsxs)("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,c.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Forwards to"}),(0,c.jsx)("code",{className:"font-mono text-sm text-gray-900",children:t})]})]})]}),l&&(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-base font-semibold text-gray-900 mb-3",children:"With subpaths:"}),(0,c.jsxs)("div",{className:"flex items-center gap-4",children:[(0,c.jsxs)("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,c.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Your endpoint + subpath"}),(0,c.jsxs)("code",{className:"font-mono text-sm text-gray-900",children:[s&&"".concat(a).concat(s),(0,c.jsx)("span",{className:"text-blue-600",children:"/v1/text-to-image/base/model"})]})]}),(0,c.jsx)("div",{className:"text-gray-400",children:(0,c.jsx)(t$.Z,{className:"text-lg"})}),(0,c.jsxs)("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,c.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Forwards to"}),(0,c.jsxs)("code",{className:"font-mono text-sm text-gray-900",children:[t,(0,c.jsx)("span",{className:"text-blue-600",children:"/v1/text-to-image/base/model"})]})]})]}),(0,c.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:["Any path after ",s," will be appended to the target URL"]})]})}),!l&&(0,c.jsx)("div",{className:"mt-4 p-3 bg-blue-50 rounded-md border border-blue-200",children:(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)(U.Z,{className:"text-blue-500 mt-0.5 mr-2 flex-shrink-0"}),(0,c.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,c.jsx)("span",{className:"font-medium",children:"Not seeing the routing you wanted?"})," Try enabling - Include Subpaths - above - this allows subroutes like ",(0,c.jsx)("code",{className:"bg-blue-100 px-1 py-0.5 rounded font-mono text-xs",children:"/api/v1/models"})," to be forwarded automatically."]})]})})]})]}):null};let{Option:tX}=C.default;var t0=e=>{let{accessToken:s,setPassThroughItems:t,passThroughItems:l}=e,[a]=I.Z.useForm(),[r,i]=(0,d.useState)(!1),[n,o]=(0,d.useState)(!1),[m,u]=(0,d.useState)(""),[x,h]=(0,d.useState)(""),[p,j]=(0,d.useState)(""),[f,v]=(0,d.useState)(!0),b=()=>{a.resetFields(),h(""),j(""),v(!0),i(!1)},N=e=>{let s=e;e&&!e.startsWith("/")&&(s="/"+e),h(s),a.setFieldsValue({path:s})},Z=async e=>{console.log("addPassThrough called with:",e),o(!0);try{console.log("formValues: ".concat(JSON.stringify(e)));let r=(await (0,g.createPassThroughEndpoint)(s,e)).endpoints[0],n=[...l,r];t(n),P.ZP.success("Pass-through endpoint created successfully"),a.resetFields(),h(""),j(""),v(!0),i(!1)}catch(e){P.ZP.error("Error creating pass-through endpoint: "+e,20)}finally{o(!1)}};return(0,c.jsxs)("div",{children:[(0,c.jsx)(_.Z,{className:"mx-auto mb-4 mt-4",onClick:()=>i(!0),children:"+ Add Pass-Through Endpoint"}),(0,c.jsx)(A.Z,{title:(0,c.jsxs)("div",{className:"flex items-center space-x-3 pb-4 border-b border-gray-100",children:[(0,c.jsx)(tJ.Z,{className:"text-xl text-blue-500"}),(0,c.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add Pass-Through Endpoint"})]}),open:r,width:1e3,onCancel:b,footer:null,className:"top-8",styles:{body:{padding:"24px"},header:{padding:"24px 24px 0 24px",border:"none"}},children:(0,c.jsxs)("div",{className:"mt-6",children:[(0,c.jsx)(tH.Z,{message:"What is a Pass-Through Endpoint?",description:"Route requests from your LiteLLM proxy to any external API. Perfect for custom models, image generation APIs, or any service you want to proxy through LiteLLM.",type:"info",showIcon:!0,className:"mb-6"}),(0,c.jsxs)(I.Z,{form:a,onFinish:Z,layout:"vertical",className:"space-y-6",initialValues:{include_subpath:!0,path:x,target:p},children:[(0,c.jsxs)(W.Z,{className:"p-5",children:[(0,c.jsx)(k.Z,{className:"text-lg font-semibold text-gray-900 mb-2",children:"Route Configuration"}),(0,c.jsx)(sT.Z,{className:"text-gray-600 mb-5",children:"Configure how requests to your domain will be forwarded to the target API"}),(0,c.jsxs)("div",{className:"space-y-5",children:[(0,c.jsx)(I.Z.Item,{label:(0,c.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Path Prefix"}),name:"path",rules:[{required:!0,message:"Path is required",pattern:/^\//}],extra:(0,c.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Example: /bria, /adobe-photoshop, /elasticsearch"}),className:"mb-4",children:(0,c.jsx)("div",{className:"flex items-center",children:(0,c.jsx)(y.Z,{placeholder:"bria",value:x,onChange:e=>N(e.target.value),className:"flex-1"})})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Target URL"}),name:"target",rules:[{required:!0,message:"Target URL is required"},{type:"url",message:"Please enter a valid URL"}],extra:(0,c.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Example:https://engine.prod.bria-api.com"}),className:"mb-4",children:(0,c.jsx)(y.Z,{placeholder:"https://engine.prod.bria-api.com",value:p,onChange:e=>{j(e.target.value),a.setFieldsValue({target:e.target.value})}})}),(0,c.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Include Subpaths"}),(0,c.jsx)("div",{className:"text-xs text-gray-500 mt-0.5",children:"Forward all subpaths to the target API (recommended for REST APIs)"})]}),(0,c.jsx)(I.Z.Item,{name:"include_subpath",valuePropName:"checked",className:"mb-0",children:(0,c.jsx)(tE.Z,{checked:f,onChange:v})})]})]})]}),(0,c.jsx)(tQ,{pathValue:x,targetValue:p,includeSubpath:f}),(0,c.jsxs)(W.Z,{className:"p-6",children:[(0,c.jsx)(k.Z,{className:"text-lg font-semibold text-gray-900 mb-2",children:"Headers"}),(0,c.jsx)(sT.Z,{className:"text-gray-600 mb-6",children:"Add headers that will be sent with every request to the target API"}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Authentication Headers",(0,c.jsx)(z.Z,{title:"Authentication and other headers to forward with requests",children:(0,c.jsx)(U.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"headers",rules:[{required:!0,message:"Please configure the headers"}],extra:(0,c.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:[(0,c.jsx)("div",{className:"font-medium mb-1",children:"Add authentication tokens and other required headers"}),(0,c.jsx)("div",{children:"Common examples: auth_token, Authorization, x-api-key"})]}),children:(0,c.jsx)(tW,{})})]}),(0,c.jsxs)(W.Z,{className:"p-6",children:[(0,c.jsx)(k.Z,{className:"text-lg font-semibold text-gray-900 mb-2",children:"Billing"}),(0,c.jsx)(sT.Z,{className:"text-gray-600 mb-6",children:"Optional cost tracking for this endpoint"}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Cost Per Request (USD)",(0,c.jsx)(z.Z,{title:"Optional: Track costs for requests to this endpoint",children:(0,c.jsx)(U.Z,{className:"ml-2 text-gray-400 hover:text-gray-600"})})]}),name:"cost_per_request",extra:(0,c.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"The cost charged for each request through this endpoint"}),children:(0,c.jsx)(M,{min:0,step:.001,precision:4,placeholder:"2.0000",size:"large"})})]}),(0,c.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-100",children:[(0,c.jsx)(_.Z,{variant:"secondary",onClick:b,children:"Cancel"}),(0,c.jsx)(_.Z,{variant:"primary",loading:n,onClick:()=>{console.log("Submit button clicked"),a.submit()},children:n?"Creating...":"Add Pass-Through Endpoint"})]})]})]})})]})},t1=t(87769),t2=t(42208);let t4=e=>{let{value:s}=e,[t,l]=(0,d.useState)(!1),a=JSON.stringify(s,null,2);return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("pre",{className:"font-mono text-xs bg-gray-50 p-2 rounded max-w-md overflow-auto",children:t?a:"••••••••"}),(0,c.jsx)("button",{onClick:()=>l(!t),className:"p-1 hover:bg-gray-100 rounded",type:"button",children:t?(0,c.jsx)(t1.Z,{className:"w-4 h-4 text-gray-500"}):(0,c.jsx)(t2.Z,{className:"w-4 h-4 text-gray-500"})})]})};var t5=e=>{let{endpointData:s,onClose:t,accessToken:l,isAdmin:a,onEndpointUpdated:r}=e,[i,n]=(0,d.useState)(s),[o,m]=(0,d.useState)(!1),[u,x]=(0,d.useState)(!1),[h]=I.Z.useForm(),p=async e=>{try{if(!l||!(null==i?void 0:i.id))return;let s={};if(e.headers)try{s="string"==typeof e.headers?JSON.parse(e.headers):e.headers}catch(e){P.ZP.error("Invalid JSON format for headers");return}let t={path:i.path,target:e.target,headers:s,include_subpath:e.include_subpath,cost_per_request:e.cost_per_request};await (0,g.updatePassThroughEndpoint)(l,i.id,t),n({...i,...t}),x(!1),r&&r()}catch(e){console.error("Error updating endpoint:",e),P.ZP.error("Failed to update pass through endpoint")}},j=async()=>{try{if(!l||!(null==i?void 0:i.id))return;await (0,g.deletePassThroughEndpointsCall)(l,i.id),P.ZP.success("Pass through endpoint deleted successfully"),t(),r&&r()}catch(e){console.error("Error deleting endpoint:",e),P.ZP.error("Failed to delete pass through endpoint")}};return o?(0,c.jsx)("div",{className:"p-4",children:"Loading..."}):i?(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,c.jsxs)("div",{children:[(0,c.jsx)(T.ZP,{onClick:t,className:"mb-4",children:"← Back"}),(0,c.jsxs)(k.Z,{children:["Pass Through Endpoint: ",i.path]}),(0,c.jsx)(w.Z,{className:"text-gray-500 font-mono",children:i.id})]})}),(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{className:"mb-4",children:[(0,c.jsx)(eY.Z,{children:"Overview"},"overview"),a?(0,c.jsx)(eY.Z,{children:"Settings"},"settings"):(0,c.jsx)(c.Fragment,{})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Path"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)(k.Z,{className:"font-mono",children:i.path})})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Target"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)(k.Z,{children:i.target})})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Configuration"}),(0,c.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,c.jsx)("div",{children:(0,c.jsx)(eJ.Z,{color:i.include_subpath?"green":"gray",children:i.include_subpath?"Include Subpath":"Exact Path"})}),void 0!==i.cost_per_request&&(0,c.jsx)("div",{children:(0,c.jsxs)(w.Z,{children:["Cost per request: $",i.cost_per_request]})})]})]})]}),(0,c.jsx)("div",{className:"mt-6",children:(0,c.jsx)(tQ,{pathValue:i.path,targetValue:i.target,includeSubpath:i.include_subpath||!1})}),i.headers&&Object.keys(i.headers).length>0&&(0,c.jsxs)(W.Z,{className:"mt-6",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Headers"}),(0,c.jsxs)(eJ.Z,{color:"blue",children:[Object.keys(i.headers).length," headers configured"]})]}),(0,c.jsx)("div",{className:"mt-4",children:(0,c.jsx)(t4,{value:i.headers})})]})]}),a&&(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"Pass Through Endpoint Settings"}),(0,c.jsx)("div",{className:"space-x-2",children:!u&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(_.Z,{onClick:()=>x(!0),children:"Edit Settings"}),(0,c.jsx)(_.Z,{onClick:j,variant:"secondary",color:"red",children:"Delete Endpoint"})]})})]}),u?(0,c.jsxs)(I.Z,{form:h,onFinish:p,initialValues:{target:i.target,headers:i.headers?JSON.stringify(i.headers,null,2):"",include_subpath:i.include_subpath||!1,cost_per_request:i.cost_per_request},layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{label:"Target URL",name:"target",rules:[{required:!0,message:"Please input a target URL"}],children:(0,c.jsx)(y.Z,{placeholder:"https://api.example.com"})}),(0,c.jsx)(I.Z.Item,{label:"Headers (JSON)",name:"headers",children:(0,c.jsx)(L.default.TextArea,{rows:5,placeholder:'{"Authorization": "Bearer your-token", "Content-Type": "application/json"}'})}),(0,c.jsx)(I.Z.Item,{label:"Include Subpath",name:"include_subpath",valuePropName:"checked",children:(0,c.jsx)(tn.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"Cost per Request",name:"cost_per_request",children:(0,c.jsx)(q.Z,{min:0,step:.01,precision:2,placeholder:"0.00",addonBefore:"$"})}),(0,c.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,c.jsx)(T.ZP,{onClick:()=>x(!1),children:"Cancel"}),(0,c.jsx)(_.Z,{children:"Save Changes"})]})]}):(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Path"}),(0,c.jsx)("div",{className:"font-mono",children:i.path})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Target URL"}),(0,c.jsx)("div",{children:i.target})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Include Subpath"}),(0,c.jsx)(eJ.Z,{color:i.include_subpath?"green":"gray",children:i.include_subpath?"Yes":"No"})]}),void 0!==i.cost_per_request&&(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Cost per Request"}),(0,c.jsxs)("div",{children:["$",i.cost_per_request]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Headers"}),i.headers&&Object.keys(i.headers).length>0?(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)(t4,{value:i.headers})}):(0,c.jsx)("div",{className:"text-gray-500",children:"No headers configured"})]})]})]})})]})]})]}):(0,c.jsx)("div",{className:"p-4",children:"Pass through endpoint not found"})},t6=t(19130);function t3(e){let{data:s=[],columns:t,getRowCanExpand:l,renderSubComponent:a,isLoading:r=!1,loadingMessage:i="\uD83D\uDE85 Loading logs...",noDataMessage:n="No logs found"}=e,o=(0,sp.b7)({data:s,columns:t,getRowCanExpand:l,getRowId:(e,s)=>{var t;return null!==(t=null==e?void 0:e.request_id)&&void 0!==t?t:String(s)},getCoreRowModel:(0,sg.sC)(),getExpandedRowModel:(0,sg.rV)()});return(0,c.jsx)("div",{className:"rounded-lg custom-border",children:(0,c.jsxs)(t6.iA,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,c.jsx)(t6.ss,{children:o.getHeaderGroups().map(e=>(0,c.jsx)(t6.SC,{children:e.headers.map(e=>(0,c.jsx)(t6.xs,{className:"py-1 h-8",children:e.isPlaceholder?null:(0,sp.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,c.jsx)(t6.RM,{children:r?(0,c.jsx)(t6.SC,{children:(0,c.jsx)(t6.pj,{colSpan:t.length,className:"h-8 text-center",children:(0,c.jsx)("div",{className:"text-center text-gray-500",children:(0,c.jsx)("p",{children:i})})})}):o.getRowModel().rows.length>0?o.getRowModel().rows.map(e=>(0,c.jsxs)(d.Fragment,{children:[(0,c.jsx)(t6.SC,{className:"h-8",children:e.getVisibleCells().map(e=>(0,c.jsx)(t6.pj,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,sp.ie)(e.column.columnDef.cell,e.getContext())},e.id))}),e.getIsExpanded()&&(0,c.jsx)(t6.SC,{children:(0,c.jsx)(t6.pj,{colSpan:e.getVisibleCells().length,children:a({row:e})})})]},e.id)):(0,c.jsx)(t6.SC,{children:(0,c.jsx)(t6.pj,{colSpan:t.length,className:"h-8 text-center",children:(0,c.jsx)("div",{className:"text-center text-gray-500",children:(0,c.jsx)("p",{children:n})})})})})]})})}let t8=e=>{let{value:s}=e,[t,l]=(0,d.useState)(!1),a=JSON.stringify(s);return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("span",{className:"font-mono text-xs",children:t?a:"••••••••"}),(0,c.jsx)("button",{onClick:()=>l(!t),className:"p-1 hover:bg-gray-100 rounded",type:"button",children:t?(0,c.jsx)(t1.Z,{className:"w-4 h-4 text-gray-500"}):(0,c.jsx)(t2.Z,{className:"w-4 h-4 text-gray-500"})})]})};var t7=e=>{let{accessToken:s,userRole:t,userID:l,modelData:a}=e,[r,i]=(0,d.useState)([]),[n,o]=(0,d.useState)(null),[m,u]=(0,d.useState)(!1),[x,h]=(0,d.useState)(null);(0,d.useEffect)(()=>{s&&t&&l&&(0,g.getPassThroughEndpointsCall)(s).then(e=>{i(e.endpoints)})},[s,t,l]);let p=async e=>{h(e),u(!0)},j=async()=>{if(null!=x&&s){try{await (0,g.deletePassThroughEndpointsCall)(s,x);let e=r.filter(e=>e.id!==x);i(e),P.ZP.success("Endpoint deleted successfully.")}catch(e){console.error("Error deleting the endpoint:",e),P.ZP.error("Error deleting the endpoint: "+e)}u(!1),h(null)}},f=(e,s)=>{p(e)},v=[{header:"ID",accessorKey:"id",cell:e=>(0,c.jsx)(z.Z,{title:e.row.original.id,children:(0,c.jsx)("div",{className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left w-full truncate whitespace-nowrap cursor-pointer max-w-[15ch]",onClick:()=>e.row.original.id&&o(e.row.original.id),children:e.row.original.id})})},{header:"Path",accessorKey:"path"},{header:"Target",accessorKey:"target",cell:e=>(0,c.jsx)(w.Z,{children:e.getValue()})},{header:"Headers",accessorKey:"headers",cell:e=>(0,c.jsx)(t8,{value:e.getValue()||{}})},{header:"Actions",id:"actions",cell:e=>{let{row:s}=e;return(0,c.jsxs)("div",{className:"flex space-x-1",children:[(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>s.original.id&&o(s.original.id),title:"Edit"}),(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>f(s.original.id,s.index),title:"Delete"})]})}}];if(!s)return null;if(n){console.log("selectedEndpointId",n),console.log("generalSettings",r);let e=r.find(e=>e.id===n);return e?(0,c.jsx)(t5,{endpointData:e,onClose:()=>o(null),accessToken:s,isAdmin:"Admin"===t||"admin"===t,onEndpointUpdated:()=>{s&&(0,g.getPassThroughEndpointsCall)(s).then(e=>{i(e.endpoints)})}}):(0,c.jsx)("div",{children:"Endpoint not found"})}return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(k.Z,{children:"Pass Through Endpoints"}),(0,c.jsx)(w.Z,{className:"text-tremor-content",children:"Configure and manage your pass-through endpoints"})]}),(0,c.jsx)(t0,{accessToken:s,setPassThroughItems:i,passThroughItems:r}),(0,c.jsx)(t3,{data:r,columns:v,renderSubComponent:()=>(0,c.jsx)("div",{}),getRowCanExpand:()=>!1,isLoading:!1,noDataMessage:"No pass-through endpoints configured"}),m&&(0,c.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,c.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,c.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,c.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,c.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,c.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,c.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,c.jsx)("div",{className:"sm:flex sm:items-start",children:(0,c.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,c.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Pass-Through Endpoint"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this pass-through endpoint? This action cannot be undone."})})]})})}),(0,c.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,c.jsx)(_.Z,{onClick:j,color:"red",className:"ml-2",children:"Delete"}),(0,c.jsx)(_.Z,{onClick:()=>{u(!1),h(null)},children:"Cancel"})]})]})]})})]})};let t9={"BadRequestError (400)":"BadRequestErrorRetries","AuthenticationError  (401)":"AuthenticationErrorRetries","TimeoutError (408)":"TimeoutErrorRetries","RateLimitError (429)":"RateLimitErrorRetries","ContentPolicyViolationError (400)":"ContentPolicyViolationErrorRetries","InternalServerError (500)":"InternalServerErrorRetries"};var le=e=>{let{accessToken:s,token:t,userRole:l,userID:a,modelData:r={data:[]},keys:i,setModelData:n,premiumUser:o,teams:m}=e,[u]=I.Z.useForm(),[x]=I.Z.useForm(),[h,p]=(0,d.useState)(null),[j,y]=(0,d.useState)(""),[b,N]=(0,d.useState)([]),[Z,S]=(0,d.useState)([]),[C,A]=(0,d.useState)(sL.Cl.OpenAI),[E,T]=(0,d.useState)(null),[L,O]=(0,d.useState)(!1),[M,D]=(0,d.useState)(!1),[F,R]=(0,d.useState)(null),[z,V]=(0,d.useState)([]),[K,B]=(0,d.useState)([]),[G,H]=(0,d.useState)(null),[J,Y]=(0,d.useState)([]),[$,Q]=(0,d.useState)([]),[X,ee]=(0,d.useState)([]),[es,et]=(0,d.useState)([]),[el,ea]=(0,d.useState)([]),[er,ei]=(0,d.useState)([]),[en,eo]=(0,d.useState)([]),[ec,eu]=(0,d.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[ex,eh]=(0,d.useState)(null),[ep,eg]=(0,d.useState)(null),[ej,ef]=(0,d.useState)(0),[ev,e_]=(0,d.useState)({}),[ey,eb]=(0,d.useState)([]),[eN,eZ]=(0,d.useState)(!1),[ew,ek]=(0,d.useState)(null),[eS,eC]=(0,d.useState)(null),[eI,eP]=(0,d.useState)([]),[eA,eT]=(0,d.useState)([]),[eL,eO]=(0,d.useState)(!1),[eM,eD]=(0,d.useState)(null),[eF,eR]=(0,d.useState)(!1),[eq,eU]=(0,d.useState)(null),[ez,eV]=(0,d.useState)(null),[eK,eB]=(0,d.useState)(null),[eG,eJ]=(0,d.useState)(null),[e0,e2]=(0,d.useState)("personal"),[e4,e5]=(0,d.useState)("current_team"),[e6,e3]=(0,d.useState)(!1),[e8,e7]=(0,d.useState)(!1),[e9,se]=(0,d.useState)(new Set),ss=(0,d.useRef)(null),st=(0,d.useRef)(null),[sl,sa]=(0,d.useState)(0),sr=async(e,t,r)=>{if(console.log("Updating model metrics for group:",e),!s||!a||!l||!t||!r)return;console.log("inside updateModelMetrics - startTime:",t,"endTime:",r),H(e);let i=null==ew?void 0:ew.token;void 0===i&&(i=null);let n=eS;void 0===n&&(n=null);try{let o=await (0,g.modelMetricsCall)(s,a,l,e,t.toISOString(),r.toISOString(),i,n);console.log("Model metrics response:",o),Y(o.data),Q(o.all_api_bases);let c=await (0,g.streamingModelMetricsCall)(s,e,t.toISOString(),r.toISOString());ee(c.data),et(c.all_api_bases);let d=await (0,g.modelExceptionsCall)(s,a,l,e,t.toISOString(),r.toISOString(),i,n);console.log("Model exceptions response:",d),ea(d.data),ei(d.exception_types);let m=await (0,g.modelMetricsSlowResponsesCall)(s,a,l,e,t.toISOString(),r.toISOString(),i,n);if(console.log("slowResponses:",m),eo(m),e){let l=await (0,g.adminGlobalActivityExceptions)(s,null==t?void 0:t.toISOString().split("T")[0],null==r?void 0:r.toISOString().split("T")[0],e);e_(l);let a=await (0,g.adminGlobalActivityExceptionsPerDeployment)(s,null==t?void 0:t.toISOString().split("T")[0],null==r?void 0:r.toISOString().split("T")[0],e);eb(a)}}catch(e){console.error("Failed to fetch model metrics",e)}},si=async e=>{try{let s=await (0,g.credentialListCall)(e);console.log("credentials: ".concat(JSON.stringify(s))),eT(s.credentials)}catch(e){console.error("Error fetching credentials:",e)}};(0,d.useEffect)(()=>{sr(G,ec.from,ec.to)},[ew,eS,ez]),(0,d.useEffect)(()=>{let e=e=>{ss.current&&!ss.current.contains(e.target)&&e7(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let sn={name:"file",accept:".json",beforeUpload:e=>{if("application/json"===e.type){let s=new FileReader;s.onload=e=>{if(e.target){let s=e.target.result;console.log("Resetting vertex_credentials to JSON; jsonStr: ".concat(s)),u.setFieldsValue({vertex_credentials:s}),console.log("Form values right after setting:",u.getFieldsValue())}},s.readAsText(e)}return!1},onChange(e){console.log("Upload onChange triggered with values:",e),console.log("Current form values:",u.getFieldsValue()),"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?P.ZP.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&P.ZP.error("".concat(e.file.name," file upload failed."))}},sc=()=>{y(new Date().toLocaleString())},sd=async()=>{if(!s){console.error("Access token is missing");return}try{let e={router_settings:{}};"global"===G?(console.log("Saving global retry policy:",ep),ep&&(e.router_settings.retry_policy=ep),P.ZP.success("Global retry settings saved successfully")):(console.log("Saving model group retry policy for",G,":",ex),ex&&(e.router_settings.model_group_retry_policy=ex),P.ZP.success("Retry settings saved successfully for ".concat(G))),await (0,g.setCallbacksCall)(s,e)}catch(e){console.error("Failed to save retry settings:",e),P.ZP.error("Failed to save retry settings")}};if((0,d.useEffect)(()=>{if(!s||!t||!l||!a)return;let e=async()=>{try{var e,t,r,i,o,c,d,m,u,x,h,p;let j=await (0,g.modelInfoCall)(s,a,l);console.log("Model data response:",j.data),n(j);let f=await (0,g.modelSettingsCall)(s);f&&S(f);let v=new Set;for(let e=0;e<j.data.length;e++){let s=j.data[e];v.add(s.model_name)}console.log("all_model_groups:",v);let _=Array.from(v);_=_.sort(),V(_);let y=new Set;for(let e=0;e<j.data.length;e++){let s=j.data[e].model_info;if(s){let e=s.access_groups;if(e)for(let s=0;s<e.length;s++)y.add(e[s])}}B(Array.from(y)),console.log("array_model_groups:",_);let b="all";_.length>0&&(b=_[_.length-1],console.log("_initial_model_group:",b)),console.log("selectedModelGroup:",G);let N=await (0,g.modelMetricsCall)(s,a,l,b,null===(e=ec.from)||void 0===e?void 0:e.toISOString(),null===(t=ec.to)||void 0===t?void 0:t.toISOString(),null==ew?void 0:ew.token,eS);console.log("Model metrics response:",N),Y(N.data),Q(N.all_api_bases);let Z=await (0,g.streamingModelMetricsCall)(s,b,null===(r=ec.from)||void 0===r?void 0:r.toISOString(),null===(i=ec.to)||void 0===i?void 0:i.toISOString());ee(Z.data),et(Z.all_api_bases);let w=await (0,g.modelExceptionsCall)(s,a,l,b,null===(o=ec.from)||void 0===o?void 0:o.toISOString(),null===(c=ec.to)||void 0===c?void 0:c.toISOString(),null==ew?void 0:ew.token,eS);console.log("Model exceptions response:",w),ea(w.data),ei(w.exception_types);let k=await (0,g.modelMetricsSlowResponsesCall)(s,a,l,b,null===(d=ec.from)||void 0===d?void 0:d.toISOString(),null===(m=ec.to)||void 0===m?void 0:m.toISOString(),null==ew?void 0:ew.token,eS),C=await (0,g.adminGlobalActivityExceptions)(s,null===(u=ec.from)||void 0===u?void 0:u.toISOString().split("T")[0],null===(x=ec.to)||void 0===x?void 0:x.toISOString().split("T")[0],b);e_(C);let I=await (0,g.adminGlobalActivityExceptionsPerDeployment)(s,null===(h=ec.from)||void 0===h?void 0:h.toISOString().split("T")[0],null===(p=ec.to)||void 0===p?void 0:p.toISOString().split("T")[0],b);eb(I),console.log("dailyExceptions:",C),console.log("dailyExceptionsPerDeplyment:",I),console.log("slowResponses:",k),eo(k);let P=await (0,g.allEndUsersCall)(s);eP(null==P?void 0:P.end_users);let A=(await (0,g.getCallbacksCall)(s,a,l)).router_settings;console.log("routerSettingsInfo:",A);let E=A.model_group_retry_policy,T=A.num_retries;console.log("model_group_retry_policy:",E),console.log("default_retries:",T),eh(E),eg(A.retry_policy),ef(T)}catch(e){console.error("There was an error fetching the model data",e)}};s&&t&&l&&a&&e();let r=async()=>{let e=await (0,g.modelCostMap)(s);console.log("received model cost map data: ".concat(Object.keys(e))),p(e)};null==h&&r(),sc()},[s,t,l,a,h,j,ez]),!r||!s||!t||!l||!a)return(0,c.jsx)("div",{children:"Loading..."});let sm=[],su=[];for(let e=0;e<r.data.length;e++){var sx,sh,sp;let s=r.data[e],t=null==s?void 0:null===(sx=s.litellm_params)||void 0===sx?void 0:sx.model,l=null==s?void 0:null===(sh=s.litellm_params)||void 0===sh?void 0:sh.custom_llm_provider,a=null==s?void 0:s.model_info,i="",n="Undefined",o="Undefined",c="Undefined",d="Undefined",m={},u=e=>(console.log("GET PROVIDER CALLED! - ".concat(h)),null!=h&&"object"==typeof h&&e in h)?h[e].litellm_provider:"openai";if(t){let e=t.split("/"),s=e[0];(i=l)||(i=1===e.length?u(t):s)}else i="-";a&&(n=null==a?void 0:a.input_cost_per_token,o=null==a?void 0:a.output_cost_per_token,c=null==a?void 0:a.max_tokens,d=null==a?void 0:a.max_input_tokens),(null==s?void 0:s.litellm_params)&&(m=Object.fromEntries(Object.entries(null==s?void 0:s.litellm_params).filter(e=>{let[s]=e;return"model"!==s&&"api_base"!==s}))),r.data[e].provider=i,r.data[e].input_cost=n,r.data[e].output_cost=o,r.data[e].litellm_model_name=t,su.push(i),r.data[e].input_cost&&(r.data[e].input_cost=(1e6*Number(r.data[e].input_cost)).toFixed(2)),r.data[e].output_cost&&(r.data[e].output_cost=(1e6*Number(r.data[e].output_cost)).toFixed(2)),r.data[e].max_tokens=c,r.data[e].max_input_tokens=d,r.data[e].api_base=null==s?void 0:null===(sp=s.litellm_params)||void 0===sp?void 0:sp.api_base,r.data[e].cleanedLitellmParams=m,sm.push(s.model_name),console.log(r.data[e])}if(l&&"Admin Viewer"==l){let{Title:e,Paragraph:s}=em.default;return(0,c.jsxs)("div",{children:[(0,c.jsx)(e,{level:1,children:"Access Denied"}),(0,c.jsx)(s,{children:"Ask your proxy admin for access to view all models"})]})}let sg=(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"mb-1",children:"Select API Key Name"}),o?(0,c.jsxs)("div",{children:[(0,c.jsxs)(eH.Z,{defaultValue:"all-keys",children:[(0,c.jsx)(ed.Z,{value:"all-keys",onClick:()=>{ek(null)},children:"All Keys"},"all-keys"),null==i?void 0:i.map((e,s)=>e&&null!==e.key_alias&&e.key_alias.length>0?(0,c.jsx)(ed.Z,{value:String(s),onClick:()=>{ek(e)},children:e.key_alias},s):null)]}),(0,c.jsx)(w.Z,{className:"mt-1",children:"Select Customer Name"}),(0,c.jsxs)(eH.Z,{defaultValue:"all-customers",children:[(0,c.jsx)(ed.Z,{value:"all-customers",onClick:()=>{eC(null)},children:"All Customers"},"all-customers"),null==eI?void 0:eI.map((e,s)=>(0,c.jsx)(ed.Z,{value:e,onClick:()=>{eC(e)},children:e},s))]}),(0,c.jsx)(w.Z,{className:"mt-1",children:"Select Team"}),(0,c.jsxs)(eH.Z,{className:"w-64 relative z-50",defaultValue:"all",value:null!=eK?eK:"all",onValueChange:e=>eB("all"===e?null:e),children:[(0,c.jsx)(ed.Z,{value:"all",children:"All Teams"}),null==m?void 0:m.filter(e=>e.team_id).map(e=>(0,c.jsx)(ed.Z,{value:e.team_id,children:e.team_alias?"".concat(e.team_alias," (").concat(e.team_id.slice(0,8),"...)"):"Team ".concat(e.team_id.slice(0,8),"...")},e.team_id))]})]}):(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"mt-1",children:"Select Team"}),(0,c.jsxs)(eH.Z,{className:"w-64 relative z-50",defaultValue:"all",value:null!=eK?eK:"all",onValueChange:e=>eB("all"===e?null:e),children:[(0,c.jsx)(ed.Z,{value:"all",children:"All Teams"}),null==m?void 0:m.filter(e=>e.team_id).map(e=>(0,c.jsx)(ed.Z,{value:e.team_id,children:e.team_alias?"".concat(e.team_alias," (").concat(e.team_id.slice(0,8),"...)"):"Team ".concat(e.team_id.slice(0,8),"...")},e.team_id))]})]})]}),sZ=e=>{var s,t;let{payload:l,active:a}=e;if(!a||!l)return null;let r=null===(t=l[0])||void 0===t?void 0:null===(s=t.payload)||void 0===s?void 0:s.date,i=l.sort((e,s)=>s.value-e.value);if(i.length>5){let e=i.length-5;(i=i.slice(0,5)).push({dataKey:"".concat(e," other deployments"),value:l.slice(5).reduce((e,s)=>e+s.value,0),color:"gray"})}return(0,c.jsxs)("div",{className:"w-150 rounded-tremor-default border border-tremor-border bg-tremor-background p-2 text-tremor-default shadow-tremor-dropdown",children:[r&&(0,c.jsxs)("p",{className:"text-tremor-content-emphasis mb-2",children:["Date: ",r]}),i.map((e,s)=>{let t=parseFloat(e.value.toFixed(5)),l=0===t&&e.value>0?"<0.00001":t.toFixed(5);return(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 mt-1 rounded-full bg-".concat(e.color,"-500")}),(0,c.jsx)("p",{className:"text-tremor-content",children:e.dataKey})]}),(0,c.jsx)("p",{className:"font-medium text-tremor-content-emphasis text-righ ml-2",children:l})]},s)})]})};console.log("selectedProvider: ".concat(C)),console.log("providerModels.length: ".concat(b.length));let sw=Object.keys(sL.Cl).find(e=>sL.Cl[e]===C);return(sw&&Z&&Z.find(e=>e.name===sL.fK[sw]),eq)?(0,c.jsx)("div",{className:"w-full h-full",children:(0,c.jsx)(tt,{teamId:eq,onClose:()=>eU(null),accessToken:s,is_team_admin:"Admin"===l,is_proxy_admin:"Proxy Admin"===l,userModels:sm,editTeam:!1,onUpdate:sc})}):(0,c.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,c.jsx)(v.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,c.jsx)(f.Z,{numColSpan:1,className:"flex flex-col gap-2",children:eM?(0,c.jsx)(t_,{modelId:eM,editModel:!0,onClose:()=>{eD(null),eR(!1)},modelData:r.data.find(e=>e.model_info.id===eM),accessToken:s,userID:a,userRole:l,setEditModalVisible:D,setSelectedModel:R,onModelUpdate:e=>{n({...r,data:r.data.map(s=>s.model_info.id===e.model_info.id?e:s)}),sc()},modelAccessGroups:K}):(0,c.jsxs)(eW.Z,{index:sl,onIndexChange:sa,className:"gap-2 h-[75vh] w-full ",children:[(0,c.jsxs)(e$.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,c.jsxs)("div",{className:"flex",children:[eE.ZL.includes(l)?(0,c.jsx)(eY.Z,{children:"All Models"}):(0,c.jsx)(eY.Z,{children:"Your Models"}),(0,c.jsx)(eY.Z,{children:"Add Model"}),eE.ZL.includes(l)&&(0,c.jsx)(eY.Z,{children:"LLM Credentials"}),eE.ZL.includes(l)&&(0,c.jsx)(eY.Z,{children:"Pass-Through Endpoints"}),eE.ZL.includes(l)&&(0,c.jsx)(eY.Z,{children:"Health Status"}),eE.ZL.includes(l)&&(0,c.jsx)(eY.Z,{children:"Model Analytics"}),eE.ZL.includes(l)&&(0,c.jsx)(eY.Z,{children:"Model Retry Settings"})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[j&&(0,c.jsxs)(w.Z,{children:["Last Refreshed: ",j]}),(0,c.jsx)(sj.Z,{icon:e1.Z,variant:"shadow",size:"xs",className:"self-center",onClick:sc})]})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(v.Z,{children:(0,c.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,c.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,c.jsxs)("div",{children:[(0,c.jsx)(k.Z,{children:"Model Management"}),eE.ZL.includes(l)?(0,c.jsx)(w.Z,{className:"text-tremor-content",children:"Add and manage models for the proxy"}):(0,c.jsx)(w.Z,{className:"text-tremor-content",children:"Add models for teams you are an admin for."})]})}),(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,c.jsx)("div",{className:"border-b px-6 py-4",children:(0,c.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-4 border-2 border-gray-200",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center gap-4",children:[(0,c.jsx)(w.Z,{className:"text-lg font-semibold text-gray-900",children:"Current Team:"}),(0,c.jsxs)(eH.Z,{className:"w-80",defaultValue:"personal",value:e0,onValueChange:e=>e2(e),children:[(0,c.jsx)(ed.Z,{value:"personal",children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:"Personal"})]})}),null==m?void 0:m.filter(e=>e.team_id).map(e=>(0,c.jsx)(ed.Z,{value:e.team_id,children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:e.team_alias?"".concat(e.team_alias.slice(0,30),"..."):"Team ".concat(e.team_id.slice(0,30),"...")})]})},e.team_id))]})]}),"current_team"===e4&&(0,c.jsxs)("div",{className:"flex items-start gap-2 mt-2 bg-gray-50 rounded",children:[(0,c.jsx)(U.Z,{className:"text-gray-400 mt-0.5 flex-shrink-0 text-xs"}),(0,c.jsx)("div",{className:"text-xs text-gray-500",children:"personal"===e0?(0,c.jsxs)("span",{children:["To access these models: Create a Virtual Key without selecting a team on the"," ",(0,c.jsx)("a",{href:"/?login=success&page=api-keys",className:"text-gray-600 hover:text-gray-800 underline",children:"Virtual Keys page"})]}):(0,c.jsxs)("span",{children:['To access these models: Create a Virtual Key and select Team as "',e0,'" on the'," ",(0,c.jsx)("a",{href:"/?login=success&page=api-keys",className:"text-gray-600 hover:text-gray-800 underline",children:"Virtual Keys page"})]})})]})]}),(0,c.jsxs)("div",{className:"flex items-center gap-4",children:[(0,c.jsx)(w.Z,{className:"text-lg font-semibold text-gray-900",children:"View:"}),(0,c.jsxs)(eH.Z,{className:"w-64",defaultValue:"current_team",value:e4,onValueChange:e=>e5(e),children:[(0,c.jsx)(ed.Z,{value:"current_team",children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:"Current Team Models"})]})}),(0,c.jsx)(ed.Z,{value:"all",children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:"All Available Models"})]})})]})]})]}),(0,c.jsx)("div",{className:"flex items-center justify-between",children:(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(w.Z,{children:"Filter by Public Model Name:"}),(0,c.jsxs)(eH.Z,{className:"w-64",defaultValue:null!=G?G:"all",onValueChange:e=>H("all"===e?"all":e),value:null!=G?G:"all",children:[(0,c.jsx)(ed.Z,{value:"all",children:"All Models"}),(0,c.jsx)(ed.Z,{value:"wildcard",children:"Wildcard Models (*)"}),z.map((e,s)=>(0,c.jsx)(ed.Z,{value:e,children:e},s))]})]}),(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(w.Z,{children:"Filter by Model Access Group:"}),(0,c.jsxs)(eH.Z,{className:"w-64",defaultValue:"all",value:null!=eG?eG:"all",onValueChange:e=>eJ("all"===e?null:e),children:[(0,c.jsx)(ed.Z,{value:"all",children:"All Model Access Groups"}),K.map((e,s)=>(0,c.jsx)(ed.Z,{value:e,children:e},s))]})]})]})}),(0,c.jsx)("div",{className:"flex justify-between items-center",children:(0,c.jsxs)(w.Z,{className:"text-sm text-gray-700",children:["Showing"," ",r&&r.data.length>0?r.data.filter(e=>{var s,t,l,a;let r="all"===G||e.model_name===G||!G,i="all"===eG||(null===(s=e.model_info.access_groups)||void 0===s?void 0:s.includes(eG))||!eG,n=!0;return"current_team"===e4&&(n="personal"===e0?(null===(t=e.model_info)||void 0===t?void 0:t.direct_access)===!0:(null===(a=e.model_info)||void 0===a?void 0:null===(l=a.access_via_team_ids)||void 0===l?void 0:l.includes(e0))===!0),r&&i&&n}).length:0," ","results"]})})]})}),(0,c.jsx)(tq.C,{columns:tU(l,a,o,eD,eU,sH,e=>{R(e),D(!0)},sc,eR,e9,se),data:r.data.filter(e=>{var s,t,l,a;let r="all"===G||e.model_name===G||!G||"wildcard"===G&&e.model_name.includes("*"),i="all"===eG||(null===(s=e.model_info.access_groups)||void 0===s?void 0:s.includes(eG))||!eG,n=!0;return"current_team"===e4&&(n="personal"===e0?(null===(t=e.model_info)||void 0===t?void 0:t.direct_access)===!0:(null===(a=e.model_info)||void 0===a?void 0:null===(l=a.access_via_team_ids)||void 0===l?void 0:l.includes(e0))===!0),r&&i&&n}),isLoading:!1,table:st})]})]})})}),(0,c.jsx)(eQ.Z,{className:"h-full",children:(0,c.jsx)(tR,{form:u,handleOk:()=>{console.log("\uD83D\uDE80 handleOk called from model dashboard!"),console.log("Current form values:",u.getFieldsValue()),u.validateFields().then(e=>{console.log("✅ Validation passed, submitting:",e),sM(e,s,u,sc)}).catch(e=>{var s;console.error("❌ Validation failed:",e),console.error("Form errors:",e.errorFields);let t=(null===(s=e.errorFields)||void 0===s?void 0:s.map(e=>"".concat(e.name.join("."),": ").concat(e.errors.join(", "))).join(" | "))||"Unknown validation error";P.ZP.error("Please fill in the following required fields: ".concat(t))})},selectedProvider:C,setSelectedProvider:A,providerModels:b,setProviderModelsFn:e=>{let s=(0,sL.bK)(e,h);N(s),console.log("providerModels: ".concat(s))},getPlaceholder:sL.ph,uploadProps:sn,showAdvancedSettings:eL,setShowAdvancedSettings:eO,teams:m,credentials:eA,accessToken:s,userRole:l,premiumUser:o})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(sG,{accessToken:s,uploadProps:sn,credentialList:eA,fetchCredentials:si})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(t7,{accessToken:s,userRole:l,userID:a,modelData:r})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(tG,{accessToken:s,modelData:r,all_models_on_proxy:sm,getDisplayModelName:sH,setSelectedModelId:eD})}),(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)(v.Z,{numItems:4,className:"mt-2 mb-2",children:[(0,c.jsx)(f.Z,{children:(0,c.jsx)(sY,{value:ec,className:"mr-2",onValueChange:e=>{eu(e),sr(G,e.from,e.to)}})}),(0,c.jsxs)(f.Z,{className:"ml-2",children:[(0,c.jsx)(w.Z,{children:"Select Model Group"}),(0,c.jsx)(eH.Z,{defaultValue:G||z[0],value:G||z[0],children:z.map((e,s)=>(0,c.jsx)(ed.Z,{value:e,onClick:()=>sr(e,ec.from,ec.to),children:e},s))})]}),(0,c.jsx)(f.Z,{children:(0,c.jsx)(sQ.Z,{trigger:"click",content:sg,overlayStyle:{width:"20vw"},children:(0,c.jsx)(_.Z,{icon:so.Z,size:"md",variant:"secondary",className:"mt-4 ml-2",style:{border:"none"},onClick:()=>eZ(!0)})})})]}),(0,c.jsxs)(v.Z,{numItems:2,children:[(0,c.jsx)(f.Z,{children:(0,c.jsx)(W.Z,{className:"mr-2 max-h-[400px] min-h-[400px]",children:(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{variant:"line",defaultValue:"1",children:[(0,c.jsx)(eY.Z,{value:"1",children:"Avg. Latency per Token"}),(0,c.jsx)(eY.Z,{value:"2",children:"Time to first token"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)("p",{className:"text-gray-500 italic",children:[" ","(seconds/token)"]}),(0,c.jsx)(w.Z,{className:"text-gray-500 italic mt-1 mb-1",children:"average Latency for successfull requests divided by the total tokens"}),J&&$&&(0,c.jsx)(sW.Z,{title:"Model Latency",className:"h-72",data:J,showLegend:!1,index:"date",categories:$,connectNulls:!0,customTooltip:sZ})]}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(s0,{modelMetrics:X,modelMetricsCategories:es,customTooltip:sZ,premiumUser:o})})]})]})})}),(0,c.jsx)(f.Z,{children:(0,c.jsx)(W.Z,{className:"ml-2 max-h-[400px] min-h-[400px]  overflow-y-auto",children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Deployment"}),(0,c.jsx)(sb.Z,{children:"Success Responses"}),(0,c.jsxs)(sb.Z,{children:["Slow Responses"," ",(0,c.jsx)("p",{children:"Success Responses taking 600+s"})]})]})}),(0,c.jsx)(sv.Z,{children:en.map((e,s)=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:e.api_base}),(0,c.jsx)(s_.Z,{children:e.total_count}),(0,c.jsx)(s_.Z,{children:e.slow_count})]},s))})]})})})]}),(0,c.jsx)(v.Z,{numItems:1,className:"gap-2 w-full mt-2",children:(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)(k.Z,{children:["All Exceptions for ",G]}),(0,c.jsx)(s$.Z,{className:"h-60",data:el,index:"model",categories:er,stack:!0,yAxisWidth:30})]})}),(0,c.jsxs)(v.Z,{numItems:1,className:"gap-2 w-full mt-2",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)(k.Z,{children:["All Up Rate Limit Errors (429) for ",G]}),(0,c.jsxs)(v.Z,{numItems:1,children:[(0,c.jsxs)(f.Z,{children:[(0,c.jsxs)(sT.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Num Rate Limit Errors"," ",ev.sum_num_rate_limit_exceptions]}),(0,c.jsx)(s$.Z,{className:"h-40",data:ev.daily_data,index:"date",colors:["rose"],categories:["num_rate_limit_exceptions"],onValueChange:e=>console.log(e)})]}),(0,c.jsx)(f.Z,{})]})]}),o?(0,c.jsx)(c.Fragment,{children:ey.map((e,s)=>(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:e.api_base?e.api_base:"Unknown API Base"}),(0,c.jsx)(v.Z,{numItems:1,children:(0,c.jsxs)(f.Z,{children:[(0,c.jsxs)(sT.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Num Rate Limit Errors (429)"," ",e.sum_num_rate_limit_exceptions]}),(0,c.jsx)(s$.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["rose"],categories:["num_rate_limit_exceptions"],onValueChange:e=>console.log(e)})]})})]},s))}):(0,c.jsx)(c.Fragment,{children:ey&&ey.length>0&&ey.slice(0,1).map((e,s)=>(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"✨ Rate Limit Errors by Deployment"}),(0,c.jsx)("p",{className:"mb-2 text-gray-500 italic text-[12px]",children:"Upgrade to see exceptions for all deployments"}),(0,c.jsx)(_.Z,{variant:"primary",className:"mb-2",children:(0,c.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"Get Free Trial"})}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:e.api_base}),(0,c.jsx)(v.Z,{numItems:1,children:(0,c.jsxs)(f.Z,{children:[(0,c.jsxs)(sT.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Num Rate Limit Errors"," ",e.sum_num_rate_limit_exceptions]}),(0,c.jsx)(s$.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["rose"],categories:["num_rate_limit_exceptions"],onValueChange:e=>console.log(e)})]})})]})]},s))})]})]}),(0,c.jsxs)(eQ.Z,{children:[(0,c.jsx)("div",{className:"flex items-center gap-4 mb-6",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(w.Z,{children:"Retry Policy Scope:"}),(0,c.jsxs)(eH.Z,{className:"ml-2 w-48",defaultValue:"global",value:"global"===G?"global":G||z[0],onValueChange:e=>H(e),children:[(0,c.jsx)(ed.Z,{value:"global",children:"Global Default"}),z.map((e,s)=>(0,c.jsx)(ed.Z,{value:e,onClick:()=>H(e),children:e},s))]})]})}),"global"===G?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(k.Z,{children:"Global Retry Policy"}),(0,c.jsx)(w.Z,{className:"mb-6",children:"Default retry settings applied to all model groups unless overridden"})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(k.Z,{children:["Retry Policy for ",G]}),(0,c.jsx)(w.Z,{className:"mb-6",children:"Model-specific retry settings. Falls back to global defaults if not set."})]}),t9&&(0,c.jsx)("table",{children:(0,c.jsx)("tbody",{children:Object.entries(t9).map((e,s)=>{var t,l,a,r;let i,[n,o]=e;if("global"===G)i=null!==(t=null==ep?void 0:ep[o])&&void 0!==t?t:ej;else{let e=null==ex?void 0:null===(l=ex[G])||void 0===l?void 0:l[o];i=null!=e?e:null!==(a=null==ep?void 0:ep[o])&&void 0!==a?a:ej}return(0,c.jsxs)("tr",{className:"flex justify-between items-center mt-2",children:[(0,c.jsxs)("td",{children:[(0,c.jsx)(w.Z,{children:n}),"global"!==G&&(0,c.jsxs)(w.Z,{className:"text-xs text-gray-500 ml-2",children:["(Global: ",null!==(r=null==ep?void 0:ep[o])&&void 0!==r?r:ej,")"]})]}),(0,c.jsx)("td",{children:(0,c.jsx)(q.Z,{className:"ml-5",value:i,min:0,step:1,onChange:e=>{"global"===G?eg(s=>null==e?s:{...null!=s?s:{},[o]:e}):eh(s=>{var t;let l=null!==(t=null==s?void 0:s[G])&&void 0!==t?t:{};return{...null!=s?s:{},[G]:{...l,[o]:e}}})}})})]},s)})})}),(0,c.jsx)(_.Z,{className:"mt-6 mr-8",onClick:sd,children:"Save"})]})]})]})})})})},ls=e=>{let{visible:s,possibleUIRoles:t,onCancel:l,user:a,onSubmit:r}=e,[i,n]=(0,d.useState)(a),[o]=I.Z.useForm();(0,d.useEffect)(()=>{o.resetFields()},[a]);let m=async()=>{o.resetFields(),l()},u=async e=>{r(e),o.resetFields(),l()};return a?(0,c.jsx)(A.Z,{visible:s,onCancel:m,footer:null,title:"Edit User "+a.user_id,width:1e3,children:(0,c.jsx)(I.Z,{form:o,onFinish:u,initialValues:a,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{className:"mt-8",label:"User Email",tooltip:"Email of the User",name:"user_email",children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"user_id",name:"user_id",hidden:!0,children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"User Role",name:"user_role",children:(0,c.jsx)(C.default,{children:t&&Object.entries(t).map(e=>{let[s,{ui_label:t,description:l}]=e;return(0,c.jsx)(ed.Z,{value:s,title:t,children:(0,c.jsxs)("div",{className:"flex",children:[t," ",(0,c.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:l})]})},s)})})}),(0,c.jsx)(I.Z.Item,{label:"Spend (USD)",name:"spend",tooltip:"(float) - Spend of all LLM calls completed by this user",help:"Across all keys (including keys with team_id).",children:(0,c.jsx)(q.Z,{min:0,step:.01})}),(0,c.jsx)(I.Z.Item,{label:"User Budget (USD)",name:"max_budget",tooltip:"(float) - Maximum budget of this user",help:"Maximum budget of this user.",children:(0,c.jsx)(M,{min:0,step:.01})}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Save"})})]})})}):null},lt=t(16853);function ll(e){let{userData:s,onCancel:t,onSubmit:l,teams:a,accessToken:r,userID:i,userRole:n,userModels:o,possibleUIRoles:m,isBulkEdit:u=!1}=e,[x]=I.Z.useForm();return d.useEffect(()=>{var e,t,l,a,r;x.setFieldsValue({user_id:s.user_id,user_email:null===(e=s.user_info)||void 0===e?void 0:e.user_email,user_role:null===(t=s.user_info)||void 0===t?void 0:t.user_role,models:(null===(l=s.user_info)||void 0===l?void 0:l.models)||[],max_budget:null===(a=s.user_info)||void 0===a?void 0:a.max_budget,metadata:(null===(r=s.user_info)||void 0===r?void 0:r.metadata)?JSON.stringify(s.user_info.metadata,null,2):void 0})},[s,x]),(0,c.jsxs)(I.Z,{form:x,onFinish:e=>{if(e.metadata&&"string"==typeof e.metadata)try{e.metadata=JSON.parse(e.metadata)}catch(e){console.error("Error parsing metadata JSON:",e);return}l(e)},layout:"vertical",children:[!u&&(0,c.jsx)(I.Z.Item,{label:"User ID",name:"user_id",children:(0,c.jsx)(y.Z,{disabled:!0})}),!u&&(0,c.jsx)(I.Z.Item,{label:"Email",name:"user_email",children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Global Proxy Role"," ",(0,c.jsx)(z.Z,{title:"This is the role that the user will globally on the proxy. This role is independent of any team/org specific roles.",children:(0,c.jsx)(U.Z,{})})]}),name:"user_role",children:(0,c.jsx)(C.default,{children:m&&Object.entries(m).map(e=>{let[s,{ui_label:t,description:l}]=e;return(0,c.jsx)(ed.Z,{value:s,title:t,children:(0,c.jsxs)("div",{className:"flex",children:[t," ",(0,c.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:l})]})},s)})})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Personal Models"," ",(0,c.jsx)(z.Z,{title:"Select which models this user can access outside of team-scope. Choose 'All Proxy Models' to grant access to all models available on the proxy.",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"models",children:(0,c.jsxs)(C.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},disabled:!eE.ZL.includes(n||""),children:[(0,c.jsx)(C.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),(0,c.jsx)(C.default.Option,{value:"no-default-models",children:"No Default Models"},"no-default-models"),o.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:F(e)},e))]})}),(0,c.jsx)(I.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,c.jsx)(q.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{label:"Metadata",name:"metadata",children:(0,c.jsx)(lt.Z,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,c.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,c.jsx)(_.Z,{variant:"secondary",type:"button",onClick:t,children:"Cancel"}),(0,c.jsx)(_.Z,{type:"submit",children:"Save Changes"})]})]})}let{Text:la,Title:lr}=em.default;var li=e=>{let{visible:s,onCancel:t,selectedUsers:l,possibleUIRoles:a,accessToken:r,onSuccess:i,teams:n,userRole:o,userModels:m,allowAllUsers:u=!1}=e,[x,h]=(0,d.useState)(!1),[p,j]=(0,d.useState)([]),[f,v]=(0,d.useState)(null),[_,y]=(0,d.useState)(!1),[b,N]=(0,d.useState)(!1),Z=()=>{j([]),v(null),y(!1),N(!1),t()},w=d.useMemo(()=>({user_id:"bulk_edit",user_info:{user_email:"",user_role:"",teams:[],models:[],max_budget:null,spend:0,metadata:{},created_at:null,updated_at:null},keys:[],teams:n||[]}),[n,s]),k=async e=>{if(console.log("formValues",e),!r){P.ZP.error("Access token not found");return}h(!0);try{let s=l.map(e=>e.user_id),a={};e.user_role&&""!==e.user_role&&(a.user_role=e.user_role),null!==e.max_budget&&void 0!==e.max_budget&&(a.max_budget=e.max_budget),e.models&&e.models.length>0&&(a.models=e.models),e.metadata&&Object.keys(e.metadata).length>0&&(a.metadata=e.metadata);let n=Object.keys(a).length>0,o=_&&p.length>0;if(!n&&!o){P.ZP.error("Please modify at least one field or select teams to add users to");return}let c=[];if(n){if(b){let e=await (0,g.userBulkUpdateUserCall)(r,a,void 0,!0);c.push("Updated all users (".concat(e.total_requested," total)"))}else await (0,g.userBulkUpdateUserCall)(r,a,s),c.push("Updated ".concat(s.length," user(s)"))}if(o){let e=[];for(let s of p)try{let t=null;b?t=null:l.map(e=>({user_id:e.user_id,role:"user",user_email:e.user_email||null}));let a=await (0,g.teamBulkMemberAddCall)(r,s,t||null,f||void 0,b);console.log("result",a),e.push({teamId:s,success:!0,successfulAdditions:a.successful_additions,failedAdditions:a.failed_additions})}catch(t){console.error("Failed to add users to team ".concat(s,":"),t),e.push({teamId:s,success:!1,error:t})}let s=e.filter(e=>e.success),t=e.filter(e=>!e.success);if(s.length>0){let e=s.reduce((e,s)=>e+s.successfulAdditions,0);c.push("Added users to ".concat(s.length," team(s) (").concat(e," total additions)"))}t.length>0&&P.ZP.warning("Failed to add users to ".concat(t.length," team(s)"))}c.length>0&&P.ZP.success(c.join(". ")),j([]),v(null),y(!1),N(!1),i(),t()}catch(e){console.error("Bulk operation failed:",e),P.ZP.error("Failed to perform bulk operations")}finally{h(!1)}};return(0,c.jsxs)(A.Z,{visible:s,onCancel:Z,footer:null,title:b?"Bulk Edit All Users":"Bulk Edit ".concat(l.length," User(s)"),width:800,children:[u&&(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)(s2.Z,{checked:b,onChange:e=>N(e.target.checked),children:(0,c.jsx)(la,{strong:!0,children:"Update ALL users in the system"})}),b&&(0,c.jsx)("div",{style:{marginTop:8},children:(0,c.jsx)(la,{type:"warning",style:{fontSize:"12px"},children:"⚠️ This will apply changes to ALL users in the system, not just the selected ones."})})]}),!b&&(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)(lr,{level:5,children:["Selected Users (",l.length,"):"]}),(0,c.jsx)(eh.Z,{size:"small",bordered:!0,dataSource:l,pagination:!1,scroll:{y:200},rowKey:"user_id",columns:[{title:"User ID",dataIndex:"user_id",key:"user_id",width:"30%",render:e=>(0,c.jsx)(la,{strong:!0,style:{fontSize:"12px"},children:e.length>20?"".concat(e.slice(0,20),"..."):e})},{title:"Email",dataIndex:"user_email",key:"user_email",width:"25%",render:e=>(0,c.jsx)(la,{type:"secondary",style:{fontSize:"12px"},children:e||"No email"})},{title:"Current Role",dataIndex:"user_role",key:"user_role",width:"25%",render:e=>{var s;return(0,c.jsx)(la,{style:{fontSize:"12px"},children:(null==a?void 0:null===(s=a[e])||void 0===s?void 0:s.ui_label)||e})}},{title:"Budget",dataIndex:"max_budget",key:"max_budget",width:"20%",render:e=>(0,c.jsx)(la,{style:{fontSize:"12px"},children:null!==e?"$".concat(e):"Unlimited"})}]})]}),(0,c.jsx)(Y.Z,{}),(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsxs)(la,{children:[(0,c.jsx)("strong",{children:"Instructions:"})," Fill in the fields below with the values you want to apply to all selected users. You can bulk edit: role, budget, models, and metadata. You can also add users to teams."]})}),(0,c.jsx)(th.Z,{title:"Team Management",size:"small",className:"mb-4",style:{backgroundColor:"#fafafa"},children:(0,c.jsxs)(tY.Z,{direction:"vertical",style:{width:"100%"},children:[(0,c.jsx)(s2.Z,{checked:_,onChange:e=>y(e.target.checked),children:"Add selected users to teams"}),_&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(la,{strong:!0,children:"Select Teams:"}),(0,c.jsx)(C.default,{mode:"multiple",placeholder:"Select teams to add users to",value:p,onChange:j,style:{width:"100%",marginTop:8},options:(null==n?void 0:n.map(e=>({label:e.team_alias||e.team_id,value:e.team_id})))||[]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(la,{strong:!0,children:"Team Budget (Optional):"}),(0,c.jsx)(q.Z,{placeholder:"Max budget per user in team",value:f,onChange:e=>v(e),style:{width:"100%",marginTop:8},min:0,step:.01,precision:2}),(0,c.jsx)(la,{type:"secondary",style:{fontSize:"12px"},children:"Leave empty for unlimited budget within team limits"})]}),(0,c.jsx)(la,{type:"secondary",style:{fontSize:"12px"},children:'Users will be added with "user" role by default. All users will be added to each selected team.'})]})]})}),(0,c.jsx)(ll,{userData:w,onCancel:Z,onSubmit:k,teams:n,accessToken:r,userID:"bulk_edit",userRole:o,userModels:m,possibleUIRoles:a,isBulkEdit:!0}),x&&(0,c.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,c.jsxs)(la,{children:["Updating ",b?"all users":l.length," user(s)..."]})})]})};let ln=(e,s,t,l,a,r)=>{let i=[{header:"User ID",accessorKey:"user_id",cell:e=>{let{row:s}=e;return(0,c.jsx)(z.Z,{title:s.original.user_id,children:(0,c.jsx)("span",{className:"text-xs",children:s.original.user_id?"".concat(s.original.user_id.slice(0,7),"..."):"-"})})}},{header:"User Email",accessorKey:"user_email",cell:e=>{let{row:s}=e;return(0,c.jsx)("span",{className:"text-xs",children:s.original.user_email||"-"})}},{header:"Global Proxy Role",accessorKey:"user_role",cell:s=>{var t;let{row:l}=s;return(0,c.jsx)("span",{className:"text-xs",children:(null==e?void 0:null===(t=e[l.original.user_role])||void 0===t?void 0:t.ui_label)||"-"})}},{header:"User Spend ($ USD)",accessorKey:"spend",cell:e=>{let{row:s}=e;return(0,c.jsx)("span",{className:"text-xs",children:s.original.spend?eD(s.original.spend,4):"-"})}},{header:"User Max Budget ($ USD)",accessorKey:"max_budget",cell:e=>{let{row:s}=e;return(0,c.jsx)("span",{className:"text-xs",children:null!==s.original.max_budget?s.original.max_budget:"Unlimited"})}},{header:()=>(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("span",{children:"SSO ID"}),(0,c.jsx)(z.Z,{title:"SSO ID is the ID of the user in the SSO provider. If the user is not using SSO, this will be null.",children:(0,c.jsx)(tz.Z,{className:"w-4 h-4"})})]}),accessorKey:"sso_user_id",cell:e=>{let{row:s}=e;return(0,c.jsx)("span",{className:"text-xs",children:null!==s.original.sso_user_id?s.original.sso_user_id:"-"})}},{header:"API Keys",accessorKey:"key_count",cell:e=>{let{row:s}=e;return(0,c.jsx)(v.Z,{numItems:2,children:s.original.key_count>0?(0,c.jsxs)(eJ.Z,{size:"xs",color:"indigo",children:[s.original.key_count," Keys"]}):(0,c.jsx)(eJ.Z,{size:"xs",color:"gray",children:"No Keys"})})}},{header:"Created At",accessorKey:"created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e;return(0,c.jsx)("span",{className:"text-xs",children:s.original.created_at?new Date(s.original.created_at).toLocaleDateString():"-"})}},{header:"Updated At",accessorKey:"updated_at",sortingFn:"datetime",cell:e=>{let{row:s}=e;return(0,c.jsx)("span",{className:"text-xs",children:s.original.updated_at?new Date(s.original.updated_at).toLocaleDateString():"-"})}},{id:"actions",header:"",cell:e=>{let{row:s}=e;return(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(z.Z,{title:"Edit user details",zIndex:9999,children:(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>a(s.original.user_id,!0)})}),(0,c.jsx)(z.Z,{title:"Delete user",zIndex:9999,children:(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>t(s.original.user_id)})}),(0,c.jsx)(z.Z,{title:"Reset Password",zIndex:9999,children:(0,c.jsx)(sj.Z,{icon:e1.Z,size:"sm",onClick:()=>l(s.original.user_id)})})]})}}];if(r){let{onSelectUser:e,onSelectAll:s,isUserSelected:t,isAllSelected:l,isIndeterminate:a}=r;return[{id:"select",header:()=>(0,c.jsx)(s2.Z,{indeterminate:a,checked:l,onChange:e=>s(e.target.checked),onClick:e=>e.stopPropagation()}),cell:s=>{let{row:l}=s;return(0,c.jsx)(s2.Z,{checked:t(l.original),onChange:s=>e(l.original,s.target.checked),onClick:e=>e.stopPropagation()})}},...i]}return i};function lo(e){var s,t,l,a,r,i,n,o,m,u,x,h,p,j,f,y,b,N,Z,S,C,I,A,E,L,O,M;let{userId:D,onClose:F,accessToken:R,userRole:q,onDelete:U,possibleUIRoles:z,initialTab:V=0,startInEditMode:K=!1}=e,[B,G]=(0,d.useState)(null),[H,J]=(0,d.useState)(!1),[Y,$]=(0,d.useState)(!0),[Q,X]=(0,d.useState)(K),[es,et]=(0,d.useState)([]),[el,ea]=(0,d.useState)(!1),[er,ei]=(0,d.useState)(null),[en,eo]=(0,d.useState)(null),[ec,ed]=(0,d.useState)(V),[em,ex]=(0,d.useState)({});d.useEffect(()=>{eo((0,g.getProxyBaseUrl)())},[]),d.useEffect(()=>{console.log("userId: ".concat(D,", userRole: ").concat(q,", accessToken: ").concat(R)),(async()=>{try{if(!R)return;let e=await (0,g.userInfoCall)(R,D,q||"",!1,null,null,!0);G(e);let s=(await (0,g.modelAvailableCall)(R,D,q||"")).data.map(e=>e.id);et(s)}catch(e){console.error("Error fetching user data:",e),P.ZP.error("Failed to fetch user data")}finally{$(!1)}})()},[R,D,q]);let eh=async()=>{if(!R){P.ZP.error("Access token not found");return}try{P.ZP.success("Generating password reset link...");let e=await (0,g.invitationCreateCall)(R,D);ei(e),ea(!0)}catch(e){P.ZP.error("Failed to generate password reset link")}},ep=async()=>{try{if(!R)return;await (0,g.userDeleteCall)(R,[D]),P.ZP.success("User deleted successfully"),U&&U(),F()}catch(e){console.error("Error deleting user:",e),P.ZP.error("Failed to delete user")}},eg=async e=>{try{if(!R||!B)return;await (0,g.userUpdateUserCall)(R,e,null),G({...B,user_info:{...B.user_info,user_email:e.user_email,models:e.models,max_budget:e.max_budget,metadata:e.metadata}}),P.ZP.success("User updated successfully"),X(!1)}catch(e){console.error("Error updating user:",e),P.ZP.error("Failed to update user")}};if(Y)return(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",onClick:F,className:"mb-4",children:"Back to Users"}),(0,c.jsx)(w.Z,{children:"Loading user data..."})]});if(!B)return(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",onClick:F,className:"mb-4",children:"Back to Users"}),(0,c.jsx)(w.Z,{children:"User not found"})]});let ej=async(e,s)=>{await eF(e)&&(ex(e=>({...e,[s]:!0})),setTimeout(()=>{ex(e=>({...e,[s]:!1}))},2e3))};return(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",onClick:F,className:"mb-4",children:"Back to Users"}),(0,c.jsx)(k.Z,{children:(null===(s=B.user_info)||void 0===s?void 0:s.user_email)||"User"}),(0,c.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,c.jsx)(w.Z,{className:"text-gray-500 font-mono",children:B.user_id}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:em["user-id"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>ej(B.user_id,"user-id"),className:"left-2 z-10 transition-all duration-200 ".concat(em["user-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),q&&eE.LQ.includes(q)&&(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(_.Z,{icon:e1.Z,variant:"secondary",onClick:eh,className:"flex items-center",children:"Reset Password"}),(0,c.jsx)(_.Z,{icon:ee.Z,variant:"secondary",onClick:()=>J(!0),className:"flex items-center",children:"Delete User"})]})]}),H&&(0,c.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,c.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,c.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,c.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,c.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,c.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,c.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,c.jsx)("div",{className:"sm:flex sm:items-start",children:(0,c.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,c.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete User"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this user?"})})]})})}),(0,c.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,c.jsx)(_.Z,{onClick:ep,color:"red",className:"ml-2",children:"Delete"}),(0,c.jsx)(_.Z,{onClick:()=>J(!1),children:"Cancel"})]})]})]})}),(0,c.jsxs)(eW.Z,{defaultIndex:ec,onIndexChange:ed,children:[(0,c.jsxs)(e$.Z,{className:"mb-4",children:[(0,c.jsx)(eY.Z,{children:"Overview"}),(0,c.jsx)(eY.Z,{children:"Details"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Spend"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)(k.Z,{children:["$",eD((null===(t=B.user_info)||void 0===t?void 0:t.spend)||0,4)]}),(0,c.jsxs)(w.Z,{children:["of"," ",(null===(l=B.user_info)||void 0===l?void 0:l.max_budget)!==null?"$".concat(eD(B.user_info.max_budget,4)):"Unlimited"]})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Teams"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsxs)(w.Z,{children:[(null===(a=B.teams)||void 0===a?void 0:a.length)||0," teams"]})})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"API Keys"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsxs)(w.Z,{children:[(null===(r=B.keys)||void 0===r?void 0:r.length)||0," keys"]})})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Personal Models"}),(0,c.jsx)("div",{className:"mt-2",children:(null===(n=B.user_info)||void 0===n?void 0:null===(i=n.models)||void 0===i?void 0:i.length)&&(null===(m=B.user_info)||void 0===m?void 0:null===(o=m.models)||void 0===o?void 0:o.length)>0?null===(x=B.user_info)||void 0===x?void 0:null===(u=x.models)||void 0===u?void 0:u.map((e,s)=>(0,c.jsx)(w.Z,{children:e},s)):(0,c.jsx)(w.Z,{children:"All proxy models"})})]})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"User Settings"}),!Q&&q&&eE.LQ.includes(q)&&(0,c.jsx)(_.Z,{variant:"light",onClick:()=>X(!0),children:"Edit Settings"})]}),Q&&B?(0,c.jsx)(ll,{userData:B,onCancel:()=>X(!1),onSubmit:eg,teams:B.teams,accessToken:R,userID:D,userRole:q,userModels:es,possibleUIRoles:z}):(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"User ID"}),(0,c.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,c.jsx)(w.Z,{className:"font-mono",children:B.user_id}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:em["user-id"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>ej(B.user_id,"user-id"),className:"left-2 z-10 transition-all duration-200 ".concat(em["user-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Email"}),(0,c.jsx)(w.Z,{children:(null===(h=B.user_info)||void 0===h?void 0:h.user_email)||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Role"}),(0,c.jsx)(w.Z,{children:(null===(p=B.user_info)||void 0===p?void 0:p.user_role)||"Not Set"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Created"}),(0,c.jsx)(w.Z,{children:(null===(j=B.user_info)||void 0===j?void 0:j.created_at)?new Date(B.user_info.created_at).toLocaleString():"Unknown"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Last Updated"}),(0,c.jsx)(w.Z,{children:(null===(f=B.user_info)||void 0===f?void 0:f.updated_at)?new Date(B.user_info.updated_at).toLocaleString():"Unknown"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Teams"}),(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:(null===(y=B.teams)||void 0===y?void 0:y.length)&&(null===(b=B.teams)||void 0===b?void 0:b.length)>0?null===(N=B.teams)||void 0===N?void 0:N.map((e,s)=>(0,c.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:e.team_alias||e.team_id},s)):(0,c.jsx)(w.Z,{children:"No teams"})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Models"}),(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:(null===(S=B.user_info)||void 0===S?void 0:null===(Z=S.models)||void 0===Z?void 0:Z.length)&&(null===(I=B.user_info)||void 0===I?void 0:null===(C=I.models)||void 0===C?void 0:C.length)>0?null===(E=B.user_info)||void 0===E?void 0:null===(A=E.models)||void 0===A?void 0:A.map((e,s)=>(0,c.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:e},s)):(0,c.jsx)(w.Z,{children:"All proxy models"})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"API Keys"}),(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:(null===(L=B.keys)||void 0===L?void 0:L.length)&&(null===(O=B.keys)||void 0===O?void 0:O.length)>0?B.keys.map((e,s)=>(0,c.jsx)("span",{className:"px-2 py-1 bg-green-100 rounded text-xs",children:e.key_alias||e.token},s)):(0,c.jsx)(w.Z,{children:"No API keys"})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Metadata"}),(0,c.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:JSON.stringify((null===(M=B.user_info)||void 0===M?void 0:M.metadata)||{},null,2)})]})]})]})})]})]}),(0,c.jsx)(eu,{isInvitationLinkModalVisible:el,setIsInvitationLinkModalVisible:ea,baseUrl:en||"",invitationLinkData:er,modalType:"resetPassword"})]})}function lc(e){let{data:s=[],columns:t,isLoading:l=!1,onSortChange:a,currentSort:r,accessToken:i,userRole:n,possibleUIRoles:o,handleEdit:m,handleDelete:u,handleResetPassword:x,selectedUsers:h=[],onSelectionChange:p,enableSelection:g=!1}=e,[j,f]=d.useState([{id:(null==r?void 0:r.sortBy)||"created_at",desc:(null==r?void 0:r.sortOrder)==="desc"}]),[v,_]=d.useState(null),[y,b]=d.useState(!1),N=function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_(e),b(s)},Z=(e,s)=>{p&&(s?p([...h,e]):p(h.filter(s=>s.user_id!==e.user_id)))},w=e=>{p&&(e?p(s):p([]))},k=e=>h.some(s=>s.user_id===e.user_id),S=s.length>0&&h.length===s.length,C=h.length>0&&h.length<s.length,I=d.useMemo(()=>o?ln(o,m,u,x,N,g?{selectedUsers:h,onSelectUser:Z,onSelectAll:w,isUserSelected:k,isAllSelected:S,isIndeterminate:C}:void 0):t,[o,m,u,x,N,t,g,h,S,C]),P=(0,sp.b7)({data:s,columns:I,state:{sorting:j},onSortingChange:e=>{if(f(e),e.length>0){let s=e[0],t=s.id,l=s.desc?"desc":"asc";null==a||a(t,l)}},getCoreRowModel:(0,sg.sC)(),getSortedRowModel:(0,sg.tj)(),enableSorting:!0});return(d.useEffect(()=>{r&&f([{id:r.sortBy,desc:"desc"===r.sortOrder}])},[r]),v)?(0,c.jsx)(lo,{userId:v,onClose:()=>{_(null),b(!1)},accessToken:i,userRole:n,possibleUIRoles:o,initialTab:y?1:0,startInEditMode:y}):(0,c.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,c.jsx)("div",{className:"overflow-x-auto",children:(0,c.jsxs)(t6.iA,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,c.jsx)(t6.ss,{children:P.getHeaderGroups().map(e=>(0,c.jsx)(t6.SC,{children:e.headers.map(e=>(0,c.jsx)(t6.xs,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,c.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,sp.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,c.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,c.jsx)(sk.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,c.jsx)(sZ.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,c.jsx)(sS.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,c.jsx)(t6.RM,{children:l?(0,c.jsx)(t6.SC,{children:(0,c.jsx)(t6.pj,{colSpan:I.length,className:"h-8 text-center",children:(0,c.jsx)("div",{className:"text-center text-gray-500",children:(0,c.jsx)("p",{children:"\uD83D\uDE85 Loading users..."})})})}):s.length>0?P.getRowModel().rows.map(e=>(0,c.jsx)(t6.SC,{className:"h-8",children:e.getVisibleCells().map(e=>(0,c.jsx)(t6.pj,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:()=>{"user_id"===e.column.id&&N(e.getValue(),!1)},style:{cursor:"user_id"===e.column.id?"pointer":"default",color:"user_id"===e.column.id?"#3b82f6":"inherit"},children:(0,sp.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,c.jsx)(t6.SC,{children:(0,c.jsx)(t6.pj,{colSpan:I.length,className:"h-8 text-center",children:(0,c.jsx)("div",{className:"text-center text-gray-500",children:(0,c.jsx)("p",{children:"No users found"})})})})})]})})})}var ld=t(67982),lm=t(87908),lu=e=>{var s;let{accessToken:t,possibleUIRoles:l,userID:a,userRole:r}=e,[i,n]=(0,d.useState)(!0),[o,m]=(0,d.useState)(null),[u,x]=(0,d.useState)(!1),[h,p]=(0,d.useState)({}),[j,f]=(0,d.useState)(!1),[v,b]=(0,d.useState)([]),{Paragraph:N}=em.default,{Option:Z}=C.default;(0,d.useEffect)(()=>{(async()=>{if(!t){n(!1);return}try{let e=await (0,g.getInternalUserSettings)(t);if(m(e),p(e.values||{}),t)try{let e=await (0,g.modelAvailableCall)(t,a,r);if(e&&e.data){let s=e.data.map(e=>e.id);b(s)}}catch(e){console.error("Error fetching available models:",e)}}catch(e){console.error("Error fetching SSO settings:",e),P.ZP.error("Failed to fetch SSO settings")}finally{n(!1)}})()},[t]);let S=async()=>{if(t){f(!0);try{let e=Object.entries(h).reduce((e,s)=>{let[t,l]=s;return e[t]=""===l?null:l,e},{}),s=await (0,g.updateInternalUserSettings)(t,e);m({...o,values:s.settings}),x(!1)}catch(e){console.error("Error updating SSO settings:",e),P.ZP.error("Failed to update settings: "+e)}finally{f(!1)}}},I=(e,s)=>{p(t=>({...t,[e]:s}))},A=e=>e&&Array.isArray(e)?e.map(e=>"string"==typeof e?{team_id:e,user_role:"user"}:"object"==typeof e&&e.team_id?{team_id:e.team_id,max_budget_in_team:e.max_budget_in_team,user_role:e.user_role||"user"}:{team_id:"",user_role:"user"}):[],E=e=>{let s=A(e),t=(e,t,l)=>{let a=[...s];a[e]={...a[e],[t]:l},I("teams",a)},l=e=>{I("teams",s.filter((s,t)=>t!==e))};return(0,c.jsxs)("div",{className:"space-y-3",children:[s.map((e,s)=>(0,c.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,c.jsxs)(w.Z,{className:"font-medium",children:["Team ",s+1]}),(0,c.jsx)(_.Z,{size:"sm",variant:"secondary",icon:ef.Z,onClick:()=>l(s),className:"text-red-500 hover:text-red-700",children:"Remove"})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"text-sm font-medium mb-1",children:"Team ID"}),(0,c.jsx)(y.Z,{value:e.team_id,onChange:e=>t(s,"team_id",e.target.value),placeholder:"Enter team ID"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"text-sm font-medium mb-1",children:"Max Budget in Team"}),(0,c.jsx)(q.Z,{style:{width:"100%"},value:e.max_budget_in_team,onChange:e=>t(s,"max_budget_in_team",e),placeholder:"Optional",min:0,step:.01,precision:2})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"text-sm font-medium mb-1",children:"User Role"}),(0,c.jsxs)(C.default,{style:{width:"100%"},value:e.user_role,onChange:e=>t(s,"user_role",e),children:[(0,c.jsx)(Z,{value:"user",children:"User"}),(0,c.jsx)(Z,{value:"admin",children:"Admin"})]})]})]})]},s)),(0,c.jsx)(_.Z,{variant:"secondary",icon:tc.Z,onClick:()=>{I("teams",[...s,{team_id:"",user_role:"user"}])},className:"w-full",children:"Add Team"})]})},T=(e,s,t)=>{var a;let r=s.type;if("teams"===e)return(0,c.jsx)("div",{className:"mt-2",children:E(h[e]||[])});if("user_role"===e&&l)return(0,c.jsx)(C.default,{style:{width:"100%"},value:h[e]||"",onChange:s=>I(e,s),className:"mt-2",children:Object.entries(l).filter(e=>{let[s]=e;return s.includes("internal_user")}).map(e=>{let[s,{ui_label:t,description:l}]=e;return(0,c.jsx)(Z,{value:s,children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("span",{children:t}),(0,c.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:l})]})},s)})});if("budget_duration"===e)return(0,c.jsx)(eO,{value:h[e]||null,onChange:s=>I(e,s),className:"mt-2"});if("boolean"===r)return(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)(tn.Z,{checked:!!h[e],onChange:s=>I(e,s)})});if("array"===r&&(null===(a=s.items)||void 0===a?void 0:a.enum))return(0,c.jsx)(C.default,{mode:"multiple",style:{width:"100%"},value:h[e]||[],onChange:s=>I(e,s),className:"mt-2",children:s.items.enum.map(e=>(0,c.jsx)(Z,{value:e,children:e},e))});if("models"===e)return(0,c.jsxs)(C.default,{mode:"multiple",style:{width:"100%"},value:h[e]||[],onChange:s=>I(e,s),className:"mt-2",children:[(0,c.jsx)(Z,{value:"no-default-models",children:"No Default Models"}),v.map(e=>(0,c.jsx)(Z,{value:e,children:F(e)},e))]});if("string"===r&&s.enum)return(0,c.jsx)(C.default,{style:{width:"100%"},value:h[e]||"",onChange:s=>I(e,s),className:"mt-2",children:s.enum.map(e=>(0,c.jsx)(Z,{value:e,children:e},e))});else return(0,c.jsx)(y.Z,{value:void 0!==h[e]?String(h[e]):"",onChange:s=>I(e,s.target.value),placeholder:s.description||"",className:"mt-2"})},L=(e,s)=>{if(null==s)return(0,c.jsx)("span",{className:"text-gray-400",children:"Not set"});if("teams"===e&&Array.isArray(s)){if(0===s.length)return(0,c.jsx)("span",{className:"text-gray-400",children:"No teams assigned"});let e=A(s);return(0,c.jsx)("div",{className:"space-y-2 mt-1",children:e.map((e,s)=>(0,c.jsx)("div",{className:"border rounded-lg p-3 bg-white",children:(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"font-medium text-gray-600",children:"Team ID:"}),(0,c.jsx)("p",{className:"text-gray-900",children:e.team_id||"Not specified"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"font-medium text-gray-600",children:"Max Budget:"}),(0,c.jsx)("p",{className:"text-gray-900",children:void 0!==e.max_budget_in_team?"$".concat(eD(e.max_budget_in_team,4)):"No limit"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"font-medium text-gray-600",children:"Role:"}),(0,c.jsx)("p",{className:"text-gray-900 capitalize",children:e.user_role})]})]})},s))})}if("user_role"===e&&l&&l[s]){let{ui_label:e,description:t}=l[s];return(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"font-medium",children:e}),t&&(0,c.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:t})]})}return"budget_duration"===e?(0,c.jsx)("span",{children:eL(s)}):"boolean"==typeof s?(0,c.jsx)("span",{children:s?"Enabled":"Disabled"}):"models"===e&&Array.isArray(s)?0===s.length?(0,c.jsx)("span",{className:"text-gray-400",children:"None"}):(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:s.map((e,s)=>(0,c.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:F(e)},s))}):"object"==typeof s?Array.isArray(s)?0===s.length?(0,c.jsx)("span",{className:"text-gray-400",children:"None"}):(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:s.map((e,s)=>(0,c.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:"object"==typeof e?JSON.stringify(e):String(e)},s))}):(0,c.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:JSON.stringify(s,null,2)}):(0,c.jsx)("span",{children:String(s)})};return i?(0,c.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,c.jsx)(lm.Z,{size:"large"})}):o?(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"Default User Settings"}),!i&&o&&(u?(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(_.Z,{variant:"secondary",onClick:()=>{x(!1),p(o.values||{})},disabled:j,children:"Cancel"}),(0,c.jsx)(_.Z,{onClick:S,loading:j,children:"Save Changes"})]}):(0,c.jsx)(_.Z,{onClick:()=>x(!0),children:"Edit Settings"}))]}),(null==o?void 0:null===(s=o.field_schema)||void 0===s?void 0:s.description)&&(0,c.jsx)(N,{className:"mb-4",children:o.field_schema.description}),(0,c.jsx)(ld.Z,{}),(0,c.jsx)("div",{className:"mt-4 space-y-4",children:(()=>{let{values:e,field_schema:s}=o;return s&&s.properties?Object.entries(s.properties).map(s=>{let[t,l]=s,a=e[t],r=t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());return(0,c.jsxs)("div",{className:"mb-6 pb-6 border-b border-gray-200 last:border-0",children:[(0,c.jsx)(w.Z,{className:"font-medium text-lg",children:r}),(0,c.jsx)(N,{className:"text-sm text-gray-500 mt-1",children:l.description||"No description available"}),u?(0,c.jsx)("div",{className:"mt-2",children:T(t,l,a)}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:L(t,a)})]},t)}):(0,c.jsx)(w.Z,{children:"No schema information available"})})()})]}):(0,c.jsx)(W.Z,{children:(0,c.jsx)(w.Z,{children:"No settings available or you do not have permission to view them."})})},lx=t(19616);let lh={email:"",user_id:"",user_role:"",sso_user_id:"",team:"",model:"",min_spend:null,max_spend:null,sort_by:"created_at",sort_order:"desc"};var lp=e=>{var s;let{accessToken:t,token:l,userRole:a,userID:r,teams:i}=e,n=(0,h.NL)(),[o,m]=(0,d.useState)(1),[u,x]=(0,d.useState)(!1),[p,j]=(0,d.useState)(null),[f,v]=(0,d.useState)(!1),[y,b]=(0,d.useState)(null),[N,Z]=(0,d.useState)("users"),[w,k]=(0,d.useState)(lh),[S,C,I]=(0,lx.G)(w,{wait:300}),[A,E]=(0,d.useState)(!1),[T,L]=(0,d.useState)(!1),[O,M]=(0,d.useState)(null),[D,F]=(0,d.useState)(null),[R,q]=(0,d.useState)([]),[U,z]=(0,d.useState)(!1),[V,K]=(0,d.useState)(!1),[B,G]=(0,d.useState)([]),H=e=>{b(e),v(!0)};(0,d.useEffect)(()=>()=>{I.cancel()},[I]),(0,d.useEffect)(()=>{F((0,g.getProxyBaseUrl)())},[]),(0,d.useEffect)(()=>{(async()=>{try{if(!r||!a||!t)return;let e=(await (0,g.modelAvailableCall)(t,r,a)).data.map(e=>e.id);console.log("available_model_names:",e),G(e)}catch(e){console.error("Error fetching user models:",e)}})()},[t,r,a]);let J=e=>{k(s=>{let t={...s,...e};return C(t),t})},Y=async e=>{if(!t){P.ZP.error("Access token not found");return}try{P.ZP.success("Generating password reset link...");let s=await (0,g.invitationCreateCall)(t,e);M(s),L(!0)}catch(e){P.ZP.error("Failed to generate password reset link")}},W=async()=>{if(y&&t)try{await (0,g.userDeleteCall)(t,[y]),n.setQueriesData({queryKey:["userList"]},e=>{if(void 0===e)return e;let s=e.users.filter(e=>e.user_id!==y);return{...e,users:s}}),P.ZP.success("User deleted successfully")}catch(e){console.error("Error deleting user:",e),P.ZP.error("Failed to delete user")}v(!1),b(null)},$=async()=>{j(null),x(!1)},Q=async e=>{if(console.log("inside handleEditSubmit:",e),t&&l&&a&&r){try{let s=await (0,g.userUpdateUserCall)(t,e,null);n.setQueriesData({queryKey:["userList"]},e=>{if(void 0===e)return e;let t=e.users.map(e=>e.user_id===s.data.user_id?eM(e,s.data):e);return{...e,users:t}}),P.ZP.success("User ".concat(e.user_id," updated successfully"))}catch(e){console.error("There was an error updating the user",e)}j(null),x(!1)}},X=async e=>{m(e)},ee=(0,sd.a)({queryKey:["userList",{debouncedFilter:S,currentPage:o}],queryFn:async()=>{if(!t)throw Error("Access token required");return await (0,g.userListCall)(t,S.user_id?[S.user_id]:null,o,25,S.email||null,S.user_role||null,S.team||null,S.sso_user_id||null,S.sort_by,S.sort_order)},enabled:!!(t&&l&&a&&r),placeholderData:e=>e}),es=ee.data,et=(0,sd.a)({queryKey:["userRoles"],initialData:()=>({}),queryFn:async()=>{if(!t)throw Error("Access token required");return await (0,g.getPossibleUserRoles)(t)},enabled:!!(t&&l&&a&&r)}).data;if(ee.isLoading||!t||!l||!a||!r)return(0,c.jsx)("div",{children:"Loading..."});let el=ln(et,e=>{j(e),x(!0)},H,Y,()=>{});return(0,c.jsxs)("div",{className:"w-full p-6",children:[(0,c.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,c.jsxs)("div",{className:"flex space-x-3",children:[(0,c.jsx)(eI,{userID:r,accessToken:t,teams:i,possibleUIRoles:et}),(0,c.jsx)(_.Z,{onClick:()=>{K(!V),q([])},variant:V?"primary":"secondary",className:"flex items-center",children:V?"Cancel Selection":"Select Users"}),V&&(0,c.jsxs)(_.Z,{onClick:()=>{if(0===R.length){P.ZP.error("Please select users to edit");return}z(!0)},disabled:0===R.length,className:"flex items-center",children:["Bulk Edit (",R.length," selected)"]})]})}),(0,c.jsxs)(eW.Z,{defaultIndex:0,onIndexChange:e=>Z(0===e?"users":"settings"),children:[(0,c.jsxs)(e$.Z,{className:"mb-4",children:[(0,c.jsx)(eY.Z,{children:"Users"}),(0,c.jsx)(eY.Z,{children:"Default User Settings"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,c.jsx)("div",{className:"border-b px-6 py-4",children:(0,c.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,c.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,c.jsxs)("div",{className:"relative w-64",children:[(0,c.jsx)("input",{type:"text",placeholder:"Search by email...",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:w.email,onChange:e=>J({email:e.target.value})}),(0,c.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,c.jsxs)("button",{className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 ".concat(A?"bg-gray-100":""),onClick:()=>E(!A),children:[(0,c.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters",(w.user_id||w.user_role||w.team)&&(0,c.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500"})]}),(0,c.jsxs)("button",{className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",onClick:()=>{J(lh)},children:[(0,c.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reset Filters"]})]}),A&&(0,c.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mt-3",children:[(0,c.jsxs)("div",{className:"relative w-64",children:[(0,c.jsx)("input",{type:"text",placeholder:"Filter by User ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:w.user_id,onChange:e=>J({user_id:e.target.value})}),(0,c.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,c.jsx)("div",{className:"w-64",children:(0,c.jsx)(eH.Z,{value:w.user_role,onValueChange:e=>J({user_role:e}),placeholder:"Select Role",children:Object.entries(et).map(e=>{let[s,t]=e;return(0,c.jsx)(ed.Z,{value:s,children:t.ui_label},s)})})}),(0,c.jsx)("div",{className:"w-64",children:(0,c.jsx)(eH.Z,{value:w.team,onValueChange:e=>J({team:e}),placeholder:"Select Team",children:null==i?void 0:i.map(e=>(0,c.jsx)(ed.Z,{value:e.team_id,children:e.team_alias||e.team_id},e.team_id))})}),(0,c.jsx)("div",{className:"relative w-64",children:(0,c.jsx)("input",{type:"text",placeholder:"Filter by SSO ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:w.sso_user_id,onChange:e=>J({sso_user_id:e.target.value})})})]}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing"," ",es&&es.users&&es.users.length>0?(es.page-1)*es.page_size+1:0," ","-"," ",es&&es.users?Math.min(es.page*es.page_size,es.total):0," ","of ",es?es.total:0," results"]}),(0,c.jsxs)("div",{className:"flex space-x-2",children:[(0,c.jsx)("button",{onClick:()=>X(o-1),disabled:1===o,className:"px-3 py-1 text-sm border rounded-md ".concat(1===o?"bg-gray-100 text-gray-400 cursor-not-allowed":"hover:bg-gray-50"),children:"Previous"}),(0,c.jsx)("button",{onClick:()=>X(o+1),disabled:!es||o>=es.total_pages,className:"px-3 py-1 text-sm border rounded-md ".concat(!es||o>=es.total_pages?"bg-gray-100 text-gray-400 cursor-not-allowed":"hover:bg-gray-50"),children:"Next"})]})]})]})}),(0,c.jsx)(lc,{data:(null===(s=ee.data)||void 0===s?void 0:s.users)||[],columns:el,isLoading:ee.isLoading,accessToken:t,userRole:a,onSortChange:(e,s)=>{J({sort_by:e,sort_order:s})},currentSort:{sortBy:w.sort_by,sortOrder:w.sort_order},possibleUIRoles:et,handleEdit:e=>{j(e),x(!0)},handleDelete:H,handleResetPassword:Y,enableSelection:V,selectedUsers:R,onSelectionChange:e=>{q(e)}})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(lu,{accessToken:t,possibleUIRoles:et,userID:r,userRole:a})})]})]}),(0,c.jsx)(ls,{visible:u,possibleUIRoles:et,onCancel:$,user:p,onSubmit:Q}),f&&(0,c.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,c.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,c.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,c.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,c.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,c.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,c.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,c.jsx)("div",{className:"sm:flex sm:items-start",children:(0,c.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,c.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete User"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this user?"}),(0,c.jsxs)("p",{className:"text-sm font-medium text-gray-900 mt-2",children:["User ID: ",y]})]})]})})}),(0,c.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,c.jsx)(_.Z,{onClick:W,color:"red",className:"ml-2",children:"Delete"}),(0,c.jsx)(_.Z,{onClick:()=>{v(!1),b(null)},children:"Cancel"})]})]})]})}),(0,c.jsx)(eu,{isInvitationLinkModalVisible:T,setIsInvitationLinkModalVisible:L,baseUrl:D||"",invitationLinkData:O,modalType:"resetPassword"}),(0,c.jsx)(li,{visible:U,onCancel:()=>z(!1),selectedUsers:R,possibleUIRoles:et,accessToken:t,onSuccess:()=>{n.invalidateQueries({queryKey:["userList"]}),q([]),K(!1)},teams:i,userRole:a,userModels:B,allowAllUsers:!!a&&(0,eE.tY)(a)})]})},lg=e=>{var s;let{accessToken:t,userID:l,userRole:a}=e,[r,i]=(0,d.useState)(!0),[n,o]=(0,d.useState)(null),[m,u]=(0,d.useState)(!1),[x,h]=(0,d.useState)({}),[p,j]=(0,d.useState)(!1),[f,v]=(0,d.useState)([]),{Paragraph:b}=em.default,{Option:N}=C.default;(0,d.useEffect)(()=>{(async()=>{if(!t){i(!1);return}try{let e=await (0,g.getDefaultTeamSettings)(t);if(o(e),h(e.values||{}),t)try{let e=await (0,g.modelAvailableCall)(t,l,a);if(e&&e.data){let s=e.data.map(e=>e.id);v(s)}}catch(e){console.error("Error fetching available models:",e)}}catch(e){console.error("Error fetching team SSO settings:",e),P.ZP.error("Failed to fetch team settings")}finally{i(!1)}})()},[t]);let Z=async()=>{if(t){j(!0);try{let e=await (0,g.updateDefaultTeamSettings)(t,x);o({...n,values:e.settings}),u(!1),P.ZP.success("Default team settings updated successfully")}catch(e){console.error("Error updating team settings:",e),P.ZP.error("Failed to update team settings")}finally{j(!1)}}},S=(e,s)=>{h(t=>({...t,[e]:s}))},I=(e,s,t)=>{var l;let a=s.type;return"budget_duration"===e?(0,c.jsx)(eO,{value:x[e]||null,onChange:s=>S(e,s),className:"mt-2"}):"boolean"===a?(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)(tn.Z,{checked:!!x[e],onChange:s=>S(e,s)})}):"array"===a&&(null===(l=s.items)||void 0===l?void 0:l.enum)?(0,c.jsx)(C.default,{mode:"multiple",style:{width:"100%"},value:x[e]||[],onChange:s=>S(e,s),className:"mt-2",children:s.items.enum.map(e=>(0,c.jsx)(N,{value:e,children:e},e))}):"models"===e?(0,c.jsx)(C.default,{mode:"multiple",style:{width:"100%"},value:x[e]||[],onChange:s=>S(e,s),className:"mt-2",children:f.map(e=>(0,c.jsx)(N,{value:e,children:F(e)},e))}):"string"===a&&s.enum?(0,c.jsx)(C.default,{style:{width:"100%"},value:x[e]||"",onChange:s=>S(e,s),className:"mt-2",children:s.enum.map(e=>(0,c.jsx)(N,{value:e,children:e},e))}):(0,c.jsx)(y.Z,{value:void 0!==x[e]?String(x[e]):"",onChange:s=>S(e,s.target.value),placeholder:s.description||"",className:"mt-2"})},A=(e,s)=>null==s?(0,c.jsx)("span",{className:"text-gray-400",children:"Not set"}):"budget_duration"===e?(0,c.jsx)("span",{children:eL(s)}):"boolean"==typeof s?(0,c.jsx)("span",{children:s?"Enabled":"Disabled"}):"models"===e&&Array.isArray(s)?0===s.length?(0,c.jsx)("span",{className:"text-gray-400",children:"None"}):(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:s.map((e,s)=>(0,c.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:F(e)},s))}):"object"==typeof s?Array.isArray(s)?0===s.length?(0,c.jsx)("span",{className:"text-gray-400",children:"None"}):(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:s.map((e,s)=>(0,c.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:"object"==typeof e?JSON.stringify(e):String(e)},s))}):(0,c.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:JSON.stringify(s,null,2)}):(0,c.jsx)("span",{children:String(s)});return r?(0,c.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,c.jsx)(lm.Z,{size:"large"})}):n?(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{className:"text-xl",children:"Default Team Settings"}),!r&&n&&(m?(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(_.Z,{variant:"secondary",onClick:()=>{u(!1),h(n.values||{})},disabled:p,children:"Cancel"}),(0,c.jsx)(_.Z,{onClick:Z,loading:p,children:"Save Changes"})]}):(0,c.jsx)(_.Z,{onClick:()=>u(!0),children:"Edit Settings"}))]}),(0,c.jsx)(w.Z,{children:"These settings will be applied by default when creating new teams."}),(null==n?void 0:null===(s=n.field_schema)||void 0===s?void 0:s.description)&&(0,c.jsx)(b,{className:"mb-4 mt-2",children:n.field_schema.description}),(0,c.jsx)(ld.Z,{}),(0,c.jsx)("div",{className:"mt-4 space-y-4",children:(()=>{let{values:e,field_schema:s}=n;return s&&s.properties?Object.entries(s.properties).map(s=>{let[t,l]=s,a=e[t],r=t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());return(0,c.jsxs)("div",{className:"mb-6 pb-6 border-b border-gray-200 last:border-0",children:[(0,c.jsx)(w.Z,{className:"font-medium text-lg",children:r}),(0,c.jsx)(b,{className:"text-sm text-gray-500 mt-1",children:l.description||"No description available"}),m?(0,c.jsx)("div",{className:"mt-2",children:I(t,l,a)}):(0,c.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:A(t,a)})]},t)}):(0,c.jsx)(w.Z,{children:"No schema information available"})})()})]}):(0,c.jsx)(W.Z,{children:(0,c.jsx)(w.Z,{children:"No team settings available or you do not have permission to view them."})})},lj=e=>{let{accessToken:s,userID:t}=e,[l,a]=(0,d.useState)([]);(0,d.useEffect)(()=>{(async()=>{if(s&&t)try{let e=await (0,g.availableTeamListCall)(s);a(e)}catch(e){console.error("Error fetching available teams:",e)}})()},[s,t]);let r=async e=>{if(s&&t)try{await (0,g.teamMemberAddCall)(s,e,{user_id:t,role:"user"}),P.ZP.success("Successfully joined team"),a(s=>s.filter(s=>s.team_id!==e))}catch(e){console.error("Error joining team:",e),P.ZP.error("Failed to join team")}};return(0,c.jsx)(W.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Team Name"}),(0,c.jsx)(sb.Z,{children:"Description"}),(0,c.jsx)(sb.Z,{children:"Members"}),(0,c.jsx)(sb.Z,{children:"Models"}),(0,c.jsx)(sb.Z,{children:"Actions"})]})}),(0,c.jsxs)(sv.Z,{children:[l.map(e=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{children:e.team_alias})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{children:e.description||"No description available"})}),(0,c.jsx)(s_.Z,{children:(0,c.jsxs)(w.Z,{children:[e.members_with_roles.length," members"]})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)("div",{className:"flex flex-col",children:e.models&&0!==e.models.length?e.models.map((e,s)=>(0,c.jsx)(eJ.Z,{size:"xs",className:"mb-1",color:"blue",children:(0,c.jsx)(w.Z,{children:e.length>30?"".concat(e.slice(0,30),"..."):e})},s)):(0,c.jsx)(eJ.Z,{size:"xs",color:"red",children:(0,c.jsx)(w.Z,{children:"All Proxy Models"})})})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(_.Z,{size:"xs",variant:"secondary",onClick:()=>r(e.team_id),children:"Join Team"})})]},e.team_id)),0===l.length&&(0,c.jsx)(sN.Z,{children:(0,c.jsx)(s_.Z,{colSpan:5,className:"text-center",children:(0,c.jsx)(w.Z,{children:"No available teams to join"})})})]})]})})};let lf=(e,s)=>{let t=[];return e&&e.models.length>0?(console.log("organization.models: ".concat(e.models)),t=e.models):t=s,R(t,s)};var lv=e=>{let{teams:s,searchParams:t,accessToken:l,setTeams:a,userID:r,userRole:i,organizations:n,premiumUser:o=!1}=e,[m,u]=(0,d.useState)(""),[x,h]=(0,d.useState)(null),[p,k]=(0,d.useState)(null),[S,E]=(0,d.useState)(!1),[O,R]=(0,d.useState)({team_id:"",team_alias:"",organization_id:"",sort_by:"created_at",sort_order:"desc"});(0,d.useEffect)(()=>{console.log("inside useeffect - ".concat(m)),l&&j(l,r,i,x,a),ez()},[m]);let[q]=I.Z.useForm(),[V]=I.Z.useForm(),{Title:K,Paragraph:B}=em.default,[G,J]=(0,d.useState)(""),[Y,$]=(0,d.useState)(!1),[Q,X]=(0,d.useState)(null),[es,et]=(0,d.useState)(null),[el,ea]=(0,d.useState)(!1),[er,ei]=(0,d.useState)(!1),[en,eo]=(0,d.useState)(!1),[eu,ex]=(0,d.useState)(!1),[eh,ep]=(0,d.useState)([]),[eg,ej]=(0,d.useState)(!1),[ef,ev]=(0,d.useState)(null),[e_,ey]=(0,d.useState)([]),[eb,eN]=(0,d.useState)({}),[eZ,ew]=(0,d.useState)([]),[ek,eS]=(0,d.useState)({}),[eC,eI]=(0,d.useState)([]),[eP,eA]=(0,d.useState)([]),[eT,eL]=(0,d.useState)(!1);(0,d.useEffect)(()=>{console.log("currentOrgForCreateTeam: ".concat(p));let e=lf(p,eh);console.log("models: ".concat(e)),ey(e),q.setFieldValue("models",[])},[p,eh]),(0,d.useEffect)(()=>{(async()=>{try{if(null==l)return;let e=(await (0,g.getGuardrailsList)(l)).guardrails.map(e=>e.guardrail_name);ew(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})()},[l]);let eO=async()=>{try{if(null==l)return;let e=await (0,g.fetchMCPAccessGroups)(l);eA(e)}catch(e){console.error("Failed to fetch MCP access groups:",e)}};(0,d.useEffect)(()=>{eO()},[l]),(0,d.useEffect)(()=>{s&&eN(s.reduce((e,s)=>(e[s.team_id]={keys:s.keys||[],team_info:{members_with_roles:s.members_with_roles||[]}},e),{}))},[s]);let eF=async e=>{ev(e),ej(!0)},eq=async()=>{if(null!=ef&&null!=s&&null!=l){try{await (0,g.teamDeleteCall)(l,ef),j(l,r,i,x,a)}catch(e){console.error("Error deleting the team:",e)}ej(!1),ev(null)}};(0,d.useEffect)(()=>{(async()=>{try{if(null===r||null===i||null===l)return;let e=await D(r,i,l);e&&ep(e)}catch(e){console.error("Error fetching user models:",e)}})()},[l,r,i,s]);let eU=async e=>{try{if(console.log("formValues: ".concat(JSON.stringify(e))),null!=l){var t,r,i;let n=null==e?void 0:e.team_alias,o=null!==(i=null==s?void 0:s.map(e=>e.team_alias))&&void 0!==i?i:[],c=(null==e?void 0:e.organization_id)||(null==x?void 0:x.organization_id);if(""===c||"string"!=typeof c?e.organization_id=null:e.organization_id=c.trim(),o.includes(n))throw Error("Team alias ".concat(n," already exists, please pick another alias"));if(P.ZP.info("Creating Team"),eC.length>0){let s={};if(e.metadata)try{s=JSON.parse(e.metadata)}catch(e){console.warn("Invalid JSON in metadata field, starting with empty object")}s={...s,logging:eC.filter(e=>e.callback_name)},e.metadata=JSON.stringify(s)}if((e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0||e.allowed_mcp_servers_and_groups&&((null===(t=e.allowed_mcp_servers_and_groups.servers)||void 0===t?void 0:t.length)>0||(null===(r=e.allowed_mcp_servers_and_groups.accessGroups)||void 0===r?void 0:r.length)>0))&&(e.object_permission={},e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0&&(e.object_permission.vector_stores=e.allowed_vector_store_ids,delete e.allowed_vector_store_ids),e.allowed_mcp_servers_and_groups)){let{servers:s,accessGroups:t}=e.allowed_mcp_servers_and_groups;s&&s.length>0&&(e.object_permission.mcp_servers=s),t&&t.length>0&&(e.object_permission.mcp_access_groups=t),delete e.allowed_mcp_servers_and_groups}e.allowed_mcp_access_groups&&e.allowed_mcp_access_groups.length>0&&(e.object_permission||(e.object_permission={}),e.object_permission.mcp_access_groups=e.allowed_mcp_access_groups,delete e.allowed_mcp_access_groups);let d=await (0,g.teamCreateCall)(l,e);null!==s?a([...s,d]):a([d]),console.log("response for team create call: ".concat(d)),P.ZP.success("Team created"),q.resetFields(),eI([]),ei(!1)}}catch(e){console.error("Error creating the team:",e),P.ZP.error("Error creating the team: "+e,20)}},ez=()=>{u(new Date().toLocaleString())},eV=(e,s)=>{let t={...O,[e]:s};R(t),l&&(0,g.v2TeamListCall)(l,t.organization_id||null,null,t.team_id||null,t.team_alias||null).then(e=>{e&&e.teams&&a(e.teams)}).catch(e=>{console.error("Error fetching teams:",e)})};return(0,c.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,c.jsx)(v.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,c.jsxs)(f.Z,{numColSpan:1,className:"flex flex-col gap-2",children:[("Admin"==i||"Org Admin"==i)&&(0,c.jsx)(_.Z,{className:"w-fit",onClick:()=>ei(!0),children:"+ Create New Team"}),es?(0,c.jsx)(tt,{teamId:es,onUpdate:e=>{a(s=>{if(null==s)return s;let t=s.map(s=>e.team_id===s.team_id?eM(s,e):s);return l&&j(l,r,i,x,a),t})},onClose:()=>{et(null),ea(!1)},accessToken:l,is_team_admin:(e=>{if(null==e||null==e.members_with_roles)return!1;for(let s=0;s<e.members_with_roles.length;s++){let t=e.members_with_roles[s];if(t.user_id==r&&"admin"==t.role)return!0}return!1})(null==s?void 0:s.find(e=>e.team_id===es)),is_proxy_admin:"Admin"==i,userModels:eh,editTeam:el}):(0,c.jsxs)(eW.Z,{className:"gap-2 h-[75vh] w-full",children:[(0,c.jsxs)(e$.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)(eY.Z,{children:"Your Teams"}),(0,c.jsx)(eY.Z,{children:"Available Teams"}),(0,eE.tY)(i||"")&&(0,c.jsx)(eY.Z,{children:"Default Team Settings"})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[m&&(0,c.jsxs)(w.Z,{children:["Last Refreshed: ",m]}),(0,c.jsx)(sj.Z,{icon:e1.Z,variant:"shadow",size:"xs",className:"self-center",onClick:ez})]})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)(w.Z,{children:["Click on “Team ID” to view team details"," ",(0,c.jsx)("b",{children:"and"})," manage team members."]}),(0,c.jsx)(v.Z,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)(W.Z,{className:"w-full mx-auto flex-auto overflow-hidden overflow-y-auto max-h-[50vh]",children:[(0,c.jsx)("div",{className:"border-b px-6 py-4",children:(0,c.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,c.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,c.jsxs)("div",{className:"relative w-64",children:[(0,c.jsx)("input",{type:"text",placeholder:"Search by Team Name...",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:O.team_alias,onChange:e=>eV("team_alias",e.target.value)}),(0,c.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,c.jsxs)("button",{className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 ".concat(S?"bg-gray-100":""),onClick:()=>E(!S),children:[(0,c.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters",(O.team_id||O.team_alias||O.organization_id)&&(0,c.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500"})]}),(0,c.jsxs)("button",{className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",onClick:()=>{R({team_id:"",team_alias:"",organization_id:"",sort_by:"created_at",sort_order:"desc"}),l&&(0,g.v2TeamListCall)(l,null,r||null,null,null).then(e=>{e&&e.teams&&a(e.teams)}).catch(e=>{console.error("Error fetching teams:",e)})},children:[(0,c.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reset Filters"]})]}),S&&(0,c.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mt-3",children:[(0,c.jsxs)("div",{className:"relative w-64",children:[(0,c.jsx)("input",{type:"text",placeholder:"Enter Team ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:O.team_id,onChange:e=>eV("team_id",e.target.value)}),(0,c.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,c.jsx)("div",{className:"w-64",children:(0,c.jsx)(eH.Z,{value:O.organization_id||"",onValueChange:e=>eV("organization_id",e),placeholder:"Select Organization",children:null==n?void 0:n.map(e=>(0,c.jsx)(ed.Z,{value:e.organization_id||"",children:e.organization_alias||e.organization_id},e.organization_id))})})]})]})}),(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Team Name"}),(0,c.jsx)(sb.Z,{children:"Team ID"}),(0,c.jsx)(sb.Z,{children:"Created"}),(0,c.jsx)(sb.Z,{children:"Spend (USD)"}),(0,c.jsx)(sb.Z,{children:"Budget (USD)"}),(0,c.jsx)(sb.Z,{children:"Models"}),(0,c.jsx)(sb.Z,{children:"Organization"}),(0,c.jsx)(sb.Z,{children:"Info"})]})}),(0,c.jsx)(sv.Z,{children:s&&s.length>0?s.filter(e=>!x||e.organization_id===x.organization_id).sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.team_alias}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)("div",{className:"overflow-hidden",children:(0,c.jsx)(z.Z,{title:e.team_id,children:(0,c.jsxs)(_.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>{et(e.team_id)},children:[e.team_id.slice(0,7),"..."]})})})}),(0,c.jsx)(s_.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"}),(0,c.jsx)(s_.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:eD(e.spend,4)}),(0,c.jsx)(s_.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:null!==e.max_budget&&void 0!==e.max_budget?e.max_budget:"No limit"}),(0,c.jsx)(s_.Z,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:e.models.length>3?"px-0":"",children:(0,c.jsx)("div",{className:"flex flex-col",children:Array.isArray(e.models)?(0,c.jsx)("div",{className:"flex flex-col",children:0===e.models.length?(0,c.jsx)(eJ.Z,{size:"xs",className:"mb-1",color:"red",children:(0,c.jsx)(w.Z,{children:"All Proxy Models"})}):(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"flex items-start",children:[e.models.length>3&&(0,c.jsx)("div",{children:(0,c.jsx)(sj.Z,{icon:ek[e.team_id]?sZ.Z:sw.Z,className:"cursor-pointer",size:"xs",onClick:()=>{eS(s=>({...s,[e.team_id]:!s[e.team_id]}))}})}),(0,c.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.models.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,c.jsx)(eJ.Z,{size:"xs",color:"red",children:(0,c.jsx)(w.Z,{children:"All Proxy Models"})},s):(0,c.jsx)(eJ.Z,{size:"xs",color:"blue",children:(0,c.jsx)(w.Z,{children:e.length>30?"".concat(F(e).slice(0,30),"..."):F(e)})},s)),e.models.length>3&&!ek[e.team_id]&&(0,c.jsx)(eJ.Z,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,c.jsxs)(w.Z,{children:["+",e.models.length-3," ",e.models.length-3==1?"more model":"more models"]})}),ek[e.team_id]&&(0,c.jsx)("div",{className:"flex flex-wrap gap-1",children:e.models.slice(3).map((e,s)=>"all-proxy-models"===e?(0,c.jsx)(eJ.Z,{size:"xs",color:"red",children:(0,c.jsx)(w.Z,{children:"All Proxy Models"})},s+3):(0,c.jsx)(eJ.Z,{size:"xs",color:"blue",children:(0,c.jsx)(w.Z,{children:e.length>30?"".concat(F(e).slice(0,30),"..."):F(e)})},s+3))})]})]})})}):null})}),(0,c.jsx)(s_.Z,{children:e.organization_id}),(0,c.jsxs)(s_.Z,{children:[(0,c.jsxs)(w.Z,{children:[eb&&e.team_id&&eb[e.team_id]&&eb[e.team_id].keys&&eb[e.team_id].keys.length," ","Keys"]}),(0,c.jsxs)(w.Z,{children:[eb&&e.team_id&&eb[e.team_id]&&eb[e.team_id].team_info&&eb[e.team_id].team_info.members_with_roles&&eb[e.team_id].team_info.members_with_roles.length," ","Members"]})]}),(0,c.jsx)(s_.Z,{children:"Admin"==i?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>{et(e.team_id),ea(!0)}}),(0,c.jsx)(sj.Z,{onClick:()=>eF(e.team_id),icon:ee.Z,size:"sm"})]}):null})]},e.team_id)):null})]}),eg&&(0,c.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,c.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,c.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,c.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,c.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,c.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,c.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,c.jsx)("div",{className:"sm:flex sm:items-start",children:(0,c.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,c.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Team"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this team ?"})})]})})}),(0,c.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,c.jsx)(_.Z,{onClick:eq,color:"red",className:"ml-2",children:"Delete"}),(0,c.jsx)(_.Z,{onClick:()=>{ej(!1),ev(null)},children:"Cancel"})]})]})]})})]})})})]}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(lj,{accessToken:l,userID:r})}),(0,eE.tY)(i||"")&&(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(lg,{accessToken:l,userID:r||"",userRole:i||""})})]})]}),("Admin"==i||"Org Admin"==i)&&(0,c.jsx)(A.Z,{title:"Create Team",visible:er,width:1e3,footer:null,onOk:()=>{ei(!1),q.resetFields(),eI([])},onCancel:()=>{ei(!1),q.resetFields(),eI([])},children:(0,c.jsxs)(I.Z,{form:q,onFinish:eU,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{label:"Team Name",name:"team_alias",rules:[{required:!0,message:"Please input a team name"}],children:(0,c.jsx)(y.Z,{placeholder:""})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Organization"," ",(0,c.jsx)(z.Z,{title:(0,c.jsxs)("span",{children:["Organizations can have multiple teams. Learn more about"," ",(0,c.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/user_management_heirarchy",target:"_blank",rel:"noopener noreferrer",style:{color:"#1890ff",textDecoration:"underline"},onClick:e=>e.stopPropagation(),children:"user management hierarchy"})]}),children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"organization_id",initialValue:x?x.organization_id:null,className:"mt-8",children:(0,c.jsx)(C.default,{showSearch:!0,allowClear:!0,placeholder:"Search or select an Organization",onChange:e=>{q.setFieldValue("organization_id",e),k((null==n?void 0:n.find(s=>s.organization_id===e))||null)},filterOption:(e,s)=>{var t;return!!s&&((null===(t=s.children)||void 0===t?void 0:t.toString())||"").toLowerCase().includes(e.toLowerCase())},optionFilterProp:"children",children:null==n?void 0:n.map(e=>(0,c.jsxs)(C.default.Option,{value:e.organization_id,children:[(0,c.jsx)("span",{className:"font-medium",children:e.organization_alias})," ",(0,c.jsxs)("span",{className:"text-gray-500",children:["(",e.organization_id,")"]})]},e.organization_id))})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Models"," ",(0,c.jsx)(z.Z,{title:"These are the models that your selected team has access to",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"models",children:(0,c.jsxs)(C.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,c.jsx)(C.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),e_.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:F(e)},e))]})}),(0,c.jsx)(I.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,c.jsx)(M,{step:.01,precision:2,width:200})}),(0,c.jsx)(I.Z.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",children:(0,c.jsxs)(C.default,{defaultValue:null,placeholder:"n/a",children:[(0,c.jsx)(C.default.Option,{value:"24h",children:"daily"}),(0,c.jsx)(C.default.Option,{value:"7d",children:"weekly"}),(0,c.jsx)(C.default.Option,{value:"30d",children:"monthly"})]})}),(0,c.jsx)(I.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,c.jsx)(M,{step:1,width:400})}),(0,c.jsx)(I.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,c.jsx)(M,{step:1,width:400})}),(0,c.jsxs)(b.Z,{className:"mt-20 mb-8",onClick:()=>{eT||(eO(),eL(!0))},children:[(0,c.jsx)(Z.Z,{children:(0,c.jsx)("b",{children:"Additional Settings"})}),(0,c.jsxs)(N.Z,{children:[(0,c.jsx)(I.Z.Item,{label:"Team ID",name:"team_id",help:"ID of the team you want to create. If not provided, it will be generated automatically.",children:(0,c.jsx)(y.Z,{onChange:e=>{e.target.value=e.target.value.trim()}})}),(0,c.jsx)(I.Z.Item,{label:"Team Member Budget (USD)",name:"team_member_budget",normalize:e=>e?Number(e):void 0,tooltip:"This is the individual budget for a user in the team.",children:(0,c.jsx)(M,{step:.01,precision:2,width:200})}),(0,c.jsx)(I.Z.Item,{label:"Team Member Key Duration (eg: 1d, 1mo)",name:"team_member_key_duration",tooltip:"Set a limit to the duration of a team member's key. Format: 30s (seconds), 30m (minutes), 30h (hours), 30d (days), 1mo (month)",children:(0,c.jsx)(y.Z,{placeholder:"e.g., 30d"})}),(0,c.jsx)(I.Z.Item,{label:"Metadata",name:"metadata",help:"Additional team metadata. Enter metadata as JSON object.",children:(0,c.jsx)(L.default.TextArea,{rows:4})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Guardrails"," ",(0,c.jsx)(z.Z,{title:"Setup your first guardrail",children:(0,c.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",className:"mt-8",help:"Select existing guardrails or enter new ones",children:(0,c.jsx)(C.default,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails",options:eZ.map(e=>({value:e,label:e}))})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Allowed Vector Stores"," ",(0,c.jsx)(z.Z,{title:"Select which vector stores this team can access by default. Leave empty for access to all vector stores",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-8",help:"Select vector stores this team can access. Leave empty for access to all vector stores",children:(0,c.jsx)(H,{onChange:e=>q.setFieldValue("allowed_vector_store_ids",e),value:q.getFieldValue("allowed_vector_store_ids"),accessToken:l||"",placeholder:"Select vector stores (optional)"})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,c.jsx)(z.Z,{title:"Select which MCP servers or access groups this team can access by default. ",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_servers_and_groups",className:"mt-8",help:"Select MCP servers or access groups this team can access. ",children:(0,c.jsx)(eR,{onChange:e=>q.setFieldValue("allowed_mcp_servers_and_groups",e),value:q.getFieldValue("allowed_mcp_servers_and_groups"),accessToken:l||"",placeholder:"Select MCP servers or access groups (optional)"})})]})]}),(0,c.jsxs)(b.Z,{className:"mt-8 mb-8",children:[(0,c.jsx)(Z.Z,{children:(0,c.jsx)("b",{children:"Logging Settings"})}),(0,c.jsx)(N.Z,{children:(0,c.jsx)("div",{className:"mt-4",children:(0,c.jsx)(ec,{value:eC,onChange:eI,premiumUser:o})})})]})]}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Create Team"})})]})})]})})})},l_=e=>{var s,t,l,a,r;let{organizationId:i,onClose:n,accessToken:o,is_org_admin:m,is_proxy_admin:u,userModels:x,editOrg:h}=e,[p,j]=(0,d.useState)(null),[f,b]=(0,d.useState)(!0),[N]=I.Z.useForm(),[Z,S]=(0,d.useState)(!1),[A,E]=(0,d.useState)(!1),[O,D]=(0,d.useState)(!1),[R,q]=(0,d.useState)(null),[U,z]=(0,d.useState)({}),V=m||u,K=async()=>{try{if(b(!0),!o)return;let e=await (0,g.organizationInfoCall)(o,i);j(e)}catch(e){P.ZP.error("Failed to load organization information"),console.error("Error fetching organization info:",e)}finally{b(!1)}};(0,d.useEffect)(()=>{K()},[i,o]);let B=async e=>{try{if(null==o)return;let s={user_email:e.user_email,user_id:e.user_id,role:e.role};await (0,g.organizationMemberAddCall)(o,i,s),P.ZP.success("Organization member added successfully"),E(!1),N.resetFields(),K()}catch(e){P.ZP.error("Failed to add organization member"),console.error("Error adding organization member:",e)}},G=async e=>{try{if(!o)return;let s={user_email:e.user_email,user_id:e.user_id,role:e.role};await (0,g.organizationMemberUpdateCall)(o,i,s),P.ZP.success("Organization member updated successfully"),D(!1),N.resetFields(),K()}catch(e){P.ZP.error("Failed to update organization member"),console.error("Error updating organization member:",e)}},J=async e=>{try{if(!o)return;await (0,g.organizationMemberDeleteCall)(o,i,e.user_id),P.ZP.success("Organization member deleted successfully"),D(!1),N.resetFields(),K()}catch(e){P.ZP.error("Failed to delete organization member"),console.error("Error deleting organization member:",e)}},Y=async e=>{try{if(!o)return;let s={organization_id:i,organization_alias:e.organization_alias,models:e.models,litellm_budget_table:{tpm_limit:e.tpm_limit,rpm_limit:e.rpm_limit,max_budget:e.max_budget,budget_duration:e.budget_duration},metadata:e.metadata?JSON.parse(e.metadata):null};if((void 0!==e.vector_stores||void 0!==e.mcp_servers_and_groups)&&(s.object_permission={...null==p?void 0:p.object_permission,vector_stores:e.vector_stores||[]},void 0!==e.mcp_servers_and_groups)){let{servers:t,accessGroups:l}=e.mcp_servers_and_groups||{servers:[],accessGroups:[]};t&&t.length>0&&(s.object_permission.mcp_servers=t),l&&l.length>0&&(s.object_permission.mcp_access_groups=l)}await (0,g.organizationUpdateCall)(o,s),P.ZP.success("Organization settings updated successfully"),S(!1),K()}catch(e){P.ZP.error("Failed to update organization settings"),console.error("Error updating organization:",e)}};if(f)return(0,c.jsx)("div",{className:"p-4",children:"Loading..."});if(!p)return(0,c.jsx)("div",{className:"p-4",children:"Organization not found"});let $=async(e,s)=>{await eF(e)&&(z(e=>({...e,[s]:!0})),setTimeout(()=>{z(e=>({...e,[s]:!1}))},2e3))};return(0,c.jsxs)("div",{className:"w-full h-screen p-4 bg-white",children:[(0,c.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,c.jsxs)("div",{children:[(0,c.jsx)(_.Z,{icon:e0.Z,onClick:n,variant:"light",className:"mb-4",children:"Back to Organizations"}),(0,c.jsx)(k.Z,{children:p.organization_alias}),(0,c.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,c.jsx)(w.Z,{className:"text-gray-500 font-mono",children:p.organization_id}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:U["org-id"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>$(p.organization_id,"org-id"),className:"left-2 z-10 transition-all duration-200 ".concat(U["org-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]})}),(0,c.jsxs)(eW.Z,{defaultIndex:h?2:0,children:[(0,c.jsxs)(e$.Z,{className:"mb-4",children:[(0,c.jsx)(eY.Z,{children:"Overview"}),(0,c.jsx)(eY.Z,{children:"Members"}),(0,c.jsx)(eY.Z,{children:"Settings"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Organization Details"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)(w.Z,{children:["Created: ",new Date(p.created_at).toLocaleDateString()]}),(0,c.jsxs)(w.Z,{children:["Updated: ",new Date(p.updated_at).toLocaleDateString()]}),(0,c.jsxs)(w.Z,{children:["Created By: ",p.created_by]})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Budget Status"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)(k.Z,{children:["$",eD(p.spend,4)]}),(0,c.jsxs)(w.Z,{children:["of"," ",null===p.litellm_budget_table.max_budget?"Unlimited":"$".concat(eD(p.litellm_budget_table.max_budget,4))]}),p.litellm_budget_table.budget_duration&&(0,c.jsxs)(w.Z,{className:"text-gray-500",children:["Reset: ",p.litellm_budget_table.budget_duration]})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Rate Limits"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsxs)(w.Z,{children:["TPM: ",p.litellm_budget_table.tpm_limit||"Unlimited"]}),(0,c.jsxs)(w.Z,{children:["RPM: ",p.litellm_budget_table.rpm_limit||"Unlimited"]}),p.litellm_budget_table.max_parallel_requests&&(0,c.jsxs)(w.Z,{children:["Max Parallel Requests: ",p.litellm_budget_table.max_parallel_requests]})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Models"}),(0,c.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:0===p.models.length?(0,c.jsx)(eJ.Z,{color:"red",children:"All proxy models"}):p.models.map((e,s)=>(0,c.jsx)(eJ.Z,{color:"red",children:e},s))})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Teams"}),(0,c.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:null===(s=p.teams)||void 0===s?void 0:s.map((e,s)=>(0,c.jsx)(eJ.Z,{color:"red",children:e.team_id},s))})]}),(0,c.jsx)(sl,{objectPermission:p.object_permission,variant:"card",accessToken:o})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsx)(W.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[75vh]",children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"User ID"}),(0,c.jsx)(sb.Z,{children:"Role"}),(0,c.jsx)(sb.Z,{children:"Spend"}),(0,c.jsx)(sb.Z,{children:"Created At"}),(0,c.jsx)(sb.Z,{})]})}),(0,c.jsx)(sv.Z,{children:null===(t=p.members)||void 0===t?void 0:t.map((e,s)=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{className:"font-mono",children:e.user_id})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{className:"font-mono",children:e.user_role})}),(0,c.jsx)(s_.Z,{children:(0,c.jsxs)(w.Z,{children:["$",eD(e.spend,4)]})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{children:new Date(e.created_at).toLocaleString()})}),(0,c.jsx)(s_.Z,{children:V&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>{q({role:e.user_role,user_email:e.user_email,user_id:e.user_id}),D(!0)}}),(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>{J(e)}})]})})]},s))})]})}),V&&(0,c.jsx)(_.Z,{onClick:()=>{E(!0)},children:"Add Member"})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(W.Z,{className:"overflow-y-auto max-h-[65vh]",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"Organization Settings"}),V&&!Z&&(0,c.jsx)(_.Z,{onClick:()=>S(!0),children:"Edit Settings"})]}),Z?(0,c.jsxs)(I.Z,{form:N,onFinish:Y,initialValues:{organization_alias:p.organization_alias,models:p.models,tpm_limit:p.litellm_budget_table.tpm_limit,rpm_limit:p.litellm_budget_table.rpm_limit,max_budget:p.litellm_budget_table.max_budget,budget_duration:p.litellm_budget_table.budget_duration,metadata:p.metadata?JSON.stringify(p.metadata,null,2):"",vector_stores:(null===(l=p.object_permission)||void 0===l?void 0:l.vector_stores)||[],mcp_servers_and_groups:{servers:(null===(a=p.object_permission)||void 0===a?void 0:a.mcp_servers)||[],accessGroups:(null===(r=p.object_permission)||void 0===r?void 0:r.mcp_access_groups)||[]}},layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{label:"Organization Name",name:"organization_alias",rules:[{required:!0,message:"Please input an organization name"}],children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"Models",name:"models",children:(0,c.jsxs)(C.default,{mode:"multiple",placeholder:"Select models",children:[(0,c.jsx)(C.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),x.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:F(e)},e))]})}),(0,c.jsx)(I.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,c.jsx)(M,{step:.01,precision:2,style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,c.jsxs)(C.default,{placeholder:"n/a",children:[(0,c.jsx)(C.default.Option,{value:"24h",children:"daily"}),(0,c.jsx)(C.default.Option,{value:"7d",children:"weekly"}),(0,c.jsx)(C.default.Option,{value:"30d",children:"monthly"})]})}),(0,c.jsx)(I.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,c.jsx)(M,{step:1,style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,c.jsx)(M,{step:1,style:{width:"100%"}})}),(0,c.jsx)(I.Z.Item,{label:"Vector Stores",name:"vector_stores",children:(0,c.jsx)(H,{onChange:e=>N.setFieldValue("vector_stores",e),value:N.getFieldValue("vector_stores"),accessToken:o||"",placeholder:"Select vector stores"})}),(0,c.jsx)(I.Z.Item,{label:"MCP Servers & Access Groups",name:"mcp_servers_and_groups",children:(0,c.jsx)(eR,{onChange:e=>N.setFieldValue("mcp_servers_and_groups",e),value:N.getFieldValue("mcp_servers_and_groups"),accessToken:o||"",placeholder:"Select MCP servers and access groups"})}),(0,c.jsx)(I.Z.Item,{label:"Metadata",name:"metadata",children:(0,c.jsx)(L.default.TextArea,{rows:4})}),(0,c.jsx)("div",{className:"sticky z-10 bg-white p-4 border-t border-gray-200 bottom-[-1.5rem] inset-x-[-1.5rem]",children:(0,c.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,c.jsx)(T.ZP,{onClick:()=>S(!1),children:"Cancel"}),(0,c.jsx)(_.Z,{type:"submit",children:"Save Changes"})]})})]}):(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Organization Name"}),(0,c.jsx)("div",{children:p.organization_alias})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Organization ID"}),(0,c.jsx)("div",{className:"font-mono",children:p.organization_id})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Created At"}),(0,c.jsx)("div",{children:new Date(p.created_at).toLocaleString()})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Models"}),(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:p.models.map((e,s)=>(0,c.jsx)(eJ.Z,{color:"red",children:e},s))})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Rate Limits"}),(0,c.jsxs)("div",{children:["TPM: ",p.litellm_budget_table.tpm_limit||"Unlimited"]}),(0,c.jsxs)("div",{children:["RPM: ",p.litellm_budget_table.rpm_limit||"Unlimited"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Budget"}),(0,c.jsxs)("div",{children:["Max:"," ",null!==p.litellm_budget_table.max_budget?"$".concat(eD(p.litellm_budget_table.max_budget,4)):"No Limit"]}),(0,c.jsxs)("div",{children:["Reset: ",p.litellm_budget_table.budget_duration||"Never"]})]}),(0,c.jsx)(sl,{objectPermission:p.object_permission,variant:"inline",className:"pt-4 border-t border-gray-200",accessToken:o})]})]})})]})]}),(0,c.jsx)(ts,{isVisible:A,onCancel:()=>E(!1),onSubmit:B,accessToken:o,title:"Add Organization Member",roles:[{label:"org_admin",value:"org_admin",description:"Can add and remove members, and change their roles."},{label:"internal_user",value:"internal_user",description:"Can view/create keys for themselves within organization."},{label:"internal_user_viewer",value:"internal_user_viewer",description:"Can only view their keys within organization."}],defaultRole:"internal_user"}),(0,c.jsx)(te,{visible:O,onCancel:()=>D(!1),onSubmit:G,initialData:R,mode:"edit",config:{title:"Edit Member",showEmail:!0,showUserId:!0,roleOptions:[{label:"Org Admin",value:"org_admin"},{label:"Internal User",value:"internal_user"},{label:"Internal User Viewer",value:"internal_user_viewer"}]}})]})};let ly=async(e,s)=>{s(await (0,g.organizationListCall)(e))};var lb=e=>{let{organizations:s,userRole:t,userModels:l,accessToken:a,lastRefreshed:r,handleRefreshClick:i,currentOrg:n,guardrailsList:o=[],setOrganizations:m,premiumUser:u}=e,[x,h]=(0,d.useState)(null),[p,j]=(0,d.useState)(!1),[b,N]=(0,d.useState)(!1),[Z,k]=(0,d.useState)(null),[S,E]=(0,d.useState)(!1),[T]=I.Z.useForm(),[O,D]=(0,d.useState)({});(0,d.useEffect)(()=>{a&&ly(a,m)},[a]);let R=e=>{e&&(k(e),N(!0))},q=async()=>{if(Z&&a)try{await (0,g.organizationDeleteCall)(a,Z),P.ZP.success("Organization deleted successfully"),N(!1),k(null),ly(a,m)}catch(e){console.error("Error deleting organization:",e)}},V=async e=>{try{var s,t,l,r;if(!a)return;console.log("values in organizations new create call: ".concat(JSON.stringify(e))),(e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0||e.allowed_mcp_servers_and_groups&&((null===(s=e.allowed_mcp_servers_and_groups.servers)||void 0===s?void 0:s.length)>0||(null===(t=e.allowed_mcp_servers_and_groups.accessGroups)||void 0===t?void 0:t.length)>0))&&(e.object_permission={},e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0&&(e.object_permission.vector_stores=e.allowed_vector_store_ids,delete e.allowed_vector_store_ids),e.allowed_mcp_servers_and_groups&&((null===(l=e.allowed_mcp_servers_and_groups.servers)||void 0===l?void 0:l.length)>0&&(e.object_permission.mcp_servers=e.allowed_mcp_servers_and_groups.servers),(null===(r=e.allowed_mcp_servers_and_groups.accessGroups)||void 0===r?void 0:r.length)>0&&(e.object_permission.mcp_access_groups=e.allowed_mcp_servers_and_groups.accessGroups),delete e.allowed_mcp_servers_and_groups)),await (0,g.organizationCreateCall)(a,e),E(!1),T.resetFields(),ly(a,m)}catch(e){console.error("Error creating organization:",e)}};return u?(0,c.jsxs)("div",{className:"w-full mx-4 h-[75vh]",children:[(0,c.jsx)(v.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,c.jsxs)(f.Z,{numColSpan:1,className:"flex flex-col gap-2",children:[("Admin"===t||"Org Admin"===t)&&(0,c.jsx)(_.Z,{className:"w-fit",onClick:()=>E(!0),children:"+ Create New Organization"}),x?(0,c.jsx)(l_,{organizationId:x,onClose:()=>{h(null),j(!1)},accessToken:a,is_org_admin:!0,is_proxy_admin:"Admin"===t,userModels:l,editOrg:p}):(0,c.jsxs)(eW.Z,{className:"gap-2 h-[75vh] w-full",children:[(0,c.jsxs)(e$.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,c.jsx)("div",{className:"flex",children:(0,c.jsx)(eY.Z,{children:"Your Organizations"})}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[r&&(0,c.jsxs)(w.Z,{children:["Last Refreshed: ",r]}),(0,c.jsx)(sj.Z,{icon:e1.Z,variant:"shadow",size:"xs",className:"self-center",onClick:i})]})]}),(0,c.jsx)(eX.Z,{children:(0,c.jsxs)(eQ.Z,{children:[(0,c.jsx)(w.Z,{children:"Click on “Organization ID” to view organization details."}),(0,c.jsx)(v.Z,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsx)(W.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Organization ID"}),(0,c.jsx)(sb.Z,{children:"Organization Name"}),(0,c.jsx)(sb.Z,{children:"Created"}),(0,c.jsx)(sb.Z,{children:"Spend (USD)"}),(0,c.jsx)(sb.Z,{children:"Budget (USD)"}),(0,c.jsx)(sb.Z,{children:"Models"}),(0,c.jsx)(sb.Z,{children:"TPM / RPM Limits"}),(0,c.jsx)(sb.Z,{children:"Info"}),(0,c.jsx)(sb.Z,{children:"Actions"})]})}),(0,c.jsx)(sv.Z,{children:s&&s.length>0?s.sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>{var s,l,a,r,i,n,o,d,m;return(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:(0,c.jsx)("div",{className:"overflow-hidden",children:(0,c.jsx)(z.Z,{title:e.organization_id,children:(0,c.jsxs)(_.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>h(e.organization_id),children:[null===(s=e.organization_id)||void 0===s?void 0:s.slice(0,7),"..."]})})})}),(0,c.jsx)(s_.Z,{children:e.organization_alias}),(0,c.jsx)(s_.Z,{children:e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"}),(0,c.jsx)(s_.Z,{children:eD(e.spend,4)}),(0,c.jsx)(s_.Z,{children:(null===(l=e.litellm_budget_table)||void 0===l?void 0:l.max_budget)!==null&&(null===(a=e.litellm_budget_table)||void 0===a?void 0:a.max_budget)!==void 0?null===(r=e.litellm_budget_table)||void 0===r?void 0:r.max_budget:"No limit"}),(0,c.jsx)(s_.Z,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:e.models.length>3?"px-0":"",children:(0,c.jsx)("div",{className:"flex flex-col",children:Array.isArray(e.models)?(0,c.jsx)("div",{className:"flex flex-col",children:0===e.models.length?(0,c.jsx)(eJ.Z,{size:"xs",className:"mb-1",color:"red",children:(0,c.jsx)(w.Z,{children:"All Proxy Models"})}):(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"flex items-start",children:[e.models.length>3&&(0,c.jsx)("div",{children:(0,c.jsx)(sj.Z,{icon:O[e.organization_id||""]?sZ.Z:sw.Z,className:"cursor-pointer",size:"xs",onClick:()=>{D(s=>({...s,[e.organization_id||""]:!s[e.organization_id||""]}))}})}),(0,c.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.models.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,c.jsx)(eJ.Z,{size:"xs",color:"red",children:(0,c.jsx)(w.Z,{children:"All Proxy Models"})},s):(0,c.jsx)(eJ.Z,{size:"xs",color:"blue",children:(0,c.jsx)(w.Z,{children:e.length>30?"".concat(F(e).slice(0,30),"..."):F(e)})},s)),e.models.length>3&&!O[e.organization_id||""]&&(0,c.jsx)(eJ.Z,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,c.jsxs)(w.Z,{children:["+",e.models.length-3," ",e.models.length-3==1?"more model":"more models"]})}),O[e.organization_id||""]&&(0,c.jsx)("div",{className:"flex flex-wrap gap-1",children:e.models.slice(3).map((e,s)=>"all-proxy-models"===e?(0,c.jsx)(eJ.Z,{size:"xs",color:"red",children:(0,c.jsx)(w.Z,{children:"All Proxy Models"})},s+3):(0,c.jsx)(eJ.Z,{size:"xs",color:"blue",children:(0,c.jsx)(w.Z,{children:e.length>30?"".concat(F(e).slice(0,30),"..."):F(e)})},s+3))})]})]})})}):null})}),(0,c.jsx)(s_.Z,{children:(0,c.jsxs)(w.Z,{children:["TPM:"," ",(null===(i=e.litellm_budget_table)||void 0===i?void 0:i.tpm_limit)?null===(n=e.litellm_budget_table)||void 0===n?void 0:n.tpm_limit:"Unlimited",(0,c.jsx)("br",{}),"RPM:"," ",(null===(o=e.litellm_budget_table)||void 0===o?void 0:o.rpm_limit)?null===(d=e.litellm_budget_table)||void 0===d?void 0:d.rpm_limit:"Unlimited"]})}),(0,c.jsx)(s_.Z,{children:(0,c.jsxs)(w.Z,{children:[(null===(m=e.members)||void 0===m?void 0:m.length)||0," Members"]})}),(0,c.jsx)(s_.Z,{children:"Admin"===t&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>{h(e.organization_id),j(!0)}}),(0,c.jsx)(sj.Z,{onClick:()=>R(e.organization_id),icon:ee.Z,size:"sm"})]})})]},e.organization_id)}):null})]})})})})]})})]})]})}),(0,c.jsx)(A.Z,{title:"Create Organization",visible:S,width:800,footer:null,onCancel:()=>{E(!1),T.resetFields()},children:(0,c.jsxs)(I.Z,{form:T,onFinish:V,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsx)(I.Z.Item,{label:"Organization Name",name:"organization_alias",rules:[{required:!0,message:"Please input an organization name"}],children:(0,c.jsx)(y.Z,{placeholder:""})}),(0,c.jsx)(I.Z.Item,{label:"Models",name:"models",children:(0,c.jsxs)(C.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,c.jsx)(C.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),l&&l.length>0&&l.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:F(e)},e))]})}),(0,c.jsx)(I.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,c.jsx)(M,{step:.01,precision:2,width:200})}),(0,c.jsx)(I.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,c.jsxs)(C.default,{defaultValue:null,placeholder:"n/a",children:[(0,c.jsx)(C.default.Option,{value:"24h",children:"daily"}),(0,c.jsx)(C.default.Option,{value:"7d",children:"weekly"}),(0,c.jsx)(C.default.Option,{value:"30d",children:"monthly"})]})}),(0,c.jsx)(I.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,c.jsx)(M,{step:1,width:400})}),(0,c.jsx)(I.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,c.jsx)(M,{step:1,width:400})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Allowed Vector Stores"," ",(0,c.jsx)(z.Z,{title:"Select which vector stores this organization can access by default. Leave empty for access to all vector stores",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-4",help:"Select vector stores this organization can access. Leave empty for access to all vector stores",children:(0,c.jsx)(H,{onChange:e=>T.setFieldValue("allowed_vector_store_ids",e),value:T.getFieldValue("allowed_vector_store_ids"),accessToken:a||"",placeholder:"Select vector stores (optional)"})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,c.jsx)(z.Z,{title:"Select which MCP servers and access groups this organization can access by default.",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_servers_and_groups",className:"mt-4",help:"Select MCP servers and access groups this organization can access.",children:(0,c.jsx)(eR,{onChange:e=>T.setFieldValue("allowed_mcp_servers_and_groups",e),value:T.getFieldValue("allowed_mcp_servers_and_groups"),accessToken:a||"",placeholder:"Select MCP servers and access groups (optional)"})}),(0,c.jsx)(I.Z.Item,{label:"Metadata",name:"metadata",children:(0,c.jsx)(L.default.TextArea,{rows:4})}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(_.Z,{type:"submit",children:"Create Organization"})})]})}),b?(0,c.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,c.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,c.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,c.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,c.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,c.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,c.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,c.jsx)("div",{className:"sm:flex sm:items-start",children:(0,c.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,c.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Organization"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this organization?"})})]})})}),(0,c.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,c.jsx)(_.Z,{onClick:q,color:"red",className:"ml-2",children:"Delete"}),(0,c.jsx)(_.Z,{onClick:()=>{N(!1),k(null)},children:"Cancel"})]})]})]})}):(0,c.jsx)(c.Fragment,{})]}):(0,c.jsx)("div",{children:(0,c.jsxs)(w.Z,{children:["This is a LiteLLM Enterprise feature, and requires a valid key to use. Get a trial key"," ",(0,c.jsx)("a",{href:"https://www.litellm.ai/#pricing",target:"_blank",rel:"noopener noreferrer",children:"here"}),"."]})})},lN=t(94789);let lZ={google:"https://artificialanalysis.ai/img/logos/google_small.svg",microsoft:"https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg",okta:"https://www.okta.com/sites/default/files/Okta_Logo_BrightBlue_Medium.png",generic:""},lw={google:{envVarMap:{google_client_id:"GOOGLE_CLIENT_ID",google_client_secret:"GOOGLE_CLIENT_SECRET"},fields:[{label:"GOOGLE CLIENT ID",name:"google_client_id"},{label:"GOOGLE CLIENT SECRET",name:"google_client_secret"}]},microsoft:{envVarMap:{microsoft_client_id:"MICROSOFT_CLIENT_ID",microsoft_client_secret:"MICROSOFT_CLIENT_SECRET",microsoft_tenant:"MICROSOFT_TENANT"},fields:[{label:"MICROSOFT CLIENT ID",name:"microsoft_client_id"},{label:"MICROSOFT CLIENT SECRET",name:"microsoft_client_secret"},{label:"MICROSOFT TENANT",name:"microsoft_tenant"}]},okta:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"GENERIC CLIENT ID",name:"generic_client_id"},{label:"GENERIC CLIENT SECRET",name:"generic_client_secret"},{label:"AUTHORIZATION ENDPOINT",name:"generic_authorization_endpoint",placeholder:"https://your-okta-domain/authorize"},{label:"TOKEN ENDPOINT",name:"generic_token_endpoint",placeholder:"https://your-okta-domain/token"},{label:"USERINFO ENDPOINT",name:"generic_userinfo_endpoint",placeholder:"https://your-okta-domain/userinfo"}]},generic:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"GENERIC CLIENT ID",name:"generic_client_id"},{label:"GENERIC CLIENT SECRET",name:"generic_client_secret"},{label:"AUTHORIZATION ENDPOINT",name:"generic_authorization_endpoint"},{label:"TOKEN ENDPOINT",name:"generic_token_endpoint"},{label:"USERINFO ENDPOINT",name:"generic_userinfo_endpoint"}]}};var lk=e=>{let{isAddSSOModalVisible:s,isInstructionsModalVisible:t,handleAddSSOOk:l,handleAddSSOCancel:a,handleShowInstructions:r,handleInstructionsOk:i,handleInstructionsCancel:n,form:o,accessToken:m,ssoConfigured:u=!1}=e,[x,h]=(0,d.useState)(!1);(0,d.useEffect)(()=>{(async()=>{if(s&&m)try{let s=await (0,g.getSSOSettings)(m);if(console.log("Raw SSO data received:",s),s&&s.values){console.log("SSO values:",s.values),console.log("user_email from API:",s.values.user_email);let l=null;if(s.values.google_client_id)l="google";else if(s.values.microsoft_client_id)l="microsoft";else if(s.values.generic_client_id){var e,t;l=(null===(e=s.values.generic_authorization_endpoint)||void 0===e?void 0:e.includes("okta"))||(null===(t=s.values.generic_authorization_endpoint)||void 0===t?void 0:t.includes("auth0"))?"okta":"generic"}let a={sso_provider:l,proxy_base_url:s.values.proxy_base_url,user_email:s.values.user_email,...s.values};console.log("Setting form values:",a),o.resetFields(),setTimeout(()=>{o.setFieldsValue(a),console.log("Form values set, current form values:",o.getFieldsValue())},100)}}catch(e){console.error("Failed to load SSO settings:",e)}})()},[s,m,o]);let p=async e=>{if(!m){P.ZP.error("No access token available");return}try{await (0,g.updateSSOSettings)(m,e),r(e)}catch(e){console.error("Failed to save SSO settings:",e),P.ZP.error("Failed to save SSO settings")}},j=async()=>{if(!m){P.ZP.error("No access token available");return}try{await (0,g.updateSSOSettings)(m,{google_client_id:"",google_client_secret:"",microsoft_client_id:"",microsoft_client_secret:"",microsoft_tenant:"",generic_client_id:"",generic_client_secret:"",generic_authorization_endpoint:"",generic_token_endpoint:"",generic_userinfo_endpoint:"",proxy_base_url:"",user_email:"",sso_provider:""}),o.resetFields(),h(!1),l(),P.ZP.success("SSO settings cleared successfully")}catch(e){console.error("Failed to clear SSO settings:",e),P.ZP.error("Failed to clear SSO settings")}},f=e=>{let s=lw[e];return s?s.fields.map(e=>(0,c.jsx)(I.Z.Item,{label:e.label,name:e.name,rules:[{required:!0,message:"Please enter the ".concat(e.label.toLowerCase())}],children:e.name.includes("client")?(0,c.jsx)(L.default.Password,{}):(0,c.jsx)(y.Z,{placeholder:e.placeholder})},e.name)):null};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(A.Z,{title:u?"Edit SSO Settings":"Add SSO",visible:s,width:800,footer:null,onOk:l,onCancel:a,children:(0,c.jsxs)(I.Z,{form:o,onFinish:p,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{label:"SSO Provider",name:"sso_provider",rules:[{required:!0,message:"Please select an SSO provider"}],children:(0,c.jsx)(C.default,{children:Object.entries(lZ).map(e=>{let[s,t]=e;return(0,c.jsx)(C.default.Option,{value:s,children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 0"},children:[t&&(0,c.jsx)("img",{src:t,alt:s,style:{height:24,width:24,marginRight:12,objectFit:"contain"}}),(0,c.jsxs)("span",{children:[s.charAt(0).toUpperCase()+s.slice(1)," SSO"]})]})},s)})})}),(0,c.jsx)(I.Z.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.sso_provider!==s.sso_provider,children:e=>{let{getFieldValue:s}=e,t=s("sso_provider");return t?f(t):null}}),(0,c.jsx)(I.Z.Item,{label:"Proxy Admin Email",name:"user_email",rules:[{required:!0,message:"Please enter the email of the proxy admin"}],children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"PROXY BASE URL",name:"proxy_base_url",rules:[{required:!0,message:"Please enter the proxy base url"}],children:(0,c.jsx)(y.Z,{})})]}),(0,c.jsxs)("div",{style:{textAlign:"right",marginTop:"10px",display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"8px"},children:[u&&(0,c.jsx)(T.ZP,{onClick:()=>h(!0),style:{backgroundColor:"#6366f1",borderColor:"#6366f1",color:"white"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#5558eb",e.currentTarget.style.borderColor="#5558eb"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#6366f1",e.currentTarget.style.borderColor="#6366f1"},children:"Clear"}),(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Save"})]})]})}),(0,c.jsxs)(A.Z,{title:"Confirm Clear SSO Settings",visible:x,onOk:j,onCancel:()=>h(!1),okText:"Yes, Clear",cancelText:"Cancel",okButtonProps:{danger:!0,style:{backgroundColor:"#dc2626",borderColor:"#dc2626"}},children:[(0,c.jsx)("p",{children:"Are you sure you want to clear all SSO settings? This action cannot be undone."}),(0,c.jsx)("p",{children:"Users will no longer be able to login using SSO after this change."})]}),(0,c.jsxs)(A.Z,{title:"SSO Setup Instructions",visible:t,width:800,footer:null,onOk:i,onCancel:n,children:[(0,c.jsx)("p",{children:"Follow these steps to complete the SSO setup:"}),(0,c.jsx)(w.Z,{className:"mt-2",children:"1. DO NOT Exit this TAB"}),(0,c.jsx)(w.Z,{className:"mt-2",children:"2. Open a new tab, visit your proxy base url"}),(0,c.jsx)(w.Z,{className:"mt-2",children:"3. Confirm your SSO is configured correctly and you can login on the new Tab"}),(0,c.jsx)(w.Z,{className:"mt-2",children:"4. If Step 3 is successful, you can close this tab"}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{onClick:i,children:"Done"})})]})]})},lS=t(62272),lC=t(92403),lI=t(29271),lP=t(34419);let lA=e=>{if(!e)return"An unknown error occurred";if("string"==typeof e)return e;if(e.message)try{let s=JSON.parse(e.message);if(s.error&&s.error.message)return s.error.message;return"string"==typeof s?s:JSON.stringify(s,null,2)}catch(s){return e.message}if(e.response&&e.response.data){if("string"==typeof e.response.data)return e.response.data;if(e.response.data.message)return e.response.data.message;if(e.response.data.error)return"string"==typeof e.response.data.error?e.response.data.error:e.response.data.error.message||JSON.stringify(e.response.data.error)}return String(e)};var lE=e=>{let{accessToken:s,userID:t,proxySettings:l}=e,[a]=I.Z.useForm(),[r,i]=(0,d.useState)(!1),[n,o]=(0,d.useState)(null),[m,u]=(0,d.useState)("<your_proxy_base_url>");(0,d.useEffect)(()=>{let e="<your_proxy_base_url>";u(l&&l.PROXY_BASE_URL&&void 0!==l.PROXY_BASE_URL?l.PROXY_BASE_URL:window.location.origin)},[l]);let x="".concat(m,"/scim/v2"),h=async e=>{if(!s||!t){P.ZP.error("You need to be logged in to create a SCIM token");return}try{i(!0);let l={key_alias:e.key_alias||"SCIM Access Token",team_id:null,models:[],allowed_routes:["/scim/*"]},a=await (0,g.keyCreateCall)(s,t,l);o(a),P.ZP.success("SCIM token created successfully")}catch(e){console.error("Error creating SCIM token:",e),P.ZP.error("Failed to create SCIM token: "+lA(e))}finally{i(!1)}};return(0,c.jsx)(v.Z,{numItems:1,children:(0,c.jsxs)(W.Z,{children:[(0,c.jsx)("div",{className:"flex items-center mb-4",children:(0,c.jsx)(k.Z,{children:"SCIM Configuration"})}),(0,c.jsx)(w.Z,{className:"text-gray-600",children:"System for Cross-domain Identity Management (SCIM) allows you to automatically provision and manage users and groups in LiteLLM."}),(0,c.jsx)(ld.Z,{}),(0,c.jsxs)("div",{className:"space-y-8",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center mb-2",children:[(0,c.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 mr-2",children:"1"}),(0,c.jsxs)(k.Z,{className:"text-lg flex items-center",children:[(0,c.jsx)(lS.Z,{className:"h-5 w-5 mr-2"}),"SCIM Tenant URL"]})]}),(0,c.jsx)(w.Z,{className:"text-gray-600 mb-3",children:"Use this URL in your identity provider SCIM integration settings."}),(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(y.Z,{value:x,disabled:!0,className:"flex-grow"}),(0,c.jsx)(S.CopyToClipboard,{text:x,onCopy:()=>P.ZP.success("URL copied to clipboard"),children:(0,c.jsxs)(_.Z,{variant:"primary",className:"ml-2 flex items-center",children:[(0,c.jsx)(tC.Z,{className:"h-4 w-4 mr-1"}),"Copy"]})})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center mb-2",children:[(0,c.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 mr-2",children:"2"}),(0,c.jsxs)(k.Z,{className:"text-lg flex items-center",children:[(0,c.jsx)(lC.Z,{className:"h-5 w-5 mr-2"}),"Authentication Token"]})]}),(0,c.jsx)(lN.Z,{title:"Using SCIM",color:"blue",className:"mb-4",children:"You need a SCIM token to authenticate with the SCIM API. Create one below and use it in your SCIM provider configuration."}),n?(0,c.jsxs)(W.Z,{className:"border border-yellow-300 bg-yellow-50",children:[(0,c.jsxs)("div",{className:"flex items-center mb-2 text-yellow-800",children:[(0,c.jsx)(lI.Z,{className:"h-5 w-5 mr-2"}),(0,c.jsx)(k.Z,{className:"text-lg text-yellow-800",children:"Your SCIM Token"})]}),(0,c.jsx)(w.Z,{className:"text-yellow-800 mb-4 font-medium",children:"Make sure to copy this token now. You will not be able to see it again."}),(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(y.Z,{value:n.key,className:"flex-grow mr-2 bg-white",type:"password",disabled:!0}),(0,c.jsx)(S.CopyToClipboard,{text:n.key,onCopy:()=>P.ZP.success("Token copied to clipboard"),children:(0,c.jsxs)(_.Z,{variant:"primary",className:"flex items-center",children:[(0,c.jsx)(tC.Z,{className:"h-4 w-4 mr-1"}),"Copy"]})})]}),(0,c.jsxs)(_.Z,{className:"mt-4 flex items-center",variant:"secondary",onClick:()=>o(null),children:[(0,c.jsx)(lP.Z,{className:"h-4 w-4 mr-1"}),"Create Another Token"]})]}):(0,c.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,c.jsxs)(I.Z,{form:a,onFinish:h,layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{name:"key_alias",label:"Token Name",rules:[{required:!0,message:"Please enter a name for your token"}],children:(0,c.jsx)(y.Z,{placeholder:"SCIM Access Token"})}),(0,c.jsx)(I.Z.Item,{children:(0,c.jsxs)(_.Z,{variant:"primary",type:"submit",loading:r,className:"flex items-center",children:[(0,c.jsx)(lC.Z,{className:"h-4 w-4 mr-1"}),"Create SCIM Token"]})})]})})]})]})]})})},lT=e=>{let{accessToken:s,onSuccess:t}=e,[l]=I.Z.useForm(),[a,r]=(0,d.useState)(!1);(0,d.useEffect)(()=>{(async()=>{if(s)try{let e=await (0,g.getSSOSettings)(s);if(e&&e.values){let s=e.values.ui_access_mode,t={};s&&"object"==typeof s?t={ui_access_mode_type:s.type,restricted_sso_group:s.restricted_sso_group,sso_group_jwt_field:s.sso_group_jwt_field}:"string"==typeof s&&(t={ui_access_mode_type:s,restricted_sso_group:e.values.restricted_sso_group,sso_group_jwt_field:e.values.team_ids_jwt_field||e.values.sso_group_jwt_field}),l.setFieldsValue(t)}}catch(e){console.error("Failed to load UI access settings:",e)}})()},[s,l]);let i=async e=>{if(!s){P.ZP.error("No access token available");return}r(!0);try{let l={ui_access_mode:{type:e.ui_access_mode_type,restricted_sso_group:e.restricted_sso_group,sso_group_jwt_field:e.sso_group_jwt_field}};await (0,g.updateSSOSettings)(s,l),t()}catch(e){console.error("Failed to save UI access settings:",e),P.ZP.error("Failed to save UI access settings")}finally{r(!1)}};return(0,c.jsxs)("div",{style:{padding:"16px"},children:[(0,c.jsx)("div",{style:{marginBottom:"16px"},children:(0,c.jsx)(w.Z,{style:{fontSize:"14px",color:"#6b7280"},children:"Configure who can access the UI interface and how group information is extracted from JWT tokens."})}),(0,c.jsxs)(I.Z,{form:l,onFinish:i,layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{label:"UI Access Mode",name:"ui_access_mode_type",tooltip:"Controls who can access the UI interface",children:(0,c.jsxs)(C.default,{placeholder:"Select access mode",children:[(0,c.jsx)(C.default.Option,{value:"all_authenticated_users",children:"All Authenticated Users"}),(0,c.jsx)(C.default.Option,{value:"restricted_sso_group",children:"Restricted SSO Group"})]})}),(0,c.jsx)(I.Z.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.ui_access_mode_type!==s.ui_access_mode_type,children:e=>{let{getFieldValue:s}=e;return"restricted_sso_group"===s("ui_access_mode_type")?(0,c.jsx)(I.Z.Item,{label:"Restricted SSO Group",name:"restricted_sso_group",rules:[{required:!0,message:"Please enter the restricted SSO group"}],children:(0,c.jsx)(y.Z,{placeholder:"ui-access-group"})}):null}}),(0,c.jsx)(I.Z.Item,{label:"SSO Group JWT Field",name:"sso_group_jwt_field",tooltip:"JWT field name that contains team/group information. Use dot notation to access nested fields.",children:(0,c.jsx)(y.Z,{placeholder:"groups"})}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"16px"},children:(0,c.jsx)(T.ZP,{type:"primary",htmlType:"submit",loading:a,style:{backgroundColor:"#6366f1",borderColor:"#6366f1"},children:"Update UI Access Control"})})]})]})},lL=t(382),lO=e=>{let{searchParams:s,accessToken:t,userID:l,showSSOBanner:a,premiumUser:r,proxySettings:i,userRole:n}=e,[o]=I.Z.useForm(),[u]=I.Z.useForm(),{Title:x,Paragraph:h}=em.default,[p,j]=(0,d.useState)(""),[f,v]=(0,d.useState)(null),[y,b]=(0,d.useState)(null),[N,Z]=(0,d.useState)(!1),[w,k]=(0,d.useState)(!1),[S,C]=(0,d.useState)(!1),[E,O]=(0,d.useState)(!1),[M,D]=(0,d.useState)(!1),[F,R]=(0,d.useState)(!1),[q,U]=(0,d.useState)(!1),[z,V]=(0,d.useState)(!1),[K,B]=(0,d.useState)(!1),[G,H]=(0,d.useState)(!1),[J,Y]=(0,d.useState)([]),[$,Q]=(0,d.useState)(null),[X,ee]=(0,d.useState)(!1);(0,m.useRouter)();let[es,et]=(0,d.useState)(null);console.log=function(){};let el=sh(),ea="All IP Addresses Allowed",er=el;er+="/fallback/login";let ei=async()=>{if(t&&r)try{let e=await (0,g.getSSOSettings)(t);if(console.log("SSO data:",e),e&&e.values){let s=e.values.google_client_id&&e.values.google_client_secret,t=e.values.microsoft_client_id&&e.values.microsoft_client_secret,l=e.values.generic_client_id&&e.values.generic_client_secret;ee(s||t||l)}else ee(!1)}catch(e){console.error("Error checking SSO configuration:",e),ee(!1)}},en=async()=>{try{if(!0!==r){P.ZP.error("This feature is only available for premium users. Please upgrade your account.");return}if(t){let e=await (0,g.getAllowedIPs)(t);Y(e&&e.length>0?e:[ea])}else Y([ea])}catch(e){console.error("Error fetching allowed IPs:",e),P.ZP.error("Failed to fetch allowed IPs ".concat(e)),Y([ea])}finally{!0===r&&U(!0)}},eo=async e=>{try{if(t){await (0,g.addAllowedIP)(t,e.ip);let s=await (0,g.getAllowedIPs)(t);Y(s),P.ZP.success("IP address added successfully")}}catch(e){console.error("Error adding IP:",e),P.ZP.error("Failed to add IP address ".concat(e))}finally{V(!1)}},ec=async e=>{Q(e),B(!0)},ed=async()=>{if($&&t)try{await (0,g.deleteAllowedIP)(t,$);let e=await (0,g.getAllowedIPs)(t);Y(e.length>0?e:[ea]),P.ZP.success("IP address deleted successfully")}catch(e){console.error("Error deleting IP:",e),P.ZP.error("Failed to delete IP address ".concat(e))}finally{B(!1),Q(null)}};(0,d.useEffect)(()=>{(async()=>{if(null!=t){let e=[],s=await (0,g.userGetAllUsersCall)(t,"proxy_admin_viewer");console.log("proxy admin viewer response: ",s);let l=s.users;console.log("proxy viewers response: ".concat(l)),l.forEach(s=>{e.push({user_role:s.user_role,user_id:s.user_id,user_email:s.user_email})}),console.log("proxy viewers: ".concat(l));let a=(await (0,g.userGetAllUsersCall)(t,"proxy_admin")).users;a.forEach(s=>{e.push({user_role:s.user_role,user_id:s.user_id,user_email:s.user_email})}),console.log("proxy admins: ".concat(a)),console.log("combinedList: ".concat(e)),v(e),et(await (0,g.getPossibleUserRoles)(t))}})()},[t]),(0,d.useEffect)(()=>{ei()},[t,r]);let eu=()=>{H(!1)};return console.log("admins: ".concat(null==f?void 0:f.length)),(0,c.jsxs)("div",{className:"w-full m-2 mt-2 p-8",children:[(0,c.jsx)(x,{level:4,children:"Admin Access "}),(0,c.jsx)(h,{children:"Go to 'Internal Users' page to add other admins."}),(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{children:[(0,c.jsx)(eY.Z,{children:"Security Settings"}),(0,c.jsx)(eY.Z,{children:"SCIM"}),(0,c.jsx)(eY.Z,{children:"Useful Links"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(x,{level:4,children:" ✨ Security Settings"}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginTop:"1rem",marginLeft:"0.5rem"},children:[(0,c.jsx)("div",{children:(0,c.jsx)(_.Z,{style:{width:"150px"},onClick:()=>!0===r?D(!0):P.ZP.error("Only premium users can add SSO"),children:X?"Edit SSO Settings":"Add SSO"})}),(0,c.jsx)("div",{children:(0,c.jsx)(_.Z,{style:{width:"150px"},onClick:en,children:"Allowed IPs"})}),(0,c.jsx)("div",{children:(0,c.jsx)(_.Z,{style:{width:"150px"},onClick:()=>!0===r?H(!0):P.ZP.error("Only premium users can configure UI access control"),children:"UI Access Control"})})]})]}),(0,c.jsxs)("div",{className:"flex justify-start mb-4",children:[(0,c.jsx)(lk,{isAddSSOModalVisible:M,isInstructionsModalVisible:F,handleAddSSOOk:()=>{D(!1),o.resetFields(),t&&r&&ei()},handleAddSSOCancel:()=>{D(!1),o.resetFields()},handleShowInstructions:e=>{D(!1),R(!0)},handleInstructionsOk:()=>{R(!1),t&&r&&ei()},handleInstructionsCancel:()=>{R(!1),t&&r&&ei()},form:o,accessToken:t,ssoConfigured:X}),(0,c.jsx)(A.Z,{title:"Manage Allowed IP Addresses",width:800,visible:q,onCancel:()=>U(!1),footer:[(0,c.jsx)(_.Z,{className:"mx-1",onClick:()=>V(!0),children:"Add IP Address"},"add"),(0,c.jsx)(_.Z,{onClick:()=>U(!1),children:"Close"},"close")],children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"IP Address"}),(0,c.jsx)(sb.Z,{className:"text-right",children:"Action"})]})}),(0,c.jsx)(sv.Z,{children:J.map((e,s)=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:e}),(0,c.jsx)(s_.Z,{className:"text-right",children:e!==ea&&(0,c.jsx)(_.Z,{onClick:()=>ec(e),color:"red",size:"xs",children:"Delete"})})]},s))})]})}),(0,c.jsx)(A.Z,{title:"Add Allowed IP Address",visible:z,onCancel:()=>V(!1),footer:null,children:(0,c.jsxs)(I.Z,{onFinish:eo,children:[(0,c.jsx)(I.Z.Item,{name:"ip",rules:[{required:!0,message:"Please enter an IP address"}],children:(0,c.jsx)(L.default,{placeholder:"Enter IP address"})}),(0,c.jsx)(I.Z.Item,{children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Add IP Address"})})]})}),(0,c.jsx)(A.Z,{title:"Confirm Delete",visible:K,onCancel:()=>B(!1),onOk:ed,footer:[(0,c.jsx)(_.Z,{className:"mx-1",onClick:()=>ed(),children:"Yes"},"delete"),(0,c.jsx)(_.Z,{onClick:()=>B(!1),children:"Close"},"close")],children:(0,c.jsxs)("p",{children:["Are you sure you want to delete the IP address: ",$,"?"]})}),(0,c.jsx)(A.Z,{title:"UI Access Control Settings",visible:G,width:600,footer:null,onOk:eu,onCancel:()=>{H(!1)},children:(0,c.jsx)(lT,{accessToken:t,onSuccess:()=>{eu(),P.ZP.success("UI Access Control settings updated successfully")}})})]}),(0,c.jsxs)(lN.Z,{title:"Login without SSO",color:"teal",children:["If you need to login without sso, you can access"," ",(0,c.jsxs)("a",{href:er,target:"_blank",children:[(0,c.jsx)("b",{children:er})," "]})]})]}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(lE,{accessToken:t,userID:l,proxySettings:i})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(lL.Z,{accessToken:t,userRole:n||null})})]})]})]})};let{Title:lM}=em.default;var lD=e=>{let{accessToken:s}=e,[t,l]=(0,d.useState)(!0),[a,r]=(0,d.useState)([]);(0,d.useEffect)(()=>{i()},[s]);let i=async()=>{if(s){l(!0);try{let e=await (0,g.getEmailEventSettings)(s);r(e.settings)}catch(e){console.error("Failed to fetch email event settings:",e),P.ZP.error("Failed to fetch email event settings")}finally{l(!1)}}},n=(e,s)=>{r(a.map(t=>t.event===e?{...t,enabled:s}:t))},o=async()=>{if(s)try{await (0,g.updateEmailEventSettings)(s,{settings:a}),P.ZP.success("Email event settings updated successfully")}catch(e){console.error("Failed to update email event settings:",e),P.ZP.error("Failed to update email event settings")}},m=async()=>{if(s)try{await (0,g.resetEmailEventSettings)(s),P.ZP.success("Email event settings reset to defaults"),i()}catch(e){console.error("Failed to reset email event settings:",e),P.ZP.error("Failed to reset email event settings")}},u=e=>{if(e.includes("Virtual Key Created"))return"An email will be sent to the user when a new virtual key is created with their user ID";if(e.includes("New User Invitation"))return"An email will be sent to the email address of the user when a new user is created";{let s=e.split(/(?=[A-Z])/).join(" ").toLowerCase();return"Receive an email notification when ".concat(s)}};return(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(lM,{level:4,children:"Email Notifications"}),(0,c.jsx)(w.Z,{children:"Select which events should trigger email notifications."}),(0,c.jsx)(Y.Z,{}),t?(0,c.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:(0,c.jsx)(lm.Z,{size:"large"})}):(0,c.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(s2.Z,{checked:e.enabled,onChange:s=>n(e.event,s.target.checked)}),(0,c.jsxs)("div",{className:"ml-3",children:[(0,c.jsx)(w.Z,{children:e.event}),(0,c.jsx)("div",{className:"text-sm text-gray-500 block",children:u(e.event)})]})]},e.event))}),(0,c.jsxs)("div",{className:"mt-6 flex space-x-4",children:[(0,c.jsx)(_.Z,{onClick:o,disabled:t,children:"Save Changes"}),(0,c.jsx)(_.Z,{onClick:m,variant:"secondary",disabled:t,children:"Reset to Defaults"})]})]})};let{Title:lF}=em.default;var lR=e=>{let{accessToken:s,premiumUser:t,alerts:l}=e,a=()=>{if(!s)return;let e={};l.filter(e=>"email"===e.name).forEach(s=>{var t;Object.entries(null!==(t=s.variables)&&void 0!==t?t:{}).forEach(s=>{let[t,l]=s,a=document.querySelector('input[name="'.concat(t,'"]'));a&&a.value&&(e[t]=null==a?void 0:a.value)})}),console.log("updatedVariables",e);try{(0,g.setCallbacksCall)(s,{general_settings:{alerting:["email"]},environment_variables:e})}catch(e){P.ZP.error("Failed to update alerts: "+e,20)}P.ZP.success("Email settings updated successfully")};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"mt-6 mb-6",children:(0,c.jsx)(lD,{accessToken:s})}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(lF,{level:4,children:"Email Server Settings"}),(0,c.jsxs)(w.Z,{children:[(0,c.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",style:{color:"blue"},children:" LiteLLM Docs: email alerts"})," ",(0,c.jsx)("br",{})]}),(0,c.jsx)("div",{className:"flex w-full",children:l.filter(e=>"email"===e.name).map((e,s)=>{var l;return(0,c.jsx)(s_.Z,{children:(0,c.jsx)("ul",{children:(0,c.jsx)(v.Z,{numItems:2,children:Object.entries(null!==(l=e.variables)&&void 0!==l?l:{}).map(e=>{let[s,l]=e;return(0,c.jsxs)("li",{className:"mx-2 my-2",children:[!0!=t&&("EMAIL_LOGO_URL"===s||"EMAIL_SUPPORT_CONTACT"===s)?(0,c.jsxs)("div",{children:[(0,c.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:(0,c.jsxs)(w.Z,{className:"mt-2",children:[" ","✨ ",s]})}),(0,c.jsx)(y.Z,{name:s,defaultValue:l,type:"password",disabled:!0,style:{width:"400px"}})]}):(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"mt-2",children:s}),(0,c.jsx)(y.Z,{name:s,defaultValue:l,type:"password",style:{width:"400px"}})]}),(0,c.jsxs)("p",{style:{fontSize:"small",fontStyle:"italic"},children:["SMTP_HOST"===s&&(0,c.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP host address, e.g. `smtp.resend.com`",(0,c.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PORT"===s&&(0,c.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP port number, e.g. `587`",(0,c.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_USERNAME"===s&&(0,c.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP username, e.g. `username`",(0,c.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PASSWORD"===s&&(0,c.jsx)("span",{style:{color:"red"},children:" Required * "}),"SMTP_SENDER_EMAIL"===s&&(0,c.jsxs)("div",{style:{color:"gray"},children:["Enter the sender email address, e.g. `sender@berri.ai`",(0,c.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"TEST_EMAIL_ADDRESS"===s&&(0,c.jsxs)("div",{style:{color:"gray"},children:["Email Address to send `Test Email Alert` to. example: `info@berri.ai`",(0,c.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"EMAIL_LOGO_URL"===s&&(0,c.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the Logo that appears in the email, pass a url to your logo"}),"EMAIL_SUPPORT_CONTACT"===s&&(0,c.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the support email address that appears in the email. Default is support@berri.ai"})]})]},s)})})})},s)})}),(0,c.jsx)(_.Z,{className:"mt-2",onClick:()=>a(),children:"Save Changes"}),(0,c.jsx)(_.Z,{onClick:()=>s&&(0,g.serviceHealthCheck)(s,"email"),className:"mx-2",children:"Test Email Alerts"})]})]})},lq=e=>{let{alertingSettings:s,handleInputChange:t,handleResetField:l,handleSubmit:a,premiumUser:r}=e,[i]=I.Z.useForm();return(0,c.jsxs)(I.Z,{form:i,onFinish:()=>{console.log("INSIDE ONFINISH");let e=i.getFieldsValue(),s=Object.entries(e).every(e=>{let[s,t]=e;return"boolean"!=typeof t&&(""===t||null==t)});console.log("formData: ".concat(JSON.stringify(e),", isEmpty: ").concat(s)),s?console.log("Some form fields are empty."):a(e)},labelAlign:"left",children:[s.map((e,s)=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsxs)(s_.Z,{align:"center",children:[(0,c.jsx)(w.Z,{children:e.field_name}),(0,c.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:e.field_description})]}),e.premium_field?r?(0,c.jsx)(I.Z.Item,{name:e.field_name,children:(0,c.jsx)(s_.Z,{children:"Integer"===e.field_type?(0,c.jsx)(q.Z,{step:1,value:e.field_value,onChange:s=>t(e.field_name,s)}):"Boolean"===e.field_type?(0,c.jsx)(tE.Z,{checked:e.field_value,onChange:s=>t(e.field_name,s)}):(0,c.jsx)(L.default,{value:e.field_value,onChange:s=>t(e.field_name,s)})})}):(0,c.jsx)(s_.Z,{children:(0,c.jsx)(_.Z,{className:"flex items-center justify-center",children:(0,c.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})})}):(0,c.jsx)(I.Z.Item,{name:e.field_name,className:"mb-0",valuePropName:"Boolean"===e.field_type?"checked":"value",children:(0,c.jsx)(s_.Z,{children:"Integer"===e.field_type?(0,c.jsx)(q.Z,{step:1,value:e.field_value,onChange:s=>t(e.field_name,s),className:"p-0"}):"Boolean"===e.field_type?(0,c.jsx)(tE.Z,{checked:e.field_value,onChange:s=>{t(e.field_name,s),i.setFieldsValue({[e.field_name]:s})}}):(0,c.jsx)(L.default,{value:e.field_value,onChange:s=>t(e.field_name,s)})})}),(0,c.jsx)(s_.Z,{children:!0==e.stored_in_db?(0,c.jsx)(eJ.Z,{icon:eZ.Z,className:"text-white",children:"In DB"}):!1==e.stored_in_db?(0,c.jsx)(eJ.Z,{className:"text-gray bg-white outline",children:"In Config"}):(0,c.jsx)(eJ.Z,{className:"text-gray bg-white outline",children:"Not Set"})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(sj.Z,{icon:ee.Z,color:"red",onClick:()=>l(e.field_name,s),children:"Reset"})})]},s)),(0,c.jsx)("div",{children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Update Settings"})})]})},lU=e=>{let{accessToken:s,premiumUser:t}=e,[l,a]=(0,d.useState)([]);return(0,d.useEffect)(()=>{s&&(0,g.alertingSettingsCall)(s).then(e=>{a(e)})},[s]),(0,c.jsx)(lq,{alertingSettings:l,handleInputChange:(e,s)=>{let t=l.map(t=>t.field_name===e?{...t,field_value:s}:t);console.log("updatedSettings: ".concat(JSON.stringify(t))),a(t)},handleResetField:(e,t)=>{if(s)try{let s=l.map(s=>s.field_name===e?{...s,stored_in_db:null,field_value:s.field_default_value}:s);a(s)}catch(e){console.log("ERROR OCCURRED!")}},handleSubmit:e=>{if(!s||(console.log("formValues: ".concat(e)),null==e||void 0==e))return;let t={};l.forEach(e=>{t[e.field_name]=e.field_value});let a={...e,...t};console.log("mergedFormValues: ".concat(JSON.stringify(a)));let{slack_alerting:r,...i}=a;console.log("slack_alerting: ".concat(r,", alertingArgs: ").concat(JSON.stringify(i)));try{(0,g.updateConfigFieldSetting)(s,"alerting_args",i),"boolean"==typeof r&&(!0==r?(0,g.updateConfigFieldSetting)(s,"alerting",["slack"]):(0,g.updateConfigFieldSetting)(s,"alerting",[])),P.ZP.success("Wait 10s for proxy to update.")}catch(e){}},premiumUser:t})},lz=t(38994);let{Title:lV,Paragraph:lK}=em.default;var lB=e=>{let{accessToken:s,userRole:t,userID:l,premiumUser:a}=e,[r,n]=(0,d.useState)([]),[o,m]=(0,d.useState)([]),[u,x]=(0,d.useState)(!1),[h]=I.Z.useForm(),[p,j]=(0,d.useState)(null),[f,b]=(0,d.useState)(""),[N,Z]=(0,d.useState)({}),[k,S]=(0,d.useState)([]),[E,L]=(0,d.useState)(!1),[O,M]=(0,d.useState)([]),[D,F]=(0,d.useState)([]),[R,q]=(0,d.useState)(!1),[U,z]=(0,d.useState)(null),[V,K]=(0,d.useState)(!1),[B,G]=(0,d.useState)(null),H=e=>{k.includes(e)?S(k.filter(s=>s!==e)):S([...k,e])},J={llm_exceptions:"LLM Exceptions",llm_too_slow:"LLM Responses Too Slow",llm_requests_hanging:"LLM Requests Hanging",budget_alerts:"Budget Alerts (API Keys, Users)",db_exceptions:"Database Exceptions (Read/Write)",daily_reports:"Weekly/Monthly Spend Reports",outage_alerts:"Outage Alerts",region_outage_alerts:"Region Outage Alerts"};(0,d.useEffect)(()=>{s&&t&&l&&(0,g.getCallbacksCall)(s,l,t).then(e=>{n(e.callbacks),M(e.available_callbacks);let s=e.alerts;if(s&&s.length>0){let e=s[0],t=e.variables.SLACK_WEBHOOK_URL;S(e.active_alerts),b(t),Z(e.alerts_to_webhook)}m(s)})},[s,t,l]);let Y=e=>k&&k.includes(e),$=async e=>{if(!s)return;let t={};Object.entries(e).forEach(e=>{let[s,l]=e;"callback"!==s&&(t[s]=l)});try{await (0,g.setCallbacksCall)(s,{environment_variables:t}),P.ZP.success("Callback added successfully"),x(!1),h.resetFields(),j(null)}catch(e){P.ZP.error("Failed to add callback: "+e,20)}},Q=async e=>{if(!s)return;let t=null==e?void 0:e.callback,l={};Object.entries(e).forEach(e=>{let[s,t]=e;"callback"!==s&&(l[s]=t)});try{await (0,g.setCallbacksCall)(s,{environment_variables:l,litellm_settings:{success_callback:[t]}}),P.ZP.success("Callback ".concat(t," added successfully")),x(!1),h.resetFields(),j(null)}catch(e){P.ZP.error("Failed to add callback: "+e,20)}},X=e=>{j(e.litellm_callback_name),e&&e.litellm_callback_params?F(e.litellm_callback_params):F([])},et=e=>{G(e),K(!0)},el=async()=>{if(B&&s)try{if(await (0,g.deleteCallback)(s,B),P.ZP.success("Callback ".concat(B," deleted successfully")),l&&t){let e=await (0,g.getCallbacksCall)(s,l,t);n(e.callbacks)}K(!1),G(null)}catch(e){console.error("Failed to delete callback:",e),P.ZP.error("Failed to delete callback: ".concat(e))}};return s?(0,c.jsxs)("div",{className:"w-full mx-4",children:[(0,c.jsx)(v.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{variant:"line",defaultValue:"1",children:[(0,c.jsx)(eY.Z,{value:"1",children:"Logging Callbacks"}),(0,c.jsx)(eY.Z,{value:"2",children:"Alerting Types"}),(0,c.jsx)(eY.Z,{value:"3",children:"Alerting Settings"}),(0,c.jsx)(eY.Z,{value:"4",children:"Email Alerts"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsx)(lV,{level:4,children:"Active Logging Callbacks"}),(0,c.jsx)(v.Z,{numItems:2,children:(0,c.jsx)(W.Z,{className:"max-h-[50vh]",children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsx)(sN.Z,{children:(0,c.jsx)(sb.Z,{children:"Callback Name"})})}),(0,c.jsx)(sv.Z,{children:r.map((e,t)=>(0,c.jsxs)(sN.Z,{className:"flex justify-between",children:[(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{children:e.name})}),(0,c.jsx)(s_.Z,{children:(0,c.jsxs)(v.Z,{numItems:2,className:"flex justify-between",children:[(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>{z(e),q(!0)}}),(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>et(e.name),className:"text-red-500 hover:text-red-700 cursor-pointer"}),(0,c.jsx)(_.Z,{onClick:()=>(0,g.serviceHealthCheck)(s,e.name),className:"ml-2",variant:"secondary",children:"Test Callback"})]})})]},t))})]})})}),(0,c.jsx)(_.Z,{className:"mt-2",onClick:()=>L(!0),children:"Add Callback"})]}),(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)(w.Z,{className:"my-2",children:["Alerts are only supported for Slack Webhook URLs. Get your webhook urls from"," ",(0,c.jsx)("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",style:{color:"blue"},children:"here"})]}),(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{}),(0,c.jsx)(sb.Z,{}),(0,c.jsx)(sb.Z,{children:"Slack Webhook URL"})]})}),(0,c.jsx)(sv.Z,{children:Object.entries(J).map((e,s)=>{let[t,l]=e;return(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:"region_outage_alerts"==t?a?(0,c.jsx)(tE.Z,{id:"switch",name:"switch",checked:Y(t),onChange:()=>H(t)}):(0,c.jsx)(_.Z,{className:"flex items-center justify-center",children:(0,c.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})}):(0,c.jsx)(tE.Z,{id:"switch",name:"switch",checked:Y(t),onChange:()=>H(t)})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(w.Z,{children:l})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(y.Z,{name:t,type:"password",defaultValue:N&&N[t]?N[t]:f})})]},s)})})]}),(0,c.jsx)(_.Z,{size:"xs",className:"mt-2",onClick:()=>{if(!s)return;let e={};Object.entries(J).forEach(s=>{let[t,l]=s,a=document.querySelector('input[name="'.concat(t,'"]')),r=(null==a?void 0:a.value)||"";e[t]=r});try{(0,g.setCallbacksCall)(s,{general_settings:{alert_to_webhook_url:e,alert_types:k}})}catch(e){P.ZP.error("Failed to update alerts: "+e,20)}P.ZP.success("Alerts updated successfully")},children:"Save Changes"}),(0,c.jsx)(_.Z,{onClick:()=>(0,g.serviceHealthCheck)(s,"slack"),className:"mx-2",children:"Test Alerts"})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(lU,{accessToken:s,premiumUser:a})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(lR,{accessToken:s,premiumUser:a,alerts:o})})]})]})}),(0,c.jsxs)(A.Z,{title:"Add Logging Callback",visible:E,width:800,onCancel:()=>L(!1),footer:null,children:[(0,c.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/logging",className:"mb-8 mt-4",target:"_blank",style:{color:"blue"},children:[" ","LiteLLM Docs: Logging"]}),(0,c.jsx)(I.Z,{form:h,onFinish:Q,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(lz.Z,{label:"Callback",name:"callback",rules:[{required:!0,message:"Please select a callback"}],children:(0,c.jsx)(C.default,{onChange:e=>{let s=O[e];s&&X(s)},children:Object.entries(i).map(e=>{var s;let[t,l]=e;return(0,c.jsx)(ed.Z,{value:es[t],children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(null===(s=ei[l])||void 0===s?void 0:s.logo)?(0,c.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,c.jsx)("img",{src:ei[l].logo,alt:"".concat(t," logo"),className:"w-5 h-5",onError:e=>{e.currentTarget.style.display="none"}})}):(0,c.jsx)("div",{className:"w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",children:l.charAt(0).toUpperCase()}),(0,c.jsx)("span",{children:l})]})},l)})})}),D&&D.map(e=>(0,c.jsx)(lz.Z,{label:e,name:e,rules:[{required:!0,message:"Please enter the value for "+e}],children:(0,c.jsx)(y.Z,{type:"password"})},e)),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Save"})})]})})]}),(0,c.jsx)(A.Z,{visible:R,width:800,title:"Edit ".concat(null==U?void 0:U.name," Settings"),onCancel:()=>q(!1),footer:null,children:(0,c.jsxs)(I.Z,{form:h,onFinish:$,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsx)(c.Fragment,{children:U&&U.variables&&Object.entries(U.variables).map(e=>{let[s,t]=e;return(0,c.jsx)(lz.Z,{label:s,name:s,children:(0,c.jsx)(y.Z,{type:"password",defaultValue:t})},s)})}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Save"})})]})}),(0,c.jsx)(A.Z,{title:"Confirm Delete",visible:V,onOk:el,onCancel:()=>{K(!1),G(null)},okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},children:(0,c.jsxs)("p",{children:["Are you sure you want to delete the callback - ",B,"? This action cannot be undone."]})})]}):null},lG=t(92414),lH=t(46030);let{Option:lJ}=C.default;var lY=e=>{let{models:s,accessToken:t,routerSettings:l,setRouterSettings:a}=e,[r]=I.Z.useForm(),[i,n]=(0,d.useState)(!1),[o,m]=(0,d.useState)("");return(0,c.jsxs)("div",{children:[(0,c.jsx)(_.Z,{className:"mx-auto",onClick:()=>n(!0),children:"+ Add Fallbacks"}),(0,c.jsx)(A.Z,{title:"Add Fallbacks",visible:i,width:800,footer:null,onOk:()=>{n(!1),r.resetFields()},onCancel:()=>{n(!1),r.resetFields()},children:(0,c.jsxs)(I.Z,{form:r,onFinish:e=>{console.log(e);let{model_name:s,models:i}=e,o=[...l.fallbacks||[],{[s]:i}],c={...l,fallbacks:o};console.log(c);try{(0,g.setCallbacksCall)(t,{router_settings:c}),a(c)}catch(e){P.ZP.error("Failed to update router settings: "+e,20)}P.ZP.success("router settings updated successfully"),n(!1),r.resetFields()},labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{label:"Public Model Name",name:"model_name",rules:[{required:!0,message:"Set the model to fallback for"}],help:"required",children:(0,c.jsx)(eH.Z,{defaultValue:o,children:s&&s.map((e,s)=>(0,c.jsx)(ed.Z,{value:e,onClick:()=>m(e),children:e},s))})}),(0,c.jsx)(I.Z.Item,{label:"Fallback Models",name:"models",rules:[{required:!0,message:"Please select a model"}],help:"required",children:(0,c.jsx)(lG.Z,{value:s,children:s&&s.filter(e=>e!=o).map(e=>(0,c.jsx)(lH.Z,{value:e,children:e},e))})})]}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Add Fallbacks"})})]})})]})},lW=t(26433);async function l$(e,s){console.log=function(){},console.log("isLocal:",!1);let t=window.location.origin,l=new lW.ZP.OpenAI({apiKey:s,baseURL:t,dangerouslyAllowBrowser:!0});try{let s=await l.chat.completions.create({model:e,messages:[{role:"user",content:"Hi, this is a test message"}],mock_testing_fallbacks:!0});P.ZP.success((0,c.jsxs)("span",{children:["Test model=",(0,c.jsx)("strong",{children:e}),", received model=",(0,c.jsx)("strong",{children:s.model}),". See"," ",(0,c.jsx)("a",{href:"#",onClick:()=>window.open("https://docs.litellm.ai/docs/proxy/reliability","_blank"),style:{textDecoration:"underline",color:"blue"},children:"curl"})]}))}catch(e){P.ZP.error("Error occurred while generating model response. Please try again. Error: ".concat(e),20)}}let lQ={ttl:3600,lowest_latency_buffer:0},lX=e=>{let{selectedStrategy:s,strategyArgs:t,paramExplanation:l}=e;return(0,c.jsxs)(b.Z,{children:[(0,c.jsx)(Z.Z,{className:"text-sm font-medium text-tremor-content-strong dark:text-dark-tremor-content-strong",children:"Routing Strategy Specific Args"}),(0,c.jsx)(N.Z,{children:"latency-based-routing"==s?(0,c.jsx)(W.Z,{children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Setting"}),(0,c.jsx)(sb.Z,{children:"Value"})]})}),(0,c.jsx)(sv.Z,{children:Object.entries(t).map(e=>{let[s,t]=e;return(0,c.jsxs)(sN.Z,{children:[(0,c.jsxs)(s_.Z,{children:[(0,c.jsx)(w.Z,{children:s}),(0,c.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:l[s]})]}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(y.Z,{name:s,defaultValue:"object"==typeof t?JSON.stringify(t,null,2):t.toString()})})]},s)})})]})}):(0,c.jsx)(w.Z,{children:"No specific settings"})})]})};var l0=e=>{let{accessToken:s,userRole:t,userID:l,modelData:a}=e,[r,i]=(0,d.useState)({}),[n,o]=(0,d.useState)({}),[m,u]=(0,d.useState)([]),[x,h]=(0,d.useState)(!1),[p]=I.Z.useForm(),[j,b]=(0,d.useState)(null),[N,Z]=(0,d.useState)(null),[S,C]=(0,d.useState)(null),A={routing_strategy_args:"(dict) Arguments to pass to the routing strategy",routing_strategy:"(string) Routing strategy to use",allowed_fails:"(int) Number of times a deployment can fail before being added to cooldown",cooldown_time:"(int) time in seconds to cooldown a deployment after failure",num_retries:"(int) Number of retries for failed requests. Defaults to 0.",timeout:"(float) Timeout for requests. Defaults to None.",retry_after:"(int) Minimum time to wait before retrying a failed request",ttl:"(int) Sliding window to look back over when calculating the average latency of a deployment. Default - 1 hour (in seconds).",lowest_latency_buffer:"(float) Shuffle between deployments within this % of the lowest latency. Default - 0 (i.e. always pick lowest latency)."};(0,d.useEffect)(()=>{s&&t&&l&&((0,g.getCallbacksCall)(s,l,t).then(e=>{console.log("callbacks",e);let s=e.router_settings;"model_group_retry_policy"in s&&delete s.model_group_retry_policy,i(s)}),(0,g.getGeneralSettingsCall)(s).then(e=>{u(e)}))},[s,t,l]);let E=async e=>{if(!s)return;console.log("received key: ".concat(e)),console.log("routerSettings['fallbacks']: ".concat(r.fallbacks));let t=r.fallbacks.map(s=>(e in s&&delete s[e],s)).filter(e=>Object.keys(e).length>0),l={...r,fallbacks:t};try{await (0,g.setCallbacksCall)(s,{router_settings:l}),i(l),P.ZP.success("Router settings updated successfully")}catch(e){P.ZP.error("Failed to update router settings: "+e,20)}},T=(e,s)=>{u(m.map(t=>t.field_name===e?{...t,field_value:s}:t))},L=(e,t)=>{if(!s)return;let l=m[t].field_value;if(null!=l&&void 0!=l)try{(0,g.updateConfigFieldSetting)(s,e,l);let t=m.map(s=>s.field_name===e?{...s,stored_in_db:!0}:s);u(t)}catch(e){}},O=(e,t)=>{if(s)try{(0,g.deleteConfigFieldSetting)(s,e);let t=m.map(s=>s.field_name===e?{...s,stored_in_db:null,field_value:null}:s);u(t)}catch(e){}},M=e=>{if(!s)return;console.log("router_settings",e);let t=Object.fromEntries(Object.entries(e).map(e=>{let[s,t]=e;if("routing_strategy_args"!==s&&"routing_strategy"!==s){var l;return[s,(null===(l=document.querySelector('input[name="'.concat(s,'"]')))||void 0===l?void 0:l.value)||t]}if("routing_strategy"==s)return[s,N];if("routing_strategy_args"==s&&"latency-based-routing"==N){let e={},s=document.querySelector('input[name="lowest_latency_buffer"]'),t=document.querySelector('input[name="ttl"]');return(null==s?void 0:s.value)&&(e.lowest_latency_buffer=Number(s.value)),(null==t?void 0:t.value)&&(e.ttl=Number(t.value)),console.log("setRoutingStrategyArgs: ".concat(e)),["routing_strategy_args",e]}return null}).filter(e=>null!=e));console.log("updatedVariables",t);try{(0,g.setCallbacksCall)(s,{router_settings:t})}catch(e){P.ZP.error("Failed to update router settings: "+e,20)}P.ZP.success("router settings updated successfully")};return s?(0,c.jsx)("div",{className:"w-full mx-4",children:(0,c.jsxs)(eW.Z,{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,c.jsxs)(e$.Z,{variant:"line",defaultValue:"1",children:[(0,c.jsx)(eY.Z,{value:"1",children:"Loadbalancing"}),(0,c.jsx)(eY.Z,{value:"2",children:"Fallbacks"}),(0,c.jsx)(eY.Z,{value:"3",children:"General"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(v.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:[(0,c.jsx)(k.Z,{children:"Router Settings"}),(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Setting"}),(0,c.jsx)(sb.Z,{children:"Value"})]})}),(0,c.jsx)(sv.Z,{children:Object.entries(r).filter(e=>{let[s,t]=e;return"fallbacks"!=s&&"context_window_fallbacks"!=s&&"routing_strategy_args"!=s}).map(e=>{let[s,t]=e;return(0,c.jsxs)(sN.Z,{children:[(0,c.jsxs)(s_.Z,{children:[(0,c.jsx)(w.Z,{children:s}),(0,c.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:A[s]})]}),(0,c.jsx)(s_.Z,{children:"routing_strategy"==s?(0,c.jsxs)(eH.Z,{defaultValue:t,className:"w-full max-w-md",onValueChange:Z,children:[(0,c.jsx)(ed.Z,{value:"usage-based-routing",children:"usage-based-routing"}),(0,c.jsx)(ed.Z,{value:"latency-based-routing",children:"latency-based-routing"}),(0,c.jsx)(ed.Z,{value:"simple-shuffle",children:"simple-shuffle"})]}):(0,c.jsx)(y.Z,{name:s,defaultValue:"object"==typeof t?JSON.stringify(t,null,2):t.toString()})})]},s)})})]}),(0,c.jsx)(lX,{selectedStrategy:N,strategyArgs:r&&r.routing_strategy_args&&Object.keys(r.routing_strategy_args).length>0?r.routing_strategy_args:lQ,paramExplanation:A})]}),(0,c.jsx)(f.Z,{children:(0,c.jsx)(_.Z,{className:"mt-2",onClick:()=>M(r),children:"Save Changes"})})]})}),(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Model Name"}),(0,c.jsx)(sb.Z,{children:"Fallbacks"})]})}),(0,c.jsx)(sv.Z,{children:r.fallbacks&&r.fallbacks.map((e,t)=>Object.entries(e).map(e=>{let[l,a]=e;return(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:l}),(0,c.jsx)(s_.Z,{children:Array.isArray(a)?a.join(", "):a}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(_.Z,{onClick:()=>l$(l,s),children:"Test Fallback"})}),(0,c.jsx)(s_.Z,{children:(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>E(l)})})]},t.toString()+l)}))})]}),(0,c.jsx)(lY,{models:(null==a?void 0:a.data)?a.data.map(e=>e.model_name):[],accessToken:s,routerSettings:r,setRouterSettings:i})]}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(W.Z,{children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Setting"}),(0,c.jsx)(sb.Z,{children:"Value"}),(0,c.jsx)(sb.Z,{children:"Status"}),(0,c.jsx)(sb.Z,{children:"Action"})]})}),(0,c.jsx)(sv.Z,{children:m.filter(e=>"TypedDictionary"!==e.field_type).map((e,s)=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsxs)(s_.Z,{children:[(0,c.jsx)(w.Z,{children:e.field_name}),(0,c.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:e.field_description})]}),(0,c.jsx)(s_.Z,{children:"Integer"==e.field_type?(0,c.jsx)(q.Z,{step:1,value:e.field_value,onChange:s=>T(e.field_name,s)}):null}),(0,c.jsx)(s_.Z,{children:!0==e.stored_in_db?(0,c.jsx)(eJ.Z,{icon:eZ.Z,className:"text-white",children:"In DB"}):!1==e.stored_in_db?(0,c.jsx)(eJ.Z,{className:"text-gray bg-white outline",children:"In Config"}):(0,c.jsx)(eJ.Z,{className:"text-gray bg-white outline",children:"Not Set"})}),(0,c.jsxs)(s_.Z,{children:[(0,c.jsx)(_.Z,{onClick:()=>L(e.field_name,s),children:"Update"}),(0,c.jsx)(sj.Z,{icon:ee.Z,color:"red",onClick:()=>O(e.field_name,s),children:"Reset"})]})]},s))})]})})})]})]})}):null},l1=e=>{let{isModalVisible:s,accessToken:t,setIsModalVisible:l,setBudgetList:a}=e,[r]=I.Z.useForm(),i=async e=>{if(null!=t&&void 0!=t)try{P.ZP.info("Making API Call");let s=await (0,g.budgetCreateCall)(t,e);console.log("key create Response:",s),a(e=>e?[...e,s]:[s]),P.ZP.success("Budget Created"),r.resetFields()}catch(e){console.error("Error creating the key:",e),P.ZP.error("Error creating the key: ".concat(e),20)}};return(0,c.jsx)(A.Z,{title:"Create Budget",visible:s,width:800,footer:null,onOk:()=>{l(!1),r.resetFields()},onCancel:()=>{l(!1),r.resetFields()},children:(0,c.jsxs)(I.Z,{form:r,onFinish:i,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{label:"Budget ID",name:"budget_id",rules:[{required:!0,message:"Please input a human-friendly name for the budget"}],help:"A human-friendly name for the budget",children:(0,c.jsx)(y.Z,{placeholder:""})}),(0,c.jsx)(I.Z.Item,{label:"Max Tokens per minute",name:"tpm_limit",help:"Default is model limit.",children:(0,c.jsx)(q.Z,{step:1,precision:2,width:200})}),(0,c.jsx)(I.Z.Item,{label:"Max Requests per minute",name:"rpm_limit",help:"Default is model limit.",children:(0,c.jsx)(q.Z,{step:1,precision:2,width:200})}),(0,c.jsxs)(b.Z,{className:"mt-20 mb-8",children:[(0,c.jsx)(Z.Z,{children:(0,c.jsx)("b",{children:"Optional Settings"})}),(0,c.jsxs)(N.Z,{children:[(0,c.jsx)(I.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,c.jsx)(q.Z,{step:.01,precision:2,width:200})}),(0,c.jsx)(I.Z.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",children:(0,c.jsxs)(C.default,{defaultValue:null,placeholder:"n/a",children:[(0,c.jsx)(C.default.Option,{value:"24h",children:"daily"}),(0,c.jsx)(C.default.Option,{value:"7d",children:"weekly"}),(0,c.jsx)(C.default.Option,{value:"30d",children:"monthly"})]})})]})]})]}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Create Budget"})})]})})},l2=e=>{let{isModalVisible:s,accessToken:t,setIsModalVisible:l,setBudgetList:a,existingBudget:r,handleUpdateCall:i}=e;console.log("existingBudget",r);let[n]=I.Z.useForm();(0,d.useEffect)(()=>{n.setFieldsValue(r)},[r,n]);let o=async e=>{if(null!=t&&void 0!=t)try{P.ZP.info("Making API Call"),l(!0);let s=await (0,g.budgetUpdateCall)(t,e);a(e=>e?[...e,s]:[s]),P.ZP.success("Budget Updated"),n.resetFields(),i()}catch(e){console.error("Error creating the key:",e),P.ZP.error("Error creating the key: ".concat(e),20)}};return(0,c.jsx)(A.Z,{title:"Edit Budget",visible:s,width:800,footer:null,onOk:()=>{l(!1),n.resetFields()},onCancel:()=>{l(!1),n.resetFields()},children:(0,c.jsxs)(I.Z,{form:n,onFinish:o,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",initialValues:r,children:[(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{label:"Budget ID",name:"budget_id",rules:[{required:!0,message:"Please input a human-friendly name for the budget"}],help:"A human-friendly name for the budget",children:(0,c.jsx)(y.Z,{placeholder:""})}),(0,c.jsx)(I.Z.Item,{label:"Max Tokens per minute",name:"tpm_limit",help:"Default is model limit.",children:(0,c.jsx)(q.Z,{step:1,precision:2,width:200})}),(0,c.jsx)(I.Z.Item,{label:"Max Requests per minute",name:"rpm_limit",help:"Default is model limit.",children:(0,c.jsx)(q.Z,{step:1,precision:2,width:200})}),(0,c.jsxs)(b.Z,{className:"mt-20 mb-8",children:[(0,c.jsx)(Z.Z,{children:(0,c.jsx)("b",{children:"Optional Settings"})}),(0,c.jsxs)(N.Z,{children:[(0,c.jsx)(I.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,c.jsx)(q.Z,{step:.01,precision:2,width:200})}),(0,c.jsx)(I.Z.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",children:(0,c.jsxs)(C.default,{defaultValue:null,placeholder:"n/a",children:[(0,c.jsx)(C.default.Option,{value:"24h",children:"daily"}),(0,c.jsx)(C.default.Option,{value:"7d",children:"weekly"}),(0,c.jsx)(C.default.Option,{value:"30d",children:"monthly"})]})})]})]})]}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(T.ZP,{htmlType:"submit",children:"Save"})})]})})},l4=t(17906),l5=e=>{let{accessToken:s}=e,[t,l]=(0,d.useState)(!1),[a,r]=(0,d.useState)(!1),[i,n]=(0,d.useState)(null),[o,m]=(0,d.useState)([]);(0,d.useEffect)(()=>{s&&(0,g.getBudgetList)(s).then(e=>{m(e)})},[s]);let u=async(e,t)=>{console.log("budget_id",e),null!=s&&(n(o.find(s=>s.budget_id===e)||null),r(!0))},x=async(e,t)=>{if(null==s)return;P.ZP.info("Request made"),await (0,g.budgetDeleteCall)(s,e);let l=[...o];l.splice(t,1),m(l),P.ZP.success("Budget Deleted.")},h=async()=>{null!=s&&(0,g.getBudgetList)(s).then(e=>{m(e)})};return(0,c.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[(0,c.jsx)(_.Z,{size:"sm",variant:"primary",className:"mb-2",onClick:()=>l(!0),children:"+ Create Budget"}),(0,c.jsx)(l1,{accessToken:s,isModalVisible:t,setIsModalVisible:l,setBudgetList:m}),i&&(0,c.jsx)(l2,{accessToken:s,isModalVisible:a,setIsModalVisible:r,setBudgetList:m,existingBudget:i,handleUpdateCall:h}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Create a budget to assign to customers."}),(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Budget ID"}),(0,c.jsx)(sb.Z,{children:"Max Budget"}),(0,c.jsx)(sb.Z,{children:"TPM"}),(0,c.jsx)(sb.Z,{children:"RPM"})]})}),(0,c.jsx)(sv.Z,{children:o.slice().sort((e,s)=>new Date(s.updated_at).getTime()-new Date(e.updated_at).getTime()).map((e,s)=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:e.budget_id}),(0,c.jsx)(s_.Z,{children:e.max_budget?e.max_budget:"n/a"}),(0,c.jsx)(s_.Z,{children:e.tpm_limit?e.tpm_limit:"n/a"}),(0,c.jsx)(s_.Z,{children:e.rpm_limit?e.rpm_limit:"n/a"}),(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>u(e.budget_id,s)}),(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>x(e.budget_id,s)})]},s))})]})]}),(0,c.jsxs)("div",{className:"mt-5",children:[(0,c.jsx)(w.Z,{className:"text-base",children:"How to use budget id"}),(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{children:[(0,c.jsx)(eY.Z,{children:"Assign Budget to Customer"}),(0,c.jsx)(eY.Z,{children:"Test it (Curl)"}),(0,c.jsx)(eY.Z,{children:"Test it (OpenAI SDK)"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(l4.Z,{language:"bash",children:"\ncurl -X POST --location '<your_proxy_base_url>/end_user/new' \n-H 'Authorization: Bearer <your-master-key>' \n-H 'Content-Type: application/json' \n-d '{\"user_id\": \"my-customer-id', \"budget_id\": \"<BUDGET_ID>\"}' # \uD83D\uDC48 KEY CHANGE\n\n            "})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(l4.Z,{language:"bash",children:'\ncurl -X POST --location \'<your_proxy_base_url>/chat/completions\' \n-H \'Authorization: Bearer <your-master-key>\' \n-H \'Content-Type: application/json\' \n-d \'{\n  "model": "gpt-3.5-turbo\', \n  "messages":[{"role": "user", "content": "Hey, how\'s it going?"}],\n  "user": "my-customer-id"\n}\' # \uD83D\uDC48 KEY CHANGE\n\n            '})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(l4.Z,{language:"python",children:'from openai import OpenAI\nclient = OpenAI(\n  base_url="<your_proxy_base_url>",\n  api_key="<your_proxy_key>"\n)\n\ncompletion = client.chat.completions.create(\n  model="gpt-3.5-turbo",\n  messages=[\n    {"role": "system", "content": "You are a helpful assistant."},\n    {"role": "user", "content": "Hello!"}\n  ],\n  user="my-customer-id"\n)\n\nprint(completion.choices[0].message)'})})]})]})]})]})},l6=t(77398),l3=t.n(l6);let l8=e=>{try{return new Date(e).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).replace(",","")}catch(e){return"Error converting time"}},l7=e=>{let{utcTime:s}=e;return(0,c.jsx)("span",{style:{fontFamily:"monospace",width:"180px",display:"inline-block"},children:l8(s)})},l9=(e,s)=>{var t,l;return(null===(l=e.metadata)||void 0===l?void 0:null===(t=l.mcp_tool_call_metadata)||void 0===t?void 0:t.mcp_server_logo_url)?e.metadata.mcp_tool_call_metadata.mcp_server_logo_url:s?(0,sL.dr)(s).logo:""},ae=[{id:"expander",header:()=>null,cell:e=>{let{row:s}=e;return(0,c.jsx)(()=>{let[e,t]=d.useState(s.getIsExpanded()),l=d.useCallback(()=>{t(e=>!e),s.getToggleExpandedHandler()()},[s]);return s.getCanExpand()?(0,c.jsx)("button",{onClick:l,style:{cursor:"pointer"},"aria-label":e?"Collapse row":"Expand row",className:"w-6 h-6 flex items-center justify-center focus:outline-none",children:(0,c.jsx)("svg",{className:"w-4 h-4 transform transition-transform duration-75 ".concat(e?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):(0,c.jsx)("span",{className:"w-6 h-6 flex items-center justify-center",children:"●"})},{})}},{header:"Time",accessorKey:"startTime",cell:e=>(0,c.jsx)(l7,{utcTime:e.getValue()})},{header:"Status",accessorKey:"metadata.status",cell:e=>{let s="failure"!==(e.getValue()||"Success").toLowerCase();return(0,c.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat(s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s?"Success":"Failure"})}},{header:"Session ID",accessorKey:"session_id",cell:e=>{let s=String(e.getValue()||""),t=e.row.original.onSessionClick;return(0,c.jsx)(z.Z,{title:String(e.getValue()||""),children:(0,c.jsx)(_.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal text-xs max-w-[15ch] truncate block",onClick:()=>null==t?void 0:t(s),children:String(e.getValue()||"")})})}},{header:"Request ID",accessorKey:"request_id",cell:e=>(0,c.jsx)(z.Z,{title:String(e.getValue()||""),children:(0,c.jsx)("span",{className:"font-mono text-xs max-w-[15ch] truncate block",children:String(e.getValue()||"")})})},{header:"Cost",accessorKey:"spend",cell:e=>(0,c.jsxs)("span",{children:["$",eD(e.getValue()||0,6)]})},{header:"Duration (s)",accessorKey:"duration",cell:e=>(0,c.jsx)(z.Z,{title:String(e.getValue()||"-"),children:(0,c.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Team Name",accessorKey:"metadata.user_api_key_team_alias",cell:e=>(0,c.jsx)(z.Z,{title:String(e.getValue()||"-"),children:(0,c.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Key Hash",accessorKey:"metadata.user_api_key",cell:e=>{let s=String(e.getValue()||"-"),t=e.row.original.onKeyHashClick;return(0,c.jsx)(z.Z,{title:s,children:(0,c.jsx)("span",{className:"font-mono max-w-[15ch] truncate block cursor-pointer hover:text-blue-600",onClick:()=>null==t?void 0:t(s),children:s})})}},{header:"Key Name",accessorKey:"metadata.user_api_key_alias",cell:e=>(0,c.jsx)(z.Z,{title:String(e.getValue()||"-"),children:(0,c.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Model",accessorKey:"model",cell:e=>{let s=e.row.original,t=s.custom_llm_provider,l=String(e.getValue()||"");return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,c.jsx)("img",{src:l9(s,t),alt:"",className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,c.jsx)(z.Z,{title:l,children:(0,c.jsx)("span",{className:"max-w-[15ch] truncate block",children:l})})]})}},{header:"Tokens",accessorKey:"total_tokens",cell:e=>{let s=e.row.original;return(0,c.jsxs)("span",{className:"text-sm",children:[String(s.total_tokens||"0"),(0,c.jsxs)("span",{className:"text-gray-400 text-xs ml-1",children:["(",String(s.prompt_tokens||"0"),"+",String(s.completion_tokens||"0"),")"]})]})}},{header:"Internal User",accessorKey:"user",cell:e=>(0,c.jsx)(z.Z,{title:String(e.getValue()||"-"),children:(0,c.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"End User",accessorKey:"end_user",cell:e=>(0,c.jsx)(z.Z,{title:String(e.getValue()||"-"),children:(0,c.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Tags",accessorKey:"request_tags",cell:e=>{let s=e.getValue();if(!s||0===Object.keys(s).length)return"-";let t=Object.entries(s),l=t[0],a=t.slice(1);return(0,c.jsx)("div",{className:"flex flex-wrap gap-1",children:(0,c.jsx)(z.Z,{title:(0,c.jsx)("div",{className:"flex flex-col gap-1",children:t.map(e=>{let[s,t]=e;return(0,c.jsxs)("span",{children:[s,": ",String(t)]},s)})}),children:(0,c.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[l[0],": ",String(l[1]),a.length>0&&" +".concat(a.length)]})})})}}],as=e=>(0,c.jsx)(eJ.Z,{color:"gray",className:"flex items-center gap-1",children:(0,c.jsx)("span",{className:"whitespace-nowrap text-xs",children:e})}),at=[{id:"expander",header:()=>null,cell:e=>{let{row:s}=e;return(0,c.jsx)(()=>{let[e,t]=d.useState(s.getIsExpanded()),l=d.useCallback(()=>{t(e=>!e),s.getToggleExpandedHandler()()},[s]);return s.getCanExpand()?(0,c.jsx)("button",{onClick:l,style:{cursor:"pointer"},"aria-label":e?"Collapse row":"Expand row",className:"w-6 h-6 flex items-center justify-center focus:outline-none",children:(0,c.jsx)("svg",{className:"w-4 h-4 transform transition-transform ".concat(e?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):(0,c.jsx)("span",{className:"w-6 h-6 flex items-center justify-center",children:"●"})},{})}},{header:"Timestamp",accessorKey:"updated_at",cell:e=>(0,c.jsx)(l7,{utcTime:e.getValue()})},{header:"Table Name",accessorKey:"table_name",cell:e=>{let s=e.getValue(),t=s;switch(s){case"LiteLLM_VerificationToken":t="Keys";break;case"LiteLLM_TeamTable":t="Teams";break;case"LiteLLM_OrganizationTable":t="Organizations";break;case"LiteLLM_UserTable":t="Users";break;case"LiteLLM_ProxyModelTable":t="Models";break;default:t=s}return(0,c.jsx)("span",{children:t})}},{header:"Action",accessorKey:"action",cell:e=>(0,c.jsx)("span",{children:as(e.getValue())})},{header:"Changed By",accessorKey:"changed_by",cell:e=>{let s=e.row.original.changed_by,t=e.row.original.changed_by_api_key;return(0,c.jsxs)("div",{className:"space-y-1",children:[(0,c.jsx)("div",{className:"font-medium",children:s}),t&&(0,c.jsx)(z.Z,{title:t,children:(0,c.jsxs)("div",{className:"text-xs text-muted-foreground max-w-[15ch] truncate",children:[" ",t]})})]})}},{header:"Affected Item ID",accessorKey:"object_id",cell:e=>(0,c.jsx)(()=>{let s=e.getValue(),[t,l]=(0,d.useState)(!1);if(!s)return(0,c.jsx)(c.Fragment,{children:"-"});let a=async()=>{try{await navigator.clipboard.writeText(String(s)),l(!0),setTimeout(()=>l(!1),1500)}catch(e){console.error("Failed to copy object ID: ",e)}};return(0,c.jsx)(z.Z,{title:t?"Copied!":String(s),children:(0,c.jsx)("span",{className:"max-w-[20ch] truncate block cursor-pointer hover:text-blue-600",onClick:a,children:String(s)})})},{})}],al=async(e,s,t,l)=>{console.log("prefetchLogDetails called with",e.length,"logs");let a=e.map(e=>{if(e.request_id)return console.log("Prefetching details for request_id:",e.request_id),l.prefetchQuery({queryKey:["logDetails",e.request_id,s],queryFn:async()=>{console.log("Fetching details for",e.request_id);let l=await (0,g.uiSpendLogDetailsCall)(t,e.request_id,s);return console.log("Received details for",e.request_id,":",l?"success":"failed"),l},staleTime:6e5,gcTime:6e5})});try{let e=await Promise.all(a);return console.log("All prefetch promises completed:",e.length),e}catch(e){throw console.error("Error in prefetchLogDetails:",e),e}};function aa(e){let{row:s,hasMessages:t,hasResponse:l,hasError:a,errorInfo:r,getRawRequest:i,formattedResponse:n}=e,o=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select();let t=document.execCommand("copy");if(document.body.removeChild(s),!t)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}},d=async()=>{await o(JSON.stringify(i(),null,2))?P.ZP.success("Request copied to clipboard"):P.ZP.error("Failed to copy request")},m=async()=>{await o(JSON.stringify(n(),null,2))?P.ZP.success("Response copied to clipboard"):P.ZP.error("Failed to copy response")};return(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,c.jsx)("h3",{className:"text-lg font-medium",children:"Request"}),(0,c.jsx)("button",{onClick:d,className:"p-1 hover:bg-gray-200 rounded",title:"Copy request",children:(0,c.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,c.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,c.jsx)("div",{className:"p-4 overflow-auto max-h-96",children:(0,c.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(i(),null,2)})})]}),(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,c.jsxs)("h3",{className:"text-lg font-medium",children:["Response",a&&(0,c.jsxs)("span",{className:"ml-2 text-sm text-red-600",children:["• HTTP code ",(null==r?void 0:r.error_code)||400]})]}),(0,c.jsx)("button",{onClick:m,className:"p-1 hover:bg-gray-200 rounded",title:"Copy response",disabled:!l,children:(0,c.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,c.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,c.jsx)("div",{className:"p-4 overflow-auto max-h-96 bg-gray-50",children:l?(0,c.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(n(),null,2)}):(0,c.jsx)("div",{className:"text-gray-500 text-sm italic text-center py-4",children:"Response data not available"})})]})]})}let ar=e=>{var s;let{errorInfo:t}=e,[l,a]=d.useState({}),[r,i]=d.useState(!1),n=e=>{a(s=>({...s,[e]:!s[e]}))},o=t.traceback&&(s=t.traceback)?Array.from(s.matchAll(/File "([^"]+)", line (\d+)/g)).map(e=>{let t=e[1],l=e[2],a=t.split("/").pop()||t,r=e.index||0,i=s.indexOf('File "',r+1),n=i>-1?s.substring(r,i).trim():s.substring(r).trim(),o=n.split("\n"),c="";return o.length>1&&(c=o[o.length-1].trim()),{filePath:t,fileName:a,lineNumber:l,code:c,inFunction:n.includes(" in ")?n.split(" in ")[1].split("\n")[0]:""}}):[];return(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,c.jsx)("div",{className:"p-4 border-b",children:(0,c.jsxs)("h3",{className:"text-lg font-medium flex items-center text-red-600",children:[(0,c.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Error Details"]})}),(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsxs)("div",{className:"bg-red-50 rounded-md p-4 mb-4",children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"text-red-800 font-medium w-20",children:"Type:"}),(0,c.jsx)("span",{className:"text-red-700",children:t.error_class||"Unknown Error"})]}),(0,c.jsxs)("div",{className:"flex mt-2",children:[(0,c.jsx)("span",{className:"text-red-800 font-medium w-20 flex-shrink-0",children:"Message:"}),(0,c.jsx)("span",{className:"text-red-700 break-words whitespace-pre-wrap",children:t.error_message||"Unknown error occurred"})]})]}),t.traceback&&(0,c.jsxs)("div",{className:"mt-4",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,c.jsx)("h4",{className:"font-medium",children:"Traceback"}),(0,c.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,c.jsx)("button",{onClick:()=>{let e=!r;if(i(e),o.length>0){let s={};o.forEach((t,l)=>{s[l]=e}),a(s)}},className:"text-gray-500 hover:text-gray-700 flex items-center text-sm",children:r?"Collapse All":"Expand All"}),(0,c.jsxs)("button",{onClick:()=>navigator.clipboard.writeText(t.traceback||""),className:"text-gray-500 hover:text-gray-700 flex items-center",title:"Copy traceback",children:[(0,c.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,c.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),(0,c.jsx)("span",{className:"ml-1",children:"Copy"})]})]})]}),(0,c.jsx)("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden shadow-sm",children:o.map((e,s)=>(0,c.jsxs)("div",{className:"border-b border-gray-200 last:border-b-0",children:[(0,c.jsxs)("div",{className:"px-4 py-2 flex items-center justify-between cursor-pointer hover:bg-gray-50",onClick:()=>n(s),children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("span",{className:"text-gray-400 mr-2 w-12 text-right",children:e.lineNumber}),(0,c.jsx)("span",{className:"text-gray-600 font-medium",children:e.fileName}),(0,c.jsx)("span",{className:"text-gray-500 mx-1",children:"in"}),(0,c.jsx)("span",{className:"text-indigo-600 font-medium",children:e.inFunction||e.fileName})]}),(0,c.jsx)("svg",{className:"w-5 h-5 text-gray-500 transition-transform ".concat(l[s]?"transform rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(l[s]||!1)&&e.code&&(0,c.jsx)("div",{className:"px-12 py-2 font-mono text-sm text-gray-800 bg-gray-50 overflow-x-auto border-t border-gray-100",children:e.code})]},s))})]})]})]})},ai=e=>{let{show:s}=e;return s?(0,c.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start",children:[(0,c.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,c.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,c.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,c.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Request/Response Data Not Available"}),(0,c.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["To view request and response details, enable prompt storage in your LiteLLM configuration by adding the following to your ",(0,c.jsx)("code",{className:"bg-blue-100 px-1 py-0.5 rounded",children:"proxy_config.yaml"})," file:"]}),(0,c.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"general_settings:\n  store_model_in_db: true\n  store_prompts_in_spend_logs: true"}),(0,c.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change."})]})]}):null};var an=t(35829);let ao=e=>{let{sessionId:s,logs:t,onBack:l}=e,[a,r]=(0,d.useState)(null),[i,n]=(0,d.useState)({}),o=t.reduce((e,s)=>e+(s.spend||0),0),m=t.reduce((e,s)=>e+(s.total_tokens||0),0),u=t.length>0?new Date(t[0].startTime):new Date;(((t.length>0?new Date(t[t.length-1].endTime):new Date).getTime()-u.getTime())/1e3).toFixed(2),t.map(e=>({time:new Date(e.startTime).toISOString(),tokens:e.total_tokens||0,cost:e.spend||0}));let x=async(e,s)=>{await eF(e)&&(n(e=>({...e,[s]:!0})),setTimeout(()=>{n(e=>({...e,[s]:!1}))},2e3))};return(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("div",{className:"mb-8",children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",onClick:l,className:"mb-4",children:"Back to All Logs"}),(0,c.jsxs)("div",{className:"mt-4",children:[(0,c.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Session Details"}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,c.jsx)("p",{className:"text-sm text-gray-500 font-mono",children:s}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:i["session-id"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>x(s,"session-id"),className:"left-2 z-10 transition-all duration-200 ".concat(i["session-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]}),(0,c.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/ui_logs_sessions",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:["Get started with session management here",(0,c.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Requests"}),(0,c.jsx)(an.Z,{children:t.length})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Cost"}),(0,c.jsxs)(an.Z,{children:["$",eD(o,6)]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Tokens"}),(0,c.jsx)(an.Z,{children:m})]})]}),(0,c.jsx)(k.Z,{children:"Session Logs"}),(0,c.jsx)("div",{className:"mt-4",children:(0,c.jsx)(t3,{columns:ae,data:t,renderSubComponent:ag,getRowCanExpand:()=>!0,loadingMessage:"Loading logs...",noDataMessage:"No logs found"})})]})};function ac(e){let{data:s}=e,[t,l]=(0,d.useState)(!0),[a,r]=(0,d.useState)({});if(!s||0===s.length)return null;let i=e=>new Date(1e3*e).toLocaleString(),n=(e,s)=>"".concat(((s-e)*1e3).toFixed(2),"ms"),o=(e,s)=>{let t="".concat(e,"-").concat(s);r(e=>({...e,[t]:!e[t]}))};return(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center p-4 border-b cursor-pointer hover:bg-gray-50",onClick:()=>l(!t),children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("svg",{className:"w-5 h-5 mr-2 text-gray-600 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,c.jsx)("h3",{className:"text-lg font-medium",children:"Vector Store Requests"})]}),(0,c.jsx)("span",{className:"text-sm text-gray-500",children:t?"Click to collapse":"Click to expand"})]}),t&&(0,c.jsx)("div",{className:"p-4",children:s.map((e,s)=>(0,c.jsxs)("div",{className:"mb-6 last:mb-0",children:[(0,c.jsx)("div",{className:"bg-white rounded-lg border p-4 mb-4",children:(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Query:"}),(0,c.jsx)("span",{className:"font-mono",children:e.query})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Vector Store ID:"}),(0,c.jsx)("span",{className:"font-mono",children:e.vector_store_id})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,c.jsx)("span",{className:"flex items-center",children:(()=>{let{logo:s,displayName:t}=(0,sL.dr)(e.custom_llm_provider);return(0,c.jsxs)(c.Fragment,{children:[s&&(0,c.jsx)("img",{src:s,alt:"".concat(t," logo"),className:"h-5 w-5 mr-2"}),t]})})()})]})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,c.jsx)("span",{children:i(e.start_time)})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,c.jsx)("span",{children:i(e.end_time)})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,c.jsx)("span",{children:n(e.start_time,e.end_time)})]})]})]})}),(0,c.jsx)("h4",{className:"font-medium mb-2",children:"Search Results"}),(0,c.jsx)("div",{className:"space-y-2",children:e.vector_store_search_response.data.map((e,t)=>{let l=a["".concat(s,"-").concat(t)]||!1;return(0,c.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,c.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 cursor-pointer",onClick:()=>o(s,t),children:[(0,c.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(l?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsxs)("span",{className:"font-medium mr-2",children:["Result ",t+1]}),(0,c.jsxs)("span",{className:"text-gray-500 text-sm",children:["Score: ",(0,c.jsx)("span",{className:"font-mono",children:e.score.toFixed(4)})]})]})]}),l&&(0,c.jsx)("div",{className:"p-3 border-t bg-white",children:e.content.map((e,s)=>(0,c.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,c.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:e.type}),(0,c.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all bg-gray-50 p-2 rounded",children:e.text})]},s))})]},t)})})]},s))})]})}function ad(e){let{data:s}=e,[t,l]=(0,d.useState)(!0),[a,r]=(0,d.useState)(!0),[i,n]=(0,d.useState)({});if(!s)return null;let o=s.masked_entity_count?Object.values(s.masked_entity_count).reduce((e,s)=>e+s,0):0,m=e=>new Date(1e3*e).toLocaleString(),u=e=>{n(s=>({...s,[e]:!s[e]}))},x=e=>e>=.8?"text-green-600":"text-yellow-600";return(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center p-4 border-b cursor-pointer hover:bg-gray-50",onClick:()=>l(!t),children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("svg",{className:"w-5 h-5 mr-2 text-gray-600 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,c.jsx)("h3",{className:"text-lg font-medium",children:"Guardrail Information"}),(0,c.jsx)("span",{className:"ml-3 px-2 py-1 rounded-md text-xs font-medium inline-block ".concat("success"===s.guardrail_status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.guardrail_status}),o>0&&(0,c.jsxs)("span",{className:"ml-3 px-2 py-1 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[o," masked ",1===o?"entity":"entities"]})]}),(0,c.jsx)("span",{className:"text-sm text-gray-500",children:t?"Click to collapse":"Click to expand"})]}),t&&(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsxs)("div",{className:"bg-white rounded-lg border p-4 mb-4",children:[(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail Name:"}),(0,c.jsx)("span",{className:"font-mono",children:s.guardrail_name})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Mode:"}),(0,c.jsx)("span",{className:"font-mono",children:s.guardrail_mode})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,c.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat("success"===s.guardrail_status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.guardrail_status})]})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,c.jsx)("span",{children:m(s.start_time)})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,c.jsx)("span",{children:m(s.end_time)})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,c.jsxs)("span",{children:[s.duration.toFixed(4),"s"]})]})]})]}),s.masked_entity_count&&Object.keys(s.masked_entity_count).length>0&&(0,c.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,c.jsx)("h4",{className:"font-medium mb-2",children:"Masked Entity Summary"}),(0,c.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(s.masked_entity_count).map(e=>{let[s,t]=e;return(0,c.jsxs)("span",{className:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[s,": ",t]},s)})})]})]}),s.guardrail_response&&s.guardrail_response.length>0&&(0,c.jsxs)("div",{className:"mt-4",children:[(0,c.jsxs)("div",{className:"flex items-center mb-2 cursor-pointer",onClick:()=>r(!a),children:[(0,c.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(a?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,c.jsxs)("h4",{className:"font-medium",children:["Detected Entities (",s.guardrail_response.length,")"]})]}),a&&(0,c.jsx)("div",{className:"space-y-2",children:s.guardrail_response.map((e,s)=>{let t=i[s]||!1;return(0,c.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>u(s),children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,c.jsx)("span",{className:"font-medium mr-2",children:e.entity_type}),(0,c.jsxs)("span",{className:"font-mono ".concat(x(e.score)),children:["Score: ",e.score.toFixed(2)]})]}),(0,c.jsxs)("span",{className:"text-xs text-gray-500",children:["Position: ",e.start,"-",e.end]})]}),t&&(0,c.jsx)("div",{className:"p-3 border-t bg-white",children:(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Entity Type:"}),(0,c.jsx)("span",{children:e.entity_type})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Position:"}),(0,c.jsxs)("span",{children:["Characters ",e.start,"-",e.end]})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Confidence:"}),(0,c.jsx)("span",{className:x(e.score),children:e.score.toFixed(2)})]})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[e.recognition_metadata&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Recognizer:"}),(0,c.jsx)("span",{children:e.recognition_metadata.recognizer_name})]}),(0,c.jsxs)("div",{className:"flex overflow-hidden",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Identifier:"}),(0,c.jsx)("span",{className:"truncate text-xs font-mono",children:e.recognition_metadata.recognizer_identifier})]})]}),e.analysis_explanation&&(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Explanation:"}),(0,c.jsx)("span",{children:e.analysis_explanation})]})]})]})})]},s)})})]})]})]})}let am={TEAM_ID:"Team ID",KEY_HASH:"Key Hash",REQUEST_ID:"Request ID",MODEL:"Model",USER_ID:"User ID",END_USER:"End User",STATUS:"Status",KEY_ALIAS:"Key Alias"},au="".concat("../ui/assets/","audit-logs-preview.png");function ax(e){let{userID:s,userRole:t,token:l,accessToken:a,isActive:r,premiumUser:i,allTeams:n}=e,[o,m]=(0,d.useState)(l3()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),u=(0,d.useRef)(null),x=(0,d.useRef)(null),[h,p]=(0,d.useState)(1),[j]=(0,d.useState)(50),[f,v]=(0,d.useState)({}),[_,y]=(0,d.useState)(""),[b,N]=(0,d.useState)(""),[Z,k]=(0,d.useState)(""),[S,C]=(0,d.useState)("all"),[I,P]=(0,d.useState)("all"),[A,E]=(0,d.useState)(!1),[T,L]=(0,d.useState)(!1),O=(0,sd.a)({queryKey:["all_audit_logs",a,l,t,s,o],queryFn:async()=>{if(!a||!l||!t||!s)return[];let e=l3()(o).utc().format("YYYY-MM-DD HH:mm:ss"),r=l3()().utc().format("YYYY-MM-DD HH:mm:ss"),i=[],n=1,c=1;do{let s=await (0,g.uiAuditLogsCall)(a,e,r,n,50);i=i.concat(s.audit_logs),c=s.total_pages,n++}while(n<=c);return i},enabled:!!a&&!!l&&!!t&&!!s&&r,refetchInterval:5e3,refetchIntervalInBackground:!0}),M=(0,d.useCallback)(async e=>{if(a)try{let s=(await (0,g.keyListCall)(a,null,null,e,null,null,1,10)).keys.find(s=>s.key_alias===e);s?N(s.token):N("")}catch(e){console.error("Error fetching key hash for alias:",e),N("")}},[a]);(0,d.useEffect)(()=>{if(!a)return;let e=!1,s=!1;f["Team ID"]?_!==f["Team ID"]&&(y(f["Team ID"]),e=!0):""!==_&&(y(""),e=!0),f["Key Hash"]?b!==f["Key Hash"]&&(N(f["Key Hash"]),s=!0):f["Key Alias"]?M(f["Key Alias"]):""!==b&&(N(""),s=!0),(e||s)&&p(1)},[f,a,M,_,b]),(0,d.useEffect)(()=>{p(1)},[_,b,o,Z,S,I]),(0,d.useEffect)(()=>{function e(e){u.current&&!u.current.contains(e.target)&&E(!1),x.current&&!x.current.contains(e.target)&&L(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let D=(0,d.useMemo)(()=>O.data?O.data.filter(e=>{var s,t,l,a,r,i,n;let o=!0,c=!0,d=!0,m=!0,u=!0;if(_){let r="string"==typeof e.before_value?null===(s=JSON.parse(e.before_value))||void 0===s?void 0:s.team_id:null===(t=e.before_value)||void 0===t?void 0:t.team_id,i="string"==typeof e.updated_values?null===(l=JSON.parse(e.updated_values))||void 0===l?void 0:l.team_id:null===(a=e.updated_values)||void 0===a?void 0:a.team_id;o=r===_||i===_}if(b)try{let s="string"==typeof e.before_value?JSON.parse(e.before_value):e.before_value,t="string"==typeof e.updated_values?JSON.parse(e.updated_values):e.updated_values,l=null==s?void 0:s.token,a=null==t?void 0:t.token;c="string"==typeof l&&l.includes(b)||"string"==typeof a&&a.includes(b)}catch(e){c=!1}if(Z&&(d=null===(r=e.object_id)||void 0===r?void 0:r.toLowerCase().includes(Z.toLowerCase())),"all"!==S&&(m=(null===(i=e.action)||void 0===i?void 0:i.toLowerCase())===S.toLowerCase()),"all"!==I){let s="";switch(I){case"keys":s="litellm_verificationtoken";break;case"teams":s="litellm_teamtable";break;case"users":s="litellm_usertable";break;default:s=I}u=(null===(n=e.table_name)||void 0===n?void 0:n.toLowerCase())===s}return o&&c&&d&&m&&u}):[],[O.data,_,b,Z,S,I]),F=D.length,R=Math.ceil(F/j)||1,q=(0,d.useMemo)(()=>{let e=(h-1)*j,s=e+j;return D.slice(e,s)},[D,h,j]),U=!O.data||0===O.data.length,z=(0,d.useCallback)(e=>{let{row:s}=e;return(0,c.jsx)(e=>{let{rowData:s}=e,{before_value:t,updated_values:l,table_name:a,action:r}=s,i=(e,s)=>{if(!e||0===Object.keys(e).length)return(0,c.jsx)(w.Z,{children:"N/A"});if(s){let s=Object.keys(e),t=["token","spend","max_budget"];if(s.every(e=>t.includes(e))&&s.length>0)return(0,c.jsxs)("div",{children:[s.includes("token")&&(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Token:"})," ",e.token||"N/A"]}),s.includes("spend")&&(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Spend:"})," ",void 0!==e.spend?"$".concat(eD(e.spend,6)):"N/A"]}),s.includes("max_budget")&&(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Max Budget:"})," ",void 0!==e.max_budget?"$".concat(eD(e.max_budget,6)):"N/A"]})]});if(e["No differing fields detected in 'before' state"]||e["No differing fields detected in 'updated' state"]||e["No fields changed"])return(0,c.jsx)(w.Z,{children:e[Object.keys(e)[0]]})}return(0,c.jsx)("pre",{className:"p-2 bg-gray-50 border rounded text-xs overflow-auto max-h-60",children:JSON.stringify(e,null,2)})},n=t,o=l;if(("updated"===r||"rotated"===r)&&t&&l&&("LiteLLM_TeamTable"===a||"LiteLLM_UserTable"===a||"LiteLLM_VerificationToken"===a)){let e={},s={};new Set([...Object.keys(t),...Object.keys(l)]).forEach(a=>{JSON.stringify(t[a])!==JSON.stringify(l[a])&&(t.hasOwnProperty(a)&&(e[a]=t[a]),l.hasOwnProperty(a)&&(s[a]=l[a]))}),Object.keys(t).forEach(a=>{l.hasOwnProperty(a)||e.hasOwnProperty(a)||(e[a]=t[a],s[a]=void 0)}),Object.keys(l).forEach(a=>{t.hasOwnProperty(a)||s.hasOwnProperty(a)||(s[a]=l[a],e[a]=void 0)}),n=Object.keys(e).length>0?e:{"No differing fields detected in 'before' state":"N/A"},o=Object.keys(s).length>0?s:{"No differing fields detected in 'updated' state":"N/A"},0===Object.keys(e).length&&0===Object.keys(s).length&&(n={"No fields changed":"N/A"},o={"No fields changed":"N/A"})}return(0,c.jsxs)("div",{className:"-mx-4 p-4 bg-slate-100 border-y border-slate-300 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Before Value:"}),i(n,"LiteLLM_VerificationToken"===a)]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Updated Value:"}),i(o,"LiteLLM_VerificationToken"===a)]})]})},{rowData:s.original})},[]);if(!i)return(0,c.jsxs)("div",{style:{textAlign:"center",marginTop:"20px"},children:[(0,c.jsx)("h1",{style:{display:"block",marginBottom:"10px"},children:"✨ Enterprise Feature."}),(0,c.jsx)(w.Z,{style:{display:"block",marginBottom:"10px"},children:"This is a LiteLLM Enterprise feature, and requires a valid key to use."}),(0,c.jsx)(w.Z,{style:{display:"block",marginBottom:"20px",fontStyle:"italic"},children:"Here's a preview of what Audit Logs offer:"}),(0,c.jsx)("img",{src:au,alt:"Audit Logs Preview",style:{maxWidth:"100%",maxHeight:"700px",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",margin:"0 auto"},onError:e=>{console.error("Failed to load audit logs preview image"),e.target.style.display="none"}})]});let V=F>0?(h-1)*j+1:0,K=Math.min(h*j,F);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"flex items-center justify-between mb-4"}),(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,c.jsxs)("div",{className:"border-b px-6 py-4",children:[(0,c.jsx)("h1",{className:"text-xl font-semibold py-4",children:"Audit Logs"}),(0,c.jsx)(e=>{let{show:s}=e;return s?(0,c.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start mb-6",children:[(0,c.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,c.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,c.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,c.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Audit Logs Not Available"}),(0,c.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"To enable audit logging, add the following configuration to your LiteLLM proxy configuration file:"}),(0,c.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"litellm_settings:\n  store_audit_logs: true"}),(0,c.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change and proxy restart."})]})]}):null},{show:U}),(0,c.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:[(0,c.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"flex items-center",children:(0,c.jsx)("input",{type:"text",placeholder:"Search by Object ID...",value:Z,onChange:e=>k(e.target.value),className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,c.jsxs)("button",{onClick:()=>{O.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,c.jsx)("svg",{className:"w-4 h-4 ".concat(O.isFetching?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,c.jsx)("span",{children:"Refresh"})]})]})}),(0,c.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,c.jsxs)("div",{className:"relative",ref:u,children:[(0,c.jsx)("label",{htmlFor:"actionFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Action:"}),(0,c.jsxs)("button",{id:"actionFilterDisplay",onClick:()=>E(!A),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,c.jsxs)("span",{children:["all"===S&&"All Actions","created"===S&&"Created","updated"===S&&"Updated","deleted"===S&&"Deleted","rotated"===S&&"Rotated"]}),(0,c.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),A&&(0,c.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,c.jsx)("div",{className:"space-y-1",children:[{label:"All Actions",value:"all"},{label:"Created",value:"created"},{label:"Updated",value:"updated"},{label:"Deleted",value:"deleted"},{label:"Rotated",value:"rotated"}].map(e=>(0,c.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(S===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"),onClick:()=>{C(e.value),E(!1)},children:e.label},e.value))})})]}),(0,c.jsxs)("div",{className:"relative",ref:x,children:[(0,c.jsx)("label",{htmlFor:"tableFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Table:"}),(0,c.jsxs)("button",{id:"tableFilterDisplay",onClick:()=>L(!T),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,c.jsxs)("span",{children:["all"===I&&"All Tables","keys"===I&&"Keys","teams"===I&&"Teams","users"===I&&"Users"]}),(0,c.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),T&&(0,c.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,c.jsx)("div",{className:"space-y-1",children:[{label:"All Tables",value:"all"},{label:"Keys",value:"keys"},{label:"Teams",value:"teams"},{label:"Users",value:"users"}].map(e=>(0,c.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(I===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"),onClick:()=>{P(e.value),L(!1)},children:e.label},e.value))})})]}),(0,c.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing"," ",O.isLoading?"...":V," ","-"," ",O.isLoading?"...":K," ","of"," ",O.isLoading?"...":F," ","results"]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",O.isLoading?"...":h," of"," ",O.isLoading?"...":R]}),(0,c.jsx)("button",{onClick:()=>p(e=>Math.max(1,e-1)),disabled:O.isLoading||1===h,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,c.jsx)("button",{onClick:()=>p(e=>Math.min(R,e+1)),disabled:O.isLoading||h===R,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]}),(0,c.jsx)(t3,{columns:at,data:q,renderSubComponent:z,getRowCanExpand:()=>!0})]})]})}let ah=(e,s,t)=>{if(e)return"".concat(l3()(s).format("MMM D, h:mm A")," - ").concat(l3()(t).format("MMM D, h:mm A"));let l=l3()(),a=l3()(s),r=l.diff(a,"minutes");if(r>=0&&r<2)return"Last 1 Minute";if(r>=2&&r<16)return"Last 15 Minutes";if(r>=16&&r<61)return"Last Hour";let i=l.diff(a,"hours");return i>=1&&i<5?"Last 4 Hours":i>=5&&i<25?"Last 24 Hours":i>=25&&i<169?"Last 7 Days":"".concat(a.format("MMM D")," - ").concat(l.format("MMM D"))};function ap(e){var s,t,l;let{accessToken:a,token:r,userRole:i,userID:n,allTeams:o,premiumUser:m}=e,[u,x]=(0,d.useState)(""),[p,j]=(0,d.useState)(!1),[f,v]=(0,d.useState)(!1),[_,y]=(0,d.useState)(1),[b]=(0,d.useState)(50),N=(0,d.useRef)(null),Z=(0,d.useRef)(null),w=(0,d.useRef)(null),[k,S]=(0,d.useState)(l3()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),[C,I]=(0,d.useState)(l3()().format("YYYY-MM-DDTHH:mm")),[P,A]=(0,d.useState)(!1),[E,T]=(0,d.useState)(!1),[L,O]=(0,d.useState)(""),[M,D]=(0,d.useState)(""),[F,R]=(0,d.useState)(""),[q,U]=(0,d.useState)(""),[z,V]=(0,d.useState)(""),[K,B]=(0,d.useState)(null),[G,H]=(0,d.useState)(null),[J,Y]=(0,d.useState)(""),[W,$]=(0,d.useState)(i&&eE.lo.includes(i)),[Q,X]=(0,d.useState)("request logs"),[ee,es]=(0,d.useState)(null),[et,el]=(0,d.useState)(null),ea=(0,h.NL)(),[er,ei]=(0,d.useState)(()=>{let e=sessionStorage.getItem("isLiveTail");return null===e||JSON.parse(e)});(0,d.useEffect)(()=>{sessionStorage.setItem("isLiveTail",JSON.stringify(er))},[er]);let[en,eo]=(0,d.useState)({value:24,unit:"hours"});(0,d.useEffect)(()=>{(async()=>{G&&a&&B({...(await (0,g.keyInfoV1Call)(a,G)).info,token:G,api_key:G})})()},[G,a]),(0,d.useEffect)(()=>{function e(e){N.current&&!N.current.contains(e.target)&&v(!1),Z.current&&!Z.current.contains(e.target)&&j(!1),w.current&&!w.current.contains(e.target)&&T(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,d.useEffect)(()=>{i&&eE.lo.includes(i)&&$(!0)},[i]);let ec=(0,sd.a)({queryKey:["logs","table",_,b,k,C,F,q,W?n:null,J,z],queryFn:async()=>{if(!a||!r||!i||!n)return{data:[],total:0,page:1,page_size:b,total_pages:0};let e=l3()(k).utc().format("YYYY-MM-DD HH:mm:ss"),s=P?l3()(C).utc().format("YYYY-MM-DD HH:mm:ss"):l3()().utc().format("YYYY-MM-DD HH:mm:ss"),t=await (0,g.uiSpendLogsCall)(a,q||void 0,F||void 0,void 0,e,s,_,b,W?n:void 0,J,z);return await al(t.data,e,a,ea),t.data=t.data.map(s=>{let t=ea.getQueryData(["logDetails",s.request_id,e]);return(null==t?void 0:t.messages)&&(null==t?void 0:t.response)&&(s.messages=t.messages,s.response=t.response),s}),t},enabled:!!a&&!!r&&!!i&&!!n&&"request logs"===Q,refetchInterval:!!er&&1===_&&15e3,refetchIntervalInBackground:!0}),{filters:ed,filteredLogs:em,allTeams:eu,allKeyAliases:ex,handleFilterChange:eh,handleFilterReset:ep}=function(e){let{logs:s,accessToken:t,startTime:l,endTime:a,pageSize:r=25,isCustomDate:i,setCurrentPage:n,userID:o,userRole:c}=e,m=(0,d.useMemo)(()=>({[am.TEAM_ID]:"",[am.KEY_HASH]:"",[am.REQUEST_ID]:"",[am.MODEL]:"",[am.USER_ID]:"",[am.END_USER]:"",[am.STATUS]:"",[am.KEY_ALIAS]:""}),[]),[u,x]=(0,d.useState)(m),[h,p]=(0,d.useState)(s),j=(0,d.useRef)(0),f=(0,d.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!t)return;let n=Date.now();j.current=n;let o=l3()(l).utc().format("YYYY-MM-DD HH:mm:ss"),c=i?l3()(a).utc().format("YYYY-MM-DD HH:mm:ss"):l3()().utc().format("YYYY-MM-DD HH:mm:ss");try{let l=await (0,g.uiSpendLogsCall)(t,e[am.KEY_HASH]||void 0,e[am.TEAM_ID]||void 0,e[am.REQUEST_ID]||void 0,o,c,s,r,e[am.USER_ID]||void 0,e[am.END_USER]||void 0,e[am.STATUS]||void 0,e[am.MODEL]||void 0);n===j.current&&l.data&&p(l)}catch(e){console.error("Error searching users:",e)}},[t,l,a,i,r]),v=(0,d.useMemo)(()=>eA()((e,s)=>f(e,s),300),[f]);(0,d.useEffect)(()=>()=>v.cancel(),[v]);let _=(0,sd.a)({queryKey:["allKeys"],queryFn:async()=>{if(!t)throw Error("Access token required");return await sm(t)},enabled:!!t}).data||[];(0,d.useEffect)(()=>{if(!s||!s.data){p({data:[],total:0,page:1,page_size:50,total_pages:0});return}let e=[...s.data];if(u[am.TEAM_ID]&&(e=e.filter(e=>e.team_id===u[am.TEAM_ID])),u[am.STATUS]&&(e=e.filter(e=>"success"===u[am.STATUS]?!e.status||"success"===e.status:e.status===u[am.STATUS])),u[am.MODEL]&&(e=e.filter(e=>e.model===u[am.MODEL])),u[am.KEY_HASH]&&(e=e.filter(e=>e.api_key===u[am.KEY_HASH])),u[am.END_USER]&&(e=e.filter(e=>e.end_user===u[am.END_USER])),u[am.KEY_ALIAS])try{let s=u[am.KEY_ALIAS];s&&(e=e.filter(e=>{var t;return(null===(t=e.metadata)||void 0===t?void 0:t.user_api_key_alias)===s}))}catch(e){console.error("Error fetching key info for alias:",e)}let t={data:e,total:s.total,page:s.page,page_size:s.page_size,total_pages:s.total_pages};JSON.stringify(t)!==JSON.stringify(h)&&p(t)},[s,u,h,t]);let{data:y}=(0,sd.a)({queryKey:["allTeamsForLogFilters",t],queryFn:async()=>t&&await su(t)||[],enabled:!!t});return{filters:u,filteredLogs:h,allKeyAliases:_,allTeams:y,handleFilterChange:e=>{x(s=>{let t={...s,...e};for(let e of Object.keys(m))e in t||(t[e]=m[e]);return JSON.stringify(t)!==JSON.stringify(s)&&(n(1),v(t,1)),t})},handleFilterReset:()=>{x(m),v(m,1)}}}({logs:ec.data||{data:[],total:0,page:1,page_size:b||10,total_pages:1},accessToken:a,startTime:k,endTime:C,pageSize:b,isCustomDate:P,setCurrentPage:y,userID:n,userRole:i}),eg=(0,d.useCallback)(async e=>{if(a)try{let s=(await (0,g.keyListCall)(a,null,null,e,null,null,_,b)).keys.find(s=>s.key_alias===e);s&&U(s.token)}catch(e){console.error("Error fetching key hash for alias:",e)}},[a,_,b]);(0,d.useEffect)(()=>{a&&(ed["Team ID"]?R(ed["Team ID"]):R(""),Y(ed.Status||""),V(ed.Model||""),ed["Key Hash"]?U(ed["Key Hash"]):ed["Key Alias"]?eg(ed["Key Alias"]):U(""))},[ed,a,eg]);let ej=(0,sd.a)({queryKey:["sessionLogs",et],queryFn:async()=>{if(!a||!et)return{data:[],total:0,page:1,page_size:50,total_pages:1};let e=await (0,g.sessionSpendLogsCall)(a,et);return{data:e.data||e||[],total:(e.data||e||[]).length,page:1,page_size:1e3,total_pages:1}},enabled:!!a&&!!et});if((0,d.useEffect)(()=>{var e;(null===(e=ec.data)||void 0===e?void 0:e.data)&&ee&&!ec.data.data.some(e=>e.request_id===ee)&&es(null)},[null===(s=ec.data)||void 0===s?void 0:s.data,ee]),!a||!r||!i||!n)return null;let ef=em.data.filter(e=>!u||e.request_id.includes(u)||e.model.includes(u)||e.user&&e.user.includes(u)).map(e=>({...e,duration:(Date.parse(e.endTime)-Date.parse(e.startTime))/1e3,onKeyHashClick:e=>H(e),onSessionClick:e=>{e&&el(e)}}))||[],ev=(null===(l=ej.data)||void 0===l?void 0:null===(t=l.data)||void 0===t?void 0:t.map(e=>({...e,onKeyHashClick:e=>H(e),onSessionClick:e=>{}})))||[],e_=[{name:"Team ID",label:"Team ID",isSearchable:!0,searchFn:async e=>o&&0!==o.length?o.filter(s=>s.team_id.toLowerCase().includes(e.toLowerCase())||s.team_alias&&s.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:"".concat(e.team_alias||e.team_id," (").concat(e.team_id,")"),value:e.team_id})):[]},{name:"Status",label:"Status",isSearchable:!1,options:[{label:"Success",value:"success"},{label:"Failure",value:"failure"}]},{name:"Model",label:"Model",isSearchable:!1},{name:"Key Alias",label:"Key Alias",isSearchable:!0,searchFn:async e=>a?(await sm(a)).filter(s=>s.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e})):[]},{name:"End User",label:"End User",isSearchable:!0,searchFn:async e=>{if(!a)return[];let s=await (0,g.allEndUsersCall)(a);return((null==s?void 0:s.end_users)||[]).filter(s=>s.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e}))}},{name:"Key Hash",label:"Key Hash",isSearchable:!1}];if(et&&ej.data)return(0,c.jsx)("div",{className:"w-full p-6",children:(0,c.jsx)(ao,{sessionId:et,logs:ej.data.data,onBack:()=>el(null)})});let ey=[{label:"Last 15 Minutes",value:15,unit:"minutes"},{label:"Last Hour",value:1,unit:"hours"},{label:"Last 4 Hours",value:4,unit:"hours"},{label:"Last 24 Hours",value:24,unit:"hours"},{label:"Last 7 Days",value:7,unit:"days"}],eb=ey.find(e=>e.value===en.value&&e.unit===en.unit),eN=P?ah(P,k,C):null==eb?void 0:eb.label;return(0,c.jsx)("div",{className:"w-full p-6",children:(0,c.jsxs)(eW.Z,{defaultIndex:0,onIndexChange:e=>X(0===e?"request logs":"audit logs"),children:[(0,c.jsxs)(e$.Z,{children:[(0,c.jsx)(eY.Z,{children:"Request Logs"}),(0,c.jsx)(eY.Z,{children:"Audit Logs"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,c.jsx)("h1",{className:"text-xl font-semibold",children:et?(0,c.jsxs)(c.Fragment,{children:["Session: ",(0,c.jsx)("span",{className:"font-mono",children:et}),(0,c.jsx)("button",{className:"ml-4 px-3 py-1 text-sm border rounded hover:bg-gray-50",onClick:()=>el(null),children:"← Back to All Logs"})]}):"Request Logs"})}),K&&G&&K.api_key===G?(0,c.jsx)(sn,{keyId:G,keyData:K,accessToken:a,userID:n,userRole:i,teams:o,onClose:()=>H(null),premiumUser:m}):et?(0,c.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,c.jsx)(t3,{columns:ae,data:ev,renderSubComponent:ag,getRowCanExpand:()=>!0})}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sc,{options:e_,onApplyFilters:eh,onResetFilters:ep}),(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,c.jsx)("div",{className:"border-b px-6 py-4",children:(0,c.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:[(0,c.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,c.jsxs)("div",{className:"relative w-64",children:[(0,c.jsx)("input",{type:"text",placeholder:"Search by Request ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:u,onChange:e=>x(e.target.value)}),(0,c.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsxs)("div",{className:"relative",ref:w,children:[(0,c.jsxs)("button",{onClick:()=>T(!E),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",children:[(0,c.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),eN]}),E&&(0,c.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border p-2 z-50",children:(0,c.jsxs)("div",{className:"space-y-1",children:[ey.map(e=>(0,c.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(eN===e.label?"bg-blue-50 text-blue-600":""),onClick:()=>{I(l3()().format("YYYY-MM-DDTHH:mm")),S(l3()().subtract(e.value,e.unit).format("YYYY-MM-DDTHH:mm")),eo({value:e.value,unit:e.unit}),A(!1),T(!1)},children:e.label},e.label)),(0,c.jsx)("div",{className:"border-t my-2"}),(0,c.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(P?"bg-blue-50 text-blue-600":""),onClick:()=>A(!P),children:"Custom Range"})]})})]}),(0,c.jsx)(()=>(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Live Tail"}),(0,c.jsx)(tE.Z,{color:"green",checked:er,defaultChecked:!0,onChange:ei})]}),{}),(0,c.jsxs)("button",{onClick:()=>{ec.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,c.jsx)("svg",{className:"w-4 h-4 ".concat(ec.isFetching?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,c.jsx)("span",{children:"Refresh"})]})]}),P&&(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{children:(0,c.jsx)("input",{type:"datetime-local",value:k,onChange:e=>{S(e.target.value),y(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,c.jsx)("span",{className:"text-gray-500",children:"to"}),(0,c.jsx)("div",{children:(0,c.jsx)("input",{type:"datetime-local",value:C,onChange:e=>{I(e.target.value),y(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})})]})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,c.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing"," ",ec.isLoading?"...":em?(_-1)*b+1:0," ","-"," ",ec.isLoading?"...":em?Math.min(_*b,em.total):0," ","of"," ",ec.isLoading?"...":em?em.total:0," ","results"]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",ec.isLoading?"...":_," of"," ",ec.isLoading?"...":em?em.total_pages:1]}),(0,c.jsx)("button",{onClick:()=>y(e=>Math.max(1,e-1)),disabled:ec.isLoading||1===_,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,c.jsx)("button",{onClick:()=>y(e=>Math.min(em.total_pages||1,e+1)),disabled:ec.isLoading||_===(em.total_pages||1),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}),er&&1===_&&(0,c.jsxs)("div",{className:"mb-4 px-4 py-2 bg-green-50 border border-greem-200 rounded-md flex items-center justify-between",children:[(0,c.jsx)("div",{className:"flex items-center gap-2",children:(0,c.jsx)("span",{className:"text-sm text-green-700",children:"Auto-refreshing every 15 seconds"})}),(0,c.jsx)("button",{onClick:()=>ei(!1),className:"text-sm text-green-600 hover:text-green-800",children:"Stop"})]}),(0,c.jsx)(t3,{columns:ae,data:ef,renderSubComponent:ag,getRowCanExpand:()=>!0})]})]})]}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(ax,{userID:n,userRole:i,token:r,accessToken:a,isActive:"audit logs"===Q,premiumUser:m,allTeams:o})})]})]})})}function ag(e){var s,t,l,a,r;let{row:i}=e,n=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},o=i.original.metadata||{},d="failure"===o.status,m=d?o.error_information:null,u=i.original.messages&&(Array.isArray(i.original.messages)?i.original.messages.length>0:Object.keys(i.original.messages).length>0),x=i.original.response&&Object.keys(n(i.original.response)).length>0,h=o.vector_store_request_metadata&&Array.isArray(o.vector_store_request_metadata)&&o.vector_store_request_metadata.length>0,p=i.original.metadata&&i.original.metadata.guardrail_information,g=p&&(null===(r=i.original.metadata)||void 0===r?void 0:r.guardrail_information.masked_entity_count)?Object.values(i.original.metadata.guardrail_information.masked_entity_count).reduce((e,s)=>e+("number"==typeof s?s:0),0):0;return(0,c.jsxs)("div",{className:"p-6 bg-gray-50 space-y-6",children:[(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,c.jsx)("div",{className:"p-4 border-b",children:(0,c.jsx)("h3",{className:"text-lg font-medium",children:"Request Details"})}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4 p-4",children:[(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Request ID:"}),(0,c.jsx)("span",{className:"font-mono text-sm",children:i.original.request_id})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Model:"}),(0,c.jsx)("span",{children:i.original.model})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Model ID:"}),(0,c.jsx)("span",{children:i.original.model_id})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Call Type:"}),(0,c.jsx)("span",{children:i.original.call_type})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,c.jsx)("span",{children:i.original.custom_llm_provider||"-"})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"API Base:"}),(0,c.jsx)(z.Z,{title:i.original.api_base||"-",children:(0,c.jsx)("span",{className:"max-w-[15ch] truncate block",children:i.original.api_base||"-"})})]}),(null==i?void 0:null===(s=i.original)||void 0===s?void 0:s.requester_ip_address)&&(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"IP Address:"}),(0,c.jsx)("span",{children:null==i?void 0:null===(t=i.original)||void 0===t?void 0:t.requester_ip_address})]}),p&&(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail:"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"font-mono",children:i.original.metadata.guardrail_information.guardrail_name}),g>0&&(0,c.jsxs)("span",{className:"ml-2 px-2 py-0.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[g," masked"]})]})]})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Tokens:"}),(0,c.jsxs)("span",{children:[i.original.total_tokens," (",i.original.prompt_tokens,"+",i.original.completion_tokens,")"]})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Cost:"}),(0,c.jsxs)("span",{children:["$",eD(i.original.spend||0,6)]})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Cache Hit:"}),(0,c.jsx)("span",{children:i.original.cache_hit})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,c.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat("failure"!==((null===(l=i.original.metadata)||void 0===l?void 0:l.status)||"Success").toLowerCase()?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"failure"!==((null===(a=i.original.metadata)||void 0===a?void 0:a.status)||"Success").toLowerCase()?"Success":"Failure"})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,c.jsx)("span",{children:i.original.startTime})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,c.jsx)("span",{children:i.original.endTime})]}),(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,c.jsxs)("span",{children:[i.original.duration," s."]})]})]})]})]}),(0,c.jsx)(ai,{show:!u&&!x}),(0,c.jsx)(aa,{row:i,hasMessages:u,hasResponse:x,hasError:d,errorInfo:m,getRawRequest:()=>{var e;return(null===(e=i.original)||void 0===e?void 0:e.proxy_server_request)?n(i.original.proxy_server_request):n(i.original.messages)},formattedResponse:()=>d&&m?{error:{message:m.error_message||"An error occurred",type:m.error_class||"error",code:m.error_code||"unknown",param:null}}:n(i.original.response)}),p&&(0,c.jsx)(ad,{data:i.original.metadata.guardrail_information}),h&&(0,c.jsx)(ac,{data:o.vector_store_request_metadata}),d&&m&&(0,c.jsx)(ar,{errorInfo:m}),i.original.request_tags&&Object.keys(i.original.request_tags).length>0&&(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,c.jsx)("div",{className:"flex justify-between items-center p-4 border-b",children:(0,c.jsx)("h3",{className:"text-lg font-medium",children:"Request Tags"})}),(0,c.jsx)("div",{className:"p-4",children:(0,c.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(i.original.request_tags).map(e=>{let[s,t]=e;return(0,c.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[s,": ",String(t)]},s)})})})]}),i.original.metadata&&Object.keys(i.original.metadata).length>0&&(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,c.jsx)("h3",{className:"text-lg font-medium",children:"Metadata"}),(0,c.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(i.original.metadata,null,2))},className:"p-1 hover:bg-gray-200 rounded",title:"Copy metadata",children:(0,c.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,c.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,c.jsx)("div",{className:"p-4 overflow-auto max-h-64",children:(0,c.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(i.original.metadata,null,2)})})]})]})}var aj=t(36172),af=t(14042),av=e=>{let{userID:s,userRole:t,accessToken:l,userSpend:a,userMaxBudget:r,selectedTeam:i}=e;console.log("userSpend: ".concat(a));let[n,o]=(0,d.useState)(null!==a?a:0),[m,u]=(0,d.useState)(i?Number(eD(i.max_budget,4)):null);(0,d.useEffect)(()=>{if(i){if("Default Team"===i.team_alias)u(r);else{let e=!1;if(i.team_memberships)for(let t of i.team_memberships)t.user_id===s&&"max_budget"in t.litellm_budget_table&&null!==t.litellm_budget_table.max_budget&&(u(t.litellm_budget_table.max_budget),e=!0);e||u(i.max_budget)}}},[i,r]);let[x,h]=(0,d.useState)([]);(0,d.useEffect)(()=>{let e=async()=>{if(!l||!s||!t)return};(async()=>{try{if(null===s||null===t)return;if(null!==l){let e=(await (0,g.modelAvailableCall)(l,s,t)).data.map(e=>e.id);console.log("available_model_names:",e),h(e)}}catch(e){console.error("Error fetching user models:",e)}})(),e()},[t,l,s]),(0,d.useEffect)(()=>{null!==a&&o(a)},[a]);let p=[];i&&i.models&&(p=i.models),p&&p.includes("all-proxy-models")?(console.log("user models:",x),p=x):p&&p.includes("all-team-models")?p=i.models:p&&0===p.length&&(p=x);let j=null!==m?"$".concat(eD(Number(m),4)," limit"):"No limit",f=void 0!==n?eD(n,4):null;return console.log("spend in view user spend: ".concat(n)),(0,c.jsx)("div",{className:"flex items-center",children:(0,c.jsxs)("div",{className:"flex justify-between gap-x-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content",children:"Total Spend"}),(0,c.jsxs)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:["$",f]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content",children:"Max Budget"}),(0,c.jsx)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:j})]})]})})};let a_=e=>{let{key:s,info:t}=e;return{token:s,...t}};var ay=e=>{let{topKeys:s,accessToken:t,userID:l,userRole:a,teams:r,premiumUser:i}=e,[n,o]=(0,d.useState)(!1),[m,u]=(0,d.useState)(null),[x,h]=(0,d.useState)(void 0),[p,j]=(0,d.useState)("table"),f=async e=>{if(t)try{let s=await (0,g.keyInfoV1Call)(t,e.api_key),l=a_(s);h(l),u(e.api_key),o(!0)}catch(e){console.error("Error fetching key info:",e)}},v=()=>{o(!1),u(null),h(void 0)};d.useEffect(()=>{let e=e=>{"Escape"===e.key&&n&&v()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]);let y=s.map(e=>({...e,display_key_alias:e.key_alias&&e.key_alias.length>10?"".concat(e.key_alias.slice(0,10),"..."):e.key_alias||"-"}));return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"mb-4 flex justify-end items-center",children:(0,c.jsxs)("div",{className:"flex space-x-2",children:[(0,c.jsx)("button",{onClick:()=>j("table"),className:"px-3 py-1 text-sm rounded-md ".concat("table"===p?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"Table View"}),(0,c.jsx)("button",{onClick:()=>j("chart"),className:"px-3 py-1 text-sm rounded-md ".concat("chart"===p?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"Chart View"})]})}),"chart"===p?(0,c.jsx)("div",{className:"relative",children:(0,c.jsx)(s$.Z,{className:"mt-4 h-40 cursor-pointer hover:opacity-90",data:y,index:"display_key_alias",categories:["spend"],colors:["cyan"],yAxisWidth:120,tickGap:5,layout:"vertical",showXAxis:!1,showLegend:!1,valueFormatter:e=>e?"$".concat(eD(e,2)):"No Key Alias",onValueChange:e=>f(e),showTooltip:!0,customTooltip:e=>{var s,t;let l=null===(t=e.payload)||void 0===t?void 0:null===(s=t[0])||void 0===s?void 0:s.payload;return(0,c.jsx)("div",{className:"relative z-50 p-3 bg-black/90 shadow-lg rounded-lg text-white max-w-xs",children:(0,c.jsxs)("div",{className:"space-y-1.5",children:[(0,c.jsxs)("div",{className:"text-sm",children:[(0,c.jsx)("span",{className:"text-gray-300",children:"Key Alias: "}),(0,c.jsx)("span",{className:"font-mono text-gray-100 break-all",children:null==l?void 0:l.key_alias})]}),(0,c.jsxs)("div",{className:"text-sm",children:[(0,c.jsx)("span",{className:"text-gray-300",children:"Key ID: "}),(0,c.jsx)("span",{className:"font-mono text-gray-100 break-all",children:null==l?void 0:l.api_key})]}),(0,c.jsxs)("div",{className:"text-sm",children:[(0,c.jsx)("span",{className:"text-gray-300",children:"Spend: "}),(0,c.jsxs)("span",{className:"text-white font-medium",children:["$",eD(null==l?void 0:l.spend,2)]})]})]})})}})}):(0,c.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,c.jsx)(t3,{columns:[{header:"Key ID",accessorKey:"api_key",cell:e=>(0,c.jsx)("div",{className:"overflow-hidden",children:(0,c.jsx)(z.Z,{title:e.getValue(),children:(0,c.jsx)(_.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>f(e.row.original),children:e.getValue()?"".concat(e.getValue().slice(0,7),"..."):"-"})})})},{header:"Key Alias",accessorKey:"key_alias",cell:e=>e.getValue()||"-"},{header:"Spend (USD)",accessorKey:"spend",cell:e=>"$".concat(eD(e.getValue(),2))}],data:s,renderSubComponent:()=>(0,c.jsx)(c.Fragment,{}),getRowCanExpand:()=>!1,isLoading:!1})}),n&&m&&x&&(console.log("Rendering modal with:",{isModalOpen:n,selectedKey:m,keyData:x}),(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&v()},children:(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-xl relative w-11/12 max-w-6xl max-h-[90vh] overflow-y-auto min-h-[750px]",children:[(0,c.jsx)("button",{onClick:v,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:(0,c.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,c.jsx)("div",{className:"p-6 h-full",children:(0,c.jsx)(sn,{keyId:m,onClose:v,keyData:x,accessToken:t,userID:l,userRole:a,teams:r,premiumUser:i})})]})}))]})};function ab(e){return e>=1e6?(e/1e6).toFixed(2)+"M":e>=1e3?e/1e3+"k":e.toString()}function aN(e){return 0===e?"$0":e>=1e6?"$"+e/1e6+"M":e>=1e3?"$"+e/1e3+"k":"$"+e}let aZ={blue:"#3b82f6",cyan:"#06b6d4",indigo:"#6366f1",green:"#22c55e",red:"#ef4444",purple:"#8b5cf6"},aw=e=>{let{active:s,payload:t,label:l}=e;if(s&&t&&t.length){let e=e=>e.replace("metrics.","").replace(/_/g," ").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),s=(e,s)=>{let t=s.substring(s.indexOf(".")+1);if(e.metrics&&t in e.metrics)return e.metrics[t]};return(0,c.jsxs)("div",{className:"w-56 rounded-tremor-default border border-tremor-border bg-tremor-background p-2 text-tremor-default shadow-tremor-dropdown",children:[(0,c.jsx)("p",{className:"text-tremor-content-strong",children:l}),t.map(t=>{var l;let a=null===(l=t.dataKey)||void 0===l?void 0:l.toString();if(!a||!t.payload)return null;let r=s(t.payload,a),i=a.includes("spend"),n=void 0!==r?i?"$".concat(r.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})):r.toLocaleString():"N/A",o=aZ[t.color]||t.color;return(0,c.jsxs)("div",{className:"flex items-center justify-between space-x-4",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("span",{className:"h-2 w-2 shrink-0 rounded-full ring-2 ring-white drop-shadow-md",style:{backgroundColor:o}}),(0,c.jsx)("p",{className:"font-medium text-tremor-content dark:text-dark-tremor-content",children:e(a)})]}),(0,c.jsx)("p",{className:"font-medium text-tremor-content-emphasis dark:text-dark-tremor-content-emphasis",children:n})]},a)})]})}return null},ak=e=>{let{categories:s,colors:t}=e,l=e=>e.replace("metrics.","").replace(/_/g," ").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return(0,c.jsx)("div",{className:"flex items-center justify-end space-x-4",children:s.map((e,s)=>{let a=aZ[t[s]]||t[s];return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("span",{className:"h-2 w-2 shrink-0 rounded-full ring-4 ring-white",style:{backgroundColor:a}}),(0,c.jsx)("p",{className:"text-sm text-tremor-content dark:text-dark-tremor-content",children:l(e)})]},e)})})},aS=e=>{var s,t;let{modelName:l,metrics:a}=e;return(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)(v.Z,{numItems:4,className:"gap-4",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Requests"}),(0,c.jsx)(k.Z,{children:a.total_requests.toLocaleString()})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Successful Requests"}),(0,c.jsx)(k.Z,{children:a.total_successful_requests.toLocaleString()})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Tokens"}),(0,c.jsx)(k.Z,{children:a.total_tokens.toLocaleString()}),(0,c.jsxs)(w.Z,{children:[Math.round(a.total_tokens/a.total_successful_requests)," ","avg per successful request"]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Spend"}),(0,c.jsxs)(k.Z,{children:["$",eD(a.total_spend,2)]}),(0,c.jsxs)(w.Z,{children:["$",eD(a.total_spend/a.total_successful_requests,3)," ","per successful request"]})]})]}),a.top_api_keys&&a.top_api_keys.length>0&&(0,c.jsxs)(W.Z,{className:"mt-4",children:[(0,c.jsx)(k.Z,{children:"Top API Keys by Spend"}),(0,c.jsx)("div",{className:"mt-3",children:(0,c.jsx)("div",{className:"grid grid-cols-1 gap-2",children:a.top_api_keys.map((e,s)=>(0,c.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:e.key_alias||"".concat(e.api_key.substring(0,10),"...")}),e.team_id&&(0,c.jsxs)(w.Z,{className:"text-xs text-gray-500",children:["Team: ",e.team_id]})]}),(0,c.jsxs)("div",{className:"text-right",children:[(0,c.jsxs)(w.Z,{className:"font-medium",children:["$",eD(e.spend,2)]}),(0,c.jsxs)(w.Z,{className:"text-xs text-gray-500",children:[e.requests.toLocaleString()," requests | ",e.tokens.toLocaleString()," tokens"]})]})]},e.api_key))})})]}),(0,c.jsxs)(v.Z,{numItems:2,className:"gap-4",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(k.Z,{children:"Total Tokens"}),(0,c.jsx)(ak,{categories:["metrics.prompt_tokens","metrics.completion_tokens","metrics.total_tokens"],colors:["blue","cyan","indigo"]})]}),(0,c.jsx)(sW.Z,{className:"mt-4",data:a.daily_data,index:"date",categories:["metrics.prompt_tokens","metrics.completion_tokens","metrics.total_tokens"],colors:["blue","cyan","indigo"],valueFormatter:ab,customTooltip:aw,showLegend:!1})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(k.Z,{children:"Requests per day"}),(0,c.jsx)(ak,{categories:["metrics.api_requests"],colors:["blue"]})]}),(0,c.jsx)(s$.Z,{className:"mt-4",data:a.daily_data,index:"date",categories:["metrics.api_requests"],colors:["blue"],valueFormatter:ab,customTooltip:aw,showLegend:!1})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(k.Z,{children:"Spend per day"}),(0,c.jsx)(ak,{categories:["metrics.spend"],colors:["green"]})]}),(0,c.jsx)(s$.Z,{className:"mt-4",data:a.daily_data,index:"date",categories:["metrics.spend"],colors:["green"],valueFormatter:aN,customTooltip:aw,showLegend:!1})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(k.Z,{children:"Success vs Failed Requests"}),(0,c.jsx)(ak,{categories:["metrics.successful_requests","metrics.failed_requests"],colors:["green","red"]})]}),(0,c.jsx)(sW.Z,{className:"mt-4",data:a.daily_data,index:"date",categories:["metrics.successful_requests","metrics.failed_requests"],colors:["green","red"],valueFormatter:ab,stack:!0,customTooltip:aw,showLegend:!1})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(k.Z,{children:"Prompt Caching Metrics"}),(0,c.jsx)(ak,{categories:["metrics.cache_read_input_tokens","metrics.cache_creation_input_tokens"],colors:["cyan","purple"]})]}),(0,c.jsxs)("div",{className:"mb-2",children:[(0,c.jsxs)(w.Z,{children:["Cache Read:"," ",(null===(s=a.total_cache_read_input_tokens)||void 0===s?void 0:s.toLocaleString())||0," ","tokens"]}),(0,c.jsxs)(w.Z,{children:["Cache Creation:"," ",(null===(t=a.total_cache_creation_input_tokens)||void 0===t?void 0:t.toLocaleString())||0," ","tokens"]})]}),(0,c.jsx)(sW.Z,{className:"mt-4",data:a.daily_data,index:"date",categories:["metrics.cache_read_input_tokens","metrics.cache_creation_input_tokens"],colors:["cyan","purple"],valueFormatter:ab,customTooltip:aw,showLegend:!1})]})]})]})},aC=e=>{let{modelMetrics:s}=e,t=Object.keys(s).sort((e,t)=>""===e?1:""===t?-1:s[t].total_spend-s[e].total_spend),l={total_requests:0,total_successful_requests:0,total_tokens:0,total_spend:0,total_cache_read_input_tokens:0,total_cache_creation_input_tokens:0,daily_data:{}};Object.values(s).forEach(e=>{l.total_requests+=e.total_requests,l.total_successful_requests+=e.total_successful_requests,l.total_tokens+=e.total_tokens,l.total_spend+=e.total_spend,l.total_cache_read_input_tokens+=e.total_cache_read_input_tokens||0,l.total_cache_creation_input_tokens+=e.total_cache_creation_input_tokens||0,e.daily_data.forEach(e=>{l.daily_data[e.date]||(l.daily_data[e.date]={prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,spend:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0}),l.daily_data[e.date].prompt_tokens+=e.metrics.prompt_tokens,l.daily_data[e.date].completion_tokens+=e.metrics.completion_tokens,l.daily_data[e.date].total_tokens+=e.metrics.total_tokens,l.daily_data[e.date].api_requests+=e.metrics.api_requests,l.daily_data[e.date].spend+=e.metrics.spend,l.daily_data[e.date].successful_requests+=e.metrics.successful_requests,l.daily_data[e.date].failed_requests+=e.metrics.failed_requests,l.daily_data[e.date].cache_read_input_tokens+=e.metrics.cache_read_input_tokens||0,l.daily_data[e.date].cache_creation_input_tokens+=e.metrics.cache_creation_input_tokens||0})});let a=Object.entries(l.daily_data).map(e=>{let[s,t]=e;return{date:s,metrics:t}}).sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime());return(0,c.jsxs)("div",{className:"space-y-8",children:[(0,c.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,c.jsx)(k.Z,{children:"Overall Usage"}),(0,c.jsxs)(v.Z,{numItems:4,className:"gap-4 mb-4",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Requests"}),(0,c.jsx)(k.Z,{children:l.total_requests.toLocaleString()})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Successful Requests"}),(0,c.jsx)(k.Z,{children:l.total_successful_requests.toLocaleString()})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Tokens"}),(0,c.jsx)(k.Z,{children:l.total_tokens.toLocaleString()})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Total Spend"}),(0,c.jsxs)(k.Z,{children:["$",eD(l.total_spend,2)]})]})]}),(0,c.jsxs)(v.Z,{numItems:2,className:"gap-4",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(k.Z,{children:"Total Tokens Over Time"}),(0,c.jsx)(ak,{categories:["metrics.prompt_tokens","metrics.completion_tokens","metrics.total_tokens"],colors:["blue","cyan","indigo"]})]}),(0,c.jsx)(sW.Z,{className:"mt-4",data:a,index:"date",categories:["metrics.prompt_tokens","metrics.completion_tokens","metrics.total_tokens"],colors:["blue","cyan","indigo"],valueFormatter:ab,customTooltip:aw,showLegend:!1})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(k.Z,{children:"Total Requests Over Time"}),(0,c.jsx)(ak,{categories:["metrics.successful_requests","metrics.failed_requests"],colors:["green","red"]})]}),(0,c.jsx)(sW.Z,{className:"mt-4",data:a,index:"date",categories:["metrics.successful_requests","metrics.failed_requests"],colors:["green","red"],valueFormatter:ab,stack:!0,customTooltip:aw,showLegend:!1})]})]})]}),(0,c.jsx)(tx.default,{defaultActiveKey:t[0],children:t.map(e=>(0,c.jsx)(tx.default.Panel,{header:(0,c.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,c.jsx)(k.Z,{children:s[e].label||"Unknown Item"}),(0,c.jsxs)("div",{className:"flex space-x-4 text-sm text-gray-500",children:[(0,c.jsxs)("span",{children:["$",eD(s[e].total_spend,2)]}),(0,c.jsxs)("span",{children:[s[e].total_requests.toLocaleString()," ","requests"]})]})]}),children:(0,c.jsx)(aS,{modelName:e||"Unknown Model",metrics:s[e]})},e))})]})},aI=(e,s)=>{let t=e.metadata.key_alias||"key-hash-".concat(s),l=e.metadata.team_id;return l?"".concat(t," (team_id: ").concat(l,")"):t},aP=(e,s)=>{let t={};return e.results.forEach(e=>{Object.entries(e.breakdown[s]||{}).forEach(l=>{let[a,r]=l;t[a]||(t[a]={label:"api_keys"===s?aI(r,a):a,total_requests:0,total_successful_requests:0,total_failed_requests:0,total_tokens:0,prompt_tokens:0,completion_tokens:0,total_spend:0,total_cache_read_input_tokens:0,total_cache_creation_input_tokens:0,top_api_keys:[],daily_data:[]}),t[a].total_requests+=r.metrics.api_requests,t[a].prompt_tokens+=r.metrics.prompt_tokens,t[a].completion_tokens+=r.metrics.completion_tokens,t[a].total_tokens+=r.metrics.total_tokens,t[a].total_spend+=r.metrics.spend,t[a].total_successful_requests+=r.metrics.successful_requests,t[a].total_failed_requests+=r.metrics.failed_requests,t[a].total_cache_read_input_tokens+=r.metrics.cache_read_input_tokens||0,t[a].total_cache_creation_input_tokens+=r.metrics.cache_creation_input_tokens||0,t[a].daily_data.push({date:e.date,metrics:{prompt_tokens:r.metrics.prompt_tokens,completion_tokens:r.metrics.completion_tokens,total_tokens:r.metrics.total_tokens,api_requests:r.metrics.api_requests,spend:r.metrics.spend,successful_requests:r.metrics.successful_requests,failed_requests:r.metrics.failed_requests,cache_read_input_tokens:r.metrics.cache_read_input_tokens||0,cache_creation_input_tokens:r.metrics.cache_creation_input_tokens||0}})})}),"api_keys"!==s&&Object.entries(t).forEach(l=>{let[a,r]=l,i={};e.results.forEach(e=>{var t;let l=null===(t=e.breakdown[s])||void 0===t?void 0:t[a];l&&"api_key_breakdown"in l&&Object.entries(l.api_key_breakdown||{}).forEach(e=>{let[s,t]=e;i[s]||(i[s]={api_key:s,key_alias:t.metadata.key_alias,team_id:t.metadata.team_id,spend:0,requests:0,tokens:0}),i[s].spend+=t.metrics.spend,i[s].requests+=t.metrics.api_requests,i[s].tokens+=t.metrics.total_tokens})}),t[a].top_api_keys=Object.values(i).sort((e,s)=>s.spend-e.spend).slice(0,5)}),Object.values(t).forEach(e=>{e.daily_data.sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime())}),t};var aA=e=>{let{accessToken:s,entityType:t,entityId:l,userID:a,userRole:r,entityList:i,premiumUser:n}=e,[o,m]=(0,d.useState)({results:[],metadata:{total_spend:0,total_api_requests:0,total_successful_requests:0,total_failed_requests:0,total_tokens:0}}),u=aP(o,"models"),x=aP(o,"api_keys"),[h,p]=(0,d.useState)([]),[j,_]=(0,d.useState)({from:new Date(Date.now()-24192e5),to:new Date}),y=async()=>{if(!s||!j.from||!j.to)return;let e=new Date(j.from),l=new Date(j.to);if("tag"===t)m(await (0,g.tagDailyActivityCall)(s,e,l,1,h.length>0?h:null));else if("team"===t)m(await (0,g.teamDailyActivityCall)(s,e,l,1,h.length>0?h:null));else throw Error("Invalid entity type")};(0,d.useEffect)(()=>{y()},[s,j,l,h]);let b=()=>{let e={};return o.results.forEach(s=>{Object.entries(s.breakdown.providers||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={provider:t,spend:0,requests:0,successful_requests:0,failed_requests:0,tokens:0});try{e[t].spend+=l.metrics.spend,e[t].requests+=l.metrics.api_requests,e[t].successful_requests+=l.metrics.successful_requests,e[t].failed_requests+=l.metrics.failed_requests,e[t].tokens+=l.metrics.total_tokens}catch(e){console.error("Error processing provider ".concat(t,": ").concat(e))}})}),Object.values(e).filter(e=>e.spend>0).sort((e,s)=>s.spend-e.spend)},N=e=>0===h.length?e:e.filter(e=>h.includes(e.metadata.id)),Z=()=>{let e={};return o.results.forEach(s=>{Object.entries(s.breakdown.entities||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{alias:l.metadata.team_alias||t,id:t}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests,e[t].metrics.failed_requests+=l.metrics.failed_requests,e[t].metrics.total_tokens+=l.metrics.total_tokens})}),N(Object.values(e).sort((e,s)=>s.metrics.spend-e.metrics.spend))};return(0,c.jsxs)("div",{style:{width:"100%"},children:[(0,c.jsxs)(v.Z,{numItems:2,className:"gap-2 w-full mb-4",children:[(0,c.jsx)(f.Z,{children:(0,c.jsx)(sY,{value:j,onValueChange:_})}),i&&i.length>0&&(0,c.jsxs)(f.Z,{children:[(0,c.jsxs)(w.Z,{children:["Filter by ","tag"===t?"Tags":"Teams"]}),(0,c.jsx)(C.default,{mode:"multiple",style:{width:"100%"},placeholder:"Select ".concat("tag"===t?"tags":"teams"," to filter..."),value:h,onChange:p,options:(()=>{if(i)return i})(),className:"mt-2",allowClear:!0})]})]}),(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{variant:"solid",className:"mt-1",children:[(0,c.jsx)(eY.Z,{children:"Cost"}),(0,c.jsx)(eY.Z,{children:"Model Activity"}),(0,c.jsx)(eY.Z,{children:"Key Activity"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(v.Z,{numItems:2,className:"gap-2 w-full",children:[(0,c.jsx)(f.Z,{numColSpan:2,children:(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)(k.Z,{children:["tag"===t?"Tag":"Team"," Spend Overview"]}),(0,c.jsxs)(v.Z,{numItems:5,className:"gap-4 mt-4",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Total Spend"}),(0,c.jsxs)(w.Z,{className:"text-2xl font-bold mt-2",children:["$",eD(o.metadata.total_spend,2)]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Total Requests"}),(0,c.jsx)(w.Z,{className:"text-2xl font-bold mt-2",children:o.metadata.total_api_requests.toLocaleString()})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Successful Requests"}),(0,c.jsx)(w.Z,{className:"text-2xl font-bold mt-2 text-green-600",children:o.metadata.total_successful_requests.toLocaleString()})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Failed Requests"}),(0,c.jsx)(w.Z,{className:"text-2xl font-bold mt-2 text-red-600",children:o.metadata.total_failed_requests.toLocaleString()})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Total Tokens"}),(0,c.jsx)(w.Z,{className:"text-2xl font-bold mt-2",children:o.metadata.total_tokens.toLocaleString()})]})]})]})}),(0,c.jsx)(f.Z,{numColSpan:2,children:(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Daily Spend"}),(0,c.jsx)(s$.Z,{data:[...o.results].sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()),index:"date",categories:["metrics.spend"],colors:["cyan"],valueFormatter:aN,yAxisWidth:100,showLegend:!1,customTooltip:e=>{let{payload:s,active:l}=e;if(!l||!(null==s?void 0:s[0]))return null;let a=s[0].payload,r=Object.keys(a.breakdown.entities||{}).length;return(0,c.jsxs)("div",{className:"bg-white p-4 shadow-lg rounded-lg border",children:[(0,c.jsx)("p",{className:"font-bold",children:a.date}),(0,c.jsxs)("p",{className:"text-cyan-500",children:["Total Spend: $",eD(a.metrics.spend,2)]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Total Requests: ",a.metrics.api_requests]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Successful: ",a.metrics.successful_requests]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Failed: ",a.metrics.failed_requests]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Total Tokens: ",a.metrics.total_tokens]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["tag"===t?"Total Tags":"Total Teams",": ",r]}),(0,c.jsxs)("div",{className:"mt-2 border-t pt-2",children:[(0,c.jsxs)("p",{className:"font-semibold",children:["Spend by ","tag"===t?"Tag":"Team",":"]}),Object.entries(a.breakdown.entities||{}).sort((e,s)=>{let[,t]=e,[,l]=s,a=t.metrics.spend;return l.metrics.spend-a}).slice(0,5).map(e=>{let[s,t]=e;return(0,c.jsxs)("p",{className:"text-sm text-gray-600",children:[t.metadata.team_alias||s,": $",eD(t.metrics.spend,2)]},s)}),r>5&&(0,c.jsxs)("p",{className:"text-sm text-gray-500 italic",children:["...and ",r-5," more"]})]})]})}})]})}),(0,c.jsx)(f.Z,{numColSpan:2,children:(0,c.jsx)(W.Z,{children:(0,c.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,c.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,c.jsxs)(k.Z,{children:["Spend Per ","tag"===t?"Tag":"Team"]}),(0,c.jsx)(sT.Z,{className:"text-xs",children:"Showing Top 5 by Spend"}),(0,c.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,c.jsxs)("span",{children:["Get Started by Tracking cost per ",t," "]}),(0,c.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/enterprise#spend-tracking",className:"text-blue-500 hover:text-blue-700 ml-1",children:"here"})]})]}),(0,c.jsxs)(v.Z,{numItems:2,className:"gap-6",children:[(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsx)(s$.Z,{className:"mt-4 h-52",data:Z().slice(0,5).map(e=>({...e,metadata:{...e.metadata,alias_display:e.metadata.alias&&e.metadata.alias.length>15?"".concat(e.metadata.alias.slice(0,15),"..."):e.metadata.alias}})),index:"metadata.alias_display",categories:["metrics.spend"],colors:["cyan"],valueFormatter:aN,layout:"vertical",showLegend:!1,yAxisWidth:150,customTooltip:e=>{let{payload:s,active:t}=e;if(!t||!(null==s?void 0:s[0]))return null;let l=s[0].payload;return(0,c.jsxs)("div",{className:"bg-white p-4 shadow-lg rounded-lg border",children:[(0,c.jsx)("p",{className:"font-bold",children:l.metadata.alias}),(0,c.jsxs)("p",{className:"text-cyan-500",children:["Spend: $",eD(l.metrics.spend,4)]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Requests:"," ",l.metrics.api_requests.toLocaleString()]}),(0,c.jsxs)("p",{className:"text-green-600",children:["Successful:"," ",l.metrics.successful_requests.toLocaleString()]}),(0,c.jsxs)("p",{className:"text-red-600",children:["Failed:"," ",l.metrics.failed_requests.toLocaleString()]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Tokens:"," ",l.metrics.total_tokens.toLocaleString()]})]})}})}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsx)("div",{className:"h-52 overflow-y-auto",children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"tag"===t?"Tag":"Team"}),(0,c.jsx)(sb.Z,{children:"Spend"}),(0,c.jsx)(sb.Z,{className:"text-green-600",children:"Successful"}),(0,c.jsx)(sb.Z,{className:"text-red-600",children:"Failed"}),(0,c.jsx)(sb.Z,{children:"Tokens"})]})}),(0,c.jsx)(sv.Z,{children:Z().filter(e=>e.metrics.spend>0).map(e=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:e.metadata.alias}),(0,c.jsxs)(s_.Z,{children:["$",eD(e.metrics.spend,4)]}),(0,c.jsx)(s_.Z,{className:"text-green-600",children:e.metrics.successful_requests.toLocaleString()}),(0,c.jsx)(s_.Z,{className:"text-red-600",children:e.metrics.failed_requests.toLocaleString()}),(0,c.jsx)(s_.Z,{children:e.metrics.total_tokens.toLocaleString()})]},e.metadata.id))})]})})})]})]})})}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Top API Keys"}),(0,c.jsx)(ay,{topKeys:(()=>{let e={};return o.results.forEach(s=>{Object.entries(s.breakdown.api_keys||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{key_alias:l.metadata.key_alias,team_id:l.metadata.team_id||null}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.prompt_tokens+=l.metrics.prompt_tokens,e[t].metrics.completion_tokens+=l.metrics.completion_tokens,e[t].metrics.total_tokens+=l.metrics.total_tokens,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests,e[t].metrics.failed_requests+=l.metrics.failed_requests,e[t].metrics.cache_read_input_tokens+=l.metrics.cache_read_input_tokens||0,e[t].metrics.cache_creation_input_tokens+=l.metrics.cache_creation_input_tokens||0})}),Object.entries(e).map(e=>{let[s,t]=e;return{api_key:s,key_alias:t.metadata.key_alias||"-",spend:t.metrics.spend}}).sort((e,s)=>s.spend-e.spend).slice(0,5)})(),accessToken:s,userID:a,userRole:r,teams:null,premiumUser:n})]})}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Top Models"}),(0,c.jsx)(s$.Z,{className:"mt-4 h-40",data:(()=>{let e={};return o.results.forEach(s=>{Object.entries(s.breakdown.models||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={spend:0,requests:0,successful_requests:0,failed_requests:0,tokens:0});try{e[t].spend+=l.metrics.spend}catch(e){console.error("Error adding spend for ".concat(t,": ").concat(e,", got metrics: ").concat(JSON.stringify(l)))}e[t].requests+=l.metrics.api_requests,e[t].successful_requests+=l.metrics.successful_requests,e[t].failed_requests+=l.metrics.failed_requests,e[t].tokens+=l.metrics.total_tokens})}),Object.entries(e).map(e=>{let[s,t]=e;return{key:s,...t}}).sort((e,s)=>s.spend-e.spend).slice(0,5)})(),index:"display_key",categories:["spend"],colors:["cyan"],valueFormatter:e=>"$".concat(eD(e,2)),layout:"vertical",yAxisWidth:200,showLegend:!1})]})}),(0,c.jsx)(f.Z,{numColSpan:2,children:(0,c.jsx)(W.Z,{children:(0,c.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,c.jsx)(k.Z,{children:"Provider Usage"}),(0,c.jsxs)(v.Z,{numItems:2,children:[(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsx)(af.Z,{className:"mt-4 h-40",data:b(),index:"provider",category:"spend",valueFormatter:e=>"$".concat(eD(e,2)),colors:["cyan","blue","indigo","violet","purple"]})}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Provider"}),(0,c.jsx)(sb.Z,{children:"Spend"}),(0,c.jsx)(sb.Z,{className:"text-green-600",children:"Successful"}),(0,c.jsx)(sb.Z,{className:"text-red-600",children:"Failed"}),(0,c.jsx)(sb.Z,{children:"Tokens"})]})}),(0,c.jsx)(sv.Z,{children:b().map(e=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:e.provider}),(0,c.jsxs)(s_.Z,{children:["$",eD(e.spend,2)]}),(0,c.jsx)(s_.Z,{className:"text-green-600",children:e.successful_requests.toLocaleString()}),(0,c.jsx)(s_.Z,{className:"text-red-600",children:e.failed_requests.toLocaleString()}),(0,c.jsx)(s_.Z,{children:e.tokens.toLocaleString()})]},e.provider))})]})})]})]})})})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(aC,{modelMetrics:u})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(aC,{modelMetrics:x})})]})]})]})},aE=e=>{let{isOpen:s,onClose:t,accessToken:l}=e,[a]=I.Z.useForm(),[r,i]=(0,d.useState)(!1),[n,o]=(0,d.useState)(null),[m,u]=(0,d.useState)(!1),[x,h]=(0,d.useState)("cloudzero"),[p,g]=(0,d.useState)(!1);(0,d.useEffect)(()=>{s&&l&&j()},[s,l]);let j=async()=>{u(!0);try{let e=await fetch("/cloudzero/settings",{method:"GET",headers:{Authorization:"Bearer ".concat(l),"Content-Type":"application/json"}});if(e.ok){let s=await e.json();o(s),a.setFieldsValue({connection_id:s.connection_id})}else if(404!==e.status){let s=await e.json();P.ZP.error("Failed to load existing settings: ".concat(s.error||"Unknown error"))}}catch(e){console.error("Error loading CloudZero settings:",e),P.ZP.error("Failed to load existing settings")}finally{u(!1)}},f=async e=>{if(!l){P.ZP.error("No access token available");return}i(!0);try{let s={...e,timezone:"UTC"},t=await fetch(n?"/cloudzero/settings":"/cloudzero/init",{method:n?"PUT":"POST",headers:{Authorization:"Bearer ".concat(l),"Content-Type":"application/json"},body:JSON.stringify(s)}),a=await t.json();if(t.ok)return P.ZP.success(a.message||"CloudZero settings saved successfully"),o({api_key_masked:e.api_key.substring(0,4)+"****"+e.api_key.slice(-4),connection_id:e.connection_id,status:"configured"}),!0;return P.ZP.error(a.error||"Failed to save CloudZero settings"),!1}catch(e){return console.error("Error saving CloudZero settings:",e),P.ZP.error("Failed to save CloudZero settings"),!1}finally{i(!1)}},v=async()=>{if(!l){P.ZP.error("No access token available");return}g(!0);try{let e=await fetch("/cloudzero/export",{method:"POST",headers:{Authorization:"Bearer ".concat(l),"Content-Type":"application/json"},body:JSON.stringify({limit:1e5,operation:"replace_hourly"})}),s=await e.json();e.ok?(P.ZP.success(s.message||"Export to CloudZero completed successfully"),t()):P.ZP.error(s.error||"Failed to export to CloudZero")}catch(e){console.error("Error exporting to CloudZero:",e),P.ZP.error("Failed to export to CloudZero")}finally{g(!1)}},b=async()=>{g(!0);try{P.ZP.info("CSV export functionality coming soon!"),t()}catch(e){console.error("Error exporting CSV:",e),P.ZP.error("Failed to export CSV")}finally{g(!1)}},N=async()=>{if("cloudzero"===x){if(!n){let e=await a.validateFields();if(!await f(e))return}await v()}else await b()},Z=()=>{a.resetFields(),h("cloudzero"),o(null),t()},k=[{value:"cloudzero",label:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("img",{src:"/cloudzero.png",alt:"CloudZero",className:"w-5 h-5",onError:e=>{e.target.style.display="none"}}),(0,c.jsx)("span",{children:"Export to CloudZero"})]})},{value:"csv",label:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,c.jsx)("span",{children:"Export to CSV"})]})}];return(0,c.jsx)(A.Z,{title:"Export Data",open:s,onCancel:Z,footer:null,width:600,destroyOnClose:!0,children:(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium mb-2 block",children:"Export Destination"}),(0,c.jsx)(C.default,{value:x,onChange:h,options:k,className:"w-full",size:"large"})]}),"cloudzero"===x&&(0,c.jsx)("div",{children:m?(0,c.jsx)("div",{className:"flex justify-center py-8",children:(0,c.jsx)(lm.Z,{size:"large"})}):(0,c.jsxs)(c.Fragment,{children:[n&&(0,c.jsx)(lN.Z,{title:"Existing CloudZero Configuration",icon:()=>(0,c.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green",className:"mb-4",children:(0,c.jsxs)(w.Z,{children:["API Key: ",n.api_key_masked,(0,c.jsx)("br",{}),"Connection ID: ",n.connection_id]})}),!n&&(0,c.jsxs)(I.Z,{form:a,layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{label:"CloudZero API Key",name:"api_key",rules:[{required:!0,message:"Please enter your CloudZero API key"}],children:(0,c.jsx)(y.Z,{type:"password",placeholder:"Enter your CloudZero API key"})}),(0,c.jsx)(I.Z.Item,{label:"Connection ID",name:"connection_id",rules:[{required:!0,message:"Please enter the CloudZero connection ID"}],children:(0,c.jsx)(y.Z,{placeholder:"Enter CloudZero connection ID"})})]})]})}),"csv"===x&&(0,c.jsx)(lN.Z,{title:"CSV Export",icon:()=>(0,c.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),color:"blue",children:(0,c.jsx)(w.Z,{children:"Export your usage data as a CSV file for analysis in spreadsheet applications."})}),(0,c.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,c.jsx)(_.Z,{variant:"secondary",onClick:Z,children:"Cancel"}),(0,c.jsx)(_.Z,{onClick:N,loading:r||p,disabled:r||p,children:"cloudzero"===x?"Export to CloudZero":"Export CSV"})]})]})})},aT=e=>{var s,t,l,a,r,i,n,o,m,u;let{accessToken:x,userRole:h,userID:p,teams:j,premiumUser:_}=e,[y,b]=(0,d.useState)({results:[],metadata:{}}),[N,Z]=(0,d.useState)({from:new Date(Date.now()-24192e5),to:new Date}),[S,C]=(0,d.useState)([]),[I,P]=(0,d.useState)("groups"),[A,E]=(0,d.useState)(!1),T=async()=>{x&&C(Object.values(await (0,g.tagListCall)(x)).map(e=>({label:e.name,value:e.name})))};(0,d.useEffect)(()=>{T()},[x]);let L=(null===(s=y.metadata)||void 0===s?void 0:s.total_spend)||0,O=()=>{let e={};return y.results.forEach(s=>{Object.entries(s.breakdown.providers||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{},api_key_breakdown:{}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.prompt_tokens+=l.metrics.prompt_tokens,e[t].metrics.completion_tokens+=l.metrics.completion_tokens,e[t].metrics.total_tokens+=l.metrics.total_tokens,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests||0,e[t].metrics.failed_requests+=l.metrics.failed_requests||0,e[t].metrics.cache_read_input_tokens+=l.metrics.cache_read_input_tokens||0,e[t].metrics.cache_creation_input_tokens+=l.metrics.cache_creation_input_tokens||0})}),Object.entries(e).map(e=>{let[s,t]=e;return{provider:s,spend:t.metrics.spend,requests:t.metrics.api_requests,successful_requests:t.metrics.successful_requests,failed_requests:t.metrics.failed_requests,tokens:t.metrics.total_tokens}})},M=async()=>{if(!x||!N.from||!N.to)return;let e=new Date(N.from),s=new Date(N.to);try{let t=await (0,g.userDailyActivityCall)(x,e,s);if(t.metadata.total_pages>10)throw Error("Too many pages of data (>10). Please select a smaller date range.");if(t.metadata.total_pages<=1){b(t);return}let l=[...t.results],a={...t.metadata};for(let r=2;r<=t.metadata.total_pages;r++){let t=await (0,g.userDailyActivityCall)(x,e,s,r);l.push(...t.results),t.metadata&&(a.total_spend+=t.metadata.total_spend||0,a.total_api_requests+=t.metadata.total_api_requests||0,a.total_successful_requests+=t.metadata.total_successful_requests||0,a.total_failed_requests+=t.metadata.total_failed_requests||0,a.total_tokens+=t.metadata.total_tokens||0)}b({results:l,metadata:a})}catch(e){throw console.error("Error fetching user spend data:",e),e}};(0,d.useEffect)(()=>{M()},[x,N]);let D=aP(y,"models"),F=aP(y,"api_keys"),R=aP(y,"mcp_servers");return(0,c.jsxs)("div",{style:{width:"100%"},className:"p-8 relative",children:[(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{variant:"solid",className:"mt-1",children:[eE.ZL.includes(h||"")?(0,c.jsx)(eY.Z,{children:"Global Usage"}):(0,c.jsx)(eY.Z,{children:"Your Usage"}),(0,c.jsx)(eY.Z,{children:"Team Usage"}),eE.ZL.includes(h||"")?(0,c.jsx)(eY.Z,{children:"Tag Usage"}):(0,c.jsx)(c.Fragment,{})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsx)(v.Z,{numItems:2,className:"gap-2 w-full mb-4",children:(0,c.jsx)(f.Z,{children:(0,c.jsx)(sY,{value:N,onValueChange:e=>{Z(e)}})})}),(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{variant:"solid",className:"mt-1",children:[(0,c.jsx)(eY.Z,{children:"Cost"}),(0,c.jsx)(eY.Z,{children:"Model Activity"}),(0,c.jsx)(eY.Z,{children:"Key Activity"}),(0,c.jsx)(eY.Z,{children:"MCP Server Activity"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(v.Z,{numItems:2,className:"gap-2 w-full",children:[(0,c.jsxs)(f.Z,{numColSpan:2,children:[(0,c.jsxs)(w.Z,{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content mb-2 mt-2 text-lg",children:["Project Spend"," ",new Date().toLocaleString("default",{month:"long"})," ","1 -"," ",new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate()]}),(0,c.jsx)(av,{userID:p,userRole:h,accessToken:x,userSpend:L,selectedTeam:null,userMaxBudget:null})]}),(0,c.jsx)(f.Z,{numColSpan:2,children:(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Usage Metrics"}),(0,c.jsxs)(v.Z,{numItems:5,className:"gap-4 mt-4",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Total Requests"}),(0,c.jsx)(w.Z,{className:"text-2xl font-bold mt-2",children:(null===(l=y.metadata)||void 0===l?void 0:null===(t=l.total_api_requests)||void 0===t?void 0:t.toLocaleString())||0})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Successful Requests"}),(0,c.jsx)(w.Z,{className:"text-2xl font-bold mt-2 text-green-600",children:(null===(r=y.metadata)||void 0===r?void 0:null===(a=r.total_successful_requests)||void 0===a?void 0:a.toLocaleString())||0})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Failed Requests"}),(0,c.jsx)(w.Z,{className:"text-2xl font-bold mt-2 text-red-600",children:(null===(n=y.metadata)||void 0===n?void 0:null===(i=n.total_failed_requests)||void 0===i?void 0:i.toLocaleString())||0})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Total Tokens"}),(0,c.jsx)(w.Z,{className:"text-2xl font-bold mt-2",children:(null===(m=y.metadata)||void 0===m?void 0:null===(o=m.total_tokens)||void 0===o?void 0:o.toLocaleString())||0})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Average Cost per Request"}),(0,c.jsxs)(w.Z,{className:"text-2xl font-bold mt-2",children:["$",eD((L||0)/((null===(u=y.metadata)||void 0===u?void 0:u.total_api_requests)||1),4)]})]})]})]})}),(0,c.jsx)(f.Z,{numColSpan:2,children:(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Daily Spend"}),(0,c.jsx)(s$.Z,{data:[...y.results].sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()),index:"date",categories:["metrics.spend"],colors:["cyan"],valueFormatter:aN,yAxisWidth:100,showLegend:!1,customTooltip:e=>{let{payload:s,active:t}=e;if(!t||!(null==s?void 0:s[0]))return null;let l=s[0].payload;return(0,c.jsxs)("div",{className:"bg-white p-4 shadow-lg rounded-lg border",children:[(0,c.jsx)("p",{className:"font-bold",children:l.date}),(0,c.jsxs)("p",{className:"text-cyan-500",children:["Spend: $",eD(l.metrics.spend,2)]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Requests: ",l.metrics.api_requests]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Successful: ",l.metrics.successful_requests]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Failed: ",l.metrics.failed_requests]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Tokens: ",l.metrics.total_tokens]})]})}})]})}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)(W.Z,{className:"h-full",children:[(0,c.jsx)(k.Z,{children:"Top API Keys"}),(0,c.jsx)(ay,{topKeys:(()=>{let e={};return y.results.forEach(s=>{Object.entries(s.breakdown.api_keys||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{key_alias:l.metadata.key_alias,team_id:null}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.prompt_tokens+=l.metrics.prompt_tokens,e[t].metrics.completion_tokens+=l.metrics.completion_tokens,e[t].metrics.total_tokens+=l.metrics.total_tokens,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests,e[t].metrics.failed_requests+=l.metrics.failed_requests,e[t].metrics.cache_read_input_tokens+=l.metrics.cache_read_input_tokens||0,e[t].metrics.cache_creation_input_tokens+=l.metrics.cache_creation_input_tokens||0})}),Object.entries(e).map(e=>{let[s,t]=e;return{api_key:s,key_alias:t.metadata.key_alias||"-",spend:t.metrics.spend}}).sort((e,s)=>s.spend-e.spend).slice(0,5)})(),accessToken:x,userID:p,userRole:h,teams:null,premiumUser:_})]})}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)(W.Z,{className:"h-full",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"groups"===I?"Top Public Model Names":"Top Litellm Models"}),(0,c.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,c.jsx)("button",{className:"px-3 py-1 text-sm rounded-md transition-colors ".concat("groups"===I?"bg-white shadow-sm text-gray-900":"text-gray-600 hover:text-gray-900"),onClick:()=>P("groups"),children:"Public Model Name"}),(0,c.jsx)("button",{className:"px-3 py-1 text-sm rounded-md transition-colors ".concat("individual"===I?"bg-white shadow-sm text-gray-900":"text-gray-600 hover:text-gray-900"),onClick:()=>P("individual"),children:"Litellm Model Name"})]})]}),(0,c.jsx)(s$.Z,{className:"mt-4 h-40",data:"groups"===I?(()=>{let e={};return y.results.forEach(s=>{Object.entries(s.breakdown.model_groups||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{},api_key_breakdown:{}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.prompt_tokens+=l.metrics.prompt_tokens,e[t].metrics.completion_tokens+=l.metrics.completion_tokens,e[t].metrics.total_tokens+=l.metrics.total_tokens,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests||0,e[t].metrics.failed_requests+=l.metrics.failed_requests||0,e[t].metrics.cache_read_input_tokens+=l.metrics.cache_read_input_tokens||0,e[t].metrics.cache_creation_input_tokens+=l.metrics.cache_creation_input_tokens||0})}),Object.entries(e).map(e=>{let[s,t]=e;return{key:s,spend:t.metrics.spend,requests:t.metrics.api_requests,successful_requests:t.metrics.successful_requests,failed_requests:t.metrics.failed_requests,tokens:t.metrics.total_tokens}}).sort((e,s)=>s.spend-e.spend).slice(0,5)})():(()=>{let e={};return y.results.forEach(s=>{Object.entries(s.breakdown.models||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{},api_key_breakdown:{}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.prompt_tokens+=l.metrics.prompt_tokens,e[t].metrics.completion_tokens+=l.metrics.completion_tokens,e[t].metrics.total_tokens+=l.metrics.total_tokens,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests||0,e[t].metrics.failed_requests+=l.metrics.failed_requests||0,e[t].metrics.cache_read_input_tokens+=l.metrics.cache_read_input_tokens||0,e[t].metrics.cache_creation_input_tokens+=l.metrics.cache_creation_input_tokens||0})}),Object.entries(e).map(e=>{let[s,t]=e;return{key:s,spend:t.metrics.spend,requests:t.metrics.api_requests,successful_requests:t.metrics.successful_requests,failed_requests:t.metrics.failed_requests,tokens:t.metrics.total_tokens}}).sort((e,s)=>s.spend-e.spend).slice(0,5)})(),index:"key",categories:["spend"],colors:["cyan"],valueFormatter:aN,layout:"vertical",yAxisWidth:200,showLegend:!1,customTooltip:e=>{let{payload:s,active:t}=e;if(!t||!(null==s?void 0:s[0]))return null;let l=s[0].payload;return(0,c.jsxs)("div",{className:"bg-white p-4 shadow-lg rounded-lg border",children:[(0,c.jsx)("p",{className:"font-bold",children:l.key}),(0,c.jsxs)("p",{className:"text-cyan-500",children:["Spend: $",eD(l.spend,2)]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Total Requests:"," ",l.requests.toLocaleString()]}),(0,c.jsxs)("p",{className:"text-green-600",children:["Successful:"," ",l.successful_requests.toLocaleString()]}),(0,c.jsxs)("p",{className:"text-red-600",children:["Failed:"," ",l.failed_requests.toLocaleString()]}),(0,c.jsxs)("p",{className:"text-gray-600",children:["Tokens: ",l.tokens.toLocaleString()]})]})}})]})}),(0,c.jsx)(f.Z,{numColSpan:2,children:(0,c.jsxs)(W.Z,{className:"h-full",children:[(0,c.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,c.jsx)(k.Z,{children:"Spend by Provider"})}),(0,c.jsxs)(v.Z,{numItems:2,children:[(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsx)(af.Z,{className:"mt-4 h-40",data:O(),index:"provider",category:"spend",valueFormatter:e=>"$".concat(eD(e,2)),colors:["cyan"]})}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Provider"}),(0,c.jsx)(sb.Z,{children:"Spend"}),(0,c.jsx)(sb.Z,{className:"text-green-600",children:"Successful"}),(0,c.jsx)(sb.Z,{className:"text-red-600",children:"Failed"}),(0,c.jsx)(sb.Z,{children:"Tokens"})]})}),(0,c.jsx)(sv.Z,{children:O().filter(e=>e.spend>0).map(e=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:e.provider}),(0,c.jsxs)(s_.Z,{children:["$",eD(e.spend,2)]}),(0,c.jsx)(s_.Z,{className:"text-green-600",children:e.successful_requests.toLocaleString()}),(0,c.jsx)(s_.Z,{className:"text-red-600",children:e.failed_requests.toLocaleString()}),(0,c.jsx)(s_.Z,{children:e.tokens.toLocaleString()})]},e.provider))})]})})]})]})})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(aC,{modelMetrics:D})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(aC,{modelMetrics:F})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(aC,{modelMetrics:R})})]})]})]}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(aA,{accessToken:x,entityType:"team",userID:p,userRole:h,entityList:(null==j?void 0:j.map(e=>({label:e.team_alias,value:e.team_id})))||null,premiumUser:_})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(aA,{accessToken:x,entityType:"tag",userID:p,userRole:h,entityList:S,premiumUser:_})})]})]}),(0,c.jsx)(aE,{isOpen:A,onClose:()=>E(!1),accessToken:x})]})},aL=e=>{let{proxySettings:s}=e,t="<your_proxy_base_url>";return s&&s.PROXY_BASE_URL&&void 0!==s.PROXY_BASE_URL&&(t=s.PROXY_BASE_URL),(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(v.Z,{className:"gap-2 p-8 h-[80vh] w-full mt-2",children:(0,c.jsxs)("div",{className:"mb-5",children:[(0,c.jsx)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:"OpenAI Compatible Proxy: API Reference"}),(0,c.jsx)(w.Z,{className:"mt-2 mb-2",children:"LiteLLM is OpenAI Compatible. This means your API Key works with the OpenAI SDK. Just replace the base_url to point to your litellm proxy. Example Below "}),(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{children:[(0,c.jsx)(eY.Z,{children:"OpenAI Python SDK"}),(0,c.jsx)(eY.Z,{children:"LlamaIndex"}),(0,c.jsx)(eY.Z,{children:"Langchain Py"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(l4.Z,{language:"python",children:'\nimport openai\nclient = openai.OpenAI(\n    api_key="your_api_key",\n    base_url="'.concat(t,'" # LiteLLM Proxy is OpenAI compatible, Read More: https://docs.litellm.ai/docs/proxy/user_keys\n)\n\nresponse = client.chat.completions.create(\n    model="gpt-3.5-turbo", # model to send to the proxy\n    messages = [\n        {\n            "role": "user",\n            "content": "this is a test request, write a short poem"\n        }\n    ]\n)\n\nprint(response)\n            ')})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(l4.Z,{language:"python",children:'\nimport os, dotenv\n\nfrom llama_index.llms import AzureOpenAI\nfrom llama_index.embeddings import AzureOpenAIEmbedding\nfrom llama_index import VectorStoreIndex, SimpleDirectoryReader, ServiceContext\n\nllm = AzureOpenAI(\n    engine="azure-gpt-3.5",               # model_name on litellm proxy\n    temperature=0.0,\n    azure_endpoint="'.concat(t,'", # litellm proxy endpoint\n    api_key="sk-1234",                    # litellm proxy API Key\n    api_version="2023-07-01-preview",\n)\n\nembed_model = AzureOpenAIEmbedding(\n    deployment_name="azure-embedding-model",\n    azure_endpoint="').concat(t,'",\n    api_key="sk-1234",\n    api_version="2023-07-01-preview",\n)\n\n\ndocuments = SimpleDirectoryReader("llama_index_data").load_data()\nservice_context = ServiceContext.from_defaults(llm=llm, embed_model=embed_model)\nindex = VectorStoreIndex.from_documents(documents, service_context=service_context)\n\nquery_engine = index.as_query_engine()\nresponse = query_engine.query("What did the author do growing up?")\nprint(response)\n\n            ')})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(l4.Z,{language:"python",children:'\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.prompts.chat import (\n    ChatPromptTemplate,\n    HumanMessagePromptTemplate,\n    SystemMessagePromptTemplate,\n)\nfrom langchain.schema import HumanMessage, SystemMessage\n\nchat = ChatOpenAI(\n    openai_api_base="'.concat(t,'",\n    model = "gpt-3.5-turbo",\n    temperature=0.1\n)\n\nmessages = [\n    SystemMessage(\n        content="You are a helpful assistant that im using to make a test request to."\n    ),\n    HumanMessage(\n        content="test from litellm. tell me why it\'s amazing in 1 sentence"\n    ),\n]\nresponse = chat(messages)\n\nprint(response)\n\n            ')})})]})]})]})})})},aO=t(243),aM=t(93837);async function aD(e,s,t,l,a,r,i,n,o,c,d,m,u){console.log=function(){},console.log("isLocal:",!1);let x=(0,g.getProxyBaseUrl)(),h={};a&&a.length>0&&(h["x-litellm-tags"]=a.join(","));let p=new lW.ZP.OpenAI({apiKey:l,baseURL:x,dangerouslyAllowBrowser:!0,defaultHeaders:h});try{let a;let h=Date.now(),g=!1,w=u?[{type:"mcp",server_label:"litellm",server_url:"".concat(x,"/mcp"),require_approval:"never",headers:{"x-litellm-api-key":"Bearer ".concat(l)}}]:void 0;for await(let l of(await p.chat.completions.create({model:t,stream:!0,stream_options:{include_usage:!0},litellm_trace_id:c,messages:e,...d?{vector_store_ids:d}:{},...m?{guardrails:m}:{},...w?{tools:w,tool_choice:"auto"}:{}},{signal:r}))){var j,f,v,_,y,b,N,Z;console.log("Stream chunk:",l);let e=null===(j=l.choices[0])||void 0===j?void 0:j.delta;if(console.log("Delta content:",null===(v=l.choices[0])||void 0===v?void 0:null===(f=v.delta)||void 0===f?void 0:f.content),console.log("Delta reasoning content:",null==e?void 0:e.reasoning_content),!g&&((null===(y=l.choices[0])||void 0===y?void 0:null===(_=y.delta)||void 0===_?void 0:_.content)||e&&e.reasoning_content)&&(g=!0,a=Date.now()-h,console.log("First token received! Time:",a,"ms"),n?(console.log("Calling onTimingData with:",a),n(a)):console.log("onTimingData callback is not defined!")),null===(N=l.choices[0])||void 0===N?void 0:null===(b=N.delta)||void 0===b?void 0:b.content){let e=l.choices[0].delta.content;s(e,l.model)}if(e&&e.reasoning_content){let s=e.reasoning_content;i&&i(s)}if(l.usage&&o){console.log("Usage data found:",l.usage);let e={completionTokens:l.usage.completion_tokens,promptTokens:l.usage.prompt_tokens,totalTokens:l.usage.total_tokens};(null===(Z=l.usage.completion_tokens_details)||void 0===Z?void 0:Z.reasoning_tokens)&&(e.reasoningTokens=l.usage.completion_tokens_details.reasoning_tokens),o(e)}}}catch(e){throw(null==r?void 0:r.aborted)&&console.log("Chat completion request was cancelled"),e}}async function aF(e,s,t,l,a,r){console.log=function(){},console.log("isLocal:",!1);let i=(0,g.getProxyBaseUrl)(),n=new lW.ZP.OpenAI({apiKey:l,baseURL:i,dangerouslyAllowBrowser:!0,defaultHeaders:a&&a.length>0?{"x-litellm-tags":a.join(",")}:void 0});try{let l=await n.images.generate({model:t,prompt:e},{signal:r});if(console.log(l.data),l.data&&l.data[0]){if(l.data[0].url)s(l.data[0].url,t);else if(l.data[0].b64_json){let e=l.data[0].b64_json;s("data:image/png;base64,".concat(e),t)}else throw Error("No image data found in response")}else throw Error("Invalid response format")}catch(e){throw(null==r?void 0:r.aborted)?console.log("Image generation request was cancelled"):P.ZP.error("Error occurred while generating image. Please try again. Error: ".concat(e),20),e}}async function aR(e,s,t,l,a,r,i){console.log=function(){},console.log("isLocal:",!1);let n=(0,g.getProxyBaseUrl)(),o=new lW.ZP.OpenAI({apiKey:a,baseURL:n,dangerouslyAllowBrowser:!0,defaultHeaders:r&&r.length>0?{"x-litellm-tags":r.join(",")}:void 0});try{let a=await o.images.edit({model:l,image:e,prompt:s},{signal:i});if(console.log(a.data),a.data&&a.data[0]){if(a.data[0].url)t(a.data[0].url,l);else if(a.data[0].b64_json){let e=a.data[0].b64_json;t("data:image/png;base64,".concat(e),l)}else throw Error("No image data found in response")}else throw Error("Invalid response format")}catch(e){throw(null==i?void 0:i.aborted)?console.log("Image edits request was cancelled"):P.ZP.error("Error occurred while editing image. Please try again. Error: ".concat(e),20),e}}async function aq(e,s,t,l){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,n=arguments.length>7?arguments[7]:void 0,o=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,d=arguments.length>10?arguments[10]:void 0,m=arguments.length>11?arguments[11]:void 0,u=arguments.length>12?arguments[12]:void 0;if(!l)throw Error("API key is required");console.log=function(){};let x=(0,g.getProxyBaseUrl)(),h={};a&&a.length>0&&(h["x-litellm-tags"]=a.join(","));let p=new lW.ZP.OpenAI({apiKey:l,baseURL:x,dangerouslyAllowBrowser:!0,defaultHeaders:h});try{let a=Date.now(),h=!1,g=e.map(e=>({role:e.role,content:e.content,type:"message"})),_=u?[{type:"mcp",server_label:"litellm",server_url:"".concat(x,"/mcp"),require_approval:"never",headers:{"x-litellm-api-key":"Bearer ".concat(l)}}]:void 0,y=await p.responses.create({model:t,input:g,stream:!0,litellm_trace_id:c,...d?{vector_store_ids:d}:{},...m?{guardrails:m}:{},..._?{tools:_,tool_choice:"required"}:{}},{signal:r}),b="";for await(let e of y)if(console.log("Response event:",e),"object"==typeof e&&null!==e){var j,f,v;if("response.output_item.done"===e.type&&(null===(j=e.item)||void 0===j?void 0:j.type)==="mcp_call"&&(null===(f=e.item)||void 0===f?void 0:f.name)&&(b=e.item.name,console.log("MCP tool used:",b)),"response.role.delta"===e.type)continue;if("response.output_text.delta"===e.type&&"string"==typeof e.delta){let l=e.delta;if(console.log("Text delta",l),l.trim().length>0&&(s("assistant",l,t),!h)){h=!0;let e=Date.now()-a;console.log("First token received! Time:",e,"ms"),n&&n(e)}}if("response.reasoning.delta"===e.type&&"delta"in e){let s=e.delta;"string"==typeof s&&i&&i(s)}if("response.completed"===e.type&&"response"in e){let s=e.response.usage;if(console.log("Usage data:",s),s&&o){console.log("Usage data:",s);let e={completionTokens:s.output_tokens,promptTokens:s.input_tokens,totalTokens:s.total_tokens};(null===(v=s.completion_tokens_details)||void 0===v?void 0:v.reasoning_tokens)&&(e.reasoningTokens=s.completion_tokens_details.reasoning_tokens),o(e,b)}}}return y}catch(e){throw(null==r?void 0:r.aborted)?console.log("Responses API request was cancelled"):P.ZP.error("Error occurred while generating model response. Please try again. Error: ".concat(e),20),e}}var aU=t(85498);async function az(e,s,t,l){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,n=arguments.length>7?arguments[7]:void 0,o=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,d=arguments.length>10?arguments[10]:void 0,m=arguments.length>11?arguments[11]:void 0,u=arguments.length>12?arguments[12]:void 0;if(!l)throw Error("API key is required");console.log=function(){};let x=(0,g.getProxyBaseUrl)(),h={};a&&a.length>0&&(h["x-litellm-tags"]=a.join(","));let p=new aU.ZP({apiKey:l,baseURL:x,dangerouslyAllowBrowser:!0,defaultHeaders:h});try{let a=Date.now(),h=!1,g=u?[{type:"mcp",server_label:"litellm",server_url:"".concat(x,"/mcp"),require_approval:"never",headers:{"x-litellm-api-key":"Bearer ".concat(l)}}]:void 0,j={model:t,messages:e.map(e=>({role:e.role,content:e.content})),stream:!0,max_tokens:1024,litellm_trace_id:c};for await(let e of(d&&(j.vector_store_ids=d),m&&(j.guardrails=m),g&&(j.tools=g,j.tool_choice="auto"),p.messages.stream(j,{signal:r}))){if(console.log("Stream event:",e),"content_block_delta"===e.type){let l=e.delta;if(!h){h=!0;let e=Date.now()-a;console.log("First token received! Time:",e,"ms"),n&&n(e)}"text_delta"===l.type?s("assistant",l.text,t):"reasoning_delta"===l.type&&i&&i(l.text)}if("message_delta"===e.type&&e.usage&&o){let s=e.usage;console.log("Usage data found:",s);let t={completionTokens:s.output_tokens,promptTokens:s.input_tokens,totalTokens:s.input_tokens+s.output_tokens};o(t)}}}catch(e){throw(null==r?void 0:r.aborted)?console.log("Anthropic messages request was cancelled"):P.ZP.error("Error occurred while generating model response. Please try again. Error: ".concat(e),20),e}}async function aV(e){try{return(await (0,g.mcpToolsCall)(e)).tools||[]}catch(e){return console.error("Error fetching MCP tools:",e),P.ZP.error("Failed to fetch MCP tools"),[]}}var aK=t(49817),aB=t(94263),aG=e=>{let{endpointType:s,onEndpointChange:t,className:l}=e,a=[{value:aK.KP.CHAT,label:"/v1/chat/completions"},{value:aK.KP.RESPONSES,label:"/v1/responses"},{value:aK.KP.ANTHROPIC_MESSAGES,label:"/v1/messages"},{value:aK.KP.IMAGE,label:"/v1/images/generations"},{value:aK.KP.IMAGE_EDITS,label:"/v1/images/edits"}];return(0,c.jsxs)("div",{className:l,children:[(0,c.jsx)(w.Z,{children:"Endpoint Type:"}),(0,c.jsx)(C.default,{showSearch:!0,value:s,style:{width:"100%"},onChange:t,options:a,className:"rounded-md"})]})},aH=e=>{let{onChange:s,value:t,className:l,accessToken:a}=e,[r,i]=(0,d.useState)([]),[n,o]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{(async()=>{if(a)try{let e=await (0,g.tagListCall)(a);console.log("List tags response:",e),i(Object.values(e))}catch(e){console.error("Error fetching tags:",e)}})()},[]),(0,c.jsx)(C.default,{mode:"multiple",placeholder:"Select tags",onChange:s,value:t,loading:n,className:l,options:r.map(e=>({label:e.name,value:e.name,title:e.description||e.name})),optionFilterProp:"label",showSearch:!0,style:{width:"100%"}})},aJ=e=>{let{onChange:s,value:t,className:l,accessToken:a}=e,[r,i]=(0,d.useState)([]),[n,o]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{(async()=>{if(a){o(!0);try{let e=await (0,g.getGuardrailsList)(a);console.log("Guardrails response:",e),e.guardrails&&(console.log("Guardrails data:",e.guardrails),i(e.guardrails))}catch(e){console.error("Error fetching guardrails:",e)}finally{o(!1)}}})()},[a]),(0,c.jsx)("div",{children:(0,c.jsx)(C.default,{mode:"multiple",placeholder:"Select guardrails",onChange:e=>{console.log("Selected guardrails:",e),s(e)},value:t,loading:n,className:l,options:r.map(e=>(console.log("Mapping guardrail:",e),{label:"".concat(e.guardrail_name),value:e.guardrail_name})),optionFilterProp:"label",showSearch:!0,style:{width:"100%"}})})},aY=t(88658),aW=t(83322),a$=e=>{let{reasoningContent:s}=e,[t,l]=(0,d.useState)(!0);return s?(0,c.jsxs)("div",{className:"reasoning-content mt-1 mb-2",children:[(0,c.jsxs)(T.ZP,{type:"text",className:"flex items-center text-xs text-gray-500 hover:text-gray-700",onClick:()=>l(!t),icon:(0,c.jsx)(aW.Z,{}),children:[t?"Hide reasoning":"Show reasoning",t?(0,c.jsx)(tp.Z,{className:"ml-1"}):(0,c.jsx)(t$.Z,{className:"ml-1"})]}),t&&(0,c.jsx)("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md text-sm text-gray-700",children:(0,c.jsx)(aO.U,{components:{code(e){let{node:s,inline:t,className:l,children:a,...r}=e,i=/language-(\w+)/.exec(l||"");return!t&&i?(0,c.jsx)(l4.Z,{style:aB.Z,language:i[1],PreTag:"div",className:"rounded-md my-2",...r,children:String(a).replace(/\n$/,"")}):(0,c.jsx)("code",{className:"".concat(l," px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono"),...r,children:a})}},children:s})})]}):null},aQ=t(5540),aX=t(71282),a0=t(11741),a1=t(16601),a2=t(58630),a4=e=>{let{timeToFirstToken:s,usage:t,toolName:l}=e;return s||t?(0,c.jsxs)("div",{className:"response-metrics mt-2 pt-2 border-t border-gray-100 text-xs text-gray-500 flex flex-wrap gap-3",children:[void 0!==s&&(0,c.jsx)(z.Z,{title:"Time to first token",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(aQ.Z,{className:"mr-1"}),(0,c.jsxs)("span",{children:[(s/1e3).toFixed(2),"s"]})]})}),(null==t?void 0:t.promptTokens)!==void 0&&(0,c.jsx)(z.Z,{title:"Prompt tokens",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(aX.Z,{className:"mr-1"}),(0,c.jsxs)("span",{children:["In: ",t.promptTokens]})]})}),(null==t?void 0:t.completionTokens)!==void 0&&(0,c.jsx)(z.Z,{title:"Completion tokens",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(a0.Z,{className:"mr-1"}),(0,c.jsxs)("span",{children:["Out: ",t.completionTokens]})]})}),(null==t?void 0:t.reasoningTokens)!==void 0&&(0,c.jsx)(z.Z,{title:"Reasoning tokens",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(aW.Z,{className:"mr-1"}),(0,c.jsxs)("span",{children:["Reasoning: ",t.reasoningTokens]})]})}),(null==t?void 0:t.totalTokens)!==void 0&&(0,c.jsx)(z.Z,{title:"Total tokens",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(a1.Z,{className:"mr-1"}),(0,c.jsxs)("span",{children:["Total: ",t.totalTokens]})]})}),l&&(0,c.jsx)(z.Z,{title:"Tool used",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(a2.Z,{className:"mr-1"}),(0,c.jsxs)("span",{children:["Tool: ",l]})]})})]}):null},a5=t(61935),a6=t(69993),a3=t(71891),a8=t(44625),a7=t(57400),a9=t(26430),re=t(11894),rs=t(15883),rt=t(99890),rl=t(23907);let{TextArea:ra}=L.default,{Dragger:rr}=ex.default;var ri=e=>{let{accessToken:s,token:t,userRole:l,userID:a,disabledPersonalKeyCreation:r}=e,[i,n]=(0,d.useState)(!1),[o,m]=(0,d.useState)([]),[u,x]=(0,d.useState)(()=>{let e=sessionStorage.getItem("selectedMCPTools");try{let s=e?JSON.parse(e):[];return Array.isArray(s)?s[0]||"":s}catch(e){return console.error("Error parsing selectedMCPTools from sessionStorage",e),""}}),[h,p]=(0,d.useState)(!1),[g,j]=(0,d.useState)(()=>{let e=sessionStorage.getItem("apiKeySource");if(e)try{return JSON.parse(e)}catch(e){console.error("Error parsing apiKeySource from sessionStorage",e)}return r?"custom":"session"}),[f,v]=(0,d.useState)(()=>sessionStorage.getItem("apiKey")||""),[b,N]=(0,d.useState)(""),[Z,S]=(0,d.useState)(()=>{try{let e=sessionStorage.getItem("chatHistory");return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing chatHistory from sessionStorage",e),[]}}),[I,E]=(0,d.useState)(()=>sessionStorage.getItem("selectedModel")||void 0),[L,O]=(0,d.useState)(!1),[M,D]=(0,d.useState)([]),F=(0,d.useRef)(null),[R,q]=(0,d.useState)(()=>sessionStorage.getItem("endpointType")||aK.KP.CHAT),[V,K]=(0,d.useState)(!1),B=(0,d.useRef)(null),[G,J]=(0,d.useState)(()=>{let e=sessionStorage.getItem("selectedTags");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedTags from sessionStorage",e),[]}}),[Y,$]=(0,d.useState)(()=>{let e=sessionStorage.getItem("selectedVectorStores");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedVectorStores from sessionStorage",e),[]}}),[Q,X]=(0,d.useState)(()=>{let e=sessionStorage.getItem("selectedGuardrails");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedGuardrails from sessionStorage",e),[]}}),[ee,es]=(0,d.useState)(()=>sessionStorage.getItem("messageTraceId")||null),[et,el]=(0,d.useState)(null),[ea,er]=(0,d.useState)(null),[ei,en]=(0,d.useState)(!1),[eo,ec]=(0,d.useState)(""),[ed,eu]=(0,d.useState)("openai"),ex=(0,d.useRef)(null),eh=async()=>{let e="session"===g?s:f;if(e){p(!0);try{let s=await aV(e);m(s)}catch(e){console.error("Error fetching MCP tools:",e)}finally{p(!1)}}};(0,d.useEffect)(()=>{i&&eh()},[i,s,f,g]),(0,d.useEffect)(()=>{ei&&ec((0,aY.L)({apiKeySource:g,accessToken:s,apiKey:f,inputMessage:b,chatHistory:Z,selectedTags:G,selectedVectorStores:Y,selectedGuardrails:Q,endpointType:R,selectedModel:I,selectedSdk:ed}))},[ei,ed,g,s,f,b,Z,G,Y,Q,R,I]),(0,d.useEffect)(()=>{let e=setTimeout(()=>{sessionStorage.setItem("chatHistory",JSON.stringify(Z))},500);return()=>{clearTimeout(e)}},[Z]),(0,d.useEffect)(()=>{sessionStorage.setItem("apiKeySource",JSON.stringify(g)),sessionStorage.setItem("apiKey",f),sessionStorage.setItem("endpointType",R),sessionStorage.setItem("selectedTags",JSON.stringify(G)),sessionStorage.setItem("selectedVectorStores",JSON.stringify(Y)),sessionStorage.setItem("selectedGuardrails",JSON.stringify(Q)),sessionStorage.setItem("selectedMCPTools",JSON.stringify(u)),I?sessionStorage.setItem("selectedModel",I):sessionStorage.removeItem("selectedModel"),ee?sessionStorage.setItem("messageTraceId",ee):sessionStorage.removeItem("messageTraceId")},[g,f,I,R,G,Y,Q,ee,u]),(0,d.useEffect)(()=>{let e="session"===g?s:f;if(!e||!t||!l||!a){console.log("userApiKey or token or userRole or userID is missing = ",e,t,l,a);return}(async()=>{try{if(!e){console.log("userApiKey is missing");return}let s=await tu(e);console.log("Fetched models:",s),s.length>0&&(D(s),I||E(s[0].model_group))}catch(e){console.error("Error fetching model info:",e)}})(),eh()},[s,a,l,g,f,t]),(0,d.useEffect)(()=>{ex.current&&setTimeout(()=>{var e;null===(e=ex.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},100)},[Z]);let ep=(e,s,t)=>{console.log("updateTextUI called with:",e,s,t),S(l=>{let a=l[l.length-1];if(!a||a.role!==e||a.isImage)return[...l,{role:e,content:s,model:t}];{var r;let e={...a,content:a.content+s,model:null!==(r=a.model)&&void 0!==r?r:t};return[...l.slice(0,-1),e]}})},eg=e=>{S(s=>{let t=s[s.length-1];return t&&"assistant"===t.role&&!t.isImage?[...s.slice(0,s.length-1),{...t,reasoningContent:(t.reasoningContent||"")+e}]:s.length>0&&"user"===s[s.length-1].role?[...s,{role:"assistant",content:"",reasoningContent:e}]:s})},ej=e=>{console.log("updateTimingData called with:",e),S(s=>{let t=s[s.length-1];if(console.log("Current last message:",t),t&&"assistant"===t.role){console.log("Updating assistant message with timeToFirstToken:",e);let l=[...s.slice(0,s.length-1),{...t,timeToFirstToken:e}];return console.log("Updated chat history:",l),l}return t&&"user"===t.role?(console.log("Creating new assistant message with timeToFirstToken:",e),[...s,{role:"assistant",content:"",timeToFirstToken:e}]):(console.log("No appropriate message found to update timing"),s)})},ev=(e,s)=>{console.log("Received usage data:",e),S(t=>{let l=t[t.length-1];if(l&&"assistant"===l.role){console.log("Updating message with usage data:",e);let a={...l,usage:e,toolName:s};return console.log("Updated message:",a),[...t.slice(0,t.length-1),a]}return t})},e_=(e,s)=>{S(t=>[...t,{role:"assistant",content:e,model:s,isImage:!0}])},ey=()=>{ea&&URL.revokeObjectURL(ea),el(null),er(null)},eb=async()=>{if(""===b.trim())return;if(R===aK.KP.IMAGE_EDITS&&!et){P.ZP.error("Please upload an image for editing");return}if(!t||!l||!a)return;let e="session"===g?s:f;if(!e){P.ZP.error("Please provide an API key or select Current UI Session");return}B.current=new AbortController;let r=B.current.signal,i={role:"user",content:b},n=ee||(0,aM.Z)();ee||es(n),S([...Z,i]),K(!0);try{if(I){if(R===aK.KP.CHAT){let s=[...Z.filter(e=>!e.isImage).map(e=>{let{role:s,content:t}=e;return{role:s,content:t}}),i];await aD(s,(e,s)=>ep("assistant",e,s),I,e,G,r,eg,ej,ev,n,Y.length>0?Y:void 0,Q.length>0?Q:void 0,u)}else if(R===aK.KP.IMAGE)await aF(b,(e,s)=>e_(e,s),I,e,G,r);else if(R===aK.KP.IMAGE_EDITS)et&&await aR(et,b,(e,s)=>e_(e,s),I,e,G,r);else if(R===aK.KP.RESPONSES){let s=[...Z.filter(e=>!e.isImage).map(e=>{let{role:s,content:t}=e;return{role:s,content:t}}),i];await aq(s,(e,s,t)=>ep(e,s,t),I,e,G,r,eg,ej,ev,n,Y.length>0?Y:void 0,Q.length>0?Q:void 0,u)}else if(R===aK.KP.ANTHROPIC_MESSAGES){let s=[...Z.filter(e=>!e.isImage).map(e=>{let{role:s,content:t}=e;return{role:s,content:t}}),i];await az(s,(e,s,t)=>ep(e,s,t),I,e,G,r,eg,ej,ev,n,Y.length>0?Y:void 0,Q.length>0?Q:void 0,u)}}}catch(e){r.aborted?console.log("Request was cancelled"):(console.error("Error fetching response",e),ep("assistant","Error fetching response:"+e))}finally{K(!1),B.current=null,R===aK.KP.IMAGE_EDITS&&ey()}N("")};if(l&&"Admin Viewer"===l){let{Title:e,Paragraph:s}=em.default;return(0,c.jsxs)("div",{children:[(0,c.jsx)(e,{level:1,children:"Access Denied"}),(0,c.jsx)(s,{children:"Ask your proxy admin for access to test models"})]})}let eN=(0,c.jsx)(a5.Z,{style:{fontSize:24},spin:!0});return(0,c.jsxs)("div",{className:"w-full h-screen p-4 bg-white",children:[(0,c.jsx)(W.Z,{className:"w-full rounded-xl shadow-md overflow-hidden",children:(0,c.jsxs)("div",{className:"flex h-[80vh] w-full gap-4",children:[(0,c.jsxs)("div",{className:"w-1/4 p-4 bg-gray-50 overflow-y-auto",children:[(0,c.jsx)(k.Z,{className:"text-xl font-semibold mb-6 mt-2",children:"Configurations"}),(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)(w.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,c.jsx)(lC.Z,{className:"mr-2"})," API Key Source"]}),(0,c.jsx)(C.default,{disabled:r,value:g,style:{width:"100%"},onChange:e=>{j(e),x("")},options:[{value:"session",label:"Current UI Session"},{value:"custom",label:"Virtual Key"}],className:"rounded-md"}),"custom"===g&&(0,c.jsx)(y.Z,{className:"mt-2",placeholder:"Enter custom API key",type:"password",onValueChange:v,value:f,icon:lC.Z})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)(w.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,c.jsx)(a6.Z,{className:"mr-2"})," Select Model"]}),(0,c.jsx)(C.default,{value:I,placeholder:"Select a Model",onChange:e=>{console.log("selected ".concat(e)),E(e),O("custom"===e)},options:[...Array.from(new Set(M.map(e=>e.model_group))).map((e,s)=>({value:e,label:e,key:s})),{value:"custom",label:"Enter custom model",key:"custom"}],style:{width:"100%"},showSearch:!0,className:"rounded-md"}),L&&(0,c.jsx)(y.Z,{className:"mt-2",placeholder:"Enter custom model name",onValueChange:e=>{F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{E(e)},500)}})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)(w.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,c.jsx)(tJ.Z,{className:"mr-2"})," Endpoint Type"]}),(0,c.jsx)(aG,{endpointType:R,onEndpointChange:e=>{q(e),e!==aK.KP.RESPONSES&&x("")},className:"mb-4"})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)(w.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,c.jsx)(a3.Z,{className:"mr-2"})," Tags"]}),(0,c.jsx)(aH,{value:G,onChange:J,className:"mb-4",accessToken:s||""})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)(w.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,c.jsx)(a2.Z,{className:"mr-2"})," MCP Tool",(0,c.jsx)(z.Z,{className:"ml-1",title:"Select an MCP tool to use in your conversation, only available for virtual keys and /v1/responses endpoint",children:(0,c.jsx)(U.Z,{})})]}),(0,c.jsx)(C.default,{style:{width:"100%"},placeholder:"Select MCP tool",value:u,onChange:e=>x(e),loading:h,className:"mb-4",allowClear:!0,optionLabelProp:"label",disabled:!("custom"===g&&R===aK.KP.RESPONSES),children:Array.isArray(o)&&o.map(e=>(0,c.jsx)(C.default.Option,{value:e.name,label:(0,c.jsx)("div",{className:"font-medium",children:e.name}),children:(0,c.jsxs)("div",{className:"flex flex-col py-1",children:[(0,c.jsx)("span",{className:"font-medium",children:e.name}),(0,c.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:e.description})]})},e.name))})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)(w.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,c.jsx)(a8.Z,{className:"mr-2"})," Vector Store",(0,c.jsx)(z.Z,{className:"ml-1",title:(0,c.jsxs)("span",{children:["Select vector store(s) to use for this LLM API call. You can set up your vector store ",(0,c.jsx)("a",{href:"?page=vector-stores",style:{color:"#1890ff"},children:"here"}),"."]}),children:(0,c.jsx)(U.Z,{})})]}),(0,c.jsx)(H,{value:Y,onChange:$,className:"mb-4",accessToken:s||""})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)(w.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,c.jsx)(a7.Z,{className:"mr-2"})," Guardrails",(0,c.jsx)(z.Z,{className:"ml-1",title:(0,c.jsxs)("span",{children:["Select guardrail(s) to use for this LLM API call. You can set up your guardrails ",(0,c.jsx)("a",{href:"?page=guardrails",style:{color:"#1890ff"},children:"here"}),"."]}),children:(0,c.jsx)(U.Z,{})})]}),(0,c.jsx)(aJ,{value:Q,onChange:X,className:"mb-4",accessToken:s||""})]}),(0,c.jsx)("div",{className:"space-y-2 mt-4",children:(0,c.jsx)(_.Z,{onClick:()=>{S([]),es(null),ey(),sessionStorage.removeItem("chatHistory"),sessionStorage.removeItem("messageTraceId"),P.ZP.success("Chat history cleared.")},className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",icon:a9.Z,children:"Clear Chat"})})]})]}),(0,c.jsxs)("div",{className:"w-3/4 flex flex-col bg-white",children:[(0,c.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,c.jsx)(k.Z,{className:"text-xl font-semibold mb-0",children:"Test Key"}),(0,c.jsx)("div",{className:"flex gap-2",children:(0,c.jsx)(_.Z,{onClick:()=>en(!0),className:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",icon:re.Z,children:"Get Code"})})]}),(0,c.jsxs)("div",{className:"flex-1 overflow-auto p-4 pb-0",children:[0===Z.length&&(0,c.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,c.jsx)(a6.Z,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,c.jsx)(w.Z,{children:"Start a conversation or generate an image"})]}),Z.map((e,s)=>(0,c.jsx)("div",{className:"mb-4 ".concat("user"===e.role?"text-right":"text-left"),children:(0,c.jsxs)("div",{className:"inline-block max-w-[80%] rounded-lg shadow-sm p-3.5 px-4",style:{backgroundColor:"user"===e.role?"#f0f8ff":"#ffffff",border:"user"===e.role?"1px solid #e6f0fa":"1px solid #f0f0f0",textAlign:"left"},children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,c.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full mr-1",style:{backgroundColor:"user"===e.role?"#e6f0fa":"#f5f5f5"},children:"user"===e.role?(0,c.jsx)(rs.Z,{style:{fontSize:"12px",color:"#2563eb"}}):(0,c.jsx)(a6.Z,{style:{fontSize:"12px",color:"#4b5563"}})}),(0,c.jsx)("strong",{className:"text-sm capitalize",children:e.role}),"assistant"===e.role&&e.model&&(0,c.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-600 font-normal",children:e.model})]}),e.reasoningContent&&(0,c.jsx)(a$,{reasoningContent:e.reasoningContent}),(0,c.jsxs)("div",{className:"whitespace-pre-wrap break-words max-w-full message-content",style:{wordWrap:"break-word",overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},children:[e.isImage?(0,c.jsx)("img",{src:e.content,alt:"Generated image",className:"max-w-full rounded-md border border-gray-200 shadow-sm",style:{maxHeight:"500px"}}):(0,c.jsx)(aO.U,{components:{code(e){let{node:s,inline:t,className:l,children:a,...r}=e,i=/language-(\w+)/.exec(l||"");return!t&&i?(0,c.jsx)(l4.Z,{style:aB.Z,language:i[1],PreTag:"div",className:"rounded-md my-2",wrapLines:!0,wrapLongLines:!0,...r,children:String(a).replace(/\n$/,"")}):(0,c.jsx)("code",{className:"".concat(l," px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono"),style:{wordBreak:"break-word"},...r,children:a})},pre:e=>{let{node:s,...t}=e;return(0,c.jsx)("pre",{style:{overflowX:"auto",maxWidth:"100%"},...t})}},children:e.content}),"assistant"===e.role&&(e.timeToFirstToken||e.usage)&&(0,c.jsx)(a4,{timeToFirstToken:e.timeToFirstToken,usage:e.usage,toolName:e.toolName})]})]})},s)),V&&(0,c.jsx)("div",{className:"flex justify-center items-center my-4",children:(0,c.jsx)(lm.Z,{indicator:eN})}),(0,c.jsx)("div",{ref:ex,style:{height:"1px"}})]}),(0,c.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-white",children:[R===aK.KP.IMAGE_EDITS&&(0,c.jsx)("div",{className:"mb-4",children:et?(0,c.jsxs)("div",{className:"relative inline-block",children:[(0,c.jsx)("img",{src:ea||"",alt:"Upload preview",className:"max-w-32 max-h-32 rounded-md border border-gray-200 object-cover"}),(0,c.jsx)("button",{className:"absolute top-1 right-1 bg-white shadow-sm border border-gray-200 rounded px-1 py-1 text-red-500 hover:bg-red-50 text-xs",onClick:ey,children:(0,c.jsx)(ef.Z,{})})]}):(0,c.jsxs)(rr,{beforeUpload:e=>(el(e),er(URL.createObjectURL(e)),!1),accept:"image/*",showUploadList:!1,className:"border-dashed border-2 border-gray-300 rounded-lg p-4",children:[(0,c.jsx)("p",{className:"ant-upload-drag-icon",children:(0,c.jsx)(rt.Z,{style:{fontSize:"24px",color:"#666"}})}),(0,c.jsx)("p",{className:"ant-upload-text text-sm",children:"Click or drag image to upload"}),(0,c.jsx)("p",{className:"ant-upload-hint text-xs text-gray-500",children:"Support for PNG, JPG, JPEG formats"})]})}),(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(ra,{value:b,onChange:e=>N(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),eb())},placeholder:R===aK.KP.CHAT||R===aK.KP.RESPONSES||R===aK.KP.ANTHROPIC_MESSAGES?"Type your message... (Shift+Enter for new line)":R===aK.KP.IMAGE_EDITS?"Describe how you want to edit the image...":"Describe the image you want to generate...",disabled:V,className:"flex-1",autoSize:{minRows:1,maxRows:6},style:{resize:"none",paddingRight:"10px",paddingLeft:"10px"}}),V?(0,c.jsx)(_.Z,{onClick:()=>{B.current&&(B.current.abort(),B.current=null,K(!1),P.ZP.info("Request cancelled"))},className:"ml-2 bg-red-50 hover:bg-red-100 text-red-600 border-red-200",icon:ef.Z,children:"Cancel"}):(0,c.jsx)(_.Z,{onClick:eb,className:"ml-2 text-white",icon:R===aK.KP.CHAT||R===aK.KP.RESPONSES||R===aK.KP.ANTHROPIC_MESSAGES?rl.Z:a6.Z,children:R===aK.KP.CHAT||R===aK.KP.RESPONSES||R===aK.KP.ANTHROPIC_MESSAGES?"Send":R===aK.KP.IMAGE_EDITS?"Edit":"Generate"})]})]})]})]})}),(0,c.jsxs)(A.Z,{title:"Generated Code",visible:ei,onCancel:()=>en(!1),footer:null,width:800,children:[(0,c.jsxs)("div",{className:"flex justify-between items-end my-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium block mb-1 text-gray-700",children:"SDK Type"}),(0,c.jsx)(C.default,{value:ed,onChange:e=>eu(e),style:{width:150},options:[{value:"openai",label:"OpenAI SDK"},{value:"azure",label:"Azure SDK"}]})]}),(0,c.jsx)(T.ZP,{onClick:()=>{navigator.clipboard.writeText(eo),P.ZP.success("Copied to clipboard!")},children:"Copy to Clipboard"})]}),(0,c.jsx)(l4.Z,{language:"python",style:aB.Z,wrapLines:!0,wrapLongLines:!0,className:"rounded-md",customStyle:{maxHeight:"60vh",overflowY:"auto"},children:eo})]}),"custom"===g&&(0,c.jsx)(A.Z,{title:"Select MCP Tool",visible:i,onCancel:()=>n(!1),onOk:()=>{n(!1),P.ZP.success("MCP tool selection updated")},width:800,children:h?(0,c.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,c.jsx)(lm.Z,{indicator:(0,c.jsx)(a5.Z,{style:{fontSize:24},spin:!0})})}):(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsx)(w.Z,{className:"text-gray-600 block mb-4",children:"Select the MCP tool you want to use in your conversation."}),(0,c.jsx)(C.default,{style:{width:"100%"},placeholder:"Select MCP tool",value:u,onChange:e=>x(e),optionLabelProp:"label",allowClear:!0,children:o.map(e=>(0,c.jsx)(C.default.Option,{value:e.name,label:(0,c.jsx)("div",{className:"font-medium",children:e.name}),children:(0,c.jsxs)("div",{className:"flex flex-col py-1",children:[(0,c.jsx)("span",{className:"font-medium",children:e.name}),(0,c.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:e.description})]})},e.name))})]})})]})},rn=t(19226),ro=t(45937),rc=t(28595),rd=t(68208),rm=t(9775),ru=t(41361),rx=t(37527),rh=t(88009),rp=t(48231),rg=t(41169),rj=t(55322),rf=t(76865),rv=t(70525),r_=t(95805),ry=t(51817),rb=t(21047);t(22135),t(40875);var rN=t(49663);let rZ=function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")};function rw(e){let{accessToken:s,width:t=220}=e,[l,a]=(0,d.useState)(!1),[r,i]=(0,d.useState)(!1),[n,o]=(0,d.useState)(null),[m,u]=(0,d.useState)(!1),[x,h]=(0,d.useState)(null);(0,d.useEffect)(()=>{(async()=>{if(s){u(!0),h(null);try{let e=await (0,g.getRemainingUsers)(s);o(e)}catch(e){console.error("Failed to fetch usage data:",e),h("Failed to load usage data")}finally{u(!1)}}})()},[s]);let{isOverLimit:p,isNearLimit:j,usagePercentage:f,userMetrics:v,teamMetrics:_}=(e=>{if(!e)return{isOverLimit:!1,isNearLimit:!1,usagePercentage:0,userMetrics:{isOverLimit:!1,isNearLimit:!1,usagePercentage:0},teamMetrics:{isOverLimit:!1,isNearLimit:!1,usagePercentage:0}};let s=!!e.total_users_remaining&&e.total_users_remaining<=0,t=!!e.total_users_remaining&&e.total_users_remaining<=5&&e.total_users_remaining>0,l=e.total_users?e.total_users_used/e.total_users*100:0,a=!!e.total_teams_remaining&&e.total_teams_remaining<=0,r=!!e.total_teams_remaining&&e.total_teams_remaining<=5&&e.total_teams_remaining>0,i=e.total_teams?e.total_teams_used/e.total_teams*100:0,n=s||a;return{isOverLimit:n,isNearLimit:(t||r)&&!n,usagePercentage:Math.max(l,i),userMetrics:{isOverLimit:s,isNearLimit:t,usagePercentage:l},teamMetrics:{isOverLimit:a,isNearLimit:r,usagePercentage:i}}})(n),y=()=>p?"red":j?"yellow":"green",b=()=>p?"Over Limit":j?"Near Limit":"Active",N=()=>p?(0,c.jsx)(rf.Z,{className:"h-3 w-3"}):j?(0,c.jsx)(rv.Z,{className:"h-3 w-3"}):null;return s&&((null==n?void 0:n.total_users)!==null||(null==n?void 0:n.total_teams)!==null)?(0,c.jsx)("div",{className:"fixed bottom-4 left-4 z-50",style:{width:"".concat(Math.min(t,220),"px")},children:(0,c.jsx)(()=>{if(r){let e=p||j;return(0,c.jsx)("button",{onClick:()=>i(!1),className:rZ("bg-white border border-gray-200 rounded-lg shadow-sm p-3 hover:shadow-md transition-all w-full",e&&p&&"border-red-200 bg-red-50",e&&j&&"border-yellow-200 bg-yellow-50"),title:"Show usage details",children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(r_.Z,{className:"h-4 w-4 flex-shrink-0"}),e&&(0,c.jsx)("span",{className:"flex-shrink-0",children:N()}),(0,c.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium truncate",children:[n&&null!==n.total_users&&(0,c.jsxs)("span",{className:"flex-shrink-0",children:["U: ",n.total_users_used,"/",n.total_users]}),n&&null!==n.total_teams&&(0,c.jsxs)("span",{className:"flex-shrink-0",children:["T: ",n.total_teams_used,"/",n.total_teams]}),!n||null===n.total_users&&null===n.total_teams&&(0,c.jsx)("span",{className:"truncate",children:"Usage"})]})]})})}return m?(0,c.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 w-full",children:(0,c.jsxs)("div",{className:"flex items-center justify-center gap-2 py-2",children:[(0,c.jsx)(ry.Z,{className:"h-4 w-4 animate-spin"}),(0,c.jsx)("span",{className:"text-sm text-gray-500 truncate",children:"Loading..."})]})}):x||!n?(0,c.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 group w-full",children:(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,c.jsx)("div",{className:"flex-1 min-w-0",children:(0,c.jsx)("span",{className:"text-sm text-gray-500 truncate block",children:x||"No data"})}),(0,c.jsx)("button",{onClick:()=>i(!0),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-100 rounded transition-all flex-shrink-0",title:"Minimize",children:(0,c.jsx)(rb.Z,{className:"h-3 w-3 text-gray-400"})})]})}):(0,c.jsxs)("div",{className:rZ("bg-white border rounded-lg shadow-sm p-3 transition-all duration-200 group w-full",p&&"border-red-200 bg-red-50",j&&"border-yellow-200 bg-yellow-50"),children:[(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-3",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[(0,c.jsx)(r_.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,c.jsx)("span",{className:"font-medium text-sm truncate",children:"Usage"}),(p||j)&&(0,c.jsx)(eJ.Z,{color:y(),className:"text-xs px-1.5 py-0.5 flex-shrink-0",children:b()})]}),(0,c.jsx)("button",{onClick:()=>i(!0),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-100 rounded transition-all flex-shrink-0",title:"Minimize",children:(0,c.jsx)(rb.Z,{className:"h-3 w-3 text-gray-400"})})]}),(0,c.jsxs)("div",{className:"space-y-3 text-sm",children:[null!==n.total_users&&(0,c.jsxs)("div",{className:"space-y-1",children:[(0,c.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-600 mb-1",children:[(0,c.jsx)(r_.Z,{className:"h-3 w-3"}),(0,c.jsx)("span",{className:"font-medium",children:"Users"})]}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("span",{className:"text-gray-600 text-xs",children:"Used:"}),(0,c.jsxs)("span",{className:"font-medium text-right",children:[n.total_users_used,"/",n.total_users]})]}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("span",{className:"text-gray-600 text-xs",children:"Remaining:"}),(0,c.jsx)("span",{className:rZ("font-medium text-right",v.isOverLimit&&"text-red-600",v.isNearLimit&&"text-yellow-600"),children:n.total_users_remaining})]}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("span",{className:"text-gray-600 text-xs",children:"Usage:"}),(0,c.jsxs)("span",{className:"font-medium text-right",children:[Math.round(v.usagePercentage),"%"]})]}),(0,c.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,c.jsx)("div",{className:rZ("h-2 rounded-full transition-all duration-300",v.isOverLimit&&"bg-red-500",v.isNearLimit&&"bg-yellow-500",!v.isOverLimit&&!v.isNearLimit&&"bg-green-500"),style:{width:"".concat(Math.min(v.usagePercentage,100),"%")}})})]}),null!==n.total_teams&&(0,c.jsxs)("div",{className:"space-y-1",children:[(0,c.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-600 mb-1",children:[(0,c.jsx)(rN.Z,{className:"h-3 w-3"}),(0,c.jsx)("span",{className:"font-medium",children:"Teams"})]}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("span",{className:"text-gray-600 text-xs",children:"Used:"}),(0,c.jsxs)("span",{className:"font-medium text-right",children:[n.total_teams_used,"/",n.total_teams]})]}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("span",{className:"text-gray-600 text-xs",children:"Remaining:"}),(0,c.jsx)("span",{className:rZ("font-medium text-right",_.isOverLimit&&"text-red-600",_.isNearLimit&&"text-yellow-600"),children:n.total_teams_remaining})]}),(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("span",{className:"text-gray-600 text-xs",children:"Usage:"}),(0,c.jsxs)("span",{className:"font-medium text-right",children:[Math.round(_.usagePercentage),"%"]})]}),(0,c.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,c.jsx)("div",{className:rZ("h-2 rounded-full transition-all duration-300",_.isOverLimit&&"bg-red-500",_.isNearLimit&&"bg-yellow-500",!_.isOverLimit&&!_.isNearLimit&&"bg-green-500"),style:{width:"".concat(Math.min(_.usagePercentage,100),"%")}})})]})]})]})},{})}):null}let{Sider:rk}=rn.default;var rS=e=>{let{accessToken:s,setPage:t,userRole:l,defaultSelectedKey:a}=e,r=[{key:"1",page:"api-keys",label:"Virtual Keys",icon:(0,c.jsx)(lC.Z,{})},{key:"3",page:"llm-playground",label:"Test Key",icon:(0,c.jsx)(rc.Z,{}),roles:eE.LQ},{key:"2",page:"models",label:"Models + Endpoints",icon:(0,c.jsx)(rd.Z,{}),roles:eE.LQ},{key:"12",page:"new_usage",label:"Usage",icon:(0,c.jsx)(rm.Z,{}),roles:[...eE.ZL,...eE.lo]},{key:"6",page:"teams",label:"Teams",icon:(0,c.jsx)(ru.Z,{})},{key:"17",page:"organizations",label:"Organizations",icon:(0,c.jsx)(rx.Z,{}),roles:eE.ZL},{key:"5",page:"users",label:"Internal Users",icon:(0,c.jsx)(rs.Z,{}),roles:eE.ZL},{key:"14",page:"api_ref",label:"API Reference",icon:(0,c.jsx)(tJ.Z,{})},{key:"16",page:"model-hub-table",label:"Model Hub",icon:(0,c.jsx)(rh.Z,{})},{key:"15",page:"logs",label:"Logs",icon:(0,c.jsx)(rp.Z,{})},{key:"11",page:"guardrails",label:"Guardrails",icon:(0,c.jsx)(a7.Z,{}),roles:eE.ZL},{key:"26",page:"tools",label:"Tools",icon:(0,c.jsx)(a2.Z,{}),children:[{key:"18",page:"mcp-servers",label:"MCP Servers",icon:(0,c.jsx)(a2.Z,{})},{key:"21",page:"vector-stores",label:"Vector Stores",icon:(0,c.jsx)(a8.Z,{}),roles:eE.ZL}]},{key:"experimental",page:"experimental",label:"Experimental",icon:(0,c.jsx)(rg.Z,{}),children:[{key:"9",page:"caching",label:"Caching",icon:(0,c.jsx)(a8.Z,{}),roles:eE.ZL},{key:"10",page:"budgets",label:"Budgets",icon:(0,c.jsx)(rx.Z,{}),roles:eE.ZL},{key:"20",page:"transform-request",label:"API Playground",icon:(0,c.jsx)(tJ.Z,{}),roles:[...eE.ZL,...eE.lo]},{key:"19",page:"tag-management",label:"Tag Management",icon:(0,c.jsx)(a3.Z,{}),roles:eE.ZL},{key:"4",page:"usage",label:"Old Usage",icon:(0,c.jsx)(rm.Z,{})}]},{key:"settings",page:"settings",label:"Settings",icon:(0,c.jsx)(rj.Z,{}),roles:eE.ZL,children:[{key:"11",page:"general-settings",label:"Router Settings",icon:(0,c.jsx)(rj.Z,{}),roles:eE.ZL},{key:"8",page:"settings",label:"Logging & Alerts",icon:(0,c.jsx)(rj.Z,{}),roles:eE.ZL},{key:"13",page:"admin-panel",label:"Admin Settings",icon:(0,c.jsx)(rj.Z,{}),roles:eE.ZL}]}],i=(e=>{let s=r.find(s=>s.page===e);if(s)return s.key;for(let s of r)if(s.children){let t=s.children.find(s=>s.page===e);if(t)return t.key}return"1"})(a),n=r.filter(e=>{let s=!e.roles||e.roles.includes(l);return console.log("Menu item ".concat(e.label,": roles=").concat(e.roles,", userRole=").concat(l,", hasAccess=").concat(s)),!!s&&(e.children&&(e.children=e.children.filter(e=>!e.roles||e.roles.includes(l))),!0)});return(0,c.jsx)(rn.default,{style:{minHeight:"100vh"},children:(0,c.jsxs)(rk,{theme:"light",width:220,children:[(0,c.jsx)(ro.Z,{mode:"inline",selectedKeys:[i],defaultOpenKeys:["llm-tools"],style:{borderRight:0,backgroundColor:"transparent",fontSize:"14px"},items:n.map(e=>{var s;return{key:e.key,icon:e.icon,label:e.label,children:null===(s=e.children)||void 0===s?void 0:s.map(e=>({key:e.key,icon:e.icon,label:e.label,onClick:()=>{let s=new URLSearchParams(window.location.search);s.set("page",e.page),window.history.pushState(null,"","?".concat(s.toString())),t(e.page)}})),onClick:e.children?void 0:()=>{let s=new URLSearchParams(window.location.search);s.set("page",e.page),window.history.pushState(null,"","?".concat(s.toString())),t(e.page)}}})}),(0,eE.tY)(l)&&(0,c.jsx)(rw,{accessToken:s,width:220})]})})},rC=t(96889);console.log("process.env.NODE_ENV","production");let rI=e=>null!==e&&("Admin"===e||"Admin Viewer"===e);var rP=e=>{let{accessToken:s,token:t,userRole:l,userID:a,keys:r,premiumUser:i}=e,n=new Date,[o,m]=(0,d.useState)([]),[u,x]=(0,d.useState)([]),[h,p]=(0,d.useState)([]),[j,y]=(0,d.useState)([]),[b,N]=(0,d.useState)([]),[Z,S]=(0,d.useState)([]),[C,I]=(0,d.useState)([]),[P,A]=(0,d.useState)([]),[E,T]=(0,d.useState)([]),[L,O]=(0,d.useState)([]),[M,D]=(0,d.useState)({}),[F,R]=(0,d.useState)([]),[q,U]=(0,d.useState)(""),[z,V]=(0,d.useState)(["all-tags"]),[K,B]=(0,d.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[G,H]=(0,d.useState)(null),[J,Y]=(0,d.useState)(0),$=new Date(n.getFullYear(),n.getMonth(),1),Q=new Date(n.getFullYear(),n.getMonth()+1,0),X=er($),ee=er(Q);function es(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0,notation:"compact",compactDisplay:"short"}).format(e)}console.log("keys in usage",r),console.log("premium user in usage",i);let et=async()=>{if(s)try{let e=await (0,g.getProxyUISettings)(s);return console.log("usage tab: proxy_settings",e),e}catch(e){console.error("Error fetching proxy settings:",e)}};(0,d.useEffect)(()=>{ea(K.from,K.to)},[K,z]);let el=async(e,t,l)=>{if(!e||!t||!s)return;console.log("uiSelectedKey",l);let a=await (0,g.adminTopEndUsersCall)(s,l,e.toISOString(),t.toISOString());console.log("End user data updated successfully",a),y(a)},ea=async(e,t)=>{if(!e||!t||!s)return;let l=await et();null!=l&&l.DISABLE_EXPENSIVE_DB_QUERIES||(S((await (0,g.tagsSpendLogsCall)(s,e.toISOString(),t.toISOString(),0===z.length?void 0:z)).spend_per_tag),console.log("Tag spend data updated successfully"))};function er(e){let s=e.getFullYear(),t=e.getMonth()+1,l=e.getDate();return"".concat(s,"-").concat(t<10?"0"+t:t,"-").concat(l<10?"0"+l:l)}console.log("Start date is ".concat(X)),console.log("End date is ".concat(ee));let ei=async(e,s,t)=>{try{let t=await e();s(t)}catch(e){console.error(t,e)}},en=(e,s,t,l)=>{let a=[],r=new Date(s),i=e=>{if(e.includes("-"))return e;{let[s,t]=e.split(" ");return new Date(new Date().getFullYear(),new Date("".concat(s," 01 2024")).getMonth(),parseInt(t)).toISOString().split("T")[0]}},n=new Map(e.map(e=>{let s=i(e.date);return[s,{...e,date:s}]}));for(;r<=t;){let e=r.toISOString().split("T")[0];if(n.has(e))a.push(n.get(e));else{let s={date:e,api_requests:0,total_tokens:0};l.forEach(e=>{s[e]||(s[e]=0)}),a.push(s)}r.setDate(r.getDate()+1)}return a},eo=async()=>{if(s)try{let e=await (0,g.adminSpendLogsCall)(s),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0),r=en(e,l,a,[]),i=Number(r.reduce((e,s)=>e+(s.spend||0),0).toFixed(2));Y(i),m(r)}catch(e){console.error("Error fetching overall spend:",e)}},ec=()=>ei(()=>s&&t?(0,g.adminspendByProvider)(s,t,X,ee):Promise.reject("No access token or token"),O,"Error fetching provider spend"),em=async()=>{s&&await ei(async()=>(await (0,g.adminTopKeysCall)(s)).map(e=>({key:e.api_key.substring(0,10),api_key:e.api_key,key_alias:e.key_alias,spend:Number(e.total_spend.toFixed(2))})),x,"Error fetching top keys")},eu=async()=>{s&&await ei(async()=>(await (0,g.adminTopModelsCall)(s)).map(e=>({key:e.model,spend:eD(e.total_spend,2)})),p,"Error fetching top models")},ex=async()=>{s&&await ei(async()=>{let e=await (0,g.teamSpendLogsCall)(s),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);return N(en(e.daily_spend,l,a,e.teams)),A(e.teams),e.total_spend_per_team.map(e=>({name:e.team_id||"",value:eD(e.total_spend||0,2)}))},T,"Error fetching team spend")},eh=()=>{s&&ei(async()=>(await (0,g.allTagNamesCall)(s)).tag_names,I,"Error fetching tag names")},ep=()=>{s&&ei(()=>{var e,t;return(0,g.tagsSpendLogsCall)(s,null===(e=K.from)||void 0===e?void 0:e.toISOString(),null===(t=K.to)||void 0===t?void 0:t.toISOString(),void 0)},e=>S(e.spend_per_tag),"Error fetching top tags")},eg=()=>{s&&ei(()=>(0,g.adminTopEndUsersCall)(s,null,void 0,void 0),y,"Error fetching top end users")},ej=async()=>{if(s)try{let e=await (0,g.adminGlobalActivity)(s,X,ee),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0),r=en(e.daily_data||[],l,a,["api_requests","total_tokens"]);D({...e,daily_data:r})}catch(e){console.error("Error fetching global activity:",e)}},ef=async()=>{if(s)try{let e=await (0,g.adminGlobalActivityPerModel)(s,X,ee),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0),r=e.map(e=>({...e,daily_data:en(e.daily_data||[],l,a,["api_requests","total_tokens"])}));R(r)}catch(e){console.error("Error fetching global activity per model:",e)}};return((0,d.useEffect)(()=>{(async()=>{if(s&&t&&l&&a){let e=await et();e&&(H(e),null!=e&&e.DISABLE_EXPENSIVE_DB_QUERIES)||(console.log("fetching data - valiue of proxySettings",G),eo(),ec(),em(),eu(),ej(),ef(),rI(l)&&(ex(),eh(),ep(),eg()))}})()},[s,t,l,a,X,ee]),null==G?void 0:G.DISABLE_EXPENSIVE_DB_QUERIES)?(0,c.jsx)("div",{style:{width:"100%"},className:"p-8",children:(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Database Query Limit Reached"}),(0,c.jsxs)(w.Z,{className:"mt-4",children:["SpendLogs in DB has ",G.NUM_SPEND_LOGS_ROWS," rows.",(0,c.jsx)("br",{}),"Please follow our guide to view usage when SpendLogs has more than 1M rows."]}),(0,c.jsx)(_.Z,{className:"mt-4",children:(0,c.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/spending_monitoring",target:"_blank",children:"View Usage Guide"})})]})}):(0,c.jsx)("div",{style:{width:"100%"},className:"p-8",children:(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{className:"mt-2",children:[(0,c.jsx)(eY.Z,{children:"All Up"}),rI(l)?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(eY.Z,{children:"Team Based Usage"}),(0,c.jsx)(eY.Z,{children:"Customer Usage"}),(0,c.jsx)(eY.Z,{children:"Tag Based Usage"})]}):(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{})})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{variant:"solid",className:"mt-1",children:[(0,c.jsx)(eY.Z,{children:"Cost"}),(0,c.jsx)(eY.Z,{children:"Activity"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(v.Z,{numItems:2,className:"gap-2 h-[100vh] w-full",children:[(0,c.jsxs)(f.Z,{numColSpan:2,children:[(0,c.jsxs)(w.Z,{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content mb-2 mt-2 text-lg",children:["Project Spend ",new Date().toLocaleString("default",{month:"long"})," 1 - ",new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate()]}),(0,c.jsx)(av,{userID:a,userRole:l,accessToken:s,userSpend:J,selectedTeam:null,userMaxBudget:null})]}),(0,c.jsx)(f.Z,{numColSpan:2,children:(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Monthly Spend"}),(0,c.jsx)(s$.Z,{data:o,index:"date",categories:["spend"],colors:["cyan"],valueFormatter:e=>"$ ".concat(eD(e,2)),yAxisWidth:100,tickGap:5})]})}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)(W.Z,{className:"h-full",children:[(0,c.jsx)(k.Z,{children:"Top API Keys"}),(0,c.jsx)(ay,{topKeys:u,accessToken:s,userID:a,userRole:l,teams:null,premiumUser:i})]})}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)(W.Z,{className:"h-full",children:[(0,c.jsx)(k.Z,{children:"Top Models"}),(0,c.jsx)(s$.Z,{className:"mt-4 h-40",data:h,index:"key",categories:["spend"],colors:["cyan"],yAxisWidth:200,layout:"vertical",showXAxis:!1,showLegend:!1,valueFormatter:e=>"$".concat(eD(e,2))})]})}),(0,c.jsx)(f.Z,{numColSpan:1}),(0,c.jsx)(f.Z,{numColSpan:2,children:(0,c.jsxs)(W.Z,{className:"mb-2",children:[(0,c.jsx)(k.Z,{children:"Spend by Provider"}),(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(v.Z,{numItems:2,children:[(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsx)(af.Z,{className:"mt-4 h-40",variant:"pie",data:L,index:"provider",category:"spend",colors:["cyan"],valueFormatter:e=>"$".concat(eD(e,2))})}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsxs)(sf.Z,{children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Provider"}),(0,c.jsx)(sb.Z,{children:"Spend"})]})}),(0,c.jsx)(sv.Z,{children:L.map(e=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:e.provider}),(0,c.jsx)(s_.Z,{children:1e-5>parseFloat(e.spend.toFixed(2))?"less than 0.00":eD(e.spend,2)})]},e.provider))})]})})]})})]})})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(v.Z,{numItems:1,className:"gap-2 h-[75vh] w-full",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"All Up"}),(0,c.jsxs)(v.Z,{numItems:2,children:[(0,c.jsxs)(f.Z,{children:[(0,c.jsxs)(sT.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["API Requests ",es(M.sum_api_requests)]}),(0,c.jsx)(sW.Z,{className:"h-40",data:M.daily_data,valueFormatter:es,index:"date",colors:["cyan"],categories:["api_requests"],onValueChange:e=>console.log(e)})]}),(0,c.jsxs)(f.Z,{children:[(0,c.jsxs)(sT.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Tokens ",es(M.sum_total_tokens)]}),(0,c.jsx)(s$.Z,{className:"h-40",data:M.daily_data,valueFormatter:es,index:"date",colors:["cyan"],categories:["total_tokens"],onValueChange:e=>console.log(e)})]})]})]}),(0,c.jsx)(c.Fragment,{children:F.map((e,s)=>(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:e.model}),(0,c.jsxs)(v.Z,{numItems:2,children:[(0,c.jsxs)(f.Z,{children:[(0,c.jsxs)(sT.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["API Requests ",es(e.sum_api_requests)]}),(0,c.jsx)(sW.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["cyan"],categories:["api_requests"],valueFormatter:es,onValueChange:e=>console.log(e)})]}),(0,c.jsxs)(f.Z,{children:[(0,c.jsxs)(sT.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Tokens ",es(e.sum_total_tokens)]}),(0,c.jsx)(s$.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["cyan"],categories:["total_tokens"],valueFormatter:es,onValueChange:e=>console.log(e)})]})]})]},s))})]})})]})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(v.Z,{numItems:2,className:"gap-2 h-[75vh] w-full",children:[(0,c.jsxs)(f.Z,{numColSpan:2,children:[(0,c.jsxs)(W.Z,{className:"mb-2",children:[(0,c.jsx)(k.Z,{children:"Total Spend Per Team"}),(0,c.jsx)(rC.Z,{data:E})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Daily Spend Per Team"}),(0,c.jsx)(s$.Z,{className:"h-72",data:b,showLegend:!0,index:"date",categories:P,yAxisWidth:80,stack:!0})]})]}),(0,c.jsx)(f.Z,{numColSpan:2})]})}),(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)("p",{className:"mb-2 text-gray-500 italic text-[12px]",children:["Customers of your LLM API calls. Tracked when a `user` param is passed in your LLM calls ",(0,c.jsx)("a",{className:"text-blue-500",href:"https://docs.litellm.ai/docs/proxy/users",target:"_blank",children:"docs here"})]}),(0,c.jsxs)(v.Z,{numItems:2,children:[(0,c.jsx)(f.Z,{children:(0,c.jsx)(sY,{value:K,onValueChange:e=>{B(e),el(e.from,e.to,null)}})}),(0,c.jsxs)(f.Z,{children:[(0,c.jsx)(w.Z,{children:"Select Key"}),(0,c.jsxs)(eH.Z,{defaultValue:"all-keys",children:[(0,c.jsx)(ed.Z,{value:"all-keys",onClick:()=>{el(K.from,K.to,null)},children:"All Keys"},"all-keys"),null==r?void 0:r.map((e,s)=>e&&null!==e.key_alias&&e.key_alias.length>0?(0,c.jsx)(ed.Z,{value:String(s),onClick:()=>{el(K.from,K.to,e.token)},children:e.key_alias},s):null)]})]})]}),(0,c.jsx)(W.Z,{className:"mt-4",children:(0,c.jsxs)(sf.Z,{className:"max-h-[70vh] min-h-[500px]",children:[(0,c.jsx)(sy.Z,{children:(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(sb.Z,{children:"Customer"}),(0,c.jsx)(sb.Z,{children:"Spend"}),(0,c.jsx)(sb.Z,{children:"Total Events"})]})}),(0,c.jsx)(sv.Z,{children:null==j?void 0:j.map((e,s)=>(0,c.jsxs)(sN.Z,{children:[(0,c.jsx)(s_.Z,{children:e.end_user}),(0,c.jsx)(s_.Z,{children:eD(e.total_spend,2)}),(0,c.jsx)(s_.Z,{children:e.total_count})]},s))})]})})]}),(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)(v.Z,{numItems:2,children:[(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsx)(sY,{className:"mb-4",value:K,onValueChange:e=>{B(e),ea(e.from,e.to)}})}),(0,c.jsx)(f.Z,{children:i?(0,c.jsx)("div",{children:(0,c.jsxs)(lG.Z,{value:z,onValueChange:e=>V(e),children:[(0,c.jsx)(lH.Z,{value:"all-tags",onClick:()=>V(["all-tags"]),children:"All Tags"},"all-tags"),C&&C.filter(e=>"all-tags"!==e).map((e,s)=>(0,c.jsx)(lH.Z,{value:String(e),children:e},e))]})}):(0,c.jsx)("div",{children:(0,c.jsxs)(lG.Z,{value:z,onValueChange:e=>V(e),children:[(0,c.jsx)(lH.Z,{value:"all-tags",onClick:()=>V(["all-tags"]),children:"All Tags"},"all-tags"),C&&C.filter(e=>"all-tags"!==e).map((e,s)=>(0,c.jsxs)(ed.Z,{value:String(e),disabled:!0,children:["✨ ",e," (Enterprise only Feature)"]},e))]})})})]}),(0,c.jsxs)(v.Z,{numItems:2,className:"gap-2 h-[75vh] w-full mb-4",children:[(0,c.jsx)(f.Z,{numColSpan:2,children:(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(k.Z,{children:"Spend Per Tag"}),(0,c.jsxs)(w.Z,{children:["Get Started by Tracking cost per tag ",(0,c.jsx)("a",{className:"text-blue-500",href:"https://docs.litellm.ai/docs/proxy/cost_tracking",target:"_blank",children:"here"})]}),(0,c.jsx)(s$.Z,{className:"h-72",data:Z,index:"name",categories:["spend"],colors:["cyan"]})]})}),(0,c.jsx)(f.Z,{numColSpan:2})]})]})]})]})})},rA=t(51853);let rE=e=>{let{responseTimeMs:s}=e;return null==s?null:(0,c.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-500 font-mono",children:[(0,c.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,c.jsx)("path",{d:"M12 6V12L16 14M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,c.jsxs)("span",{children:[s.toFixed(0),"ms"]})]})},rT=e=>{let s=e;if("string"==typeof s)try{s=JSON.parse(s)}catch(e){}return s},rL=e=>{let{label:s,value:t}=e,[l,a]=d.useState(!1),[r,i]=d.useState(!1),n=(null==t?void 0:t.toString())||"N/A",o=n.length>50?n.substring(0,50)+"...":n;return(0,c.jsx)("tr",{className:"hover:bg-gray-50",children:(0,c.jsx)("td",{className:"px-4 py-2 align-top",colSpan:2,children:(0,c.jsxs)("div",{className:"flex items-center justify-between group",children:[(0,c.jsxs)("div",{className:"flex items-center flex-1",children:[(0,c.jsx)("button",{onClick:()=>a(!l),className:"text-gray-400 hover:text-gray-600 mr-2",children:l?"▼":"▶"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-sm text-gray-600",children:s}),(0,c.jsx)("pre",{className:"mt-1 text-sm font-mono text-gray-800 whitespace-pre-wrap",children:l?n:o})]})]}),(0,c.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(n),i(!0),setTimeout(()=>i(!1),2e3)},className:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600",children:(0,c.jsx)(rA.Z,{className:"h-4 w-4"})})]})})})},rO=e=>{var s,t,l,a,r,i,n,o,d,m,u,x,h,p;let{response:g}=e,j=null,f={},v={};try{if(null==g?void 0:g.error)try{let e="string"==typeof g.error.message?JSON.parse(g.error.message):g.error.message;j={message:(null==e?void 0:e.message)||"Unknown error",traceback:(null==e?void 0:e.traceback)||"No traceback available",litellm_params:(null==e?void 0:e.litellm_cache_params)||{},health_check_cache_params:(null==e?void 0:e.health_check_cache_params)||{}},f=rT(j.litellm_params)||{},v=rT(j.health_check_cache_params)||{}}catch(e){console.warn("Error parsing error details:",e),j={message:String(g.error.message||"Unknown error"),traceback:"Error parsing details",litellm_params:{},health_check_cache_params:{}}}else f=rT(null==g?void 0:g.litellm_cache_params)||{},v=rT(null==g?void 0:g.health_check_cache_params)||{}}catch(e){console.warn("Error in response parsing:",e),f={},v={}}let _={redis_host:(null==v?void 0:null===(l=v.redis_client)||void 0===l?void 0:null===(t=l.connection_pool)||void 0===t?void 0:null===(s=t.connection_kwargs)||void 0===s?void 0:s.host)||(null==v?void 0:null===(i=v.redis_async_client)||void 0===i?void 0:null===(r=i.connection_pool)||void 0===r?void 0:null===(a=r.connection_kwargs)||void 0===a?void 0:a.host)||(null==v?void 0:null===(n=v.connection_kwargs)||void 0===n?void 0:n.host)||(null==v?void 0:v.host)||"N/A",redis_port:(null==v?void 0:null===(m=v.redis_client)||void 0===m?void 0:null===(d=m.connection_pool)||void 0===d?void 0:null===(o=d.connection_kwargs)||void 0===o?void 0:o.port)||(null==v?void 0:null===(h=v.redis_async_client)||void 0===h?void 0:null===(x=h.connection_pool)||void 0===x?void 0:null===(u=x.connection_kwargs)||void 0===u?void 0:u.port)||(null==v?void 0:null===(p=v.connection_kwargs)||void 0===p?void 0:p.port)||(null==v?void 0:v.port)||"N/A",redis_version:(null==v?void 0:v.redis_version)||"N/A",startup_nodes:(()=>{try{var e,s,t,l,a,r,i,n,o,c,d,m,u;if(null==v?void 0:null===(e=v.redis_kwargs)||void 0===e?void 0:e.startup_nodes)return JSON.stringify(v.redis_kwargs.startup_nodes);let x=(null==v?void 0:null===(l=v.redis_client)||void 0===l?void 0:null===(t=l.connection_pool)||void 0===t?void 0:null===(s=t.connection_kwargs)||void 0===s?void 0:s.host)||(null==v?void 0:null===(i=v.redis_async_client)||void 0===i?void 0:null===(r=i.connection_pool)||void 0===r?void 0:null===(a=r.connection_kwargs)||void 0===a?void 0:a.host),h=(null==v?void 0:null===(c=v.redis_client)||void 0===c?void 0:null===(o=c.connection_pool)||void 0===o?void 0:null===(n=o.connection_kwargs)||void 0===n?void 0:n.port)||(null==v?void 0:null===(u=v.redis_async_client)||void 0===u?void 0:null===(m=u.connection_pool)||void 0===m?void 0:null===(d=m.connection_kwargs)||void 0===d?void 0:d.port);return x&&h?JSON.stringify([{host:x,port:h}]):"N/A"}catch(e){return"N/A"}})(),namespace:(null==v?void 0:v.namespace)||"N/A"};return(0,c.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{className:"border-b border-gray-200 px-4",children:[(0,c.jsx)(eY.Z,{className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800",children:"Summary"}),(0,c.jsx)(eY.Z,{className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800",children:"Raw Response"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{className:"p-4",children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center mb-6",children:[(null==g?void 0:g.status)==="healthy"?(0,c.jsx)(eZ.Z,{className:"h-5 w-5 text-green-500 mr-2"}):(0,c.jsx)(eN.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,c.jsxs)(w.Z,{className:"text-sm font-medium ".concat((null==g?void 0:g.status)==="healthy"?"text-green-500":"text-red-500"),children:["Cache Status: ",(null==g?void 0:g.status)||"unhealthy"]})]}),(0,c.jsx)("table",{className:"w-full border-collapse",children:(0,c.jsxs)("tbody",{children:[j&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold text-red-600",children:"Error Details"})}),(0,c.jsx)(rL,{label:"Error Message",value:j.message}),(0,c.jsx)(rL,{label:"Traceback",value:j.traceback})]}),(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold",children:"Cache Details"})}),(0,c.jsx)(rL,{label:"Cache Configuration",value:String(null==f?void 0:f.type)}),(0,c.jsx)(rL,{label:"Ping Response",value:String(g.ping_response)}),(0,c.jsx)(rL,{label:"Set Cache Response",value:g.set_cache_response||"N/A"}),(0,c.jsx)(rL,{label:"litellm_settings.cache_params",value:JSON.stringify(f,null,2)}),(null==f?void 0:f.type)==="redis"&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold",children:"Redis Details"})}),(0,c.jsx)(rL,{label:"Redis Host",value:_.redis_host||"N/A"}),(0,c.jsx)(rL,{label:"Redis Port",value:_.redis_port||"N/A"}),(0,c.jsx)(rL,{label:"Redis Version",value:_.redis_version||"N/A"}),(0,c.jsx)(rL,{label:"Startup Nodes",value:_.startup_nodes||"N/A"}),(0,c.jsx)(rL,{label:"Namespace",value:_.namespace||"N/A"})]})]})})]})}),(0,c.jsx)(eQ.Z,{className:"p-4",children:(0,c.jsx)("div",{className:"bg-gray-50 rounded-md p-4 font-mono text-sm",children:(0,c.jsx)("pre",{className:"whitespace-pre-wrap break-words overflow-auto max-h-[500px]",children:(()=>{try{let e={...g,litellm_cache_params:f,health_check_cache_params:v},s=JSON.parse(JSON.stringify(e,(e,s)=>{if("string"==typeof s)try{return JSON.parse(s)}catch(e){}return s}));return JSON.stringify(s,null,2)}catch(e){return"Error formatting JSON: "+e.message}})()})})})]})]})})},rM=e=>{let{accessToken:s,healthCheckResponse:t,runCachingHealthCheck:l,responseTimeMs:a}=e,[r,i]=d.useState(null),[n,o]=d.useState(!1),m=async()=>{o(!0);let e=performance.now();await l(),i(performance.now()-e),o(!1)};return(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)(_.Z,{onClick:m,disabled:n,className:"bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white text-sm px-4 py-2 rounded-md",children:n?"Running Health Check...":"Run Health Check"}),(0,c.jsx)(rE,{responseTimeMs:r})]}),t&&(0,c.jsx)(rO,{response:t})]})},rD=e=>{if(e)return e.toISOString().split("T")[0]};function rF(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0,notation:"compact",compactDisplay:"short"}).format(e)}var rR=e=>{let{accessToken:s,token:t,userRole:l,userID:a,premiumUser:r}=e,[i,n]=(0,d.useState)([]),[o,m]=(0,d.useState)([]),[u,x]=(0,d.useState)([]),[h,p]=(0,d.useState)([]),[j,_]=(0,d.useState)("0"),[y,b]=(0,d.useState)("0"),[N,Z]=(0,d.useState)("0"),[k,S]=(0,d.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[C,I]=(0,d.useState)(""),[A,E]=(0,d.useState)("");(0,d.useEffect)(()=>{s&&k&&((async()=>{p(await (0,g.adminGlobalCacheActivity)(s,rD(k.from),rD(k.to)))})(),I(new Date().toLocaleString()))},[s]);let T=Array.from(new Set(h.map(e=>{var s;return null!==(s=null==e?void 0:e.api_key)&&void 0!==s?s:""}))),L=Array.from(new Set(h.map(e=>{var s;return null!==(s=null==e?void 0:e.model)&&void 0!==s?s:""})));Array.from(new Set(h.map(e=>{var s;return null!==(s=null==e?void 0:e.call_type)&&void 0!==s?s:""})));let O=async(e,t)=>{e&&t&&s&&p(await (0,g.adminGlobalCacheActivity)(s,rD(e),rD(t)))};(0,d.useEffect)(()=>{console.log("DATA IN CACHE DASHBOARD",h);let e=h;o.length>0&&(e=e.filter(e=>o.includes(e.api_key))),u.length>0&&(e=e.filter(e=>u.includes(e.model))),console.log("before processed data in cache dashboard",e);let s=0,t=0,l=0,a=e.reduce((e,a)=>{console.log("Processing item:",a),a.call_type||(console.log("Item has no call_type:",a),a.call_type="Unknown"),s+=(a.total_rows||0)-(a.cache_hit_true_rows||0),t+=a.cache_hit_true_rows||0,l+=a.cached_completion_tokens||0;let r=e.find(e=>e.name===a.call_type);return r?(r["LLM API requests"]+=(a.total_rows||0)-(a.cache_hit_true_rows||0),r["Cache hit"]+=a.cache_hit_true_rows||0,r["Cached Completion Tokens"]+=a.cached_completion_tokens||0,r["Generated Completion Tokens"]+=a.generated_completion_tokens||0):e.push({name:a.call_type,"LLM API requests":(a.total_rows||0)-(a.cache_hit_true_rows||0),"Cache hit":a.cache_hit_true_rows||0,"Cached Completion Tokens":a.cached_completion_tokens||0,"Generated Completion Tokens":a.generated_completion_tokens||0}),e},[]);_(rF(t)),b(rF(l));let r=t+s;r>0?Z((t/r*100).toFixed(2)):Z("0"),n(a),console.log("PROCESSED DATA IN CACHE DASHBOARD",a)},[o,u,k,h]);let M=async()=>{try{P.ZP.info("Running cache health check..."),E("");let e=await (0,g.cachingHealthCheckCall)(null!==s?s:"");console.log("CACHING HEALTH CHECK RESPONSE",e),E(e)}catch(s){let e;if(console.error("Error running health check:",s),s&&s.message)try{let t=JSON.parse(s.message);t.error&&(t=t.error),e=t}catch(t){e={message:s.message}}else e={message:"Unknown error occurred"};E({error:e})}};return(0,c.jsxs)(eW.Z,{className:"gap-2 p-8 h-full w-full mt-2 mb-8",children:[(0,c.jsxs)(e$.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)(eY.Z,{children:"Cache Analytics"}),(0,c.jsx)(eY.Z,{children:(0,c.jsx)("pre",{children:"Cache Health"})})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[C&&(0,c.jsxs)(w.Z,{children:["Last Refreshed: ",C]}),(0,c.jsx)(sj.Z,{icon:e1.Z,variant:"shadow",size:"xs",className:"self-center",onClick:()=>{I(new Date().toLocaleString())}})]})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)(v.Z,{numItems:3,className:"gap-4 mt-4",children:[(0,c.jsx)(f.Z,{children:(0,c.jsx)(lG.Z,{placeholder:"Select API Keys",value:o,onValueChange:m,children:T.map(e=>(0,c.jsx)(lH.Z,{value:e,children:e},e))})}),(0,c.jsx)(f.Z,{children:(0,c.jsx)(lG.Z,{placeholder:"Select Models",value:u,onValueChange:x,children:L.map(e=>(0,c.jsx)(lH.Z,{value:e,children:e},e))})}),(0,c.jsx)(f.Z,{children:(0,c.jsx)(sY,{value:k,onValueChange:e=>{S(e),O(e.from,e.to)}})})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 mt-4",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cache Hit Ratio"}),(0,c.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,c.jsxs)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:[N,"%"]})})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cache Hits"}),(0,c.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,c.jsx)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:j})})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cached Tokens"}),(0,c.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,c.jsx)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:y})})]})]}),(0,c.jsx)(sT.Z,{className:"mt-4",children:"Cache Hits vs API Requests"}),(0,c.jsx)(s$.Z,{title:"Cache Hits vs API Requests",data:i,stack:!0,index:"name",valueFormatter:rF,categories:["LLM API requests","Cache hit"],colors:["sky","teal"],yAxisWidth:48}),(0,c.jsx)(sT.Z,{className:"mt-4",children:"Cached Completion Tokens vs Generated Completion Tokens"}),(0,c.jsx)(s$.Z,{className:"mt-6",data:i,stack:!0,index:"name",valueFormatter:rF,categories:["Generated Completion Tokens","Cached Completion Tokens"],colors:["sky","teal"],yAxisWidth:48})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(rM,{accessToken:s,healthCheckResponse:A,runCachingHealthCheck:M})})]})]})},rq=t(91810),rU=t(3810);(a=n||(n={})).PresidioPII="Presidio PII",a.Bedrock="Bedrock Guardrail",a.Lakera="Lakera";let rz={},rV=e=>{let s={};return s.PresidioPII="Presidio PII",s.Bedrock="Bedrock Guardrail",s.Lakera="Lakera",Object.entries(e).forEach(e=>{let[t,l]=e;l&&"object"==typeof l&&"ui_friendly_name"in l&&(s[t.split("_").map((e,s)=>e.charAt(0).toUpperCase()+e.slice(1)).join("")]=l.ui_friendly_name)}),rz=s,s},rK=()=>Object.keys(rz).length>0?rz:n,rB={PresidioPII:"presidio",Bedrock:"bedrock",Lakera:"lakera_v2"},rG=e=>{Object.entries(e).forEach(e=>{let[s,t]=e;t&&"object"==typeof t&&"ui_friendly_name"in t&&(rB[s.split("_").map((e,s)=>e.charAt(0).toUpperCase()+e.slice(1)).join("")]=s)})},rH=e=>!!e&&"Presidio PII"===rK()[e],rJ="../ui/assets/logos/",rY={"Presidio PII":"".concat(rJ,"presidio.png"),"Bedrock Guardrail":"".concat(rJ,"bedrock.svg"),Lakera:"".concat(rJ,"lakeraai.jpeg"),"Azure Content Safety Prompt Shield":"".concat(rJ,"presidio.png"),"Azure Content Safety Text Moderation":"".concat(rJ,"presidio.png")},rW=e=>{if(!e)return{logo:"",displayName:"-"};let s=Object.keys(rB).find(s=>rB[s].toLowerCase()===e.toLowerCase());if(!s)return{logo:"",displayName:e};let t=rK()[s];return{logo:rY[t]||"",displayName:t||e}};var r$=t(33866),rQ=t(97416),rX=t(8881),r0=t(10798),r1=t(49638);let{Text:r2}=em.default,{Option:r4}=C.default,r5=e=>e.replace(/_/g," "),r6=e=>{switch(e){case"MASK":return(0,c.jsx)(rQ.Z,{style:{marginRight:4}});case"BLOCK":return(0,c.jsx)(rX.Z,{style:{marginRight:4}});default:return null}},r3=e=>{let{categories:s,selectedCategories:t,onChange:l}=e;return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center mb-2",children:[(0,c.jsx)(r0.Z,{className:"text-gray-500 mr-1"}),(0,c.jsx)(r2,{className:"text-gray-500 font-medium",children:"Filter by category"})]}),(0,c.jsx)(C.default,{mode:"multiple",placeholder:"Select categories to filter by",style:{width:"100%"},onChange:l,value:t,allowClear:!0,showSearch:!0,optionFilterProp:"children",className:"mb-4",tagRender:e=>(0,c.jsx)(rU.Z,{color:"blue",closable:e.closable,onClose:e.onClose,className:"mr-2 mb-2",children:e.label}),children:s.map(e=>(0,c.jsx)(r4,{value:e.category,children:e.category},e.category))})]})},r8=e=>{let{onSelectAll:s,onUnselectAll:t,hasSelectedEntities:l}=e;return(0,c.jsxs)("div",{className:"bg-gray-50 p-5 rounded-lg mb-6 border border-gray-200 shadow-sm",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(r2,{strong:!0,className:"text-gray-700 text-base",children:"Quick Actions"}),(0,c.jsx)(z.Z,{title:"Apply action to all PII types at once",children:(0,c.jsx)("div",{className:"ml-2 text-gray-400 cursor-help text-xs",children:"ⓘ"})})]}),(0,c.jsx)(T.ZP,{type:"default",onClick:t,disabled:!l,icon:(0,c.jsx)(r1.Z,{}),className:"border-gray-300 hover:text-red-600 hover:border-red-300",children:"Unselect All"})]}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsx)(T.ZP,{type:"default",onClick:()=>s("MASK"),className:"flex items-center justify-center h-10 border-blue-200 hover:border-blue-300 hover:text-blue-700 bg-blue-50 hover:bg-blue-100 text-blue-600",block:!0,icon:(0,c.jsx)(rQ.Z,{}),children:"Select All & Mask"}),(0,c.jsx)(T.ZP,{type:"default",onClick:()=>s("BLOCK"),className:"flex items-center justify-center h-10 border-red-200 hover:border-red-300 hover:text-red-700 bg-red-50 hover:bg-red-100 text-red-600",block:!0,icon:(0,c.jsx)(rX.Z,{}),children:"Select All & Block"})]})]})},r7=e=>{let{entities:s,selectedEntities:t,selectedActions:l,actions:a,onEntitySelect:r,onActionSelect:i,entityToCategoryMap:n}=e;return(0,c.jsxs)("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[(0,c.jsxs)("div",{className:"bg-gray-50 px-5 py-3 border-b flex",children:[(0,c.jsx)(r2,{strong:!0,className:"flex-1 text-gray-700",children:"PII Type"}),(0,c.jsx)(r2,{strong:!0,className:"w-32 text-right text-gray-700",children:"Action"})]}),(0,c.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:0===s.length?(0,c.jsx)("div",{className:"py-10 text-center text-gray-500",children:"No PII types match your filter criteria"}):s.map(e=>(0,c.jsxs)("div",{className:"px-5 py-3 flex items-center justify-between hover:bg-gray-50 border-b ".concat(t.includes(e)?"bg-blue-50":""),children:[(0,c.jsxs)("div",{className:"flex items-center flex-1",children:[(0,c.jsx)(s2.Z,{checked:t.includes(e),onChange:()=>r(e),className:"mr-3"}),(0,c.jsx)(r2,{className:t.includes(e)?"font-medium text-gray-900":"text-gray-700",children:r5(e)}),n.get(e)&&(0,c.jsx)(rU.Z,{className:"ml-2 text-xs",color:"blue",children:n.get(e)})]}),(0,c.jsx)("div",{className:"w-32",children:(0,c.jsx)(C.default,{value:t.includes(e)&&l[e]||"MASK",onChange:s=>i(e,s),style:{width:120},disabled:!t.includes(e),className:"".concat(t.includes(e)?"":"opacity-50"),dropdownMatchSelectWidth:!1,children:a.map(e=>(0,c.jsx)(r4,{value:e,children:(0,c.jsxs)("div",{className:"flex items-center",children:[r6(e),e]})},e))})})]},e))})]})},{Title:r9,Text:ie}=em.default;var is=e=>{let{entities:s,actions:t,selectedEntities:l,selectedActions:a,onEntitySelect:r,onActionSelect:i,entityCategories:n=[]}=e,[o,m]=(0,d.useState)([]),u=new Map;n.forEach(e=>{e.entities.forEach(s=>{u.set(s,e.category)})});let x=s.filter(e=>0===o.length||o.includes(u.get(e)||""));return(0,c.jsxs)("div",{className:"pii-configuration",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,c.jsx)("div",{className:"flex items-center",children:(0,c.jsx)(r9,{level:4,className:"mb-0 font-semibold text-gray-800",children:"Configure PII Protection"})}),(0,c.jsx)(r$.Z,{count:l.length,showZero:!0,style:{backgroundColor:l.length>0?"#4f46e5":"#d9d9d9"},overflowCount:999,children:(0,c.jsxs)(ie,{className:"text-gray-500",children:[l.length," items selected"]})})]}),(0,c.jsxs)("div",{className:"mb-6",children:[(0,c.jsx)(r3,{categories:n,selectedCategories:o,onChange:m}),(0,c.jsx)(r8,{onSelectAll:e=>{s.forEach(s=>{l.includes(s)||r(s),i(s,e)})},onUnselectAll:()=>{l.forEach(e=>{r(e)})},hasSelectedEntities:l.length>0})]}),(0,c.jsx)(r7,{entities:x,selectedEntities:l,selectedActions:a,actions:t,onEntitySelect:r,onActionSelect:i,entityToCategoryMap:u})]})},it=e=>{var s;let{selectedProvider:t,accessToken:l,providerParams:a=null,value:r=null}=e,[i,n]=(0,d.useState)(!1),[o,m]=(0,d.useState)(a),[u,x]=(0,d.useState)(null);if((0,d.useEffect)(()=>{if(a){m(a);return}let e=async()=>{if(l){n(!0),x(null);try{let e=await (0,g.getGuardrailProviderSpecificParams)(l);console.log("Provider params API response:",e),m(e),rV(e),rG(e)}catch(e){console.error("Error fetching provider params:",e),x("Failed to load provider parameters")}finally{n(!1)}}};a||e()},[l,a]),!t)return null;if(i)return(0,c.jsx)(lm.Z,{tip:"Loading provider parameters..."});if(u)return(0,c.jsx)("div",{className:"text-red-500",children:u});let h=null===(s=rB[t])||void 0===s?void 0:s.toLowerCase(),p=o&&o[h];if(console.log("Provider key:",h),console.log("Provider fields:",p),!p||0===Object.keys(p).length)return(0,c.jsx)("div",{children:"No configuration fields available for this provider."});console.log("Value:",r);let j=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0;return Object.entries(e).map(e=>{let[l,a]=e,i=s?"".concat(s,".").concat(l):l,n=t?t[l]:null==r?void 0:r[l];return(console.log("Field value:",n),"ui_friendly_name"===l||"optional_params"===l&&"nested"===a.type&&a.fields)?null:"nested"===a.type&&a.fields?(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"mb-2 font-medium",children:l}),(0,c.jsx)("div",{className:"ml-4 border-l-2 border-gray-200 pl-4",children:j(a.fields,i,n)})]},i):(0,c.jsx)(I.Z.Item,{name:i,label:l,tooltip:a.description,rules:a.required?[{required:!0,message:"".concat(l," is required")}]:void 0,children:"select"===a.type&&a.options?(0,c.jsx)(C.default,{placeholder:a.description,defaultValue:n||a.default_value,children:a.options.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:e},e))}):"multiselect"===a.type&&a.options?(0,c.jsx)(C.default,{mode:"multiple",placeholder:a.description,defaultValue:n||a.default_value,children:a.options.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:e},e))}):"bool"===a.type||"boolean"===a.type?(0,c.jsxs)(C.default,{placeholder:a.description,defaultValue:void 0!==n?String(n):a.default_value,children:[(0,c.jsx)(C.default.Option,{value:"true",children:"True"}),(0,c.jsx)(C.default.Option,{value:"false",children:"False"})]}):"number"===a.type?(0,c.jsx)(M,{step:1,width:400,placeholder:a.description,defaultValue:void 0!==n?Number(n):void 0}):l.includes("password")||l.includes("secret")||l.includes("key")?(0,c.jsx)(y.Z,{placeholder:a.description,type:"password",defaultValue:n||""}):(0,c.jsx)(y.Z,{placeholder:a.description,type:"text",defaultValue:n||""})},i)})};return(0,c.jsx)(c.Fragment,{children:j(p)})};let{Title:il}=em.default,ia=e=>{let{field:s,fieldKey:t,fullFieldKey:l,value:a}=e,[r,i]=d.useState([]),[n,o]=d.useState(s.dict_key_options||[]);d.useEffect(()=>{if(a&&"object"==typeof a){let e=Object.keys(a);i(e.map(e=>({key:e,id:"".concat(e,"_").concat(Date.now(),"_").concat(Math.random())}))),o((s.dict_key_options||[]).filter(s=>!e.includes(s)))}},[a,s.dict_key_options]);let m=e=>{e&&(i([...r,{key:e,id:"".concat(e,"_").concat(Date.now())}]),o(n.filter(s=>s!==e)))},u=(e,s)=>{i(r.filter(s=>s.id!==e)),o([...n,s].sort())};return(0,c.jsxs)("div",{className:"space-y-3",children:[r.map(e=>(0,c.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[(0,c.jsx)("div",{className:"w-24 font-medium text-sm",children:e.key}),(0,c.jsx)("div",{className:"flex-1",children:(0,c.jsx)(I.Z.Item,{name:Array.isArray(l)?[...l,e.key]:[l,e.key],style:{marginBottom:0},initialValue:a&&"object"==typeof a?a[e.key]:void 0,normalize:"number"===s.dict_value_type?e=>{if(null==e||""===e)return;let s=Number(e);return isNaN(s)?e:s}:void 0,children:"number"===s.dict_value_type?(0,c.jsx)(M,{step:1,width:200,placeholder:"Enter ".concat(e.key," value")}):"boolean"===s.dict_value_type?(0,c.jsxs)(C.default,{placeholder:"Select ".concat(e.key," value"),children:[(0,c.jsx)(C.default.Option,{value:!0,children:"True"}),(0,c.jsx)(C.default.Option,{value:!1,children:"False"})]}):(0,c.jsx)(y.Z,{placeholder:"Enter ".concat(e.key," value"),type:"text"})})}),(0,c.jsx)("button",{type:"button",className:"text-red-500 hover:text-red-700 text-sm",onClick:()=>u(e.id,e.key),children:"Remove"})]},e.id)),n.length>0&&(0,c.jsxs)("div",{className:"flex items-center space-x-3 mt-2",children:[(0,c.jsx)(C.default,{placeholder:"Select category to configure",style:{width:200},onSelect:e=>e&&m(e),value:void 0,children:n.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:e},e))}),(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"Select a category to add threshold configuration"})]})]})};var ir=e=>{let{optionalParams:s,parentFieldKey:t,values:l}=e,a=(e,s)=>{let a="".concat(t,".").concat(e),r=null==l?void 0:l[e];return(console.log("value",r),"dict"===s.type&&s.dict_key_options)?(0,c.jsxs)("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[(0,c.jsx)("div",{className:"mb-4 font-medium text-gray-900 text-base",children:e}),(0,c.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:s.description}),(0,c.jsx)(ia,{field:s,fieldKey:e,fullFieldKey:[t,e],value:r})]},a):(0,c.jsx)("div",{className:"mb-8 p-6 bg-white rounded-lg border border-gray-200 shadow-sm",children:(0,c.jsx)(I.Z.Item,{name:[t,e],label:(0,c.jsxs)("div",{className:"mb-2",children:[(0,c.jsx)("div",{className:"font-medium text-gray-900 text-base",children:e}),(0,c.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:s.description})]}),rules:s.required?[{required:!0,message:"".concat(e," is required")}]:void 0,className:"mb-0",initialValue:void 0!==r?r:s.default_value,normalize:"number"===s.type?e=>{if(null==e||""===e)return;let s=Number(e);return isNaN(s)?e:s}:void 0,children:"select"===s.type&&s.options?(0,c.jsx)(C.default,{placeholder:s.description,children:s.options.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:e},e))}):"multiselect"===s.type&&s.options?(0,c.jsx)(C.default,{mode:"multiple",placeholder:s.description,children:s.options.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:e},e))}):"bool"===s.type||"boolean"===s.type?(0,c.jsxs)(C.default,{placeholder:s.description,children:[(0,c.jsx)(C.default.Option,{value:"true",children:"True"}),(0,c.jsx)(C.default.Option,{value:"false",children:"False"})]}):"number"===s.type?(0,c.jsx)(M,{step:1,width:400,placeholder:s.description}):e.includes("password")||e.includes("secret")||e.includes("key")?(0,c.jsx)(y.Z,{placeholder:s.description,type:"password"}):(0,c.jsx)(y.Z,{placeholder:s.description,type:"text"})})},a)};return s.fields&&0!==Object.keys(s.fields).length?(0,c.jsxs)("div",{className:"guardrail-optional-params",children:[(0,c.jsxs)("div",{className:"mb-8 pb-4 border-b border-gray-100",children:[(0,c.jsx)(il,{level:3,className:"mb-2 font-semibold text-gray-900",children:"Optional Parameters"}),(0,c.jsx)("p",{className:"text-gray-600 text-sm",children:s.description||"Configure additional settings for this guardrail provider"})]}),(0,c.jsx)("div",{className:"space-y-8",children:Object.entries(s.fields).map(e=>{let[s,t]=e;return a(s,t)})})]}):null};let{Title:ii,Text:io,Link:ic}=em.default,{Option:id}=C.default,{Step:im}=rq.default,iu={pre_call:"Before LLM Call - Runs before the LLM call and checks the input (Recommended)",during_call:"During LLM Call - Runs in parallel with the LLM call, with response held until check completes",post_call:"After LLM Call - Runs after the LLM call and checks only the output",logging_only:"Logging Only - Only runs on logging callbacks without affecting the LLM call"};var ix=e=>{let{visible:s,onClose:t,accessToken:l,onSuccess:a}=e,[r]=I.Z.useForm(),[i,n]=(0,d.useState)(!1),[o,m]=(0,d.useState)(null),[u,x]=(0,d.useState)(null),[h,p]=(0,d.useState)([]),[j,f]=(0,d.useState)({}),[v,b]=(0,d.useState)(0),[N,Z]=(0,d.useState)(null),[w,k]=(0,d.useState)([]),[S,E]=(0,d.useState)(2),[T,L]=(0,d.useState)({});(0,d.useEffect)(()=>{l&&(async()=>{try{let[e,s]=await Promise.all([(0,g.getGuardrailUISettings)(l),(0,g.getGuardrailProviderSpecificParams)(l)]);x(e),Z(s),rV(s),rG(s)}catch(e){console.error("Error fetching guardrail data:",e),P.ZP.error("Failed to load guardrail configuration")}})()},[l]);let O=e=>{m(e),r.setFieldsValue({config:void 0,presidio_analyzer_api_base:void 0,presidio_anonymizer_api_base:void 0}),p([]),f({}),k([]),E(2),L({})},M=e=>{p(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},D=(e,s)=>{f(t=>({...t,[e]:s}))},F=async()=>{try{if(0===v&&(await r.validateFields(["guardrail_name","provider","mode","default_on"]),o)){let e=["guardrail_name","provider","mode","default_on"];"PresidioPII"===o&&e.push("presidio_analyzer_api_base","presidio_anonymizer_api_base"),await r.validateFields(e)}if(1===v&&rH(o)&&0===h.length){P.ZP.error("Please select at least one PII entity to continue");return}b(v+1)}catch(e){console.error("Form validation failed:",e)}},R=()=>{r.resetFields(),m(null),p([]),f({}),k([]),E(2),L({}),b(0)},q=()=>{R(),t()},U=async()=>{try{n(!0),await r.validateFields();let s=r.getFieldsValue(!0),i=rB[s.provider],c={guardrail_name:s.guardrail_name,litellm_params:{guardrail:i,mode:s.mode,default_on:s.default_on},guardrail_info:{}};if("PresidioPII"===s.provider&&h.length>0){let e={};h.forEach(s=>{e[s]=j[s]||"MASK"}),c.litellm_params.pii_entities_config=e,s.presidio_analyzer_api_base&&(c.litellm_params.presidio_analyzer_api_base=s.presidio_analyzer_api_base),s.presidio_anonymizer_api_base&&(c.litellm_params.presidio_anonymizer_api_base=s.presidio_anonymizer_api_base)}else if(s.config)try{let e=JSON.parse(s.config);c.guardrail_info=e}catch(e){P.ZP.error("Invalid JSON in configuration"),n(!1);return}if(console.log("values: ",JSON.stringify(s)),N&&o){var e;let t=null===(e=rB[o])||void 0===e?void 0:e.toLowerCase();console.log("providerKey: ",t);let l=N[t]||{},a=new Set;console.log("providerSpecificParams: ",JSON.stringify(l)),Object.keys(l).forEach(e=>{"optional_params"!==e&&a.add(e)}),l.optional_params&&l.optional_params.fields&&Object.keys(l.optional_params.fields).forEach(e=>{a.add(e)}),console.log("allowedParams: ",a),a.forEach(e=>{let t=s[e];if(null==t||""===t){var l;t=null===(l=s.optional_params)||void 0===l?void 0:l[e]}null!=t&&""!==t&&(c.litellm_params[e]=t)})}if(!l)throw Error("No access token available");console.log("Sending guardrail data:",JSON.stringify(c)),await (0,g.createGuardrailCall)(l,c),P.ZP.success("Guardrail created successfully"),R(),a(),t()}catch(e){console.error("Failed to create guardrail:",e),P.ZP.error("Failed to create guardrail: "+(e instanceof Error?e.message:String(e)))}finally{n(!1)}},z=()=>{var e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,c.jsx)(y.Z,{placeholder:"Enter a name for this guardrail"})}),(0,c.jsx)(I.Z.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,c.jsx)(C.default,{placeholder:"Select a guardrail provider",onChange:O,labelInValue:!1,optionLabelProp:"label",dropdownRender:e=>e,showSearch:!0,children:Object.entries(rK()).map(e=>{let[s,t]=e;return(0,c.jsx)(id,{value:s,label:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[rY[t]&&(0,c.jsx)("img",{src:rY[t],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,c.jsx)("span",{children:t})]}),children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[rY[t]&&(0,c.jsx)("img",{src:rY[t],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,c.jsx)("span",{children:t})]})},s)})})}),(0,c.jsx)(I.Z.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,c.jsx)(C.default,{optionLabelProp:"label",mode:"multiple",children:(null==u?void 0:null===(e=u.supported_modes)||void 0===e?void 0:e.map(e=>(0,c.jsx)(id,{value:e,label:e,children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("strong",{children:e}),"pre_call"===e&&(0,c.jsx)(rU.Z,{color:"green",style:{marginLeft:"8px"},children:"Recommended"})]}),(0,c.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:iu[e]})]})},e)))||(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(id,{value:"pre_call",label:"pre_call",children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("strong",{children:"pre_call"})," ",(0,c.jsx)(rU.Z,{color:"green",children:"Recommended"})]}),(0,c.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:iu.pre_call})]})}),(0,c.jsx)(id,{value:"during_call",label:"during_call",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{children:(0,c.jsx)("strong",{children:"during_call"})}),(0,c.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:iu.during_call})]})}),(0,c.jsx)(id,{value:"post_call",label:"post_call",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{children:(0,c.jsx)("strong",{children:"post_call"})}),(0,c.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:iu.post_call})]})}),(0,c.jsx)(id,{value:"logging_only",label:"logging_only",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{children:(0,c.jsx)("strong",{children:"logging_only"})}),(0,c.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:iu.logging_only})]})})]})})}),(0,c.jsx)(I.Z.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default.",children:(0,c.jsxs)(C.default,{children:[(0,c.jsx)(C.default.Option,{value:!0,children:"Yes"}),(0,c.jsx)(C.default.Option,{value:!1,children:"No"})]})}),(0,c.jsx)(it,{selectedProvider:o,accessToken:l,providerParams:N})]})},V=()=>u&&"PresidioPII"===o?(0,c.jsx)(is,{entities:u.supported_entities,actions:u.supported_actions,selectedEntities:h,selectedActions:j,onEntitySelect:M,onActionSelect:D,entityCategories:u.pii_entity_categories}):null,K=()=>{var e;if(!o||!N)return null;console.log("guardrail_provider_map: ",rB),console.log("selectedProvider: ",o);let s=null===(e=rB[o])||void 0===e?void 0:e.toLowerCase(),t=N&&N[s];return t&&t.optional_params?(0,c.jsx)(ir,{optionalParams:t.optional_params,parentFieldKey:"optional_params"}):null};return(0,c.jsx)(A.Z,{title:"Add Guardrail",open:s,onCancel:q,footer:null,width:700,children:(0,c.jsxs)(I.Z,{form:r,layout:"vertical",initialValues:{mode:"pre_call",default_on:!1},children:[(0,c.jsxs)(rq.default,{current:v,className:"mb-6",children:[(0,c.jsx)(im,{title:"Basic Info"}),(0,c.jsx)(im,{title:rH(o)?"PII Configuration":"Provider Configuration"})]}),(()=>{switch(v){case 0:return z();case 1:if(rH(o))return V();return K();default:return null}})(),(0,c.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[v>0&&(0,c.jsx)(_.Z,{variant:"secondary",onClick:()=>{b(v-1)},children:"Previous"}),v<2&&(0,c.jsx)(_.Z,{onClick:F,children:"Next"}),2===v&&(0,c.jsx)(_.Z,{onClick:U,loading:i,children:"Create Guardrail"}),(0,c.jsx)(_.Z,{variant:"secondary",onClick:q,children:"Cancel"})]})]})})};let{Title:ih,Text:ip}=em.default,{Option:ig}=C.default;var ij=e=>{var s;let{visible:t,onClose:l,accessToken:a,onSuccess:r,guardrailId:i,initialValues:n}=e,[o]=I.Z.useForm(),[m,u]=(0,d.useState)(!1),[x,h]=(0,d.useState)((null==n?void 0:n.provider)||null),[p,j]=(0,d.useState)(null),[f,v]=(0,d.useState)([]),[b,N]=(0,d.useState)({});(0,d.useEffect)(()=>{(async()=>{try{if(!a)return;let e=await (0,g.getGuardrailUISettings)(a);j(e)}catch(e){console.error("Error fetching guardrail settings:",e),P.ZP.error("Failed to load guardrail settings")}})()},[a]),(0,d.useEffect)(()=>{(null==n?void 0:n.pii_entities_config)&&Object.keys(n.pii_entities_config).length>0&&(v(Object.keys(n.pii_entities_config)),N(n.pii_entities_config))},[n]);let Z=e=>{v(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},w=(e,s)=>{N(t=>({...t,[e]:s}))},k=async()=>{try{u(!0);let e=await o.validateFields(),s=rB[e.provider],t={guardrail_id:i,guardrail:{guardrail_name:e.guardrail_name,litellm_params:{guardrail:s,mode:e.mode,default_on:e.default_on},guardrail_info:{}}};if("PresidioPII"===e.provider&&f.length>0){let e={};f.forEach(s=>{e[s]=b[s]||"MASK"}),t.guardrail.litellm_params.pii_entities_config=e}else if(e.config)try{let s=JSON.parse(e.config);"Bedrock"===e.provider&&s?(s.guardrail_id&&(t.guardrail.litellm_params.guardrailIdentifier=s.guardrail_id),s.guardrail_version&&(t.guardrail.litellm_params.guardrailVersion=s.guardrail_version)):t.guardrail.guardrail_info=s}catch(e){P.ZP.error("Invalid JSON in configuration"),u(!1);return}if(!a)throw Error("No access token available");console.log("Sending guardrail update data:",JSON.stringify(t));let n=await fetch("/guardrails/".concat(i),{method:"PUT",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){let e=await n.text();throw Error(e||"Failed to update guardrail")}P.ZP.success("Guardrail updated successfully"),r(),l()}catch(e){console.error("Failed to update guardrail:",e),P.ZP.error("Failed to update guardrail: "+(e instanceof Error?e.message:String(e)))}finally{u(!1)}},S=()=>p&&x&&"PresidioPII"===x?(0,c.jsx)(is,{entities:p.supported_entities,actions:p.supported_actions,selectedEntities:f,selectedActions:b,onEntitySelect:Z,onActionSelect:w,entityCategories:p.pii_entity_categories}):null;return(0,c.jsx)(A.Z,{title:"Edit Guardrail",open:t,onCancel:l,footer:null,width:700,children:(0,c.jsxs)(I.Z,{form:o,layout:"vertical",initialValues:n,children:[(0,c.jsx)(I.Z.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,c.jsx)(y.Z,{placeholder:"Enter a name for this guardrail"})}),(0,c.jsx)(I.Z.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,c.jsx)(C.default,{placeholder:"Select a guardrail provider",onChange:e=>{h(e),o.setFieldsValue({config:void 0}),v([]),N({})},disabled:!0,optionLabelProp:"label",children:Object.entries(rK()).map(e=>{let[s,t]=e;return(0,c.jsx)(ig,{value:s,label:t,children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[rY[t]&&(0,c.jsx)("img",{src:rY[t],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,c.jsx)("span",{children:t})]})},s)})})}),(0,c.jsx)(I.Z.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,c.jsx)(C.default,{children:(null==p?void 0:null===(s=p.supported_modes)||void 0===s?void 0:s.map(e=>(0,c.jsx)(ig,{value:e,children:e},e)))||(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ig,{value:"pre_call",children:"pre_call"}),(0,c.jsx)(ig,{value:"post_call",children:"post_call"})]})})}),(0,c.jsx)(I.Z.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default",valuePropName:"checked",children:(0,c.jsx)(tn.Z,{})}),(()=>{if(!x)return null;if("PresidioPII"===x)return S();switch(x){case"Aporia":return(0,c.jsx)(I.Z.Item,{label:"Aporia Configuration",name:"config",tooltip:"JSON configuration for Aporia",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_aporia_api_key",\n  "project_name": "your_project_name"\n}'})});case"AimSecurity":return(0,c.jsx)(I.Z.Item,{label:"Aim Security Configuration",name:"config",tooltip:"JSON configuration for Aim Security",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_aim_api_key"\n}'})});case"Bedrock":return(0,c.jsx)(I.Z.Item,{label:"Amazon Bedrock Configuration",name:"config",tooltip:"JSON configuration for Amazon Bedrock guardrails",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:'{\n  "guardrail_id": "your_guardrail_id",\n  "guardrail_version": "your_guardrail_version"\n}'})});case"GuardrailsAI":return(0,c.jsx)(I.Z.Item,{label:"Guardrails.ai Configuration",name:"config",tooltip:"JSON configuration for Guardrails.ai",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_guardrails_api_key",\n  "guardrail_id": "your_guardrail_id"\n}'})});case"LakeraAI":return(0,c.jsx)(I.Z.Item,{label:"Lakera AI Configuration",name:"config",tooltip:"JSON configuration for Lakera AI",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_lakera_api_key"\n}'})});case"PromptInjection":return(0,c.jsx)(I.Z.Item,{label:"Prompt Injection Configuration",name:"config",tooltip:"JSON configuration for prompt injection detection",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:'{\n  "threshold": 0.8\n}'})});default:return(0,c.jsx)(I.Z.Item,{label:"Custom Configuration",name:"config",tooltip:"JSON configuration for your custom guardrail",children:(0,c.jsx)(L.default.TextArea,{rows:4,placeholder:'{\n  "key1": "value1",\n  "key2": "value2"\n}'})})}})(),(0,c.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,c.jsx)(_.Z,{variant:"secondary",onClick:l,children:"Cancel"}),(0,c.jsx)(_.Z,{onClick:k,loading:m,children:"Update Guardrail"})]})]})})},iv=e=>{let{guardrailsList:s,isLoading:t,onDeleteClick:l,accessToken:a,onGuardrailUpdated:r,isAdmin:i=!1,onGuardrailClick:n}=e,[o,m]=(0,d.useState)([{id:"created_at",desc:!0}]),[u,x]=(0,d.useState)(!1),[h,p]=(0,d.useState)(null),g=e=>e?new Date(e).toLocaleString():"-",j=[{header:"Guardrail ID",accessorKey:"guardrail_id",cell:e=>(0,c.jsx)(z.Z,{title:String(e.getValue()||""),children:(0,c.jsx)(_.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>e.getValue()&&n(e.getValue()),children:e.getValue()?"".concat(String(e.getValue()).slice(0,7),"..."):""})})},{header:"Name",accessorKey:"guardrail_name",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)(z.Z,{title:t.guardrail_name,children:(0,c.jsx)("span",{className:"text-xs font-medium",children:t.guardrail_name||"-"})})}},{header:"Provider",accessorKey:"litellm_params.guardrail",cell:e=>{let{row:s}=e,{logo:t,displayName:l}=rW(s.original.litellm_params.guardrail);return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,c.jsx)("img",{src:t,alt:"".concat(l," logo"),className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,c.jsx)("span",{className:"text-xs",children:l})]})}},{header:"Mode",accessorKey:"litellm_params.mode",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("span",{className:"text-xs",children:t.litellm_params.mode})}},{header:"Default On",accessorKey:"litellm_params.default_on",cell:e=>{var s,t;let{row:l}=e,a=l.original;return(0,c.jsx)(eJ.Z,{color:(null===(s=a.litellm_params)||void 0===s?void 0:s.default_on)?"green":"gray",className:"text-xs font-normal",size:"xs",children:(null===(t=a.litellm_params)||void 0===t?void 0:t.default_on)?"Default On":"Default Off"})}},{header:"Created At",accessorKey:"created_at",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)(z.Z,{title:t.created_at,children:(0,c.jsx)("span",{className:"text-xs",children:g(t.created_at)})})}},{header:"Updated At",accessorKey:"updated_at",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)(z.Z,{title:t.updated_at,children:(0,c.jsx)("span",{className:"text-xs",children:g(t.updated_at)})})}},{id:"actions",header:"",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("div",{className:"flex space-x-2",children:(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>t.guardrail_id&&l(t.guardrail_id,t.guardrail_name||"Unnamed Guardrail"),className:"cursor-pointer hover:text-red-500",tooltip:"Delete guardrail"})})}}],f=(0,sp.b7)({data:s,columns:j,state:{sorting:o},onSortingChange:m,getCoreRowModel:(0,sg.sC)(),getSortedRowModel:(0,sg.tj)(),enableSorting:!0});return(0,c.jsxs)("div",{className:"rounded-lg custom-border relative",children:[(0,c.jsx)("div",{className:"overflow-x-auto",children:(0,c.jsxs)(sf.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,c.jsx)(sy.Z,{children:f.getHeaderGroups().map(e=>(0,c.jsx)(sN.Z,{children:e.headers.map(e=>(0,c.jsx)(sb.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,c.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,sp.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,c.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,c.jsx)(sk.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,c.jsx)(sZ.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,c.jsx)(sS.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,c.jsx)(sv.Z,{children:t?(0,c.jsx)(sN.Z,{children:(0,c.jsx)(s_.Z,{colSpan:j.length,className:"h-8 text-center",children:(0,c.jsx)("div",{className:"text-center text-gray-500",children:(0,c.jsx)("p",{children:"Loading..."})})})}):s.length>0?f.getRowModel().rows.map(e=>(0,c.jsx)(sN.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,c.jsx)(s_.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,sp.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,c.jsx)(sN.Z,{children:(0,c.jsx)(s_.Z,{colSpan:j.length,className:"h-8 text-center",children:(0,c.jsx)("div",{className:"text-center text-gray-500",children:(0,c.jsx)("p",{children:"No guardrails found"})})})})})]})}),h&&(0,c.jsx)(ij,{visible:u,onClose:()=>x(!1),accessToken:a,onSuccess:()=>{x(!1),p(null),r()},guardrailId:h.guardrail_id||"",initialValues:{guardrail_name:h.guardrail_name||"",provider:Object.keys(rB).find(e=>rB[e]===(null==h?void 0:h.litellm_params.guardrail))||"",mode:h.litellm_params.mode,default_on:h.litellm_params.default_on,pii_entities_config:h.litellm_params.pii_entities_config,...h.guardrail_info}})]})},i_=e=>{var s,t,l,a,r,i,n,o,m,u,x;let{guardrailId:h,onClose:p,accessToken:j,isAdmin:f}=e,[b,N]=(0,d.useState)(null),[Z,S]=(0,d.useState)(null),[A,E]=(0,d.useState)(!0),[O,M]=(0,d.useState)(!1),[D]=I.Z.useForm(),[F,R]=(0,d.useState)([]),[q,U]=(0,d.useState)({}),[z,V]=(0,d.useState)(null),[K,B]=(0,d.useState)({}),G=async()=>{try{var e;if(E(!0),!j)return;let s=await (0,g.getGuardrailInfo)(j,h);if(N(s),null===(e=s.litellm_params)||void 0===e?void 0:e.pii_entities_config){let e=s.litellm_params.pii_entities_config;if(R([]),U({}),Object.keys(e).length>0){let s=[],t={};Object.entries(e).forEach(e=>{let[l,a]=e;s.push(l),t[l]="string"==typeof a?a:"MASK"}),R(s),U(t)}}else R([]),U({})}catch(e){P.ZP.error("Failed to load guardrail information"),console.error("Error fetching guardrail info:",e)}finally{E(!1)}},H=async()=>{try{if(!j)return;let e=await (0,g.getGuardrailProviderSpecificParams)(j);S(e)}catch(e){console.error("Error fetching guardrail provider specific params:",e)}},J=async()=>{try{if(!j)return;let e=await (0,g.getGuardrailUISettings)(j);V(e)}catch(e){console.error("Error fetching guardrail UI settings:",e)}};(0,d.useEffect)(()=>{H()},[j]),(0,d.useEffect)(()=>{G(),J()},[h,j]),(0,d.useEffect)(()=>{if(b&&D){var e;D.setFieldsValue({guardrail_name:b.guardrail_name,...b.litellm_params,guardrail_info:b.guardrail_info?JSON.stringify(b.guardrail_info,null,2):"",...(null===(e=b.litellm_params)||void 0===e?void 0:e.optional_params)&&{optional_params:b.litellm_params.optional_params}})}},[b,Z,D]);let $=async e=>{try{var s,t,l;if(!j)return;let a={litellm_params:{}};e.guardrail_name!==b.guardrail_name&&(a.guardrail_name=e.guardrail_name),e.default_on!==(null===(s=b.litellm_params)||void 0===s?void 0:s.default_on)&&(a.litellm_params.default_on=e.default_on);let r=b.guardrail_info,i=e.guardrail_info?JSON.parse(e.guardrail_info):void 0;JSON.stringify(r)!==JSON.stringify(i)&&(a.guardrail_info=i);let n=(null===(t=b.litellm_params)||void 0===t?void 0:t.pii_entities_config)||{},o={};F.forEach(e=>{o[e]=q[e]||"MASK"}),JSON.stringify(n)!==JSON.stringify(o)&&(a.litellm_params.pii_entities_config=o);let c=Object.keys(rB).find(e=>{var s;return rB[e]===(null===(s=b.litellm_params)||void 0===s?void 0:s.guardrail)});if(console.log("values: ",JSON.stringify(e)),console.log("currentProvider: ",c),Z&&c){let s=Z[null===(l=rB[c])||void 0===l?void 0:l.toLowerCase()]||{},t=new Set;console.log("providerSpecificParams: ",JSON.stringify(s)),Object.keys(s).forEach(e=>{"optional_params"!==e&&t.add(e)}),s.optional_params&&s.optional_params.fields&&Object.keys(s.optional_params.fields).forEach(e=>{t.add(e)}),console.log("allowedParams: ",t),t.forEach(s=>{var t,l;let r=e[s];(null==r||""===r)&&(r=null===(l=e.optional_params)||void 0===l?void 0:l[s]);let i=null===(t=b.litellm_params)||void 0===t?void 0:t[s];JSON.stringify(r)!==JSON.stringify(i)&&(null!=r&&""!==r?a.litellm_params[s]=r:null!=i&&""!==i&&(a.litellm_params[s]=null))})}if(0===Object.keys(a.litellm_params).length&&delete a.litellm_params,0===Object.keys(a).length){P.ZP.info("No changes detected"),M(!1);return}await (0,g.updateGuardrailCall)(j,h,a),P.ZP.success("Guardrail updated successfully"),G(),M(!1)}catch(e){console.error("Error updating guardrail:",e),P.ZP.error("Failed to update guardrail")}};if(A)return(0,c.jsx)("div",{className:"p-4",children:"Loading..."});if(!b)return(0,c.jsx)("div",{className:"p-4",children:"Guardrail not found"});let Q=e=>e?new Date(e).toLocaleString():"-",{logo:X,displayName:ee}=rW((null===(s=b.litellm_params)||void 0===s?void 0:s.guardrail)||""),es=async(e,s)=>{await eF(e)&&(B(e=>({...e,[s]:!0})),setTimeout(()=>{B(e=>({...e,[s]:!1}))},2e3))};return(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",onClick:p,className:"mb-4",children:"Back to Guardrails"}),(0,c.jsx)(k.Z,{children:b.guardrail_name||"Unnamed Guardrail"}),(0,c.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,c.jsx)(w.Z,{className:"text-gray-500 font-mono",children:b.guardrail_id}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:K["guardrail-id"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>es(b.guardrail_id,"guardrail-id"),className:"left-2 z-10 transition-all duration-200 ".concat(K["guardrail-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{className:"mb-4",children:[(0,c.jsx)(eY.Z,{children:"Overview"},"overview"),f?(0,c.jsx)(eY.Z,{children:"Settings"},"settings"):(0,c.jsx)(c.Fragment,{})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Provider"}),(0,c.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[X&&(0,c.jsx)("img",{src:X,alt:"".concat(ee," logo"),className:"w-6 h-6",onError:e=>{e.target.style.display="none"}}),(0,c.jsx)(k.Z,{children:ee})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Mode"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsx)(k.Z,{children:(null===(t=b.litellm_params)||void 0===t?void 0:t.mode)||"-"}),(0,c.jsx)(eJ.Z,{color:(null===(l=b.litellm_params)||void 0===l?void 0:l.default_on)?"green":"gray",children:(null===(a=b.litellm_params)||void 0===a?void 0:a.default_on)?"Default On":"Default Off"})]})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Created At"}),(0,c.jsxs)("div",{className:"mt-2",children:[(0,c.jsx)(k.Z,{children:Q(b.created_at)}),(0,c.jsxs)(w.Z,{children:["Last Updated: ",Q(b.updated_at)]})]})]})]}),(null===(r=b.litellm_params)||void 0===r?void 0:r.pii_entities_config)&&Object.keys(b.litellm_params.pii_entities_config).length>0&&(0,c.jsx)(W.Z,{className:"mt-6",children:(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"PII Protection"}),(0,c.jsxs)(eJ.Z,{color:"blue",children:[Object.keys(b.litellm_params.pii_entities_config).length," PII entities configured"]})]})}),b.guardrail_info&&Object.keys(b.guardrail_info).length>0&&(0,c.jsxs)(W.Z,{className:"mt-6",children:[(0,c.jsx)(w.Z,{children:"Guardrail Info"}),(0,c.jsx)("div",{className:"mt-2 space-y-2",children:Object.entries(b.guardrail_info).map(e=>{let[s,t]=e;return(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)(w.Z,{className:"font-medium w-1/3",children:s}),(0,c.jsx)(w.Z,{className:"w-2/3",children:"object"==typeof t?JSON.stringify(t,null,2):String(t)})]},s)})})]})]}),f&&(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"Guardrail Settings"}),!O&&(0,c.jsx)(_.Z,{onClick:()=>M(!0),children:"Edit Settings"})]}),O?(0,c.jsxs)(I.Z,{form:D,onFinish:$,initialValues:{guardrail_name:b.guardrail_name,...b.litellm_params,guardrail_info:b.guardrail_info?JSON.stringify(b.guardrail_info,null,2):"",...(null===(i=b.litellm_params)||void 0===i?void 0:i.optional_params)&&{optional_params:b.litellm_params.optional_params}},layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{label:"Guardrail Name",name:"guardrail_name",rules:[{required:!0,message:"Please input a guardrail name"}],children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"Default On",name:"default_on",children:(0,c.jsxs)(C.default,{children:[(0,c.jsx)(C.default.Option,{value:!0,children:"Yes"}),(0,c.jsx)(C.default.Option,{value:!1,children:"No"})]})}),(null===(n=b.litellm_params)||void 0===n?void 0:n.guardrail)==="presidio"&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Y.Z,{orientation:"left",children:"PII Protection"}),(0,c.jsx)("div",{className:"mb-6",children:z&&(0,c.jsx)(is,{entities:z.supported_entities,actions:z.supported_actions,selectedEntities:F,selectedActions:q,onEntitySelect:e=>{R(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},onActionSelect:(e,s)=>{U(t=>({...t,[e]:s}))},entityCategories:z.pii_entity_categories})})]}),(0,c.jsx)(Y.Z,{orientation:"left",children:"Provider Settings"}),(0,c.jsx)(it,{selectedProvider:Object.keys(rB).find(e=>{var s;return rB[e]===(null===(s=b.litellm_params)||void 0===s?void 0:s.guardrail)})||null,accessToken:j,providerParams:Z,value:b.litellm_params}),Z&&(()=>{var e;let s=Object.keys(rB).find(e=>{var s;return rB[e]===(null===(s=b.litellm_params)||void 0===s?void 0:s.guardrail)});if(!s)return null;let t=Z[null===(e=rB[s])||void 0===e?void 0:e.toLowerCase()];return t&&t.optional_params?(0,c.jsx)(ir,{optionalParams:t.optional_params,parentFieldKey:"optional_params",values:b.litellm_params}):null})(),(0,c.jsx)(Y.Z,{orientation:"left",children:"Advanced Settings"}),(0,c.jsx)(I.Z.Item,{label:"Guardrail Information",name:"guardrail_info",children:(0,c.jsx)(L.default.TextArea,{rows:5})}),(0,c.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,c.jsx)(T.ZP,{onClick:()=>M(!1),children:"Cancel"}),(0,c.jsx)(_.Z,{children:"Save Changes"})]})]}):(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Guardrail ID"}),(0,c.jsx)("div",{className:"font-mono",children:b.guardrail_id})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Guardrail Name"}),(0,c.jsx)("div",{children:b.guardrail_name||"Unnamed Guardrail"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Provider"}),(0,c.jsx)("div",{children:ee})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Mode"}),(0,c.jsx)("div",{children:(null===(o=b.litellm_params)||void 0===o?void 0:o.mode)||"-"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Default On"}),(0,c.jsx)(eJ.Z,{color:(null===(m=b.litellm_params)||void 0===m?void 0:m.default_on)?"green":"gray",children:(null===(u=b.litellm_params)||void 0===u?void 0:u.default_on)?"Yes":"No"})]}),(null===(x=b.litellm_params)||void 0===x?void 0:x.pii_entities_config)&&Object.keys(b.litellm_params.pii_entities_config).length>0&&(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"PII Protection"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsxs)(eJ.Z,{color:"blue",children:[Object.keys(b.litellm_params.pii_entities_config).length," PII entities configured"]})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Created At"}),(0,c.jsx)("div",{children:Q(b.created_at)})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Last Updated"}),(0,c.jsx)("div",{children:Q(b.updated_at)})]})]})]})})]})]})]})},iy=e=>{let{accessToken:s,userRole:t}=e,[l,a]=(0,d.useState)([]),[r,i]=(0,d.useState)(!1),[n,o]=(0,d.useState)(!1),[m,u]=(0,d.useState)(!1),[x,h]=(0,d.useState)(null),[p,j]=(0,d.useState)(null),f=!!t&&(0,eE.tY)(t),v=async()=>{if(s){o(!0);try{let e=await (0,g.getGuardrailsList)(s);console.log("guardrails: ".concat(JSON.stringify(e))),a(e.guardrails)}catch(e){console.error("Error fetching guardrails:",e)}finally{o(!1)}}};(0,d.useEffect)(()=>{v()},[s]);let y=async()=>{if(x&&s){u(!0);try{await (0,g.deleteGuardrailCall)(s,x.id),P.ZP.success('Guardrail "'.concat(x.name,'" deleted successfully')),v()}catch(e){console.error("Error deleting guardrail:",e),P.ZP.error("Failed to delete guardrail")}finally{u(!1),h(null)}}};return(0,c.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[(0,c.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,c.jsx)(_.Z,{onClick:()=>{p&&j(null),i(!0)},disabled:!s,children:"+ Add New Guardrail"})}),p?(0,c.jsx)(i_,{guardrailId:p,onClose:()=>j(null),accessToken:s,isAdmin:f}):(0,c.jsx)(iv,{guardrailsList:l,isLoading:n,onDeleteClick:(e,s)=>{h({id:e,name:s})},accessToken:s,onGuardrailUpdated:v,isAdmin:f,onGuardrailClick:e=>j(e)}),(0,c.jsx)(ix,{visible:r,onClose:()=>{i(!1)},accessToken:s,onSuccess:()=>{v()}}),x&&(0,c.jsxs)(A.Z,{title:"Delete Guardrail",open:null!==x,onOk:y,onCancel:()=>{h(null)},confirmLoading:m,okText:"Delete",okButtonProps:{danger:!0},children:[(0,c.jsxs)("p",{children:["Are you sure you want to delete guardrail: ",x.name," ?"]}),(0,c.jsx)("p",{children:"This action cannot be undone."})]})]})},ib=e=>{let{accessToken:s}=e,[t,l]=(0,d.useState)('{\n  "model": "openai/gpt-4o",\n  "messages": [\n    {\n      "role": "system",\n      "content": "You are a helpful assistant."\n    },\n    {\n      "role": "user",\n      "content": "Explain quantum computing in simple terms"\n    }\n  ],\n  "temperature": 0.7,\n  "max_tokens": 500,\n  "stream": true\n}'),[a,r]=(0,d.useState)(""),[i,n]=(0,d.useState)(!1),o=(e,s,t)=>{let l=JSON.stringify(s,null,2).split("\n").map(e=>"  ".concat(e)).join("\n"),a=Object.entries(t).map(e=>{let[s,t]=e;return"-H '".concat(s,": ").concat(t,"'")}).join(" \\\n  ");return"curl -X POST \\\n  ".concat(e," \\\n  ").concat(a?"".concat(a," \\\n  "):"","-H 'Content-Type: application/json' \\\n  -d '{\n").concat(l,"\n  }'")},m=async()=>{n(!0);try{let e;try{e=JSON.parse(t)}catch(e){P.ZP.error("Invalid JSON in request body"),n(!1);return}let l={call_type:"completion",request_body:e};if(!s){P.ZP.error("No access token found"),n(!1);return}let a=await (0,g.transformRequestCall)(s,l);if(a.raw_request_api_base&&a.raw_request_body){let e=o(a.raw_request_api_base,a.raw_request_body,a.raw_request_headers||{});r(e),P.ZP.success("Request transformed successfully")}else{let e="string"==typeof a?a:JSON.stringify(a);r(e),P.ZP.info("Transformed request received in unexpected format")}}catch(e){console.error("Error transforming request:",e),P.ZP.error("Failed to transform request")}finally{n(!1)}};return(0,c.jsxs)("div",{className:"w-full m-2",style:{overflow:"hidden"},children:[(0,c.jsx)(k.Z,{children:"Playground"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"See how LiteLLM transforms your request for the specified provider."}),(0,c.jsxs)("div",{style:{display:"flex",gap:"16px",width:"100%",minWidth:0,overflow:"hidden"},className:"mt-4",children:[(0,c.jsxs)("div",{style:{flex:"1 1 50%",display:"flex",flexDirection:"column",border:"1px solid #e8e8e8",borderRadius:"8px",padding:"24px",overflow:"hidden",maxHeight:"600px",minWidth:0},children:[(0,c.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,c.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",margin:"0 0 4px 0"},children:"Original Request"}),(0,c.jsx)("p",{style:{color:"#666",margin:0},children:"The request you would send to LiteLLM /chat/completions endpoint."})]}),(0,c.jsx)("textarea",{style:{flex:"1 1 auto",width:"100%",minHeight:"240px",padding:"16px",border:"1px solid #e8e8e8",borderRadius:"6px",fontFamily:"monospace",fontSize:"14px",resize:"none",marginBottom:"24px",overflow:"auto"},value:t,onChange:e=>l(e.target.value),onKeyDown:e=>{(e.metaKey||e.ctrlKey)&&"Enter"===e.key&&(e.preventDefault(),m())},placeholder:"Press Cmd/Ctrl + Enter to transform"}),(0,c.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"auto"},children:(0,c.jsxs)(T.ZP,{type:"primary",style:{backgroundColor:"#000",display:"flex",alignItems:"center",gap:"8px"},onClick:m,loading:i,children:[(0,c.jsx)("span",{children:"Transform"}),(0,c.jsx)("span",{children:"→"})]})})]}),(0,c.jsxs)("div",{style:{flex:"1 1 50%",display:"flex",flexDirection:"column",border:"1px solid #e8e8e8",borderRadius:"8px",padding:"24px",overflow:"hidden",maxHeight:"800px",minWidth:0},children:[(0,c.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,c.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",margin:"0 0 4px 0"},children:"Transformed Request"}),(0,c.jsx)("p",{style:{color:"#666",margin:0},children:"How LiteLLM transforms your request for the specified provider."}),(0,c.jsx)("br",{}),(0,c.jsx)("p",{style:{color:"#666",margin:0},className:"text-xs",children:"Note: Sensitive headers are not shown."})]}),(0,c.jsxs)("div",{style:{position:"relative",backgroundColor:"#f5f5f5",borderRadius:"6px",flex:"1 1 auto",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,c.jsx)("pre",{style:{padding:"16px",fontFamily:"monospace",fontSize:"14px",margin:0,overflow:"auto",flex:"1 1 auto"},children:a||'curl -X POST \\\n  https://api.openai.com/v1/chat/completions \\\n  -H \'Authorization: Bearer sk-xxx\' \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n  "model": "gpt-4",\n  "messages": [\n    {\n      "role": "system",\n      "content": "You are a helpful assistant."\n    }\n  ],\n  "temperature": 0.7\n  }\''}),(0,c.jsx)(T.ZP,{type:"text",icon:(0,c.jsx)(tC.Z,{}),style:{position:"absolute",right:"8px",top:"8px"},size:"small",onClick:()=>{navigator.clipboard.writeText(a||""),P.ZP.success("Copied to clipboard")}})]})]})]}),(0,c.jsx)("div",{className:"mt-4 text-right w-full",children:(0,c.jsxs)("p",{className:"text-sm text-gray-500",children:["Found an error? File an issue ",(0,c.jsx)("a",{href:"https://github.com/BerriAI/litellm/issues",target:"_blank",rel:"noopener noreferrer",children:"here"}),"."]})})]})};let iN=e=>{try{let s=e.indexOf("/mcp/");if(-1===s)return{token:null,baseUrl:e};let t=e.split("/mcp/");if(2!==t.length)return{token:null,baseUrl:e};let l=t[0]+"/mcp/",a=t[1];if(!a)return{token:null,baseUrl:e};return{token:a,baseUrl:l}}catch(s){return console.error("Error parsing MCP URL:",s),{token:null,baseUrl:e}}},iZ=e=>{let{token:s,baseUrl:t}=iN(e);return s?t+"...":e},iw=e=>{let{token:s}=iN(e);return{maskedUrl:iZ(e),hasToken:!!s}},ik=(e,s,t,l)=>[{accessorKey:"server_id",header:"Server ID",cell:e=>{let{row:t}=e;return(0,c.jsxs)("button",{onClick:()=>s(t.original.server_id),className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left w-full truncate whitespace-nowrap cursor-pointer max-w-[15ch]",children:[t.original.server_id.slice(0,7),"..."]})}},{accessorKey:"server_name",header:"Name"},{accessorKey:"alias",header:"Alias"},{id:"url",header:"URL",cell:e=>{let{row:s}=e,{maskedUrl:t}=iw(s.original.url);return(0,c.jsx)("span",{className:"font-mono text-sm",children:t})}},{accessorKey:"transport",header:"Transport",cell:e=>{let{getValue:s}=e;return(0,c.jsx)("span",{children:(s()||"http").toUpperCase()})}},{accessorKey:"auth_type",header:"Auth Type",cell:e=>{let{getValue:s}=e;return(0,c.jsx)("span",{children:s()||"none"})}},{id:"mcp_access_groups",header:"Access Groups",cell:e=>{let{row:s}=e,t=s.original.mcp_access_groups;if(Array.isArray(t)&&t.length>0&&"string"==typeof t[0]){let e=t.join(", ");return(0,c.jsx)(z.Z,{title:e,children:(0,c.jsx)("span",{className:"max-w-[200px] truncate block",children:e.length>30?"".concat(e.slice(0,30),"..."):e})})}return(0,c.jsx)("span",{className:"text-gray-400 italic",children:"None"})}},{header:"Created At",accessorKey:"created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("span",{className:"text-xs",children:t.created_at?new Date(t.created_at).toLocaleDateString():"-"})}},{header:"Updated At",accessorKey:"updated_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("span",{className:"text-xs",children:t.updated_at?new Date(t.updated_at).toLocaleDateString():"-"})}},{id:"actions",header:"Actions",cell:e=>{let{row:s}=e;return(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>t(s.original.server_id),className:"cursor-pointer"}),(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>l(s.original.server_id),className:"cursor-pointer"})]})}}];var iS=t(82376),iC=t(71437);let iI={NONE:"none",API_KEY:"api_key",BEARER_TOKEN:"bearer_token",BASIC:"basic"},iP={SSE:"sse"},iA=e=>(console.log(e),null==e)?iP.SSE:e,iE=e=>null==e?iI.NONE:e,iT=e=>iE(e)!==iI.NONE;var iL=t(62670),iO=e=>{let{value:s={},onChange:t,tools:l=[],disabled:a=!1}=e,r=(e,l)=>{let a={...s,tool_name_to_cost_per_query:{...s.tool_name_to_cost_per_query,[e]:l}};null==t||t(a)};return(0,c.jsx)(W.Z,{children:(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,c.jsx)(iL.Z,{className:"text-green-600"}),(0,c.jsx)(k.Z,{children:"Cost Configuration"}),(0,c.jsx)(z.Z,{title:"Configure costs for this MCP server's tool calls. Set a default rate and per-tool overrides.",children:(0,c.jsx)(U.Z,{className:"text-gray-400"})})]}),(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Default Cost per Query ($)",(0,c.jsx)(z.Z,{title:"Default cost charged for each tool call to this server.",children:(0,c.jsx)(U.Z,{className:"ml-1 text-gray-400"})})]}),(0,c.jsx)(q.Z,{min:0,step:1e-4,precision:4,placeholder:"0.0000",value:s.default_cost_per_query,onChange:e=>{let l={...s,default_cost_per_query:e};null==t||t(l)},disabled:a,style:{width:"200px"},addonBefore:"$"}),(0,c.jsx)(w.Z,{className:"block mt-1 text-gray-500 text-sm",children:"Set a default cost for all tool calls to this server"})]}),l.length>0&&(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Tool-Specific Costs ($)",(0,c.jsx)(z.Z,{title:"Override the default cost for specific tools. Leave blank to use the default rate.",children:(0,c.jsx)(U.Z,{className:"ml-1 text-gray-400"})})]}),(0,c.jsx)(tx.default,{items:[{key:"1",label:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(a2.Z,{className:"mr-2 text-blue-500"}),(0,c.jsx)("span",{className:"font-medium",children:"Available Tools"}),(0,c.jsx)(r$.Z,{count:l.length,style:{backgroundColor:"#52c41a",marginLeft:"8px"}})]}),children:(0,c.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:l.map((e,t)=>{var l;return(0,c.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)(w.Z,{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,c.jsx)(w.Z,{className:"text-gray-500 text-sm block mt-1",children:e.description})]}),(0,c.jsx)("div",{className:"ml-4",children:(0,c.jsx)(q.Z,{min:0,step:1e-4,precision:4,placeholder:"Use default",value:null===(l=s.tool_name_to_cost_per_query)||void 0===l?void 0:l[e.name],onChange:s=>r(e.name,s),disabled:a,style:{width:"120px"},addonBefore:"$"})})]},t)})})}]})]})]}),(s.default_cost_per_query||s.tool_name_to_cost_per_query&&Object.keys(s.tool_name_to_cost_per_query).length>0)&&(0,c.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,c.jsx)(w.Z,{className:"text-blue-800 font-medium",children:"Cost Summary:"}),(0,c.jsxs)("div",{className:"mt-2 space-y-1",children:[s.default_cost_per_query&&(0,c.jsxs)(w.Z,{className:"text-blue-700",children:["• Default cost: $",s.default_cost_per_query.toFixed(4)," per query"]}),s.tool_name_to_cost_per_query&&Object.entries(s.tool_name_to_cost_per_query).map(e=>{let[s,t]=e;return null!=t&&(0,c.jsxs)(w.Z,{className:"text-blue-700",children:["• ",s,": $",t.toFixed(4)," per query"]},s)})]})]})]})})},iM=e=>{let{mcpServer:s,accessToken:t,onCancel:l,onSuccess:a,availableAccessGroups:r}=e,[i]=I.Z.useForm(),[n,o]=(0,d.useState)({}),[m,u]=(0,d.useState)([]),[x,h]=(0,d.useState)(!1),[p,j]=(0,d.useState)(""),[f,v]=(0,d.useState)(!1);(0,d.useEffect)(()=>{var e;(null===(e=s.mcp_info)||void 0===e?void 0:e.mcp_server_cost_info)&&o(s.mcp_info.mcp_server_cost_info)},[s]),(0,d.useEffect)(()=>{if(s.mcp_access_groups){let e=s.mcp_access_groups.map(e=>"string"==typeof e?e:e.name||String(e));i.setFieldValue("mcp_access_groups",e)}},[s]),(0,d.useEffect)(()=>{b()},[s,t]);let b=async()=>{if(t&&s.url){h(!0);try{let e={server_id:s.server_id,server_name:s.server_name,url:s.url,transport:s.transport,spec_version:s.spec_version,auth_type:s.auth_type,mcp_info:s.mcp_info},l=await (0,g.testMCPToolsListRequest)(t,e);l.tools&&!l.error?u(l.tools):(console.error("Failed to fetch tools:",l.message),u([]))}catch(e){console.error("Tools fetch error:",e),u([])}finally{h(!1)}}},N=async e=>{if(t)try{let l=(e.mcp_access_groups||[]).map(e=>"string"==typeof e?e:e.name||String(e)),r={...e,server_id:s.server_id,mcp_info:{server_name:e.server_name||e.url,description:e.description,mcp_server_cost_info:Object.keys(n).length>0?n:null},mcp_access_groups:l,alias:e.alias},i=await (0,g.updateMCPServer)(t,r);P.ZP.success("MCP Server updated successfully"),a(i)}catch(e){P.ZP.error("Failed to update MCP Server"+((null==e?void 0:e.message)?": ".concat(e.message):""))}};return(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{className:"grid w-full grid-cols-2",children:[(0,c.jsx)(eY.Z,{children:"Server Configuration"}),(0,c.jsx)(eY.Z,{children:"Cost Configuration"})]}),(0,c.jsxs)(eX.Z,{className:"mt-6",children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(I.Z,{form:i,onFinish:N,initialValues:s,layout:"vertical",children:[(0,c.jsx)(I.Z.Item,{label:"MCP Server Name",name:"server_name",rules:[{validator:(e,s)=>s&&s.includes("-")?Promise.reject("Server name cannot contain '-' (hyphen). Please use '_' (underscore) instead."):Promise.resolve()}],children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"Alias",name:"alias",rules:[{validator:(e,s)=>s&&s.includes("-")?Promise.reject("Alias cannot contain '-' (hyphen). Please use '_' (underscore) instead."):Promise.resolve()}],children:(0,c.jsx)(y.Z,{onChange:()=>v(!0)})}),(0,c.jsx)(I.Z.Item,{label:"Description",name:"description",children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"MCP Server URL",name:"url",rules:[{required:!0,message:"Please enter a server URL"}],children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"Transport Type",name:"transport",rules:[{required:!0}],children:(0,c.jsxs)(C.default,{children:[(0,c.jsx)(C.default.Option,{value:"sse",children:"Server-Sent Events (SSE)"}),(0,c.jsx)(C.default.Option,{value:"http",children:"HTTP"})]})}),(0,c.jsx)(I.Z.Item,{label:"Authentication",name:"auth_type",rules:[{required:!0}],children:(0,c.jsxs)(C.default,{children:[(0,c.jsx)(C.default.Option,{value:"none",children:"None"}),(0,c.jsx)(C.default.Option,{value:"api_key",children:"API Key"}),(0,c.jsx)(C.default.Option,{value:"bearer_token",children:"Bearer Token"}),(0,c.jsx)(C.default.Option,{value:"basic",children:"Basic Auth"})]})}),(0,c.jsx)(I.Z.Item,{label:"MCP Version",name:"spec_version",rules:[{required:!0}],children:(0,c.jsxs)(C.default,{children:[(0,c.jsx)(C.default.Option,{value:"2025-03-26",children:"2025-03-26 (Latest)"}),(0,c.jsx)(C.default.Option,{value:"2024-11-05",children:"2024-11-05"})]})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["MCP Access Groups",(0,c.jsx)(z.Z,{title:"Define access groups for this MCP server. Each group represents a set of permissions.",children:(0,c.jsx)(U.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"mcp_access_groups",getValueFromEvent:e=>e,children:(0,c.jsx)(C.default,{mode:"tags",style:{width:"100%"},showSearch:!0,placeholder:"Add or select access groups",tokenSeparators:[","],optionFilterProp:"value",filterOption:(e,s)=>{var t;return(null!==(t=null==s?void 0:s.value)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},onSearch:e=>j(e),options:(()=>{let e=r.map(e=>({value:e,label:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:e})]})}));return p&&!r.some(e=>e.toLowerCase().includes(p.toLowerCase()))&&e.push({value:p,label:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:p}),(0,c.jsx)("span",{className:"text-gray-400 text-xs ml-1",children:"create new group"})]})}),e})(),getPopupContainer:e=>e.parentNode})}),(0,c.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,c.jsx)(T.ZP,{onClick:l,children:"Cancel"}),(0,c.jsx)(_.Z,{type:"submit",children:"Save Changes"})]})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsx)(iO,{value:n,onChange:o,tools:m,disabled:x}),(0,c.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,c.jsx)(T.ZP,{onClick:l,children:"Cancel"}),(0,c.jsx)(_.Z,{onClick:()=>i.submit(),children:"Save Changes"})]})]})})]})]})},iD=e=>{let{costConfig:s}=e,t=(null==s?void 0:s.default_cost_per_query)!==void 0&&(null==s?void 0:s.default_cost_per_query)!==null,l=(null==s?void 0:s.tool_name_to_cost_per_query)&&Object.keys(s.tool_name_to_cost_per_query).length>0;return t||l?(0,c.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,c.jsxs)("div",{className:"space-y-4",children:[t&&(null==s?void 0:s.default_cost_per_query)!==void 0&&(null==s?void 0:s.default_cost_per_query)!==null&&(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Default Cost per Query"}),(0,c.jsxs)("div",{className:"text-green-600 font-mono",children:["$",s.default_cost_per_query.toFixed(4)]})]}),l&&(null==s?void 0:s.tool_name_to_cost_per_query)&&(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Tool-Specific Costs"}),(0,c.jsx)("div",{className:"mt-2 space-y-2",children:Object.entries(s.tool_name_to_cost_per_query).map(e=>{let[s,t]=e;return null!=t&&(0,c.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,c.jsx)(w.Z,{className:"font-medium",children:s}),(0,c.jsxs)(w.Z,{className:"text-green-600 font-mono",children:["$",t.toFixed(4)," per query"]})]},s)})})]}),(0,c.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,c.jsx)(w.Z,{className:"text-blue-800 font-medium",children:"Cost Summary:"}),(0,c.jsxs)("div",{className:"mt-2 space-y-1",children:[t&&(null==s?void 0:s.default_cost_per_query)!==void 0&&(null==s?void 0:s.default_cost_per_query)!==null&&(0,c.jsxs)(w.Z,{className:"text-blue-700",children:["• Default cost: $",s.default_cost_per_query.toFixed(4)," per query"]}),l&&(null==s?void 0:s.tool_name_to_cost_per_query)&&(0,c.jsxs)(w.Z,{className:"text-blue-700",children:["• ",Object.keys(s.tool_name_to_cost_per_query).length," tool(s) with custom pricing"]})]})]})]})}):(0,c.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,c.jsx)("div",{className:"space-y-4",children:(0,c.jsx)("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:(0,c.jsx)(w.Z,{className:"text-gray-600",children:"No cost configuration set for this server. Tool calls will be charged at $0.00 per tool call."})})})})};let iF=e=>{var s,t,l,a;let{mcpServer:r,onBack:i,isEditing:n,isProxyAdmin:o,accessToken:m,userRole:u,userID:x,availableAccessGroups:h}=e,[p,g]=(0,d.useState)(n),[j,f]=(0,d.useState)(!1),[y,b]=(0,d.useState)({}),{maskedUrl:N,hasToken:Z}=iw(r.url),S=(e,s)=>Z?s?e:N:e,C=async(e,s)=>{await eF(e)&&(b(e=>({...e,[s]:!0})),setTimeout(()=>{b(e=>({...e,[s]:!1}))},2e3))};return(0,c.jsxs)("div",{className:"p-4 max-w-full",children:[(0,c.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,c.jsxs)("div",{children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",className:"mb-4",onClick:i,children:"Back to All Servers"}),(0,c.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,c.jsx)(k.Z,{children:r.server_name}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:y["mcp-server_name"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>C(r.server_name,"mcp-server_name"),className:"left-2 z-10 transition-all duration-200 ".concat(y["mcp-server_name"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")}),r.alias&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"ml-4 text-gray-500",children:"Alias:"}),(0,c.jsx)("span",{className:"ml-1 font-mono text-blue-600",children:r.alias}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:y["mcp-alias"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>C(r.alias,"mcp-alias"),className:"left-2 z-10 transition-all duration-200 ".concat(y["mcp-alias"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),(0,c.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,c.jsx)(w.Z,{className:"text-gray-500 font-mono",children:r.server_id}),(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:y["mcp-server-id"]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>C(r.server_id,"mcp-server-id"),className:"left-2 z-10 transition-all duration-200 ".concat(y["mcp-server-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]})}),(0,c.jsxs)(eW.Z,{defaultIndex:p?2:0,children:[(0,c.jsx)(e$.Z,{className:"mb-4",children:[(0,c.jsx)(eY.Z,{children:"Overview"},"overview"),(0,c.jsx)(eY.Z,{children:"MCP Tools"},"tools"),...o?[(0,c.jsx)(eY.Z,{children:"Settings"},"settings")]:[]]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsxs)(eQ.Z,{children:[(0,c.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Transport"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)(k.Z,{children:iA(null!==(l=r.transport)&&void 0!==l?l:void 0)})})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Auth Type"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)(w.Z,{children:iE(null!==(a=r.auth_type)&&void 0!==a?a:void 0)})})]}),(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(w.Z,{children:"Host Url"}),(0,c.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,c.jsx)(w.Z,{className:"break-all overflow-wrap-anywhere",children:S(r.url,j)}),Z&&(0,c.jsx)("button",{onClick:()=>f(!j),className:"p-1 hover:bg-gray-100 rounded",children:(0,c.jsx)(sj.Z,{icon:j?iS.Z:iC.Z,size:"sm",className:"text-gray-500"})})]})]})]}),(0,c.jsxs)(W.Z,{className:"mt-2",children:[(0,c.jsx)(k.Z,{children:"Cost Configuration"}),(0,c.jsx)(iD,{costConfig:null===(s=r.mcp_info)||void 0===s?void 0:s.mcp_server_cost_info})]})]}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(nt,{serverId:r.server_id,accessToken:m,auth_type:r.auth_type,userRole:u,userID:x})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsxs)(W.Z,{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"MCP Server Settings"}),p?null:(0,c.jsx)(_.Z,{variant:"light",onClick:()=>g(!0),children:"Edit Settings"})]}),p?(0,c.jsx)(iM,{mcpServer:r,accessToken:m,onCancel:()=>g(!1),onSuccess:e=>{g(!1),i()},availableAccessGroups:h}):(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Server Name"}),(0,c.jsx)("div",{children:r.server_name})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Alias"}),(0,c.jsx)("div",{children:r.alias})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Description"}),(0,c.jsx)("div",{children:r.description})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"URL"}),(0,c.jsxs)("div",{className:"font-mono break-all overflow-wrap-anywhere max-w-full flex items-center gap-2",children:[S(r.url,j),Z&&(0,c.jsx)("button",{onClick:()=>f(!j),className:"p-1 hover:bg-gray-100 rounded",children:(0,c.jsx)(sj.Z,{icon:j?iS.Z:iC.Z,size:"sm",className:"text-gray-500"})})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Transport"}),(0,c.jsx)("div",{children:iA(r.transport)})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Auth Type"}),(0,c.jsx)("div",{children:iE(r.auth_type)})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Spec Version"}),(0,c.jsx)("div",{children:r.spec_version})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Access Groups"}),(0,c.jsx)("div",{children:r.mcp_access_groups&&r.mcp_access_groups.length>0?(0,c.jsx)("div",{className:"flex flex-wrap gap-2",children:r.mcp_access_groups.map((e,s)=>{var t;return(0,c.jsx)("span",{className:"px-2 py-1 bg-gray-100 rounded-md text-sm",children:"string"==typeof e?e:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:""},s)})}):(0,c.jsx)(w.Z,{className:"text-gray-500",children:"No access groups defined"})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Cost Configuration"}),(0,c.jsx)(iD,{costConfig:null===(t=r.mcp_info)||void 0===t?void 0:t.mcp_server_cost_info})]})]})]})})]})]})]})};var iR=t(83669);let{Panel:iq}=tx.default;var iU=e=>{let{accessToken:s,formValues:t,onToolsLoaded:l}=e,[a,r]=(0,d.useState)([]),[i,n]=(0,d.useState)(!1),[o,m]=(0,d.useState)(null),[u,x]=(0,d.useState)(!1),h=t.url&&t.transport&&t.auth_type&&s,p=async()=>{if(s&&t.url){n(!0),m(null);try{let e={server_id:t.server_id||"",server_name:t.server_name||"",url:t.url,transport:t.transport,spec_version:t.spec_version,auth_type:t.auth_type,mcp_info:t.mcp_info},a=await (0,g.testMCPToolsListRequest)(s,e);if(a.tools&&!a.error)r(a.tools),m(null),null==l||l(a.tools),a.tools.length>0&&!u&&x(!0);else{let e=a.message||"Failed to retrieve tools list";m(e),r([]),null==l||l([]),x(!1)}}catch(e){console.error("Tools fetch error:",e),m(e instanceof Error?e.message:String(e)),r([]),null==l||l([]),x(!1)}finally{n(!1)}}};return((0,d.useEffect)(()=>{h?p():(r([]),m(null),x(!1),null==l||l([]))},[t.url,t.transport,t.auth_type,t.spec_version,s]),h||t.url)?(0,c.jsx)(W.Z,{children:(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(iR.Z,{className:"text-blue-600"}),(0,c.jsx)(k.Z,{children:"Connection Status"})]}),!h&&t.url&&(0,c.jsxs)("div",{className:"text-center py-6 text-gray-400 border rounded-lg border-dashed",children:[(0,c.jsx)(a2.Z,{className:"text-2xl mb-2"}),(0,c.jsx)(w.Z,{children:"Complete required fields to test connection"}),(0,c.jsx)("br",{}),(0,c.jsx)(w.Z,{className:"text-sm",children:"Fill in URL, Transport, and Authentication to test MCP server connection"})]}),h&&(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"text-gray-700 font-medium",children:i?"Testing connection to MCP server...":a.length>0?"Connection successful":o?"Connection failed":"Ready to test connection"}),(0,c.jsx)("br",{}),(0,c.jsxs)(w.Z,{className:"text-gray-500 text-sm",children:["Server: ",t.url]})]}),i&&(0,c.jsxs)("div",{className:"flex items-center text-blue-600",children:[(0,c.jsx)(lm.Z,{size:"small",className:"mr-2"}),(0,c.jsx)(w.Z,{className:"text-blue-600",children:"Connecting..."})]}),!i&&!o&&a.length>0&&(0,c.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,c.jsx)(iR.Z,{className:"mr-1"}),(0,c.jsx)(w.Z,{className:"text-green-600 font-medium",children:"Connected"})]}),o&&(0,c.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,c.jsx)(lI.Z,{className:"mr-1"}),(0,c.jsx)(w.Z,{className:"text-red-600 font-medium",children:"Failed"})]})]}),i&&(0,c.jsxs)("div",{className:"flex items-center justify-center py-6",children:[(0,c.jsx)(lm.Z,{size:"large"}),(0,c.jsx)(w.Z,{className:"ml-3",children:"Testing connection and loading tools..."})]}),o&&(0,c.jsx)(tH.Z,{message:"Connection Failed",description:o,type:"error",showIcon:!0,action:(0,c.jsx)(T.ZP,{icon:(0,c.jsx)(s5.Z,{}),onClick:p,size:"small",children:"Retry"})}),!i&&a.length>0&&(0,c.jsx)(tx.default,{items:[{key:"1",label:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(a2.Z,{className:"mr-2 text-green-500"}),(0,c.jsx)("span",{className:"font-medium",children:"Available Tools"}),(0,c.jsx)(r$.Z,{count:a.length,style:{backgroundColor:"#52c41a",marginLeft:"8px"}})]}),children:(0,c.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:a.map((e,s)=>(0,c.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,c.jsx)(w.Z,{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,c.jsx)(w.Z,{className:"text-gray-500 text-sm block mt-1",children:e.description})]},s))})}]}),!i&&0===a.length&&!o&&(0,c.jsxs)("div",{className:"text-center py-6 text-gray-500 border rounded-lg border-dashed",children:[(0,c.jsx)(iR.Z,{className:"text-2xl mb-2 text-green-500"}),(0,c.jsx)(w.Z,{className:"text-green-600 font-medium",children:"Connection successful!"}),(0,c.jsx)("br",{}),(0,c.jsx)(w.Z,{className:"text-gray-500",children:"No tools found for this MCP server"})]})]})]})}):null},iz=e=>{let{isVisible:s}=e;return s?(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Stdio Configuration (JSON)",(0,c.jsx)(z.Z,{title:"Paste your stdio MCP server configuration in JSON format. You can use the full mcpServers structure from config.yaml or just the inner server configuration.",children:(0,c.jsx)(U.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"stdio_config",rules:[{required:!0,message:"Please enter stdio configuration"},{validator:(e,s)=>{if(!s)return Promise.resolve();try{return JSON.parse(s),Promise.resolve()}catch(e){return Promise.reject("Please enter valid JSON")}}}],children:(0,c.jsx)(L.default.TextArea,{placeholder:'{\n  "mcpServers": {\n    "circleci-mcp-server": {\n      "command": "npx",\n      "args": ["-y", "@circleci/mcp-server-circleci"],\n      "env": {\n        "CIRCLECI_TOKEN": "your-circleci-token",\n        "CIRCLECI_BASE_URL": "https://circleci.com"\n      }\n    }\n  }\n}',rows:12,className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500 font-mono text-sm"})}):null};let iV="".concat("../ui/assets/logos/","mcp_logo.png");var iK=e=>{let{userRole:s,accessToken:t,onCreateSuccess:l,isModalVisible:a,setModalVisible:r,availableAccessGroups:i}=e,[n]=I.Z.useForm(),[o,m]=(0,d.useState)(!1),[u,x]=(0,d.useState)({}),[h,p]=(0,d.useState)({}),[j,f]=(0,d.useState)(!1),[v,b]=(0,d.useState)([]),[N,Z]=(0,d.useState)("sse"),[w,k]=(0,d.useState)(""),S=async e=>{m(!0);try{let s=e.mcp_access_groups,a={};if(e.stdio_config&&"stdio"===N)try{let s=JSON.parse(e.stdio_config),t=s;if(s.mcpServers&&"object"==typeof s.mcpServers){let l=Object.keys(s.mcpServers);if(l.length>0){let a=l[0];t=s.mcpServers[a],e.server_name||(e.server_name=a.replace(/-/g,"_"))}}a={command:t.command,args:t.args,env:t.env},console.log("Parsed stdio config:",a)}catch(e){P.ZP.error("Invalid JSON in stdio configuration");return}let i={...e,...a,stdio_config:void 0,mcp_info:{server_name:e.server_name||e.url,description:e.description,mcp_server_cost_info:Object.keys(u).length>0?u:null},mcp_access_groups:s,alias:e.alias};if(console.log("Payload: ".concat(JSON.stringify(i))),null!=t){let e=await (0,g.createMCPServer)(t,i);P.ZP.success("MCP Server created successfully"),n.resetFields(),x({}),b([]),r(!1),l(e)}}catch(e){P.ZP.error("Error creating MCP Server: "+e,20)}finally{m(!1)}},E=()=>{n.resetFields(),x({}),b([]),r(!1)};return(d.useEffect(()=>{if(!j&&h.server_name){let e=h.server_name.replace(/\s+/g,"_");n.setFieldsValue({alias:e}),p(s=>({...s,alias:e}))}},[h.server_name]),(0,eE.tY)(s))?(0,c.jsx)(A.Z,{title:(0,c.jsxs)("div",{className:"flex items-center space-x-3 pb-4 border-b border-gray-100",children:[(0,c.jsx)("img",{src:iV,alt:"MCP Logo",className:"w-8 h-8 object-contain",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"}}),(0,c.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New MCP Server"})]}),open:a,width:1e3,onCancel:E,footer:null,className:"top-8",styles:{body:{padding:"24px"},header:{padding:"24px 24px 0 24px",border:"none"}},children:(0,c.jsx)("div",{className:"mt-6",children:(0,c.jsxs)(I.Z,{form:n,onFinish:S,onValuesChange:(e,s)=>p(s),layout:"vertical",className:"space-y-6",children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["MCP Server Name",(0,c.jsx)(z.Z,{title:"Best practice: Use a descriptive name that indicates the server's purpose (e.g., 'GitHub_MCP', 'Email_Service'). Hyphens '-' are not allowed; use underscores '_' instead.",children:(0,c.jsx)(U.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"server_name",rules:[{required:!1,message:"Please enter a server name"},{validator:(e,s)=>s&&s.includes("-")?Promise.reject("Server name cannot contain '-' (hyphen). Please use '_' (underscore) instead."):Promise.resolve()}],children:(0,c.jsx)(y.Z,{placeholder:"e.g., GitHub_MCP, Zapier_MCP, etc.",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Alias",(0,c.jsx)(z.Z,{title:"A short, unique identifier for this server. Defaults to the server name with spaces replaced by underscores.",children:(0,c.jsx)(U.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"alias",rules:[{required:!1},{validator:(e,s)=>s&&s.includes("-")?Promise.reject("Alias cannot contain '-' (hyphen). Please use '_' (underscore) instead."):Promise.resolve()}],children:(0,c.jsx)(y.Z,{placeholder:"e.g., GitHub_MCP, Zapier_MCP, etc.",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500",onChange:()=>f(!0)})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Description"}),name:"description",rules:[{required:!1,message:"Please enter a server description"}],children:(0,c.jsx)(y.Z,{placeholder:"Brief description of what this server does",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Transport Type"}),name:"transport",rules:[{required:!0,message:"Please select a transport type"}],children:(0,c.jsxs)(C.default,{placeholder:"Select transport",className:"rounded-lg",size:"large",onChange:e=>{Z(e),"stdio"===e?n.setFieldsValue({url:void 0,auth_type:void 0}):n.setFieldsValue({command:void 0,args:void 0,env:void 0})},value:N,children:[(0,c.jsx)(C.default.Option,{value:"http",children:"HTTP"}),(0,c.jsx)(C.default.Option,{value:"sse",children:"Server-Sent Events (SSE)"}),(0,c.jsx)(C.default.Option,{value:"stdio",children:"Standard Input/Output (stdio)"})]})}),"stdio"!==N&&(0,c.jsx)(I.Z.Item,{label:(0,c.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"MCP Server URL"}),name:"url",rules:[{required:!0,message:"Please enter a server URL"},{type:"url",message:"Please enter a valid URL"}],children:(0,c.jsx)(y.Z,{placeholder:"https://your-mcp-server.com",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),"stdio"!==N&&(0,c.jsx)(I.Z.Item,{label:(0,c.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Authentication"}),name:"auth_type",rules:[{required:!0,message:"Please select an auth type"}],children:(0,c.jsxs)(C.default,{placeholder:"Select auth type",className:"rounded-lg",size:"large",children:[(0,c.jsx)(C.default.Option,{value:"none",children:"None"}),(0,c.jsx)(C.default.Option,{value:"api_key",children:"API Key"}),(0,c.jsx)(C.default.Option,{value:"bearer_token",children:"Bearer Token"}),(0,c.jsx)(C.default.Option,{value:"basic",children:"Basic Auth"})]})}),(0,c.jsx)(iz,{isVisible:"stdio"===N}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["MCP Version",(0,c.jsx)(z.Z,{title:"Select the MCP specification version your server supports",children:(0,c.jsx)(U.Z,{className:"ml-2 text-gray-400 hover:text-gray-600"})})]}),name:"spec_version",rules:[{required:!0,message:"Please select a spec version"}],children:(0,c.jsxs)(C.default,{placeholder:"Select MCP version",className:"rounded-lg",size:"large",children:[(0,c.jsx)(C.default.Option,{value:"2025-03-26",children:"2025-03-26 (Latest)"}),(0,c.jsx)(C.default.Option,{value:"2024-11-05",children:"2024-11-05"})]})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["MCP Access Groups",(0,c.jsx)(z.Z,{title:"Specify access groups for this MCP server. Users must be in at least one of these groups to access the server.",children:(0,c.jsx)(U.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"mcp_access_groups",className:"mb-4",children:(0,c.jsx)(C.default,{mode:"tags",showSearch:!0,placeholder:"Select existing groups or type to create new ones",optionFilterProp:"value",filterOption:(e,s)=>{var t;return(null!==(t=null==s?void 0:s.value)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},onSearch:e=>k(e),tokenSeparators:[","],options:(()=>{let e=i.map(e=>({value:e,label:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:e})]})}));return w&&!i.some(e=>e.toLowerCase().includes(w.toLowerCase()))&&e.push({value:w,label:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:w}),(0,c.jsx)("span",{className:"text-gray-400 text-xs ml-1",children:"create new group"})]})}),e})(),maxTagCount:"responsive",allowClear:!0})})]}),(0,c.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,c.jsx)(iU,{accessToken:t,formValues:h,onToolsLoaded:b})}),(0,c.jsx)("div",{className:"mt-6",children:(0,c.jsx)(iO,{value:u,onChange:x,tools:v,disabled:!1})}),(0,c.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-100",children:[(0,c.jsx)(_.Z,{variant:"secondary",onClick:E,children:"Cancel"}),(0,c.jsx)(_.Z,{variant:"primary",loading:o,children:o?"Creating...":"Add MCP Server"})]})]})})}):null},iB=t(64935),iG=t(11239),iH=t(54001),iJ=t(96137),iY=t(96362),iW=t(80221),i$=t(29202);let{Title:iQ,Text:iX}=em.default,{Panel:i0}=tx.default,i1=e=>{let{icon:s,title:t,description:l,children:a,serverName:r,accessGroups:i=["dev"]}=e,[n,o]=(0,d.useState)(!1),m=()=>{let e={"x-litellm-api-key":"Bearer YOUR_LITELLM_API_KEY"};if(n&&r){let s=[r.replace(/\s+/g,"_"),...i].join(",");e["x-mcp-servers"]=[s]}return e};return(0,c.jsxs)(th.Z,{className:"border border-gray-200",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,c.jsx)("span",{className:"p-2 rounded-lg bg-gray-50",children:s}),(0,c.jsxs)("div",{children:[(0,c.jsx)(iQ,{level:5,className:"mb-0",children:t}),(0,c.jsx)(iX,{className:"text-gray-600",children:l})]})]}),r&&("Implementation Example"===t||"Configuration"===t)&&(0,c.jsxs)(I.Z.Item,{className:"mb-4",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,c.jsx)(tn.Z,{size:"small",checked:n,onChange:o}),(0,c.jsxs)(iX,{className:"text-sm",children:["Limit tools to specific MCP servers or MCP groups by passing the ",(0,c.jsx)("code",{children:"x-mcp-servers"})," header"]})]}),n&&(0,c.jsx)(tH.Z,{className:"mt-2",type:"info",showIcon:!0,message:"Two Options",description:(0,c.jsxs)("div",{children:[(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Option 1:"})," Get a specific server: ",(0,c.jsxs)("code",{children:['["',r.replace(/\s+/g,"_"),'"]']})]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Option 2:"})," Get a group of MCPs: ",(0,c.jsx)("code",{children:'["dev-group"]'})]}),(0,c.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["You can also mix both: ",(0,c.jsx)("code",{children:'["Server1,dev-group"]'})]})]})})]}),d.Children.map(a,e=>{if(d.isValidElement(e)&&e.props.hasOwnProperty("code")&&e.props.hasOwnProperty("copyKey")){let s=e.props.code;if(s&&s.includes('"headers":'))return d.cloneElement(e,{code:s.replace(/"headers":\s*{[^}]*}/,'"headers": '.concat(JSON.stringify(m(),null,8)))})}return e})]})};var i2=e=>{let{currentServerAccessGroups:s=[]}=e,t=(0,g.getProxyBaseUrl)(),[l,a]=(0,d.useState)({}),[r,i]=(0,d.useState)({openai:[],litellm:[],cursor:[],http:[]}),[n]=(0,d.useState)("Zapier_MCP"),o=async(e,s)=>{await eF(e)&&(a(e=>({...e,[s]:!0})),setTimeout(()=>{a(e=>({...e,[s]:!1}))},2e3))},m=e=>{let{code:s,copyKey:t,title:a,className:r=""}=e;return(0,c.jsxs)("div",{className:"relative group",children:[a&&(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,c.jsx)(iB.Z,{size:16,className:"text-blue-600"}),(0,c.jsx)(iX,{strong:!0,className:"text-gray-700",children:a})]}),(0,c.jsxs)(th.Z,{className:"bg-gray-50 border border-gray-200 relative ".concat(r),children:[(0,c.jsx)(T.ZP,{type:"text",size:"small",icon:l[t]?(0,c.jsx)(sr.Z,{size:12}):(0,c.jsx)(si.Z,{size:12}),onClick:()=>o(s,t),className:"absolute top-2 right-2 z-10 transition-all duration-200 ".concat(l[t]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")}),(0,c.jsx)("pre",{className:"text-sm overflow-x-auto pr-10 text-gray-800 font-mono leading-relaxed",children:s})]})]})},u=e=>{let{step:s,title:t,children:l}=e;return(0,c.jsxs)("div",{className:"flex gap-4",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:s})}),(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)(iX,{strong:!0,className:"text-gray-800 block mb-2",children:t}),l]})]})};return(0,c.jsx)("div",{children:(0,c.jsxs)(tY.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(k.Z,{className:"text-3xl font-bold text-gray-900 mb-3",children:"Connect to your MCP client"}),(0,c.jsx)(w.Z,{className:"text-lg text-gray-600",children:"Use tools directly from any MCP client with LiteLLM MCP. Enable your AI assistant to perform real-world tasks through a simple, secure connection."})]}),(0,c.jsxs)(eW.Z,{className:"w-full",children:[(0,c.jsx)(e$.Z,{className:"flex justify-start mt-8 mb-6",children:(0,c.jsxs)("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[(0,c.jsx)(eY.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,c.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,c.jsx)(iB.Z,{size:18}),"OpenAI API"]})}),(0,c.jsx)(eY.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,c.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,c.jsx)(iG.Z,{size:18}),"LiteLLM Proxy"]})}),(0,c.jsx)(eY.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,c.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,c.jsx)(iW.Z,{size:18}),"Cursor"]})}),(0,c.jsx)(eY.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,c.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,c.jsx)(i$.Z,{size:18}),"Streamable HTTP"]})})]})}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{className:"mt-6",children:(0,c.jsx)(()=>(0,c.jsxs)(tY.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,c.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-100",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,c.jsx)(iB.Z,{className:"text-blue-600",size:24}),(0,c.jsx)(iQ,{level:4,className:"mb-0 text-blue-900",children:"OpenAI Responses API Integration"})]}),(0,c.jsx)(iX,{className:"text-blue-700",children:"Connect OpenAI Responses API to your LiteLLM MCP server for seamless tool integration"})]}),(0,c.jsxs)(tY.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,c.jsx)(i1,{icon:(0,c.jsx)(iH.Z,{className:"text-blue-600",size:16}),title:"API Key Setup",description:"Configure your OpenAI API key for authentication",children:(0,c.jsxs)(tY.Z,{direction:"vertical",size:"middle",className:"w-full",children:[(0,c.jsx)("div",{children:(0,c.jsxs)(iX,{children:["Get your API key from the"," ",(0,c.jsxs)("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["OpenAI platform ",(0,c.jsx)(iY.Z,{size:12})]})]})}),(0,c.jsx)(m,{title:"Environment Variable",code:'export OPENAI_API_KEY="sk-..."',copyKey:"openai-env"})]})}),(0,c.jsx)(i1,{icon:(0,c.jsx)(iJ.Z,{className:"text-blue-600",size:16}),title:"MCP Server Information",description:"Connection details for your LiteLLM MCP server",children:(0,c.jsx)(m,{title:"Server URL",code:"".concat(t,"/mcp"),copyKey:"openai-server-url"})}),(0,c.jsx)(i1,{icon:(0,c.jsx)(iB.Z,{className:"text-blue-600",size:16}),title:"Implementation Example",description:"Complete cURL example for using the Responses API",serverName:"Zapier Gmail",accessGroups:["dev"],children:(0,c.jsx)(m,{code:'curl --location \'https://api.openai.com/v1/responses\' \\\n--header \'Content-Type: application/json\' \\\n--header "Authorization: Bearer $OPENAI_API_KEY" \\\n--data \'{\n    "model": "gpt-4.1",\n    "tools": [\n        {\n            "type": "mcp",\n            "server_label": "litellm",\n            "server_url": "'.concat(t,'/mcp",\n            "require_approval": "never",\n            "headers": {\n                "x-litellm-api-key": "Bearer YOUR_LITELLM_API_KEY",\n                "x-mcp-servers": ["Zapier_MCP,dev"]\n            }\n        }\n    ],\n    "input": "Run available tools",\n    "tool_choice": "required"\n}\''),copyKey:"openai-curl",className:"text-xs"})})]})]}),{})}),(0,c.jsx)(eQ.Z,{className:"mt-6",children:(0,c.jsx)(()=>(0,c.jsxs)(tY.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,c.jsxs)("div",{className:"bg-gradient-to-r from-emerald-50 to-green-50 p-6 rounded-lg border border-emerald-100",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,c.jsx)(iG.Z,{className:"text-emerald-600",size:24}),(0,c.jsx)(iQ,{level:4,className:"mb-0 text-emerald-900",children:"LiteLLM Proxy API Integration"})]}),(0,c.jsx)(iX,{className:"text-emerald-700",children:"Connect to LiteLLM Proxy Responses API for seamless tool integration with multiple model providers"})]}),(0,c.jsxs)(tY.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,c.jsx)(i1,{icon:(0,c.jsx)(iH.Z,{className:"text-emerald-600",size:16}),title:"API Key Setup",description:"Configure your LiteLLM Proxy API key for authentication",children:(0,c.jsxs)(tY.Z,{direction:"vertical",size:"middle",className:"w-full",children:[(0,c.jsx)("div",{children:(0,c.jsx)(iX,{children:"Get your API key from your LiteLLM Proxy dashboard or contact your administrator"})}),(0,c.jsx)(m,{title:"Environment Variable",code:'export LITELLM_API_KEY="sk-..."',copyKey:"litellm-env"})]})}),(0,c.jsx)(i1,{icon:(0,c.jsx)(iJ.Z,{className:"text-emerald-600",size:16}),title:"MCP Server Information",description:"Connection details for your LiteLLM MCP server",children:(0,c.jsx)(m,{title:"Server URL",code:"".concat(t,"/mcp"),copyKey:"litellm-server-url"})}),(0,c.jsx)(i1,{icon:(0,c.jsx)(iB.Z,{className:"text-emerald-600",size:16}),title:"Implementation Example",description:"Complete cURL example for using the LiteLLM Proxy Responses API",serverName:n,accessGroups:["dev"],children:(0,c.jsx)(m,{code:"curl --location '".concat(t,'/v1/responses\' \\\n--header \'Content-Type: application/json\' \\\n--header "Authorization: Bearer $LITELLM_API_KEY" \\\n--data \'{\n    "model": "gpt-4",\n    "tools": [\n        {\n            "type": "mcp",\n            "server_label": "litellm",\n            "server_url": "').concat(t,'/mcp",\n            "require_approval": "never",\n            "headers": {\n                "x-litellm-api-key": "Bearer YOUR_LITELLM_API_KEY",\n                "x-mcp-servers": ["Zapier_MCP,dev"]\n            }\n        }\n    ],\n    "input": "Run available tools",\n    "tool_choice": "required"\n}\''),copyKey:"litellm-curl",className:"text-xs"})})]})]}),{})}),(0,c.jsx)(eQ.Z,{className:"mt-6",children:(0,c.jsx)(()=>(0,c.jsxs)(tY.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,c.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-lg border border-purple-100",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,c.jsx)(iW.Z,{className:"text-purple-600",size:24}),(0,c.jsx)(iQ,{level:4,className:"mb-0 text-purple-900",children:"Cursor IDE Integration"})]}),(0,c.jsx)(iX,{className:"text-purple-700",children:"Use tools directly from Cursor IDE with LiteLLM MCP. Enable your AI assistant to perform real-world tasks without leaving your coding environment."})]}),(0,c.jsxs)(th.Z,{className:"border border-gray-200",children:[(0,c.jsx)(iQ,{level:5,className:"mb-4 text-gray-800",children:"Setup Instructions"}),(0,c.jsxs)(tY.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,c.jsx)(u,{step:1,title:"Open Cursor Settings",children:(0,c.jsxs)(iX,{className:"text-gray-600",children:["Use the keyboard shortcut ",(0,c.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"⇧+⌘+J"})," (Mac) or ",(0,c.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Ctrl+Shift+J"})," (Windows/Linux)"]})}),(0,c.jsx)(u,{step:2,title:"Navigate to MCP Tools",children:(0,c.jsx)(iX,{className:"text-gray-600",children:'Go to the "MCP Tools" tab and click "New MCP Server"'})}),(0,c.jsxs)(u,{step:3,title:"Add Configuration",children:[(0,c.jsxs)(iX,{className:"text-gray-600 mb-3",children:["Copy the JSON configuration below and paste it into Cursor, then save with ",(0,c.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Cmd+S"})," or ",(0,c.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Ctrl+S"})]}),(0,c.jsx)(i1,{icon:(0,c.jsx)(iB.Z,{className:"text-purple-600",size:16}),title:"Configuration",description:"Cursor MCP configuration",serverName:"Zapier Gmail",accessGroups:["dev"],children:(0,c.jsx)(m,{code:'{\n  "mcpServers": {\n    "Zapier_MCP": {\n      "server_url": "'.concat(t,'/mcp",\n      "headers": {\n        "x-litellm-api-key": "Bearer YOUR_LITELLM_API_KEY",\n        "x-mcp-servers": ["Zapier_MCP,dev"]\n      }\n    }\n  }\n}'),copyKey:"cursor-config",className:"text-xs"})})]})]})]})]}),{})}),(0,c.jsx)(eQ.Z,{className:"mt-6",children:(0,c.jsx)(()=>(0,c.jsxs)(tY.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,c.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-teal-50 p-6 rounded-lg border border-green-100",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,c.jsx)(i$.Z,{className:"text-green-600",size:24}),(0,c.jsx)(iQ,{level:4,className:"mb-0 text-green-900",children:"Streamable HTTP Transport"})]}),(0,c.jsx)(iX,{className:"text-green-700",children:"Connect to LiteLLM MCP using HTTP transport. Compatible with any MCP client that supports HTTP streaming."})]}),(0,c.jsx)(i1,{icon:(0,c.jsx)(i$.Z,{className:"text-green-600",size:16}),title:"Universal MCP Connection",description:"Use this URL with any MCP client that supports HTTP transport",children:(0,c.jsxs)(tY.Z,{direction:"vertical",size:"middle",className:"w-full",children:[(0,c.jsx)("div",{children:(0,c.jsx)(iX,{children:"Each MCP client supports different transports. Refer to your client documentation to determine the appropriate transport method."})}),(0,c.jsx)(m,{title:"Server URL",code:"".concat(t,"/mcp"),copyKey:"http-server-url"}),(0,c.jsx)(m,{title:"Headers Configuration",code:JSON.stringify({"x-litellm-api-key":"Bearer YOUR_LITELLM_API_KEY"},null,2),copyKey:"http-headers"}),(0,c.jsx)("div",{className:"mt-4",children:(0,c.jsx)(T.ZP,{type:"link",className:"p-0 h-auto text-blue-600 hover:text-blue-700",href:"https://modelcontextprotocol.io/docs/concepts/transports",icon:(0,c.jsx)(iY.Z,{size:14}),children:"Learn more about MCP transports"})})]})})]}),{})})]})]})]})})},i4=t(67187);let{Option:i5}=C.default,i6=e=>{let{isModalOpen:s,title:t,confirmDelete:l,cancelDelete:a}=e;return s?(0,c.jsx)(A.Z,{open:s,onOk:l,okType:"danger",onCancel:a,children:(0,c.jsxs)(v.Z,{numItems:1,className:"gap-2 w-full",children:[(0,c.jsx)(k.Z,{children:t}),(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsx)("p",{children:"Are you sure you want to delete this MCP Server?"})})]})}):null};var i3=e=>{let{accessToken:s,userRole:t,userID:l}=e,{data:a,isLoading:r,refetch:i}=(0,sd.a)({queryKey:["mcpServers"],queryFn:()=>{if(!s)throw Error("Access Token required");return(0,g.fetchMCPServers)(s)},enabled:!!s}),[n,o]=(0,d.useState)(null),[m,u]=(0,d.useState)(!1),[x,h]=(0,d.useState)(null),[p,j]=(0,d.useState)(!1),[f,v]=(0,d.useState)("all"),[y,b]=(0,d.useState)("all"),[N,Z]=(0,d.useState)([]),[S,I]=(0,d.useState)(!1),A="Internal User"===t,E=d.useMemo(()=>{if(!a)return[];let e=new Set,s=[];return a.forEach(t=>{t.teams&&t.teams.forEach(t=>{let l=t.team_id;e.has(l)||(e.add(l),s.push(t))})}),s},[a]),T=d.useMemo(()=>a?Array.from(new Set(a.flatMap(e=>e.mcp_access_groups).filter(e=>null!=e))):[],[a]),L=e=>{v(e),M(e,y)},O=e=>{b(e),M(f,e)},M=(e,s)=>{if(!a)return Z([]);let t=a;if("personal"===e){Z([]);return}"all"!==e&&(t=t.filter(s=>{var t;return null===(t=s.teams)||void 0===t?void 0:t.some(s=>s.team_id===e)})),"all"!==s&&(t=t.filter(e=>{var t;return null===(t=e.mcp_access_groups)||void 0===t?void 0:t.some(e=>"string"==typeof e?e===s:e&&e.name===s)})),Z(t)};(0,d.useEffect)(()=>{M(f,y)},[a]);let D=d.useMemo(()=>ik(null!=t?t:"",e=>{h(e),j(!1)},e=>{h(e),j(!0)},F),[t]);function F(e){o(e),u(!0)}let R=async()=>{if(null!=n&&null!=s){try{await (0,g.deleteMCPServer)(s,n),P.ZP.success("Deleted MCP Server successfully"),i()}catch(e){console.error("Error deleting the mcp server:",e)}u(!1),o(null)}};return s&&t&&l?(0,c.jsxs)("div",{className:"w-full h-full p-6",children:[(0,c.jsx)(i6,{isModalOpen:m,title:"Delete MCP Server",confirmDelete:R,cancelDelete:()=>{u(!1),o(null)}}),(0,c.jsx)(iK,{userRole:t,accessToken:s,onCreateSuccess:e=>{Z(s=>[...s,e]),I(!1)},isModalVisible:S,setModalVisible:I,availableAccessGroups:T}),(0,c.jsx)(k.Z,{children:"MCP Servers"}),(0,c.jsx)(w.Z,{className:"text-tremor-content mt-2",children:"Configure and manage your MCP servers"}),(0,eE.tY)(t)&&(0,c.jsx)(_.Z,{className:"mt-4 mb-4",onClick:()=>I(!0),children:"+ Add New MCP Server"}),(0,c.jsxs)(eW.Z,{className:"w-full h-full",children:[(0,c.jsx)(e$.Z,{className:"flex justify-between mt-2 w-full items-center",children:(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)(eY.Z,{children:"All Servers"}),(0,c.jsx)(eY.Z,{children:"Connect"})]})}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(()=>x?(0,c.jsx)(iF,{mcpServer:N.find(e=>e.server_id===x)||{server_id:"",server_name:"",alias:"",url:"",transport:"",spec_version:"",auth_type:"",created_at:"",created_by:"",updated_at:"",updated_by:""},onBack:()=>{j(!1),h(null),i()},isProxyAdmin:(0,eE.tY)(t),isEditing:p,accessToken:s,userID:l,userRole:t,availableAccessGroups:T}):(0,c.jsxs)("div",{className:"w-full h-full",children:[(0,c.jsx)("div",{className:"w-full px-6",children:(0,c.jsx)("div",{className:"flex flex-col space-y-4",children:(0,c.jsx)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-4 border-2 border-gray-200",children:(0,c.jsxs)("div",{className:"flex items-center gap-4",children:[(0,c.jsx)(w.Z,{className:"text-lg font-semibold text-gray-900",children:"Current Team:"}),(0,c.jsxs)(C.default,{value:f,onChange:L,style:{width:300},children:[(0,c.jsx)(i5,{value:"all",children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:A?"All Available Servers":"All Servers"})]})}),(0,c.jsx)(i5,{value:"personal",children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:"Personal"})]})}),E.map(e=>(0,c.jsx)(i5,{value:e.team_id,children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:e.team_alias||e.team_id})]})},e.team_id))]}),(0,c.jsxs)(w.Z,{className:"text-lg font-semibold text-gray-900 ml-6",children:["Access Group:",(0,c.jsx)(z.Z,{title:"An MCP Access Group is a set of users or teams that have permission to access specific MCP servers. Use access groups to control and organize who can connect to which servers.",children:(0,c.jsx)(i4.Z,{style:{marginLeft:4,color:"#888"}})})]}),(0,c.jsxs)(C.default,{value:y,onChange:O,style:{width:300},children:[(0,c.jsx)(i5,{value:"all",children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:"All Access Groups"})]})}),T.map(e=>(0,c.jsx)(i5,{value:e,children:(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,c.jsx)("span",{className:"font-medium",children:e})]})},e))]})]})})})}),(0,c.jsx)("div",{className:"w-full px-6 mt-6",children:(0,c.jsx)(t3,{data:N,columns:D,renderSubComponent:()=>(0,c.jsx)("div",{}),getRowCanExpand:()=>!1,isLoading:r,noDataMessage:"No MCP servers configured"})})]}),{})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(i2,{})})]})]})]}):(console.log("Missing required authentication parameters",{accessToken:s,userRole:t,userID:l}),(0,c.jsx)("div",{className:"p-6 text-center text-gray-500",children:"Missing required authentication parameters."}))},i8=t(21770);function i7(e){let{tool:s,needsAuth:t,authValue:l,onSubmit:a,isLoading:r,result:i,error:n,onClose:o}=e,[m]=I.Z.useForm(),[u,x]=d.useState("formatted"),[h,p]=d.useState(null),[g,j]=d.useState(null),f=d.useMemo(()=>"string"==typeof s.inputSchema?{type:"object",properties:{input:{type:"string",description:"Input for this tool"}},required:["input"]}:s.inputSchema,[s.inputSchema]),v=d.useMemo(()=>f.properties&&f.properties.params&&"object"===f.properties.params.type&&f.properties.params.properties?{type:"object",properties:f.properties.params.properties,required:f.properties.params.required||[]}:f,[f]);d.useEffect(()=>{h&&(i||n)&&j(Date.now()-h)},[i,n,h]);let b=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select();let t=document.execCommand("copy");if(document.body.removeChild(s),!t)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}},N=async()=>{await b(JSON.stringify(i,null,2))?P.ZP.success("Result copied to clipboard"):P.ZP.error("Failed to copy result")},Z=async()=>{await b(s.name)?P.ZP.success("Tool name copied to clipboard"):P.ZP.error("Failed to copy tool name")};return(0,c.jsxs)("div",{className:"space-y-4 h-full",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between pb-3 border-b border-gray-200",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-3",children:[s.mcp_info.logo_url&&(0,c.jsx)("img",{src:s.mcp_info.logo_url,alt:"".concat(s.mcp_info.server_name," logo"),className:"w-6 h-6 object-contain"}),(0,c.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,c.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Test Tool:"}),(0,c.jsxs)("div",{className:"group inline-flex items-center space-x-1 bg-slate-50 hover:bg-slate-100 px-3 py-1 rounded-md cursor-pointer transition-colors border border-slate-200",onClick:Z,title:"Click to copy tool name",children:[(0,c.jsx)("span",{className:"font-mono text-slate-700 font-medium text-sm",children:s.name}),(0,c.jsx)("svg",{className:"w-3 h-3 text-slate-400 group-hover:text-slate-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})]})]}),(0,c.jsx)("p",{className:"text-xs text-gray-600",children:s.description}),(0,c.jsxs)("p",{className:"text-xs text-gray-500",children:["Provider: ",s.mcp_info.server_name]})]})]}),(0,c.jsx)(_.Z,{onClick:o,variant:"light",size:"sm",className:"text-gray-500 hover:text-gray-700",children:(0,c.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4 h-full",children:[(0,c.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg",children:[(0,c.jsx)("div",{className:"border-b border-gray-100 px-4 py-2",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Input Parameters"}),(0,c.jsx)(z.Z,{title:"Configure the input parameters for this tool call",children:(0,c.jsx)(U.Z,{className:"text-gray-400 hover:text-gray-600"})})]})}),(0,c.jsx)("div",{className:"p-4",children:(0,c.jsxs)(I.Z,{form:m,onFinish:e=>{p(Date.now()),j(null);let s={};Object.entries(e).forEach(e=>{var t;let[l,a]=e,r=null===(t=v.properties)||void 0===t?void 0:t[l];if(r&&null!=a&&""!==a)switch(r.type){case"boolean":s[l]="true"===a||!0===a;break;case"number":s[l]=Number(a);break;case"string":s[l]=String(a);break;default:s[l]=a}else null!=a&&""!==a&&(s[l]=a)}),a(f.properties&&f.properties.params&&"object"===f.properties.params.type&&f.properties.params.properties?{params:s}:s)},layout:"vertical",className:"space-y-3",children:["string"==typeof s.inputSchema?(0,c.jsx)("div",{className:"space-y-3",children:(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Input ",(0,c.jsx)("span",{className:"text-red-500",children:"*"})]}),name:"input",rules:[{required:!0,message:"Please enter input for this tool"}],className:"mb-3",children:(0,c.jsx)(y.Z,{placeholder:"Enter input for this tool",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})})}):void 0===v.properties?(0,c.jsx)("div",{className:"text-center py-6 bg-gray-50 rounded-lg border border-gray-200",children:(0,c.jsxs)("div",{className:"max-w-sm mx-auto",children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"No Parameters Required"}),(0,c.jsx)("p",{className:"text-xs text-gray-500",children:"This tool can be called without any input parameters."})]})}):(0,c.jsx)("div",{className:"space-y-3",children:Object.entries(v.properties).map(e=>{var s,t,l,a,r;let[i,n]=e;return(0,c.jsxs)(I.Z.Item,{label:(0,c.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:[i," ",(null===(s=v.required)||void 0===s?void 0:s.includes(i))&&(0,c.jsx)("span",{className:"text-red-500",children:"*"}),n.description&&(0,c.jsx)(z.Z,{title:n.description,children:(0,c.jsx)(U.Z,{className:"ml-2 text-gray-400 hover:text-gray-600"})})]}),name:i,rules:[{required:null===(t=v.required)||void 0===t?void 0:t.includes(i),message:"Please enter ".concat(i)}],className:"mb-3",children:["string"===n.type&&n.enum&&(0,c.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors",defaultValue:n.default,children:[!(null===(l=v.required)||void 0===l?void 0:l.includes(i))&&(0,c.jsxs)("option",{value:"",children:["Select ",i]}),n.enum.map(e=>(0,c.jsx)("option",{value:e,children:e},e))]}),"string"===n.type&&!n.enum&&(0,c.jsx)(y.Z,{placeholder:n.description||"Enter ".concat(i),className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"}),"number"===n.type&&(0,c.jsx)("input",{type:"number",placeholder:n.description||"Enter ".concat(i),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors"}),"boolean"===n.type&&(0,c.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors",defaultValue:(null===(a=n.default)||void 0===a?void 0:a.toString())||"",children:[!(null===(r=v.required)||void 0===r?void 0:r.includes(i))&&(0,c.jsxs)("option",{value:"",children:["Select ",i]}),(0,c.jsx)("option",{value:"true",children:"True"}),(0,c.jsx)("option",{value:"false",children:"False"})]})]},i)})}),(0,c.jsx)("div",{className:"pt-3 border-t border-gray-100",children:(0,c.jsx)(_.Z,{onClick:()=>m.submit(),disabled:r,variant:"primary",className:"w-full",loading:r,children:r?"Calling Tool...":i||n?"Call Again":"Call Tool"})})]})})]}),(0,c.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg",children:[(0,c.jsx)("div",{className:"border-b border-gray-100 px-4 py-2",children:(0,c.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Tool Result"})}),(0,c.jsx)("div",{className:"p-4",children:i||n||r?(0,c.jsxs)("div",{className:"space-y-3",children:[i&&!r&&!n&&(0,c.jsx)("div",{className:"p-2 bg-green-50 border border-green-200 rounded-lg",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("svg",{className:"h-4 w-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,c.jsx)("h4",{className:"text-xs font-medium text-green-900",children:"Tool executed successfully"}),null!==g&&(0,c.jsxs)("span",{className:"text-xs text-green-600 ml-1",children:["• ",(g/1e3).toFixed(2),"s"]})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,c.jsxs)("div",{className:"flex bg-white rounded border border-green-300 p-0.5",children:[(0,c.jsx)("button",{onClick:()=>x("formatted"),className:"px-2 py-1 text-xs font-medium rounded transition-colors ".concat("formatted"===u?"bg-green-100 text-green-800":"text-green-600 hover:text-green-800"),children:"Formatted"}),(0,c.jsx)("button",{onClick:()=>x("json"),className:"px-2 py-1 text-xs font-medium rounded transition-colors ".concat("json"===u?"bg-green-100 text-green-800":"text-green-600 hover:text-green-800"),children:"JSON"})]}),(0,c.jsx)("button",{onClick:N,className:"p-1 hover:bg-green-100 rounded text-green-700",title:"Copy response",children:(0,c.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,c.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,c.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]})]})}),(0,c.jsxs)("div",{className:"max-h-96 overflow-y-auto",children:[r&&(0,c.jsxs)("div",{className:"flex flex-col justify-center items-center h-48 text-gray-500",children:[(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200"}),(0,c.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-600 border-t-transparent absolute top-0"})]}),(0,c.jsx)("p",{className:"text-sm font-medium mt-3",children:"Calling tool..."}),(0,c.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Please wait while we process your request"})]}),n&&(0,c.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,c.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)("svg",{className:"h-4 w-4 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,c.jsx)("h4",{className:"text-xs font-medium text-red-900",children:"Tool Call Failed"}),null!==g&&(0,c.jsxs)("span",{className:"text-xs text-red-600",children:["• ",(g/1e3).toFixed(2),"s"]})]}),(0,c.jsx)("div",{className:"bg-white border border-red-200 rounded p-2 max-h-48 overflow-y-auto",children:(0,c.jsx)("pre",{className:"text-xs whitespace-pre-wrap text-red-700 font-mono",children:n.message})})]})]})}),i&&!r&&!n&&(0,c.jsx)("div",{className:"space-y-3",children:"formatted"===u?i.map((e,s)=>(0,c.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:["text"===e.type&&(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"bg-gray-50 px-3 py-1 border-b border-gray-200",children:(0,c.jsx)("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Text Response"})}),(0,c.jsx)("div",{className:"p-3",children:(0,c.jsx)("div",{className:"bg-white rounded border border-gray-200 max-h-64 overflow-y-auto",children:(0,c.jsx)("div",{className:"p-3 space-y-2",children:e.text.split("\n\n").map((e,s)=>{if(""===e.trim())return null;if(e.startsWith("##")){let t=e.replace(/^#+\s/,"");return(0,c.jsx)("div",{className:"border-b border-gray-200 pb-1 mb-2",children:(0,c.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:t})},s)}let t=/(https?:\/\/[^\s\)]+)/g;if(t.test(e)){let l=e.split(t);return(0,c.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded p-2",children:(0,c.jsx)("div",{className:"text-xs text-gray-700 leading-relaxed whitespace-pre-wrap",children:l.map((e,s)=>t.test(e)?(0,c.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline break-all",children:e},s):e)})},s)}return e.includes("Score:")?(0,c.jsx)("div",{className:"bg-green-50 border-l-4 border-green-400 p-2 rounded-r",children:(0,c.jsx)("p",{className:"text-xs text-green-800 font-medium whitespace-pre-wrap",children:e})},s):(0,c.jsx)("div",{className:"bg-gray-50 rounded p-2 border border-gray-200",children:(0,c.jsx)("div",{className:"text-xs text-gray-700 leading-relaxed whitespace-pre-wrap font-mono",children:e})},s)}).filter(Boolean)})})})]}),"image"===e.type&&e.url&&(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"bg-gray-50 px-3 py-1 border-b border-gray-200",children:(0,c.jsx)("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Image Response"})}),(0,c.jsx)("div",{className:"p-3",children:(0,c.jsx)("div",{className:"bg-gray-50 rounded p-3 border border-gray-200",children:(0,c.jsx)("img",{src:e.url,alt:"Tool result",className:"max-w-full h-auto rounded shadow-sm"})})})]}),"embedded_resource"===e.type&&(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"bg-gray-50 px-3 py-1 border-b border-gray-200",children:(0,c.jsx)("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Embedded Resource"})}),(0,c.jsx)("div",{className:"p-3",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2 p-3 bg-blue-50 border border-blue-200 rounded",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)("svg",{className:"h-5 w-5 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("p",{className:"text-xs font-medium text-blue-900",children:["Resource Type: ",e.resource_type]}),e.url&&(0,c.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-blue-600 hover:text-blue-800 hover:underline mt-1 transition-colors",children:["View Resource",(0,c.jsxs)("svg",{className:"ml-1 h-3 w-3",fill:"currentColor",viewBox:"0 0 20 20",children:[(0,c.jsx)("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),(0,c.jsx)("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]})]})]})]})})]})]},s)):(0,c.jsx)("div",{className:"bg-white rounded border border-gray-200",children:(0,c.jsx)("div",{className:"p-3 overflow-auto max-h-80 bg-gray-50",children:(0,c.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all text-gray-800",children:JSON.stringify(i,null,2)})})})})]})]}):(0,c.jsx)("div",{className:"flex flex-col justify-center items-center h-48 text-gray-500",children:(0,c.jsxs)("div",{className:"text-center max-w-sm",children:[(0,c.jsx)("div",{className:"mb-3",children:(0,c.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Ready to Call Tool"}),(0,c.jsx)("p",{className:"text-xs text-gray-500 leading-relaxed",children:'Configure the input parameters and click "Call Tool" to see the results here.'})]})})})]})]})]})}var i9=t(36724);let ne=e=>{let s,{visible:t,onOk:l,onCancel:a,authType:r}=e,[i]=I.Z.useForm();if(r===iI.API_KEY||r===iI.BEARER_TOKEN){let e=r===iI.API_KEY?"API Key":"Bearer Token";s=(0,c.jsx)(I.Z.Item,{name:"authValue",label:e,rules:[{required:!0,message:"Please input your ".concat(e)}],children:(0,c.jsx)(L.default.Password,{})})}else r===iI.BASIC&&(s=(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please input your username"}],children:(0,c.jsx)(L.default,{})}),(0,c.jsx)(I.Z.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please input your password"}],children:(0,c.jsx)(L.default.Password,{})})]}));return(0,c.jsx)(A.Z,{open:t,title:"Authentication",onOk:()=>{i.validateFields().then(e=>{r===iI.BASIC?l("".concat(e.username.trim(),":").concat(e.password.trim())):l(e.authValue.trim())})},onCancel:a,destroyOnClose:!0,children:(0,c.jsx)(I.Z,{form:i,layout:"vertical",children:s})})},ns=e=>{let{authType:s,onAuthSubmit:t,hasAuth:l}=e,[a,r]=(0,d.useState)(!1);return(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)(i9.xv,{className:"text-sm font-medium text-gray-700",children:["Authentication ",l?"✓":""]}),(0,c.jsx)(i9.zx,{onClick:()=>r(!0),size:"sm",variant:"secondary",className:"text-xs",children:l?"Update":"Add Auth"})]}),(0,c.jsx)(i9.xv,{className:"text-xs text-gray-500",children:l?"Authentication configured":"Some tools may require authentication"}),(0,c.jsx)(ne,{visible:a,onOk:e=>{t(e),r(!1)},onCancel:()=>r(!1),authType:s})]})};var nt=e=>{let{serverId:s,accessToken:t,auth_type:l,userRole:a,userID:r}=e,[i,n]=(0,d.useState)(""),[o,m]=(0,d.useState)(null),[u,x]=(0,d.useState)(null),[h,p]=(0,d.useState)(null),{data:j,isLoading:f,error:v}=(0,sd.a)({queryKey:["mcpTools"],queryFn:()=>{if(!t)throw Error("Access Token required");return(0,g.listMCPTools)(t,s)},enabled:!!t}),{mutate:_,isPending:y}=(0,i8.D)({mutationFn:e=>{if(!t)throw Error("Access Token required");return(0,g.callMCPTool)(t,e.tool.name,e.arguments,e.authValue)},onSuccess:e=>{x(e),p(null)},onError:e=>{p(e),x(null)}}),b=(null==j?void 0:j.tools)||[],N=""!==i;return(0,c.jsx)("div",{className:"w-full h-screen p-4 bg-white",children:(0,c.jsx)(i9.Zb,{className:"w-full rounded-xl shadow-md overflow-hidden",children:(0,c.jsxs)("div",{className:"flex h-[80vh] w-full gap-4",children:[(0,c.jsxs)("div",{className:"w-1/4 p-4 bg-gray-50 flex flex-col",children:[(0,c.jsx)(i9.Dx,{className:"text-xl font-semibold mb-6 mt-2",children:"MCP Tools"}),(0,c.jsxs)("div",{className:"flex flex-col flex-1 space-y-6",children:[(0,c.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,c.jsxs)(i9.xv,{className:"font-medium block mb-3 text-gray-700 flex items-center",children:[(0,c.jsx)(a2.Z,{className:"mr-2"})," Available Tools",b.length>0&&(0,c.jsx)("span",{className:"ml-2 bg-blue-100 text-blue-800 text-xs font-medium px-2 py-0.5 rounded-full",children:b.length})]}),f&&(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 bg-white border border-gray-200 rounded-lg",children:[(0,c.jsxs)("div",{className:"relative mb-3",children:[(0,c.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-gray-200"}),(0,c.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-blue-600 border-t-transparent absolute top-0"})]}),(0,c.jsx)("p",{className:"text-xs font-medium text-gray-700",children:"Loading tools..."})]}),(null==j?void 0:j.error)&&(0,c.jsx)("div",{className:"p-3 text-xs text-red-800 rounded-lg bg-red-50 border border-red-200",children:(0,c.jsxs)("p",{className:"font-medium",children:["Error: ",j.message]})}),!f&&!(null==j?void 0:j.error)&&(!b||0===b.length)&&(0,c.jsxs)("div",{className:"p-4 text-center bg-white border border-gray-200 rounded-lg",children:[(0,c.jsx)("div",{className:"mx-auto w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mb-2",children:(0,c.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 8.172V5L8 4z"})})}),(0,c.jsx)("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"No tools available"}),(0,c.jsx)("p",{className:"text-xs text-gray-500",children:"No tools found for this server"})]}),!f&&!(null==j?void 0:j.error)&&b.length>0&&(0,c.jsx)("div",{className:"space-y-2 flex-1 overflow-y-auto",children:b.map(e=>(0,c.jsxs)("div",{className:"border rounded-lg p-3 cursor-pointer transition-all hover:shadow-sm ".concat((null==o?void 0:o.name)===e.name?"border-blue-500 bg-blue-50 ring-1 ring-blue-200":"border-gray-200 bg-white hover:border-gray-300"),onClick:()=>{m(e),x(null),p(null)},children:[(0,c.jsxs)("div",{className:"flex items-start space-x-2",children:[e.mcp_info.logo_url&&(0,c.jsx)("img",{src:e.mcp_info.logo_url,alt:"".concat(e.mcp_info.server_name," logo"),className:"w-4 h-4 object-contain flex-shrink-0 mt-0.5"}),(0,c.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,c.jsx)("h4",{className:"font-mono text-xs font-medium text-gray-900 truncate",children:e.name}),(0,c.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.mcp_info.server_name}),(0,c.jsx)("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2 leading-relaxed",children:e.description})]})]}),(null==o?void 0:o.name)===e.name&&(0,c.jsx)("div",{className:"mt-2 pt-2 border-t border-blue-200",children:(0,c.jsxs)("div",{className:"flex items-center text-xs font-medium text-blue-700",children:[(0,c.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,c.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Selected"]})})]},e.name))})]}),iT(l)&&(0,c.jsxs)("div",{className:"pt-4 border-t border-gray-200 flex-shrink-0",children:[(0,c.jsxs)(i9.xv,{className:"font-medium block mb-3 text-gray-700 flex items-center",children:[(0,c.jsx)(a7.Z,{className:"mr-2"})," Authentication"]}),(0,c.jsx)(ns,{authType:l,onAuthSubmit:e=>n(e),hasAuth:N})]})]})]}),(0,c.jsxs)("div",{className:"w-3/4 flex flex-col bg-white",children:[(0,c.jsx)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:(0,c.jsx)(i9.Dx,{className:"text-xl font-semibold mb-0",children:"Tool Testing Playground"})}),(0,c.jsx)("div",{className:"flex-1 overflow-auto p-4",children:o?(0,c.jsx)("div",{className:"h-full",children:(0,c.jsx)(i7,{tool:o,needsAuth:iT(l),authValue:i,onSubmit:e=>{_({tool:o,arguments:e,authValue:i})},result:u,error:h,isLoading:y,onClose:()=>m(null)})}):(0,c.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,c.jsx)(a6.Z,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,c.jsx)(i9.xv,{className:"text-lg font-medium text-gray-600 mb-2",children:"Select a Tool to Test"}),(0,c.jsx)(i9.xv,{className:"text-center text-gray-500 max-w-md",children:"Choose a tool from the left sidebar to start testing its functionality with custom inputs."})]})})]})]})})})},nl=t(57018),na=e=>{let{tagId:s,onClose:t,accessToken:l,is_admin:a,editTag:r}=e,[i]=I.Z.useForm(),[n,o]=(0,d.useState)(null),[m,u]=(0,d.useState)(r),[x,h]=(0,d.useState)([]),p=async()=>{if(l)try{let e=(await (0,g.tagInfoCall)(l,[s]))[s];e&&(o(e),r&&i.setFieldsValue({name:e.name,description:e.description,models:e.models}))}catch(e){console.error("Error fetching tag details:",e),P.ZP.error("Error fetching tag details: "+e)}};(0,d.useEffect)(()=>{p()},[s,l]),(0,d.useEffect)(()=>{l&&eV("dummy-user","Admin",l,h)},[l]);let j=async e=>{if(l)try{await (0,g.tagUpdateCall)(l,{name:e.name,description:e.description,models:e.models}),P.ZP.success("Tag updated successfully"),u(!1),p()}catch(e){console.error("Error updating tag:",e),P.ZP.error("Error updating tag: "+e)}};return n?(0,c.jsxs)("div",{className:"p-4",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(nl.zx,{onClick:t,className:"mb-4",children:"← Back to Tags"}),(0,c.jsxs)(nl.Dx,{children:["Tag Name: ",n.name]}),(0,c.jsx)(nl.xv,{className:"text-gray-500",children:n.description||"No description"})]}),a&&!m&&(0,c.jsx)(nl.zx,{onClick:()=>u(!0),children:"Edit Tag"})]}),m?(0,c.jsx)(nl.Zb,{children:(0,c.jsxs)(I.Z,{form:i,onFinish:j,layout:"vertical",initialValues:n,children:[(0,c.jsx)(I.Z.Item,{label:"Tag Name",name:"name",rules:[{required:!0,message:"Please input a tag name"}],children:(0,c.jsx)(L.default,{})}),(0,c.jsx)(I.Z.Item,{label:"Description",name:"description",children:(0,c.jsx)(L.default.TextArea,{rows:4})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Allowed LLMs"," ",(0,c.jsx)(z.Z,{title:"Select which LLMs are allowed to process this type of data",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"models",children:(0,c.jsx)(C.default,{mode:"multiple",placeholder:"Select LLMs",children:x.map(e=>(0,c.jsx)(C.default.Option,{value:e,children:F(e)},e))})}),(0,c.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,c.jsx)(nl.zx,{onClick:()=>u(!1),children:"Cancel"}),(0,c.jsx)(nl.zx,{type:"submit",children:"Save Changes"})]})]})}):(0,c.jsx)("div",{className:"space-y-6",children:(0,c.jsxs)(nl.Zb,{children:[(0,c.jsx)(nl.Dx,{children:"Tag Details"}),(0,c.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(nl.xv,{className:"font-medium",children:"Name"}),(0,c.jsx)(nl.xv,{children:n.name})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(nl.xv,{className:"font-medium",children:"Description"}),(0,c.jsx)(nl.xv,{children:n.description||"-"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(nl.xv,{className:"font-medium",children:"Allowed LLMs"}),(0,c.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:0===n.models.length?(0,c.jsx)(nl.Ct,{color:"red",children:"All Models"}):n.models.map(e=>{var s;return(0,c.jsx)(nl.Ct,{color:"blue",children:(0,c.jsx)(z.Z,{title:"ID: ".concat(e),children:(null===(s=n.model_info)||void 0===s?void 0:s[e])||e})},e)})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(nl.xv,{className:"font-medium",children:"Created"}),(0,c.jsx)(nl.xv,{children:n.created_at?new Date(n.created_at).toLocaleString():"-"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(nl.xv,{className:"font-medium",children:"Last Updated"}),(0,c.jsx)(nl.xv,{children:n.updated_at?new Date(n.updated_at).toLocaleString():"-"})]})]})]})})]}):(0,c.jsx)("div",{children:"Loading..."})},nr=e=>{let{data:s,onEdit:t,onDelete:l,onSelectTag:a}=e,[r,i]=d.useState([{id:"created_at",desc:!0}]),n=[{header:"Tag Name",accessorKey:"name",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("div",{className:"overflow-hidden",children:(0,c.jsx)(z.Z,{title:t.name,children:(0,c.jsx)(_.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5",onClick:()=>a(t.name),children:t.name})})})}},{header:"Description",accessorKey:"description",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)(z.Z,{title:t.description,children:(0,c.jsx)("span",{className:"text-xs",children:t.description||"-"})})}},{header:"Allowed LLMs",accessorKey:"models",cell:e=>{var s,t;let{row:l}=e,a=l.original;return(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(null==a?void 0:null===(s=a.models)||void 0===s?void 0:s.length)===0?(0,c.jsx)(eJ.Z,{size:"xs",className:"mb-1",color:"red",children:"All Models"}):null==a?void 0:null===(t=a.models)||void 0===t?void 0:t.map(e=>{var s;return(0,c.jsx)(eJ.Z,{size:"xs",className:"mb-1",color:"blue",children:(0,c.jsx)(z.Z,{title:"ID: ".concat(e),children:(0,c.jsx)(w.Z,{children:(null===(s=a.model_info)||void 0===s?void 0:s[e])||e})})},e)})})}},{header:"Created",accessorKey:"created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("span",{className:"text-xs",children:new Date(t.created_at).toLocaleDateString()})}},{id:"actions",header:"",cell:e=>{let{row:s}=e,a=s.original;return(0,c.jsxs)("div",{className:"flex space-x-2",children:[(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>t(a),className:"cursor-pointer"}),(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>l(a.name),className:"cursor-pointer"})]})}}],o=(0,sp.b7)({data:s,columns:n,state:{sorting:r},onSortingChange:i,getCoreRowModel:(0,sg.sC)(),getSortedRowModel:(0,sg.tj)(),enableSorting:!0});return(0,c.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,c.jsx)("div",{className:"overflow-x-auto",children:(0,c.jsxs)(sf.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,c.jsx)(sy.Z,{children:o.getHeaderGroups().map(e=>(0,c.jsx)(sN.Z,{children:e.headers.map(e=>(0,c.jsx)(sb.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,c.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,sp.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,c.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,c.jsx)(sk.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,c.jsx)(sZ.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,c.jsx)(sS.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,c.jsx)(sv.Z,{children:o.getRowModel().rows.length>0?o.getRowModel().rows.map(e=>(0,c.jsx)(sN.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,c.jsx)(s_.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,sp.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,c.jsx)(sN.Z,{children:(0,c.jsx)(s_.Z,{colSpan:n.length,className:"h-8 text-center",children:(0,c.jsx)("div",{className:"text-center text-gray-500",children:(0,c.jsx)("p",{children:"No tags found"})})})})})]})})})},ni=e=>{let{accessToken:s,userID:t,userRole:l}=e,[a,r]=(0,d.useState)([]),[i,n]=(0,d.useState)(!1),[o,m]=(0,d.useState)(null),[u,x]=(0,d.useState)(!1),[h,p]=(0,d.useState)(!1),[j,b]=(0,d.useState)(null),[N,Z]=(0,d.useState)(""),[k]=I.Z.useForm(),[S,E]=(0,d.useState)([]),T=async()=>{if(s)try{let e=await (0,g.tagListCall)(s);console.log("List tags response:",e),r(Object.values(e))}catch(e){console.error("Error fetching tags:",e),P.ZP.error("Error fetching tags: "+e)}},O=async e=>{if(s)try{await (0,g.tagCreateCall)(s,{name:e.tag_name,description:e.description,models:e.allowed_llms}),P.ZP.success("Tag created successfully"),n(!1),k.resetFields(),T()}catch(e){console.error("Error creating tag:",e),P.ZP.error("Error creating tag: "+e)}},M=async e=>{b(e),p(!0)},D=async()=>{if(s&&j){try{await (0,g.tagDeleteCall)(s,j),P.ZP.success("Tag deleted successfully"),T()}catch(e){console.error("Error deleting tag:",e),P.ZP.error("Error deleting tag: "+e)}p(!1),b(null)}};return(0,d.useEffect)(()=>{t&&l&&s&&(async()=>{try{let e=await (0,g.modelInfoCall)(s,t,l);e&&e.data&&E(e.data)}catch(e){console.error("Error fetching models:",e),P.ZP.error("Error fetching models: "+e)}})()},[s,t,l]),(0,d.useEffect)(()=>{T()},[s]),(0,c.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:o?(0,c.jsx)(na,{tagId:o,onClose:()=>{m(null),x(!1)},accessToken:s,is_admin:"Admin"===l,editTag:u}):(0,c.jsxs)("div",{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,c.jsxs)("div",{className:"flex justify-between mt-2 w-full items-center mb-4",children:[(0,c.jsx)("h1",{children:"Tag Management"}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[N&&(0,c.jsxs)(w.Z,{children:["Last Refreshed: ",N]}),(0,c.jsx)(sj.Z,{icon:e1.Z,variant:"shadow",size:"xs",className:"self-center cursor-pointer",onClick:()=>{T(),Z(new Date().toLocaleString())}})]})]}),(0,c.jsxs)(w.Z,{className:"mb-4",children:["Click on a tag name to view and edit its details.",(0,c.jsxs)("p",{children:["You can use tags to restrict the usage of certain LLMs based on tags passed in the request. Read more about tag routing ",(0,c.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/tag_routing",target:"_blank",rel:"noopener noreferrer",children:"here"}),"."]})]}),(0,c.jsx)(_.Z,{className:"mb-4",onClick:()=>n(!0),children:"+ Create New Tag"}),(0,c.jsx)(v.Z,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsx)(nr,{data:a,onEdit:e=>{m(e.name),x(!0)},onDelete:M,onSelectTag:m})})}),(0,c.jsx)(A.Z,{title:"Create New Tag",visible:i,width:800,footer:null,onCancel:()=>{n(!1),k.resetFields()},children:(0,c.jsxs)(I.Z,{form:k,onFinish:O,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsx)(I.Z.Item,{label:"Tag Name",name:"tag_name",rules:[{required:!0,message:"Please input a tag name"}],children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"Description",name:"description",children:(0,c.jsx)(L.default.TextArea,{rows:4})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Allowed Models"," ",(0,c.jsx)(z.Z,{title:"Select which LLMs are allowed to process requests from this tag",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_llms",children:(0,c.jsx)(C.default,{mode:"multiple",placeholder:"Select LLMs",children:S.map(e=>(0,c.jsx)(C.default.Option,{value:e.model_info.id,children:(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{children:e.model_name}),(0,c.jsxs)("span",{className:"text-gray-400 ml-2",children:["(",e.model_info.id,")"]})]})},e.model_info.id))})}),(0,c.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,c.jsx)(_.Z,{type:"submit",children:"Create Tag"})})]})}),h&&(0,c.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,c.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,c.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,c.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,c.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,c.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,c.jsx)("div",{className:"sm:flex sm:items-start",children:(0,c.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,c.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Tag"}),(0,c.jsx)("div",{className:"mt-2",children:(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this tag?"})})]})})}),(0,c.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,c.jsx)(_.Z,{onClick:D,color:"red",className:"ml-2",children:"Delete"}),(0,c.jsx)(_.Z,{onClick:()=>{p(!1),b(null)},children:"Cancel"})]})]})]})})]})})},nn=e=>{let{data:s,onView:t,onEdit:l,onDelete:a}=e,[r,i]=d.useState([{id:"created_at",desc:!0}]),n=[{header:"Vector Store ID",accessorKey:"vector_store_id",cell:e=>{let{row:s}=e,l=s.original;return(0,c.jsx)("button",{onClick:()=>t(l.vector_store_id),className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left w-full truncate whitespace-nowrap cursor-pointer max-w-[15ch]",children:l.vector_store_id.length>15?"".concat(l.vector_store_id.slice(0,15),"..."):l.vector_store_id})}},{header:"Name",accessorKey:"vector_store_name",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)(z.Z,{title:t.vector_store_name,children:(0,c.jsx)("span",{className:"text-xs",children:t.vector_store_name||"-"})})}},{header:"Description",accessorKey:"vector_store_description",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)(z.Z,{title:t.vector_store_description,children:(0,c.jsx)("span",{className:"text-xs",children:t.vector_store_description||"-"})})}},{header:"Provider",accessorKey:"custom_llm_provider",cell:e=>{let{row:s}=e,t=s.original,{displayName:l,logo:a}=(0,sL.dr)(t.custom_llm_provider);return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[a&&(0,c.jsx)("img",{src:a,alt:l,className:"h-4 w-4"}),(0,c.jsx)("span",{className:"text-xs",children:l})]})}},{header:"Created At",accessorKey:"created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("span",{className:"text-xs",children:new Date(t.created_at).toLocaleDateString()})}},{header:"Updated At",accessorKey:"updated_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsx)("span",{className:"text-xs",children:new Date(t.updated_at).toLocaleDateString()})}},{id:"actions",header:"",cell:e=>{let{row:s}=e,t=s.original;return(0,c.jsxs)("div",{className:"flex space-x-2",children:[(0,c.jsx)(sj.Z,{icon:sD.Z,size:"sm",onClick:()=>l(t.vector_store_id),className:"cursor-pointer"}),(0,c.jsx)(sj.Z,{icon:ee.Z,size:"sm",onClick:()=>a(t.vector_store_id),className:"cursor-pointer"})]})}}],o=(0,sp.b7)({data:s,columns:n,state:{sorting:r},onSortingChange:i,getCoreRowModel:(0,sg.sC)(),getSortedRowModel:(0,sg.tj)(),enableSorting:!0});return(0,c.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,c.jsx)("div",{className:"overflow-x-auto",children:(0,c.jsxs)(sf.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,c.jsx)(sy.Z,{children:o.getHeaderGroups().map(e=>(0,c.jsx)(sN.Z,{children:e.headers.map(e=>(0,c.jsx)(sb.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,c.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,sp.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,c.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,c.jsx)(sk.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,c.jsx)(sZ.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,c.jsx)(sS.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,c.jsx)(sv.Z,{children:o.getRowModel().rows.length>0?o.getRowModel().rows.map(e=>(0,c.jsx)(sN.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,c.jsx)(s_.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,sp.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,c.jsx)(sN.Z,{children:(0,c.jsx)(s_.Z,{colSpan:n.length,className:"h-8 text-center",children:(0,c.jsx)("div",{className:"text-center text-gray-500",children:(0,c.jsx)("p",{children:"No vector stores found"})})})})})]})})})};(r=o||(o={})).Bedrock="Amazon Bedrock",r.PgVector="PostgreSQL pgvector (LiteLLM Connector)",r.VertexRagEngine="Vertex AI RAG Engine",r.OpenAI="OpenAI",r.Azure="Azure OpenAI";let no={Bedrock:"bedrock",PgVector:"pg_vector",VertexRagEngine:"vertex_ai",OpenAI:"openai",Azure:"azure"},nc="/ui/assets/logos/",nd={"Amazon Bedrock":"".concat(nc,"bedrock.svg"),"PostgreSQL pgvector (LiteLLM Connector)":"".concat(nc,"postgresql.svg"),"Vertex AI RAG Engine":"".concat(nc,"google.svg"),OpenAI:"".concat(nc,"openai_small.svg"),"Azure OpenAI":"".concat(nc,"microsoft_azure.svg")},nm={bedrock:[],pg_vector:[{name:"api_base",label:"API Base",tooltip:"Enter the base URL of your deployed litellm-pgvector server (e.g., http://your-server:8000)",placeholder:"http://your-deployed-server:8000",required:!0,type:"text"},{name:"api_key",label:"API Key",tooltip:"Enter the API key from your deployed litellm-pgvector server",placeholder:"your-deployed-api-key",required:!0,type:"password"}],vertex_rag_engine:[],openai:[{name:"api_key",label:"API Key",tooltip:"Enter your OpenAI API key",placeholder:"sk-...",required:!0,type:"password"}],azure:[{name:"api_key",label:"API Key",tooltip:"Enter your Azure OpenAI API key",placeholder:"your-azure-api-key",required:!0,type:"password"},{name:"api_base",label:"API Base",tooltip:"Enter your Azure OpenAI endpoint (e.g., https://your-resource.openai.azure.com/)",placeholder:"https://your-resource.openai.azure.com/",required:!0,type:"text"}]},nu=e=>nm[e]||[];var nx=e=>{let{isVisible:s,onCancel:t,onSuccess:l,accessToken:a,credentials:r}=e,[i]=I.Z.useForm(),[n,m]=(0,d.useState)("{}"),[u,x]=(0,d.useState)("bedrock"),h=async e=>{if(a)try{let s={};try{s=n.trim()?JSON.parse(n):{}}catch(e){P.ZP.error("Invalid JSON in metadata field");return}let t={vector_store_id:e.vector_store_id,custom_llm_provider:e.custom_llm_provider,vector_store_name:e.vector_store_name,vector_store_description:e.vector_store_description,vector_store_metadata:s,litellm_credential_name:e.litellm_credential_name},r=nu(e.custom_llm_provider).reduce((s,t)=>(s[t.name]=e[t.name],s),{});t.litellm_params=r,await (0,g.vectorStoreCreateCall)(a,t),P.ZP.success("Vector store created successfully"),i.resetFields(),m("{}"),l()}catch(e){console.error("Error creating vector store:",e),P.ZP.error("Error creating vector store: "+e)}},p=()=>{i.resetFields(),m("{}"),x("bedrock"),t()};return(0,c.jsx)(A.Z,{title:"Add New Vector Store",visible:s,width:1e3,footer:null,onCancel:p,children:(0,c.jsxs)(I.Z,{form:i,onFinish:h,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Provider"," ",(0,c.jsx)(z.Z,{title:"Select the provider for this vector store",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"custom_llm_provider",rules:[{required:!0,message:"Please select a provider"}],initialValue:"bedrock",children:(0,c.jsx)(C.default,{onChange:e=>x(e),children:Object.entries(o).map(e=>{let[s,t]=e;return(0,c.jsx)(C.default.Option,{value:no[s],children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("img",{src:nd[t],alt:"".concat(s," logo"),className:"w-5 h-5",onError:e=>{let s=e.target,l=s.parentElement;if(l){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=t.charAt(0),l.replaceChild(e,s)}}}),(0,c.jsx)("span",{children:t})]})},s)})})}),"pg_vector"===u&&(0,c.jsx)(tH.Z,{message:"PG Vector Setup Required",description:(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{children:"LiteLLM provides a server to connect to PG Vector. To use this provider:"}),(0,c.jsxs)("ol",{style:{marginLeft:"16px",marginTop:"8px"},children:[(0,c.jsxs)("li",{children:["Deploy the litellm-pgvector server from: ",(0,c.jsx)("a",{href:"https://github.com/BerriAI/litellm-pgvector",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/BerriAI/litellm-pgvector"})]}),(0,c.jsx)("li",{children:"Configure your PostgreSQL database with pgvector extension"}),(0,c.jsx)("li",{children:"Start the server and note the API base URL and API key"}),(0,c.jsx)("li",{children:"Enter those details in the fields below"})]})]}),type:"info",showIcon:!0,style:{marginBottom:"16px"}}),"vertex_rag_engine"===u&&(0,c.jsx)(tH.Z,{message:"Vertex AI RAG Engine Setup",description:(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{children:"To use Vertex AI RAG Engine:"}),(0,c.jsxs)("ol",{style:{marginLeft:"16px",marginTop:"8px"},children:[(0,c.jsxs)("li",{children:["Set up your Vertex AI RAG Engine corpus following the guide: ",(0,c.jsx)("a",{href:"https://cloud.google.com/vertex-ai/generative-ai/docs/rag-engine/rag-overview",target:"_blank",rel:"noopener noreferrer",children:"Vertex AI RAG Engine Overview"})]}),(0,c.jsx)("li",{children:"Create a corpus in your Google Cloud project"}),(0,c.jsx)("li",{children:"Note the corpus ID from the Vertex AI console"}),(0,c.jsx)("li",{children:"Enter the corpus ID in the Vector Store ID field below"})]})]}),type:"info",showIcon:!0,style:{marginBottom:"16px"}}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Vector Store ID"," ",(0,c.jsx)(z.Z,{title:"Enter the vector store ID from your api provider",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"vector_store_id",rules:[{required:!0,message:"Please input the vector store ID from your api provider"}],children:(0,c.jsx)(y.Z,{placeholder:"vertex_rag_engine"===u?"6917529027641081856 (Get corpus ID from Vertex AI console)":"Enter vector store ID from your provider"})}),nu(u).map(e=>(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:[e.label," ",(0,c.jsx)(z.Z,{title:e.tooltip,children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:e.name,rules:e.required?[{required:!0,message:"Please input the ".concat(e.label.toLowerCase())}]:[],children:(0,c.jsx)(y.Z,{type:e.type||"text",placeholder:e.placeholder})},e.name)),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Vector Store Name"," ",(0,c.jsx)(z.Z,{title:"Custom name you want to give to the vector store, this name will be rendered on the LiteLLM UI",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"vector_store_name",children:(0,c.jsx)(y.Z,{})}),(0,c.jsx)(I.Z.Item,{label:"Description",name:"vector_store_description",children:(0,c.jsx)(L.default.TextArea,{rows:4})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Existing Credentials"," ",(0,c.jsx)(z.Z,{title:"Optionally select API provider credentials for this vector store eg. Bedrock API KEY",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"litellm_credential_name",children:(0,c.jsx)(C.default,{showSearch:!0,placeholder:"Select or search for existing credentials",optionFilterProp:"children",filterOption:(e,s)=>{var t;return(null!==(t=null==s?void 0:s.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},options:[{value:null,label:"None"},...r.map(e=>({value:e.credential_name,label:e.credential_name}))],allowClear:!0})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Metadata"," ",(0,c.jsx)(z.Z,{title:"JSON metadata for the vector store (optional)",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),children:(0,c.jsx)(L.default.TextArea,{rows:4,value:n,onChange:e=>m(e.target.value),placeholder:'{"key": "value"}'})}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,c.jsx)(_.Z,{onClick:p,variant:"secondary",children:"Cancel"}),(0,c.jsx)(_.Z,{variant:"primary",type:"submit",children:"Create"})]})]})})},nh=e=>{let{isVisible:s,onCancel:t,onConfirm:l}=e;return(0,c.jsxs)(A.Z,{title:"Delete Vector Store",visible:s,footer:null,onCancel:t,children:[(0,c.jsx)("p",{children:"Are you sure you want to delete this vector store? This action cannot be undone."}),(0,c.jsxs)("div",{className:"px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,c.jsx)(_.Z,{onClick:l,color:"red",className:"ml-2",children:"Delete"}),(0,c.jsx)(_.Z,{onClick:t,variant:"primary",children:"Cancel"})]})]})};let{TextArea:np}=L.default,{Text:ng,Title:nj}=em.default;var nf=e=>{let{vectorStoreId:s,accessToken:t,className:l=""}=e,[a,r]=(0,d.useState)(""),[i,n]=(0,d.useState)(!1),[o,m]=(0,d.useState)([]),[u,x]=(0,d.useState)({}),h=async()=>{if(!a.trim()){P.ZP.warning("Please enter a search query");return}n(!0);try{let e=await (0,g.vectorStoreSearchCall)(t,s,a),l={query:a,response:e,timestamp:Date.now()};m(e=>[l,...e]),r("")}catch(e){console.error("Error searching vector store:",e),P.ZP.error("Failed to search vector store")}finally{n(!1)}},p=e=>new Date(e).toLocaleString(),j=(e,s)=>{let t="".concat(e,"-").concat(s);x(e=>({...e,[t]:!e[t]}))};return(0,c.jsx)(th.Z,{className:"w-full rounded-xl shadow-md",children:(0,c.jsxs)("div",{className:"flex flex-col h-[600px]",children:[(0,c.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(a8.Z,{className:"mr-2 text-blue-500"}),(0,c.jsx)(nj,{level:4,className:"mb-0",children:"Test Vector Store"})]}),o.length>0&&(0,c.jsx)(T.ZP,{onClick:()=>{m([]),x({}),P.ZP.success("Search history cleared")},size:"small",children:"Clear History"})]}),(0,c.jsxs)("div",{className:"flex-1 overflow-auto p-4 pb-0",children:[0===o.length?(0,c.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,c.jsx)(a8.Z,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,c.jsx)(ng,{children:"Test your vector store by entering a search query below"})]}):(0,c.jsx)("div",{className:"space-y-4",children:o.map((e,s)=>{var t;return(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)("div",{className:"text-right",children:(0,c.jsxs)("div",{className:"inline-block max-w-[80%] rounded-lg shadow-sm p-3 bg-blue-50 border border-blue-200",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,c.jsx)("strong",{className:"text-sm",children:"Query"}),(0,c.jsx)("span",{className:"text-xs text-gray-500",children:p(e.timestamp)})]}),(0,c.jsx)("div",{className:"text-left",children:e.query})]})}),(0,c.jsx)("div",{className:"text-left",children:(0,c.jsxs)("div",{className:"inline-block max-w-[80%] rounded-lg shadow-sm p-3 bg-white border border-gray-200",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,c.jsx)(a8.Z,{className:"text-green-500"}),(0,c.jsx)("strong",{className:"text-sm",children:"Vector Store Results"}),e.response&&(0,c.jsxs)("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-600",children:[(null===(t=e.response.data)||void 0===t?void 0:t.length)||0," results"]})]}),e.response&&e.response.data&&e.response.data.length>0?(0,c.jsx)("div",{className:"space-y-3",children:e.response.data.map((e,t)=>{let l=u["".concat(s,"-").concat(t)]||!1;return(0,c.jsxs)("div",{className:"border rounded-lg overflow-hidden bg-gray-50",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center p-3 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>j(s,t),children:[(0,c.jsxs)("div",{className:"flex items-center",children:[l?(0,c.jsx)(tp.Z,{className:"text-gray-500 mr-2"}):(0,c.jsx)(t$.Z,{className:"text-gray-500 mr-2"}),(0,c.jsxs)("span",{className:"font-medium text-sm",children:["Result ",t+1]}),!l&&e.content&&e.content[0]&&(0,c.jsxs)("span",{className:"ml-2 text-xs text-gray-500 truncate max-w-md",children:["- ",e.content[0].text.substring(0,100),"..."]})]}),(0,c.jsxs)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:["Score: ",e.score.toFixed(4)]})]}),l&&(0,c.jsxs)("div",{className:"border-t bg-white p-3",children:[e.content&&e.content.map((e,s)=>(0,c.jsxs)("div",{className:"mb-3",children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:["Content (",e.type,")"]}),(0,c.jsx)("div",{className:"text-sm bg-gray-50 p-3 rounded border text-gray-800 max-h-40 overflow-y-auto",children:e.text})]},s)),(e.file_id||e.filename||e.attributes)&&(0,c.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[(0,c.jsx)("div",{className:"text-xs text-gray-500 mb-2 font-medium",children:"Metadata"}),(0,c.jsxs)("div",{className:"space-y-2 text-xs",children:[e.file_id&&(0,c.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,c.jsx)("span",{className:"font-medium",children:"File ID:"})," ",e.file_id]}),e.filename&&(0,c.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,c.jsx)("span",{className:"font-medium",children:"Filename:"})," ",e.filename]}),e.attributes&&Object.keys(e.attributes).length>0&&(0,c.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,c.jsx)("span",{className:"font-medium block mb-1",children:"Attributes:"}),(0,c.jsx)("pre",{className:"text-xs bg-white p-2 rounded border overflow-x-auto",children:JSON.stringify(e.attributes,null,2)})]})]})]})]})]},t)})}):(0,c.jsx)("div",{className:"text-gray-500 text-sm",children:"No results found"})]})}),s<o.length-1&&(0,c.jsx)(Y.Z,{})]},s)})}),i&&(0,c.jsx)("div",{className:"flex justify-center items-center my-4",children:(0,c.jsx)(lm.Z,{indicator:(0,c.jsx)(a5.Z,{style:{fontSize:24},spin:!0})})})]}),(0,c.jsx)("div",{className:"p-4 border-t border-gray-200 bg-white",children:(0,c.jsxs)("div",{className:"flex items-end space-x-2",children:[(0,c.jsx)("div",{className:"flex-1",children:(0,c.jsx)(np,{value:a,onChange:e=>r(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h())},placeholder:"Enter your search query... (Shift+Enter for new line)",disabled:i,autoSize:{minRows:1,maxRows:4},style:{resize:"none"}})}),(0,c.jsx)(T.ZP,{type:"primary",onClick:h,disabled:i||!a.trim(),icon:(0,c.jsx)(rl.Z,{}),loading:i,children:"Search"})]})})]})})},nv=e=>{let{vectorStoreId:s,onClose:t,accessToken:l,is_admin:a,editVectorStore:r}=e,[i]=I.Z.useForm(),[n,o]=(0,d.useState)(null),[m,u]=(0,d.useState)(r),[x,h]=(0,d.useState)("{}"),[p,j]=(0,d.useState)([]),[f,v]=(0,d.useState)("details"),y=async()=>{if(l)try{let e=await (0,g.vectorStoreInfoCall)(l,s);if(e&&e.vector_store){if(o(e.vector_store),e.vector_store.vector_store_metadata){let s="string"==typeof e.vector_store.vector_store_metadata?JSON.parse(e.vector_store.vector_store_metadata):e.vector_store.vector_store_metadata;h(JSON.stringify(s,null,2))}r&&i.setFieldsValue({vector_store_id:e.vector_store.vector_store_id,custom_llm_provider:e.vector_store.custom_llm_provider,vector_store_name:e.vector_store.vector_store_name,vector_store_description:e.vector_store.vector_store_description})}}catch(e){console.error("Error fetching vector store details:",e),P.ZP.error("Error fetching vector store details: "+e)}},b=async()=>{if(l)try{let e=await (0,g.credentialListCall)(l);console.log("List credentials response:",e),j(e.credentials||[])}catch(e){console.error("Error fetching credentials:",e)}};(0,d.useEffect)(()=>{y(),b()},[s,l]);let N=async e=>{if(l)try{let s={};try{s=x?JSON.parse(x):{}}catch(e){P.ZP.error("Invalid JSON in metadata field");return}let t={vector_store_id:e.vector_store_id,custom_llm_provider:e.custom_llm_provider,vector_store_name:e.vector_store_name,vector_store_description:e.vector_store_description,vector_store_metadata:s};await (0,g.vectorStoreUpdateCall)(l,t),P.ZP.success("Vector store updated successfully"),u(!1),y()}catch(e){console.error("Error updating vector store:",e),P.ZP.error("Error updating vector store: "+e)}};return n?(0,c.jsxs)("div",{className:"p-4 max-w-full",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(_.Z,{icon:e0.Z,variant:"light",className:"mb-4",onClick:t,children:"Back to Vector Stores"}),(0,c.jsxs)(k.Z,{children:["Vector Store ID: ",n.vector_store_id]}),(0,c.jsx)(w.Z,{className:"text-gray-500",children:n.vector_store_description||"No description"})]}),a&&!m&&(0,c.jsx)(_.Z,{onClick:()=>u(!0),children:"Edit Vector Store"})]}),(0,c.jsxs)(eW.Z,{children:[(0,c.jsxs)(e$.Z,{className:"mb-6",children:[(0,c.jsx)(eY.Z,{children:"Details"}),(0,c.jsx)(eY.Z,{children:"Test Vector Store"})]}),(0,c.jsxs)(eX.Z,{children:[(0,c.jsx)(eQ.Z,{children:m?(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,c.jsx)(k.Z,{children:"Edit Vector Store"})}),(0,c.jsx)(W.Z,{children:(0,c.jsxs)(I.Z,{form:i,onFinish:N,layout:"vertical",initialValues:n,children:[(0,c.jsx)(I.Z.Item,{label:"Vector Store ID",name:"vector_store_id",rules:[{required:!0,message:"Please input a vector store ID"}],children:(0,c.jsx)(L.default,{disabled:!0})}),(0,c.jsx)(I.Z.Item,{label:"Vector Store Name",name:"vector_store_name",children:(0,c.jsx)(L.default,{})}),(0,c.jsx)(I.Z.Item,{label:"Description",name:"vector_store_description",children:(0,c.jsx)(L.default.TextArea,{rows:4})}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Provider"," ",(0,c.jsx)(z.Z,{title:"Select the provider for this vector store",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),name:"custom_llm_provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,c.jsx)(C.default,{children:Object.entries(sL.Cl).map(e=>{let[s,t]=e;return"Bedrock"===s?(0,c.jsx)(C.default.Option,{value:sL.fK[s],children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("img",{src:sL.cd[t],alt:"".concat(s," logo"),className:"w-5 h-5",onError:e=>{let s=e.target,l=s.parentElement;if(l){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=t.charAt(0),l.replaceChild(e,s)}}}),(0,c.jsx)("span",{children:t})]})},s):null})})}),(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsx)(w.Z,{className:"text-sm text-gray-500 mb-2",children:"Either select existing credentials OR enter provider credentials below"})}),(0,c.jsx)(I.Z.Item,{label:"Existing Credentials",name:"litellm_credential_name",children:(0,c.jsx)(C.default,{showSearch:!0,placeholder:"Select or search for existing credentials",optionFilterProp:"children",filterOption:(e,s)=>{var t;return(null!==(t=null==s?void 0:s.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},options:[{value:null,label:"None"},...p.map(e=>({value:e.credential_name,label:e.credential_name}))],allowClear:!0})}),(0,c.jsxs)("div",{className:"flex items-center my-4",children:[(0,c.jsx)("div",{className:"flex-grow border-t border-gray-200"}),(0,c.jsx)("span",{className:"px-4 text-gray-500 text-sm",children:"OR"}),(0,c.jsx)("div",{className:"flex-grow border-t border-gray-200"})]}),(0,c.jsx)(I.Z.Item,{label:(0,c.jsxs)("span",{children:["Metadata"," ",(0,c.jsx)(z.Z,{title:"JSON metadata for the vector store",children:(0,c.jsx)(U.Z,{style:{marginLeft:"4px"}})})]}),children:(0,c.jsx)(L.default.TextArea,{rows:4,value:x,onChange:e=>h(e.target.value),placeholder:'{"key": "value"}'})}),(0,c.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,c.jsx)(T.ZP,{onClick:()=>u(!1),children:"Cancel"}),(0,c.jsx)(T.ZP,{type:"primary",htmlType:"submit",children:"Save Changes"})]})]})})]}):(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(k.Z,{children:"Vector Store Details"}),a&&(0,c.jsx)(_.Z,{onClick:()=>u(!0),children:"Edit Vector Store"})]}),(0,c.jsx)(W.Z,{children:(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"ID"}),(0,c.jsx)(w.Z,{children:n.vector_store_id})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Name"}),(0,c.jsx)(w.Z,{children:n.vector_store_name||"-"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Description"}),(0,c.jsx)(w.Z,{children:n.vector_store_description||"-"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Provider"}),(0,c.jsx)("div",{className:"flex items-center space-x-2 mt-1",children:(()=>{let e=n.custom_llm_provider||"bedrock",{displayName:s,logo:t}=(()=>{let s=Object.keys(sL.fK).find(s=>sL.fK[s].toLowerCase()===e.toLowerCase());if(!s)return{displayName:e,logo:""};let t=sL.Cl[s],l=sL.cd[t];return{displayName:t,logo:l}})();return(0,c.jsxs)(c.Fragment,{children:[t&&(0,c.jsx)("img",{src:t,alt:"".concat(s," logo"),className:"w-5 h-5",onError:e=>{let t=e.target,l=t.parentElement;if(l){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=s.charAt(0),l.replaceChild(e,t)}}}),(0,c.jsx)(eJ.Z,{color:"blue",children:s})]})})()})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Metadata"}),(0,c.jsx)("div",{className:"bg-gray-50 p-3 rounded mt-2 font-mono text-xs overflow-auto max-h-48",children:(0,c.jsx)("pre",{children:x})})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Created"}),(0,c.jsx)(w.Z,{children:n.created_at?new Date(n.created_at).toLocaleString():"-"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{className:"font-medium",children:"Last Updated"}),(0,c.jsx)(w.Z,{children:n.updated_at?new Date(n.updated_at).toLocaleString():"-"})]})]})})]})}),(0,c.jsx)(eQ.Z,{children:(0,c.jsx)(nf,{vectorStoreId:n.vector_store_id,accessToken:l||""})})]})]})]}):(0,c.jsx)("div",{children:"Loading..."})},n_=e=>{let{accessToken:s,userID:t,userRole:l}=e,[a,r]=(0,d.useState)([]),[i,n]=(0,d.useState)(!1),[o,m]=(0,d.useState)(!1),[u,x]=(0,d.useState)(null),[h,p]=(0,d.useState)(""),[j,y]=(0,d.useState)([]),[b,N]=(0,d.useState)(null),[Z,k]=(0,d.useState)(!1),S=async()=>{if(s)try{let e=await (0,g.vectorStoreListCall)(s);console.log("List vector stores response:",e),r(e.data||[])}catch(e){console.error("Error fetching vector stores:",e),P.ZP.error("Error fetching vector stores: "+e)}},C=async()=>{if(s)try{let e=await (0,g.credentialListCall)(s);console.log("List credentials response:",e),y(e.credentials||[])}catch(e){console.error("Error fetching credentials:",e),P.ZP.error("Error fetching credentials: "+e)}},I=async e=>{x(e),m(!0)},A=async()=>{if(s&&u){try{await (0,g.vectorStoreDeleteCall)(s,u),P.ZP.success("Vector store deleted successfully"),S()}catch(e){console.error("Error deleting vector store:",e),P.ZP.error("Error deleting vector store: "+e)}m(!1),x(null)}};return(0,d.useEffect)(()=>{S(),C()},[s]),b?(0,c.jsx)("div",{className:"w-full h-full",children:(0,c.jsx)(nv,{vectorStoreId:b,onClose:()=>{N(null),k(!1),S()},accessToken:s,is_admin:(0,eE.tY)(l||""),editVectorStore:Z})}):(0,c.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,c.jsxs)("div",{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,c.jsxs)("div",{className:"flex justify-between mt-2 w-full items-center mb-4",children:[(0,c.jsx)("h1",{children:"Vector Store Management"}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[h&&(0,c.jsxs)(w.Z,{children:["Last Refreshed: ",h]}),(0,c.jsx)(sj.Z,{icon:e1.Z,variant:"shadow",size:"xs",className:"self-center cursor-pointer",onClick:()=>{S(),C(),p(new Date().toLocaleString())}})]})]}),(0,c.jsx)(w.Z,{className:"mb-4",children:(0,c.jsx)("p",{children:"You can use vector stores to store and retrieve LLM embeddings.."})}),(0,c.jsx)(_.Z,{className:"mb-4",onClick:()=>n(!0),children:"+ Add Vector Store"}),(0,c.jsx)(v.Z,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:(0,c.jsx)(f.Z,{numColSpan:1,children:(0,c.jsx)(nn,{data:a,onView:e=>{N(e),k(!1)},onEdit:e=>{N(e),k(!0)},onDelete:I})})}),(0,c.jsx)(nx,{isVisible:i,onCancel:()=>n(!1),onSuccess:()=>{n(!1),S()},accessToken:s,credentials:j}),(0,c.jsx)(nh,{isVisible:o,onCancel:()=>m(!1),onConfirm:A})]})})},ny=t(49096),nb=t(53335);let{cva:nN,cx:nZ,compose:nw}=(0,ny.ZD)({hooks:{onComplete:e=>(0,nb.m6)(e)}});function nk(e){var s,t;let{className:l="",...a}=e,r=(0,d.useId)();return s=()=>{let e=document.getAnimations().filter(e=>e instanceof CSSAnimation&&"spin"===e.animationName),s=e.find(e=>{var s;return(null===(s=e.effect.target)||void 0===s?void 0:s.getAttribute("data-spinner-id"))===r}),t=e.find(e=>{var s;return e.effect instanceof KeyframeEffect&&(null===(s=e.effect.target)||void 0===s?void 0:s.getAttribute("data-spinner-id"))!==r});s&&t&&(s.currentTime=t.currentTime)},t=[r],(0,d.useLayoutEffect)(s,t),(0,c.jsxs)("svg",{"data-spinner-id":r,className:nZ("pointer-events-none size-12 animate-spin text-current",l),fill:"none",viewBox:"0 0 24 24",...a,children:[(0,c.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,c.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}let nS=new x.S;function nC(){return(0,c.jsxs)("div",{className:nZ("h-screen","flex items-center justify-center gap-4"),children:[(0,c.jsx)("div",{className:"text-lg font-medium py-2 pr-4 border-r border-r-gray-200",children:"\uD83D\uDE85 LiteLLM"}),(0,c.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,c.jsx)(nk,{className:"size-4"}),(0,c.jsx)("span",{className:"text-gray-600 text-sm",children:"Loading..."})]})]})}function nI(){let[e,s]=(0,d.useState)(""),[t,l]=(0,d.useState)(!1),[a,r]=(0,d.useState)(!1),[i,n]=(0,d.useState)(null),[o,x]=(0,d.useState)(null),[f,v]=(0,d.useState)([]),[_,y]=(0,d.useState)([]),[b,N]=(0,d.useState)([]),[Z,w]=(0,d.useState)({PROXY_BASE_URL:"",PROXY_LOGOUT_URL:""}),[k,S]=(0,d.useState)(!0),C=(0,m.useSearchParams)(),[I,P]=(0,d.useState)({data:[]}),[A,E]=(0,d.useState)(null),[T,L]=(0,d.useState)(!1),[O,M]=(0,d.useState)(!0),[D,F]=(0,d.useState)(null),R=C.get("invitation_id"),[q,U]=(0,d.useState)(()=>C.get("page")||"api-keys"),[z,V]=(0,d.useState)(null),K=e=>{v(s=>s?[...s,e]:[e]),L(()=>!T)},B=!1===O&&null===A&&null===R;return((0,d.useEffect)(()=>{let e=function(e){let s=document.cookie.split("; ").find(s=>s.startsWith(e+"="));return s?s.split("=")[1]:null}("token");(0,g.getUiConfig)().then(s=>{E(e),M(!1)})},[]),(0,d.useEffect)(()=>{B&&(window.location.href=(g.proxyBaseUrl||"")+"/sso/key/generate")},[B]),(0,d.useEffect)(()=>{if(!A)return;let e=(0,u.o)(A);if(e){if(V(e.key),r(e.disabled_non_admin_personal_key_creation),e.user_role){let t=function(e){if(!e)return"Undefined Role";switch(e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"org_admin":return"Org Admin";case"internal_user":return"Internal User";case"internal_user_viewer":case"internal_viewer":return"Internal Viewer";case"app_user":return"App User";default:return"Unknown Role"}}(e.user_role);s(t),"Admin Viewer"==t&&U("usage")}e.user_email&&n(e.user_email),e.login_method&&S("username_password"==e.login_method),e.premium_user&&l(e.premium_user),e.auth_header_name&&(0,g.setGlobalLitellmHeaderName)(e.auth_header_name),e.user_id&&F(e.user_id)}},[A]),(0,d.useEffect)(()=>{z&&D&&e&&eV(D,e,z,N),z&&D&&e&&j(z,D,e,null,x),z&&ly(z,y)},[z,D,e]),O||B)?(0,c.jsx)(nC,{}):(0,c.jsx)(d.Suspense,{fallback:(0,c.jsx)(nC,{}),children:(0,c.jsx)(h.aH,{client:nS,children:R?(0,c.jsx)(sE,{userID:D,userRole:e,premiumUser:t,teams:o,keys:f,setUserRole:s,userEmail:i,setUserEmail:n,setTeams:x,setKeys:v,organizations:_,addKey:K,createClicked:T}):(0,c.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,c.jsx)(p.Z,{userID:D,userRole:e,premiumUser:t,userEmail:i,setProxySettings:w,proxySettings:Z,accessToken:z,isPublicPage:!1}),(0,c.jsxs)("div",{className:"flex flex-1 overflow-auto",children:[(0,c.jsx)("div",{className:"mt-8",children:(0,c.jsx)(rS,{accessToken:z,setPage:e=>{let s=new URLSearchParams(C);s.set("page",e),window.history.pushState(null,"","?".concat(s.toString())),U(e)},userRole:e,defaultSelectedKey:q})}),"api-keys"==q?(0,c.jsx)(sE,{userID:D,userRole:e,premiumUser:t,teams:o,keys:f,setUserRole:s,userEmail:i,setUserEmail:n,setTeams:x,setKeys:v,organizations:_,addKey:K,createClicked:T}):"models"==q?(0,c.jsx)(le,{userID:D,userRole:e,token:A,keys:f,accessToken:z,modelData:I,setModelData:P,premiumUser:t,teams:o}):"llm-playground"==q?(0,c.jsx)(ri,{userID:D,userRole:e,token:A,accessToken:z,disabledPersonalKeyCreation:a}):"users"==q?(0,c.jsx)(lp,{userID:D,userRole:e,token:A,keys:f,teams:o,accessToken:z,setKeys:v}):"teams"==q?(0,c.jsx)(lv,{teams:o,setTeams:x,searchParams:C,accessToken:z,userID:D,userRole:e,organizations:_,premiumUser:t}):"organizations"==q?(0,c.jsx)(lb,{organizations:_,setOrganizations:y,userModels:b,accessToken:z,userRole:e,premiumUser:t}):"admin-panel"==q?(0,c.jsx)(lO,{setTeams:x,searchParams:C,accessToken:z,userID:D,showSSOBanner:k,premiumUser:t,proxySettings:Z}):"api_ref"==q?(0,c.jsx)(aL,{proxySettings:Z}):"settings"==q?(0,c.jsx)(lB,{userID:D,userRole:e,accessToken:z,premiumUser:t}):"budgets"==q?(0,c.jsx)(l5,{accessToken:z}):"guardrails"==q?(0,c.jsx)(iy,{accessToken:z,userRole:e}):"transform-request"==q?(0,c.jsx)(ib,{accessToken:z}):"general-settings"==q?(0,c.jsx)(l0,{userID:D,userRole:e,accessToken:z,modelData:I}):"model-hub-table"==q?(0,c.jsx)(aj.Z,{accessToken:z,publicPage:!1,premiumUser:t,userRole:e}):"caching"==q?(0,c.jsx)(rR,{userID:D,userRole:e,token:A,accessToken:z,premiumUser:t}):"pass-through-settings"==q?(0,c.jsx)(t7,{userID:D,userRole:e,accessToken:z,modelData:I}):"logs"==q?(0,c.jsx)(ap,{userID:D,userRole:e,token:A,accessToken:z,allTeams:null!=o?o:[],premiumUser:t}):"mcp-servers"==q?(0,c.jsx)(i3,{accessToken:z,userRole:e,userID:D}):"tag-management"==q?(0,c.jsx)(ni,{accessToken:z,userRole:e,userID:D}):"vector-stores"==q?(0,c.jsx)(n_,{accessToken:z,userRole:e,userID:D}):"new_usage"==q?(0,c.jsx)(aT,{userID:D,userRole:e,accessToken:z,teams:null!=o?o:[],premiumUser:t}):(0,c.jsx)(rP,{userID:D,userRole:e,token:A,accessToken:z,keys:f,premiumUser:t})]})]})})})}}},function(e){e.O(0,[665,990,445,152,634,475,199,338,162,172,971,117,744],function(){return e(e.s=36362)}),_N_E=e.O()}]);