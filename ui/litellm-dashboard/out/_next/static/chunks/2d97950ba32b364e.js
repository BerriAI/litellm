(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,573421,e=>{"use strict";e.i(247167);var t=e.i(8211),r=e.i(271645),s=e.i(343794),a=e.i(887719),l=e.i(908206),n=e.i(242064),i=e.i(721132),o=e.i(517455),c=e.i(264042),d=e.i(150073),m=e.i(165370),p=e.i(244451);let u=r.default.createContext({});u.Consumer;var x=e.i(763731),h=e.i(211576),g=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)0>t.indexOf(s[a])&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r};let f=r.default.forwardRef((e,t)=>{let a,{prefixCls:l,children:i,actions:o,extra:c,styles:d,className:m,classNames:p,colStyle:f}=e,y=g(e,["prefixCls","children","actions","extra","styles","className","classNames","colStyle"]),{grid:v,itemLayout:j}=(0,r.useContext)(u),{getPrefixCls:b,list:N}=(0,r.useContext)(n.ConfigContext),$=e=>{var t,r;return(0,s.default)(null==(r=null==(t=null==N?void 0:N.item)?void 0:t.classNames)?void 0:r[e],null==p?void 0:p[e])},w=e=>{var t,r;return Object.assign(Object.assign({},null==(r=null==(t=null==N?void 0:N.item)?void 0:t.styles)?void 0:r[e]),null==d?void 0:d[e])},C=b("list",l),S=o&&o.length>0&&r.default.createElement("ul",{className:(0,s.default)(`${C}-item-action`,$("actions")),key:"actions",style:w("actions")},o.map((e,t)=>r.default.createElement("li",{key:`${C}-item-action-${t}`},e,t!==o.length-1&&r.default.createElement("em",{className:`${C}-item-action-split`})))),k=r.default.createElement(v?"div":"li",Object.assign({},y,v?{}:{ref:t},{className:(0,s.default)(`${C}-item`,{[`${C}-item-no-flex`]:!("vertical"===j?!!c:(a=!1,r.Children.forEach(i,e=>{"string"==typeof e&&(a=!0)}),!(a&&r.Children.count(i)>1)))},m)}),"vertical"===j&&c?[r.default.createElement("div",{className:`${C}-item-main`,key:"content"},i,S),r.default.createElement("div",{className:(0,s.default)(`${C}-item-extra`,$("extra")),key:"extra",style:w("extra")},c)]:[i,S,(0,x.cloneElement)(c,{key:"extra"})]);return v?r.default.createElement(h.Col,{ref:t,flex:1,style:f},k):k});f.Meta=e=>{var{prefixCls:t,className:a,avatar:l,title:i,description:o}=e,c=g(e,["prefixCls","className","avatar","title","description"]);let{getPrefixCls:d}=(0,r.useContext)(n.ConfigContext),m=d("list",t),p=(0,s.default)(`${m}-item-meta`,a),u=r.default.createElement("div",{className:`${m}-item-meta-content`},i&&r.default.createElement("h4",{className:`${m}-item-meta-title`},i),o&&r.default.createElement("div",{className:`${m}-item-meta-description`},o));return r.default.createElement("div",Object.assign({},c,{className:p}),l&&r.default.createElement("div",{className:`${m}-item-meta-avatar`},l),(i||o)&&u)},e.i(296059);var y=e.i(915654),v=e.i(183293),j=e.i(246422),b=e.i(838378);let N=(0,j.genStyleHooks)("List",e=>{let t=(0,b.mergeToken)(e,{listBorderedCls:`${e.componentCls}-bordered`,minHeight:e.controlHeightLG});return[(e=>{let{componentCls:t,antCls:r,controlHeight:s,minHeight:a,paddingSM:l,marginLG:n,padding:i,itemPadding:o,colorPrimary:c,itemPaddingSM:d,itemPaddingLG:m,paddingXS:p,margin:u,colorText:x,colorTextDescription:h,motionDurationSlow:g,lineWidth:f,headerBg:j,footerBg:b,emptyTextPadding:N,metaMarginBottom:$,avatarMarginRight:w,titleMarginBottom:C,descriptionFontSize:S}=e;return{[t]:Object.assign(Object.assign({},(0,v.resetComponent)(e)),{position:"relative","--rc-virtual-list-scrollbar-bg":e.colorSplit,"*":{outline:"none"},[`${t}-header`]:{background:j},[`${t}-footer`]:{background:b},[`${t}-header, ${t}-footer`]:{paddingBlock:l},[`${t}-pagination`]:{marginBlockStart:n,[`${r}-pagination-options`]:{textAlign:"start"}},[`${t}-spin`]:{minHeight:a,textAlign:"center"},[`${t}-items`]:{margin:0,padding:0,listStyle:"none"},[`${t}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:o,color:x,[`${t}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${t}-item-meta-avatar`]:{marginInlineEnd:w},[`${t}-item-meta-content`]:{flex:"1 0",width:0,color:x},[`${t}-item-meta-title`]:{margin:`0 0 ${(0,y.unit)(e.marginXXS)} 0`,color:x,fontSize:e.fontSize,lineHeight:e.lineHeight,"> a":{color:x,transition:`all ${g}`,"&:hover":{color:c}}},[`${t}-item-meta-description`]:{color:h,fontSize:S,lineHeight:e.lineHeight}},[`${t}-item-action`]:{flex:"0 0 auto",marginInlineStart:e.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${(0,y.unit)(p)}`,color:h,fontSize:e.fontSize,lineHeight:e.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${t}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:f,height:e.calc(e.fontHeight).sub(e.calc(e.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:e.colorSplit}}},[`${t}-empty`]:{padding:`${(0,y.unit)(i)} 0`,color:h,fontSize:e.fontSizeSM,textAlign:"center"},[`${t}-empty-text`]:{padding:N,color:e.colorTextDisabled,fontSize:e.fontSize,textAlign:"center"},[`${t}-item-no-flex`]:{display:"block"}}),[`${t}-grid ${r}-col > ${t}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:u,paddingBlock:0,borderBlockEnd:"none"},[`${t}-vertical ${t}-item`]:{alignItems:"initial",[`${t}-item-main`]:{display:"block",flex:1},[`${t}-item-extra`]:{marginInlineStart:n},[`${t}-item-meta`]:{marginBlockEnd:$,[`${t}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:C,color:x,fontSize:e.fontSizeLG,lineHeight:e.lineHeightLG}},[`${t}-item-action`]:{marginBlockStart:i,marginInlineStart:"auto","> li":{padding:`0 ${(0,y.unit)(i)}`,"&:first-child":{paddingInlineStart:0}}}},[`${t}-split ${t}-item`]:{borderBlockEnd:`${(0,y.unit)(e.lineWidth)} ${e.lineType} ${e.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${t}-split ${t}-header`]:{borderBlockEnd:`${(0,y.unit)(e.lineWidth)} ${e.lineType} ${e.colorSplit}`},[`${t}-split${t}-empty ${t}-footer`]:{borderTop:`${(0,y.unit)(e.lineWidth)} ${e.lineType} ${e.colorSplit}`},[`${t}-loading ${t}-spin-nested-loading`]:{minHeight:s},[`${t}-split${t}-something-after-last-item ${r}-spin-container > ${t}-items > ${t}-item:last-child`]:{borderBlockEnd:`${(0,y.unit)(e.lineWidth)} ${e.lineType} ${e.colorSplit}`},[`${t}-lg ${t}-item`]:{padding:m},[`${t}-sm ${t}-item`]:{padding:d},[`${t}:not(${t}-vertical)`]:{[`${t}-item-no-flex`]:{[`${t}-item-action`]:{float:"right"}}}}})(t),(e=>{let{listBorderedCls:t,componentCls:r,paddingLG:s,margin:a,itemPaddingSM:l,itemPaddingLG:n,marginLG:i,borderRadiusLG:o}=e,c=(0,y.unit)(e.calc(o).sub(e.lineWidth).equal());return{[t]:{border:`${(0,y.unit)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:o,[`${r}-header`]:{borderRadius:`${c} ${c} 0 0`},[`${r}-footer`]:{borderRadius:`0 0 ${c} ${c}`},[`${r}-header,${r}-footer,${r}-item`]:{paddingInline:s},[`${r}-pagination`]:{margin:`${(0,y.unit)(a)} ${(0,y.unit)(i)}`}},[`${t}${r}-sm`]:{[`${r}-item,${r}-header,${r}-footer`]:{padding:l}},[`${t}${r}-lg`]:{[`${r}-item,${r}-header,${r}-footer`]:{padding:n}}}})(t),(e=>{let{componentCls:t,screenSM:r,screenMD:s,marginLG:a,marginSM:l,margin:n}=e;return{[`@media screen and (max-width:${s}px)`]:{[t]:{[`${t}-item`]:{[`${t}-item-action`]:{marginInlineStart:a}}},[`${t}-vertical`]:{[`${t}-item`]:{[`${t}-item-extra`]:{marginInlineStart:a}}}},[`@media screen and (max-width: ${r}px)`]:{[t]:{[`${t}-item`]:{flexWrap:"wrap",[`${t}-action`]:{marginInlineStart:l}}},[`${t}-vertical`]:{[`${t}-item`]:{flexWrap:"wrap-reverse",[`${t}-item-main`]:{minWidth:e.contentWidth},[`${t}-item-extra`]:{margin:`auto auto ${(0,y.unit)(n)}`}}}}}})(t)]},e=>({contentWidth:220,itemPadding:`${(0,y.unit)(e.paddingContentVertical)} 0`,itemPaddingSM:`${(0,y.unit)(e.paddingContentVerticalSM)} ${(0,y.unit)(e.paddingContentHorizontal)}`,itemPaddingLG:`${(0,y.unit)(e.paddingContentVerticalLG)} ${(0,y.unit)(e.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:e.padding,metaMarginBottom:e.padding,avatarMarginRight:e.padding,titleMarginBottom:e.paddingSM,descriptionFontSize:e.fontSize}));var $=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)0>t.indexOf(s[a])&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r};let w=r.forwardRef(function(e,x){let{pagination:h=!1,prefixCls:g,bordered:f=!1,split:y=!0,className:v,rootClassName:j,style:b,children:w,itemLayout:C,loadMore:S,grid:k,dataSource:T=[],size:_,header:P,footer:E,loading:O=!1,rowKey:I,renderItem:B,locale:z}=e,M=$(e,["pagination","prefixCls","bordered","split","className","rootClassName","style","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]),L=h&&"object"==typeof h?h:{},[A,D]=r.useState(L.defaultCurrent||1),[R,F]=r.useState(L.defaultPageSize||10),{getPrefixCls:H,direction:U,className:W,style:J}=(0,n.useComponentConfig)("list"),{renderEmpty:V}=r.useContext(n.ConfigContext),q=e=>(t,r)=>{var s;D(t),F(r),h&&(null==(s=null==h?void 0:h[e])||s.call(h,t,r))},K=q("onChange"),G=q("onShowSizeChange"),X=!!(S||h||E),Y=H("list",g),[Z,Q,ee]=N(Y),et=O;"boolean"==typeof et&&(et={spinning:et});let er=!!(null==et?void 0:et.spinning),es=(0,o.default)(_),ea="";switch(es){case"large":ea="lg";break;case"small":ea="sm"}let el=(0,s.default)(Y,{[`${Y}-vertical`]:"vertical"===C,[`${Y}-${ea}`]:ea,[`${Y}-split`]:y,[`${Y}-bordered`]:f,[`${Y}-loading`]:er,[`${Y}-grid`]:!!k,[`${Y}-something-after-last-item`]:X,[`${Y}-rtl`]:"rtl"===U},W,v,j,Q,ee),en=(0,a.default)({current:1,total:0,position:"bottom"},{total:T.length,current:A,pageSize:R},h||{}),ei=Math.ceil(en.total/en.pageSize);en.current=Math.min(en.current,ei);let eo=h&&r.createElement("div",{className:(0,s.default)(`${Y}-pagination`)},r.createElement(m.default,Object.assign({align:"end"},en,{onChange:K,onShowSizeChange:G}))),ec=(0,t.default)(T);h&&T.length>(en.current-1)*en.pageSize&&(ec=(0,t.default)(T).splice((en.current-1)*en.pageSize,en.pageSize));let ed=Object.keys(k||{}).some(e=>["xs","sm","md","lg","xl","xxl"].includes(e)),em=(0,d.default)(ed),ep=r.useMemo(()=>{for(let e=0;e<l.responsiveArray.length;e+=1){let t=l.responsiveArray[e];if(em[t])return t}},[em]),eu=r.useMemo(()=>{if(!k)return;let e=ep&&k[ep]?k[ep]:k.column;if(e)return{width:`${100/e}%`,maxWidth:`${100/e}%`}},[JSON.stringify(k),ep]),ex=er&&r.createElement("div",{style:{minHeight:53}});if(ec.length>0){let e=ec.map((e,t)=>{let s;return B?((s="function"==typeof I?I(e):I?e[I]:e.key)||(s=`list-item-${t}`),r.createElement(r.Fragment,{key:s},B(e,t))):null});ex=k?r.createElement(c.Row,{gutter:k.gutter},r.Children.map(e,e=>r.createElement("div",{key:null==e?void 0:e.key,style:eu},e))):r.createElement("ul",{className:`${Y}-items`},e)}else w||er||(ex=r.createElement("div",{className:`${Y}-empty-text`},(null==z?void 0:z.emptyText)||(null==V?void 0:V("List"))||r.createElement(i.default,{componentName:"List"})));let eh=en.position,eg=r.useMemo(()=>({grid:k,itemLayout:C}),[JSON.stringify(k),C]);return Z(r.createElement(u.Provider,{value:eg},r.createElement("div",Object.assign({ref:x,style:Object.assign(Object.assign({},J),b),className:el},M),("top"===eh||"both"===eh)&&eo,P&&r.createElement("div",{className:`${Y}-header`},P),r.createElement(p.default,Object.assign({},et),ex,w),E&&r.createElement("div",{className:`${Y}-footer`},E),S||("bottom"===eh||"both"===eh)&&eo)))});w.Item=f,e.s(["List",0,w],573421)},903446,e=>{"use strict";let t=(0,e.i(475254).default)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["default",()=>t])},191403,180127,516430,e=>{"use strict";var t=e.i(843476),r=e.i(271645),s=e.i(994388),a=e.i(212931),l=e.i(764205),n=e.i(269200),i=e.i(942232),o=e.i(977572),c=e.i(427612),d=e.i(64848),m=e.i(496020),p=e.i(94629),u=e.i(360820),x=e.i(871943),h=e.i(68155),g=e.i(592968),f=e.i(166406),y=e.i(152990),v=e.i(682830),j=e.i(916925);let b=e=>{let t=new Set,r=/\{\{(\w+)\}\}/g;if(e.messages.forEach(e=>{let s;for(;null!==(s=r.exec(e.content));)t.add(s[1])}),e.developerMessage){let s;for(;null!==(s=r.exec(e.developerMessage));)t.add(s[1])}return Array.from(t)},N=e=>{let t=b(e),r=`---
model: ${e.model}
`;return void 0!==e.config.temperature&&(r+=`temperature: ${e.config.temperature}
`),void 0!==e.config.max_tokens&&(r+=`max_tokens: ${e.config.max_tokens}
`),void 0!==e.config.top_p&&(r+=`top_p: ${e.config.top_p}
`),r+=`input:
  schema:
`,t.forEach(e=>{r+=`    ${e}: string
`}),r+=`output:
  format: text
`,e.tools&&e.tools.length>0&&(r+=`tools:
`,e.tools.forEach(e=>{let t=JSON.parse(e.json);r+=`  - ${JSON.stringify(t)}
`})),r+=`---

`,e.developerMessage&&""!==e.developerMessage.trim()&&(r+=`Developer: ${e.developerMessage.trim()}

`),e.messages.forEach(e=>{let t=e.role.charAt(0).toUpperCase()+e.role.slice(1);r+=`${t}: ${e.content}

`}),r.trim()},$=e=>{let t=Number(e);return Number.isFinite(t)?t:void 0},w=e=>{let t=e?.prompt_spec?.litellm_params?.dotprompt_content||"";if(!t)throw Error("No dotprompt_content found in API response");let r=t.split("---");if(r.length<3)throw Error("Invalid dotprompt format");let s=r[1],a=r.slice(2).join("---").trim(),l=(e=>{let t={config:{},tools:[]},r=e.split("\n");for(let e of(t.tools=(e=>{let t=[],r=!1;for(let s of e){let e=s.trim();if(!r){("tools:"===e||e.startsWith("tools:"))&&(r=!0);continue}if(s.length>0&&!/^\s/.test(s)&&"-"!==e&&!e.startsWith("-"))break;let a=e.match(/^-+\s*(.+)$/);if(!a)continue;let l=a[1].trim();if(l)try{let e=JSON.parse(l);t.push({name:e?.function?.name||"Unnamed Tool",description:e?.function?.description||"",json:JSON.stringify(e,null,2)})}catch{}}return t})(r),r)){let r=e.trim();if(!r||r.startsWith("input:")||r.startsWith("output:")||r.startsWith("schema:")||r.startsWith("format:")||r.startsWith("tools:")||r.startsWith("-"))continue;let s=r.indexOf(":");if(s<=0)continue;let a=r.substring(0,s).trim(),l=r.substring(s+1).trim();if("model"===a){t.model=l;continue}"temperature"===a&&(t.config.temperature=$(l)),"max_tokens"===a&&(t.config.max_tokens=$(l)),"top_p"===a&&(t.config.top_p=$(l))}return t})(s),n=(e=>{let t=/^(System|Developer|User|Assistant):(?:\s(.*)|\s*)$/,r=[],s="",a=null,l=[],n=()=>{if(!a)return;let e=l.join("\n").trim();"developer"===a?e&&(s=s?`${s}

${e}`:e):e?r.push({role:a,content:e}):r.push({role:a,content:""})};for(let r of e.split("\n")){let e=r.match(t);if(e){n(),a=e[1].toLowerCase(),l=[e[2]??""];continue}a&&l.push(r)}return n(),{developerMessage:s,messages:r}})(a),i=e?.prompt_spec?.prompt_id||"Unnamed Prompt";return{name:C(i)||i,model:l.model||"gpt-4o",config:l.config,tools:l.tools,developerMessage:n.developerMessage,messages:n.messages.length>0?n.messages:[{role:"user",content:"Enter task specifics. Use {{template_variables}} for dynamic inputs"}]}},C=e=>e?e.replace(/[._-]v\d+$/,""):"",S=e=>e?.prompt_id||"",k=e=>{try{let t=e.litellm_params;if(t?.dotprompt_content){let e=t.dotprompt_content.match(/model:\s*([^\n]+)/);if(e)return e[1].trim()}if(t?.prompt_data?.model)return t.prompt_data.model;if(t?.model)return t.model;return null}catch(e){return console.error("Error extracting model:",e),null}},T=({promptsList:e,isLoading:a,onPromptClick:b,onDeleteClick:N,accessToken:$,isAdmin:w})=>{let[C,S]=(0,r.useState)([{id:"created_at",desc:!0}]),[T,_]=(0,r.useState)(new Map);(0,r.useEffect)(()=>{(async()=>{if($)try{let e=await (0,l.modelHubCall)($);if(e?.data){let t=new Map;e.data.forEach(e=>{t.set(e.model_group,e)}),_(t)}}catch(e){console.error("Error fetching model hub data:",e)}})()},[$]);let P=e=>e?new Date(e).toLocaleString():"-",E=[{header:"Prompt ID",accessorKey:"prompt_id",cell:e=>{let r=String(e.getValue()||""),a=r.length>25?`${r.slice(0,25)}...`:r;return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g.Tooltip,{title:r,children:(0,t.jsx)(s.Button,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate min-w-[220px] justify-start",onClick:()=>e.getValue()&&b?.(e.getValue()),children:a})}),(0,t.jsx)(g.Tooltip,{title:"Copy prompt ID",children:(0,t.jsx)(f.CopyOutlined,{onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(r)},className:"cursor-pointer text-gray-500 hover:text-blue-500 text-xs"})})]})}},{header:"Model",accessorKey:"model",cell:({row:e})=>{let r=k(e.original);if(!r)return(0,t.jsx)("span",{className:"text-xs text-gray-400",children:"-"});let s=((e,t)=>{if(!e)return null;let r=t.get(e);return r&&r.providers&&r.providers.length>0?r.providers[0]:null})(r,T),{logo:a}=(0,j.getProviderLogoAndName)(s||"");return(0,t.jsx)(g.Tooltip,{title:r,children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:s&&a?(0,t.jsx)("img",{src:a,alt:`${s} logo`,className:"w-4 h-4",onError:e=>{let t=e.currentTarget,r=t.parentElement;if(r&&r.contains(t))try{let e=document.createElement("div");e.className="w-4 h-4 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=s?.charAt(0)||"-",r.replaceChild(e,t)}catch(e){console.error("Failed to replace provider logo fallback:",e)}}}):(0,t.jsx)("div",{className:"w-4 h-4 rounded-full bg-gray-200 flex items-center justify-center text-xs",children:"-"})}),(0,t.jsx)("span",{className:"max-w-[15ch] truncate block",children:r})]})})}},{header:"Created At",accessorKey:"created_at",cell:({row:e})=>{let r=e.original;return(0,t.jsx)(g.Tooltip,{title:r.created_at,children:(0,t.jsx)("span",{className:"text-xs",children:P(r.created_at)})})}},{header:"Updated At",accessorKey:"updated_at",cell:({row:e})=>{let r=e.original;return(0,t.jsx)(g.Tooltip,{title:r.updated_at,children:(0,t.jsx)("span",{className:"text-xs",children:P(r.updated_at)})})}},{header:"Type",accessorKey:"prompt_info.prompt_type",cell:({row:e})=>{let r=e.original;return(0,t.jsx)(g.Tooltip,{title:r.prompt_info.prompt_type,children:(0,t.jsx)("span",{className:"text-xs",children:r.prompt_info.prompt_type})})}},...w?[{header:"Actions",id:"actions",enableSorting:!1,cell:({row:e})=>{let r=e.original,a=r.prompt_id||"Unknown Prompt";return(0,t.jsx)("div",{className:"flex items-center gap-1",children:(0,t.jsx)(g.Tooltip,{title:"Delete prompt",children:(0,t.jsx)(s.Button,{size:"xs",variant:"light",color:"red",onClick:e=>{e.stopPropagation(),N?.(r.prompt_id,a)},icon:h.TrashIcon,className:"text-red-500 hover:text-red-700 hover:bg-red-50"})})})}}]:[]],O=(0,y.useReactTable)({data:e,columns:E,state:{sorting:C},onSortingChange:S,getCoreRowModel:(0,v.getCoreRowModel)(),getSortedRowModel:(0,v.getSortedRowModel)(),enableSorting:!0});return(0,t.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(n.Table,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,t.jsx)(c.TableHead,{children:O.getHeaderGroups().map(e=>(0,t.jsx)(m.TableRow,{children:e.headers.map(e=>(0,t.jsx)(d.TableHeaderCell,{className:"py-1 h-8",onClick:e.column.getToggleSortingHandler(),children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,y.flexRender)(e.column.columnDef.header,e.getContext())}),(0,t.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,t.jsx)(u.ChevronUpIcon,{className:"h-4 w-4 text-blue-500"}),desc:(0,t.jsx)(x.ChevronDownIcon,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,t.jsx)(p.SwitchVerticalIcon,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,t.jsx)(i.TableBody,{children:a?(0,t.jsx)(m.TableRow,{children:(0,t.jsx)(o.TableCell,{colSpan:E.length,className:"h-8 text-center",children:(0,t.jsx)("div",{className:"text-center text-gray-500",children:(0,t.jsx)("p",{children:"Loading..."})})})}):e.length>0?O.getRowModel().rows.map(e=>(0,t.jsx)(m.TableRow,{className:"h-8",children:e.getVisibleCells().map(e=>(0,t.jsx)(o.TableCell,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,y.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,t.jsx)(m.TableRow,{children:(0,t.jsx)(o.TableCell,{colSpan:E.length,className:"h-8 text-center",children:(0,t.jsx)("div",{className:"text-center text-gray-500",children:(0,t.jsx)("p",{children:"No prompts found"})})})})})]})})})};var _=e.i(304967),P=e.i(629569),E=e.i(599724),O=e.i(350967),I=e.i(389083),B=e.i(197647),z=e.i(653824),M=e.i(881073),L=e.i(404206),A=e.i(723731),D=e.i(464571),R=e.i(530212),F=e.i(797672),H=e.i(500330),U=e.i(678784),W=e.i(118366),J=e.i(727749),V=e.i(199133),q=e.i(653496),K=e.i(245094),G=e.i(650056),X=e.i(219470);let Y=({promptId:e,model:l,promptVariables:n={},accessToken:i,version:o="1",proxySettings:c})=>{let[d,m]=(0,r.useState)(!1),[p,u]=(0,r.useState)("curl"),[x,h]=(0,r.useState)("basic"),[g,f]=(0,r.useState)(""),y=window.location.origin,v=c?.LITELLM_UI_API_DOC_BASE_URL;v&&v.trim()?y=v:c?.PROXY_BASE_URL&&(y=c.PROXY_BASE_URL);let j=i||"sk-1234";return r.default.useEffect(()=>{d&&f((()=>{let t=Object.keys(n).length>0;if("curl"===p)if("basic"===x)return`curl -X POST '${y}/chat/completions' \\
  -H 'Content-Type: application/json' \\
  -H 'Authorization: Bearer ${j}' \\
  -d '{
    "model": "${l}",
    "prompt_id": "${e}"${t?`,
    "prompt_variables": ${JSON.stringify(n,null,6).replace(/\n/g,"\n    ")}`:""}
  }' | jq`;else if("messages"===x)return`curl -X POST '${y}/chat/completions' \\
  -H 'Content-Type: application/json' \\
  -H 'Authorization: Bearer ${j}' \\
  -d '{
    "model": "${l}",
    "prompt_id": "${e}"${t?`,
    "prompt_variables": ${JSON.stringify(n,null,6).replace(/\n/g,"\n    ")}`:""},
    "messages": [
      {
        "role": "user",
        "content": "hi"
      }
    ]
  }' | jq`;else return`curl -X POST '${y}/chat/completions' \\
  -H 'Content-Type: application/json' \\
  -H 'Authorization: Bearer ${j}' \\
  -d '{
    "model": "${l}",
    "prompt_id": "${e}",
    "prompt_version": ${o},
    "messages": [
      {
        "role": "user",
        "content": "Who are u"
      }
    ]
  }' | jq`;if("python"===p){let r=`import openai

client = openai.OpenAI(
    api_key="${j}",
    base_url="${y}"
)
`;return"basic"===x?`${r}
response = client.chat.completions.create(
    model="${l}",
    extra_body={
        "prompt_id": "${e}"${t?`,
        "prompt_variables": ${JSON.stringify(n,null,8).replace(/\n/g,"\n        ")}`:""}
    }
)

print(response)`:"messages"===x?`${r}
response = client.chat.completions.create(
    model="${l}",
    messages=[
        {"role": "user", "content": "hi"}
    ],
    extra_body={
        "prompt_id": "${e}"${t?`,
        "prompt_variables": ${JSON.stringify(n,null,8).replace(/\n/g,"\n        ")}`:""}
    }
)

print(response)`:`${r}
response = client.chat.completions.create(
    model="${l}",
    messages=[
        {"role": "user", "content": "Who are u"}
    ],
    extra_body={
        "prompt_id": "${e}",
        "prompt_version": ${o}
    }
)

print(response)`}{let r=`import OpenAI from 'openai';

const client = new OpenAI({
    apiKey: "${j}",
    baseURL: "${y}"
});
`;return"basic"===x?`${r}
async function main() {
    const response = await client.chat.completions.create({
        model: "${l}",
        ${t?`prompt_id: "${e}",
        prompt_variables: ${JSON.stringify(n,null,8).replace(/\n/g,"\n        ")}`:`prompt_id: "${e}"`}
    });
    
    console.log(response);
}

main();`:"messages"===x?`${r}
async function main() {
    const response = await client.chat.completions.create({
        model: "${l}",
        messages: [
            { role: "user", content: "hi" }
        ],
        ${t?`prompt_id: "${e}",
        prompt_variables: ${JSON.stringify(n,null,8).replace(/\n/g,"\n        ")}`:`prompt_id: "${e}"`}
    });
    
    console.log(response);
}

main();`:`${r}
async function main() {
    const response = await client.chat.completions.create({
        model: "${l}",
        messages: [
            { role: "user", content: "Who are u" }
        ],
        prompt_id: "${e}",
        prompt_version: ${o}
    });
    
    console.log(response);
}

main();`}})())},[d,p,x,e,l,n]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Button,{variant:"secondary",icon:K.CodeOutlined,onClick:()=>{m(!0)},children:"Get Code"}),(0,t.jsxs)(a.Modal,{title:"Generated Code",open:d,onCancel:()=>{m(!1)},footer:null,width:800,children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(E.Text,{className:"font-medium block mb-1 text-gray-700",children:"Language"}),(0,t.jsx)(V.Select,{value:p,onChange:e=>u(e),style:{width:180},options:[{value:"curl",label:"cURL"},{value:"python",label:"Python (OpenAI SDK)"},{value:"javascript",label:"JavaScript (OpenAI SDK)"}]})]}),(0,t.jsx)(D.Button,{onClick:()=>{navigator.clipboard.writeText(g),J.default.success("Copied to clipboard!")},children:"Copy to Clipboard"})]}),(0,t.jsx)(q.Tabs,{activeKey:x,onChange:h,items:[{label:"Basic",key:"basic"},{label:"With Messages",key:"messages"},{label:"With Version",key:"version"}]}),(0,t.jsx)(G.Prism,{language:"curl"===p?"bash":"python"===p?"python":"javascript",style:X.coy,wrapLines:!0,wrapLongLines:!0,className:"rounded-md mt-0",customStyle:{maxHeight:"60vh",overflowY:"auto",marginTop:0,borderTopLeftRadius:0,borderTopRightRadius:0},children:g})]})]})},Z=({promptId:e,onClose:n,accessToken:i,isAdmin:o,onDelete:c,onEdit:d})=>{let[m,p]=(0,r.useState)(null),[u,x]=(0,r.useState)(null),[g,f]=(0,r.useState)(null),[y,v]=(0,r.useState)(!0),[j,b]=(0,r.useState)({}),[N,$]=(0,r.useState)(!1),[w,C]=(0,r.useState)(!1),T=async()=>{try{if(v(!0),!i)return;let t=await (0,l.getPromptInfo)(i,e);p(t.prompt_spec),x(t.raw_prompt_template),f(t)}catch(e){J.default.fromBackend("Failed to load prompt information"),console.error("Error fetching prompt info:",e)}finally{v(!1)}};if((0,r.useEffect)(()=>{T()},[e,i]),y)return(0,t.jsx)("div",{className:"p-4",children:"Loading..."});if(!m)return(0,t.jsx)("div",{className:"p-4",children:"Prompt not found"});let V=e=>e?new Date(e).toLocaleString():"-",q=async(e,t)=>{await (0,H.copyToClipboard)(e)&&(b(e=>({...e,[t]:!0})),setTimeout(()=>{b(e=>({...e,[t]:!1}))},2e3))},K=async()=>{if(i&&m){C(!0);try{await (0,l.deletePromptCall)(i,X),J.default.success(`Prompt "${X}" deleted successfully`),c?.(),n()}catch(e){console.error("Error deleting prompt:",e),J.default.fromBackend("Failed to delete prompt")}finally{C(!1),$(!1)}}},G=m&&k(m)||"gpt-4o",X=S(m),Z=(e=>{let t;if(e?.version)return String(e.version);var r=(t=S(e),e?.litellm_params?.prompt_id||t);if(!r)return"1";let s=r.match(/[._-]v(\d+)$/);return s?s[1]:"1"})(m);return(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(s.Button,{icon:R.ArrowLeftIcon,variant:"light",onClick:n,className:"mb-4",children:"Back to Prompts"}),(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(P.Title,{children:"Prompt Details"}),(0,t.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,t.jsx)(E.Text,{className:"text-gray-500 font-mono",children:X}),(0,t.jsx)(D.Button,{type:"text",size:"small",icon:j["prompt-id"]?(0,t.jsx)(U.CheckIcon,{size:12}):(0,t.jsx)(W.CopyIcon,{size:12}),onClick:()=>q(X,"prompt-id"),className:`left-2 z-10 transition-all duration-200 ${j["prompt-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(Y,{promptId:X,model:G,promptVariables:(e=>{let t;if(!e)return{};let r={},s=/\{\{(\w+)\}\}/g;for(;null!==(t=s.exec(e));){let e=t[1];r[e]||(r[e]=`example_${e}`)}return r})(u?.content),accessToken:i,version:Z}),(0,t.jsx)(s.Button,{icon:F.PencilIcon,variant:"primary",onClick:()=>d?.(g),className:"flex items-center",children:"Prompt Studio"}),o&&(0,t.jsx)(s.Button,{icon:h.TrashIcon,variant:"secondary",onClick:()=>{$(!0)},className:"flex items-center",children:"Delete Prompt"})]})]})]}),(0,t.jsxs)(z.TabGroup,{children:[(0,t.jsxs)(M.TabList,{className:"mb-4",children:[(0,t.jsx)(B.Tab,{children:"Overview"},"overview"),u?(0,t.jsx)(B.Tab,{children:"Prompt Template"},"prompt-template"):(0,t.jsx)(t.Fragment,{}),o?(0,t.jsx)(B.Tab,{children:"Details"},"details"):(0,t.jsx)(t.Fragment,{}),(0,t.jsx)(B.Tab,{children:"Raw JSON"},"raw-json")]}),(0,t.jsxs)(A.TabPanels,{children:[(0,t.jsxs)(L.TabPanel,{children:[(0,t.jsxs)(O.Grid,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,t.jsxs)(_.Card,{children:[(0,t.jsx)(E.Text,{children:"Prompt ID"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(P.Title,{className:"font-mono text-sm",children:X})})]}),(0,t.jsxs)(_.Card,{children:[(0,t.jsx)(E.Text,{children:"Version"}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)(P.Title,{children:Z}),(0,t.jsxs)(I.Badge,{color:"blue",className:"mt-1",children:["v",Z]})]})]}),(0,t.jsxs)(_.Card,{children:[(0,t.jsx)(E.Text,{children:"Prompt Type"}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)(P.Title,{children:m.prompt_info?.prompt_type||"-"}),(0,t.jsx)(I.Badge,{color:"blue",className:"mt-1",children:m.prompt_info?.prompt_type||"Unknown"})]})]}),(0,t.jsxs)(_.Card,{children:[(0,t.jsx)(E.Text,{children:"Created At"}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)(P.Title,{children:V(m.created_at)}),(0,t.jsxs)(E.Text,{children:["Last Updated: ",V(m.updated_at)]})]})]})]}),m.litellm_params&&Object.keys(m.litellm_params).length>0&&(0,t.jsxs)(_.Card,{className:"mt-6",children:[(0,t.jsx)(E.Text,{className:"font-medium",children:"LiteLLM Parameters"}),(0,t.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md",children:(0,t.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(m.litellm_params,null,2)})})]})]}),u&&(0,t.jsx)(L.TabPanel,{children:(0,t.jsxs)(_.Card,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)(P.Title,{children:"Prompt Template"}),(0,t.jsx)(D.Button,{type:"text",size:"small",icon:j["prompt-content"]?(0,t.jsx)(U.CheckIcon,{size:16}):(0,t.jsx)(W.CopyIcon,{size:16}),onClick:()=>q(u.content,"prompt-content"),className:`transition-all duration-200 ${j["prompt-content"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:j["prompt-content"]?"Copied!":"Copy Content"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(E.Text,{className:"font-medium",children:"Template ID"}),(0,t.jsx)("div",{className:"font-mono text-sm bg-gray-50 p-2 rounded",children:u.litellm_prompt_id})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(E.Text,{className:"font-medium",children:"Content"}),(0,t.jsx)("div",{className:"mt-2 p-4 bg-gray-50 rounded-md border overflow-auto max-h-96",children:(0,t.jsx)("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:u.content})})]}),u.metadata&&Object.keys(u.metadata).length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)(E.Text,{className:"font-medium",children:"Template Metadata"}),(0,t.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,t.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap overflow-auto max-h-64",children:JSON.stringify(u.metadata,null,2)})})]})]})]})}),o&&(0,t.jsx)(L.TabPanel,{children:(0,t.jsxs)(_.Card,{children:[(0,t.jsx)(P.Title,{className:"mb-4",children:"Prompt Details"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(E.Text,{className:"font-medium",children:"Prompt ID"}),(0,t.jsx)("div",{className:"font-mono text-sm bg-gray-50 p-2 rounded",children:X})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(E.Text,{className:"font-medium",children:"Prompt Type"}),(0,t.jsx)("div",{children:m.prompt_info?.prompt_type||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(E.Text,{className:"font-medium",children:"Created At"}),(0,t.jsx)("div",{children:V(m.created_at)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(E.Text,{className:"font-medium",children:"Last Updated"}),(0,t.jsx)("div",{children:V(m.updated_at)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(E.Text,{className:"font-medium",children:"LiteLLM Parameters"}),(0,t.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,t.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap overflow-auto max-h-96",children:JSON.stringify(m.litellm_params,null,2)})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(E.Text,{className:"font-medium",children:"Prompt Info"}),(0,t.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,t.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(m.prompt_info,null,2)})})]})]})]})}),(0,t.jsx)(L.TabPanel,{children:(0,t.jsxs)(_.Card,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)(P.Title,{children:"Raw API Response"}),(0,t.jsx)(D.Button,{type:"text",size:"small",icon:j["raw-json"]?(0,t.jsx)(U.CheckIcon,{size:16}):(0,t.jsx)(W.CopyIcon,{size:16}),onClick:()=>q(JSON.stringify(g,null,2),"raw-json"),className:`transition-all duration-200 ${j["raw-json"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:j["raw-json"]?"Copied!":"Copy JSON"})]}),(0,t.jsx)("div",{className:"p-4 bg-gray-50 rounded-md border overflow-auto",children:(0,t.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(g,null,2)})})]})})]})]}),(0,t.jsxs)(a.Modal,{title:"Delete Prompt",open:N,onOk:K,onCancel:()=>{$(!1)},confirmLoading:w,okText:"Delete",okButtonProps:{danger:!0},children:[(0,t.jsxs)("p",{children:["Are you sure you want to delete prompt: ",(0,t.jsx)("strong",{children:X}),"?"]}),(0,t.jsx)("p",{children:"This action cannot be undone."})]})]})};var Q=e.i(808613),ee=e.i(515831),et=e.i(312361),er=e.i(779241),es=e.i(519756);let{Option:ea}=V.Select,el=({visible:e,onClose:s,accessToken:n,onSuccess:i})=>{let[o]=Q.Form.useForm(),[c,d]=(0,r.useState)(!1),[m,p]=(0,r.useState)([]),[u,x]=(0,r.useState)("dotprompt"),h=()=>{o.resetFields(),p([]),x("dotprompt"),s()},g=async()=>{try{let e=await o.validateFields();if(console.log("values: ",e),!n)return void J.default.fromBackend("Access token is required");if("dotprompt"===u&&0===m.length)return void J.default.fromBackend("Please upload a .prompt file");d(!0);let t={};if("dotprompt"===u&&m.length>0){let r=m[0].originFileObj;try{let s=await (0,l.convertPromptFileToJson)(n,r);console.log("Conversion result:",s),t={prompt_id:e.prompt_id,litellm_params:{prompt_integration:"dotprompt",prompt_id:s.prompt_id,prompt_data:s.json_data},prompt_info:{prompt_type:"db"}}}catch(e){console.error("Error converting prompt file:",e),J.default.fromBackend("Failed to convert prompt file to JSON"),d(!1);return}}try{await (0,l.createPromptCall)(n,t),J.default.success("Prompt created successfully!"),h(),i()}catch(e){console.error("Error creating prompt:",e),J.default.fromBackend("Failed to create prompt")}}catch(e){console.error("Form validation error:",e)}finally{d(!1)}};return(0,t.jsx)(a.Modal,{title:"Add New Prompt",open:e,onCancel:h,footer:[(0,t.jsx)(D.Button,{onClick:h,children:"Cancel"},"cancel"),(0,t.jsx)(D.Button,{loading:c,onClick:g,children:"Create Prompt"},"submit")],width:600,children:(0,t.jsxs)(Q.Form,{form:o,layout:"vertical",requiredMark:!1,children:[(0,t.jsx)(Q.Form.Item,{label:"Prompt ID",name:"prompt_id",rules:[{required:!0,message:"Please enter a prompt ID"},{pattern:/^[a-zA-Z0-9_-]+$/,message:"Prompt ID can only contain letters, numbers, underscores, and hyphens"}],children:(0,t.jsx)(er.TextInput,{placeholder:"Enter unique prompt ID (e.g., my_prompt_id)"})}),(0,t.jsx)(Q.Form.Item,{label:"Prompt Integration",name:"prompt_integration",initialValue:"dotprompt",children:(0,t.jsx)(V.Select,{value:u,onChange:x,children:(0,t.jsx)(ea,{value:"dotprompt",children:"dotprompt"})})}),"dotprompt"===u&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(et.Divider,{}),(0,t.jsxs)(Q.Form.Item,{label:"Prompt File",extra:"Upload a .prompt file that follows the Dotprompt specification",children:[(0,t.jsx)(ee.Upload,{...{beforeUpload:e=>(e.name.endsWith(".prompt")||J.default.fromBackend("Please upload a .prompt file"),!1),fileList:m,onChange:({fileList:e})=>{p(e.slice(-1))},onRemove:()=>{p([])}},children:(0,t.jsx)(D.Button,{icon:(0,t.jsx)(es.UploadOutlined,{}),children:"Select .prompt File"})}),m.length>0&&(0,t.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",m[0].name]})]})]})]})})},en=`{
  "type": "function",
  "function": {
    "name": "get_current_weather",
    "description": "Get the current weather in a given location",
    "parameters": {
      "type": "object",
      "properties": {
        "location": {
          "type": "string",
          "description": "The city and state, e.g. San Francisco, CA"
        },
        "unit": {
          "type": "string",
          "enum": ["celsius", "fahrenheit"]
        }
      },
      "required": ["location"]
    }
  }
}`,ei=({visible:e,initialJson:s,onSave:l,onClose:n})=>{let[i,o]=(0,r.useState)(s||en),[c,d]=(0,r.useState)(null),m=()=>{d(null),n()};return(0,t.jsx)(a.Modal,{title:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)("span",{className:"text-lg font-medium",children:"Add Tool"})}),open:e,onCancel:m,width:800,footer:[(0,t.jsx)(D.Button,{onClick:m,children:"Cancel"},"cancel"),(0,t.jsx)(D.Button,{type:"primary",onClick:()=>{try{JSON.parse(i),d(null),l(i)}catch(e){d("Invalid JSON format. Please check your syntax.")}},children:"Add"},"save")],children:(0,t.jsxs)("div",{className:"space-y-3",children:[c&&(0,t.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-red-600 text-sm",children:c}),(0,t.jsx)("textarea",{value:i,onChange:e=>o(e.target.value),className:"w-full min-h-[400px] px-4 py-3 border border-gray-300 rounded-lg text-sm font-mono focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Paste your tool JSON here..."})]})})};var eo=e.i(311451),ec=e.i(475254);let ed=(0,ec.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["default",()=>ed],180127),e.s(["ArrowLeftIcon",()=>ed],516430);let em=(0,ec.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),ep=(0,ec.default)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),eu=({promptName:e,onNameChange:r,onBack:a,onSave:l,isSaving:n,editMode:i=!1,onShowHistory:o,version:c,promptModel:d="gpt-4o",promptVariables:m={},accessToken:p,proxySettings:u})=>(0,t.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 py-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(s.Button,{icon:ed,variant:"light",onClick:a,size:"xs",children:"Back"}),(0,t.jsx)(eo.Input,{value:e,onChange:e=>r(e.target.value),className:"text-base font-medium border-none shadow-none",style:{width:"200px"}}),c&&(0,t.jsx)("span",{className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-700 rounded font-medium",children:c}),(0,t.jsx)("span",{className:"px-2 py-0.5 text-xs bg-gray-100 text-gray-600 rounded",children:"Draft"}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:"Unsaved changes"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(Y,{promptId:e,model:d,promptVariables:m,accessToken:p,version:c?.replace("v","")||"1",proxySettings:u}),i&&o&&(0,t.jsx)(s.Button,{icon:ep,variant:"secondary",onClick:o,children:"History"}),(0,t.jsx)(s.Button,{icon:em,onClick:l,loading:n,disabled:n,children:i?"Update":"Save"})]})]});var ex=e.i(903446),ex=ex,eh=e.i(992619);let eg=({model:e,temperature:s=1,maxTokens:a=1e3,accessToken:l,onModelChange:n,onTemperatureChange:i,onMaxTokensChange:o})=>{let[c,d]=(0,r.useState)(!1);return(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-[300px]",children:(0,t.jsx)(eh.default,{accessToken:l||"",value:e,onChange:n,showLabel:!1})}),(0,t.jsxs)("button",{onClick:()=>d(!c),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,t.jsx)(ex.default,{size:16}),(0,t.jsx)("span",{children:"Parameters"})]}),c&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Model Parameters"}),(0,t.jsx)("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)(E.Text,{className:"text-sm text-gray-700",children:"Temperature"}),(0,t.jsx)(eo.Input,{type:"number",size:"small",min:0,max:2,step:.1,value:s,onChange:e=>i(parseFloat(e.target.value)||0),className:"w-20"})]})}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)(E.Text,{className:"text-sm text-gray-700",children:"Max Tokens"}),(0,t.jsx)(eo.Input,{type:"number",size:"small",min:1,max:32768,value:a,onChange:e=>o(parseInt(e.target.value)||1e3),className:"w-24"})]})})]})]})})]})};var ef=e.i(603908),ef=ef;let ey=(0,ec.default)("trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),ev=({tools:e,onAddTool:r,onEditTool:s,onRemoveTool:a})=>(0,t.jsxs)(_.Card,{className:"p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)(E.Text,{className:"text-sm font-medium",children:"Tools"}),(0,t.jsxs)("button",{onClick:r,className:"text-xs text-blue-600 hover:text-blue-700 flex items-center",children:[(0,t.jsx)(ef.default,{size:14,className:"mr-1"}),"Add"]})]}),0===e.length?(0,t.jsx)(E.Text,{className:"text-gray-500 text-xs",children:"No tools added"}):(0,t.jsx)("div",{className:"space-y-2",children:e.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"font-medium text-xs truncate",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.description})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1 ml-2",children:[(0,t.jsx)("button",{onClick:()=>s(r),className:"text-xs text-blue-600 hover:text-blue-700",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>a(r),className:"text-gray-400 hover:text-red-500",children:(0,t.jsx)(ey,{size:14})})]})]},r))})]});var ej=e.i(282786),eb=e.i(262218),eN=e.i(751904);let{TextArea:e$}=eo.Input,ew=({value:e,onChange:s,placeholder:a,rows:l=4,className:n})=>{let[i,o]=(0,r.useState)(null),[c,d]=(0,r.useState)(""),m=()=>{c.trim()&&i&&(s(e.substring(0,i.start)+`{{${c}}}`+e.substring(i.end)),o(null),d(""))},p=(()=>{let t,r=/\{\{(\w+)\}\}/g,s=[];for(;null!==(t=r.exec(e));)s.push({name:t[1],start:t.index,end:t.index+t[0].length});return s})();return(0,t.jsxs)("div",{className:`variable-textarea-container ${n}`,children:[(0,t.jsx)("style",{children:`
          .variable-highlight-text {
            color: #f97316;
            background-color: #fff7ed;
            border-radius: 4px;
            padding: 0 2px;
            border: 1px solid #fed7aa;
            font-family: monospace;
          }
        `}),(0,t.jsx)(e$,{value:e,onChange:e=>s(e.target.value),placeholder:a,rows:l,className:"font-sans"}),p.length>0&&(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2 items-center",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500 mr-1",children:"Detected variables:"}),p.map((e,r)=>(0,t.jsx)(ej.Popover,{content:(0,t.jsxs)("div",{className:"p-2",style:{minWidth:"200px"},children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Edit variable name"}),(0,t.jsx)(eo.Input,{size:"small",value:c,onChange:e=>d(e.target.value),onPressEnter:m,placeholder:"Variable name",autoFocus:!0}),(0,t.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,t.jsx)("button",{onClick:m,className:"text-xs px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Save"}),(0,t.jsx)("button",{onClick:()=>{o(null),d("")},className:"text-xs px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:"Cancel"})]})]}),open:i?.start===e.start,onOpenChange:e=>{e||(o(null),d(""))},trigger:"click",children:(0,t.jsx)(eb.Tag,{color:"orange",className:"cursor-pointer hover:opacity-80 transition-all m-0",icon:(0,t.jsx)(eN.EditOutlined,{}),onClick:()=>{o({oldName:e.name,start:e.start,end:e.end}),d(e.name)},children:e.name})},`${e.start}-${r}`))]})]})},eC=({value:e,onChange:r})=>(0,t.jsxs)(_.Card,{className:"p-3",children:[(0,t.jsx)(E.Text,{className:"block mb-2 text-sm font-medium",children:"Developer message"}),(0,t.jsx)(E.Text,{className:"text-gray-500 text-xs mb-2",children:"Optional system instructions for the model"}),(0,t.jsx)(ew,{value:e,onChange:r,rows:3,placeholder:"e.g., You are a helpful assistant..."})]});var ef=ef;let eS=(0,ec.default)("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),{Option:ek}=V.Select,eT=({messages:e,onAddMessage:s,onUpdateMessage:a,onRemoveMessage:l,onMoveMessage:n})=>{let[i,o]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),m=()=>{o(null),d(null)};return(0,t.jsxs)(_.Card,{className:"p-3",children:[(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsx)(E.Text,{className:"text-sm font-medium",children:"Prompt messages"}),(0,t.jsxs)(E.Text,{className:"text-gray-500 text-xs mt-1",children:["Use ",(0,t.jsx)("code",{className:"bg-gray-100 px-1 rounded text-xs",children:"{{variable}}"})," syntax for template variables"]})]}),(0,t.jsx)("div",{className:"space-y-2",children:e.map((r,s)=>(0,t.jsxs)("div",{draggable:!0,onDragStart:()=>{o(s)},onDragOver:e=>{e.preventDefault(),d(s)},onDrop:e=>{e.preventDefault(),null!==i&&i!==s&&n(i,s),o(null),d(null)},onDragEnd:m,className:`border border-gray-300 rounded overflow-hidden bg-white transition-all ${i===s?"opacity-50":""} ${c===s&&i!==s?"border-blue-500 border-2":""}`,children:[(0,t.jsxs)("div",{className:"bg-gray-50 px-2 py-1.5 border-b border-gray-300 flex items-center justify-between",children:[(0,t.jsxs)(V.Select,{value:r.role,onChange:e=>a(s,"role",e),style:{width:100},size:"small",bordered:!1,children:[(0,t.jsx)(ek,{value:"user",children:"User"}),(0,t.jsx)(ek,{value:"assistant",children:"Assistant"}),(0,t.jsx)(ek,{value:"system",children:"System"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[e.length>1&&(0,t.jsx)("button",{onClick:()=>l(s),className:"text-gray-400 hover:text-red-500",children:(0,t.jsx)(ey,{size:14})}),(0,t.jsx)("div",{className:"cursor-grab active:cursor-grabbing text-gray-400 hover:text-gray-600",children:(0,t.jsx)(eS,{size:16})})]})]}),(0,t.jsx)("div",{className:"p-2",children:(0,t.jsx)(ew,{value:r.content,onChange:e=>a(s,"content",e),rows:3,placeholder:"Enter prompt content..."})})]},s))}),(0,t.jsxs)("button",{onClick:s,className:"mt-2 text-xs text-blue-600 hover:text-blue-700 flex items-center",children:[(0,t.jsx)(ef.default,{size:14,className:"mr-1"}),"Add message"]})]})};var e_=e.i(447593);let eP=({extractedVariables:e,variables:r,onVariableChange:s})=>0===e.length?null:(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 bg-blue-50",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Fill in template variables to start testing"}),(0,t.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-xs text-gray-600 mb-1 font-medium",children:["{{",e,"}}"]}),(0,t.jsx)(eo.Input,{value:r[e]||"",onChange:t=>s(e,t.target.value),placeholder:`Enter value for ${e}`,size:"small"})]},e))})]});var eE=e.i(56456),eO=e.i(482725),eI=e.i(983561);let eB=({hasVariables:e})=>(0,t.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,t.jsx)(eI.RobotOutlined,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,t.jsx)("span",{className:"text-base",children:e?"Fill in the variables above, then type a message to start testing":"Type a message below to start testing your prompt"})]});var ez=e.i(771674),eM=e.i(918789),eL=e.i(989022);let eA=({message:e})=>(0,t.jsx)("div",{className:`mb-4 flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsxs)("div",{className:"max-w-[85%] rounded-lg shadow-sm p-3.5 px-4",style:{backgroundColor:"user"===e.role?"#f0f8ff":"#ffffff",border:"user"===e.role?"1px solid #e6f0fa":"1px solid #f0f0f0"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full mr-1",style:{backgroundColor:"user"===e.role?"#e6f0fa":"#f5f5f5"},children:"user"===e.role?(0,t.jsx)(ez.UserOutlined,{style:{fontSize:"12px",color:"#2563eb"}}):(0,t.jsx)(eI.RobotOutlined,{style:{fontSize:"12px",color:"#4b5563"}})}),(0,t.jsx)("strong",{className:"text-sm capitalize",children:e.role}),"assistant"===e.role&&e.model&&(0,t.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-600 font-normal",children:e.model})]}),(0,t.jsxs)("div",{className:"whitespace-pre-wrap break-words max-w-full message-content",style:{wordWrap:"break-word",overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},children:["assistant"===e.role?(0,t.jsx)(eM.default,{components:{code({node:e,inline:r,className:s,children:a,...l}){let n=/language-(\w+)/.exec(s||"");return!r&&n?(0,t.jsx)(G.Prism,{style:X.coy,language:n[1],PreTag:"div",className:"rounded-md my-2",wrapLines:!0,wrapLongLines:!0,...l,children:String(a).replace(/\n$/,"")}):(0,t.jsx)("code",{className:`${s} px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono`,style:{wordBreak:"break-word"},...l,children:a})},pre:({node:e,...r})=>(0,t.jsx)("pre",{style:{overflowX:"auto",maxWidth:"100%"},...r})},children:e.content}):(0,t.jsx)("div",{className:"whitespace-pre-wrap",children:e.content}),"assistant"===e.role&&(e.timeToFirstToken||e.totalLatency||e.usage)&&(0,t.jsx)(eL.default,{timeToFirstToken:e.timeToFirstToken,totalLatency:e.totalLatency,usage:e.usage})]})]})}),eD=({messages:e,isLoading:r,hasVariables:s,messagesEndRef:a})=>{let l=(0,t.jsx)(eE.LoadingOutlined,{style:{fontSize:24},spin:!0});return(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 pb-0",children:[0===e.length&&(0,t.jsx)(eB,{hasVariables:s}),e.map((e,r)=>(0,t.jsx)(eA,{message:e},r)),r&&(0,t.jsx)("div",{className:"flex justify-center items-center my-4",children:(0,t.jsx)(eO.Spin,{indicator:l})}),(0,t.jsx)("div",{ref:a,style:{height:"1px"}})]})},eR=({extractedVariables:e,variables:r})=>{let s=e.filter(e=>!r[e]||""===r[e].trim());return 0===s.length?null:(0,t.jsx)("div",{className:"mb-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("span",{className:"text-yellow-600 text-sm",children:"âš ï¸"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm text-yellow-800 font-medium mb-1",children:"Please fill in all template variables above"}),(0,t.jsxs)("p",{className:"text-xs text-yellow-700",children:["Missing: ",s.map(e=>`{{${e}}}`).join(", ")]})]})]})})};var eF=e.i(132104);let{TextArea:eH}=eo.Input,eU=({inputMessage:e,isLoading:r,isDisabled:a,onInputChange:l,onSend:n,onKeyDown:i,onCancel:o})=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center flex-1 bg-white border border-gray-300 rounded-xl px-3 py-1 min-h-[44px]",children:[(0,t.jsx)(eH,{value:e,onChange:e=>l(e.target.value),onKeyDown:i,placeholder:"Type your message... (Shift+Enter for new line)",disabled:r,className:"flex-1",autoSize:{minRows:1,maxRows:4},style:{resize:"none",border:"none",boxShadow:"none",background:"transparent",padding:"4px 0",fontSize:"14px",lineHeight:"20px"}}),(0,t.jsx)(s.Button,{onClick:n,disabled:a,className:"flex-shrink-0 ml-2 !w-8 !h-8 !min-w-8 !p-0 !rounded-full !bg-blue-600 hover:!bg-blue-700 disabled:!bg-gray-300 !border-none !text-white disabled:!text-gray-500 !flex !items-center !justify-center",children:(0,t.jsx)(eF.ArrowUpOutlined,{style:{fontSize:"14px"}})})]}),r&&(0,t.jsx)(s.Button,{onClick:o,className:"bg-red-50 hover:bg-red-100 text-red-600 border-red-200",children:"Cancel"})]}),eW=({prompt:e,accessToken:a})=>{let{isLoading:n,messages:i,inputMessage:o,variables:c,variablesFilled:d,extractedVariables:m,allVariablesFilled:p,messagesEndRef:u,setInputMessage:x,handleSendMessage:h,handleCancelRequest:g,handleClearConversation:f,handleKeyDown:y,handleVariableChange:v}=((e,t)=>{let[s,a]=(0,r.useState)(!1),[n,i]=(0,r.useState)([]),[o,c]=(0,r.useState)(""),[d,m]=(0,r.useState)({}),[p,u]=(0,r.useState)(!1),[x,h]=(0,r.useState)(null),g=(0,r.useRef)(null),f=b(e),y=f.every(e=>d[e]&&""!==d[e].trim());(0,r.useEffect)(()=>{g.current&&setTimeout(()=>{g.current?.scrollIntoView({behavior:"smooth",block:"end"})},100)},[n]);let v=async()=>{let r;if(!t)return void J.default.fromBackend("Access token is required");if(f.length>0&&!y)return void J.default.fromBackend("Please fill in all template variables");if(!o.trim())return;!p&&f.length>0&&u(!0);let s={role:"user",content:o};i(e=>[...e,s]),c("");let m=new AbortController;h(m),a(!0);let x=Date.now();try{let s,a,c=N(e),p=(0,l.getProxyBaseUrl)(),u={dotprompt_content:c};0===n.length?u.prompt_variables=d:u.conversation_history=[...n.map(e=>({role:e.role,content:e.content})),{role:"user",content:o}];let h=await fetch(`${p}/prompts/test`,{method:"POST",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(u),signal:m.signal});if(!h.ok){let e=await h.text();throw Error(`HTTP error! status: ${h.status}, ${e}`)}if(!h.body)throw Error("No response body");let g=h.body.getReader(),f=new TextDecoder,y="";for(i(e=>[...e,{role:"assistant",content:""}]);;){let{done:e,value:t}=await g.read();if(e)break;for(let e of f.decode(t).split("\n"))if(e.startsWith("data: ")){let t=e.slice(6);if("[DONE]"===t)continue;try{let e=JSON.parse(t);!s&&e.model&&(s=e.model),e.usage&&(a=e.usage);let l=e.choices?.[0]?.delta?.content;l&&(r||(r=Date.now()-x),y+=l,i(e=>{let t=[...e];return t[t.length-1]={role:"assistant",content:y,model:s,timeToFirstToken:r},t}))}catch(e){console.error("Error parsing chunk:",e)}}}let v=Date.now()-x;i(e=>{let t=[...e];return t[t.length-1]={...t[t.length-1],totalLatency:v,usage:a},t})}catch(e){"AbortError"===e.name?console.log("Request was cancelled"):(console.error("Error testing prompt:",e),i(t=>{let r=t[t.length-1];return r&&"assistant"===r.role&&""===r.content?[...t.slice(0,-1),{role:"assistant",content:`Error: ${e.message}`}]:[...t,{role:"assistant",content:`Error: ${e.message}`}]}))}finally{a(!1),h(null)}};return{isLoading:s,messages:n,inputMessage:o,variables:d,variablesFilled:p,extractedVariables:f,allVariablesFilled:y,messagesEndRef:g,setInputMessage:c,handleSendMessage:v,handleCancelRequest:()=>{x&&(x.abort(),h(null),a(!1),J.default.info("Request cancelled"))},handleClearConversation:()=>{i([]),u(!1),J.default.success("Chat history cleared.")},handleKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v())},handleVariableChange:(e,t)=>{m({...d,[e]:t})}}})(e,a);return(0,t.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[!d&&(0,t.jsx)(eP,{extractedVariables:m,variables:c,onVariableChange:v}),i.length>0&&(0,t.jsx)("div",{className:"p-3 border-b border-gray-200 bg-white flex justify-end",children:(0,t.jsx)(s.Button,{onClick:f,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",icon:e_.ClearOutlined,children:"Clear Chat"})}),(0,t.jsx)(eD,{messages:i,isLoading:n,hasVariables:m.length>0,messagesEndRef:u}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-white",children:[(0,t.jsx)(eR,{extractedVariables:m,variables:c}),(0,t.jsx)(eU,{inputMessage:o,isLoading:n,isDisabled:n||!o.trim()||m.length>0&&!p,onInputChange:x,onSend:h,onKeyDown:y,onCancel:g})]})]})},eJ=({visible:e,promptName:r,isSaving:l,onNameChange:n,onPublish:i,onCancel:o})=>(0,t.jsx)(a.Modal,{title:"Publish Prompt",open:e,onCancel:o,footer:[(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(s.Button,{variant:"secondary",onClick:o,children:"Cancel"}),(0,t.jsx)(s.Button,{onClick:i,loading:l,children:"Publish"})]},"footer")],children:(0,t.jsxs)("div",{className:"py-4",children:[(0,t.jsx)(E.Text,{className:"mb-2",children:"Name"}),(0,t.jsx)(eo.Input,{value:r,onChange:e=>n(e.target.value),placeholder:"Enter prompt name",onPressEnter:i,autoFocus:!0}),(0,t.jsx)(E.Text,{className:"text-gray-500 text-xs mt-2",children:"Published prompts can be used in API calls and are versioned for easy tracking."})]})}),eV=({prompt:e})=>{let r=N(e);return(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Generated .prompt file"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"This is the dotprompt format that will be saved to the database"})]}),(0,t.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 overflow-auto",children:(0,t.jsx)("pre",{className:"text-sm text-gray-900 font-mono whitespace-pre-wrap",children:r})})]})};var eq=e.i(608856),eK=e.i(573421),eG=e.i(981339);let{Text:eX}=e.i(898586).Typography,eY=({isOpen:e,onClose:s,accessToken:a,promptId:n,activeVersionId:i,onSelectVersion:o})=>{let[c,d]=(0,r.useState)([]),[m,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{e&&a&&n&&u()},[e,a,n]);let u=async()=>{p(!0);try{let e=n.includes(".v")?n.split(".v")[0]:n,t=await (0,l.getPromptVersions)(a,e);d(t.prompts)}catch(e){console.error("Error fetching prompt versions:",e)}finally{p(!1)}},x=e=>{if(e.version)return`v${e.version}`;let t=e.litellm_params?.prompt_id||e.prompt_id;return t.includes(".v")?`v${t.split(".v")[1]}`:t.includes("_v")?`v${t.split("_v")[1]}`:"v1"};return(0,t.jsx)(eq.Drawer,{title:"Version History",placement:"right",onClose:s,open:e,width:400,mask:!1,maskClosable:!1,children:m?(0,t.jsx)(eG.Skeleton,{active:!0,paragraph:{rows:4}}):0===c.length?(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No version history available."}):(0,t.jsx)(eK.List,{dataSource:c,renderItem:(e,r)=>{var s;let a=e.version||parseInt(x(e).replace("v","")),l=null;i&&(i.includes(".v")?l=parseInt(i.split(".v")[1]):i.includes("_v")&&(l=parseInt(i.split("_v")[1])));let n=l?a===l:0===r;return(0,t.jsxs)("div",{className:`mb-4 p-4 rounded-lg border cursor-pointer transition-all hover:shadow-md ${n?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300"}`,onClick:()=>o?.(e),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eb.Tag,{className:"m-0",children:x(e)}),0===r&&(0,t.jsx)(eb.Tag,{color:"blue",className:"m-0",children:"Latest"})]}),n&&(0,t.jsx)(eb.Tag,{color:"green",className:"m-0",children:"Active"})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(eX,{className:"text-sm text-gray-600 font-medium",children:(s=e.created_at)?new Date(s).toLocaleString():"-"}),(0,t.jsx)(eX,{type:"secondary",className:"text-xs",children:e.prompt_info?.prompt_type==="db"?"Saved to Database":"Config Prompt"})]})]},`${e.prompt_id}-v${e.version||a}`)}})})},eZ=({onClose:e,onSuccess:s,accessToken:a,initialPromptData:n})=>{let[i,o]=(0,r.useState)((()=>{if(n)try{return w(n)}catch(e){console.error("Error parsing existing prompt:",e),J.default.fromBackend("Failed to parse prompt data")}return{name:"New prompt",model:"gpt-4o",config:{temperature:1,max_tokens:1e3},tools:[],developerMessage:"",messages:[{role:"user",content:"Enter task specifics. Use {{template_variables}} for dynamic inputs"}]}})()),[c,d]=(0,r.useState)(!!n),[m,p]=(0,r.useState)(!1),[u,x]=(0,r.useState)((()=>{if(!n?.prompt_spec)return;let e=n.prompt_spec.prompt_id,t=n.prompt_spec.version||n.prompt_spec.litellm_params?.prompt_id;return"number"==typeof t?`${e}.v${t}`:"string"==typeof t&&(t.includes(".v")||t.includes("_v"))?t:e})()),[h,g]=(0,r.useState)(!1),[f,y]=(0,r.useState)(!1),[v,j]=(0,r.useState)(null),[b,$]=(0,r.useState)(!1),[C,S]=(0,r.useState)("pretty"),k=e=>{void 0!==e?j(e):j(null),g(!0)},T=async()=>{if(!a)return void J.default.fromBackend("Access token is required");if(!i.name||""===i.name.trim())return void J.default.fromBackend("Please enter a valid prompt name");$(!0);try{let t=i.name.replace(/[^a-zA-Z0-9_-]/g,"_").toLowerCase(),r=N(i),o={prompt_id:t,litellm_params:{prompt_integration:"dotprompt",prompt_id:t,dotprompt_content:r},prompt_info:{prompt_type:"db"}};c&&n?.prompt_spec?.prompt_id?(await (0,l.updatePromptCall)(a,n.prompt_spec.prompt_id,o),J.default.success("Prompt updated successfully!")):(await (0,l.createPromptCall)(a,o),J.default.success("Prompt created successfully!")),s(),e()}catch(e){console.error("Error saving prompt:",e),J.default.fromBackend(c?"Failed to update prompt":"Failed to save prompt")}finally{$(!1),y(!1)}},_=u&&u.includes(".v")?`v${u.split(".v")[1]}`:null;return(0,t.jsxs)("div",{className:"flex h-full bg-white",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)(eu,{promptName:i.name,onNameChange:e=>o({...i,name:e}),onBack:e,onSave:()=>{i.name&&""!==i.name.trim()&&"New prompt"!==i.name?T():y(!0)},isSaving:b,editMode:c,onShowHistory:()=>p(!0),version:_,promptModel:i.model,promptVariables:(()=>{let e,t={},r=[i.developerMessage,...i.messages.map(e=>e.content)].join(" "),s=/\{\{(\w+)\}\}/g;for(;null!==(e=s.exec(r));){let r=e[1];t[r]||(t[r]=`example_${r}`)}return t})(),accessToken:a}),(0,t.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,t.jsxs)("div",{className:"w-1/2 overflow-y-auto bg-white border-r border-gray-200 flex-shrink-0",children:[(0,t.jsxs)("div",{className:"border-b border-gray-200 bg-white px-6 py-4 flex items-center gap-3",children:[(0,t.jsx)(eg,{model:i.model,temperature:i.config.temperature,maxTokens:i.config.max_tokens,accessToken:a,onModelChange:e=>o({...i,model:e}),onTemperatureChange:e=>o({...i,config:{...i.config,temperature:e}}),onMaxTokensChange:e=>o({...i,config:{...i.config,max_tokens:e}})}),(0,t.jsxs)("div",{className:"ml-auto inline-flex items-center bg-gray-200 rounded-full p-0.5",children:[(0,t.jsx)("button",{className:`px-3 py-1 text-xs font-medium rounded-full transition-colors ${"pretty"===C?"bg-white text-gray-900 shadow-sm":"text-gray-600"}`,onClick:()=>S("pretty"),children:"PRETTY"}),(0,t.jsx)("button",{className:`px-3 py-1 text-xs font-medium rounded-full transition-colors ${"dotprompt"===C?"bg-white text-gray-900 shadow-sm":"text-gray-600"}`,onClick:()=>S("dotprompt"),children:"DOTPROMPT"})]})]}),"pretty"===C?(0,t.jsxs)("div",{className:"p-6 space-y-4 pb-20",children:[(0,t.jsx)(ev,{tools:i.tools,onAddTool:()=>k(),onEditTool:k,onRemoveTool:e=>{o({...i,tools:i.tools.filter((t,r)=>r!==e)})}}),(0,t.jsx)(eC,{value:i.developerMessage,onChange:e=>o({...i,developerMessage:e})}),(0,t.jsx)(eT,{messages:i.messages,onAddMessage:()=>{o({...i,messages:[...i.messages,{role:"user",content:""}]})},onUpdateMessage:(e,t,r)=>{let s=[...i.messages];s[e][t]=r,o({...i,messages:s})},onRemoveMessage:e=>{i.messages.length>1&&o({...i,messages:i.messages.filter((t,r)=>r!==e)})},onMoveMessage:(e,t)=>{let r=[...i.messages],[s]=r.splice(e,1);r.splice(t,0,s),o({...i,messages:r})}})]}):(0,t.jsx)(eV,{prompt:i})]}),(0,t.jsx)("div",{className:"w-1/2 flex-shrink-0",children:(0,t.jsx)(eW,{prompt:i,accessToken:a})})]})]}),(0,t.jsx)(eJ,{visible:f,promptName:i.name,isSaving:b,onNameChange:e=>o({...i,name:e}),onPublish:T,onCancel:()=>y(!1)}),h&&(0,t.jsx)(ei,{visible:h,initialJson:null!==v?i.tools[v].json:"",onSave:e=>{try{let t=JSON.parse(e),r={name:t.function?.name||"Unnamed Tool",description:t.function?.description||"",json:e};if(null!==v){let e=[...i.tools];e[v]=r,o({...i,tools:e})}else o({...i,tools:[...i.tools,r]});g(!1),j(null)}catch(e){J.default.fromBackend("Invalid JSON format")}},onClose:()=>{g(!1),j(null)}}),(0,t.jsx)(eY,{isOpen:m,onClose:()=>p(!1),accessToken:a,promptId:n?.prompt_spec?.prompt_id||i.name,activeVersionId:u,onSelectVersion:e=>{try{let t=w({prompt_spec:e});o(t);let r=e.version||1;x(`${e.prompt_id}.v${r}`)}catch(e){console.error("Error loading version:",e),J.default.fromBackend("Failed to load prompt version")}}})]})};var eQ=e.i(708347);e.s(["default",0,({accessToken:e,userRole:n})=>{let[i,o]=(0,r.useState)([]),[c,d]=(0,r.useState)(!1),[m,p]=(0,r.useState)(null),[u,x]=(0,r.useState)(!1),[h,g]=(0,r.useState)(!1),[f,y]=(0,r.useState)(null),[v,j]=(0,r.useState)(!1),[b,N]=(0,r.useState)(null),$=!!n&&(0,eQ.isAdminRole)(n),w=async()=>{if(e){d(!0);try{let t=await (0,l.getPromptsList)(e);console.log(`prompts: ${JSON.stringify(t)}`),o(t.prompts)}catch(e){console.error("Error fetching prompts:",e)}finally{d(!1)}}};(0,r.useEffect)(()=>{w()},[e]);let C=()=>{w(),g(!1),y(null),p(null)},S=async()=>{if(b&&e){j(!0);try{await (0,l.deletePromptCall)(e,b.id),J.default.success(`Prompt "${b.name}" deleted successfully`),w()}catch(e){console.error("Error deleting prompt:",e),J.default.fromBackend("Failed to delete prompt")}finally{j(!1),N(null)}}};return(0,t.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[h?(0,t.jsx)(eZ,{onClose:()=>{g(!1),y(null)},onSuccess:C,accessToken:e,initialPromptData:f}):m?(0,t.jsx)(Z,{promptId:m,onClose:()=>p(null),accessToken:e,isAdmin:$,onDelete:w,onEdit:e=>{y(e),g(!0)}}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(s.Button,{onClick:()=>{m&&p(null),y(null),g(!0)},disabled:!e,children:"+ Add New Prompt"}),(0,t.jsx)(s.Button,{onClick:()=>{m&&p(null),x(!0)},disabled:!e,variant:"secondary",children:"Upload .prompt File"})]})}),(0,t.jsx)(T,{promptsList:i,isLoading:c,onPromptClick:e=>{p(e)},onDeleteClick:(e,t)=>{N({id:e,name:t})},accessToken:e,isAdmin:$})]}),(0,t.jsx)(el,{visible:u,onClose:()=>{x(!1)},accessToken:e,onSuccess:C}),b&&(0,t.jsxs)(a.Modal,{title:"Delete Prompt",open:null!==b,onOk:S,onCancel:()=>{N(null)},confirmLoading:v,okText:"Delete",okButtonProps:{danger:!0},children:[(0,t.jsxs)("p",{children:["Are you sure you want to delete prompt: ",b.name," ?"]}),(0,t.jsx)("p",{children:"This action cannot be undone."})]})]})}],191403)}]);