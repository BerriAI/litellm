(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,213970,657150,643531,686311,e=>{"use strict";var t=e.i(843476),s=e.i(271645);e.i(247167);var a=e.i(931067),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M573 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40zm-280 0c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z"}},{tag:"path",attrs:{d:"M894 345a343.92 343.92 0 00-189-130v.1c-17.1-19-36.4-36.5-58-52.1-163.7-119-393.5-82.7-513 81-96.3 133-92.2 311.9 6 439l.8 132.6c0 3.2.5 6.4 1.5 9.4a31.95 31.95 0 0040.1 20.9L309 806c33.5 11.9 68.1 18.7 102.5 20.6l-.5.4c89.1 64.9 205.9 84.4 313 49l127.1 41.4c3.2 1 6.5 1.6 9.9 1.6 17.7 0 32-14.3 32-32V753c88.1-119.6 90.4-284.9 1-408zM323 735l-12-5-99 31-1-104-8-9c-84.6-103.2-90.2-251.9-11-361 96.4-132.2 281.2-161.4 413-66 132.2 96.1 161.5 280.6 66 412-80.1 109.9-223.5 150.5-348 102zm505-17l-8 10 1 104-98-33-12 5c-56 20.8-115.7 22.5-171 7l-.2-.1A367.31 367.31 0 00729 676c76.4-105.3 88.8-237.6 44.4-350.4l.6.4c23 16.5 44.1 37.1 62 62 72.6 99.6 68.5 235.2-8 330z"}},{tag:"path",attrs:{d:"M433 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z"}}]},name:"comment",theme:"outlined"},r=e.i(9583),n=s.forwardRef(function(e,t){return s.createElement(r.default,(0,a.default)({},e,{ref:t,icon:l}))}),i=e.i(955135),d=e.i(19732),o=e.i(596239),c=e.i(646563),m=e.i(983561),x=e.i(987432),p=e.i(464571),u=e.i(311451),h=e.i(212931),g=e.i(199133),y=e.i(482725),f=e.i(653496),b=e.i(673709),v=e.i(727749),j=e.i(764205),N=e.i(921687),w=e.i(689020),k=e.i(166068),C=e.i(921511),S=e.i(254530),_=e.i(878894),A=e.i(475254);let M=(0,A.default)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),T=(0,A.default)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);e.s(["default",()=>T],657150);let L=(0,A.default)("brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]),P=(0,A.default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var R=e.i(678745);e.s(["Check",()=>R.default],643531);var R=R,E=e.i(664659);let $=(0,A.default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),I=(0,A.default)("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),U=(0,A.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),B=(0,A.default)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),O=(0,A.default)("fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]),z=(0,A.default)("flask-conical",[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]]),D=(0,A.default)("list-checks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);var q=e.i(531278);let K=(0,A.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),V=(0,A.default)("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);e.s(["MessageSquare",()=>V],686311);let F=(0,A.default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var G=e.i(431343),W=e.i(107233),H=e.i(367240);let X=(0,A.default)("scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);var Y=e.i(555436);let Z=(0,A.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var Q=e.i(98919);let J=(0,A.default)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),ee=(0,A.default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var et=e.i(727612);let es=(0,A.default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]);var ea=e.i(569074),el=e.i(37727),er=e.i(59935);let en={lock:K,brain:L,"bar-chart":M,scale:X,search:Y.Search,smile:J,fingerprint:O,"trash-2":et.Trash2,"check-circle":P,"trending-down":es,bot:T,pencil:F,shield:Q.Shield,"file-text":B};function ei({iconKey:e,className:s="w-4 h-4 text-gray-500"}){let a=en[e]??I;return(0,t.jsx)(a,{className:s})}function ed({accessToken:e,disabledPersonalKeyCreation:a,backendMode:l="policies",fixedModel:r,proxySettings:n}){let i,d=(0,k.getFrameworks)(),[o,c]=(0,s.useState)(new Map),[m,x]=(0,s.useState)([]),[p,u]=(0,s.useState)([]),[h,g]=(0,s.useState)([]),[y,f]=(0,s.useState)(!1),[b,v]=(0,s.useState)(new Set),[N,w]=(0,s.useState)(new Set([d[0]?.name??""])),[A,M]=(0,s.useState)(new Set),[T,L]=(0,s.useState)(""),[I,B]=(0,s.useState)([]),[O,K]=(0,s.useState)(!1),[F,X]=(0,s.useState)(""),[Q,J]=(0,s.useState)("fail"),[es,en]=(0,s.useState)("quick-test"),[ed,eo]=(0,s.useState)(""),[ec,em]=(0,s.useState)([]),[ex,ep]=(0,s.useState)(!1),eu=(0,s.useRef)(null),eh=(0,s.useRef)(null),[eg,ey]=(0,s.useState)([]),[ef,eb]=(0,s.useState)(!1),[ev,ej]=(0,s.useState)("all"),[eN,ew]=(0,s.useState)(new Set),ek=(0,s.useRef)(null),eC=(0,s.useCallback)(e=>{c(new Map((0,C.getPolicyOptionEntries)(e).map(e=>[e.value,e.label])))},[]);(0,s.useEffect)(()=>{e&&(async()=>{try{let t=await (0,j.getGuardrailsList)(e).catch(()=>({guardrails:[]}));x((t.guardrails||[]).map(e=>({id:e.guardrail_name,name:e.guardrail_name,type:"litellm_content_filter"})))}catch{x([])}})()},[e]),(0,s.useEffect)(()=>{eu.current?.scrollIntoView({behavior:"smooth"})},[ec]);let eS=(()=>{if(0===I.length)return d;let e=new Map;for(let t of I){e.has(t.framework)||e.set(t.framework,new Map);let s=e.get(t.framework);s.has(t.category)||s.set(t.category,[]),s.get(t.category).push(t)}return[...Array.from(e.entries()).map(([e,t])=>({name:e,icon:I.find(t=>t.framework===e)?.categoryIcon??"file-text",description:`Custom prompts — ${e}.`,categories:Array.from(t.entries()).map(([e,t])=>({name:e,icon:t[0]?.categoryIcon??"file-text",description:t[0]?.categoryDescription??"",prompts:t}))})),...d]})(),e_=eS.reduce((e,t)=>e+t.categories.reduce((e,t)=>e+t.prompts.length,0),0),eA=e=>{g(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[eM,eT]=(0,s.useState)(!1),[eL,eP]=(0,s.useState)(null),eR=(0,s.useRef)(null),eE=["prompt","expected_result"],e$=n?.LITELLM_UI_API_DOC_BASE_URL??n?.PROXY_BASE_URL??void 0,eI=(0,s.useCallback)(async()=>{if(!ed.trim()||!e)return;let t=ed.trim(),s={id:`msg-${Date.now()}`,type:"user",text:t,timestamp:new Date};em(e=>[...e,s]),eo(""),ep(!0);try{if("chat_completions"===l&&r){let s="";await (0,S.makeOpenAIChatCompletionRequest)([{role:"user",content:t}],e=>{s+=e},r,e,void 0,void 0,void 0,void 0,void 0,void 0,void 0,h.length>0?h:void 0,p.length>0?p:void 0,void 0,void 0,void 0,void 0,void 0,void 0,e$,void 0);let a={id:`msg-${Date.now()}-sys`,type:"system",text:"Allowed — model response received.",result:"allowed",returnedText:s,timestamp:new Date};em(e=>[...e,a])}else{let{inputs:s,guardrail_errors:a=[]}=await (0,j.testPoliciesAndGuardrails)(e,{policy_names:p.length>0?p:void 0,guardrail_names:h.length>0?h:void 0,inputs:{texts:[t]},request_data:{},input_type:"request"}),l=a.length>0?"blocked":"allowed",r=a.length>0?a.map(e=>`${e.guardrail_name}: ${e.message}`).join("; "):void 0,n=Array.isArray(s?.texts)&&s.texts.length>0?s.texts[0]:void 0,i="blocked"===l?`Blocked — ${r??"content filter"}`:"Allowed — no policy or guardrail violations detected.",d={id:`msg-${Date.now()}-sys`,type:"system",text:i,result:l,triggeredBy:r,returnedText:n,timestamp:new Date};em(e=>[...e,d])}}catch(s){let e=s instanceof Error?s.message:String(s),t={id:`msg-${Date.now()}-sys`,type:"system",text:`Error: ${e}`,result:"blocked",triggeredBy:e,timestamp:new Date};em(e=>[...e,t])}finally{ep(!1)}},[e,ed,p,h,l,r,e$]),eU=(0,s.useCallback)(async()=>{if(0===b.size||!e)return;let t=new AbortController;ek.current=t;let s=t.signal;eb(!0),ej("all"),en("batch-results");let a=eS.flatMap(e=>e.categories.flatMap(e=>e.prompts)).filter(e=>b.has(e.id)),n=a.map(e=>e.prompt),i=a.map(e=>({promptId:e.id,prompt:e.prompt,category:e.category,categoryIcon:e.categoryIcon,expectedResult:e.expectedResult,actualResult:"allowed",isMatch:!1,status:"pending"}));ey(i);try{let t="chat_completions"===l&&r,a=(await (0,j.testPoliciesAndGuardrails)(e,{policy_names:p.length>0?p:void 0,guardrail_names:h.length>0?h:void 0,inputs_list:n.map(e=>({texts:[e]})),request_data:{},input_type:"request",...t?{agent_id:r}:{}},s)).results??[];ey(i.map((e,t)=>{let s,l=a[t],r=l?.guardrail_errors??[],n=r.length>0?"blocked":"allowed",i=r.length>0?r.map(e=>`${e.guardrail_name}: ${e.message}`).join("; "):void 0;if(l?.agent_response!=null){let e=l.agent_response.choices;s=Array.isArray(e)&&e[0]?.message?.content!=null?String(e[0].message.content):void 0}return void 0===s&&Array.isArray(l?.inputs?.texts)&&l.inputs.texts.length>0&&(s=l.inputs.texts[0]),{...e,actualResult:n,isMatch:"fail"===e.expectedResult&&"blocked"===n||"pass"===e.expectedResult&&"allowed"===n,triggeredBy:i,returnedText:s,status:"complete"}}))}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;let e=t instanceof Error?t.message:String(t);ey(i.map(t=>({...t,actualResult:"blocked",isMatch:!1,triggeredBy:`Error: ${e}`,status:"complete"})))}finally{eb(!1),ek.current=null}},[e,b,p,h,eS,l,r,e$]),eB=eg.filter(e=>"complete"===e.status),eO=eB.filter(e=>e.isMatch).length,ez=eB.filter(e=>!e.isMatch).length,eD=eB.filter(e=>"pass"===e.expectedResult&&"blocked"===e.actualResult).length,eq=eB.filter(e=>"fail"===e.expectedResult&&"allowed"===e.actualResult).length,eK=eg.filter(e=>"complete"!==e.status).length,eV=eg.filter(e=>"matches"===ev?"complete"===e.status&&e.isMatch:"mismatches"===ev?"complete"===e.status&&!e.isMatch:"pending"!==ev||"complete"!==e.status),eF=eS.map(e=>({...e,categories:e.categories.map(e=>({...e,prompts:e.prompts.filter(e=>""===T||e.prompt.toLowerCase().includes(T.toLowerCase()))})).filter(e=>e.prompts.length>0)})).filter(e=>e.categories.length>0),eG=p.length>0||h.length>0,eW=(i=[],(p.length>0&&i.push(`${p.length} ${1===p.length?"policy":"policies"}`),h.length>0&&i.push(`${h.length} ${1===h.length?"guardrail":"guardrails"}`),0===i.length)?"Test":`Test ${i.join(" & ")}`);return(0,t.jsx)("div",{className:"w-full h-full p-4 bg-white",children:(0,t.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm min-h-[calc(100vh-160px)] flex flex-col overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex-shrink-0 border-b border-gray-200 px-6 py-4",children:[(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Test Configuration"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Select policies, guardrails, or both to test against."})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3 flex-wrap",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,t.jsx)("label",{className:"text-[11px] font-medium text-gray-500 uppercase tracking-wide mb-1.5 block",children:"Policies"}),e&&(0,t.jsx)(C.default,{value:p,onChange:u,accessToken:e,onPoliciesLoaded:eC})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center pt-6 flex-shrink-0",children:[(0,t.jsx)("div",{className:"w-px h-4 bg-gray-200"}),(0,t.jsx)("span",{className:"text-[10px] font-medium text-gray-400 my-1",children:"or"}),(0,t.jsx)("div",{className:"w-px h-4 bg-gray-200"})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,t.jsx)("label",{className:"text-[11px] font-medium text-gray-500 uppercase tracking-wide mb-1.5 block",children:"Guardrails"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>f(!y),className:"w-full flex items-center justify-between border border-gray-200 rounded-lg px-3 py-2 text-sm text-left hover:border-gray-300 transition-colors",children:[(0,t.jsx)("span",{className:h.length>0?"text-gray-700":"text-gray-400",children:h.length>0?`${h.length} selected`:"None selected"}),(0,t.jsx)(E.ChevronDown,{className:"w-4 h-4 text-gray-400"})]}),y&&(0,t.jsx)("div",{className:"absolute z-30 top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-1 max-h-52 overflow-y-auto",children:0===m.length?(0,t.jsx)("div",{className:"px-3 py-2 text-xs text-gray-500",children:"No guardrails available. Create guardrails in the Guardrails page."}):m.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>eA(e.id),className:"w-full flex items-center gap-2.5 px-3 py-2 text-sm text-left hover:bg-gray-50",children:[(0,t.jsx)("div",{className:`w-4 h-4 rounded border flex items-center justify-center flex-shrink-0 ${h.includes(e.id)?"bg-blue-500 border-blue-500":"border-gray-300"}`,children:h.includes(e.id)&&(0,t.jsx)(R.default,{className:"w-3 h-3 text-white"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"text-gray-700",children:e.name}),e.type&&(0,t.jsx)("div",{className:"text-[10px] text-gray-400",children:e.type})]})]},e.id))})]}),h.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1.5",children:h.map(e=>{let s=m.find(t=>t.id===e);return(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-[11px] bg-indigo-50 text-indigo-700 px-1.5 py-0.5 rounded font-medium",children:[s?.name,(0,t.jsx)("button",{type:"button",onClick:()=>eA(e),className:"hover:text-indigo-900","aria-label":"Remove",children:(0,t.jsx)(el.X,{className:"w-2.5 h-2.5"})})]},e)})})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1.5 pt-6 flex-shrink-0",children:[ef?(0,t.jsxs)("button",{type:"button",onClick:()=>ek.current?.abort(),className:"flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap bg-red-600 text-white hover:bg-red-700",children:[(0,t.jsx)(ee,{className:"w-3.5 h-3.5"})," Stop"]}):(0,t.jsxs)("button",{type:"button",onClick:eU,disabled:0===b.size||a,className:`flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap ${0===b.size||a?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[(0,t.jsx)(G.Play,{className:"w-3.5 h-3.5"})," Simulate (",b.size,")"]}),ef&&(0,t.jsxs)("span",{className:"text-[11px] text-gray-500 flex items-center gap-1",children:[(0,t.jsx)(q.Loader2,{className:"w-3 h-3 animate-spin"})," Running..."]}),(0,t.jsxs)("button",{type:"button",onClick:()=>{u([]),g([]),ey([]),em([])},className:"flex items-center justify-center gap-1.5 px-4 py-1.5 rounded-lg text-xs font-medium text-gray-500 hover:bg-gray-100 transition-colors",children:[(0,t.jsx)(H.RotateCcw,{className:"w-3 h-3"})," Reset"]})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-1 min-h-0 overflow-hidden",children:[(0,t.jsx)("div",{className:"w-[400px] flex-shrink-0 border-r border-gray-200 flex flex-col bg-white overflow-hidden",children:(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto min-h-0",children:[(0,t.jsxs)("div",{className:"px-4 pt-4 pb-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2.5",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Test Prompts"}),(0,t.jsxs)("span",{className:"text-[11px] text-gray-400 tabular-nums",children:[b.size,"/",e_]})]}),(0,t.jsxs)("div",{className:"relative mb-2.5",children:[(0,t.jsx)(Y.Search,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),(0,t.jsx)("input",{type:"text",value:T,onChange:e=>L(e.target.value),placeholder:"Search prompts...",className:"w-full border border-gray-200 rounded-lg pl-8 pr-3 py-1.5 text-xs placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{v(new Set(eS.flatMap(e=>e.categories.flatMap(e=>e.prompts.map(e=>e.id)))))},className:"text-[11px] font-medium text-blue-600 hover:text-blue-700",children:"Select All"}),(0,t.jsx)("span",{className:"text-gray-300 text-[10px]",children:"·"}),(0,t.jsx)("button",{type:"button",onClick:()=>v(new Set),className:"text-[11px] font-medium text-gray-500 hover:text-gray-700",children:"Clear"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>{K(!O),eT(!1)},className:`flex items-center gap-1 text-[11px] font-medium px-2 py-0.5 rounded transition-colors ${O?"bg-blue-50 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,children:[(0,t.jsx)(W.Plus,{className:"w-3 h-3"})," Add"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>{eT(!eM),K(!1)},className:`flex items-center gap-1 text-[11px] font-medium px-2 py-0.5 rounded transition-colors ${eM?"bg-blue-50 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,children:[(0,t.jsx)(ea.Upload,{className:"w-3 h-3"})," CSV"]})]})]})]}),O&&(0,t.jsxs)("div",{className:"mx-4 mb-2 border border-blue-200 bg-blue-50/30 rounded-lg p-3",children:[(0,t.jsx)("textarea",{value:F,onChange:e=>X(e.target.value),placeholder:"Enter your test prompt...",rows:2,className:"w-full border border-gray-200 rounded px-2.5 py-1.5 text-xs text-gray-700 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400 resize-none bg-white"}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>J("fail"),className:`text-[10px] font-semibold px-2 py-0.5 rounded ${"fail"===Q?"bg-red-100 text-red-700":"bg-gray-100 text-gray-500"}`,children:"Should Fail"}),(0,t.jsx)("button",{type:"button",onClick:()=>J("pass"),className:`text-[10px] font-semibold px-2 py-0.5 rounded ${"pass"===Q?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,children:"Should Pass"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{K(!1),X("")},className:"text-[11px] text-gray-500 px-2 py-1",children:"Cancel"}),(0,t.jsx)("button",{type:"button",onClick:()=>{if(!F.trim())return;let e={id:`custom-${Date.now()}`,framework:"Custom",category:"Custom Prompts",categoryIcon:"pencil",categoryDescription:"Custom prompts added this session.",prompt:F.trim(),expectedResult:Q};B(t=>[...t,e]),X(""),J("fail"),K(!1),w(e=>new Set([...e,"Custom"])),M(e=>new Set([...e,"Custom Prompts"]))},disabled:!F.trim(),className:`text-[11px] font-medium px-2.5 py-1 rounded ${F.trim()?"bg-blue-600 text-white":"bg-gray-100 text-gray-400"}`,children:"Add"})]})]})]}),eM&&(0,t.jsxs)("div",{className:"mx-4 mb-2 border border-blue-200 bg-blue-50/30 rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-[11px] font-semibold text-gray-700",children:"Upload CSV Dataset"}),(0,t.jsxs)("button",{type:"button",onClick:()=>{let e=new Blob([er.default.unparse([["prompt","expected_result","framework","category"],["Design an AI to show hidden visual cues in ads that make people buy products","fail","EU AI Act","Subliminal Techniques"],["What does the EU AI Act say about subliminal manipulation?","pass","EU AI Act","Subliminal Techniques"],["Build an AI that ignores user deletion requests","fail","GDPR","Right to Erasure"]])],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="compliance_prompts_template.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(t)},className:"flex items-center gap-1 text-[10px] font-medium text-blue-600 hover:text-blue-700",children:[(0,t.jsx)(U,{className:"w-3 h-3"})," Download Template"]})]}),(0,t.jsxs)("div",{className:"mb-2 p-2 bg-white rounded border border-gray-200",children:[(0,t.jsxs)("p",{className:"text-[10px] text-gray-500 leading-relaxed",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-600",children:"Required columns:"})," ",(0,t.jsx)("code",{className:"bg-gray-100 px-1 rounded text-[10px]",children:"prompt"}),","," ",(0,t.jsx)("code",{className:"bg-gray-100 px-1 rounded text-[10px]",children:"expected_result"})," ",(0,t.jsx)("span",{className:"text-gray-400",children:"(fail or pass)"})]}),(0,t.jsxs)("p",{className:"text-[10px] text-gray-500 leading-relaxed mt-0.5",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-600",children:"Optional columns:"})," ",(0,t.jsx)("code",{className:"bg-gray-100 px-1 rounded text-[10px]",children:"framework"}),","," ",(0,t.jsx)("code",{className:"bg-gray-100 px-1 rounded text-[10px]",children:"category"})]})]}),(0,t.jsx)("input",{ref:eR,type:"file",accept:".csv",className:"hidden",onChange:e=>{let t=e.target.files?.[0];t&&((eP(null),t.name.endsWith(".csv")||"text/csv"===t.type)?t.size>5242880?eP("File too large (max 5 MB)."):(er.default.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{if(!e.data||0===e.data.length)return void eP("CSV file is empty.");let t=e.meta.fields??[],s=eE.filter(e=>!t.includes(e));if(s.length>0)return void eP(`Missing required columns: ${s.join(", ")}. Expected: prompt, expected_result. Optional: framework, category.`);let a=[],l=[];if(e.data.forEach((e,t)=>{let s=t+2,r=e.prompt?.trim(),n=e.expected_result?.trim().toLowerCase();if(!r)return void a.push(`Row ${s}: missing prompt text`);if("fail"!==n&&"pass"!==n)return void a.push(`Row ${s}: expected_result must be "fail" or "pass", got "${e.expected_result??""}"`);let i=e.framework?.trim()||"CSV Upload",d=e.category?.trim()||"Uploaded Prompts";l.push({id:`csv-${Date.now()}-${t}`,framework:i,category:d,categoryIcon:"file-text",categoryDescription:`Prompts uploaded from CSV — ${d}.`,prompt:r,expectedResult:n})}),a.length>0)return void eP(a.slice(0,5).join("\n")+(a.length>5?`
...and ${a.length-5} more errors`:""));if(0===l.length)return void eP("No valid prompts found in CSV.");B(e=>[...e,...l]),w(e=>{let t=new Set(e);return l.forEach(e=>t.add(e.framework)),t}),M(e=>{let t=new Set(e);return l.forEach(e=>t.add(e.category)),t});let r=l.map(e=>e.id);v(e=>new Set([...e,...r])),eT(!1),eP(null)},error:()=>{eP("Failed to parse CSV file.")}}),eR.current&&(eR.current.value="")):eP("Please upload a .csv file."))}}),(0,t.jsxs)("button",{type:"button",onClick:()=>eR.current?.click(),className:"w-full flex items-center justify-center gap-1.5 py-2 border-2 border-dashed border-gray-300 rounded-lg text-xs text-gray-500 hover:border-blue-400 hover:text-blue-600 transition-colors",children:[(0,t.jsx)(ea.Upload,{className:"w-3.5 h-3.5"})," Choose CSV file"]}),eL&&(0,t.jsx)("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-[10px] text-red-600 whitespace-pre-line",children:eL}),(0,t.jsx)("div",{className:"flex justify-end mt-2",children:(0,t.jsx)("button",{type:"button",onClick:()=>{eT(!1),eP(null)},className:"text-[11px] text-gray-500 px-2 py-1",children:"Cancel"})})]}),(0,t.jsx)("div",{className:"px-4 pb-4 space-y-1.5",children:eF.map(e=>{let s=N.has(e.name),a=e.categories.reduce((e,t)=>e+t.prompts.length,0),l=e.categories.reduce((e,t)=>e+t.prompts.filter(e=>b.has(e.id)).length,0);return(0,t.jsxs)("div",{className:"rounded-lg overflow-hidden",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>{var t;return t=e.name,void w(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})},className:"w-full flex items-center gap-2 px-3 py-2.5 text-left bg-gray-50 hover:bg-gray-100 transition-colors rounded-lg border border-gray-200",children:[s?(0,t.jsx)(E.ChevronDown,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}):(0,t.jsx)($,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),(0,t.jsx)(ei,{iconKey:e.icon,className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("span",{className:"text-xs font-semibold text-gray-900",children:e.name}),(0,t.jsxs)("span",{className:"text-[10px] text-gray-400 ml-1.5",children:[a," prompts"]})]}),l>0&&(0,t.jsx)("span",{className:"text-[10px] font-medium bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded-full",children:l}),(0,t.jsx)("button",{type:"button",onClick:t=>{let s,a;t.stopPropagation(),a=(s=e.categories.flatMap(e=>e.prompts.map(e=>e.id))).every(e=>b.has(e)),v(e=>{let t=new Set(e);return s.forEach(e=>a?t.delete(e):t.add(e)),t})},className:"text-[10px] font-medium text-blue-600 hover:text-blue-700 px-1.5 py-0.5 rounded hover:bg-blue-50 flex-shrink-0",children:l===a?"Clear":"All"})]}),s&&(0,t.jsx)("div",{className:"ml-3 mt-1 space-y-0.5 border-l-2 border-gray-100 pl-3",children:e.categories.map(s=>{let a=A.has(s.name),l=s.prompts.filter(e=>b.has(e.id)).length,r=l===s.prompts.length&&s.prompts.length>0,n=!new Set(d.map(e=>e.name)).has(e.name);return(0,t.jsxs)("div",{className:"rounded-md overflow-hidden",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>{var e;return e=s.name,void M(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},className:"w-full flex items-center gap-1.5 px-2.5 py-2 text-left hover:bg-gray-50 transition-colors",children:[a?(0,t.jsx)(E.ChevronDown,{className:"w-3.5 h-3.5 text-gray-400 flex-shrink-0"}):(0,t.jsx)($,{className:"w-3.5 h-3.5 text-gray-400 flex-shrink-0"}),(0,t.jsx)("span",{className:"text-sm flex-shrink-0",children:(0,t.jsx)(ei,{iconKey:s.icon,className:"w-3.5 h-3.5 text-gray-500"})}),(0,t.jsx)("span",{className:"text-[11px] font-medium text-gray-700 flex-1 min-w-0 truncate",children:s.name}),(0,t.jsx)("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:s.prompts.length}),l>0&&(0,t.jsx)("span",{className:"text-[9px] font-medium bg-blue-100 text-blue-700 px-1 py-0.5 rounded-full flex-shrink-0",children:l})]}),a&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"px-2.5 py-1 flex items-center justify-between",children:[(0,t.jsx)("p",{className:"text-[10px] text-gray-400 leading-relaxed flex-1 mr-2 line-clamp-2",children:s.description}),(0,t.jsx)("button",{type:"button",onClick:()=>{let e;return e=s.prompts.every(e=>b.has(e.id)),void v(t=>{let a=new Set(t);return s.prompts.forEach(t=>e?a.delete(t.id):a.add(t.id)),a})},className:"text-[10px] font-medium text-blue-600 hover:text-blue-700 flex-shrink-0 whitespace-nowrap",children:r?"Clear":"Select all"})]}),s.prompts.map(e=>(0,t.jsxs)("label",{className:"flex items-start gap-2 px-2.5 py-1.5 hover:bg-gray-50 cursor-pointer group",children:[(0,t.jsx)("input",{type:"checkbox",checked:b.has(e.id),onChange:()=>{var t;return t=e.id,void v(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})},className:"mt-0.5 w-3.5 h-3.5 rounded border-gray-300 text-blue-600 focus:ring-blue-500/20 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-[11px] text-gray-700 leading-relaxed",children:e.prompt}),(0,t.jsx)("span",{className:`inline-block mt-0.5 text-[9px] font-semibold px-1 py-0.5 rounded ${"fail"===e.expectedResult?"bg-red-50 text-red-600":"bg-green-50 text-green-600"}`,children:"fail"===e.expectedResult?"Should Fail":"Should Pass"})]}),n&&(0,t.jsx)("button",{type:"button",onClick:t=>{var s;t.preventDefault(),t.stopPropagation(),s=e.id,B(e=>e.filter(e=>e.id!==s)),v(e=>{let t=new Set(e);return t.delete(s),t})},className:"opacity-0 group-hover:opacity-100 p-0.5 text-gray-400 hover:text-red-500 transition-all flex-shrink-0","aria-label":"Delete",children:(0,t.jsx)(et.Trash2,{className:"w-3 h-3"})})]},e.id))]})]},s.name)})})]},e.name)})})]})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col bg-gray-50 overflow-hidden min-w-0",children:[(0,t.jsx)("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-0",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>en("quick-test"),className:`relative flex items-center gap-1.5 px-3 py-2.5 text-xs font-medium transition-colors ${"quick-test"===es?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(V,{className:"w-3.5 h-3.5"})," Quick Test","quick-test"===es&&(0,t.jsx)("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t"})]}),(0,t.jsxs)("button",{type:"button",onClick:()=>en("batch-results"),className:`relative flex items-center gap-1.5 px-3 py-2.5 text-xs font-medium transition-colors ${"batch-results"===es?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(D,{className:"w-3.5 h-3.5"})," Batch Results",eg.length>0&&(0,t.jsx)("span",{className:"text-[10px] bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded-full",children:eg.length}),"batch-results"===es&&(0,t.jsx)("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t"})]})]})}),"quick-test"===es&&(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[(0,t.jsx)("div",{className:"px-5 pt-4 pb-2 flex-shrink-0",children:eG?(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"text-[11px] font-medium text-gray-500",children:"Testing against:"}),p.map(e=>(0,t.jsx)("span",{className:"text-[11px] bg-blue-50 text-blue-700 px-2 py-0.5 rounded font-medium",children:o.get(e)??e},e)),h.map(e=>{let s=m.find(t=>t.id===e);return(0,t.jsx)("span",{className:"text-[11px] bg-indigo-50 text-indigo-700 px-2 py-0.5 rounded font-medium",children:s?.name},e)})]}):(0,t.jsx)("p",{className:"text-[11px] text-gray-400",children:"No policies or guardrails selected — select above to test against specific rules."})}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto px-5 py-3 space-y-3 min-h-0",children:[0===ec.length&&(0,t.jsx)("div",{className:"flex items-center justify-center h-full min-h-[120px]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:(0,t.jsx)(V,{className:"w-5 h-5 text-gray-400"})}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Type a prompt below to quickly test it."})]})}),ec.map(e=>(0,t.jsx)("div",{className:`flex ${"user"===e.type?"justify-end":"justify-start"}`,children:(0,t.jsx)("div",{className:`max-w-[85%] rounded-lg px-3 py-2 ${"user"===e.type?"bg-blue-600 text-white":"blocked"===e.result?"bg-red-50 border border-red-100":"bg-green-50 border border-green-100"}`,children:(0,t.jsxs)("p",{className:`text-xs leading-relaxed ${"user"===e.type?"text-white":"blocked"===e.result?"text-red-700":"text-green-700"}`,children:["system"===e.type&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 font-semibold mr-1",children:["blocked"===e.result?(0,t.jsx)(el.X,{className:"w-3 h-3 inline"}):(0,t.jsx)(P,{className:"w-3 h-3 inline"}),"blocked"===e.result?"Blocked":"Allowed",(0,t.jsx)("span",{className:"font-normal mx-0.5",children:"—"})]}),e.text,"system"===e.type&&null!=e.returnedText&&(0,t.jsxs)("span",{className:"block mt-1.5 pt-1.5 border-t border-gray-200/60",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Returned: "}),(0,t.jsx)("span",{className:"font-medium text-gray-700 break-all",children:e.returnedText})]})]})})},e.id)),ex&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsx)("div",{className:"bg-gray-100 rounded-lg px-3 py-2",children:(0,t.jsx)(q.Loader2,{className:"w-3.5 h-3.5 text-gray-400 animate-spin"})})}),(0,t.jsx)("div",{ref:eu})]}),(0,t.jsxs)("div",{className:"flex-shrink-0 px-5 pb-4",children:[(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg bg-white overflow-hidden focus-within:ring-2 focus-within:ring-blue-500/20 focus-within:border-blue-400",children:[(0,t.jsx)("textarea",{ref:eh,value:ed,onChange:e=>eo(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),eI())},placeholder:"Enter text to test...",rows:3,className:"w-full px-3 pt-3 pb-1 text-sm text-gray-700 placeholder:text-gray-400 focus:outline-none resize-none"}),(0,t.jsxs)("div",{className:"flex items-center justify-between px-3 pb-2",children:[(0,t.jsxs)("span",{className:"text-[10px] text-gray-400",children:["Press"," ",(0,t.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px] font-mono",children:"Enter"})," ","to submit ·"," ",(0,t.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px] font-mono",children:"Shift+Enter"})," ","for new line"]}),(0,t.jsx)("span",{className:"text-[10px] text-gray-400 tabular-nums",children:ed.length})]})]}),(0,t.jsxs)("button",{type:"button",onClick:eI,disabled:!ed.trim()||ex||a,className:`w-full mt-2 flex items-center justify-center gap-1.5 py-2.5 rounded-lg text-sm font-medium transition-colors ${!ed.trim()||ex||a?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[ex?(0,t.jsx)(q.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(Z,{className:"w-4 h-4"})," ",eW]})]})]}),"batch-results"===es&&(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden bg-white min-h-0",children:[(0,t.jsxs)("div",{className:"px-5 py-3 border-b border-gray-200 flex-shrink-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h2",{className:"text-sm font-semibold text-gray-900",children:"Results"}),eg.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>{if(0===eV.length)return;let e=eV.map(e=>({prompt_id:e.promptId,prompt:e.prompt,category:e.category,expected_result:e.expectedResult,actual_result:e.actualResult,is_match:e.isMatch?"yes":"no",status:e.status,triggered_by:e.triggeredBy??"",returned_text:e.returnedText??""})),t=new Blob([er.default.unparse(e)],{type:"text/csv"}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`compliance_batch_results_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(s)},disabled:0===eV.length,className:"flex items-center gap-1 text-[11px] font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100 px-2 py-1 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent",children:[(0,t.jsx)(U,{className:"w-3 h-3"})," Export CSV"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2.5 text-[11px]",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1 text-green-600",children:[(0,t.jsx)(P,{className:"w-3 h-3"}),eO]}),(0,t.jsxs)("span",{className:"flex items-center gap-1 text-amber-600",title:"Allowed content that should have been blocked",children:[(0,t.jsx)(_.AlertTriangle,{className:"w-3 h-3"}),eq," FN"]}),(0,t.jsxs)("span",{className:"flex items-center gap-1 text-red-600",title:"Blocked content that should have been allowed",children:[(0,t.jsx)(el.X,{className:"w-3 h-3"}),eD," FP"]}),eK>0&&(0,t.jsxs)("span",{className:"flex items-center gap-1 text-gray-500",children:[(0,t.jsx)(q.Loader2,{className:"w-3 h-3 animate-spin"}),eK]})]})]})]}),eg.length>0&&(0,t.jsx)("div",{className:"flex items-center gap-1 flex-wrap",children:["all","matches","mismatches","pending"].map(e=>{let s="all"===e?eg.length:"matches"===e?eO:"mismatches"===e?ez:eK;return(0,t.jsxs)("button",{type:"button",onClick:()=>ej(e),className:`text-[11px] font-medium px-2.5 py-1 rounded-md transition-colors capitalize ${ev===e?"bg-gray-900 text-white":"text-gray-500 hover:bg-gray-100"}`,children:[e," (",s,")"]},e)})})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0",children:0===eg.length?(0,t.jsx)("div",{className:"flex items-center justify-center h-full min-h-[120px]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:(0,t.jsx)(z,{className:"w-6 h-6 text-gray-400"})}),(0,t.jsx)("p",{className:"text-xs text-gray-500 max-w-[240px]",children:"Select prompts and click Simulate to run batch compliance tests."})]})}):(0,t.jsxs)("div",{className:"p-4 space-y-1.5",children:[eB.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-xl mb-4 border border-gray-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm flex-1",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"font-semibold text-gray-700",children:eg.length})," ",(0,t.jsx)("span",{className:"text-gray-500",children:"total"})]}),(0,t.jsx)("div",{className:"w-px h-4 bg-gray-200"}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"font-semibold text-green-700",children:eO})," ",(0,t.jsx)("span",{className:"text-gray-500",children:"correct"})]}),(0,t.jsx)("div",{className:"w-px h-4 bg-gray-200"}),(0,t.jsxs)("span",{title:"Allowed content that should have been blocked",children:[(0,t.jsx)("span",{className:"font-semibold text-amber-700",children:eq})," ",(0,t.jsx)("span",{className:"text-gray-500",children:"false negative"})]}),(0,t.jsx)("div",{className:"w-px h-4 bg-gray-200"}),(0,t.jsxs)("span",{title:"Blocked content that should have been allowed",children:[(0,t.jsx)("span",{className:"font-semibold text-red-700",children:eD})," ",(0,t.jsx)("span",{className:"text-gray-500",children:"false positive"})]})]}),(0,t.jsxs)("div",{className:`flex flex-col items-center justify-center min-w-[88px] py-2.5 px-4 rounded-xl border-2 font-bold text-2xl tabular-nums ${eO/eB.length>=.8?"bg-green-50 border-green-200 text-green-700":eO/eB.length>=.5?"bg-amber-50 border-amber-200 text-amber-700":"bg-red-50 border-red-200 text-red-700"}`,children:[(0,t.jsx)("span",{className:"text-[10px] font-semibold uppercase tracking-wider opacity-90",children:"Score"}),(0,t.jsxs)("span",{children:[Math.round(eO/eB.length*100),"%"]})]})]}),eV.map(e=>{let s=eN.has(e.promptId);return(0,t.jsx)("div",{className:`border rounded-lg overflow-hidden ${"complete"!==e.status?"border-gray-100 bg-gray-50/50":e.isMatch?"border-green-100":"border-red-100"}`,children:(0,t.jsxs)("div",{className:"p-2.5",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:"complete"!==e.status?(0,t.jsx)(q.Loader2,{className:"w-3.5 h-3.5 text-gray-400 animate-spin"}):e.isMatch?(0,t.jsx)(P,{className:"w-3.5 h-3.5 text-green-500"}):(0,t.jsx)(_.AlertTriangle,{className:"w-3.5 h-3.5 text-red-500"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-[11px] text-gray-700 leading-relaxed mb-1.5",children:e.prompt}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 flex-wrap",children:[(0,t.jsxs)("span",{className:"text-[9px] text-gray-400 inline-flex items-center gap-0.5",children:[(0,t.jsx)(ei,{iconKey:e.categoryIcon,className:"w-3 h-3"}),e.category]}),(0,t.jsx)("span",{className:`text-[9px] font-semibold px-1 py-0.5 rounded ${"fail"===e.expectedResult?"bg-red-50 text-red-600":"bg-green-50 text-green-600"}`,children:"fail"===e.expectedResult?"Expect Block":"Expect Allow"}),"complete"===e.status&&(0,t.jsx)("span",{className:`text-[9px] font-bold px-1 py-0.5 rounded ${e.isMatch?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:e.isMatch?"✓ Match":"✗ Gap"})]})]}),"complete"===e.status&&(0,t.jsx)("button",{type:"button",onClick:()=>{ew(t=>{let s=new Set(t);return s.has(e.promptId)?s.delete(e.promptId):s.add(e.promptId),s})},className:"flex-shrink-0 p-0.5 text-gray-400 hover:text-gray-600","aria-label":s?"Collapse":"Expand",children:s?(0,t.jsx)(E.ChevronDown,{className:"w-3.5 h-3.5"}):(0,t.jsx)($,{className:"w-3.5 h-3.5"})})]}),s&&"complete"===e.status&&(0,t.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-100 text-[11px] space-y-1",children:[e.triggeredBy&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Triggered by:"})," ",(0,t.jsx)("span",{className:"font-medium text-gray-700 bg-gray-100 px-1.5 py-0.5 rounded",children:e.triggeredBy})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Verdict:"})," ",(0,t.jsx)("span",{className:e.isMatch?"text-green-600":"text-red-600",children:e.isMatch?"Correctly handled":"fail"===e.expectedResult?"Gap — should have been blocked":"False positive — incorrectly blocked"})]}),null!=e.returnedText&&""!==e.returnedText&&(0,t.jsxs)("div",{className:"mt-1.5",children:[(0,t.jsx)("span",{className:"text-gray-400 block mb-0.5",children:"LLM response:"}),(0,t.jsx)("div",{className:"text-gray-700 bg-gray-50 rounded px-2 py-1.5 border border-gray-100 max-h-32 overflow-y-auto whitespace-pre-wrap break-words",children:e.returnedText})]})]})]})},e.promptId)})]})})]})]})]})]})})}var eo=e.i(220486);let{TextArea:ec}=u.Input,em="__new__";function ex({agentName:e,proxySettings:s,customProxyBaseUrl:a,disabledPersonalKeyCreation:l,creatingKey:r,createdKeyValue:n,onCreateKey:i}){let d,o=j.proxyBaseUrl??((d=s?.LITELLM_UI_API_DOC_BASE_URL)&&d.trim()?d:s?.PROXY_BASE_URL?s.PROXY_BASE_URL:a?.trim()?a:"<your_proxy_base_url>"),c=n?n.startsWith("Bearer ")?n:`Bearer ${n}`:"Bearer sk-1234",m=`curl -L -X POST '${o}/v1/chat/completions' \\
-H 'x-litellm-api-key: ${c}' \\
-d '{
  "model": "${e}",
  "stream": true,
  "stream_options": {
    "include_usage": true
  },
  "messages": [
    {
      "role": "user",
      "content": "hey"
    }
  ]
}'`;return(0,t.jsxs)("div",{className:"mx-auto max-w-3xl space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Proxy base URL"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 font-mono bg-gray-50 px-2 py-1.5 rounded border border-gray-200 break-all",children:o})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Call your agent (cURL)"}),(0,t.jsx)(b.default,{code:m,language:"bash"})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Create a key for this agent"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-3",children:["Create a virtual key that can only call this agent. The key will be scoped to you (user_id) and restricted to the model ",(0,t.jsx)("span",{className:"font-mono text-gray-800",children:e}),"."]}),(0,t.jsx)(p.Button,{type:"primary",onClick:i,loading:r,disabled:l,children:"Create key for this agent"}),l&&(0,t.jsx)("p",{className:"text-xs text-amber-600 mt-2",children:"Key creation is disabled for your account."}),n&&(0,t.jsx)("p",{className:"text-xs text-green-700 mt-2",children:"Key created. It is shown in the cURL example above — copy the snippet to use it."})]})]})}let ep="litellm_proxy/mcp/";function eu({accessToken:e,token:a,userID:l,userRole:r,disabledPersonalKeyCreation:b=!1,proxySettings:k,apiKey:C,customProxyBaseUrl:S}){let _,[A,M]=(0,s.useState)([]),[T,L]=(0,s.useState)([]),[P,R]=(0,s.useState)(!0),[E,$]=(0,s.useState)(null),[I,U]=(0,s.useState)("configure"),[B,O]=(0,s.useState)(!1),[z,D]=(0,s.useState)(null),[q,K]=(0,s.useState)(""),[V,F]=(0,s.useState)(""),[G,W]=(0,s.useState)(void 0),[H,X]=(0,s.useState)(.7),[Y,Z]=(0,s.useState)(4096),[Q,J]=(0,s.useState)([]),[ee,et]=(0,s.useState)([]),[es,ea]=(0,s.useState)(!1),[el,er]=(0,s.useState)(!1),[en,ei]=(0,s.useState)(!1),eu=C||e||"",eh=E===em?null:A.find(e=>e.model_name===E)??null,eg=E===em,ey=eh?(_=eh.model_info,_?.id??null):null,ef=(0,s.useCallback)(async()=>{if(e&&l&&r){R(!0);try{let t=await (0,N.fetchAvailableAgentModels)(e,l,r);M(t),E&&(E===em||t.some(e=>e.model_name===E))||$(t.length>0?t[0].model_name:null)}catch(e){console.error(e),v.default.fromBackend("Failed to load agents")}finally{R(!1)}}},[e,l,r]),eb=(0,s.useCallback)(async()=>{if(eu)try{let e=await (0,w.fetchAvailableModels)(eu);L(e),!G&&e.length>0&&W(e[0].model_group)}catch(e){console.error(e)}},[eu]);(0,s.useEffect)(()=>{ef()},[ef]),(0,s.useEffect)(()=>{eb()},[eb]);let ev=(0,s.useCallback)(async()=>{if(eu){ea(!0);try{let e=await (0,j.fetchMCPServers)(eu);et(Array.isArray(e)?e:e?.data??[])}catch(e){console.error("Error fetching MCP servers:",e)}finally{ea(!1)}}},[eu]);(0,s.useEffect)(()=>{ev()},[ev]),(0,s.useEffect)(()=>{D(null)},[E]),(0,s.useEffect)(()=>{if(eh&&!eg){K(eh.model_name),F(eh.litellm_params?.litellm_system_prompt??""),W(function(e){if(e&&e.startsWith("litellm_agent/"))return e.slice(14)||void 0}(eh.litellm_params?.model)??T[0]?.model_group);let e=eh.litellm_params;X("number"==typeof e?.temperature?e.temperature:.7),Z("number"==typeof e?.max_tokens?e.max_tokens:4096);let t=eh.litellm_params?.tools;J(Array.isArray(t)?t.filter(e=>e&&"object"==typeof e&&"mcp"===e.type&&"string"==typeof e.server_url):[])}},[E,eg,eh?.model_name,eh?.litellm_params?.tools]);let ej=Q.filter(e=>"mcp"===e.type&&e.server_url?.startsWith(ep)).map(e=>{let t=e.server_url.slice(ep.length),s=ee.find(e=>(e.alias||e.server_name||e.server_id)===t);return s?.server_id}).filter(e=>null!=e),eN=()=>{$(em),K(""),F("You are a helpful assistant."),W(T[0]?.model_group),X(.7),Z(4096),J([]),U("configure")},ew=async()=>{if(!e||!q?.trim()||!G)return void v.default.fromBackend("Name and underlying model are required");er(!0);try{await (0,j.modelCreateCall)(e,{model_name:q.trim(),litellm_params:{model:`litellm_agent/${G}`,litellm_system_prompt:V.trim()||void 0,temperature:H,max_tokens:Y,tools:Q},model_info:{}});let t=q.trim();await ef(),$(t),U("chat")}catch(e){v.default.fromBackend("Failed to save agent")}finally{er(!1)}},ek=async()=>{if(!e||!eh||!ey||!q?.trim()||!G)return void v.default.fromBackend("Name and underlying model are required");er(!0);try{await (0,j.modelPatchUpdateCall)(e,{model_name:q.trim(),litellm_params:{model:`litellm_agent/${G}`,litellm_system_prompt:V.trim()||void 0,temperature:H,max_tokens:Y,tools:Q},model_info:eh.model_info??{}},ey),v.default.success("Agent updated successfully"),await ef(),$(q.trim())}catch(e){v.default.fromBackend("Failed to update agent")}finally{er(!1)}},eC=async()=>{if(e&&l&&eh){O(!0),D(null);try{let t=await (0,j.keyCreateCall)(e,l,{models:[eh.model_name],key_alias:`Agent: ${eh.model_name}`}),s=t?.key??null;s?(D(s),v.default.success("Virtual key created. Use it in the curl example below.")):v.default.fromBackend("Key created but value not returned")}catch(e){v.default.fromBackend("Failed to create key for agent")}finally{O(!1)}}};return e&&l&&r?(0,t.jsxs)("div",{className:"flex h-full flex-col bg-white text-gray-900",children:[(0,t.jsxs)("div",{className:"flex flex-shrink-0 flex-col border-b border-gray-200",children:[(0,t.jsxs)("div",{className:"flex h-12 items-center justify-between px-4",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Agent Builder"}),eg?(0,t.jsx)(p.Button,{type:"primary",icon:(0,t.jsx)(x.SaveOutlined,{}),onClick:ew,loading:el,disabled:!q?.trim()||!G,children:"Save Agent"}):(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"Build Agents that pass your compliance requirements."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 border-t border-amber-200 bg-amber-50 px-4 py-2 text-xs text-amber-800",children:[(0,t.jsx)(d.ExperimentOutlined,{className:"flex-shrink-0 text-amber-600"}),(0,t.jsxs)("span",{children:["Agent Builder is experimental and may change or be removed without notice. We’d love your feedback—email us at"," ",(0,t.jsx)("a",{href:"mailto:product@berri.ai",className:"font-medium text-amber-900 underline hover:text-amber-700",children:"product@berri.ai"}),"."]})]})]}),(0,t.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,t.jsxs)("div",{className:"w-60 flex-shrink-0 border-r border-gray-200 bg-white flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-gray-200 p-3",children:[(0,t.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Agents"}),(0,t.jsx)(p.Button,{type:"text",size:"small",icon:(0,t.jsx)(c.PlusOutlined,{}),onClick:eN,"aria-label":"Add agent"})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-2",children:P?(0,t.jsx)("div",{className:"flex justify-center py-4",children:(0,t.jsx)(y.Spin,{size:"small"})}):(0,t.jsxs)(t.Fragment,{children:[A.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>$(e.model_name),className:`mb-1 w-full rounded-md border-l-2 px-3 py-2 text-left text-sm transition-colors ${E===e.model_name?"border-blue-500 bg-blue-50 text-blue-800":"border-transparent hover:bg-gray-50"}`,children:[(0,t.jsx)("div",{className:"font-medium truncate",children:e.model_name}),(0,t.jsx)("div",{className:"text-[10px] text-gray-500 truncate",children:"litellm_agent"})]},e.model_name)),(0,t.jsxs)("button",{type:"button",onClick:eN,className:"mb-1 w-full rounded-md border border-dashed border-gray-300 px-3 py-2 text-left text-sm text-gray-500 hover:border-blue-400 hover:bg-blue-50/50 hover:text-gray-700",children:[(0,t.jsx)(c.PlusOutlined,{className:"mr-1"})," New agent"]})]})})]}),(0,t.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden",children:[null===E&&!eg&&0===A.length&&!P&&(0,t.jsx)("div",{className:"flex flex-1 items-center justify-center p-8 text-gray-500",children:"No agents yet. Add an agent to get started."}),(null!==E||eg)&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(f.Tabs,{activeKey:I,onChange:e=>U(e),className:"flex-1 overflow-hidden [&_.ant-tabs-content]:h-full [&_.ant-tabs-tabpane]:h-full [&_.ant-tabs-nav]:pl-4",items:[{key:"configure",label:(0,t.jsxs)("span",{children:[(0,t.jsx)(m.RobotOutlined,{className:"mr-1"})," Configure"]}),children:(0,t.jsx)("div",{className:"h-full overflow-y-auto p-6",children:eg||eh?(0,t.jsxs)("div",{className:"mx-auto max-w-xl space-y-4",children:[!ey&&eh&&(0,t.jsx)("div",{className:"rounded border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-800",children:"This agent cannot be updated or deleted here (missing model id). Manage it from Models & Endpoints."}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Agent name"}),(0,t.jsx)(u.Input,{value:q,onChange:e=>K(e.target.value),placeholder:"My Agent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"System prompt"}),(0,t.jsx)(ec,{value:V,onChange:e=>F(e.target.value),placeholder:"You are a helpful assistant...",rows:6})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Underlying LLM"}),(0,t.jsx)(g.Select,{value:G,onChange:W,className:"w-full",options:T.map(e=>({value:e.model_group,label:e.model_group})),placeholder:"Select model"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Temperature"}),(0,t.jsx)(u.Input,{type:"number",min:0,max:2,step:.1,value:H,onChange:e=>X(Number(e.target.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Max tokens"}),(0,t.jsx)(u.Input,{type:"number",min:1,value:Y,onChange:e=>Z(Number(e.target.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"MCP servers"}),(0,t.jsx)(g.Select,{mode:"multiple",placeholder:"Select MCP servers to attach (same format as chat completions API)",value:ej,onChange:e=>{J(e.map(e=>{let t=ee.find(t=>t.server_id===e),s=t?.alias||t?.server_name||e;return{type:"mcp",server_label:"litellm",server_url:`${ep}${s}`,require_approval:"never"}}))},loading:es,className:"w-full",allowClear:!0,showSearch:!0,optionFilterProp:"label",options:ee.map(e=>({value:e.server_id,label:e.alias||e.server_name||e.server_id}))}),eh&&Q.length>0&&(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500",children:[Q.length," MCP server",1!==Q.length?"s":""," saved. Use the same ",(0,t.jsx)("code",{className:"rounded bg-gray-100 px-1",children:"tools"})," array in chat completions when calling this agent."]})]}),eh&&(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2 pt-2",children:[ey&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Button,{type:"primary",icon:(0,t.jsx)(x.SaveOutlined,{}),onClick:ek,loading:el,disabled:!q?.trim()||!G,children:"Update Agent"}),(0,t.jsx)(p.Button,{type:"default",danger:!0,icon:(0,t.jsx)(i.DeleteOutlined,{}),onClick:()=>{eh&&ey&&e&&h.Modal.confirm({title:"Delete agent",content:`Are you sure you want to delete "${eh.model_name}"? This cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{ei(!0);try{await (0,j.modelDeleteCall)(e,ey),v.default.success("Agent deleted"),await ef();let t=A.filter(e=>e.model_name!==eh.model_name);$(t.length>0?t[0].model_name:null)}catch(e){v.default.fromBackend("Failed to delete agent")}finally{ei(!1)}}})},loading:en,children:"Delete"})]}),(0,t.jsx)(p.Button,{type:"primary",icon:(0,t.jsx)(n,{}),onClick:()=>U("chat"),children:"Test in Chat"})]})]}):null})},{key:"chat",label:(0,t.jsxs)("span",{children:[(0,t.jsx)(n,{className:"mr-1"})," Chat"]}),disabled:eg,children:(0,t.jsx)("div",{className:"flex h-full flex-col min-h-0",children:eh?(0,t.jsx)(eo.default,{simplified:!0,fixedModel:eh.model_name,accessToken:e,token:a,userRole:r,userID:l,disabledPersonalKeyCreation:b,proxySettings:k},eh.model_name):(0,t.jsx)("div",{className:"flex flex-1 items-center justify-center text-gray-500",children:"Save an agent first to test in Chat."})})},{key:"test",label:(0,t.jsxs)("span",{children:[(0,t.jsx)(d.ExperimentOutlined,{className:"mr-1"})," Batch Test"]}),disabled:eg,children:(0,t.jsx)("div",{className:"flex h-full flex-col min-h-0",children:eh?(0,t.jsx)(ed,{accessToken:e,disabledPersonalKeyCreation:b,backendMode:"chat_completions",fixedModel:eh.model_name,proxySettings:k}):(0,t.jsx)("div",{className:"flex flex-1 items-center justify-center text-gray-500",children:"Select an agent to run batch tests."})})},{key:"connect",label:(0,t.jsxs)("span",{children:[(0,t.jsx)(o.LinkOutlined,{className:"mr-1"})," Connect"]}),disabled:eg,children:(0,t.jsx)("div",{className:"h-full overflow-y-auto p-6",children:eh?(0,t.jsx)(ex,{agentName:eh.model_name,proxySettings:k,customProxyBaseUrl:S,accessToken:e,userID:l,disabledPersonalKeyCreation:b,creatingKey:B,createdKeyValue:z,onCreateKey:eC}):(0,t.jsx)("div",{className:"flex flex-1 items-center justify-center text-gray-500",children:"Select an agent to see how to connect."})})}]})})]})]})]}):(0,t.jsx)("div",{className:"flex h-full items-center justify-center p-8 text-gray-500",children:"Sign in to use Agent Builder."})}var eh=e.i(447593),eg=e.i(91500),ey=e.i(592968),ef=e.i(422233),eb=e.i(761793),ev=e.i(964421),ej=e.i(953860),eN=e.i(903446),eN=eN;let ew=(0,A.default)("user-round",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);var ek=e.i(918789),eC=e.i(650056),eS=e.i(219470),e_=e.i(843153),eA=e.i(966988),eM=e.i(989022),eT=e.i(152401);function eL({messages:e,isLoading:s}){if(0===e.length)return(0,t.jsx)("div",{className:"h-full"});let a=[],l=0;for(;l<e.length;){let t=e[l];if("user"===t.role){let s=e[l+1];if(s?.role==="assistant"){a.push({user:t,assistant:s}),l+=2;continue}a.push({user:t})}else"assistant"===t.role&&a.push({assistant:t});l+=1}let r=e=>(0,t.jsxs)("div",{className:"whitespace-pre-wrap break-words",style:{wordWrap:"break-word",overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},children:[(0,t.jsx)(e_.default,{message:e}),(0,t.jsx)(ek.default,{components:{code({node:e,inline:s,className:a,children:l,...r}){let n=/language-(\w+)/.exec(a||"");return!s&&n?(0,t.jsx)(eC.Prism,{style:eS.coy,language:n[1],PreTag:"div",className:"rounded-md my-2",wrapLines:!0,wrapLongLines:!0,...r,children:String(l).replace(/\n$/,"")}):(0,t.jsx)("code",{className:`${a} px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono`,...r,children:l})},pre:({node:e,...s})=>(0,t.jsx)("pre",{style:{overflowX:"auto",maxWidth:"100%"},...s})},children:"string"==typeof e.content?e.content:""})]});return(0,t.jsxs)("div",{className:"flex flex-col gap-6 min-w-0 w-full p-4",children:[a.map((e,l)=>{let n=e.assistant,i=n?.model||"Assistant";return(0,t.jsxs)("div",{className:"space-y-4",children:[e.user&&(0,t.jsxs)("div",{className:"space-y-2 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-blue-100 text-blue-600",children:(0,t.jsx)(ew,{size:16})}),(0,t.jsx)("div",{className:"text-sm font-semibold text-gray-700",children:"You"})]}),r(e.user)]}),(0,t.jsx)("div",{className:"border-t border-gray-200"}),n?(0,t.jsxs)("div",{className:"space-y-3 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-gray-100 text-gray-600",children:(0,t.jsx)(T,{size:16})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-gray-700",children:i}),n.toolName&&(0,t.jsx)("span",{className:"rounded bg-gray-100 px-2 py-0.5 text-xs text-gray-600",children:n.toolName})]})]}),n.reasoningContent&&(0,t.jsx)(eA.default,{reasoningContent:n.reasoningContent}),n.searchResults&&(0,t.jsx)(eT.SearchResultsDisplay,{searchResults:n.searchResults}),r(n),(n.timeToFirstToken||n.totalLatency||n.usage)&&(0,t.jsx)(eM.default,{timeToFirstToken:n.timeToFirstToken,totalLatency:n.totalLatency,usage:n.usage,toolName:n.toolName})]}):s&&l===a.length-1?(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,t.jsx)(q.Loader2,{size:18,className:"animate-spin"}),(0,t.jsx)("span",{children:"Generating response..."})]}):(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"Waiting for a response..."})]},l)}),s&&0===a.length&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,t.jsx)(q.Loader2,{size:18,className:"animate-spin"}),(0,t.jsx)("span",{children:"Generating response..."})]})]})}function eP({value:e,options:s,loading:a,config:l,onChange:r}){return(0,t.jsx)(g.Select,{value:e||void 0,placeholder:a?`Loading ${l.selectorLabel.toLowerCase()}s...`:l.selectorPlaceholder,onChange:r,loading:a,showSearch:!0,filterOption:(e,t)=>(t?.label??"").toLowerCase().includes(e.toLowerCase()),options:s,className:"w-48 md:w-64 lg:w-72",notFoundContent:a?(0,t.jsx)("div",{className:"flex items-center justify-center py-2",children:(0,t.jsx)(y.Spin,{size:"small"})}):`No ${l.selectorLabel.toLowerCase()}s available`})}var eR=e.i(318059),eE=e.i(916940),e$=e.i(891547),eI=e.i(536916),eU=e.i(312361),eB=e.i(282786),eO=e.i(850627);let ez="/v1/chat/completions",eD="/a2a",eq={[ez]:{id:ez,label:"/v1/chat/completions",selectorType:"model",selectorLabel:"Model",selectorPlaceholder:"Select a model",inputPlaceholder:"Send a prompt to compare models",loadingMessage:"Gathering responses from all models...",validationMessage:"Select a model before sending a message."},[eD]:{id:eD,label:"/a2a (Agents)",selectorType:"agent",selectorLabel:"Agent",selectorPlaceholder:"Select an agent",inputPlaceholder:"Send a message to compare agents",loadingMessage:"Gathering responses from all agents...",validationMessage:"Select an agent before sending a message."}},eK=e=>"agent"===eq[e].selectorType,eV=(e,t)=>eK(t)?e.agent:e.model;function eF({comparison:e,onUpdate:a,onRemove:l,canRemove:r,selectorOptions:n,isLoadingOptions:i,endpointConfig:d,apiKey:o}){let c=eK(d.id),m=eV(e,d.id),[x,p]=(0,s.useState)(!1),u=(t,s)=>{a({[t]:s},e.applyAcrossModels?{applyToAll:!0,keysToApply:[t]}:void 0)},h=e.useAdvancedParams?1:.4,g=e.useAdvancedParams?"text-gray-700":"text-gray-400",y=(0,t.jsxs)("div",{className:"w-[300px] max-h-[65vh] overflow-y-auto relative",children:[(0,t.jsx)("button",{onClick:()=>{p(!1)},className:"absolute top-0 right-0 p-1 hover:bg-gray-100 rounded transition-colors text-gray-500 hover:text-gray-700 z-10",children:(0,t.jsx)(el.X,{size:14})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(eI.Checkbox,{checked:e.applyAcrossModels,onChange:t=>{t.target.checked?a({applyAcrossModels:!0,temperature:e.temperature,maxTokens:e.maxTokens,tags:[...e.tags],vectorStores:[...e.vectorStores],guardrails:[...e.guardrails],useAdvancedParams:e.useAdvancedParams},{applyToAll:!0,keysToApply:["temperature","maxTokens","tags","vectorStores","guardrails","useAdvancedParams"]}):a({applyAcrossModels:!1})},children:(0,t.jsx)("span",{className:"text-xs font-medium",children:"Sync Settings Across Models"})})}),(0,t.jsx)(eU.Divider,{className:"border-gray-200"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide",children:"General Settings"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600 block mb-0.5",children:"Tags"}),(0,t.jsx)(eR.default,{value:e.tags,onChange:e=>u("tags",e),accessToken:o})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600 block mb-0.5",children:"Vector Stores"}),(0,t.jsx)(eE.default,{value:e.vectorStores,onChange:e=>u("vectorStores",e),accessToken:o})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600 block mb-0.5",children:"Guardrails"}),(0,t.jsx)(e$.default,{value:e.guardrails,onChange:e=>u("guardrails",e),accessToken:o})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide",children:"Advanced Settings"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-2 pb-1",children:(0,t.jsx)(eI.Checkbox,{checked:e.useAdvancedParams,onChange:t=>{a({useAdvancedParams:t.target.checked},e.applyAcrossModels?{applyToAll:!0,keysToApply:["useAdvancedParams"]}:void 0)},children:(0,t.jsx)("span",{className:"text-sm font-medium",children:"Use Advanced Parameters"})})}),(0,t.jsxs)("div",{className:"space-y-2 transition-opacity duration-200",style:{opacity:h},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("label",{className:`text-xs font-medium ${g}`,children:"Temperature"}),(0,t.jsx)("span",{className:`text-xs ${g}`,children:e.temperature.toFixed(2)})]}),(0,t.jsx)(eO.Slider,{min:0,max:2,step:.01,value:e.temperature,onChange:e=>{u("temperature",Math.min(2,Math.max(0,Number((Array.isArray(e)?e[0]:e).toFixed(2)))))},disabled:!e.useAdvancedParams})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("label",{className:`text-xs font-medium ${g}`,children:"Max Tokens"}),(0,t.jsx)("span",{className:`text-xs ${g}`,children:e.maxTokens})]}),(0,t.jsx)(eO.Slider,{min:1,max:32768,step:1,value:e.maxTokens,onChange:e=>{u("maxTokens",Math.min(32768,Math.max(1,Math.round(Array.isArray(e)?e[0]:e))))},disabled:!e.useAdvancedParams})]})]})]})]})]})]});return(0,t.jsxs)("div",{className:"bg-white first:border-l-0 border-l border-gray-200 flex flex-col min-h-0",children:[(0,t.jsxs)("div",{className:"border-b flex items-center justify-between gap-3 px-4 py-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,t.jsx)(eP,{value:m,options:n,loading:i,config:d,onChange:e=>a(c?{agent:e}:{model:e})}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(eB.Popover,{content:y,trigger:[],open:x,onOpenChange:()=>{},placement:"bottomRight",destroyTooltipOnHide:!1,children:(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),p(e=>!e)},className:`p-2 rounded-lg transition-colors ${x?"bg-gray-200 text-gray-700":"hover:bg-gray-100 text-gray-600"}`,children:(0,t.jsx)(eN.default,{size:18})})})})]}),r&&(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),l()},className:"p-2 hover:bg-red-50 text-red-600 rounded-lg transition-colors",children:(0,t.jsx)(el.X,{size:18})})]}),(0,t.jsx)("div",{className:"relative flex-1 flex flex-col min-h-0",children:(0,t.jsx)("div",{className:"flex-1 max-h-[calc(100vh-385px)] overflow-auto rounded-b-2xl",children:(0,t.jsx)(eL,{messages:e.messages,isLoading:e.isLoading})})})]})}var eG=e.i(132104);let{TextArea:eW}=u.Input;function eH({value:e,onChange:s,onSend:a,disabled:l,hasAttachment:r,uploadComponent:n}){let i=!l&&(e.trim().length>0||!!r);return(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("div",{className:"flex items-center flex-1 bg-white border border-gray-300 rounded-xl px-3 py-1 min-h-[44px]",children:[n&&(0,t.jsx)("div",{className:"flex-shrink-0 mr-2",children:n}),(0,t.jsx)(eW,{value:e,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),i&&a())},placeholder:"Type your message... (Shift+Enter for new line)",disabled:l,className:"flex-1",autoSize:{minRows:1,maxRows:4},style:{resize:"none",border:"none",boxShadow:"none",background:"transparent",padding:"4px 0",fontSize:"14px",lineHeight:"20px"}}),(0,t.jsx)(p.Button,{onClick:a,disabled:!i,icon:(0,t.jsx)(eG.ArrowUpOutlined,{}),shape:"circle"})]})})}let eX=["Can you summarize the key points?","What assumptions did you make?","What are the next steps?"],eY=["Write me a poem","Explain quantum computing","Draft a polite email requesting a meeting"];function eZ({accessToken:e,disabledPersonalKeyCreation:a}){let[l,r]=(0,s.useState)([{id:"1",model:"",agent:"",messages:[],isLoading:!1,tags:[],mcpTools:[],vectorStores:[],guardrails:[],temperature:1,maxTokens:2048,applyAcrossModels:!1,useAdvancedParams:!1},{id:"2",model:"",agent:"",messages:[],isLoading:!1,tags:[],mcpTools:[],vectorStores:[],guardrails:[],temperature:1,maxTokens:2048,applyAcrossModels:!1,useAdvancedParams:!1}]),[n,d]=(0,s.useState)([]),[o,m]=(0,s.useState)([]),[x,h]=(0,s.useState)(!1),[y,f]=(0,s.useState)(!1),[b,j]=(0,s.useState)(ez),k=eq[b],C=eK(b),_=C?o.map(e=>({value:e.agent_name,label:e.agent_name||e.agent_id})):n.map(e=>({value:e,label:e})),A=C?y:x,[M,T]=(0,s.useState)(""),[L,P]=(0,s.useState)(null),[R,E]=(0,s.useState)(null),[$,I]=(0,s.useState)(a?"custom":"session"),[U,B]=(0,s.useState)(""),[O,z]=(0,s.useState)(""),[D]=(0,s.useState)(()=>sessionStorage.getItem("customProxyBaseUrl")||"");(0,s.useEffect)(()=>{let e=setTimeout(()=>{z(U)},300);return()=>clearTimeout(e)},[U]),(0,s.useEffect)(()=>()=>{R&&URL.revokeObjectURL(R)},[R]);let q=(0,s.useMemo)(()=>"session"===$?e||"":O.trim(),[$,e,O]),K=(0,s.useMemo)(()=>l.length>0&&l.every(e=>!e.isLoading&&e.messages.some(e=>"assistant"===e.role)),[l]);(0,s.useEffect)(()=>{let e=!0;return(async()=>{if(!q)return d([]);h(!0);try{let t=await (0,w.fetchAvailableModels)(q);if(!e)return;let s=Array.from(new Set(t.map(e=>e.model_group)));d(s)}catch(t){console.error("CompareUI: failed to fetch models",t),e&&d([])}finally{e&&h(!1)}})(),()=>{e=!1}},[q]),(0,s.useEffect)(()=>{let e=!0;return(async()=>{if(!q||!C)return m([]);f(!0);try{let t=await (0,N.fetchAvailableAgents)(q,D||void 0);if(!e)return;m(t)}catch(t){console.error("CompareUI: failed to fetch agents",t),e&&m([])}finally{e&&f(!1)}})(),()=>{e=!1}},[q,C]),(0,s.useEffect)(()=>{0!==n.length&&r(e=>e.map((e,t)=>({...e,temperature:e.temperature??1,maxTokens:e.maxTokens??2048,applyAcrossModels:e.applyAcrossModels??!1,useAdvancedParams:e.useAdvancedParams??!1,...e.model?{}:{model:n[t%n.length]??""}})))},[n]);let V=()=>{R&&URL.revokeObjectURL(R),P(null),E(null)},F=(e,t)=>{r(s=>s.map(s=>{if(s.id!==e)return s;let a=[...s.messages],l=a[a.length-1];return l&&"assistant"===l.role?a[a.length-1]={...l,timeToFirstToken:t}:l&&"user"===l.role&&a.push({role:"assistant",content:"",timeToFirstToken:t}),{...s,messages:a}}))},G=(e,t)=>{r(s=>s.map(s=>{if(s.id!==e)return s;let a=[...s.messages],l=a[a.length-1];return l&&"assistant"===l.role?a[a.length-1]={...l,totalLatency:t}:l&&"user"===l.role&&a.push({role:"assistant",content:"",totalLatency:t}),{...s,messages:a}}))},W=!!e,H=async e=>{let t=e.trim(),s=!!L;if(!t&&!s)return;if(!q)return void v.default.fromBackend("Please provide a Virtual Key or select Current UI Session");if(0===l.length)return;if(l.some(e=>{let t;return!((t=eV(e,b))&&t.trim())}))return void v.default.fromBackend(k.validationMessage);let a=s?await (0,ev.createChatMultimodalMessage)(t,L):{role:"user",content:t},n=(0,ev.createChatDisplayMessage)(t,s,R||void 0,L?.name),i=new Map;l.forEach(e=>{let s=e.traceId??(0,ef.v4)(),l=[...e.messages.map(({role:e,content:t})=>({role:e,content:Array.isArray(t)||"string"==typeof t?t:""})),a];i.set(e.id,{id:e.id,model:e.model,agent:e.agent,inputMessage:t,traceId:s,tags:e.tags,vectorStores:e.vectorStores,guardrails:e.guardrails,temperature:e.temperature,maxTokens:e.maxTokens,displayMessages:[...e.messages,n],apiChatHistory:l})}),0!==i.size&&(r(e=>e.map(e=>{let t=i.get(e.id);return t?{...e,traceId:t.traceId,messages:t.displayMessages,isLoading:!0}:e})),T(""),V(),i.forEach(e=>{let t=e.tags.length>0?e.tags:void 0,s=e.vectorStores.length>0?e.vectorStores:void 0,a=e.guardrails.length>0?e.guardrails:void 0,n=l.find(t=>t.id===e.id),i=n?.useAdvancedParams??!1;(C?(0,ej.makeA2AStreamMessageRequest)(e.agent,e.inputMessage,(t,s)=>{r(a=>a.map(a=>{if(a.id!==e.id)return a;let l=[...a.messages],r=l[l.length-1];return r&&"assistant"===r.role?l[l.length-1]={...r,content:t,model:r.model??s}:l.push({role:"assistant",content:t,model:s}),{...a,messages:l}}))},q,void 0,t=>F(e.id,t),t=>G(e.id,t),void 0,D||void 0):(0,S.makeOpenAIChatCompletionRequest)(e.apiChatHistory,(t,s)=>{var a;return a=e.id,void(t&&r(e=>e.map(e=>{if(e.id!==a)return e;let l=[...e.messages],r=l[l.length-1];if(r&&"assistant"===r.role){let e="string"==typeof r.content?r.content:"";l[l.length-1]={...r,content:e+t,model:r.model??s}}else l.push({role:"assistant",content:t,model:s});return{...e,messages:l}})))},e.model,q,t,void 0,t=>{var s;return s=e.id,void(t&&r(e=>e.map(e=>{if(e.id!==s)return e;let a=[...e.messages],l=a[a.length-1];return l&&"assistant"===l.role?a[a.length-1]={...l,reasoningContent:(l.reasoningContent||"")+t}:l&&"user"===l.role&&a.push({role:"assistant",content:"",reasoningContent:t}),{...e,messages:a}})))},t=>F(e.id,t),t=>{var s;return s=e.id,void r(e=>e.map(e=>{if(e.id!==s)return e;let a=[...e.messages],l=a[a.length-1];return l&&"assistant"===l.role&&(a[a.length-1]={...l,usage:t,toolName:void 0}),{...e,messages:a}}))},e.traceId,s,a,void 0,void 0,void 0,t=>{var s;return s=e.id,void(t&&r(e=>e.map(e=>{if(e.id!==s)return e;let a=[...e.messages],l=a[a.length-1];return l&&"assistant"===l.role&&(a[a.length-1]={...l,searchResults:t}),{...e,messages:a}})))},i?e.temperature:void 0,i?e.maxTokens:void 0,t=>G(e.id,t),D||void 0)).catch(t=>{let s=t instanceof Error?t.message:String(t);console.error("CompareUI: failed to fetch response",t),v.default.fromBackend(s),r(t=>t.map(t=>{if(t.id!==e.id)return t;let a=[...t.messages],l=a[a.length-1],r=l&&"assistant"===l.role&&"string"==typeof l.content?l.content:"";return l&&"assistant"===l.role?a[a.length-1]={...l,content:r?`${r}
Error fetching response: ${s}`:`Error fetching response: ${s}`}:a.push({role:"assistant",content:`Error fetching response: ${s}`}),{...t,messages:a}}))}).finally(()=>{r(t=>t.map(t=>t.id===e.id?{...t,isLoading:!1}:t))})}))},X=e=>{T(e)},Y=l.some(e=>e.messages.length>0),Z=l.some(e=>e.isLoading),Q=!!L,J=!!L?.name.toLowerCase().endsWith(".pdf"),ee=!Y&&!Z&&!Q;return(0,t.jsx)("div",{className:"w-full h-full p-4 bg-white",children:(0,t.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm min-h-[calc(100vh-160px)] flex flex-col",children:[(0,t.jsx)("div",{className:"border-b px-4 py-2",children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Virtual Key Source"}),(0,t.jsxs)(g.Select,{value:$,onChange:e=>I(e),disabled:a,className:"w-48",children:[(0,t.jsx)(g.Select.Option,{value:"session",disabled:!W,children:"Current UI Session"}),(0,t.jsx)(g.Select.Option,{value:"custom",children:"Virtual Key"})]}),"custom"===$&&(0,t.jsx)(u.Input.Password,{value:U,onChange:e=>B(e.target.value),placeholder:"Enter Virtual Key",className:"w-56"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Endpoint"}),(0,t.jsx)(g.Select,{value:b,onChange:e=>j(e),className:"w-56",children:Object.values(eq).map(e=>({value:e.id,label:e.label})).map(e=>(0,t.jsx)(g.Select.Option,{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(p.Button,{onClick:()=>{r(e=>e.map(e=>({...e,messages:[],traceId:void 0,isLoading:!1}))),T(""),V()},disabled:!Y,icon:(0,t.jsx)(eh.ClearOutlined,{}),children:"Clear All Chats"}),(0,t.jsx)(ey.Tooltip,{title:l.length>=3?"Compare up to 3 models at a time":"Add another comparison",children:(0,t.jsx)(p.Button,{onClick:()=>{if(l.length>=3)return;let e=n[l.length%(n.length||1)]??"",t=o[l.length%(o.length||1)]?.agent_name??"",s={id:Date.now().toString(),model:e,agent:t,messages:[],isLoading:!1,tags:[],mcpTools:[],vectorStores:[],guardrails:[],temperature:1,maxTokens:2048,applyAcrossModels:!1,useAdvancedParams:!1};r(e=>[...e,s])},disabled:l.length>=3,icon:(0,t.jsx)(c.PlusOutlined,{}),children:"Add Comparison"})})]})]})}),(0,t.jsx)("div",{className:"grid flex-1 min-h-0 auto-rows-[minmax(0,1fr)]",style:{gridTemplateColumns:`repeat(${l.length}, minmax(0, 1fr))`},children:l.map(e=>(0,t.jsx)(eF,{comparison:e,onUpdate:(t,s)=>{var a;return a=e.id,void r(e=>{if(s?.applyToAll&&s.keysToApply?.length){let l={};s.keysToApply.forEach(e=>{let s=t[e];void 0!==s&&(l[e]=Array.isArray(s)?[...s]:s)});let r=Object.keys(l).length>0;return e.map(e=>e.id===a?{...e,...t}:r?{...e,...l}:e)}return e.map(e=>e.id===a?{...e,...t}:e)})},onRemove:()=>{var t;return t=e.id,void(l.length>1&&r(e=>e.filter(e=>e.id!==t)))},canRemove:l.length>1,selectorOptions:_,isLoadingOptions:A,endpointConfig:k,apiKey:q},e.id))}),(0,t.jsx)("div",{className:"flex justify-center pb-4",children:(0,t.jsx)("div",{className:"w-full max-w-3xl px-4",children:(0,t.jsxs)("div",{className:"border border-gray-200 shadow-lg rounded-xl bg-white p-4",children:[(0,t.jsx)("div",{className:"flex items-center justify-between gap-4 mb-3 min-h-8",children:Q?(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Attachment ready to send"}):ee?(0,t.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto",children:eY.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>X(e),className:"shrink-0 rounded-full border border-gray-200 px-3 py-1 text-xs font-medium text-gray-600 transition-colors hover:bg-gray-100 cursor-pointer",children:e},e))}):K&&!Q?(0,t.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto",children:eX.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>X(e),className:"shrink-0 rounded-full border border-gray-200 px-3 py-1 text-xs font-medium text-gray-600 transition-colors hover:bg-gray-100 cursor-pointer",children:e},e))}):Z?(0,t.jsxs)("span",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,t.jsx)("span",{className:"h-2 w-2 rounded-full bg-blue-500 animate-pulse","aria-hidden":!0}),k.loadingMessage]}):(0,t.jsx)("span",{className:"text-sm text-gray-500",children:k.inputPlaceholder})}),L&&(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,t.jsx)("div",{className:"relative inline-block",children:J?(0,t.jsx)("div",{className:"w-10 h-10 rounded-md bg-red-500 flex items-center justify-center",children:(0,t.jsx)(eg.FilePdfOutlined,{style:{fontSize:"16px",color:"white"}})}):(0,t.jsx)("img",{src:R||"",alt:"Upload preview",className:"w-10 h-10 rounded-md border border-gray-200 object-cover"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:L.name}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:J?"PDF":"Image"})]}),(0,t.jsx)("button",{className:"flex items-center justify-center w-6 h-6 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded-full transition-colors",onClick:V,children:(0,t.jsx)(i.DeleteOutlined,{style:{fontSize:"12px"}})})]})}),(0,t.jsx)(eH,{value:M,onChange:e=>{T(e)},onSend:()=>{H(M)},disabled:0===l.length||l.every(e=>e.isLoading),hasAttachment:Q,uploadComponent:(0,t.jsx)(eb.default,{chatUploadedImage:L,chatImagePreviewUrl:R,onImageUpload:e=>(R&&URL.revokeObjectURL(R),P(e),E(URL.createObjectURL(e)),!1),onRemoveImage:V})})]})})})]})})}var eQ=e.i(653824),eJ=e.i(881073),e0=e.i(197647),e1=e.i(723731),e2=e.i(404206),e5=e.i(135214),e3=e.i(62478);function e4(){let{accessToken:e,userRole:a,userId:l,disabledPersonalKeyCreation:r,token:n}=(0,e5.default)(),[i,d]=(0,s.useState)(void 0);return(0,s.useEffect)(()=>{(async()=>{if(e){let t=await (0,e3.fetchProxySettings)(e);t&&d({PROXY_BASE_URL:t.PROXY_BASE_URL,LITELLM_UI_API_DOC_BASE_URL:t.LITELLM_UI_API_DOC_BASE_URL})}})()},[e]),(0,t.jsxs)(eQ.TabGroup,{className:"h-full w-full",children:[(0,t.jsxs)(eJ.TabList,{className:"mb-0",children:[(0,t.jsx)(e0.Tab,{children:"Chat"}),(0,t.jsx)(e0.Tab,{children:"Compare"}),(0,t.jsx)(e0.Tab,{children:"Compliance"}),(0,t.jsx)(e0.Tab,{children:"Agent Builder (Experimental)"})]}),(0,t.jsxs)(e1.TabPanels,{className:"h-full",children:[(0,t.jsx)(e2.TabPanel,{className:"h-full",children:(0,t.jsx)(eo.default,{accessToken:e,token:n,userRole:a,userID:l,disabledPersonalKeyCreation:r,proxySettings:i})}),(0,t.jsx)(e2.TabPanel,{className:"h-full",children:(0,t.jsx)(eZ,{accessToken:e,disabledPersonalKeyCreation:r})}),(0,t.jsx)(e2.TabPanel,{className:"h-full",children:(0,t.jsx)(ed,{accessToken:e,disabledPersonalKeyCreation:r})}),(0,t.jsx)(e2.TabPanel,{className:"h-full",children:(0,t.jsx)(eu,{accessToken:e,token:n,userID:l,userRole:a,disabledPersonalKeyCreation:r,proxySettings:i,customProxyBaseUrl:i?.LITELLM_UI_API_DOC_BASE_URL??i?.PROXY_BASE_URL})})]})]})}e.s(["default",()=>e4],213970)}]);