(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,152473,e=>{"use strict";var t=e.i(271645);let s={enabled:!0,leading:!1,trailing:!0,wait:0,onExecute:()=>{}};class i{constructor(e,t){this.fn=e,this._canLeadingExecute=!0,this._isPending=!1,this._executionCount=0,this._options={...s,...t}}setOptions(e){return this._options={...this._options,...e},this._options.enabled||(this._isPending=!1),this._options}getOptions(){return this._options}maybeExecute(...e){this._options.leading&&this._canLeadingExecute&&(this.executeFunction(...e),this._canLeadingExecute=!1),(this._options.leading||this._options.trailing)&&(this._isPending=!0),this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this._canLeadingExecute=!0,this._isPending=!1,this._options.trailing&&this.executeFunction(...e)},this._options.wait)}executeFunction(...e){this._options.enabled&&(this.fn(...e),this._executionCount++,this._options.onExecute(this))}cancel(){this._timeoutId&&(clearTimeout(this._timeoutId),this._canLeadingExecute=!0,this._isPending=!1)}getExecutionCount(){return this._executionCount}getIsPending(){return this._options.enabled&&this._isPending}}function a(e,s){let[a,l]=(0,t.useState)(e),n=function(e,s){let[a]=(0,t.useState)(()=>{var t;return Object.getOwnPropertyNames(Object.getPrototypeOf(t=new i(e,s))).filter(e=>"function"==typeof t[e]).reduce((e,s)=>{let i=t[s];return"function"==typeof i&&(e[s]=i.bind(t)),e},{})});return a.setOptions(s),a}(l,s);return[a,n.maybeExecute,n]}e.s(["useDebouncedState",()=>a],152473)},954616,e=>{"use strict";var t=e.i(271645),s=e.i(114272),i=e.i(540143),a=e.i(915823),l=e.i(619273),n=class extends a.Subscribable{#e;#t=void 0;#s;#i;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,l.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,l.hashKey)(t.mutationKey)!==(0,l.hashKey)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#l(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#a(),this.#l()}mutate(e,t){return this.#i=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#a(){let e=this.#s?.state??(0,s.getDefaultState)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#l(e){i.notifyManager.batch(()=>{if(this.#i&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context,i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#i.onSuccess?.(e.data,t,s,i)}catch(e){Promise.reject(e)}try{this.#i.onSettled?.(e.data,null,t,s,i)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#i.onError?.(e.error,t,s,i)}catch(e){Promise.reject(e)}try{this.#i.onSettled?.(void 0,e.error,t,s,i)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#t)})})}},r=e.i(912598);function o(e,s){let a=(0,r.useQueryClient)(s),[o]=t.useState(()=>new n(a,e));t.useEffect(()=>{o.setOptions(e)},[o,e]);let c=t.useSyncExternalStore(t.useCallback(e=>o.subscribe(i.notifyManager.batchCalls(e)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),d=t.useCallback((e,t)=>{o.mutate(e,t).catch(l.noop)},[o]);if(c.error&&(0,l.shouldThrowError)(o.options.throwOnError,[c.error]))throw c.error;return{...c,mutate:d,mutateAsync:c.mutate}}e.s(["useMutation",()=>o],954616)},700514,e=>{"use strict";var t=e.i(271645);e.s(["defaultPageSize",0,25,"useBaseUrl",0,()=>{let[e,s]=(0,t.useState)("http://localhost:4000");return(0,t.useEffect)(()=>{{let{protocol:e,host:t}=window.location;s(`${e}//${t}`)}},[]),e}])},633627,e=>{"use strict";var t=e.i(764205);let s=async(e,s)=>{if(!e)return[];try{let i=[],a=1,l=!0;for(;l;){let n=await (0,t.teamListCall)(e,s||null,null);i=[...i,...n],a<n.total_pages?a++:l=!1}return i}catch(e){return console.error("Error fetching all teams:",e),[]}},i=async e=>{if(!e)return[];try{let s=[],i=1,a=!0;for(;a;){let l=await (0,t.organizationListCall)(e);s=[...s,...l],i<l.total_pages?i++:a=!1}return s}catch(e){return console.error("Error fetching all organizations:",e),[]}};e.s(["fetchAllOrganizations",0,i,"fetchAllTeams",0,s])},50882,969550,e=>{"use strict";var t=e.i(843476),s=e.i(621482),i=e.i(243652),a=e.i(764205),l=e.i(135214);let n=(0,i.createQueryKeys)("infiniteKeyAliases");var r=e.i(56456),o=e.i(152473),c=e.i(199133),d=e.i(271645);e.s(["PaginatedKeyAliasSelect",0,({value:e,onChange:i,placeholder:u="Select a key alias",style:h,pageSize:m=50,allowClear:g=!0,disabled:p=!1})=>{let[x,f]=(0,d.useState)(""),[y,w]=(0,o.useDebouncedState)("",{wait:300}),{data:S,fetchNextPage:b,hasNextPage:v,isFetchingNextPage:j,isLoading:_}=((e=50,t)=>{let{accessToken:i}=(0,l.default)();return(0,s.useInfiniteQuery)({queryKey:n.list({filters:{size:e,...t&&{search:t}}}),queryFn:async({pageParam:s})=>await (0,a.keyAliasesCall)(i,s,e,t),initialPageParam:1,getNextPageParam:e=>{if(e.current_page<e.total_pages)return e.current_page+1},enabled:!!i})})(m,y||void 0),C=(0,d.useMemo)(()=>{if(!S?.pages)return[];let e=new Set,t=[];for(let s of S.pages)for(let i of s.aliases)!i||e.has(i)||(e.add(i),t.push({label:i,value:i}));return t},[S]);return(0,t.jsx)(c.Select,{value:e||void 0,onChange:e=>{i?.(e??"")},placeholder:u,style:{width:"100%",...h},allowClear:g,disabled:p,showSearch:!0,filterOption:!1,onSearch:e=>{f(e),w(e)},searchValue:x,onPopupScroll:e=>{let t=e.currentTarget;(t.scrollTop+t.clientHeight)/t.scrollHeight>=.8&&v&&!j&&b()},loading:_,notFoundContent:_?(0,t.jsx)(r.LoadingOutlined,{spin:!0}):"No key aliases found",options:C,popupRender:e=>(0,t.jsxs)(t.Fragment,{children:[e,j&&(0,t.jsx)("div",{style:{textAlign:"center",padding:8},children:(0,t.jsx)(r.LoadingOutlined,{spin:!0})})]})})}],50882);let u=d.forwardRef(function(e,t){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"}))});var h=e.i(464571),m=e.i(311451),g=e.i(374009);e.s(["default",0,({options:e,onApplyFilters:s,onResetFilters:i,initialValues:a={},buttonLabel:l="Filters"})=>{let[n,r]=(0,d.useState)(!1),[o,p]=(0,d.useState)(a),[x,f]=(0,d.useState)({}),[y,w]=(0,d.useState)({}),[S,b]=(0,d.useState)({}),[v,j]=(0,d.useState)({}),_=(0,d.useCallback)((0,g.default)(async(e,t)=>{if(t.isSearchable&&t.searchFn){w(e=>({...e,[t.name]:!0}));try{let s=await t.searchFn(e);f(e=>({...e,[t.name]:s}))}catch(e){console.error("Error searching:",e),f(e=>({...e,[t.name]:[]}))}finally{w(e=>({...e,[t.name]:!1}))}}},300),[]),C=(0,d.useCallback)(async e=>{if(e.isSearchable&&e.searchFn&&!v[e.name]){w(t=>({...t,[e.name]:!0})),j(t=>({...t,[e.name]:!0}));try{let t=await e.searchFn("");f(s=>({...s,[e.name]:t}))}catch(t){console.error("Error loading initial options:",t),f(t=>({...t,[e.name]:[]}))}finally{w(t=>({...t,[e.name]:!1}))}}},[v]);(0,d.useEffect)(()=>{n&&e.forEach(e=>{e.isSearchable&&!v[e.name]&&C(e)})},[n,e,C,v]);let k=(e,t)=>{let i={...o,[e]:t};p(i),s(i)};return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsx)(h.Button,{icon:(0,t.jsx)(u,{className:"h-4 w-4"}),onClick:()=>r(!n),className:"flex items-center gap-2",children:l}),(0,t.jsx)(h.Button,{onClick:()=>{let t={};e.forEach(e=>{t[e.name]=""}),p(t),i()},children:"Reset Filters"})]}),n&&(0,t.jsx)("div",{className:"grid grid-cols-3 gap-x-6 gap-y-4 mb-6",children:["Team ID","Status","Organization ID","Key Alias","User ID","End User","Error Code","Error Message","Key Hash","Model"].map(s=>{let i,a=e.find(e=>e.label===s||e.name===s);return a?(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:a.label||a.name}),a.isSearchable?(0,t.jsx)(c.Select,{showSearch:!0,className:"w-full",placeholder:`Search ${a.label||a.name}...`,value:o[a.name]||void 0,onChange:e=>k(a.name,e),onOpenChange:e=>{e&&a.isSearchable&&!v[a.name]&&C(a)},onSearch:e=>{b(t=>({...t,[a.name]:e})),a.searchFn&&_(e,a)},filterOption:!1,loading:y[a.name],options:x[a.name]||[],allowClear:!0,notFoundContent:y[a.name]?"Loading...":"No results found"}):a.options?(0,t.jsx)(c.Select,{className:"w-full",placeholder:`Select ${a.label||a.name}...`,value:o[a.name]||void 0,onChange:e=>k(a.name,e),allowClear:!0,children:a.options.map(e=>(0,t.jsx)(c.Select.Option,{value:e.value,children:e.label},e.value))}):a.customComponent?(i=a.customComponent,(0,t.jsx)(i,{value:o[a.name]||void 0,onChange:e=>k(a.name,e??""),placeholder:`Select ${a.label||a.name}...`})):(0,t.jsx)(m.Input,{className:"w-full",placeholder:`Enter ${a.label||a.name}...`,value:o[a.name]||"",onChange:e=>k(a.name,e.target.value),allowClear:!0})]},a.name):null})})]})}],969550)},566606,e=>{"use strict";var t=e.i(843476),s=e.i(271645),i=e.i(618566),a=e.i(947293),l=e.i(764205),n=e.i(954616),r=e.i(266027),o=e.i(612256);let c=(0,e.i(243652).createQueryKeys)("onboarding");var d=e.i(482725),u=e.i(56456);function h(){return(0,t.jsx)("div",{className:"mx-auto w-full max-w-md mt-10 flex justify-center",children:(0,t.jsx)(d.Spin,{indicator:(0,t.jsx)(u.LoadingOutlined,{spin:!0}),size:"large"})})}var m=e.i(560445),g=e.i(464571);function p(){return(0,t.jsxs)("div",{className:"mx-auto w-full max-w-md mt-10",children:[(0,t.jsx)(m.Alert,{type:"error",message:"Failed to load invitation",description:"The invitation link may be invalid or expired.",showIcon:!0}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(g.Button,{href:"/ui/login",children:"Back to Login"})})]})}var x=e.i(175712),f=e.i(808613),y=e.i(311451),w=e.i(898586);function S({variant:e,userEmail:i,isPending:a,claimError:l,onSubmit:n}){let[r]=f.Form.useForm();return s.default.useEffect(()=>{i&&r.setFieldValue("user_email",i)},[i,r]),(0,t.jsx)("div",{className:"mx-auto w-full max-w-md mt-10",children:(0,t.jsxs)(x.Card,{children:[(0,t.jsx)(w.Typography.Title,{level:5,className:"text-center mb-5",children:"ðŸš… LiteLLM"}),(0,t.jsx)(w.Typography.Title,{level:3,children:"reset_password"===e?"Reset Password":"Sign Up"}),(0,t.jsx)(w.Typography.Text,{children:"reset_password"===e?"Reset your password to access Admin UI.":"Claim your user account to login to Admin UI."}),"signup"===e&&(0,t.jsx)(m.Alert,{className:"mt-4",type:"info",message:"SSO",description:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"SSO is under the Enterprise Tier."}),(0,t.jsx)(g.Button,{type:"primary",size:"small",href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"Get Free Trial"})]}),showIcon:!0}),(0,t.jsxs)(f.Form,{className:"mt-10 mb-5",layout:"vertical",form:r,onFinish:e=>n({password:e.password}),children:[(0,t.jsx)(f.Form.Item,{label:"Email Address",name:"user_email",children:(0,t.jsx)(y.Input,{type:"email",disabled:!0})}),(0,t.jsx)(f.Form.Item,{label:"Password",name:"password",rules:[{required:!0,message:"password required to sign up"}],help:"reset_password"===e?"Enter your new password":"Create a password for your account",children:(0,t.jsx)(y.Input.Password,{})}),l&&(0,t.jsx)(m.Alert,{type:"error",message:l,showIcon:!0,className:"mb-4"}),(0,t.jsx)("div",{className:"mt-10",children:(0,t.jsx)(g.Button,{htmlType:"submit",loading:a,children:"reset_password"===e?"Reset Password":"Sign Up"})})]})]})})}function b({variant:e}){let d=(0,i.useSearchParams)().get("invitation_id"),[u,m]=s.default.useState(null),{data:g,isLoading:x,isError:f}=(e=>{let{isLoading:t}=(0,o.useUIConfig)();return(0,r.useQuery)({queryKey:c.detail(e??""),queryFn:async()=>{if(!e)throw Error("inviteId is required");return(0,l.getOnboardingCredentials)(e)},enabled:!!e&&!t})})(d),{mutate:y,isPending:w}=(0,n.useMutation)({mutationFn:async({accessToken:e,inviteId:t,userId:s,password:i})=>await (0,l.claimOnboardingToken)(e,t,s,i)}),b=g?.token?(0,a.jwtDecode)(g.token):null,v=b?.user_email??"",j=b?.user_id??null,_=b?.key??null,C=g?.token??null;return x?(0,t.jsx)(h,{}):f?(0,t.jsx)(p,{}):(0,t.jsx)(S,{variant:e,userEmail:v,isPending:w,claimError:u,onSubmit:e=>{_&&C&&j&&d&&(m(null),y({accessToken:_,inviteId:d,userId:j,password:e.password},{onSuccess:()=>{document.cookie=`token=${C}; path=/; SameSite=Lax`;let e=(0,l.getProxyBaseUrl)();window.location.href=e?`${e}/ui/?login=success`:"/ui/?login=success"},onError:e=>{m(e.message||"Failed to submit. Please try again.")}}))}})}function v(){let e=(0,i.useSearchParams)().get("action");return(0,t.jsx)(b,{variant:"reset_password"===e?"reset_password":"signup"})}function j(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}),children:(0,t.jsx)(v,{})})}e.s(["default",()=>j],566606)},693569,e=>{"use strict";var t=e.i(843476),s=e.i(268004),i=e.i(309426),a=e.i(350967),l=e.i(898586),n=e.i(947293),r=e.i(618566),o=e.i(271645),c=e.i(566606),d=e.i(584578),u=e.i(764205),h=e.i(702597),m=e.i(207082),g=e.i(500330),p=e.i(871943),x=e.i(502547),f=e.i(360820),y=e.i(94629),w=e.i(152990),S=e.i(682830),b=e.i(389083),v=e.i(994388),j=e.i(752978),_=e.i(269200),C=e.i(942232),k=e.i(977572),N=e.i(427612),z=e.i(64848),I=e.i(496020),O=e.i(599724),D=e.i(827252),T=e.i(282786),E=e.i(981339),P=e.i(592968),R=e.i(355619),M=e.i(633627),A=e.i(374009),K=e.i(700514),L=e.i(135214),U=e.i(50882),$=e.i(969550),B=e.i(20147);function F({teams:e,organizations:s,onSortChange:i,currentSort:a}){let[l,n]=(0,o.useState)(null),[r,c]=o.default.useState(()=>a?[{id:a.sortBy,desc:"desc"===a.sortOrder}]:[{id:"created_at",desc:!0}]),[d,h]=o.default.useState({pageIndex:0,pageSize:50}),F=r.length>0?r[0].id:null,V=r.length>0?r[0].desc?"desc":"asc":null,{data:H,isPending:J,isFetching:W,refetch:q}=(0,m.useKeys)(d.pageIndex+1,d.pageSize,{sortBy:F||void 0,sortOrder:V||void 0}),[Q,G]=(0,o.useState)({}),{filters:Z,filteredKeys:X,filteredTotalCount:Y,allTeams:ee,allOrganizations:et,handleFilterChange:es,handleFilterReset:ei}=function({keys:e,teams:t,organizations:s}){let i={"Team ID":"","Organization ID":"","Key Alias":"","User ID":"","Sort By":"created_at","Sort Order":"desc"},{accessToken:a}=(0,L.default)(),[l,n]=(0,o.useState)(i),[r,c]=(0,o.useState)(t||[]),[d,h]=(0,o.useState)(s||[]),[m,g]=(0,o.useState)(e),[p,x]=(0,o.useState)(null),f=(0,o.useRef)(0),y=(0,o.useCallback)((0,A.default)(async e=>{if(!a)return;let t=Date.now();f.current=t;try{let s=await (0,u.keyListCall)(a,e["Organization ID"]||null,e["Team ID"]||null,e["Key Alias"]||null,e["User ID"]||null,e["Key Hash"]||null,1,K.defaultPageSize,e["Sort By"]||null,e["Sort Order"]||null);t===f.current&&s&&(g(s.keys),x(s.total_count??null),console.log("called from debouncedSearch filters:",JSON.stringify(e)),console.log("called from debouncedSearch data:",JSON.stringify(s)))}catch(e){console.error("Error searching users:",e)}},300),[a]);return(0,o.useEffect)(()=>{if(!e)return void g([]);let t=[...e];l["Team ID"]&&(t=t.filter(e=>e.team_id===l["Team ID"])),l["Organization ID"]&&(t=t.filter(e=>e.organization_id===l["Organization ID"])),g(t)},[e,l]),(0,o.useEffect)(()=>{let e=async()=>{let e=await (0,M.fetchAllTeams)(a);e.length>0&&c(e);let t=await (0,M.fetchAllOrganizations)(a);t.length>0&&h(t)};a&&e()},[a]),(0,o.useEffect)(()=>{t&&t.length>0&&c(e=>e.length<t.length?t:e)},[t]),(0,o.useEffect)(()=>{s&&s.length>0&&h(e=>e.length<s.length?s:e)},[s]),{filters:l,filteredKeys:m,filteredTotalCount:p,allTeams:r,allOrganizations:d,handleFilterChange:(e,t=!1)=>{n({"Team ID":e["Team ID"]||"","Organization ID":e["Organization ID"]||"","Key Alias":e["Key Alias"]||"","User ID":e["User ID"]||"","Sort By":e["Sort By"]||"created_at","Sort Order":e["Sort Order"]||"desc"}),t||y({...l,...e})},handleFilterReset:()=>{n(i),x(null),y(i)}}}({keys:H?.keys||[],teams:e,organizations:s}),ea=Y??H?.total_count??0;(0,o.useEffect)(()=>{if(q){let e=()=>{q()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}},[q]);let el=(0,o.useMemo)(()=>[{id:"expander",header:()=>null,size:40,enableSorting:!1,cell:({row:e})=>e.getCanExpand()?(0,t.jsx)("button",{onClick:e.getToggleExpandedHandler(),style:{cursor:"pointer"},children:e.getIsExpanded()?"â–¼":"â–¶"}):null},{id:"token",accessorKey:"token",header:"Key ID",size:100,enableSorting:!0,cell:e=>{let s=e.getValue(),i=e.cell.column.getSize();return(0,t.jsx)(P.Tooltip,{title:s,children:(0,t.jsx)(v.Button,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate block",style:{maxWidth:i,overflow:"hidden"},onClick:()=>n(e.row.original),children:s??"-"})})}},{id:"key_alias",accessorKey:"key_alias",header:"Key Alias",size:150,enableSorting:!0,cell:e=>{let s=e.getValue(),i=e.cell.column.getSize();return(0,t.jsx)(P.Tooltip,{title:s,children:(0,t.jsx)("span",{className:"font-mono text-xs truncate block",style:{maxWidth:i,overflow:"hidden"},children:s??"-"})})}},{id:"key_name",accessorKey:"key_name",header:"Secret Key",size:120,enableSorting:!1,cell:e=>(0,t.jsx)("span",{className:"font-mono text-xs",children:e.getValue()})},{id:"team_alias",accessorKey:"team_id",header:"Team Alias",size:120,enableSorting:!1,cell:({row:t,getValue:s})=>{let i=s(),a=e?.find(e=>e.team_id===i);return a?.team_alias||"Unknown"}},{id:"team_id",accessorKey:"team_id",header:"Team ID",size:80,enableSorting:!1,cell:e=>{let s=e.getValue(),i=e.cell.column.getSize();return(0,t.jsx)(P.Tooltip,{title:s,children:(0,t.jsx)("span",{className:"font-mono text-xs truncate block",style:{maxWidth:i,overflow:"hidden"},children:s??"-"})})}},{id:"organization_id",accessorKey:"organization_id",header:"Organization ID",size:140,enableSorting:!1,cell:e=>e.getValue()?e.renderValue():"-"},{id:"user_email",accessorKey:"user",header:"User Email",size:160,enableSorting:!1,cell:e=>{let s=e.getValue(),i=s?.user_email,a=e.cell.column.getSize();return(0,t.jsx)(P.Tooltip,{title:i,children:(0,t.jsx)("span",{className:"font-mono text-xs truncate block",style:{maxWidth:a,overflow:"hidden"},children:i??"-"})})}},{id:"user_id",accessorKey:"user_id",header:"User ID",size:70,enableSorting:!1,cell:e=>{let s=e.getValue(),i="default_user_id"===s?"Default Proxy Admin":s,a=e.cell.column.getSize();return(0,t.jsx)(P.Tooltip,{title:i,children:(0,t.jsx)("span",{className:"font-mono text-xs truncate block",style:{maxWidth:a,overflow:"hidden"},children:i??"-"})})}},{id:"created_at",accessorKey:"created_at",header:"Created At",size:120,enableSorting:!0,cell:e=>{let t=e.getValue();return t?new Date(t).toLocaleDateString():"-"}},{id:"created_by",accessorKey:"created_by",header:"Created By",size:70,enableSorting:!1,cell:e=>{let s=e.getValue(),i="default_user_id"===s?"Default Proxy Admin":s,a=e.cell.column.getSize();return(0,t.jsx)(P.Tooltip,{title:i,children:(0,t.jsx)("span",{className:"font-mono text-xs truncate block",style:{maxWidth:a,overflow:"hidden"},children:i??"-"})})}},{id:"updated_at",accessorKey:"updated_at",header:"Updated At",size:120,enableSorting:!0,cell:e=>{let t=e.getValue();return t?new Date(t).toLocaleDateString():"Never"}},{id:"last_active",accessorKey:"last_active",header:()=>(0,t.jsxs)("span",{className:"flex items-center gap-1",children:["Last Active",(0,t.jsx)(T.Popover,{content:"This is a new field and is not backfilled. Only new key usage will update this value.",trigger:"hover",children:(0,t.jsx)(D.InfoCircleOutlined,{className:"text-gray-400 text-xs cursor-help"})})]}),size:130,enableSorting:!1,cell:e=>{let s=e.getValue();if(!s)return"Unknown";let i=new Date(s);return(0,t.jsx)(P.Tooltip,{title:i.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"long"}),children:(0,t.jsx)("span",{children:i.toLocaleDateString()})})}},{id:"expires",accessorKey:"expires",header:"Expires",size:120,enableSorting:!1,cell:e=>{let t=e.getValue();return t?new Date(t).toLocaleDateString():"Never"}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",size:100,enableSorting:!0,cell:e=>(0,g.formatNumberWithCommas)(e.getValue(),4)},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",size:110,enableSorting:!0,cell:e=>{let t=e.getValue();return null===t?"Unlimited":`$${(0,g.formatNumberWithCommas)(t)}`}},{id:"budget_reset_at",accessorKey:"budget_reset_at",header:"Budget Reset",size:130,enableSorting:!1,cell:e=>{let t=e.getValue();return t?new Date(t).toLocaleString():"Never"}},{id:"models",accessorKey:"models",header:"Models",size:200,enableSorting:!1,cell:e=>{let s=e.getValue();return(0,t.jsx)("div",{className:"flex flex-col py-2",children:Array.isArray(s)?(0,t.jsx)("div",{className:"flex flex-col",children:0===s.length?(0,t.jsx)(b.Badge,{size:"xs",className:"mb-1",color:"red",children:(0,t.jsx)(O.Text,{children:"All Proxy Models"})}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex items-start",children:[s.length>3&&(0,t.jsx)("div",{children:(0,t.jsx)(j.Icon,{icon:Q[e.row.id]?p.ChevronDownIcon:x.ChevronRightIcon,className:"cursor-pointer",size:"xs",onClick:()=>{G(t=>({...t,[e.row.id]:!t[e.row.id]}))}})}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[s.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,t.jsx)(b.Badge,{size:"xs",color:"red",children:(0,t.jsx)(O.Text,{children:"All Proxy Models"})},s):(0,t.jsx)(b.Badge,{size:"xs",color:"blue",children:(0,t.jsx)(O.Text,{children:e.length>30?`${(0,R.getModelDisplayName)(e).slice(0,30)}...`:(0,R.getModelDisplayName)(e)})},s)),s.length>3&&!Q[e.row.id]&&(0,t.jsx)(b.Badge,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,t.jsxs)(O.Text,{children:["+",s.length-3," ",s.length-3==1?"more model":"more models"]})}),Q[e.row.id]&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:s.slice(3).map((e,s)=>"all-proxy-models"===e?(0,t.jsx)(b.Badge,{size:"xs",color:"red",children:(0,t.jsx)(O.Text,{children:"All Proxy Models"})},s+3):(0,t.jsx)(b.Badge,{size:"xs",color:"blue",children:(0,t.jsx)(O.Text,{children:e.length>30?`${(0,R.getModelDisplayName)(e).slice(0,30)}...`:(0,R.getModelDisplayName)(e)})},s+3))})]})]})})}):null})}},{id:"rate_limits",header:"Rate Limits",size:140,enableSorting:!1,cell:({row:e})=>{let s=e.original;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:["TPM: ",null!==s.tpm_limit?s.tpm_limit:"Unlimited"]}),(0,t.jsxs)("div",{children:["RPM: ",null!==s.rpm_limit?s.rpm_limit:"Unlimited"]})]})}}],[]),en=[{name:"Team ID",label:"Team ID",isSearchable:!0,searchFn:async e=>ee&&0!==ee.length?ee.filter(t=>t.team_id.toLowerCase().includes(e.toLowerCase())||t.team_alias&&t.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:`${e.team_alias||e.team_id} (${e.team_id})`,value:e.team_id})):[]},{name:"Organization ID",label:"Organization ID",isSearchable:!0,searchFn:async e=>et&&0!==et.length?et.filter(t=>t.organization_id?.toLowerCase().includes(e.toLowerCase())??!1).filter(e=>null!==e.organization_id&&void 0!==e.organization_id).map(e=>({label:`${e.organization_id||"Unknown"} (${e.organization_id})`,value:e.organization_id})):[]},{name:"Key Alias",label:"Key Alias",customComponent:U.PaginatedKeyAliasSelect},{name:"User ID",label:"User ID",isSearchable:!1},{name:"Key Hash",label:"Key Hash",isSearchable:!1}];console.log(`keys: ${JSON.stringify(H)}`);let er=(0,w.useReactTable)({data:X,columns:el.filter(e=>"expander"!==e.id),columnResizeMode:"onChange",columnResizeDirection:"ltr",state:{sorting:r,pagination:d},onSortingChange:e=>{let t="function"==typeof e?e(r):e;if(console.log(`newSorting: ${JSON.stringify(t)}`),c(t),t&&t.length>0){let e=t[0],s=e.id,a=e.desc?"desc":"asc";console.log(`sortBy: ${s}, sortOrder: ${a}`),es({...Z,"Sort By":s,"Sort Order":a},!0),i?.(s,a)}},onPaginationChange:h,getCoreRowModel:(0,S.getCoreRowModel)(),getSortedRowModel:(0,S.getSortedRowModel)(),getPaginationRowModel:(0,S.getPaginationRowModel)(),enableSorting:!0,manualSorting:!1,manualPagination:!0,pageCount:Math.ceil(ea/d.pageSize)});o.default.useEffect(()=>{a&&c([{id:a.sortBy,desc:"desc"===a.sortOrder}])},[a]);let{pageIndex:eo,pageSize:ec}=er.getState().pagination,ed=Math.min((eo+1)*ec,ea),eu=`${eo*ec+1} - ${ed}`;return(0,t.jsx)("div",{className:"w-full h-full overflow-hidden",children:l?(0,t.jsx)(B.default,{keyId:l.token,onClose:()=>n(null),keyData:l,teams:ee,onDelete:q}):(0,t.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,t.jsx)("div",{className:"w-full mb-6",children:(0,t.jsx)($.default,{options:en,onApplyFilters:es,initialValues:Z,onResetFilters:ei})}),(0,t.jsxs)("div",{className:"flex items-center justify-between w-full mb-4",children:[J||W?(0,t.jsx)(E.Skeleton.Node,{active:!0,style:{width:200,height:20}}):(0,t.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",eu," of ",ea," results"]}),(0,t.jsxs)("div",{className:"inline-flex items-center gap-2",children:[J||W?(0,t.jsx)(E.Skeleton.Node,{active:!0,style:{width:74,height:20}}):(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",eo+1," of ",er.getPageCount()]}),J||W?(0,t.jsx)(E.Skeleton.Button,{active:!0,size:"small",style:{width:84,height:30}}):(0,t.jsx)("button",{onClick:()=>er.previousPage(),disabled:J||W||!er.getCanPreviousPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),J||W?(0,t.jsx)(E.Skeleton.Button,{active:!0,size:"small",style:{width:58,height:30}}):(0,t.jsx)("button",{onClick:()=>er.nextPage(),disabled:J||W||!er.getCanNextPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),(0,t.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,t.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(_.Table,{className:"[&_td]:py-0.5 [&_th]:py-1",style:{width:er.getCenterTotalSize()},children:[(0,t.jsx)(N.TableHead,{children:er.getHeaderGroups().map(e=>(0,t.jsx)(I.TableRow,{children:e.headers.map(e=>(0,t.jsx)(z.TableHeaderCell,{"data-header-id":e.id,className:`py-1 h-8 relative hover:bg-gray-50 ${"actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""}`,style:{width:e.getSize(),position:"relative",cursor:e.column.getCanSort()?"pointer":"default"},onMouseEnter:()=>{let t=document.querySelector(`[data-header-id="${e.id}"] .resizer`);t&&(t.style.opacity="0.5")},onMouseLeave:()=>{let t=document.querySelector(`[data-header-id="${e.id}"] .resizer`);t&&!e.column.getIsResizing()&&(t.style.opacity="0")},onClick:e.column.getCanSort()?e.column.getToggleSortingHandler():void 0,children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,w.flexRender)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&e.column.getCanSort()&&(0,t.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,t.jsx)(f.ChevronUpIcon,{className:"h-4 w-4 text-blue-500"}),desc:(0,t.jsx)(p.ChevronDownIcon,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,t.jsx)(y.SwitchVerticalIcon,{className:"h-4 w-4 text-gray-400"})}),(0,t.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:`resizer ${er.options.columnResizeDirection} ${e.column.getIsResizing()?"isResizing":""}`,style:{position:"absolute",right:0,top:0,height:"100%",width:"5px",background:e.column.getIsResizing()?"#3b82f6":"transparent",cursor:"col-resize",userSelect:"none",touchAction:"none",opacity:+!!e.column.getIsResizing()}})]})},e.id))},e.id))}),(0,t.jsx)(C.TableBody,{children:J||W?(0,t.jsx)(I.TableRow,{children:(0,t.jsx)(k.TableCell,{colSpan:el.length,className:"h-8 text-center",children:(0,t.jsx)("div",{className:"text-center text-gray-500",children:(0,t.jsx)("p",{children:"ðŸš… Loading keys..."})})})}):X.length>0?er.getRowModel().rows.map(e=>(0,t.jsx)(I.TableRow,{className:"h-8",children:e.getVisibleCells().map(e=>(0,t.jsx)(k.TableCell,{style:{width:e.column.getSize(),maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:`py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ${"models"===e.column.id&&Array.isArray(e.getValue())&&e.getValue().length>3?"px-0":""}`,children:(0,w.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,t.jsx)(I.TableRow,{children:(0,t.jsx)(k.TableCell,{colSpan:el.length,className:"h-8 text-center",children:(0,t.jsx)("div",{className:"text-center text-gray-500",children:(0,t.jsx)("p",{children:"No keys found"})})})})})]})})})})]})})}e.s(["default",0,({userID:e,userRole:m,teams:g,keys:p,setUserRole:x,userEmail:f,setUserEmail:y,setTeams:w,setKeys:S,premiumUser:b,organizations:v,addKey:j,createClicked:_})=>{let C,[k,N]=(0,o.useState)(null),[z,I]=(0,o.useState)(null),O=(0,r.useSearchParams)(),D=(console.log("COOKIES",document.cookie),(C=document.cookie.split("; ").find(e=>e.startsWith("token=")))?C.split("=")[1]:null),T=O.get("invitation_id"),[E,P]=(0,o.useState)(null),[R,M]=(0,o.useState)(null),[A,K]=(0,o.useState)([]),[L,U]=(0,o.useState)(null),[$,B]=(0,o.useState)(null);if((0,o.useEffect)(()=>{let e=()=>{sessionStorage.clear()};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[]),(0,o.useEffect)(()=>{if(D){let e=(0,n.jwtDecode)(D);if(e){if(console.log("Decoded token:",e),console.log("Decoded key:",e.key),P(e.key),e.user_role){let t=function(e){if(!e)return"Undefined Role";switch(console.log(`Received user role: ${e}`),e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"app_user":return"App User";case"internal_user":return"Internal User";case"internal_user_viewer":return"Internal Viewer";default:return"Unknown Role"}}(e.user_role);console.log("Decoded user_role:",t),x(t)}else console.log("User role not defined");e.user_email?y(e.user_email):console.log(`User Email is not set ${e}`)}}if(e&&E&&m&&!p&&!k){let t=sessionStorage.getItem("userModels"+e);t?K(JSON.parse(t)):(console.log(`currentOrg: ${JSON.stringify(z)}`),(async()=>{try{let t=await (0,u.getProxyUISettings)(E);U(t);let s=await (0,u.userInfoCall)(E,e,m,!1,null,null);N(s.user_info),console.log(`userSpendData: ${JSON.stringify(k)}`),s?.teams[0].keys?S(s.keys.concat(s.teams.filter(t=>"Admin"===m||t.user_id===e).flatMap(e=>e.keys))):S(s.keys),sessionStorage.setItem("userData"+e,JSON.stringify(s.keys)),sessionStorage.setItem("userSpendData"+e,JSON.stringify(s.user_info));let i=(await (0,u.modelAvailableCall)(E,e,m)).data.map(e=>e.id);console.log("available_model_names:",i),K(i),console.log("userModels:",A),sessionStorage.setItem("userModels"+e,JSON.stringify(i))}catch(e){console.error("There was an error fetching the data",e),e.message.includes("Invalid proxy server token passed")&&V()}})(),(0,d.fetchTeams)(E,e,m,z,w))}},[e,D,E,p,m]),(0,o.useEffect)(()=>{E&&(async()=>{try{let e=await (0,u.keyInfoCall)(E,[E]);console.log("keyInfo: ",e)}catch(e){e.message.includes("Invalid proxy server token passed")&&V()}})()},[E]),(0,o.useEffect)(()=>{console.log(`currentOrg: ${JSON.stringify(z)}, accessToken: ${E}, userID: ${e}, userRole: ${m}`),E&&(console.log("fetching teams"),(0,d.fetchTeams)(E,e,m,z,w))},[z]),(0,o.useEffect)(()=>{if(null!==p&&null!=$&&null!==$.team_id){let e=0;for(let t of(console.log(`keys: ${JSON.stringify(p)}`),p))$.hasOwnProperty("team_id")&&null!==t.team_id&&t.team_id===$.team_id&&(e+=t.spend);console.log(`sum: ${e}`),M(e)}else if(null!==p){let e=0;for(let t of p)e+=t.spend;M(e)}},[$]),null!=T)return(0,t.jsx)(c.default,{});function V(){(0,s.clearTokenCookies)();let e=(0,u.getProxyBaseUrl)();console.log("proxyBaseUrl:",e);let t=e?`${e}/sso/key/generate`:"/sso/key/generate";return console.log("Full URL:",t),window.location.href=t,null}if(null==D)return console.log("All cookies before redirect:",document.cookie),V(),null;try{let e=(0,n.jwtDecode)(D);console.log("Decoded token:",e);let t=e.exp,s=Math.floor(Date.now()/1e3);if(t&&s>=t)return console.log("Token expired, redirecting to login"),V(),null}catch(e){return console.error("Error decoding token:",e),(0,s.clearTokenCookies)(),V(),null}if(null==E)return null;if(null==e)return(0,t.jsx)("h1",{children:"User ID is not set"});if(null==m&&x("App Owner"),m&&"Admin Viewer"==m){let{Title:e,Paragraph:s}=l.Typography;return(0,t.jsxs)("div",{children:[(0,t.jsx)(e,{level:1,children:"Access Denied"}),(0,t.jsx)(s,{children:"Ask your proxy admin for access to create keys"})]})}return console.log("inside user dashboard, selected team",$),console.log("All cookies after redirect:",document.cookie),(0,t.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,t.jsx)(a.Grid,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,t.jsxs)(i.Col,{numColSpan:1,className:"flex flex-col gap-2",children:[(0,t.jsx)(h.default,{team:$,teams:g,data:p,addKey:j},$?$.team_id:null),(0,t.jsx)(F,{teams:g,organizations:v})]})})})}],693569)}]);