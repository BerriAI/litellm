(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,921687,e=>{"use strict";var t=e.i(764205);let s=async(e,s)=>{try{let r=s||(0,t.getProxyBaseUrl)(),a=r?`${r}/v1/agents`:"/v1/agents",n=await fetch(a,{method:"GET",headers:{[(0,t.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"}});if(!n.ok){let e=await n.json();throw Error(e.detail||"Failed to fetch agents")}let i=await n.json();return console.log("Fetched agents:",i),i.sort((e,t)=>{let s=e.agent_name||e.agent_id,r=t.agent_name||t.agent_id;return s.localeCompare(r)}),i}catch(e){throw console.error("Error fetching agents:",e),e}},r=async(e,s,r,a)=>{try{let a=await (0,t.modelInfoCall)(e,s,r,1,200),n=a?.data??[],i=(Array.isArray(n)?n:[]).filter(e=>"string"==typeof e?.litellm_params?.model&&e.litellm_params.model.startsWith("litellm_agent/")).map(e=>({model_name:e.model_name??e.model_group??"",litellm_params:{...e.litellm_params,model:e.litellm_params.model,litellm_system_prompt:e.litellm_params?.litellm_system_prompt,tools:Array.isArray(e.litellm_params?.tools)?e.litellm_params.tools:void 0},model_info:e.model_info??null}));return i.sort((e,t)=>e.model_name.localeCompare(t.model_name)),i}catch(e){throw console.error("Error fetching agent models:",e),e}};e.s(["fetchAvailableAgentModels",0,r,"fetchAvailableAgents",0,s])},254530,e=>{"use strict";var t=e.i(356449),s=e.i(764205);async function r(e,r,a,n,i,o,l,c,d,u,m,p,h,f,g,y,x,b,v,w,_,j,S,N){console.log=function(){},console.log("isLocal:",!1);let k=w||(0,s.getProxyBaseUrl)(),E={};i&&i.length>0&&(E["x-litellm-tags"]=i.join(","));let C=new t.default.OpenAI({apiKey:n,baseURL:k,dangerouslyAllowBrowser:!0,defaultHeaders:E});try{let t,s=Date.now(),n=!1,i={},w=!1,k=[];for await(let v of(f&&f.length>0&&(f.includes("__all__")?k.push({type:"mcp",server_label:"litellm",server_url:"litellm_proxy/mcp",require_approval:"never"}):f.forEach(e=>{let t=_?.find(t=>t.server_id===e),s=t?.alias||t?.server_name||e,r=j?.[e]||[];k.push({type:"mcp",server_label:"litellm",server_url:`litellm_proxy/mcp/${s}`,require_approval:"never",...r.length>0?{allowed_tools:r}:{}})})),await C.chat.completions.create({model:a,stream:!0,stream_options:{include_usage:!0},litellm_trace_id:u,messages:e,...m?{vector_store_ids:m}:{},...p?{guardrails:p}:{},...h?{policies:h}:{},...k.length>0?{tools:k,tool_choice:"auto"}:{},...void 0!==x?{temperature:x}:{},...void 0!==b?{max_tokens:b}:{},...N?{mock_testing_fallbacks:!0}:{}},{signal:o}))){console.log("Stream chunk:",v);let e=v.choices[0]?.delta;if(console.log("Delta content:",v.choices[0]?.delta?.content),console.log("Delta reasoning content:",e?.reasoning_content),!n&&(v.choices[0]?.delta?.content||e&&e.reasoning_content)&&(n=!0,t=Date.now()-s,console.log("First token received! Time:",t,"ms"),c?(console.log("Calling onTimingData with:",t),c(t)):console.log("onTimingData callback is not defined!")),v.choices[0]?.delta?.content){let e=v.choices[0].delta.content;r(e,v.model)}if(e&&e.image&&g&&(console.log("Image generated:",e.image),g(e.image.url,v.model)),e&&e.reasoning_content){let t=e.reasoning_content;l&&l(t)}if(e&&e.provider_specific_fields?.search_results&&y&&(console.log("Search results found:",e.provider_specific_fields.search_results),y(e.provider_specific_fields.search_results)),e&&e.provider_specific_fields){let t=e.provider_specific_fields;if(t.mcp_list_tools&&!i.mcp_list_tools&&(i.mcp_list_tools=t.mcp_list_tools,S&&!w)){w=!0;let e={type:"response.output_item.done",item_id:"mcp_list_tools",item:{type:"mcp_list_tools",tools:t.mcp_list_tools.map(e=>({name:e.function?.name||e.name||"",description:e.function?.description||e.description||"",input_schema:e.function?.parameters||e.input_schema||{}}))},timestamp:Date.now()};S(e),console.log("MCP list_tools event sent:",e)}t.mcp_tool_calls&&(i.mcp_tool_calls=t.mcp_tool_calls),t.mcp_call_results&&(i.mcp_call_results=t.mcp_call_results),(t.mcp_list_tools||t.mcp_tool_calls||t.mcp_call_results)&&console.log("MCP metadata found in chunk:",{mcp_list_tools:t.mcp_list_tools?"present":"absent",mcp_tool_calls:t.mcp_tool_calls?"present":"absent",mcp_call_results:t.mcp_call_results?"present":"absent"})}if(v.usage&&d){console.log("Usage data found:",v.usage);let e={completionTokens:v.usage.completion_tokens,promptTokens:v.usage.prompt_tokens,totalTokens:v.usage.total_tokens};v.usage.completion_tokens_details?.reasoning_tokens&&(e.reasoningTokens=v.usage.completion_tokens_details.reasoning_tokens),void 0!==v.usage.cost&&null!==v.usage.cost&&(e.cost=parseFloat(v.usage.cost)),d(e)}}S&&(i.mcp_tool_calls||i.mcp_call_results)&&i.mcp_tool_calls&&i.mcp_tool_calls.length>0&&i.mcp_tool_calls.forEach((e,t)=>{let s=e.function?.name||e.name||"",r=e.function?.arguments||e.arguments||"{}",a=i.mcp_call_results?.find(t=>t.tool_call_id===e.id||t.tool_call_id===e.call_id)||i.mcp_call_results?.[t],n={type:"response.output_item.done",item:{type:"mcp_call",name:s,arguments:"string"==typeof r?r:JSON.stringify(r),output:a?.result?"string"==typeof a.result?a.result:JSON.stringify(a.result):void 0},item_id:e.id||e.call_id,timestamp:Date.now()};S(n),console.log("MCP call event sent:",n)});let E=Date.now();v&&v(E-s)}catch(e){throw o?.aborted&&console.log("Chat completion request was cancelled"),e}}e.s(["makeOpenAIChatCompletionRequest",()=>r])},91500,124608,422233,235267,318059,953860,434788,512882,584976,e=>{"use strict";let t,s,r,a;e.i(247167);var n,i,o,l,c,d,u,m,p,h,f,g,y,x,b,v,w,_,j,S,N,k,E,C,T,A,P,O,R,I,M,L,$,U,D,B,q,z,F,W,H,J,G,V,K,X,Y,Q,Z,ee=e.i(931067),et=e.i(271645);let es={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M531.3 574.4l.3-1.4c5.8-23.9 13.1-53.7 7.4-80.7-3.8-21.3-19.5-29.6-32.9-30.2-15.8-.7-29.9 8.3-33.4 21.4-6.6 24-.7 56.8 10.1 98.6-13.6 32.4-35.3 79.5-51.2 107.5-29.6 15.3-69.3 38.9-75.2 68.7-1.2 5.5.2 12.5 3.5 18.8 3.7 7 9.6 12.4 16.5 15 3 1.1 6.6 2 10.8 2 17.6 0 46.1-14.2 84.1-79.4 5.8-1.9 11.8-3.9 17.6-5.9 27.2-9.2 55.4-18.8 80.9-23.1 28.2 15.1 60.3 24.8 82.1 24.8 21.6 0 30.1-12.8 33.3-20.5 5.6-13.5 2.9-30.5-6.2-39.6-13.2-13-45.3-16.4-95.3-10.2-24.6-15-40.7-35.4-52.4-65.8zM421.6 726.3c-13.9 20.2-24.4 30.3-30.1 34.7 6.7-12.3 19.8-25.3 30.1-34.7zm87.6-235.5c5.2 8.9 4.5 35.8.5 49.4-4.9-19.9-5.6-48.1-2.7-51.4.8.1 1.5.7 2.2 2zm-1.6 120.5c10.7 18.5 24.2 34.4 39.1 46.2-21.6 4.9-41.3 13-58.9 20.2-4.2 1.7-8.3 3.4-12.3 5 13.3-24.1 24.4-51.4 32.1-71.4zm155.6 65.5c.1.2.2.5-.4.9h-.2l-.2.3c-.8.5-9 5.3-44.3-8.6 40.6-1.9 45 7.3 45.1 7.4zm191.4-388.2L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-pdf",theme:"outlined"};var er=e.i(9583),ea=et.forwardRef(function(e,t){return et.createElement(er.default,(0,ee.default)({},e,{ref:t,icon:es}))});e.s(["FilePdfOutlined",0,ea],91500);let en={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2zM304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z"}}]},name:"picture",theme:"outlined"};var ei=et.forwardRef(function(e,t){return et.createElement(er.default,(0,ee.default)({},e,{ref:t,icon:en}))});e.s(["PictureOutlined",0,ei],124608);let eo="u">typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),el=new Uint8Array(16),ec=[];for(let e=0;e<256;++e)ec.push((e+256).toString(16).slice(1));let ed=function(e,s,r){if(eo&&!s&&!e)return eo();let a=(e=e||{}).random??e.rng?.()??function(){if(!t){if("u"<typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(el)}();if(a.length<16)throw Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,s){if((r=r||0)<0||r+16>s.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)s[r+e]=a[e];return s}return function(e,t=0){return(ec[e[t+0]]+ec[e[t+1]]+ec[e[t+2]]+ec[e[t+3]]+"-"+ec[e[t+4]]+ec[e[t+5]]+"-"+ec[e[t+6]]+ec[e[t+7]]+"-"+ec[e[t+8]]+ec[e[t+9]]+"-"+ec[e[t+10]]+ec[e[t+11]]+ec[e[t+12]]+ec[e[t+13]]+ec[e[t+14]]+ec[e[t+15]]).toLowerCase()}(a)};e.s(["v4",0,ed],422233);var eu=e.i(843476),em=e.i(808613),ep=e.i(311451),eh=e.i(28651),ef=e.i(199133),eg=e.i(592968),ey=e.i(827252);function ex(e){if(!e)return[];if(Array.isArray(e))return e.map(e=>eb(e)).filter(e=>void 0!==e);let t=eb(e);return void 0!==t?[t]:[]}function eb(e,t){if(!e)return;let s=void 0!==t?t:e.default;if("object"===e.type){let t="object"!=typeof s||null===s||Array.isArray(s)?{}:{...s};return e.properties&&Object.entries(e.properties).forEach(([e,s])=>{t[e]=eb(s,t[e])}),t}if("array"===e.type){if(Array.isArray(s)){let t=e.items;if(!t)return s;if(0===s.length){let e=ex(t);return e.length?e:s}return Array.isArray(t)?s.map((e,s)=>eb(t[s]??t[t.length-1],e)):s.map(e=>eb(t,e))}return void 0!==s?s:ex(e.items)}if(void 0!==s)return s;switch(e.type){case"integer":case"number":return 0;case"boolean":return!1;default:return""}}let ev=e=>{let t=eb(e);if("object"===e.type||"array"===e.type){let s="array"===e.type?[]:{};return JSON.stringify(t??s,null,2)}return t},ew=(0,et.forwardRef)(({tool:e,className:t},s)=>{let[r]=em.Form.useForm(),a=(0,et.useMemo)(()=>"string"==typeof e.inputSchema?{type:"object",properties:{input:{type:"string",description:"Input for this tool"}},required:["input"]}:e.inputSchema,[e.inputSchema]),n=(0,et.useMemo)(()=>a.properties?.params?.type==="object"&&a.properties.params.properties?{type:"object",properties:a.properties.params.properties,required:a.properties.params.required||[]}:a,[a]);return((0,et.useImperativeHandle)(s,()=>({getSubmitValues:async()=>{var e;let t;return e=await r.validateFields(),t={},Object.entries(e).forEach(([e,s])=>{let r=n.properties?.[e];if(r&&null!=s&&""!==s)switch(r.type){case"boolean":t[e]="true"===s||!0===s;break;case"number":case"integer":{let a=Number(s);t[e]=Number.isNaN(a)?s:"integer"===r.type?Math.trunc(a):a;break}case"object":case"array":try{let a="string"==typeof s?JSON.parse(s):s,n="object"===r.type&&null!==a&&"object"==typeof a&&!Array.isArray(a),i="array"===r.type&&Array.isArray(a);"object"===r.type&&n||"array"===r.type&&i?t[e]=a:t[e]=s}catch{t[e]=s}break;case"string":t[e]=String(s);break;default:t[e]=s}else null!=s&&""!==s&&(t[e]=s)}),a.properties?.params?.type==="object"&&a.properties.params.properties?{params:t}:t}})),et.default.useEffect(()=>{if(r.resetFields(),!n.properties)return;let e={};Object.entries(n.properties).forEach(([t,s])=>{e[t]=ev(s)}),r.setFieldsValue(e)},[r,n,e]),"string"==typeof e.inputSchema)?(0,eu.jsx)(em.Form,{form:r,layout:"vertical",className:t,children:(0,eu.jsx)(em.Form.Item,{label:(0,eu.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Input ",(0,eu.jsx)("span",{className:"text-red-500",children:"*"})]}),name:"input",rules:[{required:!0,message:"Please enter input for this tool"}],children:(0,eu.jsx)(ep.Input,{placeholder:"Enter input for this tool"})})}):n.properties?(0,eu.jsx)(em.Form,{form:r,layout:"vertical",className:t,children:Object.entries(n.properties).map(([t,s])=>{let r=ev(s),a=`${e.name}-${t}`;return(0,eu.jsx)(em.Form.Item,{label:(0,eu.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:[t," ",n.required?.includes(t)&&(0,eu.jsx)("span",{className:"text-red-500",children:"*"}),s.description&&(0,eu.jsx)(eg.Tooltip,{title:s.description,children:(0,eu.jsx)(ey.InfoCircleOutlined,{className:"ml-2 text-gray-400 hover:text-gray-600"})})]}),name:t,initialValue:r,rules:[{required:n.required?.includes(t),message:`Please enter ${t}`},..."object"===s.type||"array"===s.type?[{validator:(e,r)=>{if((null==r||""===r)&&!n.required?.includes(t))return Promise.resolve();try{let e="string"==typeof r?JSON.parse(r):r,t="object"===s.type&&null!==e&&"object"==typeof e&&!Array.isArray(e),a="array"===s.type&&Array.isArray(e);if("object"===s.type&&t||"array"===s.type&&a)return Promise.resolve();return Promise.reject(Error("object"===s.type?"Please enter a JSON object":"Please enter a JSON array"))}catch{return Promise.reject(Error("Invalid JSON"))}}}]:[]],children:"string"===s.type&&s.enum?(0,eu.jsx)(ef.Select,{placeholder:`Select ${t}`,allowClear:!n.required?.includes(t),options:s.enum.map(e=>({value:e,label:e}))}):"string"!==s.type||s.enum?"number"===s.type||"integer"===s.type?(0,eu.jsx)(eh.InputNumber,{step:"integer"===s.type?1:void 0,placeholder:s.description||`Enter ${t}`,className:"w-full",style:{width:"100%"}}):"boolean"===s.type?(0,eu.jsx)(ef.Select,{placeholder:`Select ${t}`,allowClear:!n.required?.includes(t),options:[{value:!0,label:"True"},{value:!1,label:"False"}]}):"object"===s.type||"array"===s.type?(0,eu.jsx)(ep.Input.TextArea,{rows:"object"===s.type?4:3,placeholder:s.description||("object"===s.type?`Enter JSON object for ${t}`:`Enter JSON array for ${t}`),spellCheck:!1,className:"font-mono"}):(0,eu.jsx)(ep.Input,{placeholder:s.description||`Enter ${t}`,allowClear:!0}):(0,eu.jsx)(ep.Input,{placeholder:s.description||`Enter ${t}`,allowClear:!0})},a)})}):(0,eu.jsx)(em.Form,{form:r,layout:"vertical",className:t,children:(0,eu.jsx)("div",{className:"py-4 text-center text-sm text-gray-500",children:"No parameters required for this tool."})})});ew.displayName="MCPToolArgumentsForm",e.s(["default",0,ew],235267);var e_=e.i(764205);e.s(["default",0,({onChange:e,value:t,className:s,accessToken:r})=>{let[a,n]=(0,et.useState)([]),[i,o]=(0,et.useState)(!1);return(0,et.useEffect)(()=>{(async()=>{if(r)try{let e=await (0,e_.tagListCall)(r);console.log("List tags response:",e),n(Object.values(e))}catch(e){console.error("Error fetching tags:",e)}finally{o(!1)}})()},[r]),(0,eu.jsx)(ef.Select,{mode:"tags",showSearch:!0,placeholder:"Select or create tags",onChange:e,value:t,loading:i,className:s,options:a.map(e=>({label:e.name,value:e.name,title:e.description||e.name})),optionFilterProp:"label",tokenSeparators:[","],maxTagCount:"responsive",allowClear:!0,style:{width:"100%"}})}],318059);let ej=e=>{if(!e)return;let t={};if(e.id&&(t.taskId=e.id),e.contextId&&(t.contextId=e.contextId),e.status&&(t.status={state:e.status.state,timestamp:e.status.timestamp},e.status.message?.parts)){let s=e.status.message.parts.filter(e=>"text"===e.kind&&e.text).map(e=>e.text).join(" ");s&&(t.status.message=s)}return e.metadata&&"object"==typeof e.metadata&&(t.metadata=e.metadata),Object.keys(t).length>0?t:void 0},eS=async(e,t,s,r,a,n,i,o,l,c)=>{let d=l||(0,e_.getProxyBaseUrl)(),u=d?`${d}/a2a/${e}/message/send`:`/a2a/${e}/message/send`,m={jsonrpc:"2.0",id:ed(),method:"message/send",params:{message:{kind:"message",messageId:ed().replace(/-/g,""),role:"user",parts:[{kind:"text",text:t}]}}};c&&c.length>0&&(m.params.metadata={guardrails:c});let p=performance.now();try{let t=await fetch(u,{method:"POST",headers:{[(0,e_.getGlobalLitellmHeaderName)()]:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(m),signal:a}),l=performance.now()-p;if(n&&n(l),!t.ok){let e=await t.json();throw Error(e.error?.message||e.detail||`HTTP ${t.status}`)}let c=await t.json(),d=performance.now()-p;if(i&&i(d),c.error)throw Error(c.error.message);let h=c.result;if(h){let t="",r=ej(h);if(r&&o&&o(r),h.artifacts&&Array.isArray(h.artifacts)){for(let e of h.artifacts)if(e.parts&&Array.isArray(e.parts))for(let s of e.parts)"text"===s.kind&&s.text&&(t+=s.text)}else if(h.parts&&Array.isArray(h.parts))for(let e of h.parts)"text"===e.kind&&e.text&&(t+=e.text);else if(h.status?.message?.parts)for(let e of h.status.message.parts)"text"===e.kind&&e.text&&(t+=e.text);t?s(t,`a2a_agent/${e}`):(console.warn("Could not extract text from A2A response, showing raw JSON:",h),s(JSON.stringify(h,null,2),`a2a_agent/${e}`))}}catch(e){if(a?.aborted)return void console.log("A2A request was cancelled");throw console.error("A2A send message error:",e),e}},eN=async(e,t,s,r,a,n,i,o,l)=>{let c,d=l||(0,e_.getProxyBaseUrl)(),u=d?`${d}/a2a/${e}`:`/a2a/${e}`,m=ed(),p=ed().replace(/-/g,""),h=performance.now(),f=!1,g="";try{let l=await fetch(u,{method:"POST",headers:{[(0,e_.getGlobalLitellmHeaderName)()]:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:m,method:"message/stream",params:{message:{kind:"message",messageId:p,role:"user",parts:[{kind:"text",text:t}]}}}),signal:a});if(!l.ok){let e=await l.json();throw Error(e.error?.message||e.detail||`HTTP ${l.status}`)}let d=l.body?.getReader();if(!d)throw Error("No response body");let y=new TextDecoder,x="",b=!1;for(;!b;){let t=await d.read();b=t.done;let r=t.value;if(b)break;let a=(x+=y.decode(r,{stream:!0})).split("\n");for(let t of(x=a.pop()||"",a))if(t.trim())try{let r=JSON.parse(t);if(!f){f=!0;let e=performance.now()-h;n&&n(e)}let a=r.result;if(a){let t=ej(a);t&&(c={...c,...t});let r=a.kind;if("artifact-update"===r&&a.artifact){let t=a.artifact;if(t.parts&&Array.isArray(t.parts))for(let r of t.parts)"text"===r.kind&&r.text&&(g+=r.text,s(g,`a2a_agent/${e}`))}else if(a.artifacts&&Array.isArray(a.artifacts)){for(let t of a.artifacts)if(t.parts&&Array.isArray(t.parts))for(let r of t.parts)"text"===r.kind&&r.text&&(g+=r.text,s(g,`a2a_agent/${e}`))}else if("status-update"===r);else if(a.parts&&Array.isArray(a.parts))for(let t of a.parts)"text"===t.kind&&t.text&&(g+=t.text,s(g,`a2a_agent/${e}`))}if(r.error){let e=r.error.message||"Unknown A2A error";throw Error(e)}}catch(e){if(e instanceof Error&&e.message&&!e.message.includes("JSON"))throw e;t.trim().length>0&&console.warn("Failed to parse A2A streaming chunk:",t,e)}}let v=performance.now()-h;i&&i(v),c&&o&&o(c)}catch(e){if(a?.aborted)return void console.log("A2A streaming request was cancelled");throw console.error("A2A stream message error:",e),e}};function ek(e,t,s,r,a){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!a)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,s):a?a.value=s:t.set(e,s),s}function eE(e,t,s,r){if("a"===s&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?r:"a"===s?r.call(e):r?r.value:t.get(e)}e.s(["makeA2ASendMessageRequest",0,eS,"makeA2AStreamMessageRequest",0,eN],953860);let eC=function(){let{crypto:e}=globalThis;if(e?.randomUUID)return eC=e.randomUUID.bind(e),e.randomUUID();let t=new Uint8Array(1),s=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^s()&15>>e/4).toString(16))};function eT(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}let eA=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){let t=Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return Error(JSON.stringify(e))}catch{}}return Error(e)};class eP extends Error{}class eO extends eP{constructor(e,t,s,r){super(`${eO.makeMessage(e,t,s)}`),this.status=e,this.headers=r,this.requestID=r?.get("request-id"),this.error=t}static makeMessage(e,t,s){let r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,s,r){return e&&r?400===e?new eL(e,t,s,r):401===e?new e$(e,t,s,r):403===e?new eU(e,t,s,r):404===e?new eD(e,t,s,r):409===e?new eB(e,t,s,r):422===e?new eq(e,t,s,r):429===e?new ez(e,t,s,r):e>=500?new eF(e,t,s,r):new eO(e,t,s,r):new eI({message:s,cause:eA(t)})}}class eR extends eO{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class eI extends eO{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class eM extends eI{constructor({message:e}={}){super({message:e??"Request timed out."})}}class eL extends eO{}class e$ extends eO{}class eU extends eO{}class eD extends eO{}class eB extends eO{}class eq extends eO{}class ez extends eO{}class eF extends eO{}let eW=/^[a-z][a-z0-9+.-]*:/i;function eH(e){return"object"!=typeof e?{}:e??{}}let eJ=e=>{try{return JSON.parse(e)}catch(e){return}},eG={off:0,error:200,warn:300,info:400,debug:500},eV=(e,t,s)=>{if(e){if(Object.prototype.hasOwnProperty.call(eG,e))return e;eZ(s).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(eG))}`)}};function eK(){}function eX(e,t,s){return!t||eG[e]>eG[s]?eK:t[e].bind(t)}let eY={error:eK,warn:eK,info:eK,debug:eK},eQ=new WeakMap;function eZ(e){let t=e.logger,s=e.logLevel??"off";if(!t)return eY;let r=eQ.get(t);if(r&&r[0]===s)return r[1];let a={error:eX("error",t,s),warn:eX("warn",t,s),info:eX("info",t,s),debug:eX("debug",t,s)};return eQ.set(t,[s,a]),a}let e0=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([e,t])=>[e,"x-api-key"===e.toLowerCase()||"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e),e1="0.54.0",e2=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",e4=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";function e3(...e){let t=globalThis.ReadableStream;if(void 0===t)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function e5(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return e3({start(){},async pull(e){let{done:s,value:r}=await t.next();s?e.close():e.enqueue(r)},async cancel(){await t.return?.()}})}function e6(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function e8(e){if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator])return void await e[Symbol.asyncIterator]().return?.();let t=e.getReader(),s=t.cancel();t.releaseLock(),await s}let e7=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});function e9(e){let t;return(r??(r=(t=new globalThis.TextEncoder).encode.bind(t)))(e)}function te(e){let t;return(a??(a=(t=new globalThis.TextDecoder).decode.bind(t)))(e)}class tt{constructor(){n.set(this,void 0),i.set(this,void 0),ek(this,n,new Uint8Array,"f"),ek(this,i,null,"f")}decode(e){let t;if(null==e)return[];let s=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?e9(e):e;ek(this,n,function(e){let t=0;for(let s of e)t+=s.length;let s=new Uint8Array(t),r=0;for(let t of e)s.set(t,r),r+=t.length;return s}([eE(this,n,"f"),s]),"f");let r=[];for(;null!=(t=function(e,t){for(let s=t??0;s<e.length;s++){if(10===e[s])return{preceding:s,index:s+1,carriage:!1};if(13===e[s])return{preceding:s,index:s+1,carriage:!0}}return null}(eE(this,n,"f"),eE(this,i,"f")));){if(t.carriage&&null==eE(this,i,"f")){ek(this,i,t.index,"f");continue}if(null!=eE(this,i,"f")&&(t.index!==eE(this,i,"f")+1||t.carriage)){r.push(te(eE(this,n,"f").subarray(0,eE(this,i,"f")-1))),ek(this,n,eE(this,n,"f").subarray(eE(this,i,"f")),"f"),ek(this,i,null,"f");continue}let e=null!==eE(this,i,"f")?t.preceding-1:t.preceding,s=te(eE(this,n,"f").subarray(0,e));r.push(s),ek(this,n,eE(this,n,"f").subarray(t.index),"f"),ek(this,i,null,"f")}return r}flush(){return eE(this,n,"f").length?this.decode("\n"):[]}}n=new WeakMap,i=new WeakMap,tt.NEWLINE_CHARS=new Set(["\n","\r"]),tt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class ts{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let s=!1;async function*r(){if(s)throw new eP("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let r=!1;try{for await(let s of tr(e,t)){if("completion"===s.event)try{yield JSON.parse(s.data)}catch(e){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),e}if("message_start"===s.event||"message_delta"===s.event||"message_stop"===s.event||"content_block_start"===s.event||"content_block_delta"===s.event||"content_block_stop"===s.event)try{yield JSON.parse(s.data)}catch(e){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),e}if("ping"!==s.event&&"error"===s.event)throw new eO(void 0,eJ(s.data)??s.data,void 0,e.headers)}r=!0}catch(e){if(eT(e))return;throw e}finally{r||t.abort()}}return new ts(r,t)}static fromReadableStream(e,t){let s=!1;async function*r(){let t=new tt;for await(let s of e6(e))for(let e of t.decode(s))yield e;for(let e of t.flush())yield e}return new ts(async function*(){if(s)throw new eP("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let e=!1;try{for await(let t of r())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(eT(e))return;throw e}finally{e||t.abort()}},t)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],s=this.iterator(),r=r=>({next:()=>{if(0===r.length){let r=s.next();e.push(r),t.push(r)}return r.shift()}});return[new ts(()=>r(e),this.controller),new ts(()=>r(t),this.controller)]}toReadableStream(){let e,t=this;return e3({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:s,done:r}=await e.next();if(r)return t.close();let a=e9(JSON.stringify(s)+"\n");t.enqueue(a)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}async function*tr(e,t){if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new eP("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new eP("Attempted to iterate over a response with no body")}let s=new tn,r=new tt;for await(let t of ta(e6(e.body)))for(let e of r.decode(t)){let t=s.decode(e);t&&(yield t)}for(let e of r.flush()){let t=s.decode(e);t&&(yield t)}}async function*ta(e){let t=new Uint8Array;for await(let s of e){let e;if(null==s)continue;let r=s instanceof ArrayBuffer?new Uint8Array(s):"string"==typeof s?e9(s):s,a=new Uint8Array(t.length+r.length);for(a.set(t),a.set(r,t.length),t=a;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}class tn{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){var t;let s;if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,a,n]=-1!==(s=(t=e).indexOf(":"))?[t.substring(0,s),":",t.substring(s+1)]:[t,"",""];return n.startsWith(" ")&&(n=n.substring(1)),"event"===r?this.event=n:"data"===r&&this.data.push(n),null}}async function ti(e,t){let{response:s,requestLogID:r,retryOfRequestLogID:a,startTime:n}=t,i=await (async()=>{if(t.options.stream)return(eZ(e).debug("response",s.status,s.url,s.headers,s.body),t.options.__streamClass)?t.options.__streamClass.fromSSEResponse(s,t.controller):ts.fromSSEResponse(s,t.controller);if(204===s.status)return null;if(t.options.__binaryResponse)return s;let r=s.headers.get("content-type"),a=r?.split(";")[0]?.trim();return a?.includes("application/json")||a?.endsWith("+json")?to(await s.json(),s):await s.text()})();return eZ(e).debug(`[${r}] response parsed`,e0({retryOfRequestLogID:a,url:s.url,status:s.status,body:i,durationMs:Date.now()-n})),i}function to(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("request-id"),enumerable:!1})}class tl extends Promise{constructor(e,t,s=ti){super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=s,o.set(this,void 0),ek(this,o,e,"f")}_thenUnwrap(e){return new tl(eE(this,o,"f"),this.responsePromise,async(t,s)=>to(e(await this.parseResponse(t,s),s),s.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(eE(this,o,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}o=new WeakMap;class tc{constructor(e,t,s,r){l.set(this,void 0),ek(this,l,e,"f"),this.options=r,this.response=t,this.body=s}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageRequestOptions()}async getNextPage(){let e=this.nextPageRequestOptions();if(!e)throw new eP("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await eE(this,l,"f").requestAPIList(this.constructor,e)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(l=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}class td extends tl{constructor(e,t,s){super(e,t,async(e,t)=>new s(e,t.response,await ti(e,t),t.options))}async *[Symbol.asyncIterator](){for await(let e of(await this))yield e}}class tu extends tc{constructor(e,t,s,r){super(e,t,s,r),this.data=s.data||[],this.has_more=s.has_more||!1,this.first_id=s.first_id||null,this.last_id=s.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){if(this.options.query?.before_id){let e=this.first_id;return e?{...this.options,query:{...eH(this.options.query),before_id:e}}:null}let e=this.last_id;return e?{...this.options,query:{...eH(this.options.query),after_id:e}}:null}}let tm=()=>{if("u"<typeof File){let{process:e}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof e?.versions?.node&&20>parseInt(e.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function tp(e,t,s){return tm(),new File(e,t??"unknown_file",s)}function th(e){return("object"==typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}let tf=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],tg=async(e,t)=>({...e,body:await tx(e.body,t)}),ty=new WeakMap,tx=async(e,t)=>{if(!await function(e){let t="function"==typeof e?e:e.fetch,s=ty.get(t);if(s)return s;let r=(async()=>{try{let e="Response"in t?t.Response:(await t("data:,")).constructor,s=new FormData;if(s.toString()===await new e(s).text())return!1;return!0}catch{return!0}})();return ty.set(t,r),r}(t))throw TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let s=new FormData;return await Promise.all(Object.entries(e||{}).map(([e,t])=>tb(s,e,t))),s},tb=async(e,t,s)=>{if(void 0!==s){if(null==s)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof s||"number"==typeof s||"boolean"==typeof s)e.append(t,String(s));else if(s instanceof Response){let r={},a=s.headers.get("Content-Type");a&&(r={type:a}),e.append(t,tp([await s.blob()],th(s),r))}else if(tf(s))e.append(t,tp([await new Response(e5(s)).blob()],th(s)));else{let r;if((r=s)instanceof Blob&&"name"in r)e.append(t,tp([s],th(s),{type:s.type}));else if(Array.isArray(s))await Promise.all(s.map(s=>tb(e,t+"[]",s)));else if("object"==typeof s)await Promise.all(Object.entries(s).map(([s,r])=>tb(e,`${t}[${s}]`,r)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`)}}},tv=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer;async function tw(e,t,s){let r,a;if(tm(),e=await e,t||(t=th(e)),null!=(r=e)&&"object"==typeof r&&"string"==typeof r.name&&"number"==typeof r.lastModified&&tv(r))return e instanceof File&&null==t&&null==s?e:tp([await e.arrayBuffer()],t??e.name,{type:e.type,lastModified:e.lastModified,...s});if(null!=(a=e)&&"object"==typeof a&&"string"==typeof a.url&&"function"==typeof a.blob){let r=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),tp(await t_(r),t,s)}let n=await t_(e);if(!s?.type){let e=n.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(s={...s,type:e})}return tp(n,t,s)}async function t_(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(tv(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(tf(e))for await(let s of e)t.push(...await t_(s));else{let t=e?.constructor?.name;throw Error(`Unexpected data type: ${typeof e}${t?`; constructor: ${t}`:""}${function(e){if("object"!=typeof e||null===e)return"";let t=Object.getOwnPropertyNames(e);return`; props: [${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`)}return t}class tj{constructor(e){this._client=e}}let tS=Symbol.for("brand.privateNullableHeaders"),tN=Array.isArray,tk=e=>{let t=new Headers,s=new Set;for(let r of e){let e=new Set;for(let[a,n]of function*(e){let t;if(!e)return;if(tS in e){let{values:t,nulls:s}=e;for(let e of(yield*t.entries(),s))yield[e,null];return}let s=!1;for(let r of(e instanceof Headers?t=e.entries():tN(e)?t=e:(s=!0,t=Object.entries(e??{})),t)){let e=r[0];if("string"!=typeof e)throw TypeError("expected header name to be a string");let t=tN(r[1])?r[1]:[r[1]],a=!1;for(let r of t)void 0!==r&&(s&&!a&&(a=!0,yield[e,null]),yield[e,r])}}(r)){let r=a.toLowerCase();e.has(r)||(t.delete(a),e.add(r)),null===n?(t.delete(a),s.add(r)):(t.append(a,n),s.delete(r))}}return{[tS]:!0,values:t,nulls:s}};function tE(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}let tC=((e=tE)=>function(t,...s){let r;if(1===t.length)return t[0];let a=!1,n=t.reduce((t,r,n)=>(/[?#]/.test(r)&&(a=!0),t+r+(n===s.length?"":(a?encodeURIComponent:e)(String(s[n])))),""),i=n.split(/[?#]/,1)[0],o=[],l=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(r=l.exec(i));)o.push({start:r.index,length:r[0].length});if(o.length>0){let e=0,t=o.reduce((t,s)=>{let r=" ".repeat(s.start-e),a="^".repeat(s.length);return e=s.start+s.length,t+r+a},"");throw new eP(`Path parameters result in path with invalid segments:
${n}
${t}`)}return n})(tE);class tT extends tj{list(e={},t){let{betas:s,...r}=e??{};return this._client.getAPIList("/v1/files",tu,{query:r,...t,headers:tk([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString()},t?.headers])})}delete(e,t={},s){let{betas:r}=t??{};return this._client.delete(tC`/v1/files/${e}`,{...s,headers:tk([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString()},s?.headers])})}download(e,t={},s){let{betas:r}=t??{};return this._client.get(tC`/v1/files/${e}/content`,{...s,headers:tk([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString(),Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}retrieveMetadata(e,t={},s){let{betas:r}=t??{};return this._client.get(tC`/v1/files/${e}`,{...s,headers:tk([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString()},s?.headers])})}upload(e,t){let{betas:s,...r}=e;return this._client.post("/v1/files",tg({body:r,...t,headers:tk([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString()},t?.headers])},this._client))}}class tA extends tj{retrieve(e,t={},s){let{betas:r}=t??{};return this._client.get(tC`/v1/models/${e}?beta=true`,{...s,headers:tk([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},s?.headers])})}list(e={},t){let{betas:s,...r}=e??{};return this._client.getAPIList("/v1/models?beta=true",tu,{query:r,...t,headers:tk([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},t?.headers])})}}class tP{constructor(e,t){this.iterator=e,this.controller=t}async *decoder(){let e=new tt;for await(let t of this.iterator)for(let s of e.decode(t))yield JSON.parse(s);for(let t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new eP("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new eP("Attempted to iterate over a response with no body")}return new tP(e6(e.body),t)}}class tO extends tj{create(e,t){let{betas:s,...r}=e;return this._client.post("/v1/messages/batches?beta=true",{body:r,...t,headers:tk([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},t?.headers])})}retrieve(e,t={},s){let{betas:r}=t??{};return this._client.get(tC`/v1/messages/batches/${e}?beta=true`,{...s,headers:tk([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},s?.headers])})}list(e={},t){let{betas:s,...r}=e??{};return this._client.getAPIList("/v1/messages/batches?beta=true",tu,{query:r,...t,headers:tk([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},t?.headers])})}delete(e,t={},s){let{betas:r}=t??{};return this._client.delete(tC`/v1/messages/batches/${e}?beta=true`,{...s,headers:tk([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},s?.headers])})}cancel(e,t={},s){let{betas:r}=t??{};return this._client.post(tC`/v1/messages/batches/${e}/cancel?beta=true`,{...s,headers:tk([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},s?.headers])})}async results(e,t={},s){let r=await this.retrieve(e);if(!r.results_url)throw new eP(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);let{betas:a}=t??{};return this._client.get(r.results_url,{...s,headers:tk([{"anthropic-beta":[...a??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary"},s?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((e,t)=>tP.fromResponse(t.response,t.controller))}}let tR=e=>{if(0===e.length)return e;let t=e[e.length-1];switch(t.type){case"separator":return tR(e=e.slice(0,e.length-1));case"number":let s=t.value[t.value.length-1];if("."===s||"-"===s)return tR(e=e.slice(0,e.length-1));case"string":let r=e[e.length-2];if(r?.type==="delimiter"||r?.type==="brace"&&"{"===r.value)return tR(e=e.slice(0,e.length-1));break;case"delimiter":return tR(e=e.slice(0,e.length-1))}return e},tI=e=>{var t;let s,r;return JSON.parse((t=tR((e=>{let t=0,s=[];for(;t<e.length;){let r=e[t];if("\\"===r){t++;continue}if("{"===r){s.push({type:"brace",value:"{"}),t++;continue}if("}"===r){s.push({type:"brace",value:"}"}),t++;continue}if("["===r){s.push({type:"paren",value:"["}),t++;continue}if("]"===r){s.push({type:"paren",value:"]"}),t++;continue}if(":"===r){s.push({type:"separator",value:":"}),t++;continue}if(","===r){s.push({type:"delimiter",value:","}),t++;continue}if('"'===r){let a="",n=!1;for(r=e[++t];'"'!==r;){if(t===e.length){n=!0;break}if("\\"===r){if(++t===e.length){n=!0;break}a+=r+e[t],r=e[++t]}else a+=r,r=e[++t]}r=e[++t],n||s.push({type:"string",value:a});continue}let a=/\s/;if(r&&a.test(r)){t++;continue}let n=/[0-9]/;if(r&&n.test(r)||"-"===r||"."===r){let a="";for("-"===r&&(a+=r,r=e[++t]);r&&n.test(r)||"."===r;)a+=r,r=e[++t];s.push({type:"number",value:a});continue}let i=/[a-z]/i;if(r&&i.test(r)){let a="";for(;r&&i.test(r)&&t!==e.length;)a+=r,r=e[++t];"true"==a||"false"==a||"null"===a?s.push({type:"name",value:a}):t++;continue}t++}return s})(e)),s=[],t.map(e=>{"brace"===e.type&&("{"===e.value?s.push("}"):s.splice(s.lastIndexOf("}"),1)),"paren"===e.type&&("["===e.value?s.push("]"):s.splice(s.lastIndexOf("]"),1))}),s.length>0&&s.reverse().map(e=>{"}"===e?t.push({type:"brace",value:"}"}):"]"===e&&t.push({type:"paren",value:"]"})}),r="",t.map(e=>{"string"===e.type?r+='"'+e.value+'"':r+=e.value}),r))},tM="__json_buf";function tL(e){return"tool_use"===e.type||"server_tool_use"===e.type||"mcp_tool_use"===e.type}class t${constructor(){c.add(this),this.messages=[],this.receivedMessages=[],d.set(this,void 0),this.controller=new AbortController,u.set(this,void 0),m.set(this,()=>{}),p.set(this,()=>{}),h.set(this,void 0),f.set(this,()=>{}),g.set(this,()=>{}),y.set(this,{}),x.set(this,!1),b.set(this,!1),v.set(this,!1),w.set(this,!1),_.set(this,void 0),j.set(this,void 0),k.set(this,e=>{if(ek(this,b,!0,"f"),eT(e)&&(e=new eR),e instanceof eR)return ek(this,v,!0,"f"),this._emit("abort",e);if(e instanceof eP)return this._emit("error",e);if(e instanceof Error){let t=new eP(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new eP(String(e)))}),ek(this,u,new Promise((e,t)=>{ek(this,m,e,"f"),ek(this,p,t,"f")}),"f"),ek(this,h,new Promise((e,t)=>{ek(this,f,e,"f"),ek(this,g,t,"f")}),"f"),eE(this,u,"f").catch(()=>{}),eE(this,h,"f").catch(()=>{})}get response(){return eE(this,_,"f")}get request_id(){return eE(this,j,"f")}async withResponse(){let e=await eE(this,u,"f");if(!e)throw Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){let t=new t$;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,s){let r=new t$;for(let e of t.messages)r._addMessageParam(e);return r._run(()=>r._createMessage(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},eE(this,k,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,s){let r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),eE(this,c,"m",E).call(this);let{response:a,data:n}=await e.create({...t,stream:!0},{...s,signal:this.controller.signal}).withResponse();for await(let e of(this._connected(a),n))eE(this,c,"m",C).call(this,e);if(n.controller.signal?.aborted)throw new eR;eE(this,c,"m",T).call(this)}_connected(e){this.ended||(ek(this,_,e,"f"),ek(this,j,e?.headers.get("request-id"),"f"),eE(this,m,"f").call(this,e),this._emit("connect"))}get ended(){return eE(this,x,"f")}get errored(){return eE(this,b,"f")}get aborted(){return eE(this,v,"f")}abort(){this.controller.abort()}on(e,t){return(eE(this,y,"f")[e]||(eE(this,y,"f")[e]=[])).push({listener:t}),this}off(e,t){let s=eE(this,y,"f")[e];if(!s)return this;let r=s.findIndex(e=>e.listener===t);return r>=0&&s.splice(r,1),this}once(e,t){return(eE(this,y,"f")[e]||(eE(this,y,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,s)=>{ek(this,w,!0,"f"),"error"!==e&&this.once("error",s),this.once(e,t)})}async done(){ek(this,w,!0,"f"),await eE(this,h,"f")}get currentMessage(){return eE(this,d,"f")}async finalMessage(){return await this.done(),eE(this,c,"m",S).call(this)}async finalText(){return await this.done(),eE(this,c,"m",N).call(this)}_emit(e,...t){if(eE(this,x,"f"))return;"end"===e&&(ek(this,x,!0,"f"),eE(this,f,"f").call(this));let s=eE(this,y,"f")[e];if(s&&(eE(this,y,"f")[e]=s.filter(e=>!e.once),s.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];eE(this,w,"f")||s?.length||Promise.reject(e),eE(this,p,"f").call(this,e),eE(this,g,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];eE(this,w,"f")||s?.length||Promise.reject(e),eE(this,p,"f").call(this,e),eE(this,g,"f").call(this,e),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",eE(this,c,"m",S).call(this))}async _fromReadableStream(e,t){let s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),eE(this,c,"m",E).call(this),this._connected(null);let r=ts.fromReadableStream(e,this.controller);for await(let e of r)eE(this,c,"m",C).call(this,e);if(r.controller.signal?.aborted)throw new eR;eE(this,c,"m",T).call(this)}[(d=new WeakMap,u=new WeakMap,m=new WeakMap,p=new WeakMap,h=new WeakMap,f=new WeakMap,g=new WeakMap,y=new WeakMap,x=new WeakMap,b=new WeakMap,v=new WeakMap,w=new WeakMap,_=new WeakMap,j=new WeakMap,k=new WeakMap,c=new WeakSet,S=function(){if(0===this.receivedMessages.length)throw new eP("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},N=function(){if(0===this.receivedMessages.length)throw new eP("stream ended without producing a Message with role=assistant");let e=this.receivedMessages.at(-1).content.filter(e=>"text"===e.type).map(e=>e.text);if(0===e.length)throw new eP("stream ended without producing a content block with type=text");return e.join(" ")},E=function(){this.ended||ek(this,d,void 0,"f")},C=function(e){if(this.ended)return;let t=eE(this,c,"m",A).call(this,e);switch(this._emit("streamEvent",e,t),e.type){case"content_block_delta":{let s=t.content.at(-1);switch(e.delta.type){case"text_delta":"text"===s.type&&this._emit("text",e.delta.text,s.text||"");break;case"citations_delta":"text"===s.type&&this._emit("citation",e.delta.citation,s.citations??[]);break;case"input_json_delta":tL(s)&&s.input&&this._emit("inputJson",e.delta.partial_json,s.input);break;case"thinking_delta":"thinking"===s.type&&this._emit("thinking",e.delta.thinking,s.thinking);break;case"signature_delta":"thinking"===s.type&&this._emit("signature",s.signature);break;default:tU(e.delta)}break}case"message_stop":this._addMessageParam(t),this._addMessage(t,!0);break;case"content_block_stop":this._emit("contentBlock",t.content.at(-1));break;case"message_start":ek(this,d,t,"f")}},T=function(){if(this.ended)throw new eP("stream has ended, this shouldn't happen");let e=eE(this,d,"f");if(!e)throw new eP("request ended without sending any chunks");return ek(this,d,void 0,"f"),e},A=function(e){let t=eE(this,d,"f");if("message_start"===e.type){if(t)throw new eP(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!t)throw new eP(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":case"content_block_stop":return t;case"message_delta":return t.container=e.delta.container,t.stop_reason=e.delta.stop_reason,t.stop_sequence=e.delta.stop_sequence,t.usage.output_tokens=e.usage.output_tokens,null!=e.usage.input_tokens&&(t.usage.input_tokens=e.usage.input_tokens),null!=e.usage.cache_creation_input_tokens&&(t.usage.cache_creation_input_tokens=e.usage.cache_creation_input_tokens),null!=e.usage.cache_read_input_tokens&&(t.usage.cache_read_input_tokens=e.usage.cache_read_input_tokens),null!=e.usage.server_tool_use&&(t.usage.server_tool_use=e.usage.server_tool_use),t;case"content_block_start":return t.content.push(e.content_block),t;case"content_block_delta":{let s=t.content.at(e.index);switch(e.delta.type){case"text_delta":s?.type==="text"&&(s.text+=e.delta.text);break;case"citations_delta":s?.type==="text"&&(s.citations??(s.citations=[]),s.citations.push(e.delta.citation));break;case"input_json_delta":if(s&&tL(s)){let t=s[tM]||"";if(Object.defineProperty(s,tM,{value:t+=e.delta.partial_json,enumerable:!1,writable:!0}),t)try{s.input=tI(t)}catch(s){let e=new eP(`Unable to parse tool parameter JSON from model. Please retry your request or adjust your prompt. Error: ${s}. JSON: ${t}`);eE(this,k,"f").call(this,e)}}break;case"thinking_delta":s?.type==="thinking"&&(s.thinking+=e.delta.thinking);break;case"signature_delta":s?.type==="thinking"&&(s.signature=e.delta.signature);break;default:tU(e.delta)}return t}}},Symbol.asyncIterator)](){let e=[],t=[],s=!1;return this.on("streamEvent",s=>{let r=t.shift();r?r.resolve(s):e.push(s)}),this.on("end",()=>{for(let e of(s=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((e,s)=>t.push({resolve:e,reject:s})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ts(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function tU(e){}let tD={"claude-opus-4-20250514":8192,"claude-opus-4-0":8192,"claude-4-opus-20250514":8192,"anthropic.claude-opus-4-20250514-v1:0":8192,"claude-opus-4@20250514":8192},tB={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};class tq extends tj{constructor(){super(...arguments),this.batches=new tO(this._client)}create(e,t){let{betas:s,...r}=e;r.model in tB&&console.warn(`The model '${r.model}' is deprecated and will reach end-of-life on ${tB[r.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let a=this._client._options.timeout;if(!r.stream&&null==a){let e=tD[r.model]??void 0;a=this._client.calculateNonstreamingTimeout(r.max_tokens,e)}return this._client.post("/v1/messages?beta=true",{body:r,timeout:a??6e5,...t,headers:tk([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},t?.headers]),stream:e.stream??!1})}stream(e,t){return t$.createMessage(this,e,t)}countTokens(e,t){let{betas:s,...r}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:r,...t,headers:tk([{"anthropic-beta":[...s??[],"token-counting-2024-11-01"].toString()},t?.headers])})}}tq.Batches=tO;class tz extends tj{constructor(){super(...arguments),this.models=new tA(this._client),this.messages=new tq(this._client),this.files=new tT(this._client)}}tz.Models=tA,tz.Messages=tq,tz.Files=tT;class tF extends tj{create(e,t){let{betas:s,...r}=e;return this._client.post("/v1/complete",{body:r,timeout:this._client._options.timeout??6e5,...t,headers:tk([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},t?.headers]),stream:e.stream??!1})}}let tW="__json_buf";function tH(e){return"tool_use"===e.type||"server_tool_use"===e.type}class tJ{constructor(){P.add(this),this.messages=[],this.receivedMessages=[],O.set(this,void 0),this.controller=new AbortController,R.set(this,void 0),I.set(this,()=>{}),M.set(this,()=>{}),L.set(this,void 0),$.set(this,()=>{}),U.set(this,()=>{}),D.set(this,{}),B.set(this,!1),q.set(this,!1),z.set(this,!1),F.set(this,!1),W.set(this,void 0),H.set(this,void 0),V.set(this,e=>{if(ek(this,q,!0,"f"),eT(e)&&(e=new eR),e instanceof eR)return ek(this,z,!0,"f"),this._emit("abort",e);if(e instanceof eP)return this._emit("error",e);if(e instanceof Error){let t=new eP(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new eP(String(e)))}),ek(this,R,new Promise((e,t)=>{ek(this,I,e,"f"),ek(this,M,t,"f")}),"f"),ek(this,L,new Promise((e,t)=>{ek(this,$,e,"f"),ek(this,U,t,"f")}),"f"),eE(this,R,"f").catch(()=>{}),eE(this,L,"f").catch(()=>{})}get response(){return eE(this,W,"f")}get request_id(){return eE(this,H,"f")}async withResponse(){let e=await eE(this,R,"f");if(!e)throw Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){let t=new tJ;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,s){let r=new tJ;for(let e of t.messages)r._addMessageParam(e);return r._run(()=>r._createMessage(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},eE(this,V,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,s){let r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),eE(this,P,"m",K).call(this);let{response:a,data:n}=await e.create({...t,stream:!0},{...s,signal:this.controller.signal}).withResponse();for await(let e of(this._connected(a),n))eE(this,P,"m",X).call(this,e);if(n.controller.signal?.aborted)throw new eR;eE(this,P,"m",Y).call(this)}_connected(e){this.ended||(ek(this,W,e,"f"),ek(this,H,e?.headers.get("request-id"),"f"),eE(this,I,"f").call(this,e),this._emit("connect"))}get ended(){return eE(this,B,"f")}get errored(){return eE(this,q,"f")}get aborted(){return eE(this,z,"f")}abort(){this.controller.abort()}on(e,t){return(eE(this,D,"f")[e]||(eE(this,D,"f")[e]=[])).push({listener:t}),this}off(e,t){let s=eE(this,D,"f")[e];if(!s)return this;let r=s.findIndex(e=>e.listener===t);return r>=0&&s.splice(r,1),this}once(e,t){return(eE(this,D,"f")[e]||(eE(this,D,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,s)=>{ek(this,F,!0,"f"),"error"!==e&&this.once("error",s),this.once(e,t)})}async done(){ek(this,F,!0,"f"),await eE(this,L,"f")}get currentMessage(){return eE(this,O,"f")}async finalMessage(){return await this.done(),eE(this,P,"m",J).call(this)}async finalText(){return await this.done(),eE(this,P,"m",G).call(this)}_emit(e,...t){if(eE(this,B,"f"))return;"end"===e&&(ek(this,B,!0,"f"),eE(this,$,"f").call(this));let s=eE(this,D,"f")[e];if(s&&(eE(this,D,"f")[e]=s.filter(e=>!e.once),s.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];eE(this,F,"f")||s?.length||Promise.reject(e),eE(this,M,"f").call(this,e),eE(this,U,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];eE(this,F,"f")||s?.length||Promise.reject(e),eE(this,M,"f").call(this,e),eE(this,U,"f").call(this,e),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",eE(this,P,"m",J).call(this))}async _fromReadableStream(e,t){let s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),eE(this,P,"m",K).call(this),this._connected(null);let r=ts.fromReadableStream(e,this.controller);for await(let e of r)eE(this,P,"m",X).call(this,e);if(r.controller.signal?.aborted)throw new eR;eE(this,P,"m",Y).call(this)}[(O=new WeakMap,R=new WeakMap,I=new WeakMap,M=new WeakMap,L=new WeakMap,$=new WeakMap,U=new WeakMap,D=new WeakMap,B=new WeakMap,q=new WeakMap,z=new WeakMap,F=new WeakMap,W=new WeakMap,H=new WeakMap,V=new WeakMap,P=new WeakSet,J=function(){if(0===this.receivedMessages.length)throw new eP("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},G=function(){if(0===this.receivedMessages.length)throw new eP("stream ended without producing a Message with role=assistant");let e=this.receivedMessages.at(-1).content.filter(e=>"text"===e.type).map(e=>e.text);if(0===e.length)throw new eP("stream ended without producing a content block with type=text");return e.join(" ")},K=function(){this.ended||ek(this,O,void 0,"f")},X=function(e){if(this.ended)return;let t=eE(this,P,"m",Q).call(this,e);switch(this._emit("streamEvent",e,t),e.type){case"content_block_delta":{let s=t.content.at(-1);switch(e.delta.type){case"text_delta":"text"===s.type&&this._emit("text",e.delta.text,s.text||"");break;case"citations_delta":"text"===s.type&&this._emit("citation",e.delta.citation,s.citations??[]);break;case"input_json_delta":tH(s)&&s.input&&this._emit("inputJson",e.delta.partial_json,s.input);break;case"thinking_delta":"thinking"===s.type&&this._emit("thinking",e.delta.thinking,s.thinking);break;case"signature_delta":"thinking"===s.type&&this._emit("signature",s.signature);break;default:tG(e.delta)}break}case"message_stop":this._addMessageParam(t),this._addMessage(t,!0);break;case"content_block_stop":this._emit("contentBlock",t.content.at(-1));break;case"message_start":ek(this,O,t,"f")}},Y=function(){if(this.ended)throw new eP("stream has ended, this shouldn't happen");let e=eE(this,O,"f");if(!e)throw new eP("request ended without sending any chunks");return ek(this,O,void 0,"f"),e},Q=function(e){let t=eE(this,O,"f");if("message_start"===e.type){if(t)throw new eP(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!t)throw new eP(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":case"content_block_stop":return t;case"message_delta":return t.stop_reason=e.delta.stop_reason,t.stop_sequence=e.delta.stop_sequence,t.usage.output_tokens=e.usage.output_tokens,null!=e.usage.input_tokens&&(t.usage.input_tokens=e.usage.input_tokens),null!=e.usage.cache_creation_input_tokens&&(t.usage.cache_creation_input_tokens=e.usage.cache_creation_input_tokens),null!=e.usage.cache_read_input_tokens&&(t.usage.cache_read_input_tokens=e.usage.cache_read_input_tokens),null!=e.usage.server_tool_use&&(t.usage.server_tool_use=e.usage.server_tool_use),t;case"content_block_start":return t.content.push(e.content_block),t;case"content_block_delta":{let s=t.content.at(e.index);switch(e.delta.type){case"text_delta":s?.type==="text"&&(s.text+=e.delta.text);break;case"citations_delta":s?.type==="text"&&(s.citations??(s.citations=[]),s.citations.push(e.delta.citation));break;case"input_json_delta":if(s&&tH(s)){let t=s[tW]||"";Object.defineProperty(s,tW,{value:t+=e.delta.partial_json,enumerable:!1,writable:!0}),t&&(s.input=tI(t))}break;case"thinking_delta":s?.type==="thinking"&&(s.thinking+=e.delta.thinking);break;case"signature_delta":s?.type==="thinking"&&(s.signature=e.delta.signature);break;default:tG(e.delta)}return t}}},Symbol.asyncIterator)](){let e=[],t=[],s=!1;return this.on("streamEvent",s=>{let r=t.shift();r?r.resolve(s):e.push(s)}),this.on("end",()=>{for(let e of(s=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((e,s)=>t.push({resolve:e,reject:s})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ts(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function tG(e){}class tV extends tj{create(e,t){return this._client.post("/v1/messages/batches",{body:e,...t})}retrieve(e,t){return this._client.get(tC`/v1/messages/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/v1/messages/batches",tu,{query:e,...t})}delete(e,t){return this._client.delete(tC`/v1/messages/batches/${e}`,t)}cancel(e,t){return this._client.post(tC`/v1/messages/batches/${e}/cancel`,t)}async results(e,t){let s=await this.retrieve(e);if(!s.results_url)throw new eP(`No batch \`results_url\`; Has it finished processing? ${s.processing_status} - ${s.id}`);return this._client.get(s.results_url,{...t,headers:tk([{Accept:"application/binary"},t?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((e,t)=>tP.fromResponse(t.response,t.controller))}}class tK extends tj{constructor(){super(...arguments),this.batches=new tV(this._client)}create(e,t){e.model in tX&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${tX[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let s=this._client._options.timeout;if(!e.stream&&null==s){let t=tD[e.model]??void 0;s=this._client.calculateNonstreamingTimeout(e.max_tokens,t)}return this._client.post("/v1/messages",{body:e,timeout:s??6e5,...t,stream:e.stream??!1})}stream(e,t){return tJ.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}let tX={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};tK.Batches=tV;class tY extends tj{retrieve(e,t={},s){let{betas:r}=t??{};return this._client.get(tC`/v1/models/${e}`,{...s,headers:tk([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},s?.headers])})}list(e={},t){let{betas:s,...r}=e??{};return this._client.getAPIList("/v1/models",tu,{query:r,...t,headers:tk([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},t?.headers])})}}let tQ=e=>void 0!==globalThis.process?globalThis.process.env?.[e]?.trim()??void 0:void 0!==globalThis.Deno?globalThis.Deno.env?.get?.(e)?.trim():void 0;class tZ{constructor({baseURL:e=tQ("ANTHROPIC_BASE_URL"),apiKey:t=tQ("ANTHROPIC_API_KEY")??null,authToken:s=tQ("ANTHROPIC_AUTH_TOKEN")??null,...r}={}){Z.set(this,void 0);const a={apiKey:t,authToken:s,...r,baseURL:e||"https://api.anthropic.com"};if(!a.dangerouslyAllowBrowser&&"u">typeof window&&void 0!==window.document&&"u">typeof navigator)throw new eP("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew Anthropic({ apiKey, dangerouslyAllowBrowser: true });\n");this.baseURL=a.baseURL,this.timeout=a.timeout??t0.DEFAULT_TIMEOUT,this.logger=a.logger??console;const n="warn";this.logLevel=n,this.logLevel=eV(a.logLevel,"ClientOptions.logLevel",this)??eV(tQ("ANTHROPIC_LOG"),"process.env['ANTHROPIC_LOG']",this)??n,this.fetchOptions=a.fetchOptions,this.maxRetries=a.maxRetries??2,this.fetch=a.fetch??function(){if("u">typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),ek(this,Z,e7,"f"),this._options=a,this.apiKey=t,this.authToken=s}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetchOptions:this.fetchOptions,apiKey:this.apiKey,authToken:this.authToken,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(this.apiKey&&e.get("x-api-key")||t.has("x-api-key")||this.authToken&&e.get("authorization"))&&!t.has("authorization"))throw Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){return tk([this.apiKeyAuth(e),this.bearerAuth(e)])}apiKeyAuth(e){if(null!=this.apiKey)return tk([{"X-Api-Key":this.apiKey}])}bearerAuth(e){if(null!=this.authToken)return tk([{Authorization:`Bearer ${this.authToken}`}])}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new eP(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${e1}`}defaultIdempotencyKey(){return`stainless-node-retry-${eC()}`}makeStatusError(e,t,s,r){return eO.generate(e,t,s,r)}buildURL(e,t){let s=new URL(eW.test(e)?e:this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return!function(e){if(!e)return!0;for(let t in e)return!1;return!0}(r)&&(t={...r,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}_calculateNonstreamingTimeout(e){if(3600*e/128e3>600)throw new eP("Streaming is strongly recommended for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details");return 6e5}async prepareOptions(e){}async prepareRequest(e,{url:t,options:s}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,s){return this.request(Promise.resolve(s).then(s=>({method:e,path:t,...s})))}request(e,t=null){return new tl(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,s){let r=await e,a=r.maxRetries??this.maxRetries;null==t&&(t=a),await this.prepareOptions(r);let{req:n,url:i,timeout:o}=this.buildRequest(r,{retryCount:a-t});await this.prepareRequest(n,{url:i,options:r});let l="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),c=void 0===s?"":`, retryOf: ${s}`,d=Date.now();if(eZ(this).debug(`[${l}] sending request`,e0({retryOfRequestLogID:s,method:r.method,url:i,options:r,headers:n.headers})),r.signal?.aborted)throw new eR;let u=new AbortController,m=await this.fetchWithTimeout(i,n,o,u).catch(eA),p=Date.now();if(m instanceof Error){let e=`retrying, ${t} attempts remaining`;if(r.signal?.aborted)throw new eR;let a=eT(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(t)return eZ(this).info(`[${l}] connection ${a?"timed out":"failed"} - ${e}`),eZ(this).debug(`[${l}] connection ${a?"timed out":"failed"} (${e})`,e0({retryOfRequestLogID:s,url:i,durationMs:p-d,message:m.message})),this.retryRequest(r,t,s??l);if(eZ(this).info(`[${l}] connection ${a?"timed out":"failed"} - error; no more retries left`),eZ(this).debug(`[${l}] connection ${a?"timed out":"failed"} (error; no more retries left)`,e0({retryOfRequestLogID:s,url:i,durationMs:p-d,message:m.message})),a)throw new eM;throw new eI({cause:m})}let h=[...m.headers.entries()].filter(([e])=>"request-id"===e).map(([e,t])=>", "+e+": "+JSON.stringify(t)).join(""),f=`[${l}${c}${h}] ${n.method} ${i} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${p-d}ms`;if(!m.ok){let e=this.shouldRetry(m);if(t&&e){let e=`retrying, ${t} attempts remaining`;return await e8(m.body),eZ(this).info(`${f} - ${e}`),eZ(this).debug(`[${l}] response error (${e})`,e0({retryOfRequestLogID:s,url:m.url,status:m.status,headers:m.headers,durationMs:p-d})),this.retryRequest(r,t,s??l,m.headers)}let a=e?"error; no more retries left":"error; not retryable";eZ(this).info(`${f} - ${a}`);let n=await m.text().catch(e=>eA(e).message),i=eJ(n),o=i?void 0:n;throw eZ(this).debug(`[${l}] response error (${a})`,e0({retryOfRequestLogID:s,url:m.url,status:m.status,headers:m.headers,message:o,durationMs:Date.now()-d})),this.makeStatusError(m.status,i,o,m.headers)}return eZ(this).info(f),eZ(this).debug(`[${l}] response start`,e0({retryOfRequestLogID:s,url:m.url,status:m.status,headers:m.headers,durationMs:p-d})),{response:m,options:r,controller:u,requestLogID:l,retryOfRequestLogID:s,startTime:d}}getAPIList(e,t,s){return this.requestAPIList(t,{method:"get",path:e,...s})}requestAPIList(e,t){return new td(this,this.makeRequest(t,null,void 0),e)}async fetchWithTimeout(e,t,s,r){let{signal:a,method:n,...i}=t||{};a&&a.addEventListener("abort",()=>r.abort());let o=setTimeout(()=>r.abort(),s),l=globalThis.ReadableStream&&i.body instanceof globalThis.ReadableStream||"object"==typeof i.body&&null!==i.body&&Symbol.asyncIterator in i.body,c={signal:r.signal,...l?{duplex:"half"}:{},method:"GET",...i};n&&(c.method=n.toUpperCase());try{return await this.fetch.call(void 0,e,c)}finally{clearTimeout(o)}}shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||!!(e.status>=500))}async retryRequest(e,t,s,r){let a,n,i=r?.get("retry-after-ms");if(i){let e=parseFloat(i);Number.isNaN(e)||(a=e)}let o=r?.get("retry-after");if(o&&!a){let e=parseFloat(o);a=Number.isNaN(e)?Date.parse(o)-Date.now():1e3*e}if(!(a&&0<=a&&a<6e4)){let s=e.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,s)}return await (n=a,new Promise(e=>setTimeout(e,n))),this.makeRequest(e,t-1,s)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}calculateNonstreamingTimeout(e,t){if(36e5*e/128e3>6e5||null!=t&&e>t)throw new eP("Streaming is strongly recommended for operations that may token longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details");return 6e5}buildRequest(e,{retryCount:t=0}={}){let s={...e},{method:r,path:a,query:n}=s,i=this.buildURL(a,n);"timeout"in s&&((e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new eP(`${e} must be an integer`);if(t<0)throw new eP(`${e} must be a positive integer`)})("timeout",s.timeout),s.timeout=s.timeout??this.timeout;let{bodyHeaders:o,body:l}=this.buildBody({options:s}),c=this.buildHeaders({options:e,method:r,bodyHeaders:o,retryCount:t});return{req:{method:r,headers:c,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&l instanceof globalThis.ReadableStream&&{duplex:"half"},...l&&{body:l},...this.fetchOptions??{},...s.fetchOptions??{}},url:i,timeout:s.timeout}}buildHeaders({options:e,method:t,bodyHeaders:r,retryCount:a}){let n={};this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),n[this.idempotencyHeader]=e.idempotencyKey);let i=tk([n,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...s??(s=(()=>{let e="u">typeof Deno&&null!=Deno.build?"deno":"u">typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e1,"X-Stainless-OS":e4(Deno.build.os),"X-Stainless-Arch":e2(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("u">typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e1,"X-Stainless-OS":e4(globalThis.process.platform??"unknown"),"X-Stainless-Arch":e2(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let t=function(){if("u"<typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let s=t.exec(navigator.userAgent);if(s){let t=s[1]||0,r=s[2]||0,a=s[3]||0;return{browser:e,version:`${t}.${r}.${a}`}}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01"},this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};let s=tk([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&s.values.has("content-type")||e instanceof Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:"object"==typeof e&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&"function"==typeof e.next)?{bodyHeaders:void 0,body:e5(e)}:eE(this,Z,"f").call(this,{body:e,headers:s})}}Z=new WeakMap,tZ.Anthropic=tZ,tZ.HUMAN_PROMPT="\n\nHuman:",tZ.AI_PROMPT="\n\nAssistant:",tZ.DEFAULT_TIMEOUT=6e5,tZ.AnthropicError=eP,tZ.APIError=eO,tZ.APIConnectionError=eI,tZ.APIConnectionTimeoutError=eM,tZ.APIUserAbortError=eR,tZ.NotFoundError=eD,tZ.ConflictError=eB,tZ.RateLimitError=ez,tZ.BadRequestError=eL,tZ.AuthenticationError=e$,tZ.InternalServerError=eF,tZ.PermissionDeniedError=eU,tZ.UnprocessableEntityError=eq,tZ.toFile=tw;class t0 extends tZ{constructor(){super(...arguments),this.completions=new tF(this),this.messages=new tK(this),this.models=new tY(this),this.beta=new tz(this)}}t0.Completions=tF,t0.Messages=tK,t0.Models=tY,t0.Beta=tz;let{HUMAN_PROMPT:t1,AI_PROMPT:t2}=t0;var t4=e.i(727749);async function t3(e,t,s,r,a=[],n,i,o,l,c,d,u,m,p,h){if(!r)throw Error("Virtual Key is required");console.log=function(){};let f=h||(0,e_.getProxyBaseUrl)(),g={};a&&a.length>0&&(g["x-litellm-tags"]=a.join(","));let y=new t0({apiKey:r,baseURL:f,dangerouslyAllowBrowser:!0,defaultHeaders:g});try{let r=Date.now(),a=!1,p={model:s,messages:e.map(e=>({role:e.role,content:e.content})),stream:!0,max_tokens:1024,litellm_trace_id:c};for await(let e of(d&&(p.vector_store_ids=d),u&&(p.guardrails=u),m&&(p.policies=m),y.messages.stream(p,{signal:n}))){if(console.log("Stream event:",e),"content_block_delta"===e.type){let n=e.delta;if(!a){a=!0;let e=Date.now()-r;console.log("First token received! Time:",e,"ms"),o&&o(e)}"text_delta"===n.type?t("assistant",n.text,s):"reasoning_delta"===n.type&&i&&i(n.text)}if("message_delta"===e.type&&e.usage&&l){let t=e.usage;console.log("Usage data found:",t);let s={completionTokens:t.output_tokens,promptTokens:t.input_tokens,totalTokens:t.input_tokens+t.output_tokens};l(s)}}}catch(e){throw n?.aborted?console.log("Anthropic messages request was cancelled"):t4.default.fromBackend(`Error occurred while generating model response. Please try again. Error: ${e}`),e}}e.s(["makeAnthropicMessagesRequest",()=>t3],434788);var t5=e.i(356449);async function t6(e,t,s,r,a,n,i,o,l,c){console.log=function(){},console.log("isLocal:",!1);let d=c||(0,e_.getProxyBaseUrl)(),u=new t5.default.OpenAI({apiKey:a,baseURL:d,dangerouslyAllowBrowser:!0,defaultHeaders:n&&n.length>0?{"x-litellm-tags":n.join(",")}:void 0});try{let a=await u.audio.speech.create({model:r,input:e,voice:t,...o?{response_format:o}:{},...l?{speed:l}:{}},{signal:i}),n=await a.blob(),c=URL.createObjectURL(n);s(c,r)}catch(e){throw i?.aborted?console.log("Audio speech request was cancelled"):t4.default.fromBackend(`Error occurred while generating speech. Please try again. Error: ${e}`),e}}async function t8(e,t,s,r,a,n,i,o,l,c,d){console.log=function(){},console.log("isLocal:",!1);let u=d||(0,e_.getProxyBaseUrl)(),m=new t5.default.OpenAI({apiKey:r,baseURL:u,dangerouslyAllowBrowser:!0,defaultHeaders:a&&a.length>0?{"x-litellm-tags":a.join(",")}:void 0});try{console.log("Processing audio file for transcription:",e.name);let r=await m.audio.transcriptions.create({model:s,file:e,...i?{language:i}:{},...o?{prompt:o}:{},...l?{response_format:l}:{},...void 0!==c?{temperature:c}:{}},{signal:n});if(console.log("Transcription response:",r),r&&r.text)t(r.text,s),t4.default.success("Audio transcribed successfully");else throw Error("No transcription text in response")}catch(e){if(console.error("Error making audio transcription request:",e),n?.aborted)console.log("Audio transcription request was cancelled");else{let t="Failed to transcribe audio";e?.error?.message?t=e.error.message:e?.message&&(t=e.message),t4.default.fromBackend(`Audio transcription failed: ${t}`)}throw e}}e.s(["makeOpenAIAudioSpeechRequest",()=>t6],512882),e.s(["makeOpenAIAudioTranscriptionRequest",()=>t8],584976)},720762,e=>{"use strict";var t=e.i(727749),s=e.i(764205);async function r(e,r,a,n,i,o){if(!n)throw Error("Virtual Key is required");console.log=function(){};let l=o||(0,s.getProxyBaseUrl)(),c={};i&&i.length>0&&(c["x-litellm-tags"]=i.join(","));try{let t=l.endsWith("/")?l.slice(0,-1):l,i=`${t}/embeddings`,o=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",[(0,s.getGlobalLitellmHeaderName)()]:`Bearer ${n}`,...c},body:JSON.stringify({model:a,input:e})});if(!o.ok){let e=await o.text();throw Error(e||`Request failed with status ${o.status}`)}let d=await o.json(),u=d?.data?.[0]?.embedding;if(!u)throw Error("No embedding returned from server");r(JSON.stringify(u),d?.model??a)}catch(e){throw t.default.fromBackend(`Error occurred while making embeddings request. Please try again. Error: ${e}`),e}}e.s(["makeOpenAIEmbeddingsRequest",()=>r])},488143,(e,t,s)=>{"use strict";function r({widthInt:e,heightInt:t,blurWidth:s,blurHeight:r,blurDataURL:a,objectFit:n}){let i=s?40*s:e,o=r?40*r:t,l=i&&o?`viewBox='0 0 ${i} ${o}'`:"";return`%3Csvg xmlns='http://www.w3.org/2000/svg' ${l}%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='${l?"none":"contain"===n?"xMidYMid":"cover"===n?"xMidYMid slice":"none"}' style='filter: url(%23b);' href='${a}'/%3E%3C/svg%3E`}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"getImageBlurSvg",{enumerable:!0,get:function(){return r}})},987690,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r={VALID_LOADERS:function(){return n},imageConfigDefault:function(){return i}};for(var a in r)Object.defineProperty(s,a,{enumerable:!0,get:r[a]});let n=["default","imgix","cloudinary","akamai","custom"],i={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:14400,formats:["image/webp"],maximumRedirects:3,maximumResponseBody:5e7,dangerouslyAllowLocalIP:!1,dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:[75],unoptimized:!1}},908927,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"getImgProps",{enumerable:!0,get:function(){return c}}),e.r(233525);let r=e.r(543369),a=e.r(488143),n=e.r(987690),i=["-moz-initial","fill","none","scale-down",void 0];function o(e){return void 0!==e.default}function l(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function c({src:e,sizes:t,unoptimized:s=!1,priority:c=!1,preload:d=!1,loading:u,className:m,quality:p,width:h,height:f,fill:g=!1,style:y,overrideSrc:x,onLoad:b,onLoadingComplete:v,placeholder:w="empty",blurDataURL:_,fetchPriority:j,decoding:S="async",layout:N,objectFit:k,objectPosition:E,lazyBoundary:C,lazyRoot:T,...A},P){var O;let R,I,M,{imgConf:L,showAltText:$,blurComplete:U,defaultLoader:D}=P,B=L||n.imageConfigDefault;if("allSizes"in B)R=B;else{let e=[...B.deviceSizes,...B.imageSizes].sort((e,t)=>e-t),t=B.deviceSizes.sort((e,t)=>e-t),s=B.qualities?.sort((e,t)=>e-t);R={...B,allSizes:e,deviceSizes:t,qualities:s}}if(void 0===D)throw Object.defineProperty(Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config"),"__NEXT_ERROR_CODE",{value:"E163",enumerable:!1,configurable:!0});let q=A.loader||D;delete A.loader,delete A.srcSet;let z="__next_img_default"in q;if(z){if("custom"===R.loader)throw Object.defineProperty(Error(`Image with src "${e}" is missing "loader" prop.
Read more: https://nextjs.org/docs/messages/next-image-missing-loader`),"__NEXT_ERROR_CODE",{value:"E252",enumerable:!1,configurable:!0})}else{let e=q;q=t=>{let{config:s,...r}=t;return e(r)}}if(N){"fill"===N&&(g=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[N];e&&(y={...y,...e});let s={responsive:"100vw",fill:"100vw"}[N];s&&!t&&(t=s)}let F="",W=l(h),H=l(f);if((O=e)&&"object"==typeof O&&(o(O)||void 0!==O.src)){let t=o(e)?e.default:e;if(!t.src)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E460",enumerable:!1,configurable:!0});if(!t.height||!t.width)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E48",enumerable:!1,configurable:!0});if(I=t.blurWidth,M=t.blurHeight,_=_||t.blurDataURL,F=t.src,!g)if(W||H){if(W&&!H){let e=W/t.width;H=Math.round(t.height*e)}else if(!W&&H){let e=H/t.height;W=Math.round(t.width*e)}}else W=t.width,H=t.height}let J=!c&&!d&&("lazy"===u||void 0===u);(!(e="string"==typeof e?e:F)||e.startsWith("data:")||e.startsWith("blob:"))&&(s=!0,J=!1),R.unoptimized&&(s=!0),z&&!R.dangerouslyAllowSVG&&e.split("?",1)[0].endsWith(".svg")&&(s=!0);let G=l(p),V=Object.assign(g?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:k,objectPosition:E}:{},$?{}:{color:"transparent"},y),K=U||"empty"===w?null:"blur"===w?`url("data:image/svg+xml;charset=utf-8,${(0,a.getImageBlurSvg)({widthInt:W,heightInt:H,blurWidth:I,blurHeight:M,blurDataURL:_||"",objectFit:V.objectFit})}")`:`url("${w}")`,X=i.includes(V.objectFit)?"fill"===V.objectFit?"100% 100%":"cover":V.objectFit,Y=K?{backgroundSize:X,backgroundPosition:V.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:K}:{},Q=function({config:e,src:t,unoptimized:s,width:a,quality:n,sizes:i,loader:o}){if(s){let e=(0,r.getDeploymentId)();if(t.startsWith("/")&&!t.startsWith("//")&&e){let s=t.includes("?")?"&":"?";t=`${t}${s}dpl=${e}`}return{src:t,srcSet:void 0,sizes:void 0}}let{widths:l,kind:c}=function({deviceSizes:e,allSizes:t},s,r){if(r){let s=/(^|\s)(1?\d?\d)vw/g,a=[];for(let e;e=s.exec(r);)a.push(parseInt(e[2]));if(a.length){let s=.01*Math.min(...a);return{widths:t.filter(t=>t>=e[0]*s),kind:"w"}}return{widths:t,kind:"w"}}return"number"!=typeof s?{widths:e,kind:"w"}:{widths:[...new Set([s,2*s].map(e=>t.find(t=>t>=e)||t[t.length-1]))],kind:"x"}}(e,a,i),d=l.length-1;return{sizes:i||"w"!==c?i:"100vw",srcSet:l.map((s,r)=>`${o({config:e,src:t,quality:n,width:s})} ${"w"===c?s:r+1}${c}`).join(", "),src:o({config:e,src:t,quality:n,width:l[d]})}}({config:R,src:e,unoptimized:s,width:W,quality:G,sizes:t,loader:q}),Z=J?"lazy":u;return{props:{...A,loading:Z,fetchPriority:j,width:W,height:H,decoding:S,className:m,style:{...V,...Y},sizes:Q.sizes,srcSet:Q.srcSet,src:x||Q.src},meta:{unoptimized:s,preload:d||c,placeholder:w,fill:g}}}},898879,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return o}});let r=e.r(271645),a="u"<typeof window,n=a?()=>{}:r.useLayoutEffect,i=a?()=>{}:r.useEffect;function o(e){let{headManager:t,reduceComponentsToState:s}=e;function o(){if(t&&t.mountedInstances){let e=r.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(s(e))}}return a&&(t?.mountedInstances?.add(e.children),o()),n(()=>(t?.mountedInstances?.add(e.children),()=>{t?.mountedInstances?.delete(e.children)})),n(()=>(t&&(t._pendingUpdate=o),()=>{t&&(t._pendingUpdate=o)})),i(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},325633,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r={default:function(){return f},defaultHead:function(){return u}};for(var a in r)Object.defineProperty(s,a,{enumerable:!0,get:r[a]});let n=e.r(563141),i=e.r(151836),o=e.r(843476),l=i._(e.r(271645)),c=n._(e.r(898879)),d=e.r(742732);function u(){return[(0,o.jsx)("meta",{charSet:"utf-8"},"charset"),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")]}function m(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===l.default.Fragment?e.concat(l.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}e.r(233525);let p=["name","httpEquiv","charSet","itemProp"];function h(e){let t,s,r,a;return e.reduce(m,[]).reverse().concat(u().reverse()).filter((t=new Set,s=new Set,r=new Set,a={},e=>{let n=!0,i=!1;if(e.key&&"number"!=typeof e.key&&e.key.indexOf("$")>0){i=!0;let s=e.key.slice(e.key.indexOf("$")+1);t.has(s)?n=!1:t.add(s)}switch(e.type){case"title":case"base":s.has(e.type)?n=!1:s.add(e.type);break;case"meta":for(let t=0,s=p.length;t<s;t++){let s=p[t];if(e.props.hasOwnProperty(s))if("charSet"===s)r.has(s)?n=!1:r.add(s);else{let t=e.props[s],r=a[s]||new Set;("name"!==s||!i)&&r.has(t)?n=!1:(r.add(t),a[s]=r)}}}return n})).reverse().map((e,t)=>{let s=e.key||t;return l.default.cloneElement(e,{key:s})})}let f=function({children:e}){let t=(0,l.useContext)(d.HeadManagerContext);return(0,o.jsx)(c.default,{reduceComponentsToState:h,headManager:t,children:e})};("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},918556,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"ImageConfigContext",{enumerable:!0,get:function(){return n}});let r=e.r(563141)._(e.r(271645)),a=e.r(987690),n=r.default.createContext(a.imageConfigDefault)},65856,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"RouterContext",{enumerable:!0,get:function(){return r}});let r=e.r(563141)._(e.r(271645)).default.createContext(null)},670965,(e,t,s)=>{"use strict";function r(e,t){let s=e||75;return t?.qualities?.length?t.qualities.reduce((e,t)=>Math.abs(t-s)<Math.abs(e-s)?t:e,0):s}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"findClosestQuality",{enumerable:!0,get:function(){return r}})},1948,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return i}});let r=e.r(670965),a=e.r(543369);function n({config:e,src:t,width:s,quality:n}){if(t.startsWith("/")&&t.includes("?")&&e.localPatterns?.length===1&&"**"===e.localPatterns[0].pathname&&""===e.localPatterns[0].search)throw Object.defineProperty(Error(`Image with src "${t}" is using a query string which is not configured in images.localPatterns.
Read more: https://nextjs.org/docs/messages/next-image-unconfigured-localpatterns`),"__NEXT_ERROR_CODE",{value:"E871",enumerable:!1,configurable:!0});let i=(0,r.findClosestQuality)(n,e),o=(0,a.getDeploymentId)();return`${e.path}?url=${encodeURIComponent(t)}&w=${s}&q=${i}${t.startsWith("/")&&o?`&dpl=${o}`:""}`}n.__next_img_default=!0;let i=n},605500,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"Image",{enumerable:!0,get:function(){return v}});let r=e.r(563141),a=e.r(151836),n=e.r(843476),i=a._(e.r(271645)),o=r._(e.r(174080)),l=r._(e.r(325633)),c=e.r(908927),d=e.r(987690),u=e.r(918556);e.r(233525);let m=e.r(65856),p=r._(e.r(1948)),h=e.r(818581),f={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function g(e,t,s,r,a,n,i){let o=e?.src;e&&e["data-loaded-src"]!==o&&(e["data-loaded-src"]=o,("decode"in e?e.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&a(!0),s?.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let r=!1,a=!1;s.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>r,isPropagationStopped:()=>a,persist:()=>{},preventDefault:()=>{r=!0,t.preventDefault()},stopPropagation:()=>{a=!0,t.stopPropagation()}})}r?.current&&r.current(e)}}))}function y(e){return i.use?{fetchPriority:e}:{fetchpriority:e}}"u"<typeof window&&(globalThis.__NEXT_IMAGE_IMPORTED=!0);let x=(0,i.forwardRef)(({src:e,srcSet:t,sizes:s,height:r,width:a,decoding:o,className:l,style:c,fetchPriority:d,placeholder:u,loading:m,unoptimized:p,fill:f,onLoadRef:x,onLoadingCompleteRef:b,setBlurComplete:v,setShowAltText:w,sizesInput:_,onLoad:j,onError:S,...N},k)=>{let E=(0,i.useCallback)(e=>{e&&(S&&(e.src=e.src),e.complete&&g(e,u,x,b,v,p,_))},[e,u,x,b,v,S,p,_]),C=(0,h.useMergedRef)(k,E);return(0,n.jsx)("img",{...N,...y(d),loading:m,width:a,height:r,decoding:o,"data-nimg":f?"fill":"1",className:l,style:c,sizes:s,srcSet:t,src:e,ref:C,onLoad:e=>{g(e.currentTarget,u,x,b,v,p,_)},onError:e=>{w(!0),"empty"!==u&&v(!0),S&&S(e)}})});function b({isAppRouter:e,imgAttributes:t}){let s={as:"image",imageSrcSet:t.srcSet,imageSizes:t.sizes,crossOrigin:t.crossOrigin,referrerPolicy:t.referrerPolicy,...y(t.fetchPriority)};return e&&o.default.preload?(o.default.preload(t.src,s),null):(0,n.jsx)(l.default,{children:(0,n.jsx)("link",{rel:"preload",href:t.srcSet?void 0:t.src,...s},"__nimg-"+t.src+t.srcSet+t.sizes)})}let v=(0,i.forwardRef)((e,t)=>{let s=(0,i.useContext)(m.RouterContext),r=(0,i.useContext)(u.ImageConfigContext),a=(0,i.useMemo)(()=>{let e=f||r||d.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),s=e.deviceSizes.sort((e,t)=>e-t),a=e.qualities?.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:s,qualities:a,localPatterns:"u"<typeof window?r?.localPatterns:e.localPatterns}},[r]),{onLoad:o,onLoadingComplete:l}=e,h=(0,i.useRef)(o);(0,i.useEffect)(()=>{h.current=o},[o]);let g=(0,i.useRef)(l);(0,i.useEffect)(()=>{g.current=l},[l]);let[y,v]=(0,i.useState)(!1),[w,_]=(0,i.useState)(!1),{props:j,meta:S}=(0,c.getImgProps)(e,{defaultLoader:p.default,imgConf:a,blurComplete:y,showAltText:w});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x,{...j,unoptimized:S.unoptimized,placeholder:S.placeholder,fill:S.fill,onLoadRef:h,onLoadingCompleteRef:g,setBlurComplete:v,setShowAltText:_,sizesInput:e.sizes,ref:t}),S.preload?(0,n.jsx)(b,{isAppRouter:!s,imgAttributes:j}):null]})});("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},794909,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r={default:function(){return d},getImageProps:function(){return c}};for(var a in r)Object.defineProperty(s,a,{enumerable:!0,get:r[a]});let n=e.r(563141),i=e.r(908927),o=e.r(605500),l=n._(e.r(1948));function c(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:l.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,s]of Object.entries(t))void 0===s&&delete t[e];return{props:t}}let d=o.Image},657688,(e,t,s)=>{t.exports=e.r(794909)},220486,964421,843153,761793,966988,152401,e=>{"use strict";var t=e.i(843476),s=e.i(218129),r=e.i(132104),a=e.i(447593),n=e.i(245094),i=e.i(210612),o=e.i(955135),l=e.i(91500),c=e.i(827252),d=e.i(438957),u=e.i(596239),m=e.i(56456),p=e.i(124608),h=e.i(983561),f=e.i(602073),g=e.i(313603),y=e.i(782273),x=e.i(232164),b=e.i(366308),v=e.i(771674),w=e.i(304967),_=e.i(599724),j=e.i(779241),S=e.i(629569),N=e.i(994388),k=e.i(464571),E=e.i(311451),C=e.i(212931),T=e.i(282786),A=e.i(199133),P=e.i(482725),O=e.i(592968),R=e.i(898586),I=e.i(515831),M=e.i(271645),L=e.i(918789),$=e.i(650056),U=e.i(219470),D=e.i(422233),B=e.i(122550),q=e.i(891547),z=e.i(921511),F=e.i(235267),W=e.i(727749),H=e.i(764205),J=e.i(318059),G=e.i(916940),V=e.i(953860),K=e.i(434788),X=e.i(512882),Y=e.i(584976),Q=e.i(254530),Z=e.i(720762),ee=e.i(921687),et=e.i(689020);e.i(247167);var es=e.i(356449);async function er(e,t,s,r,a,n,i,o){console.log=function(){},console.log("isLocal:",!1);let l=o||(0,H.getProxyBaseUrl)(),c=new es.default.OpenAI({apiKey:a,baseURL:l,dangerouslyAllowBrowser:!0,defaultHeaders:n&&n.length>0?{"x-litellm-tags":n.join(",")}:void 0});try{let a=Array.isArray(e)?e:[e],n=[];for(let e=0;e<a.length;e++){let o=a[e];console.log(`Processing image ${e+1} of ${a.length}`);let l=await c.images.edit({model:r,image:o,prompt:t},{signal:i});if(console.log(`Response for image ${e+1}:`,l.data),l.data&&l.data[0]){if(l.data[0].url)s(l.data[0].url,r),n.push(l.data[0].url);else if(l.data[0].b64_json){let e=l.data[0].b64_json,t=`data:image/png;base64,${e}`;s(t,r),n.push(t)}}}n.length>1&&W.default.success(`Successfully processed ${n.length} images`)}catch(e){if(console.error("Error making image edit request:",e),i?.aborted)console.log("Image edits request was cancelled");else{let t="Failed to edit image(s)";e?.error?.message?t=e.error.message:e?.message&&(t=e.message),W.default.fromBackend(`Image edit failed: ${t}`)}throw e}}async function ea(e,t,s,r,a,n,i){console.log=function(){},console.log("isLocal:",!1);let o=i||(0,H.getProxyBaseUrl)(),l=new es.default.OpenAI({apiKey:r,baseURL:o,dangerouslyAllowBrowser:!0,defaultHeaders:a&&a.length>0?{"x-litellm-tags":a.join(",")}:void 0});try{let r=await l.images.generate({model:s,prompt:e},{signal:n});if(console.log(r.data),r.data&&r.data[0])if(r.data[0].url)t(r.data[0].url,s);else if(r.data[0].b64_json){let e=r.data[0].b64_json;t(`data:image/png;base64,${e}`,s)}else throw Error("No image data found in response");else throw Error("Invalid response format")}catch(e){throw n?.aborted?console.log("Image generation request was cancelled"):W.default.fromBackend(`Error occurred while generating image. Please try again. Error: ${e}`),e}}async function en(e,t,s,r,a=[],n,i,o,l,c,d,u,m,p,h,f,g,y,x,b,v,w){if(!r)throw Error("Virtual Key is required");if(!s||""===s.trim())throw Error("Model is required. Please select a model before sending a request.");console.log=function(){};let _=b||(0,H.getProxyBaseUrl)(),j={};a&&a.length>0&&(j["x-litellm-tags"]=a.join(","));let S=new es.default.OpenAI({apiKey:r,baseURL:_,dangerouslyAllowBrowser:!0,defaultHeaders:j});try{let r=Date.now(),a=!1,b=e.map(e=>(Array.isArray(e.content),{role:e.role,content:e.content,type:"message"})),_=[];p&&p.length>0&&(p.includes("__all__")?_.push({type:"mcp",server_label:"litellm",server_url:"litellm_proxy/mcp",require_approval:"never"}):p.forEach(e=>{let t=v?.find(t=>t.server_id===e),s=t?.alias||t?.server_name||e,r=w?.[e]||[];_.push({type:"mcp",server_label:"litellm",server_url:`litellm_proxy/mcp/${s}`,require_approval:"never",...r.length>0?{allowed_tools:r}:{}})})),y&&_.push({type:"code_interpreter",container:{type:"auto"}});let j=await S.responses.create({model:s,input:b,stream:!0,litellm_trace_id:c,...h?{previous_response_id:h}:{},...d?{vector_store_ids:d}:{},...u?{guardrails:u}:{},...m?{policies:m}:{},..._.length>0?{tools:_,tool_choice:"auto"}:{}},{signal:n}),E="",C={code:"",containerId:""};for await(let e of j)if(console.log("Response event:",e),"object"==typeof e&&null!==e){if((e.type?.startsWith("response.mcp_")||"response.output_item.done"===e.type&&(e.item?.type==="mcp_list_tools"||e.item?.type==="mcp_call"))&&(console.log("MCP event received:",e),g)){let t={type:e.type,sequence_number:e.sequence_number,output_index:e.output_index,item_id:e.item_id||e.item?.id,item:e.item,delta:e.delta,arguments:e.arguments,timestamp:Date.now()};g(t)}"response.output_item.done"===e.type&&e.item?.type==="mcp_call"&&e.item?.name&&(E=e.item.name,console.log("MCP tool used:",E)),N=C;var N,k=C="response.output_item.done"===e.type&&e.item?.type==="code_interpreter_call"?(console.log("Code interpreter call completed:",e.item),{code:e.item.code||"",containerId:e.item.container_id||""}):N;if("response.output_item.done"===e.type&&e.item?.type==="message"&&e.item?.content&&x){for(let t of e.item.content)if("output_text"===t.type&&t.annotations){let e=t.annotations.filter(e=>"container_file_citation"===e.type);(e.length>0||k.code)&&x({code:k.code,containerId:k.containerId,annotations:e})}}if("response.role.delta"===e.type)continue;if("response.output_text.delta"===e.type&&"string"==typeof e.delta){let n=e.delta;if(console.log("Text delta",n),n.trim().length>0&&(t("assistant",n,s),!a)){a=!0;let e=Date.now()-r;console.log("First token received! Time:",e,"ms"),o&&o(e)}}if("response.reasoning.delta"===e.type&&"delta"in e){let t=e.delta;"string"==typeof t&&i&&i(t)}if("response.completed"===e.type&&"response"in e){let t=e.response,s=t.usage;if(console.log("Usage data:",s),console.log("Response completed event:",t),t.id&&f&&(console.log("Response ID for session management:",t.id),f(t.id)),s&&l){console.log("Usage data:",s);let e={completionTokens:s.output_tokens,promptTokens:s.input_tokens,totalTokens:s.total_tokens};s.completion_tokens_details?.reasoning_tokens&&(e.reasoningTokens=s.completion_tokens_details.reasoning_tokens),l(e,E)}}}return j}catch(e){throw n?.aborted?console.log("Responses API request was cancelled"):W.default.fromBackend(`Error occurred while generating model response. Please try again. Error: ${e}`),e}}var ei=e.i(245704),eo=e.i(637235),el=e.i(270377),ec=e.i(166406),ed=e.i(755151),eu=e.i(240647),em=e.i(993914);let ep=(e,t=8)=>e?e.length>t?`${e.substring(0,t)}`:e:null,eh=e=>{navigator.clipboard.writeText(e)},ef=({a2aMetadata:e,timeToFirstToken:s,totalLatency:r})=>{let[a,n]=(0,M.useState)(!1);if(!e&&!s&&!r)return null;let{taskId:i,contextId:o,status:l,metadata:c}=e||{},d=(e=>{if(!e)return null;try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return e}})(l?.timestamp);return(0,t.jsxs)("div",{className:"a2a-metrics mt-3 pt-2 border-t border-gray-200 text-xs",children:[(0,t.jsxs)("div",{className:"flex items-center mb-2 text-gray-600",children:[(0,t.jsx)(h.RobotOutlined,{className:"mr-1.5 text-blue-500"}),(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"A2A Metadata"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-gray-500 ml-4",children:[l?.state&&(0,t.jsxs)("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${(e=>{switch(e){case"completed":return"bg-green-100 text-green-700";case"working":case"submitted":return"bg-blue-100 text-blue-700";case"failed":case"canceled":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}})(l.state)}`,children:[(e=>{switch(e){case"completed":return(0,t.jsx)(ei.CheckCircleOutlined,{className:"text-green-500"});case"working":case"submitted":return(0,t.jsx)(m.LoadingOutlined,{className:"text-blue-500"});case"failed":case"canceled":return(0,t.jsx)(el.ExclamationCircleOutlined,{className:"text-red-500"});default:return(0,t.jsx)(eo.ClockCircleOutlined,{className:"text-gray-500"})}})(l.state),(0,t.jsx)("span",{className:"ml-1 capitalize",children:l.state})]}),d&&(0,t.jsx)(O.Tooltip,{title:l?.timestamp,children:(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(eo.ClockCircleOutlined,{className:"mr-1"}),d]})}),void 0!==r&&(0,t.jsx)(O.Tooltip,{title:"Total latency",children:(0,t.jsxs)("span",{className:"flex items-center text-blue-600",children:[(0,t.jsx)(eo.ClockCircleOutlined,{className:"mr-1"}),(r/1e3).toFixed(2),"s"]})}),void 0!==s&&(0,t.jsx)(O.Tooltip,{title:"Time to first token",children:(0,t.jsxs)("span",{className:"flex items-center text-green-600",children:["TTFT: ",(s/1e3).toFixed(2),"s"]})})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-gray-500 ml-4 mt-1.5",children:[i&&(0,t.jsx)(O.Tooltip,{title:`Click to copy: ${i}`,children:(0,t.jsxs)("span",{className:"flex items-center cursor-pointer hover:text-gray-700",onClick:()=>eh(i),children:[(0,t.jsx)(em.FileTextOutlined,{className:"mr-1"}),"Task: ",ep(i),(0,t.jsx)(ec.CopyOutlined,{className:"ml-1 text-gray-400 hover:text-gray-600"})]})}),o&&(0,t.jsx)(O.Tooltip,{title:`Click to copy: ${o}`,children:(0,t.jsxs)("span",{className:"flex items-center cursor-pointer hover:text-gray-700",onClick:()=>eh(o),children:[(0,t.jsx)(u.LinkOutlined,{className:"mr-1"}),"Session: ",ep(o),(0,t.jsx)(ec.CopyOutlined,{className:"ml-1 text-gray-400 hover:text-gray-600"})]})}),(c||l?.message)&&(0,t.jsxs)(k.Button,{type:"text",size:"small",className:"text-xs text-blue-500 hover:text-blue-700 p-0 h-auto",onClick:()=>n(!a),children:[a?(0,t.jsx)(ed.DownOutlined,{}):(0,t.jsx)(eu.RightOutlined,{}),(0,t.jsx)("span",{className:"ml-1",children:"Details"})]})]}),a&&(0,t.jsxs)("div",{className:"mt-2 ml-4 p-3 bg-gray-50 rounded-md text-gray-600 border border-gray-200",children:[l?.message&&(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Status Message:"}),(0,t.jsx)("span",{className:"ml-2",children:l.message})]}),i&&(0,t.jsxs)("div",{className:"mb-1.5 flex items-center",children:[(0,t.jsx)("span",{className:"font-medium text-gray-700 w-24",children:"Task ID:"}),(0,t.jsx)("code",{className:"ml-2 px-2 py-1 bg-white border border-gray-200 rounded text-xs font-mono",children:i}),(0,t.jsx)(ec.CopyOutlined,{className:"ml-2 cursor-pointer text-gray-400 hover:text-blue-500",onClick:()=>eh(i)})]}),o&&(0,t.jsxs)("div",{className:"mb-1.5 flex items-center",children:[(0,t.jsx)("span",{className:"font-medium text-gray-700 w-24",children:"Session ID:"}),(0,t.jsx)("code",{className:"ml-2 px-2 py-1 bg-white border border-gray-200 rounded text-xs font-mono",children:o}),(0,t.jsx)(ec.CopyOutlined,{className:"ml-2 cursor-pointer text-gray-400 hover:text-blue-500",onClick:()=>eh(o)})]}),c&&Object.keys(c).length>0&&(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Custom Metadata:"}),(0,t.jsx)("pre",{className:"mt-1.5 p-2 bg-white border border-gray-200 rounded text-xs font-mono overflow-x-auto whitespace-pre-wrap",children:JSON.stringify(c,null,2)})]})]})]})};var eg=e.i(536916),ey=e.i(28651),ex=e.i(850627);let eb=({temperature:e=1,maxTokens:s=2048,useAdvancedParams:r,onTemperatureChange:a,onMaxTokensChange:n,onUseAdvancedParamsChange:i,mockTestFallbacks:o,onMockTestFallbacksChange:l})=>{let[d,u]=(0,M.useState)(!1),m=void 0!==r?r:d,[p,h]=(0,M.useState)(e),[f,g]=(0,M.useState)(s);(0,M.useEffect)(()=>{h(e)},[e]),(0,M.useEffect)(()=>{g(s)},[s]);let y=e=>{let t=e??1;h(t),a?.(t)},x=e=>{let t=e??1e3;g(t),n?.(t)},b=m?"text-gray-700":"text-gray-400";return(0,t.jsxs)("div",{className:"space-y-4 p-4 w-80",children:[(0,t.jsx)(eg.Checkbox,{checked:m,onChange:e=>{var t;return t=e.target.checked,void(i?i(t):u(t))},children:(0,t.jsx)("span",{className:"font-medium",children:"Use Advanced Parameters"})}),l&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(eg.Checkbox,{checked:o??!1,onChange:e=>l(e.target.checked),children:(0,t.jsx)("span",{className:"font-medium",children:"Simulate failure to test fallbacks"})}),(0,t.jsx)(T.Popover,{trigger:"hover",placement:"right",content:(0,t.jsxs)("div",{style:{maxWidth:340},children:[(0,t.jsx)(R.Typography.Paragraph,{className:"text-sm",style:{marginBottom:8},children:"Causes the first request to fail so the router tries fallbacks (if configured). Use this to verify your fallback setup."}),(0,t.jsxs)(R.Typography.Paragraph,{className:"text-sm",style:{marginBottom:0},children:["Behavior can differ when keys, teams, or router settings are configured."," ",(0,t.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/keys_teams_router_settings",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:"Learn more"})]})]}),children:(0,t.jsx)(c.InfoCircleOutlined,{className:"text-xs text-gray-400 cursor-pointer shrink-0 hover:text-gray-600","aria-label":"Help: Simulate failure to test fallbacks"})})]}),(0,t.jsxs)("div",{className:"space-y-4 transition-opacity duration-200",style:{opacity:m?1:.4},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(_.Text,{className:`text-sm ${b}`,children:"Temperature"}),(0,t.jsx)(O.Tooltip,{title:"Controls randomness. Lower values make output more deterministic, higher values more creative.",children:(0,t.jsx)(c.InfoCircleOutlined,{className:`text-xs ${b} cursor-help`})})]}),(0,t.jsx)(ey.InputNumber,{min:0,max:2,step:.1,value:p,onChange:y,disabled:!m,precision:1,className:"w-20"})]}),(0,t.jsx)(ex.Slider,{min:0,max:2,step:.1,value:p,onChange:y,disabled:!m,marks:{0:"0",1:"1.0",2:"2.0"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(_.Text,{className:`text-sm ${b}`,children:"Max Tokens"}),(0,t.jsx)(O.Tooltip,{title:"Maximum number of tokens to generate in the response.",children:(0,t.jsx)(c.InfoCircleOutlined,{className:`text-xs ${b} cursor-help`})})]}),(0,t.jsx)(ey.InputNumber,{min:1,max:32768,step:1,value:f,onChange:x,disabled:!m})]}),(0,t.jsx)(ex.Slider,{min:1,max:32768,step:1,value:f,onChange:x,disabled:!m,marks:{1:"1",32768:"32768"}})]})]})]})},ev=({message:e})=>e.isAudio&&"string"==typeof e.content?(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsx)("audio",{controls:!0,src:e.content,className:"max-w-full",style:{maxWidth:"500px"},children:"Your browser does not support the audio element."})}):null;var ew=e.i(785913);let e_={ALLOY:"Alloy - Professional and confident",ASH:"Ash - Casual and relaxed",BALAD:"Ballad - Smooth and melodic",CORAL:"Coral - Warm and engaging",ECHO:"Echo - Friendly and conversational",FABLE:"Fable - Wise and measured",NOVA:"Nova - Friendly and conversational",ONYX:"Onyx - Deep and authoritative",SAGE:"Sage - Wise and measured",SHIMMER:"Shimmer - Bright and cheerful"},ej=Object.entries({ALLOY:"alloy",ASH:"ash",BALAD:"ballad",CORAL:"coral",ECHO:"echo",FABLE:"fable",NOVA:"nova",ONYX:"onyx",SAGE:"sage",SHIMMER:"shimmer"}).map(([e,t])=>({value:t,label:e_[e]})),eS=[{value:ew.EndpointType.CHAT,label:"/v1/chat/completions"},{value:ew.EndpointType.RESPONSES,label:"/v1/responses"},{value:ew.EndpointType.ANTHROPIC_MESSAGES,label:"/v1/messages"},{value:ew.EndpointType.IMAGE,label:"/v1/images/generations"},{value:ew.EndpointType.IMAGE_EDITS,label:"/v1/images/edits"},{value:ew.EndpointType.EMBEDDINGS,label:"/v1/embeddings"},{value:ew.EndpointType.SPEECH,label:"/v1/audio/speech"},{value:ew.EndpointType.TRANSCRIPTION,label:"/v1/audio/transcriptions"},{value:ew.EndpointType.A2A_AGENTS,label:"/v1/a2a/message/send"},{value:ew.EndpointType.MCP,label:"/mcp-rest/tools/call"},{value:ew.EndpointType.REALTIME,label:"/v1/realtime"}];var eN=e.i(657688);let ek=async(e,t)=>({role:"user",content:[{type:"text",text:e},{type:"image_url",image_url:{url:await new Promise((e,s)=>{let r=new FileReader;r.onload=()=>{e(r.result)},r.onerror=s,r.readAsDataURL(t)})}}]}),eE=(e,t,s,r)=>{let a="";t&&r&&(a=r.toLowerCase().endsWith(".pdf")?"[PDF attached]":"[Image attached]");let n={role:"user",content:t?`${e} ${a}`:e};return t&&s&&(n.imagePreviewUrl=s),n},eC=e=>"user"===e.role&&"string"==typeof e.content&&(e.content.includes("[Image attached]")||e.content.includes("[PDF attached]"))&&!!e.imagePreviewUrl;e.s(["createChatDisplayMessage",0,eE,"createChatMultimodalMessage",0,ek,"shouldShowChatAttachedImage",0,eC],964421);let eT=({message:e})=>{if(!eC(e))return null;let s="string"==typeof e.content&&e.content.includes("[PDF attached]");return(0,t.jsx)("div",{className:"mb-2",children:s?(0,t.jsx)("div",{className:"w-64 h-32 rounded-md border border-gray-200 bg-red-50 flex items-center justify-center",children:(0,t.jsx)(l.FilePdfOutlined,{style:{fontSize:"48px",color:"#dc2626"}})}):(0,t.jsx)(eN.default,{src:e.imagePreviewUrl||"",alt:"User uploaded image",width:256,height:200,className:"max-w-64 rounded-md border border-gray-200 shadow-sm",style:{maxHeight:"200px",width:"auto",height:"auto"}})})};e.s(["default",0,eT],843153);var eA=e.i(955719),eA=eA;let{Dragger:eP}=I.Upload,eO=({chatUploadedImage:e,chatImagePreviewUrl:s,onImageUpload:r,onRemoveImage:a})=>(0,t.jsx)(t.Fragment,{children:!e&&(0,t.jsx)(eP,{beforeUpload:r,accept:"image/*,.pdf",showUploadList:!1,className:"inline-block",style:{padding:0,border:"none",background:"none"},children:(0,t.jsx)(O.Tooltip,{title:"Attach image or PDF",children:(0,t.jsx)("button",{type:"button",className:"flex items-center justify-center w-8 h-8 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors",children:(0,t.jsx)(eA.default,{style:{fontSize:"16px"}})})})})});e.s(["default",0,eO],761793);var eR=e.i(362024),eI=e.i(737434),eM=e.i(931067);let eL={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M553.1 509.1l-77.8 99.2-41.1-52.4a8 8 0 00-12.6 0l-99.8 127.2a7.98 7.98 0 006.3 12.9H696c6.7 0 10.4-7.7 6.3-12.9l-136.5-174a8.1 8.1 0 00-12.7 0zM360 442a40 40 0 1080 0 40 40 0 10-80 0zm494.6-153.4L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-image",theme:"outlined"};var e$=e.i(9583),eU=M.forwardRef(function(e,t){return M.createElement(e$.default,(0,eM.default)({},e,{ref:t,icon:eL}))});let eD=({code:e,containerId:s,annotations:r=[],accessToken:a})=>{let[i,o]=(0,M.useState)({}),[l,c]=(0,M.useState)({}),d=(0,H.getProxyBaseUrl)();(0,M.useEffect)(()=>{let e=async()=>{for(let e of r)if((e.filename?.toLowerCase().endsWith(".png")||e.filename?.toLowerCase().endsWith(".jpg")||e.filename?.toLowerCase().endsWith(".jpeg")||e.filename?.toLowerCase().endsWith(".gif"))&&e.container_id&&e.file_id){c(t=>({...t,[e.file_id]:!0}));try{let t=await fetch(`${d}/v1/containers/${e.container_id}/files/${e.file_id}/content`,{headers:{[(0,H.getGlobalLitellmHeaderName)()]:`Bearer ${a}`}});if(t.ok){let s=await t.blob(),r=URL.createObjectURL(s);o(t=>({...t,[e.file_id]:r}))}}catch(e){console.error("Error fetching image:",e)}finally{c(t=>({...t,[e.file_id]:!1}))}}};return r.length>0&&a&&e(),()=>{Object.values(i).forEach(e=>URL.revokeObjectURL(e))}},[r,a,d]);let u=async e=>{try{let t=await fetch(`${d}/v1/containers/${e.container_id}/files/${e.file_id}/content`,{headers:{[(0,H.getGlobalLitellmHeaderName)()]:`Bearer ${a}`}});if(t.ok){let s=await t.blob(),r=URL.createObjectURL(s),a=document.createElement("a");a.href=r,a.download=e.filename||`file_${e.file_id}`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}}catch(e){console.error("Error downloading file:",e)}},p=r.filter(e=>e.filename?.toLowerCase().endsWith(".png")||e.filename?.toLowerCase().endsWith(".jpg")||e.filename?.toLowerCase().endsWith(".jpeg")||e.filename?.toLowerCase().endsWith(".gif")),h=r.filter(e=>!e.filename?.toLowerCase().endsWith(".png")&&!e.filename?.toLowerCase().endsWith(".jpg")&&!e.filename?.toLowerCase().endsWith(".jpeg")&&!e.filename?.toLowerCase().endsWith(".gif"));return e||0!==r.length?(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[e&&(0,t.jsx)(eR.Collapse,{size:"small",items:[{key:"code",label:(0,t.jsxs)("span",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,t.jsx)(n.CodeOutlined,{})," Python Code Executed"]}),children:(0,t.jsx)($.Prism,{language:"python",style:U.coy,customStyle:{margin:0,borderRadius:"6px",fontSize:"12px",maxHeight:"300px",overflow:"auto"},children:e})}]}),p.map(e=>(0,t.jsx)("div",{className:"rounded-lg border border-gray-200 overflow-hidden",children:l[e.file_id]?(0,t.jsxs)("div",{className:"flex items-center justify-center p-8 bg-gray-50",children:[(0,t.jsx)(P.Spin,{indicator:(0,t.jsx)(m.LoadingOutlined,{spin:!0})}),(0,t.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:"Loading image..."})]}):i[e.file_id]?(0,t.jsxs)("div",{children:[(0,t.jsx)("img",{src:i[e.file_id],alt:e.filename||"Generated chart",className:"max-w-full",style:{maxHeight:"400px"}}),(0,t.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-50 border-t border-gray-200",children:[(0,t.jsxs)("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,t.jsx)(eU,{})," ",e.filename]}),(0,t.jsxs)("button",{onClick:()=>u(e),className:"text-xs text-blue-500 hover:text-blue-700 flex items-center gap-1",children:[(0,t.jsx)(eI.DownloadOutlined,{})," Download"]})]})]}):(0,t.jsx)("div",{className:"flex items-center justify-center p-4 bg-gray-50",children:(0,t.jsx)("span",{className:"text-sm text-gray-400",children:"Image not available"})})},e.file_id)),h.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:h.map(e=>(0,t.jsxs)("button",{onClick:()=>u(e),className:"flex items-center gap-2 px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,t.jsx)(em.FileTextOutlined,{className:"text-blue-500"}),(0,t.jsx)("span",{className:"text-sm",children:e.filename}),(0,t.jsx)(eI.DownloadOutlined,{className:"text-gray-400"})]},e.file_id))})]}):null};var eB=e.i(790848),eq=e.i(998573);let ez=({enabled:e,onEnabledChange:s,selectedModel:r,disabled:a=!1})=>{let i=(e=>{if(!e)return!1;let t=e.toLowerCase();return t.startsWith("openai/")||t.startsWith("gpt-")||t.startsWith("o1")||t.startsWith("o3")||t.includes("openai")})(r);return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3 bg-gradient-to-r from-blue-50 to-purple-50",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n.CodeOutlined,{className:"text-blue-500"}),(0,t.jsx)(_.Text,{className:"font-medium text-gray-700",children:"Code Interpreter"}),(0,t.jsx)(O.Tooltip,{title:"Run Python code to generate files, charts, and analyze data. Container is created automatically.",children:(0,t.jsx)(c.InfoCircleOutlined,{className:"text-gray-400 text-xs"})})]}),(0,t.jsx)(eB.Switch,{checked:e&&i,onChange:e=>{e&&!i?eq.message.warning("Code Interpreter is only available for OpenAI models"):s(e)},disabled:a||!i,size:"small",className:e&&i?"bg-blue-500":""})]}),!i&&(0,t.jsx)("div",{className:"mt-2 pt-2 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(el.ExclamationCircleOutlined,{className:"text-amber-500 mt-0.5"}),(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,t.jsx)("span",{children:"Code Interpreter is currently only supported for OpenAI models. "}),(0,t.jsx)("a",{href:"https://github.com/BerriAI/litellm/issues/new?template=feature_request.yml",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"Request support for other providers"})]})]})})]})};var eF=e.i(190272);let eW=({endpointType:e,onEndpointChange:s,className:r})=>(0,t.jsx)("div",{className:r,children:(0,t.jsx)(A.Select,{showSearch:!0,value:e,style:{width:"100%"},onChange:s,options:eS,className:"rounded-md",filterOption:(e,t)=>(t?.label??"").toLowerCase().includes(e.toLowerCase())||(t?.value??"").toLowerCase().includes(e.toLowerCase())})});var eH=e.i(437902);let{Text:eJ}=R.Typography,{Panel:eG}=eR.Collapse,eV=({events:e,className:s})=>{if(console.log("MCPEventsDisplay: Received events:",e),!e||0===e.length)return console.log("MCPEventsDisplay: No events, returning null"),null;let r=e.find(e=>"response.output_item.done"===e.type&&e.item?.type==="mcp_list_tools"&&e.item.tools&&e.item.tools.length>0),a=e.filter(e=>"response.output_item.done"===e.type&&e.item?.type==="mcp_call");return(console.log("MCPEventsDisplay: toolsEvent:",r),console.log("MCPEventsDisplay: mcpCallEvents:",a),r||0!==a.length)?(0,t.jsxs)("div",{className:`jsx-32b14b04f420f3ac mcp-events-display ${s||""}`,children:[(0,t.jsx)(eH.default,{id:"32b14b04f420f3ac",children:".openai-mcp-tools.jsx-32b14b04f420f3ac{margin:0;padding:0;position:relative}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse.jsx-32b14b04f420f3ac,.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-item.jsx-32b14b04f420f3ac{background:0 0!important;border:none!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-header.jsx-32b14b04f420f3ac{color:#9ca3af!important;background:0 0!important;border:none!important;min-height:20px!important;padding:0 0 0 20px!important;font-size:14px!important;font-weight:400!important;line-height:20px!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-header.jsx-32b14b04f420f3ac:hover{color:#6b7280!important;background:0 0!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-content.jsx-32b14b04f420f3ac{background:0 0!important;border:none!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-content-box.jsx-32b14b04f420f3ac{padding:4px 0 0 20px!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-expand-icon.jsx-32b14b04f420f3ac{color:#9ca3af!important;justify-content:center!important;align-items:center!important;width:16px!important;height:16px!important;font-size:10px!important;display:flex!important;position:absolute!important;top:2px!important;left:2px!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-expand-icon.jsx-32b14b04f420f3ac:hover{color:#6b7280!important}.openai-vertical-line.jsx-32b14b04f420f3ac{opacity:.8;background-color:#f3f4f6;width:.5px;position:absolute;top:18px;bottom:0;left:9px}.tool-item.jsx-32b14b04f420f3ac{color:#4b5563;z-index:1;background:#fff;margin:0;padding:0;font-family:ui-monospace,SFMono-Regular,SF Mono,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:13px;line-height:18px;position:relative}.mcp-section.jsx-32b14b04f420f3ac{z-index:1;background:#fff;margin-bottom:12px;position:relative}.mcp-section.jsx-32b14b04f420f3ac:last-child{margin-bottom:0}.mcp-section-header.jsx-32b14b04f420f3ac{color:#6b7280;margin-bottom:4px;font-size:13px;font-weight:500}.mcp-code-block.jsx-32b14b04f420f3ac{background:#f9fafb;border:1px solid #f3f4f6;border-radius:6px;padding:8px;font-size:12px}.mcp-json.jsx-32b14b04f420f3ac{color:#374151;white-space:pre-wrap;word-wrap:break-word;margin:0;font-family:ui-monospace,SFMono-Regular,SF Mono,Monaco,Consolas,Liberation Mono,Courier New,monospace}.mcp-approved.jsx-32b14b04f420f3ac{color:#6b7280;align-items:center;font-size:13px;display:flex}.mcp-checkmark.jsx-32b14b04f420f3ac{color:#10b981;margin-right:6px;font-weight:700}.mcp-response-content.jsx-32b14b04f420f3ac{color:#374151;white-space:pre-wrap;font-family:ui-monospace,SFMono-Regular,SF Mono,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:13px;line-height:1.5}"}),(0,t.jsxs)("div",{className:"jsx-32b14b04f420f3ac openai-mcp-tools",children:[(0,t.jsx)("div",{className:"jsx-32b14b04f420f3ac openai-vertical-line"}),(0,t.jsxs)(eR.Collapse,{ghost:!0,size:"small",expandIconPosition:"start",defaultActiveKey:r?["list-tools"]:a.map((e,t)=>`mcp-call-${t}`),children:[r&&(0,t.jsx)(eG,{header:"List tools",children:(0,t.jsx)("div",{className:"jsx-32b14b04f420f3ac",children:r.item?.tools?.map((e,s)=>(0,t.jsx)("div",{className:"jsx-32b14b04f420f3ac tool-item",children:e.name},s))})},"list-tools"),a.map((e,s)=>(0,t.jsx)(eG,{header:e.item?.name||"Tool call",children:(0,t.jsxs)("div",{className:"jsx-32b14b04f420f3ac",children:[(0,t.jsxs)("div",{className:"jsx-32b14b04f420f3ac mcp-section",children:[(0,t.jsx)("div",{className:"jsx-32b14b04f420f3ac mcp-section-header",children:"Request"}),(0,t.jsx)("div",{className:"jsx-32b14b04f420f3ac mcp-code-block",children:e.item?.arguments&&(0,t.jsx)("pre",{className:"jsx-32b14b04f420f3ac mcp-json",children:(()=>{try{return JSON.stringify(JSON.parse(e.item.arguments),null,2)}catch(t){return e.item.arguments}})()})})]}),(0,t.jsx)("div",{className:"jsx-32b14b04f420f3ac mcp-section",children:(0,t.jsxs)("div",{className:"jsx-32b14b04f420f3ac mcp-approved",children:[(0,t.jsx)("span",{className:"jsx-32b14b04f420f3ac mcp-checkmark",children:""})," Approved"]})}),e.item?.output&&(0,t.jsxs)("div",{className:"jsx-32b14b04f420f3ac mcp-section",children:[(0,t.jsx)("div",{className:"jsx-32b14b04f420f3ac mcp-section-header",children:"Response"}),(0,t.jsx)("div",{className:"jsx-32b14b04f420f3ac mcp-response-content",children:e.item.output})]})]})},`mcp-call-${s}`))]})]})]}):(console.log("MCPEventsDisplay: No valid events found, returning null"),null)};var eK=e.i(812618);let eX=({reasoningContent:e})=>{let[s,r]=(0,M.useState)(!0);return e?(0,t.jsxs)("div",{className:"reasoning-content mt-1 mb-2",children:[(0,t.jsxs)(k.Button,{type:"text",className:"flex items-center text-xs text-gray-500 hover:text-gray-700",onClick:()=>r(!s),icon:(0,t.jsx)(eK.BulbOutlined,{}),children:[s?"Hide reasoning":"Show reasoning",s?(0,t.jsx)(ed.DownOutlined,{className:"ml-1"}):(0,t.jsx)(eu.RightOutlined,{className:"ml-1"})]}),s&&(0,t.jsx)("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md text-sm text-gray-700",children:(0,t.jsx)(L.default,{components:{code({node:e,inline:s,className:r,children:a,...n}){let i=/language-(\w+)/.exec(r||"");return!s&&i?(0,t.jsx)($.Prism,{style:U.coy,language:i[1],PreTag:"div",className:"rounded-md my-2",...n,children:String(a).replace(/\n$/,"")}):(0,t.jsx)("code",{className:`${r} px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono`,...n,children:a})}},children:e})})]}):null};e.s(["default",0,eX],966988);var eY=e.i(989022);let eQ=async(e,t)=>{let s=await new Promise((e,s)=>{let r=new FileReader;r.onload=()=>{e(r.result.split(",")[1])},r.onerror=s,r.readAsDataURL(t)}),r=t.type||(t.name.toLowerCase().endsWith(".pdf")?"application/pdf":"image/jpeg");return{role:"user",content:[{type:"input_text",text:e},{type:"input_image",image_url:`data:${r};base64,${s}`}]}},eZ=(e,t,s,r)=>{let a="";t&&r&&(a=r.toLowerCase().endsWith(".pdf")?"[PDF attached]":"[Image attached]");let n={role:"user",content:t?`${e} ${a}`:e};return t&&s&&(n.imagePreviewUrl=s),n},e0=({message:e})=>{if(!("user"===e.role&&"string"==typeof e.content&&(e.content.includes("[Image attached]")||e.content.includes("[PDF attached]"))&&e.imagePreviewUrl))return null;let s="string"==typeof e.content&&e.content.includes("[PDF attached]");return(0,t.jsx)("div",{className:"mb-2",children:s?(0,t.jsx)("div",{className:"w-64 h-32 rounded-md border border-gray-200 bg-red-50 flex items-center justify-center",children:(0,t.jsx)(l.FilePdfOutlined,{style:{fontSize:"48px",color:"#dc2626"}})}):(0,t.jsx)("img",{src:e.imagePreviewUrl,alt:"User uploaded image",className:"max-w-64 rounded-md border border-gray-200 shadow-sm",style:{maxHeight:"200px"}})})};var eA=eA;let{Dragger:e1}=I.Upload,e2=({responsesUploadedImage:e,responsesImagePreviewUrl:s,onImageUpload:r,onRemoveImage:a})=>(0,t.jsx)(t.Fragment,{children:!e&&(0,t.jsx)(e1,{beforeUpload:r,accept:"image/*,.pdf",showUploadList:!1,className:"inline-block",style:{padding:0,border:"none",background:"none"},children:(0,t.jsx)(O.Tooltip,{title:"Attach image or PDF",children:(0,t.jsx)("button",{type:"button",className:"flex items-center justify-center w-8 h-8 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors",children:(0,t.jsx)(eA.default,{style:{fontSize:"16px"}})})})})});function e4({searchResults:e}){let[s,r]=(0,M.useState)(!0),[a,n]=(0,M.useState)({});if(!e||0===e.length)return null;let o=e.reduce((e,t)=>e+t.data.length,0);return(0,t.jsxs)("div",{className:"search-results-content mt-1 mb-2",children:[(0,t.jsxs)(k.Button,{type:"text",className:"flex items-center text-xs text-gray-500 hover:text-gray-700",onClick:()=>r(!s),icon:(0,t.jsx)(i.DatabaseOutlined,{}),children:[s?"Hide sources":`Show sources (${o})`,s?(0,t.jsx)(ed.DownOutlined,{className:"ml-1"}):(0,t.jsx)(eu.RightOutlined,{className:"ml-1"})]}),s&&(0,t.jsx)("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md text-sm",children:(0,t.jsx)("div",{className:"space-y-3",children:e.map((e,s)=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-xs text-gray-600 mb-2 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium",children:"Query:"}),(0,t.jsxs)("span",{className:"italic",children:['"',e.search_query,'"']}),(0,t.jsx)("span",{className:"text-gray-400",children:""}),(0,t.jsxs)("span",{className:"text-gray-500",children:[e.data.length," result",1!==e.data.length?"s":""]})]}),(0,t.jsx)("div",{className:"space-y-2",children:e.data.map((e,r)=>{let i=a[`${s}-${r}`]||!1;return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-md overflow-hidden bg-white",children:[(0,t.jsx)("div",{className:"flex items-center justify-between p-2 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>{let e;return e=`${s}-${r}`,void n(t=>({...t,[e]:!t[e]}))},children:(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,t.jsx)("svg",{className:`w-4 h-4 text-gray-400 transition-transform flex-shrink-0 ${i?"transform rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,t.jsx)(em.FileTextOutlined,{className:"text-gray-400 flex-shrink-0",style:{fontSize:"12px"}}),(0,t.jsx)("span",{className:"text-xs font-medium text-gray-700 truncate",children:e.filename||e.file_id||`Result ${r+1}`}),(0,t.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-blue-100 text-blue-700 font-mono flex-shrink-0",children:e.score.toFixed(3)})]})}),i&&(0,t.jsx)("div",{className:"border-t border-gray-200 bg-white",children:(0,t.jsxs)("div",{className:"p-3 space-y-2",children:[e.content.map((e,s)=>(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"text-xs font-mono bg-gray-50 p-2 rounded text-gray-800 whitespace-pre-wrap break-words",children:e.text})},s)),e.attributes&&Object.keys(e.attributes).length>0&&(0,t.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-100",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-1 font-medium",children:"Metadata:"}),(0,t.jsx)("div",{className:"space-y-1",children:Object.entries(e.attributes).map(([e,s])=>(0,t.jsxs)("div",{className:"text-xs flex gap-2",children:[(0,t.jsxs)("span",{className:"text-gray-500 font-medium",children:[e,":"]}),(0,t.jsx)("span",{className:"text-gray-700 font-mono break-all",children:String(s)})]},e))})]})]})})]},r)})})]},s))})})]})}e.s(["SearchResultsDisplay",()=>e4],152401);let e3=({endpointType:e,responsesSessionId:s,useApiSessionManagement:r,onToggleSessionManagement:a})=>e!==ew.EndpointType.RESPONSES?null:(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Session Management"}),(0,t.jsx)(O.Tooltip,{title:"Choose between LiteLLM API session management (using previous_response_id) or UI-based session management (using chat history)",children:(0,t.jsx)(c.InfoCircleOutlined,{className:"text-gray-400",style:{fontSize:"12px"}})})]}),(0,t.jsx)(eB.Switch,{checked:r,onChange:a,checkedChildren:"API",unCheckedChildren:"UI",size:"small"})]}),(0,t.jsxs)("div",{className:`text-xs p-2 rounded-md ${s?"bg-green-50 text-green-700 border border-green-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(c.InfoCircleOutlined,{style:{fontSize:"12px"}}),(()=>{if(!s)return r?"API Session: Ready":"UI Session: Ready";let e=r?"Response ID":"UI Session",t=s.slice(0,10);return`${e}: ${t}...`})()]}),s&&(0,t.jsx)(O.Tooltip,{title:(0,t.jsxs)("div",{className:"text-xs",children:[(0,t.jsx)("div",{className:"mb-1",children:"Copy response ID to continue session:"}),(0,t.jsx)("div",{className:"bg-gray-800 text-gray-100 p-2 rounded font-mono text-xs whitespace-pre-wrap",children:`curl -X POST "your-proxy-url/v1/responses" \\
  -H "Authorization: Bearer your-api-key" \\
  -H "Content-Type: application/json" \\
  -d '{
    "model": "your-model",
    "input": [{"role": "user", "content": "your message", "type": "message"}],
    "previous_response_id": "${s}",
    "stream": true
  }'`})]}),overlayStyle:{maxWidth:"500px"},children:(0,t.jsx)("button",{onClick:()=>{s&&(navigator.clipboard.writeText(s),W.default.success("Response ID copied to clipboard!"))},className:"ml-2 p-1 hover:bg-green-100 rounded transition-colors",children:(0,t.jsx)(ec.CopyOutlined,{style:{fontSize:"12px"}})})})]}),(0,t.jsx)("div",{className:"text-xs opacity-75 mt-1",children:s?r?"LiteLLM API session active - context maintained server-side":"UI session active - context maintained client-side":r?"LiteLLM will manage session using previous_response_id":"UI will manage session using chat history"})]})]});var e5={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M682 455V311l-76 76v68c-.1 50.7-42 92.1-94 92a95.8 95.8 0 01-52-15l-54 55c29.1 22.4 65.9 36 106 36 93.8 0 170-75.1 170-168z"}},{tag:"path",attrs:{d:"M833 446h-60c-4.4 0-8 3.6-8 8 0 140.3-113.7 254-254 254-63 0-120.7-23-165-61l-54 54a334.01 334.01 0 00179 81v102H326c-13.9 0-24.9 14.3-25 32v36c.1 4.4 2.9 8 6 8h408c3.2 0 6-3.6 6-8v-36c0-17.7-11-32-25-32H547V782c165.3-17.9 294-157.9 294-328 0-4.4-3.6-8-8-8zm13.1-377.7l-43.5-41.9a8 8 0 00-11.2.1l-129 129C634.3 101.2 577 64 511 64c-93.9 0-170 75.3-170 168v224c0 6.7.4 13.3 1.2 19.8l-68 68A252.33 252.33 0 01258 454c-.2-4.4-3.8-8-8-8h-60c-4.4 0-8 3.6-8 8 0 53 12.5 103 34.6 147.4l-137 137a8.03 8.03 0 000 11.3l42.7 42.7c3.1 3.1 8.2 3.1 11.3 0L846.2 79.8l.1-.1c3.1-3.2 3-8.3-.2-11.4zM417 401V232c0-50.6 41.9-92 94-92 46 0 84.1 32.3 92.3 74.7L417 401z"}}]},name:"audio-muted",theme:"outlined"},e6=M.forwardRef(function(e,t){return M.createElement(e$.default,(0,eM.default)({},e,{ref:t,icon:e5}))}),e8=e.i(793916),e7=e.i(518617),e9=e.i(84899);let{Text:te}=R.Typography,tt=({accessToken:e,selectedModel:s,customProxyBaseUrl:r,selectedGuardrails:a})=>{let[n,i]=(0,M.useState)([]),[o,l]=(0,M.useState)(""),[c,d]=(0,M.useState)(!1),[u,m]=(0,M.useState)(!1),[p,h]=(0,M.useState)(!1),[f,g]=(0,M.useState)("alloy"),x=(0,M.useRef)(null),b=(0,M.useRef)(null),v=(0,M.useRef)(null),w=(0,M.useRef)(null);(0,M.useRef)([]),(0,M.useRef)(!1);let _=(0,M.useRef)(null),j=(0,M.useRef)(0),S=(0,M.useCallback)(()=>{_.current?.scrollIntoView({behavior:"smooth"})},[]);(0,M.useEffect)(()=>{S()},[n,S]);let N=(0,M.useCallback)((e,t)=>{i(s=>[...s,{role:e,content:t,timestamp:new Date}])},[]),C=(0,M.useCallback)(e=>{i(t=>{let s=t[t.length-1];return s&&"assistant"===s.role?[...t.slice(0,-1),{...s,content:s.content+e}]:[...t,{role:"assistant",content:e,timestamp:new Date}]})},[]),T=(0,M.useCallback)(e=>{let t=atob(e),s=new Uint8Array(t.length);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);let r=new Int16Array(s.buffer),a=new Float32Array(r.length);for(let e=0;e<r.length;e++)a[e]=r[e]/32768;let n=b.current;if(!n)return;let i=n.createBuffer(1,a.length,24e3);i.getChannelData(0).set(a);let o=n.createBufferSource();o.buffer=i,o.connect(n.destination);let l=Math.max(n.currentTime,j.current);o.start(l),j.current=l+i.duration},[]),P=(0,M.useCallback)(async()=>{if(!x.current){if(!s)return void N("status","Please select a model first");m(!0);try{b.current=new AudioContext({sampleRate:24e3});let t=(r||(0,H.getProxyBaseUrl)()).replace(/^http/,"ws"),n=`${t}/v1/realtime?model=${encodeURIComponent(s)}`;a&&a.length>0&&(n+=`&guardrails=${encodeURIComponent(a.join(","))}`);let o=new WebSocket(n,["realtime",`openai-insecure-api-key.${e}`]);o.onopen=()=>{d(!0),m(!1),N("status","Connected to realtime API")},o.onmessage=async e=>{try{let t=e.data;t instanceof Blob?t=await t.text():t instanceof ArrayBuffer&&(t=new TextDecoder().decode(t));let s=JSON.parse(t),r=s.type;"session.created"===r?o.send(JSON.stringify({type:"session.update",session:{modalities:["text","audio"],voice:f,input_audio_format:"pcm16",output_audio_format:"pcm16",input_audio_transcription:{model:"gpt-4o-mini-transcribe"},turn_detection:null}})):"session.updated"===r||("response.audio.delta"===r?s.delta&&T(s.delta):"response.audio_transcript.delta"===r||"response.text.delta"===r?s.delta&&C(s.delta):"conversation.item.input_audio_transcription.completed"===r?s.transcript&&N("user",s.transcript):"response.done"===r?i(e=>{let t=e[e.length-1];if(t&&"assistant"===t.role&&t.content)return e;let r=s.response?.output||[],a=[];for(let e of r)for(let t of e.content||[]){let e=t.text||t.transcript;e&&a.push(e)}return a.length>0?[...e,{role:"assistant",content:a.join(""),timestamp:new Date}]:e}):"error"===r&&N("status",`Error: ${s.error?.message||JSON.stringify(s.error)}`))}catch{}},o.onerror=()=>{N("status","WebSocket error"),d(!1),m(!1)},o.onclose=()=>{N("status","Disconnected"),d(!1),m(!1),x.current=null},x.current=o}catch(e){N("status",`Connection failed: ${e.message}`),m(!1)}}},[e,s,f,r,a,N,C,T]),O=(0,M.useCallback)(()=>{I(),x.current?.close(),x.current=null,b.current?.close(),b.current=null,j.current=0,L.current=!1,d(!1)},[]),R=(0,M.useCallback)(async()=>{if(x.current&&x.current.readyState===WebSocket.OPEN){x.current.send(JSON.stringify({type:"session.update",session:{modalities:["text","audio"],voice:f,input_audio_format:"pcm16",output_audio_format:"pcm16",input_audio_transcription:{model:"gpt-4o-mini-transcribe"},turn_detection:{type:"server_vad"}}}));try{let e=await navigator.mediaDevices.getUserMedia({audio:!0});v.current=e;let t=b.current||new AudioContext({sampleRate:24e3});b.current=t;let s=t.createMediaStreamSource(e),r=t.createScriptProcessor(4096,1,1);w.current=r,r.onaudioprocess=e=>{let s;if(!x.current||x.current.readyState!==WebSocket.OPEN)return;let r=e.inputBuffer.getChannelData(0),a=t.sampleRate;if(24e3!==a){let e=a/24e3,t=Math.round(r.length/e);s=new Float32Array(t);for(let a=0;a<t;a++)s[a]=r[Math.round(a*e)]||0}else s=r;let n=new Int16Array(s.length);for(let e=0;e<s.length;e++){let t=Math.max(-1,Math.min(1,s[e]));n[e]=t<0?32768*t:32767*t}let i=new Uint8Array(n.buffer),o="";for(let e=0;e<i.length;e++)o+=String.fromCharCode(i[e]);let l=btoa(o);x.current.send(JSON.stringify({type:"input_audio_buffer.append",audio:l}))},s.connect(r),r.connect(t.destination),h(!0),N("status"," Listening...")}catch(e){N("status",`Microphone error: ${e.message}`)}}},[N]),I=(0,M.useCallback)(()=>{w.current?.disconnect(),w.current=null,v.current?.getTracks().forEach(e=>e.stop()),v.current=null,h(!1)},[]),L=(0,M.useRef)(!1),$=(0,M.useCallback)(()=>{!x.current||x.current.readyState!==WebSocket.OPEN||L.current||(L.current=!0,x.current.send(JSON.stringify({type:"session.update",session:{modalities:["text","audio"],voice:f,input_audio_format:"pcm16",output_audio_format:"pcm16",input_audio_transcription:{model:"gpt-4o-mini-transcribe"},turn_detection:null}})))},[f]),U=(0,M.useCallback)(()=>{if(!o.trim()||!x.current||x.current.readyState!==WebSocket.OPEN)return;let e=o.trim();N("user",e),l(""),x.current.send(JSON.stringify({type:"conversation.item.create",item:{type:"message",role:"user",content:[{type:"input_text",text:e}]}})),x.current.send(JSON.stringify({type:"response.create"}))},[o,N,$]);return(0,M.useEffect)(()=>()=>{x.current?.close(),b.current?.close(),v.current?.getTracks().forEach(e=>e.stop())},[]),(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(y.SoundOutlined,{className:"text-lg text-blue-500"}),(0,t.jsx)(te,{className:"font-semibold text-gray-800",children:"Realtime Voice Chat"}),(0,t.jsx)("span",{className:`inline-block w-2 h-2 rounded-full ${c?"bg-green-500":"bg-gray-300"}`}),(0,t.jsx)(te,{className:"text-xs text-gray-500",children:c?"Connected":u?"Connecting...":"Disconnected"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(A.Select,{size:"small",value:f,onChange:g,options:ej,style:{width:220},disabled:c}),c?(0,t.jsx)(k.Button,{danger:!0,onClick:O,size:"small",icon:(0,t.jsx)(e7.CloseCircleOutlined,{}),children:"Disconnect"}):(0,t.jsx)(k.Button,{type:"primary",onClick:P,loading:u,size:"small",children:"Connect"})]})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[0===n.length&&!c&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 gap-3",children:[(0,t.jsx)(y.SoundOutlined,{style:{fontSize:48}}),(0,t.jsx)(te,{className:"text-lg text-gray-500",children:"Realtime Voice Playground"}),(0,t.jsxs)(te,{className:"text-sm text-gray-400 text-center max-w-md",children:["Click ",(0,t.jsx)("b",{children:"Connect"})," to start a realtime session. You can speak using your microphone or type messages. The AI will respond with voice and text."]})]}),n.map((e,s)=>(0,t.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"status"===e.role?"justify-center":"justify-start"}`,children:"status"===e.role?(0,t.jsx)("div",{className:"text-xs text-gray-400 italic px-3 py-1",children:e.content}):(0,t.jsxs)("div",{className:`max-w-[75%] rounded-2xl px-4 py-2.5 ${"user"===e.role?"bg-blue-500 text-white rounded-br-md":"bg-gray-100 text-gray-800 rounded-bl-md"}`,children:[(0,t.jsx)("div",{className:"text-xs font-medium mb-0.5 opacity-70",children:"user"===e.role?"You":"AI"}),(0,t.jsx)("div",{className:"text-sm whitespace-pre-wrap",children:e.content})]})},s)),(0,t.jsx)("div",{ref:_})]}),c&&(0,t.jsxs)("div",{className:"border-t border-gray-200 p-3 bg-white",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(k.Button,{shape:"circle",size:"large",type:p?"primary":"default",danger:p,icon:p?(0,t.jsx)(e6,{}):(0,t.jsx)(e8.AudioOutlined,{}),onClick:p?I:R,title:p?"Stop recording":"Start recording",className:p?"animate-pulse":""}),(0,t.jsx)(E.Input,{placeholder:"Type a message or use the mic...",value:o,onChange:e=>l(e.target.value),onPressEnter:U,className:"flex-1",size:"large"}),(0,t.jsx)(k.Button,{type:"primary",icon:(0,t.jsx)(e9.SendOutlined,{}),onClick:U,disabled:!o.trim(),size:"large"})]}),p&&(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-red-500 text-xs",children:[(0,t.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-red-500 animate-pulse"}),"Listening  speak into your microphone. Server VAD will detect when you stop."]})]})]})},{TextArea:ts}=E.Input,{Dragger:tr}=I.Upload,ta=new Set([ew.EndpointType.CHAT,ew.EndpointType.RESPONSES,ew.EndpointType.MCP]);e.s(["default",0,({accessToken:e,token:E,userRole:I,userID:es,disabledPersonalKeyCreation:ei,proxySettings:eo,simplified:el=!1,fixedModel:ec})=>{let ed,[eu,em]=(0,M.useState)([]),[ep,eh]=(0,M.useState)(()=>{let e=sessionStorage.getItem("selectedMCPServers");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedMCPServers from sessionStorage",e),[]}}),[eg,ey]=(0,M.useState)(!1),[ex,e_]=(0,M.useState)({}),[eS,eN]=(0,M.useState)(void 0),eC=(0,M.useRef)(null),[eA,eP]=(0,M.useState)(()=>{let e=sessionStorage.getItem("mcpServerToolRestrictions");try{return e?JSON.parse(e):{}}catch(e){return console.error("Error parsing mcpServerToolRestrictions from sessionStorage",e),{}}}),[eR,eI]=(0,M.useState)(()=>{let e=sessionStorage.getItem("apiKeySource");if(e)try{return JSON.parse(e)}catch(e){console.error("Error parsing apiKeySource from sessionStorage",e)}return ei?"custom":"session"}),[eM,eL]=(0,M.useState)(()=>sessionStorage.getItem("apiKey")||""),[e$,eU]=(0,M.useState)(()=>sessionStorage.getItem("customProxyBaseUrl")||""),[eB,eq]=(0,M.useState)(""),[eH,eJ]=(0,M.useState)(()=>{if(el)return[];try{let e=sessionStorage.getItem("chatHistory");return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing chatHistory from sessionStorage",e),[]}}),[eG,eK]=(0,M.useState)(el?ec:void 0),[e1,e5]=(0,M.useState)(!1),[e6,e8]=(0,M.useState)([]),[e7,e9]=(0,M.useState)([]),[te,tn]=(0,M.useState)(void 0),ti=(0,M.useRef)(null),[to,tl]=(0,M.useState)(()=>sessionStorage.getItem("endpointType")||ew.EndpointType.CHAT),[tc,td]=(0,M.useState)(!1),tu=(0,M.useRef)(null),[tm,tp]=(0,M.useState)(()=>{let e=sessionStorage.getItem("selectedTags");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedTags from sessionStorage",e),[]}}),[th,tf]=(0,M.useState)(()=>{let e=sessionStorage.getItem("selectedVoice");if(!e)return"alloy";try{return JSON.parse(e)}catch{return e}}),[tg,ty]=(0,M.useState)(()=>{let e=sessionStorage.getItem("selectedVectorStores");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedVectorStores from sessionStorage",e),[]}}),[tx,tb]=(0,M.useState)(()=>{let e=sessionStorage.getItem("selectedGuardrails");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedGuardrails from sessionStorage",e),[]}}),[tv,tw]=(0,M.useState)(()=>{let e=sessionStorage.getItem("selectedPolicies");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedPolicies from sessionStorage",e),[]}}),[t_,tj]=(0,M.useState)(()=>sessionStorage.getItem("messageTraceId")||null),[tS,tN]=(0,M.useState)(()=>sessionStorage.getItem("responsesSessionId")||null),[tk,tE]=(0,M.useState)(()=>{let e=sessionStorage.getItem("useApiSessionManagement");return!e||JSON.parse(e)}),[tC,tT]=(0,M.useState)([]),[tA,tP]=(0,M.useState)([]),[tO,tR]=(0,M.useState)(null),[tI,tM]=(0,M.useState)(null),[tL,t$]=(0,M.useState)(null),[tU,tD]=(0,M.useState)(null),[tB,tq]=(0,M.useState)(null),[tz,tF]=(0,M.useState)(!1),[tW,tH]=(0,M.useState)(""),[tJ,tG]=(0,M.useState)("openai"),[tV,tK]=(0,M.useState)([]),[tX,tY]=(0,M.useState)(1),[tQ,tZ]=(0,M.useState)(2048),[t0,t1]=(0,M.useState)(!1),[t2,t4]=(0,M.useState)(!1),t3=function(){let[e,t]=(0,M.useState)(()=>{let e=sessionStorage.getItem("codeInterpreterEnabled");return!!e&&JSON.parse(e)}),[s,r]=(0,M.useState)(null),a=(0,M.useCallback)(e=>{t(e),sessionStorage.setItem("codeInterpreterEnabled",JSON.stringify(e))},[]),n=(0,M.useCallback)(()=>{r(null)},[]),i=(0,M.useCallback)(()=>{a(!e)},[e,a]);return{enabled:e,result:s,setEnabled:a,setResult:r,clearResult:n,toggle:i}}(),t5=(0,M.useRef)(null),t6=async()=>{let t="session"===eR?e:eM;if(t){ey(!0);try{let e=await (0,H.fetchMCPServers)(t);em(Array.isArray(e)?e:e.data||[])}catch(e){console.error("Error fetching MCP servers:",e)}finally{ey(!1)}}};(0,M.useEffect)(()=>{el&&ec&&(eK(ec),tl(ew.EndpointType.CHAT))},[el,ec]);let t8=async t=>{let s="session"===eR?e:eM;if(s&&!ex[t])try{let e=await (0,H.listMCPTools)(s,t);e_(s=>({...s,[t]:e.tools||[]}))}catch(e){console.error(`Error fetching tools for server ${t}:`,e)}};(0,M.useEffect)(()=>{if(tz){let t=(0,eF.generateCodeSnippet)({apiKeySource:eR,accessToken:e,apiKey:eM,inputMessage:eB,chatHistory:eH,selectedTags:tm,selectedVectorStores:tg,selectedGuardrails:tx,selectedPolicies:tv,selectedMCPServers:ep,mcpServers:eu,mcpServerToolRestrictions:eA,endpointType:to,selectedModel:eG,selectedSdk:tJ,selectedVoice:th,proxySettings:eo});tH(t)}},[tz,tJ,eR,e,eM,eB,eH,tm,tg,tx,tv,ep,eu,eA,to,eG,eo]),(0,M.useEffect)(()=>{if(el)return;let e=setTimeout(()=>{sessionStorage.setItem("chatHistory",JSON.stringify(eH))},500);return()=>{clearTimeout(e)}},[eH,el]),(0,M.useEffect)(()=>{sessionStorage.setItem("apiKeySource",JSON.stringify(eR)),sessionStorage.setItem("apiKey",eM),sessionStorage.setItem("endpointType",to),sessionStorage.setItem("selectedTags",JSON.stringify(tm)),sessionStorage.setItem("selectedVectorStores",JSON.stringify(tg)),sessionStorage.setItem("selectedGuardrails",JSON.stringify(tx)),sessionStorage.setItem("selectedPolicies",JSON.stringify(tv)),sessionStorage.setItem("selectedMCPServers",JSON.stringify(ep)),sessionStorage.setItem("mcpServerToolRestrictions",JSON.stringify(eA)),sessionStorage.setItem("selectedVoice",th),sessionStorage.removeItem("selectedMCPTools"),el||(eG?sessionStorage.setItem("selectedModel",eG):sessionStorage.removeItem("selectedModel")),t_?sessionStorage.setItem("messageTraceId",t_):sessionStorage.removeItem("messageTraceId"),tS?sessionStorage.setItem("responsesSessionId",tS):sessionStorage.removeItem("responsesSessionId"),sessionStorage.setItem("useApiSessionManagement",JSON.stringify(tk))},[el,eR,eM,eG,to,tm,tg,tx,tv,t_,tS,tk,ep,eA,th]),(0,M.useEffect)(()=>{let t="session"===eR?e:eM;if(!t||!E||!I||!es)return void console.log("userApiKey or token or userRole or userID is missing = ",t,E,I,es);let s=async()=>{try{if(!t)return void console.log("userApiKey is missing");let e=await (0,et.fetchAvailableModels)(t);console.log("Fetched models:",e),e8(e);let s=e.some(e=>e.model_group===eG);e.length&&s||eK(void 0)}catch(e){console.error("Error fetching model info:",e)}};el||s(),t6()},[e,es,I,eR,eM,E,el]),(0,M.useEffect)(()=>{to!==ew.EndpointType.MCP||1!==ep.length||"__all__"===ep[0]||ex[ep[0]]||t8(ep[0])},[to,ep,ex]),(0,M.useEffect)(()=>{let t="session"===eR?e:eM;t&&to===ew.EndpointType.A2A_AGENTS&&(async()=>{try{let e=await (0,ee.fetchAvailableAgents)(t,e$||void 0);e9(e),te&&!e.some(e=>e.agent_name===te)&&tn(void 0)}catch(e){console.error("Error fetching agents:",e)}})()},[e,eR,eM,to,e$,te]),(0,M.useEffect)(()=>{t5.current&&setTimeout(()=>{t5.current?.scrollIntoView({behavior:"smooth",block:"end"})},100)},[eH]);let t7=(e,t,s)=>{console.log("updateTextUI called with:",e,t,s),eJ(r=>{let a=r[r.length-1];if(!a||a.role!==e||a.isImage||a.isAudio)return[...r,{role:e,content:t,model:s}];{let e={...a,content:a.content+t,model:a.model??s};return[...r.slice(0,-1),e]}})},t9=e=>{eJ(t=>{let s=t[t.length-1];return!s||"assistant"!==s.role||s.isImage||s.isAudio?t.length>0&&"user"===t[t.length-1].role?[...t,{role:"assistant",content:"",reasoningContent:e}]:t:[...t.slice(0,t.length-1),{...s,reasoningContent:(s.reasoningContent||"")+e}]})},se=e=>{console.log("updateTimingData called with:",e),eJ(t=>{let s=t[t.length-1];if(console.log("Current last message:",s),s&&"assistant"===s.role){console.log("Updating assistant message with timeToFirstToken:",e);let r=[...t.slice(0,t.length-1),{...s,timeToFirstToken:e}];return console.log("Updated chat history:",r),r}return s&&"user"===s.role?(console.log("Creating new assistant message with timeToFirstToken:",e),[...t,{role:"assistant",content:"",timeToFirstToken:e}]):(console.log("No appropriate message found to update timing"),t)})},st=(e,t)=>{console.log("Received usage data:",e),eJ(s=>{let r=s[s.length-1];if(r&&"assistant"===r.role){console.log("Updating message with usage data:",e);let a={...r,usage:e,toolName:t};return console.log("Updated message:",a),[...s.slice(0,s.length-1),a]}return s})},ss=e=>{console.log("Received A2A metadata:",e),eJ(t=>{let s=t[t.length-1];if(s&&"assistant"===s.role){let r={...s,a2aMetadata:e};return[...t.slice(0,t.length-1),r]}return t})},sr=e=>{eJ(t=>{let s=t[t.length-1];return s&&"assistant"===s.role?[...t.slice(0,t.length-1),{...s,totalLatency:e}]:t})},sa=e=>{console.log("Received search results:",e),eJ(t=>{let s=t[t.length-1];if(s&&"assistant"===s.role){console.log("Updating message with search results");let r={...s,searchResults:e};return[...t.slice(0,t.length-1),r]}return t})},sn=e=>{console.log("Received response ID for session management:",e),tk&&tN(e)},si=e=>{console.log("ChatUI: Received MCP event:",e),tK(t=>{if(e.item_id&&t.some(t=>t.item_id===e.item_id&&t.type===e.type&&(t.sequence_number===e.sequence_number||void 0===t.sequence_number&&void 0===e.sequence_number)))return console.log("ChatUI: Duplicate MCP event, skipping"),t;let s=[...t,e];return console.log("ChatUI: Updated MCP events:",s),s})},so=(e,t)=>{eJ(s=>[...s,{role:"assistant",content:e,model:t,isImage:!0}])},sl=(e,t)=>{eJ(s=>{let r=s[s.length-1];if(!r||"assistant"!==r.role||r.isImage||r.isAudio)return[...s,{role:"assistant",content:"",model:t,image:{url:e,detail:"auto"}}];{let a={...r,image:{url:e,detail:"auto"},model:r.model??t};return[...s.slice(0,-1),a]}})},sc=e=>{tT(t=>[...t,e]);let t=URL.createObjectURL(e);return tP(e=>[...e,t]),!1},sd=()=>{tA.forEach(e=>{URL.revokeObjectURL(e)}),tT([]),tP([])},su=()=>{tI&&URL.revokeObjectURL(tI),tR(null),tM(null)},sm=()=>{tU&&URL.revokeObjectURL(tU),t$(null),tD(null)},sp=()=>{tq(null)},sh=async()=>{let t;if(""===eB.trim()&&to!==ew.EndpointType.TRANSCRIPTION&&to!==ew.EndpointType.MCP)return;if(to===ew.EndpointType.IMAGE_EDITS&&0===tC.length)return void W.default.fromBackend("Please upload at least one image for editing");if(to===ew.EndpointType.TRANSCRIPTION&&!tB)return void W.default.fromBackend("Please upload an audio file for transcription");if(to===ew.EndpointType.A2A_AGENTS&&!te)return void W.default.fromBackend("Please select an agent to send a message");let s={};if(to===ew.EndpointType.MCP){if(!(1===ep.length&&"__all__"!==ep[0]?ep[0]:null))return void W.default.fromBackend("Please select an MCP server to test");if(!eS)return void W.default.fromBackend("Please select an MCP tool to call");if(!(ex[ep[0]]||[]).find(e=>e.name===eS))return void W.default.fromBackend("Please wait for tool schema to load");try{s=await eC.current?.getSubmitValues()??{}}catch(e){W.default.fromBackend(e instanceof Error?e.message:"Please fill in all required parameters");return}}if([ew.EndpointType.CHAT,ew.EndpointType.IMAGE,ew.EndpointType.SPEECH,ew.EndpointType.IMAGE_EDITS,ew.EndpointType.RESPONSES,ew.EndpointType.ANTHROPIC_MESSAGES,ew.EndpointType.EMBEDDINGS,ew.EndpointType.TRANSCRIPTION].includes(to)&&!eG)return void W.default.fromBackend("Please select a model before sending a request");if(!E||!I||!es)return;let r=el||"session"===eR?e:eM;if(!r)return void W.default.fromBackend("Please provide a Virtual Key or select Current UI Session");tu.current=new AbortController;let a=tu.current.signal;if(to===ew.EndpointType.RESPONSES&&tO)try{t=await eQ(eB,tO)}catch(e){W.default.fromBackend("Failed to process image. Please try again.");return}else if(to===ew.EndpointType.CHAT&&tL)try{t=await ek(eB,tL)}catch(e){W.default.fromBackend("Failed to process image. Please try again.");return}else t={role:"user",content:eB};let n=t_||(0,D.v4)();t_||tj(n),eJ([...eH,to===ew.EndpointType.RESPONSES&&tO?eZ(eB,!0,tI||void 0,tO.name):to===ew.EndpointType.CHAT&&tL?eE(eB,!0,tU||void 0,tL.name):to===ew.EndpointType.TRANSCRIPTION&&tB?eZ(eB?` Audio file: ${tB.name}
Prompt: ${eB}`:` Audio file: ${tB.name}`,!1):to===ew.EndpointType.MCP&&eS?eZ(` MCP Tool: ${eS}
Arguments: ${JSON.stringify(s,null,2)}`,!1):eZ(eB,!1)]),tK([]),t3.clearResult(),td(!0);try{if(eG)if(to===ew.EndpointType.CHAT){let e=[...eH.filter(e=>!e.isImage&&!e.isAudio).map(({role:e,content:t})=>({role:e,content:"string"==typeof t?t:""})),t],s=el&&eo?eo.LITELLM_UI_API_DOC_BASE_URL??eo.PROXY_BASE_URL??void 0:e$||void 0;await (0,Q.makeOpenAIChatCompletionRequest)(e,(e,t)=>t7("assistant",e,t),eG,r,tm,a,t9,se,st,n,tg.length>0?tg:void 0,tx.length>0?tx:void 0,tv.length>0?tv:void 0,ep,sl,sa,t0?tX:void 0,t0?tQ:void 0,sr,s,eu,eA,si,t2)}else if(to===ew.EndpointType.IMAGE)await ea(eB,(e,t)=>so(e,t),eG,r,tm,a,e$||void 0);else if(to===ew.EndpointType.SPEECH)await (0,X.makeOpenAIAudioSpeechRequest)(eB,th,(e,t)=>{eJ(s=>[...s,{role:"assistant",content:e,model:t,isAudio:!0}])},eG||"",r,tm,a,void 0,void 0,e$||void 0);else if(to===ew.EndpointType.IMAGE_EDITS)tC.length>0&&await er(1===tC.length?tC[0]:tC,eB,(e,t)=>so(e,t),eG,r,tm,a,e$||void 0);else if(to===ew.EndpointType.RESPONSES){let e;e=tk&&tS?[t]:[...eH.filter(e=>!e.isImage&&!e.isAudio).map(({role:e,content:t})=>({role:e,content:t})),t],await en(e,(e,t,s)=>t7(e,t,s),eG,r,tm,a,t9,se,st,n,tg.length>0?tg:void 0,tx.length>0?tx:void 0,tv.length>0?tv:void 0,ep,tk?tS:null,sn,si,t3.enabled,t3.setResult,e$||void 0,eu,eA)}else if(to===ew.EndpointType.ANTHROPIC_MESSAGES){let e=[...eH.filter(e=>!e.isImage&&!e.isAudio).map(({role:e,content:t})=>({role:e,content:t})),t];await (0,K.makeAnthropicMessagesRequest)(e,(e,t,s)=>t7(e,t,s),eG,r,tm,a,t9,se,st,n,tg.length>0?tg:void 0,tx.length>0?tx:void 0,tv.length>0?tv:void 0,ep,e$||void 0)}else to===ew.EndpointType.EMBEDDINGS?await (0,Z.makeOpenAIEmbeddingsRequest)(eB,(e,t)=>{eJ(s=>[...s,{role:"assistant",content:(0,B.truncateString)(e,100),model:t,isEmbeddings:!0}])},eG,r,tm,e$||void 0):to===ew.EndpointType.TRANSCRIPTION&&tB&&await (0,Y.makeOpenAIAudioTranscriptionRequest)(tB,(e,t)=>t7("assistant",e,t),eG,r,tm,a,void 0,void 0,void 0,void 0,e$||void 0);if(to===ew.EndpointType.MCP){let e=1===ep.length&&"__all__"!==ep[0]?ep[0]:null;if(e&&eS){let t=await (0,H.callMCPTool)(r,e,eS,s,tx.length>0?{guardrails:tx}:void 0),a=t?.content?.length>0?JSON.stringify(t.content.map(e=>"text"===e.type?e.text:e).filter(Boolean),null,2):JSON.stringify(t,null,2);t7("assistant",a||"Tool executed successfully.")}}to===ew.EndpointType.A2A_AGENTS&&te&&await (0,V.makeA2ASendMessageRequest)(te,eB,(e,t)=>t7("assistant",e,t),r,a,se,sr,ss,e$||void 0,tx.length>0?tx:void 0)}catch(e){a.aborted?console.log("Request was cancelled"):(console.error("Error fetching response",e),t7("assistant","Error fetching response:"+e))}finally{td(!1),tu.current=null,to===ew.EndpointType.IMAGE_EDITS&&sd(),to===ew.EndpointType.RESPONSES&&tO&&su(),to===ew.EndpointType.CHAT&&tL&&sm(),to===ew.EndpointType.TRANSCRIPTION&&tB&&sp()}eq("")};if(I&&"Admin Viewer"===I){let{Title:e,Paragraph:s}=R.Typography;return(0,t.jsxs)("div",{children:[(0,t.jsx)(e,{level:1,children:"Access Denied"}),(0,t.jsx)(s,{children:"Ask your proxy admin for access to test models"})]})}let sf=(0,t.jsx)(m.LoadingOutlined,{style:{fontSize:24},spin:!0});return(0,t.jsxs)("div",{className:`w-full bg-white ${el?"h-full flex flex-col":"p-4 pb-0"}`,children:[(0,t.jsx)(w.Card,{className:`w-full rounded-xl shadow-md overflow-hidden ${el?"h-full flex flex-col":""}`,children:(0,t.jsxs)("div",{className:`flex w-full gap-4 ${el?"h-full":"h-[80vh]"}`,children:[!el&&(0,t.jsxs)("div",{className:"w-1/4 p-4 bg-gray-50 overflow-y-auto",children:[(0,t.jsx)(S.Title,{className:"text-xl font-semibold mb-6 mt-2",children:"Configurations"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(_.Text,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,t.jsx)(d.KeyOutlined,{className:"mr-2"})," Virtual Key Source"]}),(0,t.jsx)(A.Select,{disabled:ei,value:eR,style:{width:"100%"},onChange:e=>{eI(e)},options:[{value:"session",label:"Current UI Session"},{value:"custom",label:"Virtual Key"}],className:"rounded-md"}),"custom"===eR&&(0,t.jsx)(j.TextInput,{className:"mt-2",placeholder:"Enter custom Virtual Key",type:"password",onValueChange:eL,value:eM,icon:d.KeyOutlined})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)(_.Text,{className:"font-medium block text-gray-700 flex items-center",children:[(0,t.jsx)(g.SettingOutlined,{className:"mr-2"})," Custom Proxy Base URL"]}),eo?.LITELLM_UI_API_DOC_BASE_URL&&!e$&&(0,t.jsx)(k.Button,{type:"link",size:"small",icon:(0,t.jsx)(u.LinkOutlined,{}),onClick:()=>{eU(eo.LITELLM_UI_API_DOC_BASE_URL||""),sessionStorage.setItem("customProxyBaseUrl",eo.LITELLM_UI_API_DOC_BASE_URL||"")},className:"text-gray-500 hover:text-gray-700",children:"Fill"}),e$&&(0,t.jsx)(k.Button,{type:"link",size:"small",icon:(0,t.jsx)(a.ClearOutlined,{}),onClick:()=>{eU(""),sessionStorage.removeItem("customProxyBaseUrl")},className:"text-gray-500 hover:text-gray-700",children:"Clear"})]}),(0,t.jsx)(j.TextInput,{placeholder:"Optional: Enter custom proxy URL (e.g., http://localhost:5000)",onValueChange:e=>{eU(e),sessionStorage.setItem("customProxyBaseUrl",e)},value:e$,icon:s.ApiOutlined}),e$&&(0,t.jsxs)(_.Text,{className:"text-xs text-gray-500 mt-1",children:["API calls will be sent to: ",e$]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(_.Text,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,t.jsx)(s.ApiOutlined,{className:"mr-2"})," Endpoint Type"]}),(0,t.jsx)(eW,{endpointType:to,onEndpointChange:e=>{tl(e),eK(void 0),tn(void 0),e5(!1),eN(void 0),e===ew.EndpointType.MCP&&eh(e=>1===e.length&&"__all__"!==e[0]?e:[]);try{sessionStorage.removeItem("selectedModel"),sessionStorage.removeItem("selectedAgent")}catch{}},className:"mb-4"}),to===ew.EndpointType.SPEECH&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)(_.Text,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,t.jsx)(y.SoundOutlined,{className:"mr-2"}),"Voice"]}),(0,t.jsx)(A.Select,{value:th,onChange:e=>{tf(e),sessionStorage.setItem("selectedVoice",e)},style:{width:"100%"},className:"rounded-md",options:ej})]}),(0,t.jsx)(e3,{endpointType:to,responsesSessionId:tS,useApiSessionManagement:tk,onToggleSessionManagement:e=>{tE(e),e||tN(null)}})]}),to!==ew.EndpointType.A2A_AGENTS&&to!==ew.EndpointType.MCP&&(0,t.jsxs)("div",{children:[(0,t.jsxs)(_.Text,{className:"font-medium block mb-2 text-gray-700 flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(h.RobotOutlined,{className:"mr-2"})," Select Model"]}),(()=>{if(!eG||"custom"===eG)return!1;let e=e6.find(e=>e.model_group===eG);return!!e&&(!e.mode||"chat"===e.mode)})()?(0,t.jsx)(T.Popover,{content:(0,t.jsx)(eb,{temperature:tX,maxTokens:tQ,useAdvancedParams:t0,onTemperatureChange:tY,onMaxTokensChange:tZ,onUseAdvancedParamsChange:t1,mockTestFallbacks:t2,onMockTestFallbacksChange:t4}),title:"Model Settings",trigger:"click",placement:"right",children:(0,t.jsx)(k.Button,{type:"text",size:"small",icon:(0,t.jsx)(g.SettingOutlined,{}),className:"text-gray-500 hover:text-gray-700","aria-label":"Model Settings","data-testid":"model-settings-button"})}):(0,t.jsx)(O.Tooltip,{title:"Advanced parameters are only supported for chat models currently",children:(0,t.jsx)(k.Button,{type:"text",size:"small",icon:(0,t.jsx)(g.SettingOutlined,{}),className:"text-gray-300 cursor-not-allowed",disabled:!0})})]}),(0,t.jsx)(A.Select,{value:eG,placeholder:"Select a Model",onChange:e=>{console.log(`selected ${e}`),eK(e),e5("custom"===e)},options:[{value:"custom",label:"Enter custom model",key:"custom"},...Array.from(new Set(e6.filter(e=>{if(!e.mode)return!0;let t=(0,ew.getEndpointType)(e.mode);return to===ew.EndpointType.RESPONSES||to===ew.EndpointType.ANTHROPIC_MESSAGES?t===to||t===ew.EndpointType.CHAT:to===ew.EndpointType.IMAGE_EDITS?t===to||t===ew.EndpointType.IMAGE:t===to}).map(e=>e.model_group))).map((e,t)=>({value:e,label:e,key:t}))],style:{width:"100%"},showSearch:!0,className:"rounded-md"}),e1&&(0,t.jsx)(j.TextInput,{className:"mt-2",placeholder:"Enter custom model name",onValueChange:e=>{ti.current&&clearTimeout(ti.current),ti.current=setTimeout(()=>{eK(e)},500)}})]}),to===ew.EndpointType.A2A_AGENTS&&(0,t.jsxs)("div",{children:[(0,t.jsxs)(_.Text,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,t.jsx)(h.RobotOutlined,{className:"mr-2"})," Select Agent"]}),(0,t.jsx)(A.Select,{value:te,placeholder:"Select an Agent",onChange:e=>tn(e),options:e7.map(e=>({value:e.agent_name,label:e.agent_name||e.agent_id,key:e.agent_id})),style:{width:"100%"},showSearch:!0,className:"rounded-md",optionLabelProp:"label",children:e7.map(e=>(0,t.jsx)(A.Select.Option,{value:e.agent_name,label:e.agent_name||e.agent_id,children:(0,t.jsxs)("div",{className:"flex flex-col py-1",children:[(0,t.jsx)("span",{className:"font-medium",children:e.agent_name||e.agent_id}),e.agent_card_params?.description&&(0,t.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:e.agent_card_params.description})]})},e.agent_id))}),0===e7.length&&(0,t.jsx)(_.Text,{className:"text-xs text-gray-500 mt-2 block",children:"No agents found. Create agents via /v1/agents endpoint."})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(_.Text,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,t.jsx)(x.TagsOutlined,{className:"mr-2"})," Tags"]}),(0,t.jsx)(J.default,{value:tm,onChange:tp,className:"mb-4",accessToken:e||""})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(_.Text,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,t.jsx)(b.ToolOutlined,{className:"mr-2"}),to===ew.EndpointType.MCP?"MCP Server":"MCP Servers",(0,t.jsx)(O.Tooltip,{className:"ml-1",title:to===ew.EndpointType.MCP?"Select an MCP server to test tools directly.":"Select MCP servers to use in your conversation.",children:(0,t.jsx)(c.InfoCircleOutlined,{})})]}),(0,t.jsxs)(A.Select,{mode:to===ew.EndpointType.MCP?void 0:"multiple",style:{width:"100%"},placeholder:to===ew.EndpointType.MCP?"Select MCP server":"Select MCP servers",value:to===ew.EndpointType.MCP?"__all__"!==ep[0]&&1===ep.length?ep[0]:void 0:ep,onChange:e=>{to===ew.EndpointType.MCP?(eh(e?[e]:[]),eN(void 0),e&&!ex[e]&&t8(e)):e.includes("__all__")?(eh(["__all__"]),eP({})):(eh(e),eP(t=>{let s={...t};return Object.keys(s).forEach(t=>{e.includes(t)||delete s[t]}),s}),e.forEach(e=>{ex[e]||t8(e)}))},loading:eg,className:"mb-2",allowClear:!0,optionLabelProp:"label",disabled:!ta.has(to),maxTagCount:to===ew.EndpointType.MCP?1:"responsive",children:[to!==ew.EndpointType.MCP&&(0,t.jsx)(A.Select.Option,{value:"__all__",label:"All MCP Servers",children:(0,t.jsxs)("div",{className:"flex flex-col py-1",children:[(0,t.jsx)("span",{className:"font-medium",children:"All MCP Servers"}),(0,t.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Use all available MCP servers"})]})},"__all__"),eu.map(e=>(0,t.jsx)(A.Select.Option,{value:e.server_id,label:e.alias||e.server_name||e.server_id,disabled:to!==ew.EndpointType.MCP&&ep.includes("__all__"),children:(0,t.jsxs)("div",{className:"flex flex-col py-1",children:[(0,t.jsx)("span",{className:"font-medium",children:e.alias||e.server_name||e.server_id}),e.description&&(0,t.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:e.description})]})},e.server_id))]}),to===ew.EndpointType.MCP&&1===ep.length&&"__all__"!==ep[0]&&(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)(_.Text,{className:"text-xs text-gray-600 mb-1 block",children:"Select Tool"}),(0,t.jsx)(A.Select,{style:{width:"100%"},placeholder:"Select a tool to call",value:eS,onChange:e=>eN(e),options:(ex[ep[0]]||[]).map(e=>({value:e.name,label:e.name})),allowClear:!0,className:"rounded-md"})]}),ep.length>0&&!ep.includes("__all__")&&to!==ew.EndpointType.MCP&&ta.has(to)&&(0,t.jsx)("div",{className:"mt-3 space-y-2",children:ep.map(e=>{let s=eu.find(t=>t.server_id===e),r=ex[e]||[];return 0===r.length?null:(0,t.jsxs)("div",{className:"border rounded p-2",children:[(0,t.jsxs)(_.Text,{className:"text-xs text-gray-600 mb-1",children:["Limit tools for ",s?.alias||s?.server_name||e,":"]}),(0,t.jsx)(A.Select,{mode:"multiple",size:"small",style:{width:"100%"},placeholder:"All tools (default)",value:eA[e]||[],onChange:t=>{eP(s=>({...s,[e]:t}))},options:r.map(e=>({value:e.name,label:e.name})),maxTagCount:2})]},e)})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(_.Text,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,t.jsx)(i.DatabaseOutlined,{className:"mr-2"})," Vector Store",(0,t.jsx)(O.Tooltip,{className:"ml-1",title:(0,t.jsxs)("span",{children:["Select vector store(s) to use for this LLM API call. You can set up your vector store"," ",(0,t.jsx)("a",{href:"?page=vector-stores",style:{color:"#1890ff"},children:"here"}),"."]}),children:(0,t.jsx)(c.InfoCircleOutlined,{})})]}),(0,t.jsx)(G.default,{value:tg,onChange:ty,className:"mb-4",accessToken:e||""})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(_.Text,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,t.jsx)(f.SafetyOutlined,{className:"mr-2"})," Guardrails",(0,t.jsx)(O.Tooltip,{className:"ml-1",title:(0,t.jsxs)("span",{children:["Select guardrail(s) to use for this LLM API call. You can set up your guardrails"," ",(0,t.jsx)("a",{href:"?page=guardrails",style:{color:"#1890ff"},children:"here"}),"."]}),children:(0,t.jsx)(c.InfoCircleOutlined,{})})]}),(0,t.jsx)(q.default,{value:tx,onChange:tb,className:"mb-4",accessToken:e||""})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(_.Text,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,t.jsx)(f.SafetyOutlined,{className:"mr-2"})," Policies",(0,t.jsx)(O.Tooltip,{className:"ml-1",title:(0,t.jsxs)("span",{children:["Select policy/policies to apply to this LLM API call. Policies define which guardrails are applied based on conditions. You can set up your policies"," ",(0,t.jsx)("a",{href:"?page=policies",style:{color:"#1890ff"},children:"here"}),"."]}),children:(0,t.jsx)(c.InfoCircleOutlined,{})})]}),(0,t.jsx)(z.default,{value:tv,onChange:tw,className:"mb-4",accessToken:e||""})]}),to===ew.EndpointType.RESPONSES&&(0,t.jsx)("div",{children:(0,t.jsx)(ez,{accessToken:"session"===eR?e||"":eM,enabled:t3.enabled,onEnabledChange:t3.setEnabled,selectedContainerId:null,onContainerChange:()=>{},selectedModel:eG||""})})]})]}),(0,t.jsx)("div",{className:`flex flex-col bg-white ${el?"flex-1 w-full":"w-3/4"}`,children:to===ew.EndpointType.REALTIME?(0,t.jsx)(tt,{accessToken:"session"===eR?e||"":eM,selectedModel:eG||"",customProxyBaseUrl:e$||void 0,selectedGuardrails:tx.length>0?tx:void 0}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,t.jsx)(S.Title,{className:"text-xl font-semibold mb-0",children:el?"Chat":"Test Key"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(N.Button,{onClick:()=>{eH.forEach(e=>{e.isAudio&&"string"==typeof e.content&&URL.revokeObjectURL(e.content)}),eJ([]),tj(null),tN(null),tK([]),sd(),su(),sm(),sp(),el||(sessionStorage.removeItem("chatHistory"),sessionStorage.removeItem("messageTraceId"),sessionStorage.removeItem("responsesSessionId")),W.default.success("Chat history cleared.")},className:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",icon:a.ClearOutlined,children:"Clear Chat"}),!el&&(0,t.jsx)(N.Button,{onClick:()=>tF(!0),className:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",icon:n.CodeOutlined,children:"Get Code"})]})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-auto p-4 pb-0",children:[0===eH.length&&(0,t.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,t.jsx)(h.RobotOutlined,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,t.jsx)(_.Text,{children:"Start a conversation, generate an image, or handle audio"})]}),eH.map((s,r)=>(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:`mb-4 ${"user"===s.role?"text-right":"text-left"}`,children:(0,t.jsxs)("div",{className:"inline-block max-w-[80%] rounded-lg shadow-sm p-3.5 px-4",style:{backgroundColor:"user"===s.role?"#f0f8ff":"#ffffff",border:"user"===s.role?"1px solid #e6f0fa":"1px solid #f0f0f0",textAlign:"left"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full mr-1",style:{backgroundColor:"user"===s.role?"#e6f0fa":"#f5f5f5"},children:"user"===s.role?(0,t.jsx)(v.UserOutlined,{style:{fontSize:"12px",color:"#2563eb"}}):(0,t.jsx)(h.RobotOutlined,{style:{fontSize:"12px",color:"#4b5563"}})}),(0,t.jsx)("strong",{className:"text-sm capitalize",children:s.role}),"assistant"===s.role&&s.model&&(0,t.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-600 font-normal",children:s.model})]}),s.reasoningContent&&(0,t.jsx)(eX,{reasoningContent:s.reasoningContent}),"assistant"===s.role&&r===eH.length-1&&tV.length>0&&(to===ew.EndpointType.RESPONSES||to===ew.EndpointType.CHAT)&&(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)(eV,{events:tV})}),"assistant"===s.role&&s.searchResults&&(0,t.jsx)(e4,{searchResults:s.searchResults}),"assistant"===s.role&&r===eH.length-1&&t3.result&&to===ew.EndpointType.RESPONSES&&(0,t.jsx)(eD,{code:t3.result.code,containerId:t3.result.containerId,annotations:t3.result.annotations,accessToken:"session"===eR?e||"":eM}),(0,t.jsxs)("div",{className:"whitespace-pre-wrap break-words max-w-full message-content",style:{wordWrap:"break-word",overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},children:[s.isImage?(0,t.jsx)("img",{src:"string"==typeof s.content?s.content:"",alt:"Generated image",className:"max-w-full rounded-md border border-gray-200 shadow-sm",style:{maxHeight:"500px"}}):s.isAudio?(0,t.jsx)(ev,{message:s}):(0,t.jsxs)(t.Fragment,{children:[to===ew.EndpointType.RESPONSES&&(0,t.jsx)(e0,{message:s}),to===ew.EndpointType.CHAT&&(0,t.jsx)(eT,{message:s}),(0,t.jsx)(L.default,{components:{code({node:e,inline:s,className:r,children:a,...n}){let i=/language-(\w+)/.exec(r||"");return!s&&i?(0,t.jsx)($.Prism,{style:U.coy,language:i[1],PreTag:"div",className:"rounded-md my-2",wrapLines:!0,wrapLongLines:!0,...n,children:String(a).replace(/\n$/,"")}):(0,t.jsx)("code",{className:`${r} px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono`,style:{wordBreak:"break-word"},...n,children:a})},pre:({node:e,...s})=>(0,t.jsx)("pre",{style:{overflowX:"auto",maxWidth:"100%"},...s})},children:"string"==typeof s.content?s.content:""}),s.image&&(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)("img",{src:s.image.url,alt:"Generated image",className:"max-w-full rounded-md border border-gray-200 shadow-sm",style:{maxHeight:"500px"}})})]}),"assistant"===s.role&&(s.timeToFirstToken||s.totalLatency||s.usage)&&!s.a2aMetadata&&(0,t.jsx)(eY.default,{timeToFirstToken:s.timeToFirstToken,totalLatency:s.totalLatency,usage:s.usage,toolName:s.toolName}),"assistant"===s.role&&s.a2aMetadata&&(0,t.jsx)(ef,{a2aMetadata:s.a2aMetadata,timeToFirstToken:s.timeToFirstToken,totalLatency:s.totalLatency})]})]})})},r)),tc&&tV.length>0&&(to===ew.EndpointType.RESPONSES||to===ew.EndpointType.CHAT)&&eH.length>0&&"user"===eH[eH.length-1].role&&(0,t.jsx)("div",{className:"text-left mb-4",children:(0,t.jsxs)("div",{className:"inline-block max-w-[80%] rounded-lg shadow-sm p-3.5 px-4",style:{backgroundColor:"#ffffff",border:"1px solid #f0f0f0",textAlign:"left"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full mr-1",style:{backgroundColor:"#f5f5f5"},children:(0,t.jsx)(h.RobotOutlined,{style:{fontSize:"12px",color:"#4b5563"}})}),(0,t.jsx)("strong",{className:"text-sm capitalize",children:"Assistant"})]}),(0,t.jsx)(eV,{events:tV})]})}),tc&&(0,t.jsx)("div",{className:"flex justify-center items-center my-4",children:(0,t.jsx)(P.Spin,{indicator:sf})}),(0,t.jsx)("div",{ref:t5,style:{height:"1px"}})]}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-white",children:[to===ew.EndpointType.IMAGE_EDITS&&(0,t.jsx)("div",{className:"mb-4",children:0===tC.length?(0,t.jsxs)(tr,{beforeUpload:sc,accept:"image/*",showUploadList:!1,children:[(0,t.jsx)("p",{className:"ant-upload-drag-icon",children:(0,t.jsx)(p.PictureOutlined,{style:{fontSize:"24px",color:"#666"}})}),(0,t.jsx)("p",{className:"ant-upload-text text-sm",children:"Click or drag images to upload"}),(0,t.jsx)("p",{className:"ant-upload-hint text-xs text-gray-500",children:"Support for PNG, JPG, JPEG formats. Multiple images supported."})]}):(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[tC.map((e,s)=>(0,t.jsxs)("div",{className:"relative inline-block",children:[(0,t.jsx)("img",{src:tA[s]||"",alt:`Upload preview ${s+1}`,className:"max-w-32 max-h-32 rounded-md border border-gray-200 object-cover"}),(0,t.jsx)("button",{className:"absolute top-1 right-1 bg-white shadow-sm border border-gray-200 rounded px-1 py-1 text-red-500 hover:bg-red-50 text-xs",onClick:()=>{tA[s]&&URL.revokeObjectURL(tA[s]),tT(e=>e.filter((e,t)=>t!==s)),tP(e=>e.filter((e,t)=>t!==s))},children:(0,t.jsx)(o.DeleteOutlined,{})})]},s)),(0,t.jsxs)("div",{className:"flex items-center justify-center w-32 h-32 border-2 border-dashed border-gray-300 rounded-md hover:border-gray-400 cursor-pointer",onClick:()=>document.getElementById("additional-image-upload")?.click(),children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(p.PictureOutlined,{style:{fontSize:"24px",color:"#666"}}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Add more"})]}),(0,t.jsx)("input",{id:"additional-image-upload",type:"file",accept:"image/*",multiple:!0,style:{display:"none"},onChange:e=>{Array.from(e.target.files||[]).forEach(e=>sc(e))}})]})]})}),to===ew.EndpointType.TRANSCRIPTION&&(0,t.jsx)("div",{className:"mb-4",children:tB?(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,t.jsx)(y.SoundOutlined,{style:{fontSize:"20px",color:"#666"}}),(0,t.jsx)("span",{className:"text-sm font-medium",children:tB.name}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:["(",(tB.size/1024/1024).toFixed(2)," MB)"]})]}),(0,t.jsxs)("button",{className:"bg-white shadow-sm border border-gray-200 rounded px-2 py-1 text-red-500 hover:bg-red-50 text-xs",onClick:sp,children:[(0,t.jsx)(o.DeleteOutlined,{})," Remove"]})]}):(0,t.jsxs)(tr,{beforeUpload:e=>(tq(e),!1),accept:"audio/*,.mp3,.mp4,.mpeg,.mpga,.m4a,.wav,.webm",showUploadList:!1,children:[(0,t.jsx)("p",{className:"ant-upload-drag-icon",children:(0,t.jsx)(y.SoundOutlined,{style:{fontSize:"24px",color:"#666"}})}),(0,t.jsx)("p",{className:"ant-upload-text text-sm",children:"Click or drag audio file to upload"}),(0,t.jsx)("p",{className:"ant-upload-hint text-xs text-gray-500",children:"Support for MP3, MP4, MPEG, MPGA, M4A, WAV, WEBM formats. Max file size: 25 MB."})]})}),to===ew.EndpointType.RESPONSES&&tO&&(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,t.jsx)("div",{className:"relative inline-block",children:tO.name.toLowerCase().endsWith(".pdf")?(0,t.jsx)("div",{className:"w-10 h-10 rounded-md bg-red-500 flex items-center justify-center",children:(0,t.jsx)(l.FilePdfOutlined,{style:{fontSize:"16px",color:"white"}})}):(0,t.jsx)("img",{src:tI||"",alt:"Upload preview",className:"w-10 h-10 rounded-md border border-gray-200 object-cover"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:tO.name}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:tO.name.toLowerCase().endsWith(".pdf")?"PDF":"Image"})]}),(0,t.jsx)("button",{className:"flex items-center justify-center w-6 h-6 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded-full transition-colors",onClick:su,children:(0,t.jsx)(o.DeleteOutlined,{style:{fontSize:"12px"}})})]})}),to===ew.EndpointType.CHAT&&tL&&(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,t.jsx)("div",{className:"relative inline-block",children:tL.name.toLowerCase().endsWith(".pdf")?(0,t.jsx)("div",{className:"w-10 h-10 rounded-md bg-red-500 flex items-center justify-center",children:(0,t.jsx)(l.FilePdfOutlined,{style:{fontSize:"16px",color:"white"}})}):(0,t.jsx)("img",{src:tU||"",alt:"Upload preview",className:"w-10 h-10 rounded-md border border-gray-200 object-cover"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:tL.name}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:tL.name.toLowerCase().endsWith(".pdf")?"PDF":"Image"})]}),(0,t.jsx)("button",{className:"flex items-center justify-center w-6 h-6 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded-full transition-colors",onClick:sm,children:(0,t.jsx)(o.DeleteOutlined,{style:{fontSize:"12px"}})})]})}),to===ew.EndpointType.RESPONSES&&t3.enabled&&(0,t.jsxs)("div",{className:"mb-2 space-y-2",children:[(0,t.jsxs)("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-200 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:tc?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.LoadingOutlined,{className:"text-blue-500",spin:!0}),(0,t.jsx)("span",{className:"text-sm text-blue-700 font-medium",children:"Running Python code..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.CodeOutlined,{className:"text-blue-500"}),(0,t.jsx)("span",{className:"text-sm text-blue-700 font-medium",children:"Code Interpreter Active"})]})}),(0,t.jsx)("button",{className:"text-xs text-blue-500 hover:text-blue-700",onClick:()=>t3.setEnabled(!1),children:"Disable"})]}),!tc&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:["Generate sample sales data CSV and create a chart","Create a PNG bar chart comparing AI gateway providers including LiteLLM","Generate a CSV of LLM pricing data and visualize it as a line chart"].map((e,s)=>(0,t.jsx)("button",{className:"text-xs px-3 py-1.5 bg-white border border-gray-200 rounded-full hover:bg-blue-50 hover:border-blue-300 hover:text-blue-600 transition-colors",onClick:()=>eq(e),children:e},s))})]}),0===eH.length&&!tc&&to!==ew.EndpointType.MCP&&(0,t.jsx)("div",{className:"flex items-center gap-2 mb-3 overflow-x-auto",children:(to===ew.EndpointType.A2A_AGENTS?["What can you help me with?","Tell me about yourself","What tasks can you perform?"]:["Write me a poem","Explain quantum computing","Draft a polite email requesting a meeting"]).map(e=>(0,t.jsx)("button",{type:"button",className:"shrink-0 rounded-full border border-gray-200 px-3 py-1 text-xs font-medium text-gray-600 transition-colors hover:bg-blue-50 hover:border-blue-300 hover:text-blue-600 cursor-pointer",onClick:()=>eq(e),children:e},e))}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center flex-1 bg-white border border-gray-300 rounded-xl px-3 py-1 min-h-[44px]",children:[(0,t.jsxs)("div",{className:"flex-shrink-0 mr-2 flex items-center gap-1",children:[to===ew.EndpointType.RESPONSES&&!tO&&(0,t.jsx)(e2,{responsesUploadedImage:tO,responsesImagePreviewUrl:tI,onImageUpload:e=>(tR(e),tM(URL.createObjectURL(e)),!1),onRemoveImage:su}),to===ew.EndpointType.CHAT&&!tL&&(0,t.jsx)(eO,{chatUploadedImage:tL,chatImagePreviewUrl:tU,onImageUpload:e=>(t$(e),tD(URL.createObjectURL(e)),!1),onRemoveImage:sm}),to===ew.EndpointType.RESPONSES&&(0,t.jsx)(O.Tooltip,{title:t3.enabled?"Code Interpreter enabled (click to disable)":"Enable Code Interpreter",children:(0,t.jsx)("button",{className:`p-1.5 rounded-md transition-colors ${t3.enabled?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,onClick:()=>{t3.toggle(),t3.enabled||W.default.success("Code Interpreter enabled!")},children:(0,t.jsx)(n.CodeOutlined,{style:{fontSize:"16px"}})})})]}),to===ew.EndpointType.MCP&&1===ep.length&&"__all__"!==ep[0]&&eS?(0,t.jsx)("div",{className:"flex-1 overflow-y-auto max-h-48 min-h-[44px] p-2 border border-gray-200 rounded-lg bg-gray-50/50",children:(ed=(ex[ep[0]]||[]).find(e=>e.name===eS))?(0,t.jsx)(F.default,{ref:eC,tool:ed,className:"space-y-2"}):(0,t.jsx)("div",{className:"flex items-center justify-center h-10 text-sm text-gray-500",children:"Loading tool schema..."})}):(0,t.jsx)(ts,{value:eB,onChange:e=>eq(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),sh())},placeholder:to===ew.EndpointType.CHAT||to===ew.EndpointType.EMBEDDINGS||to===ew.EndpointType.RESPONSES||to===ew.EndpointType.ANTHROPIC_MESSAGES?"Type your message... (Shift+Enter for new line)":to===ew.EndpointType.A2A_AGENTS?"Send a message to the A2A agent...":to===ew.EndpointType.IMAGE_EDITS?"Describe how you want to edit the image...":to===ew.EndpointType.SPEECH?"Enter text to convert to speech...":to===ew.EndpointType.TRANSCRIPTION?"Optional: Add context or prompt for transcription...":"Describe the image you want to generate...",disabled:tc,className:"flex-1",autoSize:{minRows:1,maxRows:4},style:{resize:"none",border:"none",boxShadow:"none",background:"transparent",padding:"4px 0",fontSize:"14px",lineHeight:"20px"}}),(0,t.jsx)(N.Button,{onClick:sh,disabled:tc||(to===ew.EndpointType.MCP?!(1===ep.length&&"__all__"!==ep[0]&&eS):to===ew.EndpointType.TRANSCRIPTION?!tB:!eB.trim()),className:"flex-shrink-0 ml-2 !w-8 !h-8 !min-w-8 !p-0 !rounded-full !bg-blue-600 hover:!bg-blue-700 disabled:!bg-gray-300 !border-none !text-white disabled:!text-gray-500 !flex !items-center !justify-center",children:(0,t.jsx)(r.ArrowUpOutlined,{style:{fontSize:"14px"}})})]}),tc&&(0,t.jsx)(N.Button,{onClick:()=>{tu.current&&(tu.current.abort(),tu.current=null,td(!1),W.default.info("Request cancelled"))},className:"bg-red-50 hover:bg-red-100 text-red-600 border-red-200",icon:o.DeleteOutlined,children:"Cancel"})]})]})]})})]})}),(0,t.jsxs)(C.Modal,{title:"Generated Code",open:tz,onCancel:()=>tF(!1),footer:null,width:800,children:[(0,t.jsxs)("div",{className:"flex justify-between items-end my-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Text,{className:"font-medium block mb-1 text-gray-700",children:"SDK Type"}),(0,t.jsx)(A.Select,{value:tJ,onChange:e=>tG(e),style:{width:150},options:[{value:"openai",label:"OpenAI SDK"},{value:"azure",label:"Azure SDK"}]})]}),(0,t.jsx)(k.Button,{onClick:()=>{navigator.clipboard.writeText(tW),W.default.success("Copied to clipboard!")},children:"Copy to Clipboard"})]}),(0,t.jsx)($.Prism,{language:"python",style:U.coy,wrapLines:!0,wrapLongLines:!0,className:"rounded-md",customStyle:{maxHeight:"60vh",overflowY:"auto"},children:tW})]})]})}],220486)}]);