(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1900:function(e,l,s){Promise.resolve().then(s.bind(s,14164))},12011:function(e,l,s){"use strict";s.r(l),s.d(l,{default:function(){return y}});var t=s(57437),a=s(2265),r=s(99376),i=s(20831),n=s(94789),o=s(12514),d=s(49804),c=s(67101),m=s(84264),u=s(49566),h=s(96761),x=s(84566),p=s(19250),g=s(14474),j=s(13634),f=s(73002),_=s(3914);function y(){let[e]=j.Z.useForm(),l=(0,r.useSearchParams)();(0,_.e)("token");let s=l.get("invitation_id"),[y,v]=(0,a.useState)(null),[b,Z]=(0,a.useState)(""),[N,w]=(0,a.useState)(""),[k,S]=(0,a.useState)(null),[C,I]=(0,a.useState)(""),[A,E]=(0,a.useState)("");return(0,a.useEffect)(()=>{s&&(0,p.W_)(s).then(e=>{let l=e.login_url;console.log("login_url:",l),I(l);let s=e.token,t=(0,g.o)(s);E(s),console.log("decoded:",t),v(t.key),console.log("decoded user email:",t.user_email),w(t.user_email),S(t.user_id)})},[s]),(0,t.jsx)("div",{className:"mx-auto w-full max-w-md mt-10",children:(0,t.jsxs)(o.Z,{children:[(0,t.jsx)(h.Z,{className:"text-sm mb-5 text-center",children:"\uD83D\uDE85 LiteLLM"}),(0,t.jsx)(h.Z,{className:"text-xl",children:"Sign up"}),(0,t.jsx)(m.Z,{children:"Claim your user account to login to Admin UI."}),(0,t.jsx)(n.Z,{className:"mt-4",title:"SSO",icon:x.GH$,color:"sky",children:(0,t.jsxs)(c.Z,{numItems:2,className:"flex justify-between items-center",children:[(0,t.jsx)(d.Z,{children:"SSO is under the Enterprise Tirer."}),(0,t.jsx)(d.Z,{children:(0,t.jsx)(i.Z,{variant:"primary",className:"mb-2",children:(0,t.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"Get Free Trial"})})})]})}),(0,t.jsxs)(j.Z,{className:"mt-10 mb-5 mx-auto",layout:"vertical",onFinish:e=>{console.log("in handle submit. accessToken:",y,"token:",A,"formValues:",e),y&&A&&(e.user_email=N,k&&s&&(0,p.m_)(y,s,k,e.password).then(e=>{var l;let s="/ui/";s+="?userID="+((null===(l=e.data)||void 0===l?void 0:l.user_id)||e.user_id),document.cookie="token="+A,console.log("redirecting to:",s),window.location.href=s}))},children:[(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Z.Item,{label:"Email Address",name:"user_email",children:(0,t.jsx)(u.Z,{type:"email",disabled:!0,value:N,defaultValue:N,className:"max-w-md"})}),(0,t.jsx)(j.Z.Item,{label:"Password",name:"password",rules:[{required:!0,message:"password required to sign up"}],help:"Create a password for your account",children:(0,t.jsx)(u.Z,{placeholder:"",type:"password",className:"max-w-md"})})]}),(0,t.jsx)("div",{className:"mt-10",children:(0,t.jsx)(f.ZP,{htmlType:"submit",children:"Sign Up"})})]})]})})}},14164:function(e,l,s){"use strict";s.r(l),s.d(l,{default:function(){return tA}});var t,a,r=s(57437),i=s(2265),n=s(99376),o=s(14474),d=s(90946),c=s(29827),m=s(27648),u=s(80795),h=s(15883),x=s(40428),p=s(3914),g=s(19250);let j=async e=>{if(!e)return null;try{return await (0,g.g)(e)}catch(e){return console.error("Error fetching proxy settings:",e),null}};var f=e=>{let{userID:l,userEmail:s,userRole:t,premiumUser:a,proxySettings:n,setProxySettings:o,accessToken:d}=e,[c,g]=(0,i.useState)("");(0,i.useEffect)(()=>{(async()=>{if(d){let e=await j(d);console.log("response from fetchProxySettings",e),e&&o(e)}})()},[d]),(0,i.useEffect)(()=>{g((null==n?void 0:n.PROXY_LOGOUT_URL)||"")},[n]);let f=[{key:"1",label:(0,r.jsxs)("div",{className:"py-1",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Role: ",t]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Email: ",s||"Unknown"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,r.jsx)(h.Z,{})," ",l]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Premium User: ",String(a)]})]})},{key:"2",label:(0,r.jsxs)("p",{className:"text-sm hover:text-gray-900",onClick:()=>{(0,p.b)(),window.location.href=c},children:[(0,r.jsx)(x.Z,{})," Logout"]})}];return(0,r.jsx)("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsxs)("div",{className:"flex items-center h-12 px-4",children:[(0,r.jsx)("div",{className:"flex items-center flex-shrink-0",children:(0,r.jsx)(m.default,{href:"/",className:"flex items-center",children:(0,r.jsx)("img",{src:"/get_image",alt:"LiteLLM Brand",className:"h-8 w-auto"})})}),(0,r.jsxs)("div",{className:"flex items-center space-x-5 ml-auto",children:[(0,r.jsx)("a",{href:"https://docs.litellm.ai/docs/",target:"_blank",rel:"noopener noreferrer",className:"text-[13px] text-gray-600 hover:text-gray-900 transition-colors",children:"Docs"}),(0,r.jsx)(u.Z,{menu:{items:f,style:{padding:"4px",marginTop:"4px"}},children:(0,r.jsxs)("button",{className:"inline-flex items-center text-[13px] text-gray-600 hover:text-gray-900 transition-colors",children:["User",(0,r.jsx)("svg",{className:"ml-1 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 9l-7 7-7-7"})})]})})]})]})})})};let _=async(e,l,s,t,a)=>{let r;r="Admin"!=s&&"Admin Viewer"!=s?await (0,g.It)(e,(null==t?void 0:t.organization_id)||null,l):await (0,g.It)(e,(null==t?void 0:t.organization_id)||null),console.log("givenTeams: ".concat(r)),a(r)};var y=s(49804),v=s(67101),b=s(20831),Z=s(49566),N=s(87452),w=s(88829),k=s(72208),S=s(84264),C=s(96761),I=s(29233),A=s(52787),E=s(13634),P=s(41021),O=s(51369),T=s(29967),L=s(73002),M=s(20577),D=s(56632);let F=async(e,l,s)=>{try{if(null===e||null===l)return;if(null!==s){let t=(await (0,g.So)(s,e,l,!0)).data.map(e=>e.id),a=[],r=[];return t.forEach(e=>{e.endsWith("/*")?a.push(e):r.push(e)}),[...a,...r]}}catch(e){console.error("Error fetching user models:",e)}},R=e=>{if(e.endsWith("/*")){let l=e.replace("/*","");return"All ".concat(l," models")}return e},U=(e,l)=>{let s=[],t=[];return console.log("teamModels",e),console.log("allModels",l),e.forEach(e=>{if(e.endsWith("/*")){let a=e.replace("/*",""),r=l.filter(e=>e.startsWith(a+"/"));t.push(...r),s.push(e)}else t.push(e)}),[...s,...t].filter((e,l,s)=>s.indexOf(e)===l)};var z=s(15424),V=s(75957);let q=(e,l)=>["metadata","config","enforced_params","aliases"].includes(e)||"json"===l.format,K=e=>{if(!e)return!0;try{return JSON.parse(e),!0}catch(e){return!1}},B=(e,l,s)=>{let t={max_budget:"Enter maximum budget in USD (e.g., 100.50)",budget_duration:"Select a time period for budget reset",tpm_limit:"Enter maximum tokens per minute (whole number)",rpm_limit:"Enter maximum requests per minute (whole number)",duration:"Enter duration (e.g., 30s, 24h, 7d)",metadata:'Enter JSON object with key-value pairs\nExample: {"team": "research", "project": "nlp"}',config:'Enter configuration as JSON object\nExample: {"setting": "value"}',permissions:"Enter comma-separated permission strings",enforced_params:'Enter parameters as JSON object\nExample: {"param": "value"}',blocked:"Enter true/false or specific block conditions",aliases:'Enter aliases as JSON object\nExample: {"alias1": "value1", "alias2": "value2"}',models:"Select one or more model names",key_alias:"Enter a unique identifier for this key",tags:"Enter comma-separated tag strings"}[e]||({string:"Text input",number:"Numeric input",integer:"Whole number input",boolean:"True/False value"})[s]||"Text input";return q(e,l)?"".concat(t,"\nMust be valid JSON format"):l.enum?"Select from available options\nAllowed values: ".concat(l.enum.join(", ")):t};var H=e=>{let{schemaComponent:l,excludedFields:s=[],form:t,overrideLabels:a={},overrideTooltips:n={},customValidation:o={},defaultValues:d={}}=e,[c,m]=(0,i.useState)(null),[u,h]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{try{let e=(await (0,g.lP)()).components.schemas[l];if(!e)throw Error('Schema component "'.concat(l,'" not found'));m(e);let a={};Object.keys(e.properties).filter(e=>!s.includes(e)&&void 0!==d[e]).forEach(e=>{a[e]=d[e]}),t.setFieldsValue(a)}catch(e){console.error("Schema fetch error:",e),h(e instanceof Error?e.message:"Failed to fetch schema")}})()},[l,t,s]);let x=e=>{if(e.type)return e.type;if(e.anyOf){let l=e.anyOf.map(e=>e.type);if(l.includes("number")||l.includes("integer"))return"number";l.includes("string")}return"string"},p=(e,l)=>{var s;let t;let i=x(l),m=null==c?void 0:null===(s=c.required)||void 0===s?void 0:s.includes(e),u=a[e]||l.title||e,h=n[e]||l.description,p=[];m&&p.push({required:!0,message:"".concat(u," is required")}),o[e]&&p.push({validator:o[e]}),q(e,l)&&p.push({validator:async(e,l)=>{if(l&&!K(l))throw Error("Please enter valid JSON")}});let g=h?(0,r.jsxs)("span",{children:[u," ",(0,r.jsx)(V.Z,{title:h,children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}):u;return t=q(e,l)?(0,r.jsx)(D.Z.TextArea,{rows:4,placeholder:"Enter as JSON",className:"font-mono"}):l.enum?(0,r.jsx)(A.default,{children:l.enum.map(e=>(0,r.jsx)(A.default.Option,{value:e,children:e},e))}):"number"===i||"integer"===i?(0,r.jsx)(M.Z,{style:{width:"100%"},precision:"integer"===i?0:void 0}):"duration"===e?(0,r.jsx)(Z.Z,{placeholder:"eg: 30s, 30h, 30d"}):(0,r.jsx)(Z.Z,{placeholder:h||""}),(0,r.jsx)(E.Z.Item,{label:g,name:e,className:"mt-8",rules:p,initialValue:d[e],help:(0,r.jsx)("div",{className:"text-xs text-gray-500",children:B(e,l,i)}),children:t},e)};return u?(0,r.jsxs)("div",{className:"text-red-500",children:["Error: ",u]}):(null==c?void 0:c.properties)?(0,r.jsx)("div",{children:Object.entries(c.properties).filter(e=>{let[l]=e;return!s.includes(l)}).map(e=>{let[l,s]=e;return p(l,s)})}):null},J=e=>{let{teams:l,value:s,onChange:t}=e;return(0,r.jsx)(A.default,{showSearch:!0,placeholder:"Search or select a team",value:s,onChange:t,filterOption:(e,l)=>{var s,t,a;return!!l&&((null===(a=l.children)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:null===(s=t.props)||void 0===s?void 0:s.children)||"").toLowerCase().includes(e.toLowerCase())},optionFilterProp:"children",children:null==l?void 0:l.map(e=>(0,r.jsxs)(A.default.Option,{value:e.team_id,children:[(0,r.jsx)("span",{className:"font-medium",children:e.team_alias})," ",(0,r.jsxs)("span",{className:"text-gray-500",children:["(",e.team_id,")"]})]},e.team_id))})},W=s(57365),G=s(93192);function Y(e){let{isInvitationLinkModalVisible:l,setIsInvitationLinkModalVisible:s,baseUrl:t,invitationLinkData:a}=e,{Title:i,Paragraph:n}=G.default,o=()=>(null==a?void 0:a.has_user_setup_sso)?new URL("/ui",t).toString():new URL("/ui?invitation_id=".concat(null==a?void 0:a.id),t).toString();return(0,r.jsxs)(O.Z,{title:"Invitation Link",visible:l,width:800,footer:null,onOk:()=>{s(!1)},onCancel:()=>{s(!1)},children:[(0,r.jsx)(n,{children:"Copy and send the generated link to onboard this user to the proxy."}),(0,r.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,r.jsx)(S.Z,{className:"text-base",children:"User ID"}),(0,r.jsx)(S.Z,{children:null==a?void 0:a.user_id})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,r.jsx)(S.Z,{children:"Invitation Link"}),(0,r.jsx)(S.Z,{children:(0,r.jsx)(S.Z,{children:o()})})]}),(0,r.jsx)("div",{className:"flex justify-end mt-5",children:(0,r.jsx)(I.CopyToClipboard,{text:o(),onCopy:()=>P.ZP.success("Copied!"),children:(0,r.jsx)(b.Z,{variant:"primary",children:"Copy invitation link"})})})]})}var $=s(30967),X=s(28181),Q=s(73879),ee=s(3632),el=s(15452),es=s.n(el),et=s(71157),ea=s(44643),er=e=>{let{accessToken:l,teams:s,possibleUIRoles:t,onUsersCreated:a}=e,[n,o]=(0,i.useState)(!1),[d,c]=(0,i.useState)([]),[m,u]=(0,i.useState)(!1),[h,x]=(0,i.useState)(null),[p,j]=(0,i.useState)(null),[f,_]=(0,i.useState)("http://localhost:4000");(0,i.useEffect)(()=>{(async()=>{try{let e=await (0,g.g)(l);j(e)}catch(e){console.error("Error fetching UI settings:",e)}})(),_(new URL("/",window.location.href).toString())},[l]);let y=async()=>{u(!0);let e=d.map(e=>({...e,status:"pending"}));c(e);let s=!1;for(let a=0;a<e.length;a++){var t,r,i;let n=e[a];try{let e={...n};e.teams&&"string"==typeof e.teams&&(e.teams=e.teams.split(",").map(e=>e.trim())),e.models&&"string"==typeof e.models&&(e.models=e.models.split(",").map(e=>e.trim())),e.max_budget&&""!==e.max_budget.toString().trim()&&(e.max_budget=parseFloat(e.max_budget.toString()));let r=await (0,g.Ov)(l,null,e);if(console.log("Full response:",r),r&&(r.key||r.user_id)){s=!0,console.log("Success case triggered");let e=(null===(t=r.data)||void 0===t?void 0:t.user_id)||r.user_id;try{if(null==p?void 0:p.SSO_ENABLED){let e=new URL("/ui",f).toString();c(l=>l.map((l,s)=>s===a?{...l,status:"success",key:r.key||r.user_id,invitation_link:e}:l))}else{let s=await (0,g.XO)(l,e),t=new URL("/ui?invitation_id=".concat(s.id),f).toString();c(e=>e.map((e,l)=>l===a?{...e,status:"success",key:r.key||r.user_id,invitation_link:t}:e))}}catch(e){console.error("Error creating invitation:",e),c(e=>e.map((e,l)=>l===a?{...e,status:"success",key:r.key||r.user_id,error:"User created but failed to generate invitation link"}:e))}}else{console.log("Error case triggered");let e=(null==r?void 0:r.error)||"Failed to create user";console.log("Error message:",e),c(l=>l.map((l,s)=>s===a?{...l,status:"failed",error:e}:l))}}catch(l){console.error("Caught error:",l);let e=(null==l?void 0:null===(i=l.response)||void 0===i?void 0:null===(r=i.data)||void 0===r?void 0:r.error)||(null==l?void 0:l.message)||String(l);c(l=>l.map((l,s)=>s===a?{...l,status:"failed",error:e}:l))}}u(!1),s&&a&&a()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.Z,{className:"mx-auto mb-0",onClick:()=>o(!0),children:"+ Bulk Invite Users"}),(0,r.jsx)(O.Z,{title:"Bulk Invite Users",visible:n,width:800,onCancel:()=>o(!1),bodyStyle:{maxHeight:"70vh",overflow:"auto"},footer:null,children:(0,r.jsx)("div",{className:"flex flex-col",children:0===d.length?(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"1"}),(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Download and fill the template"})]}),(0,r.jsxs)("div",{className:"ml-11 mb-6",children:[(0,r.jsx)("p",{className:"mb-4",children:"Add multiple users at once by following these steps:"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside space-y-2 ml-2 mb-4",children:[(0,r.jsx)("li",{children:"Download our CSV template"}),(0,r.jsx)("li",{children:"Add your users' information to the spreadsheet"}),(0,r.jsx)("li",{children:"Save the file and upload it here"}),(0,r.jsx)("li",{children:"After creation, download the results file containing the API keys for each user"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200 mb-4",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Template Column Names"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"user_email"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"User's email address (required)"})]})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"user_role"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:'User\'s role (one of: "proxy_admin", "proxy_admin_view_only", "internal_user", "internal_user_view_only")'})]})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"teams"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated team IDs (e.g., "team-1,team-2")'})]})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"max_budget"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:'Maximum budget as a number (e.g., "100")'})]})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"budget_duration"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:'Budget reset period (e.g., "30d", "1mo")'})]})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"models"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated allowed models (e.g., "gpt-3.5-turbo,gpt-4")'})]})]})]})]}),(0,r.jsxs)(b.Z,{onClick:()=>{let e=new Blob([es().unparse([["user_email","user_role","teams","max_budget","budget_duration","models"],["user@example.com","internal_user","team-id-1,team-id-2","100","30d","gpt-3.5-turbo,gpt-4"]])],{type:"text/csv"}),l=window.URL.createObjectURL(e),s=document.createElement("a");s.href=l,s.download="bulk_users_template.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(l)},size:"lg",className:"w-full md:w-auto",children:[(0,r.jsx)(Q.Z,{className:"mr-2"})," Download CSV Template"]})]}),(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"2"}),(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Upload your completed CSV"})]}),(0,r.jsx)("div",{className:"ml-11",children:(0,r.jsx)($.Z,{beforeUpload:e=>(x(null),es().parse(e,{complete:e=>{let l=e.data[0],s=["user_email","user_role"].filter(e=>!l.includes(e));if(s.length>0){x("Your CSV is missing these required columns: ".concat(s.join(", "))),c([]);return}try{let s=e.data.slice(1).map((e,s)=>{var t,a,r,i,n,o;let d={user_email:(null===(t=e[l.indexOf("user_email")])||void 0===t?void 0:t.trim())||"",user_role:(null===(a=e[l.indexOf("user_role")])||void 0===a?void 0:a.trim())||"",teams:null===(r=e[l.indexOf("teams")])||void 0===r?void 0:r.trim(),max_budget:null===(i=e[l.indexOf("max_budget")])||void 0===i?void 0:i.trim(),budget_duration:null===(n=e[l.indexOf("budget_duration")])||void 0===n?void 0:n.trim(),models:null===(o=e[l.indexOf("models")])||void 0===o?void 0:o.trim(),rowNumber:s+2,isValid:!0,error:""},c=[];d.user_email||c.push("Email is required"),d.user_role||c.push("Role is required"),d.user_email&&!d.user_email.includes("@")&&c.push("Invalid email format");let m=["proxy_admin","proxy_admin_view_only","internal_user","internal_user_view_only"];return d.user_role&&!m.includes(d.user_role)&&c.push("Invalid role. Must be one of: ".concat(m.join(", "))),d.max_budget&&isNaN(parseFloat(d.max_budget.toString()))&&c.push("Max budget must be a number"),c.length>0&&(d.isValid=!1,d.error=c.join(", ")),d}),t=s.filter(e=>e.isValid);c(s),0===t.length?x("No valid users found in the CSV. Please check the errors below."):t.length<s.length?x("Found ".concat(s.length-t.length," row(s) with errors. Please correct them before proceeding.")):P.ZP.success("Successfully parsed ".concat(t.length," users"))}catch(l){let e=l instanceof Error?l.message:"Unknown error";x("Error parsing CSV: ".concat(e)),c([])}},error:e=>{x("Failed to parse CSV file: ".concat(e.message)),c([])},header:!1}),!1),accept:".csv",maxCount:1,showUploadList:!1,children:(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-colors cursor-pointer",children:[(0,r.jsx)(ee.Z,{className:"text-3xl text-gray-400 mb-2"}),(0,r.jsx)("p",{className:"mb-1",children:"Drag and drop your CSV file here"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"or"}),(0,r.jsx)(b.Z,{size:"sm",children:"Browse files"})]})})})]}):(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"3"}),(0,r.jsx)("h3",{className:"text-lg font-medium",children:d.some(e=>"success"===e.status||"failed"===e.status)?"User Creation Results":"Review and create users"})]}),h&&(0,r.jsx)("div",{className:"ml-11 mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:(0,r.jsx)(S.Z,{className:"text-red-600 font-medium",children:h})}),(0,r.jsxs)("div",{className:"ml-11",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,r.jsx)("div",{className:"flex items-center",children:d.some(e=>"success"===e.status||"failed"===e.status)?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(S.Z,{className:"text-lg font-medium mr-3",children:"Creation Summary"}),(0,r.jsxs)(S.Z,{className:"text-sm bg-green-100 text-green-800 px-2 py-1 rounded mr-2",children:[d.filter(e=>"success"===e.status).length," Successful"]}),d.some(e=>"failed"===e.status)&&(0,r.jsxs)(S.Z,{className:"text-sm bg-red-100 text-red-800 px-2 py-1 rounded",children:[d.filter(e=>"failed"===e.status).length," Failed"]})]}):(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(S.Z,{className:"text-lg font-medium mr-3",children:"User Preview"}),(0,r.jsxs)(S.Z,{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded",children:[d.filter(e=>e.isValid).length," of ",d.length," users valid"]})]})}),!d.some(e=>"success"===e.status||"failed"===e.status)&&(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)(b.Z,{onClick:()=>{c([]),x(null)},variant:"secondary",children:"Back"}),(0,r.jsx)(b.Z,{onClick:y,disabled:0===d.filter(e=>e.isValid).length||m,children:m?"Creating...":"Create ".concat(d.filter(e=>e.isValid).length," Users")})]})]}),d.some(e=>"success"===e.status)&&(0,r.jsx)("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"mr-3 mt-1",children:(0,r.jsx)(ea.Z,{className:"h-5 w-5 text-blue-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium text-blue-800",children:"User creation complete"}),(0,r.jsxs)(S.Z,{className:"block text-sm text-blue-700 mt-1",children:[(0,r.jsx)("span",{className:"font-medium",children:"Next step:"})," Download the credentials file containing API keys and invitation links. Users will need these API keys to make LLM requests through LiteLLM."]})]})]})}),(0,r.jsx)(X.Z,{dataSource:d,columns:[{title:"Row",dataIndex:"rowNumber",key:"rowNumber",width:80},{title:"Email",dataIndex:"user_email",key:"user_email"},{title:"Role",dataIndex:"user_role",key:"user_role"},{title:"Teams",dataIndex:"teams",key:"teams"},{title:"Budget",dataIndex:"max_budget",key:"max_budget"},{title:"Status",key:"status",render:(e,l)=>l.isValid?l.status&&"pending"!==l.status?"success"===l.status?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(ea.Z,{className:"h-5 w-5 text-green-500 mr-2"}),(0,r.jsx)("span",{className:"text-green-500",children:"Success"})]}),l.invitation_link&&(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:l.invitation_link}),(0,r.jsx)(I.CopyToClipboard,{text:l.invitation_link,onCopy:()=>P.ZP.success("Invitation link copied!"),children:(0,r.jsx)("button",{className:"ml-1 text-blue-500 text-xs hover:text-blue-700",children:"Copy"})})]})})]}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(et.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,r.jsx)("span",{className:"text-red-500",children:"Failed"})]}),l.error&&(0,r.jsx)("span",{className:"text-sm text-red-500 ml-7",children:JSON.stringify(l.error)})]}):(0,r.jsx)("span",{className:"text-gray-500",children:"Pending"}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(et.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,r.jsx)("span",{className:"text-red-500",children:"Invalid"})]}),l.error&&(0,r.jsx)("span",{className:"text-sm text-red-500 ml-7",children:l.error})]})}],size:"small",pagination:{pageSize:5},scroll:{y:300},rowClassName:e=>e.isValid?"":"bg-red-50"}),!d.some(e=>"success"===e.status||"failed"===e.status)&&(0,r.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,r.jsx)(b.Z,{onClick:()=>{c([]),x(null)},variant:"secondary",className:"mr-3",children:"Back"}),(0,r.jsx)(b.Z,{onClick:y,disabled:0===d.filter(e=>e.isValid).length||m,children:m?"Creating...":"Create ".concat(d.filter(e=>e.isValid).length," Users")})]}),d.some(e=>"success"===e.status||"failed"===e.status)&&(0,r.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,r.jsx)(b.Z,{onClick:()=>{c([]),x(null)},variant:"secondary",className:"mr-3",children:"Start New Bulk Import"}),(0,r.jsxs)(b.Z,{onClick:()=>{let e=d.map(e=>({user_email:e.user_email,user_role:e.user_role,status:e.status,key:e.key||"",invitation_link:e.invitation_link||"",error:e.error||""})),l=new Blob([es().unparse(e)],{type:"text/csv"}),s=window.URL.createObjectURL(l),t=document.createElement("a");t.href=s,t.download="bulk_users_results.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(s)},variant:"primary",className:"flex items-center",children:[(0,r.jsx)(Q.Z,{className:"mr-2"})," Download User Credentials"]})]})]})]})})})]})};let{Option:ei}=A.default;var en=e=>{let{userID:l,accessToken:s,teams:t,possibleUIRoles:a,onUserCreated:o,isEmbedded:d=!1}=e,[c,m]=(0,i.useState)(null),[u]=E.Z.useForm(),[h,x]=(0,i.useState)(!1),[p,j]=(0,i.useState)(null),[f,_]=(0,i.useState)([]),[y,v]=(0,i.useState)(!1),[I,T]=(0,i.useState)(null),M=(0,n.useRouter)(),[F,U]=(0,i.useState)("http://localhost:4000");(0,i.useEffect)(()=>{(async()=>{try{let e=await (0,g.So)(s,l,"any"),t=[];for(let l=0;l<e.data.length;l++){let s=e.data[l];t.push(s.id)}console.log("Model data response:",e.data),console.log("Available models:",t),_(t);let a=await (0,g.g)(s);console.log("uiSettingsResponse:",a),m(a)}catch(e){console.error("Error fetching model data:",e)}})()},[]),(0,i.useEffect)(()=>{M&&U(new URL("/",window.location.href).toString())},[M]);let q=async e=>{var t,a,r;try{P.ZP.info("Making API Call"),d||x(!0),e.models&&0!==e.models.length||(e.models=["no-default-models"]),console.log("formValues in create user:",e);let a=await (0,g.Ov)(s,null,e);console.log("user create Response:",a),j(a.key);let r=(null===(t=a.data)||void 0===t?void 0:t.user_id)||a.user_id;if(o&&d){o(r),u.resetFields();return}if(null==c?void 0:c.SSO_ENABLED){let e={id:crypto.randomUUID(),user_id:r,is_accepted:!1,accepted_at:null,expires_at:new Date(Date.now()+6048e5),created_at:new Date,created_by:l,updated_at:new Date,updated_by:l,has_user_setup_sso:!0};T(e),v(!0)}else(0,g.XO)(s,r).then(e=>{e.has_user_setup_sso=!1,T(e),v(!0)});P.ZP.success("API user Created"),u.resetFields(),localStorage.removeItem("userData"+l)}catch(l){let e=(null===(r=l.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.detail)||(null==l?void 0:l.message)||"Error creating the user";P.ZP.error(e),console.error("Error creating the user:",l)}};return d?(0,r.jsxs)(E.Z,{form:u,onFinish:q,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsx)(E.Z.Item,{label:"User Email",name:"user_email",children:(0,r.jsx)(Z.Z,{placeholder:""})}),(0,r.jsx)(E.Z.Item,{label:"User Role",name:"user_role",children:(0,r.jsx)(A.default,{children:a&&Object.entries(a).map(e=>{let[l,{ui_label:s,description:t}]=e;return(0,r.jsx)(W.Z,{value:l,title:s,children:(0,r.jsxs)("div",{className:"flex",children:[s," ",(0,r.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:t})]})},l)})})}),(0,r.jsx)(E.Z.Item,{label:"Team ID",name:"team_id",children:(0,r.jsx)(A.default,{placeholder:"Select Team ID",style:{width:"100%"},children:t?t.map(e=>(0,r.jsx)(ei,{value:e.team_id,children:e.team_alias},e.team_id)):(0,r.jsx)(ei,{value:null,children:"Default Team"},"default")})}),(0,r.jsx)(E.Z.Item,{label:"Metadata",name:"metadata",children:(0,r.jsx)(D.Z.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Create User"})})]}):(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(b.Z,{className:"mx-auto mb-0",onClick:()=>x(!0),children:"+ Invite User"}),(0,r.jsx)(er,{accessToken:s,teams:t,possibleUIRoles:a}),(0,r.jsxs)(O.Z,{title:"Invite User",visible:h,width:800,footer:null,onOk:()=>{x(!1),u.resetFields()},onCancel:()=>{x(!1),j(null),u.resetFields()},children:[(0,r.jsx)(S.Z,{className:"mb-1",children:"Create a User who can own keys"}),(0,r.jsxs)(E.Z,{form:u,onFinish:q,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsx)(E.Z.Item,{label:"User Email",name:"user_email",children:(0,r.jsx)(Z.Z,{placeholder:""})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Global Proxy Role"," ",(0,r.jsx)(V.Z,{title:"This is the role that the user will globally on the proxy. This role is independent of any team/org specific roles.",children:(0,r.jsx)(z.Z,{})})]}),name:"user_role",children:(0,r.jsx)(A.default,{children:a&&Object.entries(a).map(e=>{let[l,{ui_label:s,description:t}]=e;return(0,r.jsx)(W.Z,{value:l,title:s,children:(0,r.jsxs)("div",{className:"flex",children:[s," ",(0,r.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:t})]})},l)})})}),(0,r.jsx)(E.Z.Item,{label:"Team ID",className:"gap-2",name:"team_id",help:"If selected, user will be added as a 'user' role to the team.",children:(0,r.jsx)(A.default,{placeholder:"Select Team ID",style:{width:"100%"},children:t?t.map(e=>(0,r.jsx)(ei,{value:e.team_id,children:e.team_alias},e.team_id)):(0,r.jsx)(ei,{value:null,children:"Default Team"},"default")})}),(0,r.jsx)(E.Z.Item,{label:"Metadata",name:"metadata",children:(0,r.jsx)(D.Z.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(k.Z,{children:(0,r.jsx)(C.Z,{children:"Personal Key Creation"})}),(0,r.jsx)(w.Z,{children:(0,r.jsx)(E.Z.Item,{className:"gap-2",label:(0,r.jsxs)("span",{children:["Models"," ",(0,r.jsx)(V.Z,{title:"Models user has access to, outside of team scope.",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"models",help:"Models user has access to, outside of team scope.",children:(0,r.jsxs)(A.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,r.jsx)(A.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),f.map(e=>(0,r.jsx)(A.default.Option,{value:e,children:R(e)},e))]})})})]}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Create User"})})]})]}),p&&(0,r.jsx)(Y,{isInvitationLinkModalVisible:y,setIsInvitationLinkModalVisible:v,baseUrl:F,invitationLinkData:I})]})},eo=s(7310),ed=s.n(eo);let ec=["Admin","Admin Viewer","proxy_admin","proxy_admin_viewer","org_admin"],em=["Internal User","Internal Viewer"],eu=["Internal User","Admin"],{Option:eh}=A.default,ex=e=>e?({"24h":"daily","7d":"weekly","30d":"monthly"})[e]||e:"Not set";var ep=e=>{let{value:l,onChange:s,className:t="",style:a={}}=e;return(0,r.jsxs)(A.default,{style:{width:"100%",...a},value:l||void 0,onChange:s,className:t,placeholder:"n/a",children:[(0,r.jsx)(eh,{value:"24h",children:"daily"}),(0,r.jsx)(eh,{value:"7d",children:"weekly"}),(0,r.jsx)(eh,{value:"30d",children:"monthly"})]})};let{Option:eg}=A.default,ej=e=>{let l=[];if(console.log("data:",JSON.stringify(e)),e)for(let s of e)s.metadata&&s.metadata.tags&&l.push(...s.metadata.tags);let s=Array.from(new Set(l)).map(e=>({value:e,label:e}));return console.log("uniqueTags:",s),s},ef=async(e,l,s,t)=>{try{if(null===e||null===l)return[];if(null!==s){let a=(await (0,g.So)(s,e,l,!0,t)).data.map(e=>e.id);return console.log("available_model_names:",a),a}return[]}catch(e){return console.error("Error fetching user models:",e),[]}},e_=async(e,l,s,t)=>{try{if(null===e||null===l)return;if(null!==s){let a=(await (0,g.So)(s,e,l)).data.map(e=>e.id);console.log("available_model_names:",a),t(a)}}catch(e){console.error("Error fetching user models:",e)}};var ey=e=>{let{userID:l,team:s,teams:t,userRole:a,accessToken:n,data:o,setData:d}=e,[c]=E.Z.useForm(),[m,u]=(0,i.useState)(!1),[h,x]=(0,i.useState)(null),[p,j]=(0,i.useState)(null),[f,_]=(0,i.useState)([]),[F,U]=(0,i.useState)([]),[q,K]=(0,i.useState)("you"),[B,W]=(0,i.useState)(ej(o)),[G,Y]=(0,i.useState)([]),[$,X]=(0,i.useState)(s),[Q,ee]=(0,i.useState)(!1),[el,es]=(0,i.useState)(null),[et,ea]=(0,i.useState)({}),[er,ei]=(0,i.useState)([]),[eo,ec]=(0,i.useState)(!1),em=()=>{u(!1),c.resetFields()},eh=()=>{u(!1),x(null),c.resetFields()};(0,i.useEffect)(()=>{l&&a&&n&&e_(l,a,n,_)},[n,l,a]),(0,i.useEffect)(()=>{(async()=>{try{let e=(await (0,g.t3)(n)).guardrails.map(e=>e.guardrail_name);Y(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})()},[n]),(0,i.useEffect)(()=>{(async()=>{try{if(n){let e=sessionStorage.getItem("possibleUserRoles");if(e)ea(JSON.parse(e));else{let e=await (0,g.lg)(n);sessionStorage.setItem("possibleUserRoles",JSON.stringify(e)),ea(e)}}}catch(e){console.error("Error fetching possible user roles:",e)}})()},[n]);let ex=async e=>{try{var s,t,a;let r=null!==(s=null==e?void 0:e.key_alias)&&void 0!==s?s:"",i=null!==(t=null==e?void 0:e.team_id)&&void 0!==t?t:null;if((null!==(a=null==o?void 0:o.filter(e=>e.team_id===i).map(e=>e.key_alias))&&void 0!==a?a:[]).includes(r))throw Error("Key alias ".concat(r," already exists for team with ID ").concat(i,", please provide another key alias"));if(P.ZP.info("Making API Call"),u(!0),"you"===q&&(e.user_id=l),"service_account"===q){let l={};try{l=JSON.parse(e.metadata||"{}")}catch(e){console.error("Error parsing metadata:",e)}l.service_account_id=e.key_alias,e.metadata=JSON.stringify(l)}let m=await (0,g.wX)(n,l,e);console.log("key create Response:",m),d(e=>e?[...e,m]:[m]),window.addNewKeyToList&&window.addNewKeyToList(m),x(m.key),j(m.soft_budget),P.ZP.success("API Key Created"),c.resetFields(),localStorage.removeItem("userData"+l)}catch(e){console.log("error in create key:",e),P.ZP.error("Error creating the key: ".concat(e))}};(0,i.useEffect)(()=>{l&&a&&n&&$&&ef(l,a,n,$.team_id).then(e=>{U(Array.from(new Set([...$.models,...e])))}),c.setFieldValue("models",[])},[$]);let ey=async e=>{if(!e){ei([]);return}ec(!0);try{let l=new URLSearchParams;if(l.append("user_email",e),null==n)return;let s=(await (0,g.u5)(n,l)).map(e=>({label:"".concat(e.user_email," (").concat(e.user_id,")"),value:e.user_id,user:e}));ei(s)}catch(e){console.error("Error fetching users:",e),P.ZP.error("Failed to search for users")}finally{ec(!1)}},ev=(0,i.useCallback)(ed()(e=>ey(e),300),[n]),eb=(e,l)=>{let s=l.user;c.setFieldsValue({user_id:s.user_id})};return(0,r.jsxs)("div",{children:[a&&eu.includes(a)&&(0,r.jsx)(b.Z,{className:"mx-auto",onClick:()=>u(!0),children:"+ Create New Key"}),(0,r.jsx)(O.Z,{visible:m,width:1e3,footer:null,onOk:em,onCancel:eh,children:(0,r.jsxs)(E.Z,{form:c,onFinish:ex,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)(C.Z,{className:"mb-4",children:"Key Ownership"}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Owned By"," ",(0,r.jsx)(V.Z,{title:"Select who will own this API key",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),className:"mb-4",children:(0,r.jsxs)(T.ZP.Group,{onChange:e=>K(e.target.value),value:q,children:[(0,r.jsx)(T.ZP,{value:"you",children:"You"}),(0,r.jsx)(T.ZP,{value:"service_account",children:"Service Account"}),"Admin"===a&&(0,r.jsx)(T.ZP,{value:"another_user",children:"Another User"})]})}),"another_user"===q&&(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["User ID"," ",(0,r.jsx)(V.Z,{title:"The user who will own this key and be responsible for its usage",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"user_id",className:"mt-4",rules:[{required:"another_user"===q,message:"Please input the user ID of the user you are assigning the key to"}],children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",marginBottom:"8px"},children:[(0,r.jsx)(A.default,{showSearch:!0,placeholder:"Type email to search for users",filterOption:!1,onSearch:e=>{ev(e)},onSelect:(e,l)=>eb(e,l),options:er,loading:eo,allowClear:!0,style:{width:"100%"},notFoundContent:eo?"Searching...":"No users found"}),(0,r.jsx)(L.ZP,{onClick:()=>ee(!0),style:{marginLeft:"8px"},children:"Create User"})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"Search by email to find users"})]})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Team"," ",(0,r.jsx)(V.Z,{title:"The team this key belongs to, which determines available models and budget limits",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"team_id",initialValue:s?s.team_id:null,className:"mt-4",children:(0,r.jsx)(J,{teams:t,onChange:e=>{X((null==t?void 0:t.find(l=>l.team_id===e))||null)}})})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)(C.Z,{className:"mb-4",children:"Key Details"}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["you"===q||"another_user"===q?"Key Name":"Service Account ID"," ",(0,r.jsx)(V.Z,{title:"you"===q||"another_user"===q?"A descriptive name to identify this key":"Unique identifier for this service account",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"key_alias",rules:[{required:!0,message:"Please input a ".concat("you"===q?"key name":"service account ID")}],help:"required",children:(0,r.jsx)(Z.Z,{placeholder:""})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Models"," ",(0,r.jsx)(V.Z,{title:"Select which models this key can access. Choose 'All Team Models' to grant access to all models available to the team",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"models",rules:[{required:!0,message:"Please select a model"}],help:"required",className:"mt-4",children:(0,r.jsxs)(A.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},onChange:e=>{e.includes("all-team-models")&&c.setFieldsValue({models:["all-team-models"]})},children:[(0,r.jsx)(eg,{value:"all-team-models",children:"All Team Models"},"all-team-models"),F.map(e=>(0,r.jsx)(eg,{value:e,children:R(e)},e))]})})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)(N.Z,{className:"mt-4 mb-4",children:[(0,r.jsx)(k.Z,{children:(0,r.jsx)(C.Z,{className:"m-0",children:"Optional Settings"})}),(0,r.jsxs)(w.Z,{children:[(0,r.jsx)(E.Z.Item,{className:"mt-4",label:(0,r.jsxs)("span",{children:["Max Budget (USD)"," ",(0,r.jsx)(V.Z,{title:"Maximum amount in USD this key can spend. When reached, the key will be blocked from making further requests",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"max_budget",help:"Budget cannot exceed team max budget: $".concat((null==s?void 0:s.max_budget)!==null&&(null==s?void 0:s.max_budget)!==void 0?null==s?void 0:s.max_budget:"unlimited"),rules:[{validator:async(e,l)=>{if(l&&s&&null!==s.max_budget&&l>s.max_budget)throw Error("Budget cannot exceed team max budget: $".concat(s.max_budget))}}],children:(0,r.jsx)(M.Z,{step:.01,precision:2,width:200})}),(0,r.jsx)(E.Z.Item,{className:"mt-4",label:(0,r.jsxs)("span",{children:["Reset Budget"," ",(0,r.jsx)(V.Z,{title:"How often the budget should reset. For example, setting 'daily' will reset the budget every 24 hours",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"budget_duration",help:"Team Reset Budget: ".concat((null==s?void 0:s.budget_duration)!==null&&(null==s?void 0:s.budget_duration)!==void 0?null==s?void 0:s.budget_duration:"None"),children:(0,r.jsx)(ep,{onChange:e=>c.setFieldValue("budget_duration",e)})}),(0,r.jsx)(E.Z.Item,{className:"mt-4",label:(0,r.jsxs)("span",{children:["Tokens per minute Limit (TPM)"," ",(0,r.jsx)(V.Z,{title:"Maximum number of tokens this key can process per minute. Helps control usage and costs",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"tpm_limit",help:"TPM cannot exceed team TPM limit: ".concat((null==s?void 0:s.tpm_limit)!==null&&(null==s?void 0:s.tpm_limit)!==void 0?null==s?void 0:s.tpm_limit:"unlimited"),rules:[{validator:async(e,l)=>{if(l&&s&&null!==s.tpm_limit&&l>s.tpm_limit)throw Error("TPM limit cannot exceed team TPM limit: ".concat(s.tpm_limit))}}],children:(0,r.jsx)(M.Z,{step:1,width:400})}),(0,r.jsx)(E.Z.Item,{className:"mt-4",label:(0,r.jsxs)("span",{children:["Requests per minute Limit (RPM)"," ",(0,r.jsx)(V.Z,{title:"Maximum number of API requests this key can make per minute. Helps prevent abuse and manage load",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"rpm_limit",help:"RPM cannot exceed team RPM limit: ".concat((null==s?void 0:s.rpm_limit)!==null&&(null==s?void 0:s.rpm_limit)!==void 0?null==s?void 0:s.rpm_limit:"unlimited"),rules:[{validator:async(e,l)=>{if(l&&s&&null!==s.rpm_limit&&l>s.rpm_limit)throw Error("RPM limit cannot exceed team RPM limit: ".concat(s.rpm_limit))}}],children:(0,r.jsx)(M.Z,{step:1,width:400})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Expire Key"," ",(0,r.jsx)(V.Z,{title:"Set when this key should expire. Format: 30s (seconds), 30m (minutes), 30h (hours), 30d (days)",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"duration",className:"mt-4",children:(0,r.jsx)(Z.Z,{placeholder:"e.g., 30d"})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Guardrails"," ",(0,r.jsx)(V.Z,{title:"Apply safety guardrails to this key to filter content or enforce policies",children:(0,r.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",className:"mt-4",help:"Select existing guardrails or enter new ones",children:(0,r.jsx)(A.default,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails",options:G.map(e=>({value:e,label:e}))})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Metadata"," ",(0,r.jsx)(V.Z,{title:"JSON object with additional information about this key. Used for tracking or custom logic",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"metadata",className:"mt-4",children:(0,r.jsx)(D.Z.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Tags"," ",(0,r.jsx)(V.Z,{title:"Tags for tracking spend and/or doing tag-based routing. Used for analytics and filtering",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"tags",className:"mt-4",help:"Tags for tracking spend and/or doing tag-based routing.",children:(0,r.jsx)(A.default,{mode:"tags",style:{width:"100%"},placeholder:"Enter tags",tokenSeparators:[","],options:B})}),(0,r.jsxs)(N.Z,{className:"mt-4 mb-4",children:[(0,r.jsx)(k.Z,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("b",{children:"Advanced Settings"}),(0,r.jsx)(V.Z,{title:(0,r.jsxs)("span",{children:["Learn more about advanced settings in our"," ",(0,r.jsx)("a",{href:g.H2?"".concat(g.H2,"/#/key%20management/generate_key_fn_key_generate_post"):"/#/key%20management/generate_key_fn_key_generate_post",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300",children:"documentation"})]}),children:(0,r.jsx)(z.Z,{className:"text-gray-400 hover:text-gray-300 cursor-help"})})]})}),(0,r.jsx)(w.Z,{children:(0,r.jsx)(H,{schemaComponent:"GenerateKeyRequest",form:c,excludedFields:["key_alias","team_id","models","duration","metadata","tags","guardrails","max_budget","budget_duration","tpm_limit","rpm_limit"]})})]})]})]})}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Create Key"})})]})}),Q&&(0,r.jsx)(O.Z,{title:"Create New User",visible:Q,onCancel:()=>ee(!1),footer:null,width:800,children:(0,r.jsx)(en,{userID:l,accessToken:n,teams:t,possibleUIRoles:et,onUserCreated:e=>{es(e),c.setFieldsValue({user_id:e}),ee(!1)},isEmbedded:!0})}),h&&(0,r.jsx)(O.Z,{visible:m,onOk:em,onCancel:eh,footer:null,children:(0,r.jsxs)(v.Z,{numItems:1,className:"gap-2 w-full",children:[(0,r.jsx)(C.Z,{children:"Save your Key"}),(0,r.jsx)(y.Z,{numColSpan:1,children:(0,r.jsxs)("p",{children:["Please save this secret key somewhere safe and accessible. For security reasons, ",(0,r.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,r.jsx)(y.Z,{numColSpan:1,children:null!=h?(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"mt-3",children:"API Key:"}),(0,r.jsx)("div",{style:{background:"#f8f8f8",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:(0,r.jsx)("pre",{style:{wordWrap:"break-word",whiteSpace:"normal"},children:h})}),(0,r.jsx)(I.CopyToClipboard,{text:h,onCopy:()=>{P.ZP.success("API Key copied to clipboard")},children:(0,r.jsx)(b.Z,{className:"mt-3",children:"Copy API Key"})})]}):(0,r.jsx)(S.Z,{children:"Key being created, this might take 30s"})})]})})]})},ev=s(7366),eb=e=>{let{selectedTeam:l,currentOrg:s,accessToken:t,currentPage:a=1}=e,[r,n]=(0,i.useState)({keys:[],total_count:0,current_page:1,total_pages:0}),[o,d]=(0,i.useState)(!0),[c,m]=(0,i.useState)(null),u=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(console.log("calling fetchKeys"),!t){console.log("accessToken",t);return}d(!0);let a=await (0,g.OD)(t,(null==s?void 0:s.organization_id)||null,(null==l?void 0:l.team_id)||"",e.page||1,50);console.log("data",a),n(a),m(null)}catch(e){m(e instanceof Error?e:Error("An error occurred"))}finally{d(!1)}};return(0,i.useEffect)(()=>{u(),console.log("selectedTeam",l,"currentOrg",s,"accessToken",t)},[l,s,t]),{keys:r.keys,isLoading:o,error:c,pagination:{currentPage:r.current_page,totalPages:r.total_pages,totalCount:r.total_count},refresh:u,setKeys:e=>{n(l=>{let s="function"==typeof e?e(l.keys):e;return{...l,keys:s}})}}},eZ=s(71594),eN=s(24525),ew=s(21626),ek=s(97214),eS=s(28241),eC=s(58834),eI=s(69552),eA=s(71876);function eE(e){let{data:l=[],columns:s,getRowCanExpand:t,renderSubComponent:a,isLoading:n=!1,expandedRequestId:o,onRowExpand:d}=e,c=(0,eZ.b7)({data:l,columns:s,getRowCanExpand:t,getCoreRowModel:(0,eN.sC)(),getExpandedRowModel:(0,eN.rV)(),state:{expanded:o?l.reduce((e,l,s)=>(l.request_id===o&&(e[s]=!0),e),{}):{}},onExpandedChange:e=>{if(!d)return;let s=o?l.reduce((e,l,s)=>(l.request_id===o&&(e[s]=!0),e),{}):{},t="function"==typeof e?e(s):e;if(0===Object.keys(t).length){d(null);return}let a=Object.keys(t)[0],r=void 0!==a?l[parseInt(a)]:null;d(r?r.request_id:null)}});return(0,r.jsx)("div",{className:"rounded-lg custom-border",children:(0,r.jsxs)(ew.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,r.jsx)(eC.Z,{children:c.getHeaderGroups().map(e=>(0,r.jsx)(eA.Z,{children:e.headers.map(e=>(0,r.jsx)(eI.Z,{className:"py-1 h-8",children:e.isPlaceholder?null:(0,eZ.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,r.jsx)(ek.Z,{children:n?(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{colSpan:s.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"\uD83D\uDE85 Loading logs..."})})})}):c.getRowModel().rows.length>0?c.getRowModel().rows.map(e=>(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(eA.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,r.jsx)(eS.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,eZ.ie)(e.column.columnDef.cell,e.getContext())},e.id))}),e.getIsExpanded()&&(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{colSpan:e.getVisibleCells().length,children:a({row:e})})})]},e.id)):(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{colSpan:s.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"No logs found"})})})})})]})})}var eP=s(27281),eO=s(41649),eT=s(12514),eL=s(12485),eM=s(18135),eD=s(35242),eF=s(29706),eR=s(77991),eU=s(10900),ez=s(23628),eV=s(74998);function eq(e){var l,s;let{keyData:t,onCancel:a,onSubmit:n,teams:o,accessToken:d,userID:c,userRole:m}=e,[u]=E.Z.useForm(),[h,x]=(0,i.useState)([]),p=null==o?void 0:o.find(e=>e.team_id===t.team_id),[j,f]=(0,i.useState)([]);(0,i.useEffect)(()=>{(async()=>{if(c&&m&&d)try{if(null===t.team_id){let e=(await (0,g.So)(d,c,m)).data.map(e=>e.id);f(e)}else if(null==p?void 0:p.team_id){let e=await ef(c,m,d,p.team_id);f(Array.from(new Set([...p.models,...e])))}}catch(e){console.error("Error fetching models:",e)}})()},[c,m,d,p,t.team_id]);let _={...t,budget_duration:(s=t.budget_duration)&&({"24h":"daily","7d":"weekly","30d":"monthly"})[s]||null,metadata:t.metadata?JSON.stringify(t.metadata,null,2):"",guardrails:(null===(l=t.metadata)||void 0===l?void 0:l.guardrails)||[]};return(0,r.jsxs)(E.Z,{form:u,onFinish:n,initialValues:_,layout:"vertical",children:[(0,r.jsx)(E.Z.Item,{label:"Key Alias",name:"key_alias",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"Models",name:"models",children:(0,r.jsxs)(A.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[j.length>0&&(0,r.jsx)(A.default.Option,{value:"all-team-models",children:"All Team Models"}),j.map(e=>(0,r.jsx)(A.default.Option,{value:e,children:e},e))]})}),(0,r.jsx)(E.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,r.jsx)(M.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,r.jsxs)(A.default,{placeholder:"n/a",children:[(0,r.jsx)(A.default.Option,{value:"daily",children:"Daily"}),(0,r.jsx)(A.default.Option,{value:"weekly",children:"Weekly"}),(0,r.jsx)(A.default.Option,{value:"monthly",children:"Monthly"})]})}),(0,r.jsx)(E.Z.Item,{label:"TPM Limit",name:"tpm_limit",children:(0,r.jsx)(M.Z,{style:{width:"100%"},min:0})}),(0,r.jsx)(E.Z.Item,{label:"RPM Limit",name:"rpm_limit",children:(0,r.jsx)(M.Z,{style:{width:"100%"},min:0})}),(0,r.jsx)(E.Z.Item,{label:"Max Parallel Requests",name:"max_parallel_requests",children:(0,r.jsx)(M.Z,{style:{width:"100%"},min:0})}),(0,r.jsx)(E.Z.Item,{label:"Model TPM Limit",name:"model_tpm_limit",children:(0,r.jsx)(D.Z.TextArea,{rows:4,placeholder:'{"gpt-4": 100, "claude-v1": 200}'})}),(0,r.jsx)(E.Z.Item,{label:"Model RPM Limit",name:"model_rpm_limit",children:(0,r.jsx)(D.Z.TextArea,{rows:4,placeholder:'{"gpt-4": 100, "claude-v1": 200}'})}),(0,r.jsx)(E.Z.Item,{label:"Guardrails",name:"guardrails",children:(0,r.jsx)(A.default,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails"})}),(0,r.jsx)(E.Z.Item,{label:"Metadata",name:"metadata",children:(0,r.jsx)(D.Z.TextArea,{rows:10})}),(0,r.jsx)(E.Z.Item,{name:"token",hidden:!0,children:(0,r.jsx)(D.Z,{})}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,r.jsx)(b.Z,{variant:"light",onClick:a,children:"Cancel"}),(0,r.jsx)(b.Z,{children:"Save Changes"})]})]})}function eK(e){let{selectedToken:l,visible:s,onClose:t,accessToken:a}=e,[n]=E.Z.useForm(),[o,d]=(0,i.useState)(null),[c,m]=(0,i.useState)(null),[u,h]=(0,i.useState)(null),[x,p]=(0,i.useState)(!1);(0,i.useEffect)(()=>{s&&l&&n.setFieldsValue({key_alias:l.key_alias,max_budget:l.max_budget,tpm_limit:l.tpm_limit,rpm_limit:l.rpm_limit,duration:l.duration||""})},[s,l,n]),(0,i.useEffect)(()=>{s||(d(null),p(!1),n.resetFields())},[s,n]),(0,i.useEffect)(()=>{(null==c?void 0:c.duration)?h((e=>{if(!e)return null;try{let l;let s=new Date;if(e.endsWith("s"))l=(0,ev.Z)(s,{seconds:parseInt(e)});else if(e.endsWith("h"))l=(0,ev.Z)(s,{hours:parseInt(e)});else if(e.endsWith("d"))l=(0,ev.Z)(s,{days:parseInt(e)});else throw Error("Invalid duration format");return l.toLocaleString()}catch(e){return null}})(c.duration)):h(null)},[null==c?void 0:c.duration]);let j=async()=>{if(l&&a){p(!0);try{let e=await n.validateFields(),s=await (0,g.s0)(a,l.token,e);d(s.key),P.ZP.success("API Key regenerated successfully")}catch(e){console.error("Error regenerating key:",e),P.ZP.error("Failed to regenerate API Key"),p(!1)}}},f=()=>{d(null),p(!1),n.resetFields(),t()};return(0,r.jsx)(O.Z,{title:"Regenerate API Key",open:s,onCancel:f,footer:o?[(0,r.jsx)(b.Z,{onClick:f,children:"Close"},"close")]:[(0,r.jsx)(b.Z,{onClick:f,className:"mr-2",children:"Cancel"},"cancel"),(0,r.jsx)(b.Z,{onClick:j,disabled:x,children:x?"Regenerating...":"Regenerate"},"regenerate")],children:o?(0,r.jsxs)(v.Z,{numItems:1,className:"gap-2 w-full",children:[(0,r.jsx)(C.Z,{children:"Regenerated Key"}),(0,r.jsx)(y.Z,{numColSpan:1,children:(0,r.jsxs)("p",{children:["Please replace your old key with the new key generated. For security reasons, ",(0,r.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,r.jsxs)(y.Z,{numColSpan:1,children:[(0,r.jsx)(S.Z,{className:"mt-3",children:"Key Alias:"}),(0,r.jsx)("div",{className:"bg-gray-100 p-2 rounded mb-2",children:(0,r.jsx)("pre",{className:"break-words whitespace-normal",children:(null==l?void 0:l.key_alias)||"No alias set"})}),(0,r.jsx)(S.Z,{className:"mt-3",children:"New API Key:"}),(0,r.jsx)("div",{className:"bg-gray-100 p-2 rounded mb-2",children:(0,r.jsx)("pre",{className:"break-words whitespace-normal",children:o})}),(0,r.jsx)(I.CopyToClipboard,{text:o,onCopy:()=>P.ZP.success("API Key copied to clipboard"),children:(0,r.jsx)(b.Z,{className:"mt-3",children:"Copy API Key"})})]})]}):(0,r.jsxs)(E.Z,{form:n,layout:"vertical",onValuesChange:e=>{"duration"in e&&m(l=>({...l,duration:e.duration}))},children:[(0,r.jsx)(E.Z.Item,{name:"key_alias",label:"Key Alias",children:(0,r.jsx)(Z.Z,{disabled:!0})}),(0,r.jsx)(E.Z.Item,{name:"max_budget",label:"Max Budget (USD)",children:(0,r.jsx)(M.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{name:"tpm_limit",label:"TPM Limit",children:(0,r.jsx)(M.Z,{style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{name:"rpm_limit",label:"RPM Limit",children:(0,r.jsx)(M.Z,{style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{name:"duration",label:"Expire Key (eg: 30s, 30h, 30d)",className:"mt-8",children:(0,r.jsx)(Z.Z,{placeholder:""})}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Current expiry: ",(null==l?void 0:l.expires)?new Date(l.expires).toLocaleString():"Never"]}),u&&(0,r.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["New expiry: ",u]})]})})}function eB(e){var l,s;let{keyId:t,onClose:a,keyData:n,accessToken:o,userID:d,userRole:c,teams:m}=e,[u,h]=(0,i.useState)(!1),[x]=E.Z.useForm(),[p,j]=(0,i.useState)(!1),[f,_]=(0,i.useState)(!1);if(!n)return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)(b.Z,{icon:eU.Z,variant:"light",onClick:a,className:"mb-4",children:"Back to Keys"}),(0,r.jsx)(S.Z,{children:"Key not found"})]});let y=async e=>{try{var l,s;if(!o)return;let t=e.token;if(e.key=t,e.metadata&&"string"==typeof e.metadata)try{let s=JSON.parse(e.metadata);e.metadata={...s,...(null===(l=e.guardrails)||void 0===l?void 0:l.length)>0?{guardrails:e.guardrails}:{}}}catch(e){console.error("Error parsing metadata JSON:",e),P.ZP.error("Invalid metadata JSON");return}else e.metadata={...e.metadata||{},...(null===(s=e.guardrails)||void 0===s?void 0:s.length)>0?{guardrails:e.guardrails}:{}};e.budget_duration&&(e.budget_duration=({daily:"24h",weekly:"7d",monthly:"30d"})[e.budget_duration]),await (0,g.Nc)(o,e),P.ZP.success("Key updated successfully"),h(!1)}catch(e){P.ZP.error("Failed to update key"),console.error("Error updating key:",e)}},Z=async()=>{try{if(!o)return;await (0,g.I1)(o,n.token),P.ZP.success("Key deleted successfully"),a()}catch(e){console.error("Error deleting the key:",e),P.ZP.error("Failed to delete key")}};return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(b.Z,{icon:eU.Z,variant:"light",onClick:a,className:"mb-4",children:"Back to Keys"}),(0,r.jsx)(C.Z,{children:n.key_alias||"API Key"}),(0,r.jsx)(S.Z,{className:"text-gray-500 font-mono",children:n.token})]}),c&&eu.includes(c)&&(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(b.Z,{icon:ez.Z,variant:"secondary",onClick:()=>_(!0),className:"flex items-center",children:"Regenerate Key"}),(0,r.jsx)(b.Z,{icon:eV.Z,variant:"secondary",onClick:()=>j(!0),className:"flex items-center",children:"Delete Key"})]})]}),(0,r.jsx)(eK,{selectedToken:n,visible:f,onClose:()=>_(!1),accessToken:o}),p&&(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Key"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this key?"})})]})})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)(b.Z,{onClick:Z,color:"red",className:"ml-2",children:"Delete"}),(0,r.jsx)(b.Z,{onClick:()=>j(!1),children:"Cancel"})]})]})]})}),(0,r.jsxs)(eM.Z,{children:[(0,r.jsxs)(eD.Z,{className:"mb-4",children:[(0,r.jsx)(eL.Z,{children:"Overview"}),(0,r.jsx)(eL.Z,{children:"Settings"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Spend"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(C.Z,{children:["$",Number(n.spend).toFixed(4)]}),(0,r.jsxs)(S.Z,{children:["of ",null!==n.max_budget?"$".concat(n.max_budget):"Unlimited"]})]})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Rate Limits"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(S.Z,{children:["TPM: ",null!==n.tpm_limit?n.tpm_limit:"Unlimited"]}),(0,r.jsxs)(S.Z,{children:["RPM: ",null!==n.rpm_limit?n.rpm_limit:"Unlimited"]})]})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Models"}),(0,r.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:n.models&&n.models.length>0?n.models.map((e,l)=>(0,r.jsx)(eO.Z,{color:"red",children:e},l)):(0,r.jsx)(S.Z,{children:"No models specified"})})]})]})}),(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(C.Z,{children:"Key Settings"}),!u&&c&&eu.includes(c)&&(0,r.jsx)(b.Z,{variant:"light",onClick:()=>h(!0),children:"Edit Settings"})]}),u?(0,r.jsx)(eq,{keyData:n,onCancel:()=>h(!1),onSubmit:y,teams:m,accessToken:o,userID:d,userRole:c}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Key ID"}),(0,r.jsx)(S.Z,{className:"font-mono",children:n.token})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Key Alias"}),(0,r.jsx)(S.Z,{children:n.key_alias||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Secret Key"}),(0,r.jsx)(S.Z,{className:"font-mono",children:n.key_name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Team ID"}),(0,r.jsx)(S.Z,{children:n.team_id||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Organization"}),(0,r.jsx)(S.Z,{children:n.organization_id||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Created"}),(0,r.jsx)(S.Z,{children:new Date(n.created_at).toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Expires"}),(0,r.jsx)(S.Z,{children:n.expires?new Date(n.expires).toLocaleString():"Never"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Spend"}),(0,r.jsxs)(S.Z,{children:["$",Number(n.spend).toFixed(4)," USD"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Budget"}),(0,r.jsx)(S.Z,{children:null!==n.max_budget?"$".concat(n.max_budget," USD"):"Unlimited"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Models"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:n.models&&n.models.length>0?n.models.map((e,l)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:e},l)):(0,r.jsx)(S.Z,{children:"No models specified"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Rate Limits"}),(0,r.jsxs)(S.Z,{children:["TPM: ",null!==n.tpm_limit?n.tpm_limit:"Unlimited"]}),(0,r.jsxs)(S.Z,{children:["RPM: ",null!==n.rpm_limit?n.rpm_limit:"Unlimited"]}),(0,r.jsxs)(S.Z,{children:["Max Parallel Requests: ",null!==n.max_parallel_requests?n.max_parallel_requests:"Unlimited"]}),(0,r.jsxs)(S.Z,{children:["Model TPM Limits: ",(null===(l=n.metadata)||void 0===l?void 0:l.model_tpm_limit)?JSON.stringify(n.metadata.model_tpm_limit):"Unlimited"]}),(0,r.jsxs)(S.Z,{children:["Model RPM Limits: ",(null===(s=n.metadata)||void 0===s?void 0:s.model_rpm_limit)?JSON.stringify(n.metadata.model_rpm_limit):"Unlimited"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Metadata"}),(0,r.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:JSON.stringify(n.metadata,null,2)})]})]})]})})]})]})]})}var eH=s(87908),eJ=s(82422),eW=s(2356),eG=s(44633),eY=s(86462),e$=s(3837),eX=e=>{var l;let{options:s,onApplyFilters:t,onResetFilters:a,initialValues:n={},buttonLabel:o="Filter"}=e,[d,c]=(0,i.useState)(!1),[m,h]=(0,i.useState)((null===(l=s[0])||void 0===l?void 0:l.name)||""),[x,p]=(0,i.useState)(n),[g,j]=(0,i.useState)(n),[f,_]=(0,i.useState)(!1),[y,v]=(0,i.useState)([]),[Z,N]=(0,i.useState)(!1),[w,k]=(0,i.useState)(""),S=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=e=>{let l=e.target;!S.current||S.current.contains(l)||l.closest(".ant-dropdown")||l.closest(".ant-select-dropdown")||c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,i.useEffect)(()=>{s.length>0&&s[0].isSearchable&&s[0].searchFn&&C(s[0])},[]);let C=async e=>{if(e.isSearchable&&e.searchFn){N(!0);try{let l=await e.searchFn("");v(l)}catch(e){console.error("Error loading initial options:",e),v([])}finally{N(!1)}}};(0,i.useEffect)(()=>{d&&(null==M?void 0:M.isSearchable)&&(null==M?void 0:M.searchFn)&&C(M)},[d,m]);let I=e=>{h(e),_(!1);let l=s.find(l=>l.name===e);(null==l?void 0:l.isSearchable)&&(null==l?void 0:l.searchFn)?C(l):v([])},E=(0,i.useCallback)(ed()(async(e,l)=>{if(l.isSearchable&&l.searchFn){N(!0);try{let s=await l.searchFn(e);v(s)}catch(e){console.error("Error searching:",e),v([])}finally{N(!1)}}},300),[]),P=e=>{j(l=>({...l,[m]:e}))},O=()=>{let e={};s.forEach(l=>{e[l.name]=""}),j(e)},T=s.map(e=>({key:e.name,label:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[m===e.name&&(0,r.jsx)(eJ.Z,{className:"h-4 w-4 text-blue-600"}),e.label||e.name]})})),M=s.find(e=>e.name===m);return(0,r.jsxs)("div",{className:"relative",ref:S,children:[(0,r.jsx)(b.Z,{icon:eW.Z,onClick:()=>c(!d),variant:"secondary",size:"xs",className:"flex items-center pr-2",children:o}),d&&(0,r.jsx)(eT.Z,{className:"absolute left-0 mt-2 w-[500px] z-50 border border-gray-200 shadow-lg",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Where"}),(0,r.jsx)(u.Z,{menu:{items:T,onClick:e=>{let{key:l}=e;return I(l)},style:{minWidth:"200px"}},onOpenChange:_,open:f,trigger:["click"],children:(0,r.jsxs)(L.ZP,{className:"min-w-40 text-left flex justify-between items-center",children:[(null==M?void 0:M.label)||m,f?(0,r.jsx)(eG.Z,{className:"h-4 w-4"}):(0,r.jsx)(eY.Z,{className:"h-4 w-4"})]})}),(null==M?void 0:M.isSearchable)?(0,r.jsx)(A.default,{showSearch:!0,placeholder:"Search ".concat(M.label||m,"..."),value:g[m]||void 0,onChange:e=>P(e),onSearch:e=>{k(e),E(e,M)},onInputKeyDown:e=>{"Enter"===e.key&&w&&(P(w),e.preventDefault())},filterOption:!1,className:"flex-1 w-full max-w-full truncate min-w-100",loading:Z,options:y,allowClear:!0,notFoundContent:Z?(0,r.jsx)(eH.Z,{size:"small"}):(0,r.jsx)("div",{className:"p-2",children:w&&(0,r.jsxs)(L.ZP,{type:"link",className:"p-0 mt-1",onClick:()=>{P(w);let e=document.activeElement;e&&e.blur()},children:["Use “",w,"” as filter value"]})})}):(0,r.jsx)(D.Z,{placeholder:"Enter value...",value:g[m]||"",onChange:e=>P(e.target.value),className:"px-3 py-1.5 border rounded-md text-sm flex-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",suffix:g[m]?(0,r.jsx)(e$.Z,{className:"h-4 w-4 cursor-pointer text-gray-400 hover:text-gray-500",onClick:e=>{e.stopPropagation(),P("")}}):null})]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,r.jsx)(L.ZP,{onClick:()=>{O(),a(),c(!1)},children:"Reset"}),(0,r.jsx)(L.ZP,{onClick:()=>{p(g),t(g),c(!1)},children:"Apply Filters"})]})]})})]})};let eQ=async(e,l)=>{if(!e)return[];try{let s=[],t=1,a=!0;for(;a;){let r=await (0,g.It)(e,l||null,null);s=[...s,...r.teams],t<r.total_pages?t++:a=!1}return s}catch(e){return console.error("Error fetching all teams:",e),[]}},e0=async e=>{if(!e)return[];try{let l=[],s=1,t=!0;for(;t;){let a=await (0,g.r6)(e);l=[...l,...a.organizations],s<a.total_pages?s++:t=!1}return l}catch(e){return console.error("Error fetching all organizations:",e),[]}};function e1(e){let{keys:l,isLoading:s=!1,pagination:t,onPageChange:a,pageSize:n=50,teams:o,selectedTeam:d,setSelectedTeam:c,accessToken:m,userID:u,userRole:h,organizations:x,setCurrentOrg:p,refresh:j}=e,[f,_]=(0,i.useState)(null),[y,v]=(0,i.useState)([]),{filters:Z,filteredKeys:N,allKeyAliases:w,allTeams:k,allOrganizations:S,handleFilterChange:C,handleFilterReset:I}=function(e){let{keys:l,teams:s,organizations:t,accessToken:a,setSelectedTeam:r,setCurrentOrg:n}=e,[o,d]=(0,i.useState)({"Team ID":"","Organization ID":""}),[c,m]=(0,i.useState)([]),[u,h]=(0,i.useState)(s||[]),[x,p]=(0,i.useState)(t||[]),[g,j]=(0,i.useState)(l);return(0,i.useEffect)(()=>{if(!l){j([]);return}let e=[...l];o["Team ID"]&&(e=e.filter(e=>e.team_id===o["Team ID"])),o["Organization ID"]&&(e=e.filter(e=>e.organization_id===o["Organization ID"])),j(e)},[l,o]),(0,i.useEffect)(()=>{let e=async()=>{let e=await eQ(a);e.length>0&&h(e);let l=await e0(a);l.length>0&&p(l)};a&&e()},[a]),(0,i.useEffect)(()=>{s&&s.length>0&&h(e=>e.length<s.length?s:e)},[s]),(0,i.useEffect)(()=>{t&&t.length>0&&p(e=>e.length<t.length?t:e)},[t]),{filters:o,filteredKeys:g,allKeyAliases:c,allTeams:u,allOrganizations:x,handleFilterChange:e=>{if(d({"Team ID":e["Team ID"]||"","Organization ID":e["Organization ID"]||""}),e["Team ID"]){let l=null==u?void 0:u.find(l=>l.team_id===e["Team ID"]);l&&r(l)}if(e["Organization ID"]){let l=null==x?void 0:x.find(l=>l.organization_id===e["Organization ID"]);l&&n(l)}},handleFilterReset:()=>{d({"Team ID":"","Organization ID":""}),r(null),n(null)}}}({keys:l,teams:o,organizations:x,accessToken:m,setSelectedTeam:c,setCurrentOrg:p});(0,i.useEffect)(()=>{if(m){let e=l.map(e=>e.user_id).filter(e=>null!==e);(async()=>{v((await (0,g.Of)(m,e,1,100)).users)})()}},[m,l]),(0,i.useEffect)(()=>{if(j){let e=()=>{j()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}},[j]);let A=[{id:"expander",header:()=>null,cell:e=>{let{row:l}=e;return l.getCanExpand()?(0,r.jsx)("button",{onClick:l.getToggleExpandedHandler(),style:{cursor:"pointer"},children:l.getIsExpanded()?"▼":"▶"}):null}},{header:"Key ID",accessorKey:"token",cell:e=>(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)(V.Z,{title:e.getValue(),children:(0,r.jsx)(b.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>_(e.getValue()),children:e.getValue()?"".concat(e.getValue().slice(0,7),"..."):"-"})})})},{header:"Key Alias",accessorKey:"key_alias",cell:e=>{let l=e.getValue();return(0,r.jsx)(V.Z,{title:l,children:l?l.length>20?"".concat(l.slice(0,20),"..."):l:"-"})}},{header:"Secret Key",accessorKey:"key_name",cell:e=>(0,r.jsx)("span",{className:"font-mono text-xs",children:e.getValue()})},{header:"Team Alias",accessorKey:"team_id",cell:e=>{let{row:l,getValue:s}=e,t=s(),a=null==k?void 0:k.find(e=>e.team_id===t);return(null==a?void 0:a.team_alias)||"Unknown"}},{header:"Team ID",accessorKey:"team_id",cell:e=>(0,r.jsx)(V.Z,{title:e.getValue(),children:e.getValue()?"".concat(e.getValue().slice(0,7),"..."):"-"})},{header:"Organization ID",accessorKey:"organization_id",cell:e=>e.getValue()?e.renderValue():"-"},{header:"User Email",accessorKey:"user_id",cell:e=>{let l=e.getValue(),s=y.find(e=>e.user_id===l);return(null==s?void 0:s.user_email)?s.user_email:"-"}},{header:"User ID",accessorKey:"user_id",cell:e=>{let l=e.getValue();return l?(0,r.jsx)(V.Z,{title:l,children:(0,r.jsxs)("span",{children:[l.slice(0,7),"..."]})}):"-"}},{header:"Created At",accessorKey:"created_at",cell:e=>{let l=e.getValue();return l?new Date(l).toLocaleDateString():"-"}},{header:"Created By",accessorKey:"created_by",cell:e=>e.getValue()||"Unknown"},{header:"Expires",accessorKey:"expires",cell:e=>{let l=e.getValue();return l?new Date(l).toLocaleDateString():"Never"}},{header:"Spend (USD)",accessorKey:"spend",cell:e=>Number(e.getValue()).toFixed(4)},{header:"Budget (USD)",accessorKey:"max_budget",cell:e=>null!==e.getValue()&&void 0!==e.getValue()?e.getValue():"Unlimited"},{header:"Budget Reset",accessorKey:"budget_reset_at",cell:e=>{let l=e.getValue();return l?new Date(l).toLocaleString():"Never"}},{header:"Models",accessorKey:"models",cell:e=>{let l=e.getValue();return(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:l&&l.length>0?l.map((e,l)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:e},l)):"-"})}},{header:"Rate Limits",cell:e=>{let{row:l}=e,s=l.original;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:["TPM: ",null!==s.tpm_limit?s.tpm_limit:"Unlimited"]}),(0,r.jsxs)("div",{children:["RPM: ",null!==s.rpm_limit?s.rpm_limit:"Unlimited"]})]})}}];return(0,r.jsx)("div",{className:"w-full h-full overflow-hidden",children:f?(0,r.jsx)(eB,{keyId:f,onClose:()=>_(null),keyData:l.find(e=>e.token===f),accessToken:m,userID:u,userRole:h,teams:k}):(0,r.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between w-full mb-2",children:[(0,r.jsx)(eX,{options:[{name:"Team ID",label:"Team ID",isSearchable:!0,searchFn:async e=>k&&0!==k.length?k.filter(l=>l.team_id.toLowerCase().includes(e.toLowerCase())||l.team_alias&&l.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:"".concat(e.team_alias||e.team_id," (").concat(e.team_id,")"),value:e.team_id})):[]},{name:"Organization ID",label:"Organization ID",isSearchable:!0,searchFn:async e=>S&&0!==S.length?S.filter(l=>{var s,t;return null!==(t=null===(s=l.organization_id)||void 0===s?void 0:s.toLowerCase().includes(e.toLowerCase()))&&void 0!==t&&t}).filter(e=>null!==e.organization_id&&void 0!==e.organization_id).map(e=>({label:"".concat(e.organization_id||"Unknown"," (").concat(e.organization_id,")"),value:e.organization_id})):[]}],onApplyFilters:C,initialValues:Z,onResetFilters:I}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",s?"...":"".concat((t.currentPage-1)*n+1," - ").concat(Math.min(t.currentPage*n,t.totalCount))," of ",s?"...":t.totalCount," results"]}),(0,r.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",s?"...":t.currentPage," of ",s?"...":t.totalPages]}),(0,r.jsx)("button",{onClick:()=>a(t.currentPage-1),disabled:s||1===t.currentPage,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,r.jsx)("button",{onClick:()=>a(t.currentPage+1),disabled:s||t.currentPage===t.totalPages,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}),(0,r.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,r.jsx)(eE,{columns:A.filter(e=>"expander"!==e.id),data:N,isLoading:s,getRowCanExpand:()=>!1,renderSubComponent:()=>(0,r.jsx)(r.Fragment,{})})})]})})}console.log=function(){};var e2=e=>{let{userID:l,userRole:s,accessToken:t,selectedTeam:a,setSelectedTeam:n,data:o,setData:d,teams:c,premiumUser:m,currentOrg:u,organizations:h,setCurrentOrg:x}=e,[p,j]=(0,i.useState)(!1),[f,_]=(0,i.useState)(!1),[N,w]=(0,i.useState)(null),[k,A]=(0,i.useState)(null),[T,L]=(0,i.useState)(null),[D,R]=(0,i.useState)((null==a?void 0:a.team_id)||""),[U,z]=(0,i.useState)("");(0,i.useEffect)(()=>{R((null==a?void 0:a.team_id)||"")},[a]);let{keys:V,isLoading:q,error:K,pagination:B,refresh:H,setKeys:J}=eb({selectedTeam:a,currentOrg:u,accessToken:t});window.refreshKeysList=H,window.addNewKeyToList=e=>{J(l=>[e,...l])};let[W,G]=(0,i.useState)(!1),[Y,$]=(0,i.useState)(!1),[X,Q]=(0,i.useState)(null),[ee,el]=(0,i.useState)([]),es=new Set,[et,ea]=(0,i.useState)(!1),[er,ei]=(0,i.useState)(!1),[en,eo]=(0,i.useState)(null),[ed,ec]=(0,i.useState)(null),[em]=E.Z.useForm(),[eu,eh]=(0,i.useState)(null),[ex,ep]=(0,i.useState)(es),[eg,ej]=(0,i.useState)([]);(0,i.useEffect)(()=>{console.log("in calculateNewExpiryTime for selectedToken",X),(null==ed?void 0:ed.duration)?eh((e=>{if(!e)return null;try{let l;let s=new Date;if(e.endsWith("s"))l=(0,ev.Z)(s,{seconds:parseInt(e)});else if(e.endsWith("h"))l=(0,ev.Z)(s,{hours:parseInt(e)});else if(e.endsWith("d"))l=(0,ev.Z)(s,{days:parseInt(e)});else throw Error("Invalid duration format");return l.toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})}catch(e){return null}})(ed.duration)):eh(null),console.log("calculateNewExpiryTime:",eu)},[X,null==ed?void 0:ed.duration]),(0,i.useEffect)(()=>{(async()=>{try{if(null===l||null===s||null===t)return;let e=await F(l,s,t);e&&el(e)}catch(e){console.error("Error fetching user models:",e)}})()},[t,l,s]),(0,i.useEffect)(()=>{if(c){let e=new Set;c.forEach((l,s)=>{let t=l.team_id;e.add(t)}),ep(e)}},[c]);let ef=async()=>{if(null!=N&&null!=o){try{await (0,g.I1)(t,N);let e=o.filter(e=>e.token!==N);d(e)}catch(e){console.error("Error deleting the key:",e)}_(!1),w(null)}},e_=(e,l)=>{ec(s=>({...s,[e]:l}))},ey=async()=>{if(!m){P.ZP.error("Regenerate API Key is an Enterprise feature. Please upgrade to use this feature.");return}if(null!=X)try{let e=await em.validateFields(),l=await (0,g.s0)(t,X.token,e);if(eo(l.key),o){let s=o.map(s=>s.token===(null==X?void 0:X.token)?{...s,key_name:l.key_name,...e}:s);d(s)}ei(!1),em.resetFields(),P.ZP.success("API Key regenerated successfully")}catch(e){console.error("Error regenerating key:",e),P.ZP.error("Failed to regenerate API Key")}};return(0,r.jsxs)("div",{children:[(0,r.jsx)(e1,{keys:V,isLoading:q,pagination:B,onPageChange:e=>{H({page:e})},pageSize:100,teams:c,selectedTeam:a,setSelectedTeam:n,accessToken:t,userID:l,userRole:s,organizations:h,setCurrentOrg:x,refresh:H}),f&&(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Key"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this key ?"})})]})})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)(b.Z,{onClick:ef,color:"red",className:"ml-2",children:"Delete"}),(0,r.jsx)(b.Z,{onClick:()=>{_(!1),w(null)},children:"Cancel"})]})]})]})}),(0,r.jsx)(O.Z,{title:"Regenerate API Key",visible:er,onCancel:()=>{ei(!1),em.resetFields()},footer:[(0,r.jsx)(b.Z,{onClick:()=>{ei(!1),em.resetFields()},className:"mr-2",children:"Cancel"},"cancel"),(0,r.jsx)(b.Z,{onClick:ey,disabled:!m,children:m?"Regenerate":"Upgrade to Regenerate"},"regenerate")],children:m?(0,r.jsxs)(E.Z,{form:em,layout:"vertical",onValuesChange:(e,l)=>{"duration"in e&&e_("duration",e.duration)},children:[(0,r.jsx)(E.Z.Item,{name:"key_alias",label:"Key Alias",children:(0,r.jsx)(Z.Z,{disabled:!0})}),(0,r.jsx)(E.Z.Item,{name:"max_budget",label:"Max Budget (USD)",children:(0,r.jsx)(M.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{name:"tpm_limit",label:"TPM Limit",children:(0,r.jsx)(M.Z,{style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{name:"rpm_limit",label:"RPM Limit",children:(0,r.jsx)(M.Z,{style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{name:"duration",label:"Expire Key (eg: 30s, 30h, 30d)",className:"mt-8",children:(0,r.jsx)(Z.Z,{placeholder:""})}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Current expiry:"," ",(null==X?void 0:X.expires)!=null?new Date(X.expires).toLocaleString():"Never"]}),eu&&(0,r.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["New expiry: ",eu]})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"mb-2 text-gray-500 italic text-[12px]",children:"Upgrade to use this feature"}),(0,r.jsx)(b.Z,{variant:"primary",className:"mb-2",children:(0,r.jsx)("a",{href:"https://calendly.com/d/4mp-gd3-k5k/litellm-1-1-onboarding-chat",target:"_blank",children:"Get Free Trial"})})]})}),en&&(0,r.jsx)(O.Z,{visible:!!en,onCancel:()=>eo(null),footer:[(0,r.jsx)(b.Z,{onClick:()=>eo(null),children:"Close"},"close")],children:(0,r.jsxs)(v.Z,{numItems:1,className:"gap-2 w-full",children:[(0,r.jsx)(C.Z,{children:"Regenerated Key"}),(0,r.jsx)(y.Z,{numColSpan:1,children:(0,r.jsxs)("p",{children:["Please replace your old key with the new key generated. For security reasons, ",(0,r.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,r.jsxs)(y.Z,{numColSpan:1,children:[(0,r.jsx)(S.Z,{className:"mt-3",children:"Key Alias:"}),(0,r.jsx)("div",{style:{background:"#f8f8f8",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:(0,r.jsx)("pre",{style:{wordWrap:"break-word",whiteSpace:"normal"},children:(null==X?void 0:X.key_alias)||"No alias set"})}),(0,r.jsx)(S.Z,{className:"mt-3",children:"New API Key:"}),(0,r.jsx)("div",{style:{background:"#f8f8f8",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:(0,r.jsx)("pre",{style:{wordWrap:"break-word",whiteSpace:"normal"},children:en})}),(0,r.jsx)(I.CopyToClipboard,{text:en,onCopy:()=>P.ZP.success("API Key copied to clipboard"),children:(0,r.jsx)(b.Z,{className:"mt-3",children:"Copy API Key"})})]})]})})]})},e4=s(12011);console.log=function(){},console.log("isLocal:",!1);var e5=e=>{let{userID:l,userRole:s,teams:t,keys:a,setUserRole:d,userEmail:c,setUserEmail:m,setTeams:u,setKeys:h,premiumUser:x,organizations:j}=e,[f,b]=(0,i.useState)(null),[Z,N]=(0,i.useState)(null),w=(0,n.useSearchParams)(),k=function(e){console.log("COOKIES",document.cookie);let l=document.cookie.split("; ").find(l=>l.startsWith(e+"="));return l?l.split("=")[1]:null}("token"),S=w.get("invitation_id"),[C,I]=(0,i.useState)(null),[A,E]=(0,i.useState)(null),[P,O]=(0,i.useState)([]),[T,L]=(0,i.useState)(null),[M,D]=(0,i.useState)(null);if(window.addEventListener("beforeunload",function(){sessionStorage.clear()}),(0,i.useEffect)(()=>{if(k){let e=(0,o.o)(k);if(e){if(console.log("Decoded token:",e),console.log("Decoded key:",e.key),I(e.key),e.user_role){let l=function(e){if(!e)return"Undefined Role";switch(console.log("Received user role: ".concat(e)),e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"app_user":return"App User";case"internal_user":return"Internal User";case"internal_user_viewer":return"Internal Viewer";default:return"Unknown Role"}}(e.user_role);console.log("Decoded user_role:",l),d(l)}else console.log("User role not defined");e.user_email?m(e.user_email):console.log("User Email is not set ".concat(e))}}if(l&&C&&s&&!a&&!f){let e=sessionStorage.getItem("userModels"+l);e?O(JSON.parse(e)):(console.log("currentOrg: ".concat(JSON.stringify(Z))),(async()=>{try{let e=await (0,g.g)(C);L(e);let t=await (0,g.Br)(C,l,s,!1,null,null);b(t.user_info),console.log("userSpendData: ".concat(JSON.stringify(f))),(null==t?void 0:t.teams[0].keys)?h(t.keys.concat(t.teams.filter(e=>"Admin"===s||e.user_id===l).flatMap(e=>e.keys))):h(t.keys),sessionStorage.setItem("userData"+l,JSON.stringify(t.keys)),sessionStorage.setItem("userSpendData"+l,JSON.stringify(t.user_info));let a=(await (0,g.So)(C,l,s)).data.map(e=>e.id);console.log("available_model_names:",a),O(a),console.log("userModels:",P),sessionStorage.setItem("userModels"+l,JSON.stringify(a))}catch(e){console.error("There was an error fetching the data",e)}})(),_(C,l,s,Z,u))}},[l,k,C,a,s]),(0,i.useEffect)(()=>{console.log("currentOrg: ".concat(JSON.stringify(Z),", accessToken: ").concat(C,", userID: ").concat(l,", userRole: ").concat(s)),C&&(console.log("fetching teams"),_(C,l,s,Z,u))},[Z]),(0,i.useEffect)(()=>{if(null!==a&&null!=M&&null!==M.team_id){let e=0;for(let l of(console.log("keys: ".concat(JSON.stringify(a))),a))M.hasOwnProperty("team_id")&&null!==l.team_id&&l.team_id===M.team_id&&(e+=l.spend);console.log("sum: ".concat(e)),E(e)}else if(null!==a){let e=0;for(let l of a)e+=l.spend;E(e)}},[M]),null!=S)return(0,r.jsx)(e4.default,{});if(null==l||null==k){console.log("All cookies before redirect:",document.cookie),(0,p.b)();let e="/sso/key/generate";return console.log("Full URL:",e),window.location.href=e,null}if(null==C)return null;if(null==s&&d("App Owner"),s&&"Admin Viewer"==s){let{Title:e,Paragraph:l}=G.default;return(0,r.jsxs)("div",{children:[(0,r.jsx)(e,{level:1,children:"Access Denied"}),(0,r.jsx)(l,{children:"Ask your proxy admin for access to create keys"})]})}return console.log("inside user dashboard, selected team",M),console.log("All cookies after redirect:",document.cookie),(0,r.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,r.jsx)(v.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,r.jsxs)(y.Z,{numColSpan:1,className:"flex flex-col gap-2",children:[(0,r.jsx)(ey,{userID:l,team:M,teams:t,userRole:s,accessToken:C,data:a,setData:h},M?M.team_id:null),(0,r.jsx)(e2,{userID:l,userRole:s,accessToken:C,selectedTeam:M||null,setSelectedTeam:D,data:a,setData:h,premiumUser:x,teams:t,currentOrg:Z,setCurrentOrg:N,organizations:j})]})})})},e3=s(97765);(t=a||(a={})).OpenAI="OpenAI",t.OpenAI_Compatible="OpenAI-Compatible Endpoints (Together AI, etc.)",t.OpenAI_Text="OpenAI Text Completion",t.OpenAI_Text_Compatible="OpenAI-Compatible Text Completion Models (Together AI, etc.)",t.Azure="Azure",t.Azure_AI_Studio="Azure AI Foundry (Studio)",t.Anthropic="Anthropic",t.Vertex_AI="Vertex AI (Anthropic, Gemini, etc.)",t.Google_AI_Studio="Google AI Studio",t.Bedrock="Amazon Bedrock",t.Groq="Groq",t.MistralAI="Mistral AI",t.Deepseek="Deepseek",t.Cohere="Cohere",t.Databricks="Databricks",t.Ollama="Ollama",t.xAI="xAI",t.AssemblyAI="AssemblyAI",t.Cerebras="Cerebras",t.Sambanova="Sambanova",t.Perplexity="Perplexity",t.TogetherAI="TogetherAI",t.Openrouter="Openrouter",t.FireworksAI="Fireworks AI";let e6={OpenAI:"openai",OpenAI_Text:"text-completion-openai",Azure:"azure",Azure_AI_Studio:"azure_ai",Anthropic:"anthropic",Google_AI_Studio:"gemini",Bedrock:"bedrock",Groq:"groq",MistralAI:"mistral",Cohere:"cohere_chat",OpenAI_Compatible:"openai",OpenAI_Text_Compatible:"text-completion-openai",Vertex_AI:"vertex_ai",Databricks:"databricks",xAI:"xai",Deepseek:"deepseek",Ollama:"ollama",AssemblyAI:"assemblyai",Cerebras:"cerebras",Sambanova:"sambanova",Perplexity:"perplexity",TogetherAI:"togetherai",Openrouter:"openrouter",FireworksAI:"fireworks_ai"},e8={OpenAI:"https://artificialanalysis.ai/img/logos/openai_small.svg","OpenAI Text Completion":"https://artificialanalysis.ai/img/logos/openai_small.svg","OpenAI-Compatible Text Completion Models (Together AI, etc.)":"https://artificialanalysis.ai/img/logos/openai_small.svg","OpenAI-Compatible Endpoints (Together AI, etc.)":"https://artificialanalysis.ai/img/logos/openai_small.svg",Azure:"https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg","Azure AI Foundry (Studio)":"https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg",Anthropic:"https://artificialanalysis.ai/img/logos/anthropic_small.svg","Google AI Studio":"https://artificialanalysis.ai/img/logos/google_small.svg","Amazon Bedrock":"https://artificialanalysis.ai/img/logos/aws_small.png",Groq:"https://artificialanalysis.ai/img/logos/groq_small.png","Mistral AI":"https://artificialanalysis.ai/img/logos/mistral_small.png",Cohere:"https://artificialanalysis.ai/img/logos/cohere_small.png","Vertex AI (Anthropic, Gemini, etc.)":"https://artificialanalysis.ai/img/logos/google_small.svg",Databricks:"https://artificialanalysis.ai/img/logos/databricks_small.png",Ollama:"https://artificialanalysis.ai/img/logos/ollama_small.svg",xAI:"https://artificialanalysis.ai/img/logos/xai_small.svg",Deepseek:"https://artificialanalysis.ai/img/logos/deepseek_small.jpg",AssemblyAI:"https://artificialanalysis.ai/img/logos/assemblyai_small.png",Cerebras:"https://artificialanalysis.ai/img/logos/cerebras_small.png",Sambanova:"https://artificialanalysis.ai/img/logos/sambanova_small.webp",Perplexity:"https://artificialanalysis.ai/img/logos/perplexity_small.png",TogetherAI:"https://artificialanalysis.ai/img/logos/togetherai_small.svg",Openrouter:"https://t0.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://openrouter.ai/chat&size=256","Fireworks AI":"https://artificialanalysis.ai/img/logos/fireworks_small_revised.png"},e7=e=>{if(!e)return{logo:"",displayName:"-"};if("gemini"===e.toLowerCase()){let e="Google AI Studio";return{logo:e8[e],displayName:e}}let l=Object.keys(e6).find(l=>e6[l].toLowerCase()===e.toLowerCase());if(!l)return{logo:"",displayName:e};let s=a[l];return{logo:e8[s],displayName:s}},e9=e=>"Vertex AI (Anthropic, Gemini, etc.)"===e?"gemini-pro":"Anthropic"==e||"Amazon Bedrock"==e?"claude-3-opus":"Google AI Studio"==e?"gemini-pro":"Azure AI Foundry (Studio)"==e?"azure_ai/command-r-plus":"Azure"==e?"azure/my-deployment":"gpt-3.5-turbo",le=(e,l)=>{console.log("Provider key: ".concat(e));let s=e6[e];console.log("Provider mapped to: ".concat(s));let t=[];return e&&"object"==typeof l&&(Object.entries(l).forEach(e=>{let[l,a]=e;null!==a&&"object"==typeof a&&"litellm_provider"in a&&(a.litellm_provider===s||a.litellm_provider.includes(s))&&t.push(l)}),"Cohere"==e&&(console.log("Adding cohere chat models"),Object.entries(l).forEach(e=>{let[l,s]=e;null!==s&&"object"==typeof s&&"litellm_provider"in s&&"cohere"===s.litellm_provider&&t.push(l)}))),t},ll=async(e,l,s)=>{try{console.log("handling submit for formValues:",e);let l=e.model_mappings||[];if("model_mappings"in e&&delete e.model_mappings,e.model&&e.model.includes("all-wildcard")){let s=e6[e.custom_llm_provider]+"/*";e.model_name=s,l.push({public_name:s,litellm_model:s}),e.model=s}for(let s of l){let l={},t={},a=s.public_name;for(let[a,r]of(l.model=s.litellm_model,e.input_cost_per_token&&(e.input_cost_per_token=Number(e.input_cost_per_token)/1e6),e.output_cost_per_token&&(e.output_cost_per_token=Number(e.output_cost_per_token)/1e6),l.model=s.litellm_model,console.log("formValues add deployment:",e),Object.entries(e)))if(""!==r&&"custom_pricing"!==a&&"pricing_model"!==a){if("model_name"==a)l.model=r;else if("custom_llm_provider"==a){console.log("custom_llm_provider:",r);let e=e6[r];l.custom_llm_provider=e,console.log("custom_llm_provider mappingResult:",e)}else if("model"==a)continue;else if("base_model"===a)t[a]=r;else if("team_id"===a)t.team_id=r;else if("mode"==a)console.log("placing mode in modelInfo"),t.mode=r,delete l.mode;else if("custom_model_name"===a)l.model=r;else if("litellm_extra_params"==a){console.log("litellm_extra_params:",r);let e={};if(r&&void 0!=r){try{e=JSON.parse(r)}catch(e){throw P.ZP.error("Failed to parse LiteLLM Extra Params: "+e,10),Error("Failed to parse litellm_extra_params: "+e)}for(let[s,t]of Object.entries(e))l[s]=t}}else if("model_info_params"==a){console.log("model_info_params:",r);let e={};if(r&&void 0!=r){try{e=JSON.parse(r)}catch(e){throw P.ZP.error("Failed to parse LiteLLM Extra Params: "+e,10),Error("Failed to parse litellm_extra_params: "+e)}for(let[l,s]of Object.entries(e))t[l]=s}}else if("input_cost_per_token"===a||"output_cost_per_token"===a||"input_cost_per_second"===a){r&&(l[a]=Number(r));continue}else l[a]=r}return{litellmParamsObj:l,modelInfoObj:t,modelName:a}}}catch(e){P.ZP.error("Failed to create model: "+e,10)}},ls=async(e,l,s,t)=>{try{let a=await ll(e,l,s);if(!a)return;let{litellmParamsObj:r,modelInfoObj:i,modelName:n}=a,o=await (0,g.kK)(l,{model_name:n,litellm_params:r,model_info:i});console.log("response for model create call: ".concat(o.data)),t&&t(),s.resetFields()}catch(e){P.ZP.error("Failed to add model: "+e,10)}};var lt=s(53410),la=s(47451),lr=s(69410);let{Link:li}=G.default,ln={[a.OpenAI]:[{key:"api_base",label:"API Base",type:"select",options:["https://api.openai.com/v1","https://eu.api.openai.com"],defaultValue:"https://api.openai.com/v1"},{key:"organization",label:"OpenAI Organization ID",placeholder:"[OPTIONAL] my-unique-org"},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[a.OpenAI_Text]:[{key:"api_base",label:"API Base",type:"select",options:["https://api.openai.com/v1","https://eu.api.openai.com"],defaultValue:"https://api.openai.com/v1"},{key:"organization",label:"OpenAI Organization ID",placeholder:"[OPTIONAL] my-unique-org"},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[a.Vertex_AI]:[{key:"vertex_project",label:"Vertex Project",placeholder:"adroit-cadet-1234..",required:!0},{key:"vertex_location",label:"Vertex Location",placeholder:"us-east-1",required:!0},{key:"vertex_credentials",label:"Vertex Credentials",required:!0,type:"upload"}],[a.AssemblyAI]:[{key:"api_base",label:"API Base",type:"select",required:!0,options:["https://api.assemblyai.com","https://api.eu.assemblyai.com"]},{key:"api_key",label:"AssemblyAI API Key",type:"password",required:!0}],[a.Azure]:[{key:"api_base",label:"API Base",placeholder:"https://...",required:!0},{key:"api_version",label:"API Version",placeholder:"2023-07-01-preview",tooltip:"By default litellm will use the latest version. If you want to use a different version, you can specify it here"},{key:"base_model",label:"Base Model",placeholder:"azure/gpt-3.5-turbo"},{key:"api_key",label:"Azure API Key",type:"password",required:!0}],[a.Azure_AI_Studio]:[{key:"api_base",label:"API Base",placeholder:"https://<test>.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-10-21",tooltip:"Enter your full Target URI from Azure Foundry here. Example:  https://litellm8397336933.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-10-21",required:!0},{key:"api_key",label:"Azure API Key",type:"password",required:!0}],[a.OpenAI_Compatible]:[{key:"api_base",label:"API Base",placeholder:"https://...",required:!0},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[a.OpenAI_Text_Compatible]:[{key:"api_base",label:"API Base",placeholder:"https://...",required:!0},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[a.Bedrock]:[{key:"aws_access_key_id",label:"AWS Access Key ID",required:!0,tooltip:"You can provide the raw key or the environment variable (e.g. `os.environ/MY_SECRET_KEY`)."},{key:"aws_secret_access_key",label:"AWS Secret Access Key",required:!0,tooltip:"You can provide the raw key or the environment variable (e.g. `os.environ/MY_SECRET_KEY`)."},{key:"aws_region_name",label:"AWS Region Name",placeholder:"us-east-1",required:!0,tooltip:"You can provide the raw key or the environment variable (e.g. `os.environ/MY_SECRET_KEY`)."}],[a.Ollama]:[],[a.Anthropic]:[{key:"api_key",label:"API Key",placeholder:"sk-",type:"password",required:!0}],[a.Google_AI_Studio]:[{key:"api_key",label:"API Key",placeholder:"aig-",type:"password",required:!0}],[a.Groq]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.MistralAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.Deepseek]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.Cohere]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.Databricks]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.xAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.Cerebras]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.Sambanova]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.Perplexity]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.TogetherAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.Openrouter]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[a.FireworksAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}]};var lo=e=>{let{selectedProvider:l,uploadProps:s}=e,t=a[l],n=i.useMemo(()=>ln[t]||[],[t]);return(0,r.jsx)(r.Fragment,{children:n.map(e=>{var l;return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(E.Z.Item,{label:e.label,name:e.key,rules:e.required?[{required:!0,message:"Required"}]:void 0,tooltip:e.tooltip,className:"vertex_credentials"===e.key?"mb-0":void 0,children:"select"===e.type?(0,r.jsx)(A.default,{placeholder:e.placeholder,defaultValue:e.defaultValue,children:null===(l=e.options)||void 0===l?void 0:l.map(e=>(0,r.jsx)(A.default.Option,{value:e,children:e},e))}):"upload"===e.type?(0,r.jsx)($.Z,{...s,children:(0,r.jsx)(L.ZP,{icon:(0,r.jsx)(ee.Z,{}),children:"Click to Upload"})}):(0,r.jsx)(Z.Z,{placeholder:e.placeholder,type:"password"===e.type?"password":"text"})}),"vertex_credentials"===e.key&&(0,r.jsxs)(la.Z,{children:[(0,r.jsx)(lr.Z,{span:10}),(0,r.jsx)(lr.Z,{span:10,children:(0,r.jsx)(S.Z,{className:"mb-3 mt-1",children:"Give litellm a gcp service account(.json file), so it can make the relevant calls"})})]}),"base_model"===e.key&&(0,r.jsxs)(la.Z,{children:[(0,r.jsx)(lr.Z,{span:10}),(0,r.jsx)(lr.Z,{span:10,children:(0,r.jsxs)(S.Z,{className:"mb-2",children:["The actual model your azure deployment uses. Used for accurate cost tracking. Select name from"," ",(0,r.jsx)(li,{href:"https://github.com/BerriAI/litellm/blob/main/model_prices_and_context_window.json",target:"_blank",children:"here"})]})})]})]},e.key)})})};let{Title:ld,Link:lc}=G.default;var lm=e=>{let{isVisible:l,onCancel:s,onAddCredential:t,onUpdateCredential:n,uploadProps:o,addOrEdit:d,existingCredential:c}=e,[m]=E.Z.useForm(),[u,h]=(0,i.useState)(a.OpenAI),[x,p]=(0,i.useState)(!1);return console.log("existingCredential in add credentials tab: ".concat(JSON.stringify(c))),(0,r.jsx)(O.Z,{title:"add"===d?"Add New Credential":"Edit Credential",visible:l,onCancel:()=>{s(),m.resetFields()},footer:null,width:600,children:(0,r.jsxs)(E.Z,{form:m,onFinish:e=>{"add"===d?t(e):n(e),m.resetFields()},layout:"vertical",children:[(0,r.jsx)(E.Z.Item,{label:"Credential Name:",name:"credential_name",rules:[{required:!0,message:"Credential name is required"}],initialValue:null==c?void 0:c.credential_name,children:(0,r.jsx)(Z.Z,{placeholder:"Enter a friendly name for these credentials",disabled:null!=c&&!!c.credential_name})}),(0,r.jsx)(E.Z.Item,{rules:[{required:!0,message:"Required"}],label:"Provider:",name:"custom_llm_provider",tooltip:"Helper to auto-populate provider specific fields",children:(0,r.jsx)(A.default,{value:(null==c?void 0:c.credential_info.custom_llm_provider)||u,onChange:e=>{h(e)},children:Object.entries(a).map(e=>{let[l,s]=e;return(0,r.jsx)(A.default.Option,{value:l,children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("img",{src:e8[s],alt:"".concat(l," logo"),className:"w-5 h-5",onError:e=>{let l=e.target,t=l.parentElement;if(t){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=s.charAt(0),t.replaceChild(e,l)}}}),(0,r.jsx)("span",{children:s})]})},l)})})}),(0,r.jsx)(lo,{selectedProvider:u,uploadProps:o}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(V.Z,{title:"Get help on our github",children:(0,r.jsx)(lc,{href:"https://github.com/BerriAI/litellm/issues",children:"Need Help?"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(L.ZP,{onClick:()=>{s(),m.resetFields()},style:{marginRight:10},children:"Cancel"}),(0,r.jsx)(L.ZP,{htmlType:"submit",children:"add"===d?"Add Credential":"Update Credential"})]})]})]})})},lu=e=>{let{accessToken:l,uploadProps:s,credentialList:t,fetchCredentials:a}=e,[n,o]=(0,i.useState)(!1),[d,c]=(0,i.useState)(!1),[m,u]=(0,i.useState)(null),[h]=E.Z.useForm();console.log("selectedCredential in credentials panel: ".concat(JSON.stringify(m)));let x=["credential_name","custom_llm_provider"],p=async e=>{if(!l){console.error("No access token found");return}let s=Object.entries(e).filter(e=>{let[l]=e;return!x.includes(l)}).reduce((e,l)=>{let[s,t]=l;return{...e,[s]:t}},{}),t={credential_name:e.credential_name,credential_values:s,credential_info:{custom_llm_provider:e.custom_llm_provider}},r=await (0,g.eZ)(l,e.credential_name,t);P.ZP.success("Credential updated successfully"),console.log("response: ".concat(JSON.stringify(r))),c(!1),a(l)},j=async e=>{if(!l){console.error("No access token found");return}let s=Object.entries(e).filter(e=>{let[l]=e;return!x.includes(l)}).reduce((e,l)=>{let[s,t]=l;return{...e,[s]:t}},{}),t={credential_name:e.credential_name,credential_values:s,credential_info:{custom_llm_provider:e.custom_llm_provider}},r=await (0,g.oC)(l,t);P.ZP.success("Credential added successfully"),console.log("response: ".concat(JSON.stringify(r))),o(!1),a(l)};(0,i.useEffect)(()=>{l&&a(l)},[l]);let f=e=>{let l={openai:"blue",azure:"indigo",anthropic:"purple",default:"gray"},s=l[e.toLowerCase()]||l.default;return(0,r.jsx)(eO.Z,{color:s,size:"xs",children:e})},_=async e=>{if(!l){console.error("No access token found");return}let s=await (0,g.gX)(l,e);console.log("response: ".concat(JSON.stringify(s))),P.ZP.success("Credential deleted successfully"),a(l)};return(0,r.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,r.jsxs)(S.Z,{children:["Configured credentials for different AI providers. Add and manage your API credentials."," ",(0,r.jsx)("a",{href:"https://docs.litellm.ai/docs/credentials",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700 underline",children:"Docs"})]})}),(0,r.jsx)(eT.Z,{children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Credential Name"}),(0,r.jsx)(eI.Z,{children:"Provider"}),(0,r.jsx)(eI.Z,{children:"Description"})]})}),(0,r.jsx)(ek.Z,{children:t&&0!==t.length?t.map((e,l)=>{var s,t;return(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:e.credential_name}),(0,r.jsx)(eS.Z,{children:f((null===(s=e.credential_info)||void 0===s?void 0:s.custom_llm_provider)||"-")}),(0,r.jsx)(eS.Z,{children:(null===(t=e.credential_info)||void 0===t?void 0:t.description)||"-"}),(0,r.jsxs)(eS.Z,{children:[(0,r.jsx)(b.Z,{icon:lt.Z,variant:"light",size:"sm",onClick:()=>{console.log("credential being set: ".concat(JSON.stringify(e))),u(e),c(!0)}}),(0,r.jsx)(b.Z,{icon:eV.Z,variant:"light",size:"sm",onClick:()=>_(e.credential_name)})]})]},l)}):(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{colSpan:4,className:"text-center py-4 text-gray-500",children:"No credentials configured"})})})]})}),(0,r.jsx)(b.Z,{onClick:()=>o(!0),className:"mt-4",children:"Add Credential"}),n&&(0,r.jsx)(lm,{onAddCredential:j,isVisible:n,onCancel:()=>o(!1),uploadProps:s,addOrEdit:"add",onUpdateCredential:p,existingCredential:null}),d&&(0,r.jsx)(lm,{onAddCredential:j,isVisible:d,existingCredential:m,onUpdateCredential:p,uploadProps:s,onCancel:()=>c(!1),addOrEdit:"edit"})]})};let lh=e=>{var l;return(null==e?void 0:null===(l=e.model_info)||void 0===l?void 0:l.team_public_model_name)?e.model_info.team_public_model_name:(null==e?void 0:e.model_name)||"-"},lx=async(e,l,s,t)=>{if(console.log("handleEditSubmit:",e),null==l)return;let a={},r=null;for(let[l,s]of(e.input_cost_per_token&&(e.input_cost_per_token=Number(e.input_cost_per_token)/1e6),e.output_cost_per_token&&(e.output_cost_per_token=Number(e.output_cost_per_token)/1e6),Object.entries(e)))"model_id"!==l?a[l]=""===s?null:s:r=""===s?null:s;let i={litellm_params:Object.keys(a).length>0?a:void 0,model_info:void 0!==r?{id:r}:void 0};console.log("handleEditSubmit payload:",i);try{await (0,g.um)(l,i),P.ZP.success("Model updated successfully, restart server to see updates"),s(!1),t(null)}catch(e){console.log("Error occurred")}};var lp=e=>{let{visible:l,onCancel:s,model:t,onSubmit:a}=e,[i]=E.Z.useForm(),n={},o="",d="";if(t){var c,m;n={...t.litellm_params,input_cost_per_token:(null===(c=t.litellm_params)||void 0===c?void 0:c.input_cost_per_token)?1e6*t.litellm_params.input_cost_per_token:void 0,output_cost_per_token:(null===(m=t.litellm_params)||void 0===m?void 0:m.output_cost_per_token)?1e6*t.litellm_params.output_cost_per_token:void 0},o=t.model_name;let e=t.model_info;e&&(d=e.id,console.log("model_id: ".concat(d)),n.model_id=d)}return(0,r.jsx)(O.Z,{title:"Edit '"+o+"' LiteLLM Params",visible:l,width:800,footer:null,onOk:()=>{i.validateFields().then(e=>{a({...e,input_cost_per_token:e.input_cost_per_token?Number(e.input_cost_per_token)/1e6:void 0,output_cost_per_token:e.output_cost_per_token?Number(e.output_cost_per_token)/1e6:void 0}),i.resetFields()}).catch(e=>{console.error("Validation failed:",e)})},onCancel:s,children:(0,r.jsxs)(E.Z,{form:i,onFinish:a,initialValues:n,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z.Item,{label:"Input Cost (per 1M tokens)",name:"input_cost_per_token",tooltip:"float (optional) - Input cost per 1 million tokens",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"Output Cost (per 1M tokens)",name:"output_cost_per_token",tooltip:"float (optional) - Output cost per 1 million tokens",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{className:"mt-8",label:"api_base",name:"api_base",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{className:"mt-8",label:"api_key",name:"api_key",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{className:"mt-8",label:"custom_llm_provider",name:"custom_llm_provider",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{className:"mt-8",label:"model",name:"model",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"organization",name:"organization",tooltip:"OpenAI Organization ID",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"tpm",name:"tpm",tooltip:"int (optional) - Tokens limit for this deployment: in tokens per minute (tpm). Find this information on your model/providers website",children:(0,r.jsx)(M.Z,{min:0,step:1})}),(0,r.jsx)(E.Z.Item,{label:"rpm",name:"rpm",tooltip:"int (optional) - Rate limit for this deployment: in requests per minute (rpm). Find this information on your model/providers website",children:(0,r.jsx)(M.Z,{min:0,step:1})}),(0,r.jsx)(E.Z.Item,{label:"max_retries",name:"max_retries",children:(0,r.jsx)(M.Z,{min:0,step:1})}),(0,r.jsx)(E.Z.Item,{label:"timeout",name:"timeout",tooltip:"int (optional) - Timeout in seconds for LLM requests (Defaults to 600 seconds)",children:(0,r.jsx)(M.Z,{min:0,step:1})}),(0,r.jsx)(E.Z.Item,{label:"stream_timeout",name:"stream_timeout",tooltip:"int (optional) - Timeout for stream requests (seconds)",children:(0,r.jsx)(M.Z,{min:0,step:1})}),(0,r.jsx)(E.Z.Item,{label:"model_id",name:"model_id",hidden:!0})]}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Save"})})]})})},lg=s(53003),lj=s(47323),lf=s(75105),l_=s(40278),ly=s(14301),lv=s(59664),lb=e=>{let{modelMetrics:l,modelMetricsCategories:s,customTooltip:t,premiumUser:a}=e;return(0,r.jsx)(lv.Z,{title:"Time to First token (s)",className:"h-72",data:l,index:"date",showLegend:!1,categories:s,colors:["indigo","rose"],connectNulls:!0,customTooltip:t})},lZ=e=>{var l,s,t;let{visible:a,onCancel:n,onSubmit:o,initialData:d,mode:c,config:m}=e,[u]=E.Z.useForm();console.log("Initial Data:",d),(0,i.useEffect)(()=>{if(a){if("edit"===c&&d)u.setFieldsValue({...d,role:d.role||m.defaultRole});else{var e;u.resetFields(),u.setFieldsValue({role:m.defaultRole||(null===(e=m.roleOptions[0])||void 0===e?void 0:e.value)})}}},[a,d,c,u,m.defaultRole,m.roleOptions]);let h=async e=>{try{let l=Object.entries(e).reduce((e,l)=>{let[s,t]=l;return{...e,[s]:"string"==typeof t?t.trim():t}},{});o(l),u.resetFields(),P.ZP.success("Successfully ".concat("add"===c?"added":"updated"," member"))}catch(e){P.ZP.error("Failed to submit form"),console.error("Form submission error:",e)}},x=e=>{switch(e.type){case"input":return(0,r.jsx)(D.Z,{className:"px-3 py-2 border rounded-md w-full",onChange:e=>{e.target.value=e.target.value.trim()}});case"select":var l;return(0,r.jsx)(A.default,{children:null===(l=e.options)||void 0===l?void 0:l.map(e=>(0,r.jsx)(A.default.Option,{value:e.value,children:e.label},e.value))});default:return null}};return(0,r.jsx)(O.Z,{title:m.title||("add"===c?"Add Member":"Edit Member"),open:a,width:800,footer:null,onCancel:n,children:(0,r.jsxs)(E.Z,{form:u,onFinish:h,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[m.showEmail&&(0,r.jsx)(E.Z.Item,{label:"Email",name:"user_email",className:"mb-4",rules:[{type:"email",message:"Please enter a valid email!"}],children:(0,r.jsx)(D.Z,{className:"px-3 py-2 border rounded-md w-full",placeholder:"user@example.com",onChange:e=>{e.target.value=e.target.value.trim()}})}),m.showEmail&&m.showUserId&&(0,r.jsx)("div",{className:"text-center mb-4",children:(0,r.jsx)(S.Z,{children:"OR"})}),m.showUserId&&(0,r.jsx)(E.Z.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,r.jsx)(D.Z,{className:"px-3 py-2 border rounded-md w-full",placeholder:"user_123",onChange:e=>{e.target.value=e.target.value.trim()}})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:"Role"}),"edit"===c&&d&&(0,r.jsxs)("span",{className:"text-gray-500 text-sm",children:["(Current: ",(s=d.role,(null===(t=m.roleOptions.find(e=>e.value===s))||void 0===t?void 0:t.label)||s),")"]})]}),name:"role",className:"mb-4",rules:[{required:!0,message:"Please select a role!"}],children:(0,r.jsx)(A.default,{children:"edit"===c&&d?[...m.roleOptions.filter(e=>e.value===d.role),...m.roleOptions.filter(e=>e.value!==d.role)].map(e=>(0,r.jsx)(A.default.Option,{value:e.value,children:e.label},e.value)):m.roleOptions.map(e=>(0,r.jsx)(A.default.Option,{value:e.value,children:e.label},e.value))})}),null===(l=m.additionalFields)||void 0===l?void 0:l.map(e=>(0,r.jsx)(E.Z.Item,{label:e.label,name:e.name,className:"mb-4",rules:e.rules,children:x(e)},e.name)),(0,r.jsxs)("div",{className:"text-right mt-6",children:[(0,r.jsx)(L.ZP,{onClick:n,className:"mr-2",children:"Cancel"}),(0,r.jsx)(L.ZP,{type:"default",htmlType:"submit",children:"add"===c?"Add Member":"Save Changes"})]})]})})},lN=e=>{let{isVisible:l,onCancel:s,onSubmit:t,accessToken:a,title:n="Add Team Member",roles:o=[{label:"admin",value:"admin",description:"Admin role. Can create team keys, add members, and manage settings."},{label:"user",value:"user",description:"User role. Can view team info, but not manage it."}],defaultRole:d="user"}=e,[c]=E.Z.useForm(),[m,u]=(0,i.useState)([]),[h,x]=(0,i.useState)(!1),[p,j]=(0,i.useState)("user_email"),f=async(e,l)=>{if(!e){u([]);return}x(!0);try{let s=new URLSearchParams;if(s.append(l,e),null==a)return;let t=(await (0,g.u5)(a,s)).map(e=>({label:"user_email"===l?"".concat(e.user_email):"".concat(e.user_id),value:"user_email"===l?e.user_email:e.user_id,user:e}));u(t)}catch(e){console.error("Error fetching users:",e)}finally{x(!1)}},_=(0,i.useCallback)(ed()((e,l)=>f(e,l),300),[]),y=(e,l)=>{j(l),_(e,l)},v=(e,l)=>{let s=l.user;c.setFieldsValue({user_email:s.user_email,user_id:s.user_id,role:c.getFieldValue("role")})};return(0,r.jsx)(O.Z,{title:n,open:l,onCancel:()=>{c.resetFields(),u([]),s()},footer:null,width:800,children:(0,r.jsxs)(E.Z,{form:c,onFinish:t,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",initialValues:{role:d},children:[(0,r.jsx)(E.Z.Item,{label:"Email",name:"user_email",className:"mb-4",children:(0,r.jsx)(A.default,{showSearch:!0,className:"w-full",placeholder:"Search by email",filterOption:!1,onSearch:e=>y(e,"user_email"),onSelect:(e,l)=>v(e,l),options:"user_email"===p?m:[],loading:h,allowClear:!0})}),(0,r.jsx)("div",{className:"text-center mb-4",children:"OR"}),(0,r.jsx)(E.Z.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,r.jsx)(A.default,{showSearch:!0,className:"w-full",placeholder:"Search by user ID",filterOption:!1,onSearch:e=>y(e,"user_id"),onSelect:(e,l)=>v(e,l),options:"user_id"===p?m:[],loading:h,allowClear:!0})}),(0,r.jsx)(E.Z.Item,{label:"Member Role",name:"role",className:"mb-4",children:(0,r.jsx)(A.default,{defaultValue:d,children:o.map(e=>(0,r.jsx)(A.default.Option,{value:e.value,children:(0,r.jsxs)(V.Z,{title:e.description,children:[(0,r.jsx)("span",{className:"font-medium",children:e.label}),(0,r.jsxs)("span",{className:"ml-2 text-gray-500 text-sm",children:["- ",e.description]})]})},e.value))})}),(0,r.jsx)("div",{className:"text-right mt-4",children:(0,r.jsx)(L.ZP,{type:"default",htmlType:"submit",children:"Add Member"})})]})})},lw=e=>{var l;let{teamId:s,onClose:t,accessToken:a,is_team_admin:n,is_proxy_admin:o,userModels:d,editTeam:c}=e,[m,u]=(0,i.useState)(null),[h,x]=(0,i.useState)(!0),[p,j]=(0,i.useState)(!1),[f]=E.Z.useForm(),[_,y]=(0,i.useState)(!1),[Z,N]=(0,i.useState)(null),[w,k]=(0,i.useState)(!1);console.log("userModels in team info",d);let I=n||o,O=async()=>{try{if(x(!0),!a)return;let e=await (0,g.Xm)(a,s);u(e)}catch(e){P.ZP.error("Failed to load team information"),console.error("Error fetching team info:",e)}finally{x(!1)}};(0,i.useEffect)(()=>{O()},[s,a]);let T=async e=>{try{if(null==a)return;let l={user_email:e.user_email,user_id:e.user_id,role:e.role};await (0,g.cu)(a,s,l),P.ZP.success("Team member added successfully"),j(!1),f.resetFields(),O()}catch(e){P.ZP.error("Failed to add team member"),console.error("Error adding team member:",e)}},F=async e=>{try{if(null==a)return;let l={user_email:e.user_email,user_id:e.user_id,role:e.role};await (0,g.sN)(a,s,l),P.ZP.success("Team member updated successfully"),y(!1),O()}catch(e){P.ZP.error("Failed to update team member"),console.error("Error updating team member:",e)}},U=async e=>{try{if(null==a)return;await (0,g.Lp)(a,s,e),P.ZP.success("Team member removed successfully"),O()}catch(e){P.ZP.error("Failed to remove team member"),console.error("Error removing team member:",e)}},q=async e=>{try{if(!a)return;let l={team_id:s,team_alias:e.team_alias,models:e.models,tpm_limit:e.tpm_limit,rpm_limit:e.rpm_limit,max_budget:e.max_budget,budget_duration:e.budget_duration,metadata:{...e.metadata,guardrails:e.guardrails||[]}};await (0,g.Gh)(a,l),P.ZP.success("Team settings updated successfully"),k(!1),O()}catch(e){P.ZP.error("Failed to update team settings"),console.error("Error updating team:",e)}};if(h)return(0,r.jsx)("div",{className:"p-4",children:"Loading..."});if(!(null==m?void 0:m.team_info))return(0,r.jsx)("div",{className:"p-4",children:"Team not found"});let{team_info:K}=m;return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(L.ZP,{onClick:t,className:"mb-4",children:"← Back"}),(0,r.jsx)(C.Z,{children:K.team_alias}),(0,r.jsx)(S.Z,{className:"text-gray-500 font-mono",children:K.team_id})]})}),(0,r.jsxs)(eM.Z,{defaultIndex:c?2:0,children:[(0,r.jsx)(eD.Z,{className:"mb-4",children:[(0,r.jsx)(eL.Z,{children:"Overview"},"overview"),...I?[(0,r.jsx)(eL.Z,{children:"Members"},"members"),(0,r.jsx)(eL.Z,{children:"Settings"},"settings")]:[]]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Budget Status"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(C.Z,{children:["$",K.spend.toFixed(6)]}),(0,r.jsxs)(S.Z,{children:["of ",null===K.max_budget?"Unlimited":"$".concat(K.max_budget)]}),K.budget_duration&&(0,r.jsxs)(S.Z,{className:"text-gray-500",children:["Reset: ",K.budget_duration]})]})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Rate Limits"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(S.Z,{children:["TPM: ",K.tpm_limit||"Unlimited"]}),(0,r.jsxs)(S.Z,{children:["RPM: ",K.rpm_limit||"Unlimited"]}),K.max_parallel_requests&&(0,r.jsxs)(S.Z,{children:["Max Parallel Requests: ",K.max_parallel_requests]})]})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Models"}),(0,r.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:K.models.map((e,l)=>(0,r.jsx)(eO.Z,{color:"red",children:e},l))})]})]})}),(0,r.jsx)(eF.Z,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(eT.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"User ID"}),(0,r.jsx)(eI.Z,{children:"User Email"}),(0,r.jsx)(eI.Z,{children:"Role"}),(0,r.jsx)(eI.Z,{})]})}),(0,r.jsx)(ek.Z,{children:m.team_info.members_with_roles.map((e,l)=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{className:"font-mono",children:e.user_id})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{className:"font-mono",children:e.user_email})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{className:"font-mono",children:e.role})}),(0,r.jsx)(eS.Z,{children:I&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(lj.Z,{icon:lt.Z,size:"sm",onClick:()=>{N(e),y(!0)}}),(0,r.jsx)(lj.Z,{onClick:()=>U(e),icon:eV.Z,size:"sm"})]})})]},l))})]})}),(0,r.jsx)(b.Z,{onClick:()=>j(!0),children:"Add Member"})]})}),(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(C.Z,{children:"Team Settings"}),I&&!w&&(0,r.jsx)(b.Z,{onClick:()=>k(!0),children:"Edit Settings"})]}),w?(0,r.jsxs)(E.Z,{form:f,onFinish:q,initialValues:{...K,team_alias:K.team_alias,models:K.models,tpm_limit:K.tpm_limit,rpm_limit:K.rpm_limit,max_budget:K.max_budget,budget_duration:K.budget_duration,guardrails:(null===(l=K.metadata)||void 0===l?void 0:l.guardrails)||[],metadata:K.metadata?JSON.stringify(K.metadata,null,2):""},layout:"vertical",children:[(0,r.jsx)(E.Z.Item,{label:"Team Name",name:"team_alias",rules:[{required:!0,message:"Please input a team name"}],children:(0,r.jsx)(D.Z,{type:""})}),(0,r.jsx)(E.Z.Item,{label:"Models",name:"models",children:(0,r.jsxs)(A.default,{mode:"multiple",placeholder:"Select models",children:[(0,r.jsx)(A.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),d.map(e=>(0,r.jsx)(A.default.Option,{value:e,children:R(e)},e))]})}),(0,r.jsx)(E.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,r.jsx)(M.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,r.jsxs)(A.default,{placeholder:"n/a",children:[(0,r.jsx)(A.default.Option,{value:"24h",children:"daily"}),(0,r.jsx)(A.default.Option,{value:"7d",children:"weekly"}),(0,r.jsx)(A.default.Option,{value:"30d",children:"monthly"})]})}),(0,r.jsx)(E.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,r.jsx)(M.Z,{step:1,style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,r.jsx)(M.Z,{step:1,style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Guardrails"," ",(0,r.jsx)(V.Z,{title:"Setup your first guardrail",children:(0,r.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",help:"Select existing guardrails or enter new ones",children:(0,r.jsx)(A.default,{mode:"tags",placeholder:"Select or enter guardrails"})}),(0,r.jsx)(E.Z.Item,{label:"Metadata",name:"metadata",children:(0,r.jsx)(D.Z.TextArea,{rows:10})}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,r.jsx)(L.ZP,{onClick:()=>k(!1),children:"Cancel"}),(0,r.jsx)(b.Z,{children:"Save Changes"})]})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Team Name"}),(0,r.jsx)("div",{children:K.team_alias})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Team ID"}),(0,r.jsx)("div",{className:"font-mono",children:K.team_id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Created At"}),(0,r.jsx)("div",{children:new Date(K.created_at).toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Models"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:K.models.map((e,l)=>(0,r.jsx)(eO.Z,{color:"red",children:e},l))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Rate Limits"}),(0,r.jsxs)("div",{children:["TPM: ",K.tpm_limit||"Unlimited"]}),(0,r.jsxs)("div",{children:["RPM: ",K.rpm_limit||"Unlimited"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Budget"}),(0,r.jsxs)("div",{children:["Max: ",null!==K.max_budget?"$".concat(K.max_budget):"No Limit"]}),(0,r.jsxs)("div",{children:["Reset: ",K.budget_duration||"Never"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Status"}),(0,r.jsx)(eO.Z,{color:K.blocked?"red":"green",children:K.blocked?"Blocked":"Active"})]})]})]})})]})]}),(0,r.jsx)(lZ,{visible:_,onCancel:()=>y(!1),onSubmit:F,initialData:Z,mode:"edit",config:{title:"Edit Member",showEmail:!0,showUserId:!0,roleOptions:[{label:"Admin",value:"admin"},{label:"User",value:"user"}]}}),(0,r.jsx)(lN,{isVisible:p,onCancel:()=>j(!1),onSubmit:T,accessToken:a})]})},lk=s(30150),lS=s(45589);let{Title:lC,Link:lI}=G.default;var lA=e=>{let{isVisible:l,onCancel:s,onAddCredential:t,existingCredential:a,setIsCredentialModalOpen:i}=e,[n]=E.Z.useForm();return console.log("existingCredential in add credentials tab: ".concat(JSON.stringify(a))),(0,r.jsx)(O.Z,{title:"Reuse Credentials",visible:l,onCancel:()=>{s(),n.resetFields()},footer:null,width:600,children:(0,r.jsxs)(E.Z,{form:n,onFinish:e=>{t(e),n.resetFields(),i(!1)},layout:"vertical",children:[(0,r.jsx)(E.Z.Item,{label:"Credential Name:",name:"credential_name",rules:[{required:!0,message:"Credential name is required"}],initialValue:null==a?void 0:a.credential_name,children:(0,r.jsx)(Z.Z,{placeholder:"Enter a friendly name for these credentials"})}),Object.entries((null==a?void 0:a.credential_values)||{}).map(e=>{let[l,s]=e;return(0,r.jsx)(E.Z.Item,{label:l,name:l,initialValue:s,children:(0,r.jsx)(Z.Z,{placeholder:"Enter ".concat(l),disabled:!0})},l)}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(V.Z,{title:"Get help on our github",children:(0,r.jsx)(lI,{href:"https://github.com/BerriAI/litellm/issues",children:"Need Help?"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(L.ZP,{onClick:()=>{s(),n.resetFields()},style:{marginRight:10},children:"Cancel"}),(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Reuse Credentials"})]})]})]})})};function lE(e){var l,s,t,a,n,o,d,c,m,u,h,x,p,j,f,_,y,N;let{modelId:w,onClose:k,modelData:I,accessToken:A,userID:T,userRole:M,editModel:D,setEditModalVisible:F,setSelectedModel:R,onModelUpdate:U}=e,[z]=E.Z.useForm(),[V,q]=(0,i.useState)(null),[K,B]=(0,i.useState)(!1),[H,J]=(0,i.useState)(!1),[W,G]=(0,i.useState)(!1),[Y,$]=(0,i.useState)(!1),[X,Q]=(0,i.useState)(!1),[ee,el]=(0,i.useState)(null),es=(null===(l=I.litellm_params)||void 0===l?void 0:l.litellm_credential_name)!=null&&(null===(s=I.litellm_params)||void 0===s?void 0:s.litellm_credential_name)!=void 0;console.log("usingExistingCredential, ",es),console.log("modelData.litellm_params.litellm_credential_name, ",I.litellm_params.litellm_credential_name),(0,i.useEffect)(()=>{let e=async()=>{if(!A)return;let e=await (0,g.ix)(A,w);console.log("modelInfoResponse, ",e),q(e.data[0])};(async()=>{if(console.log("accessToken, ",A),!A||es)return;let e=await (0,g.Qg)(A,null,w);console.log("existingCredentialResponse, ",e),el({credential_name:e.credential_name,credential_values:e.credential_values,credential_info:e.credential_info})})(),e()},[A,w]);let et=async e=>{var l;if(console.log("values, ",e),!A)return;let s={credential_name:e.credential_name,model_id:w,credential_info:{custom_llm_provider:null===(l=V.litellm_params)||void 0===l?void 0:l.custom_llm_provider}};P.ZP.info("Storing credential.."),console.log("credentialResponse, ",await (0,g.oC)(A,s)),P.ZP.success("Credential stored successfully")},ea=async e=>{try{if(!A)return;$(!0);let l={model_name:e.model_name,litellm_params:{...V.litellm_params,model:e.litellm_model_name,api_base:e.api_base,custom_llm_provider:e.custom_llm_provider,organization:e.organization,tpm:e.tpm,rpm:e.rpm,max_retries:e.max_retries,timeout:e.timeout,stream_timeout:e.stream_timeout,input_cost_per_token:e.input_cost/1e6,output_cost_per_token:e.output_cost/1e6},model_info:{id:w}};await (0,g.um)(A,l);let s={...V,model_name:e.model_name,litellm_model_name:e.litellm_model_name,litellm_params:l.litellm_params};q(s),U&&U(s),P.ZP.success("Model settings updated successfully"),G(!1),Q(!1)}catch(e){console.error("Error updating model:",e),P.ZP.error("Failed to update model settings")}finally{$(!1)}};if(!I)return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)(L.ZP,{icon:(0,r.jsx)(eU.Z,{}),onClick:k,className:"mb-4",children:"Back to Models"}),(0,r.jsx)(S.Z,{children:"Model not found"})]});let er=async()=>{try{if(!A)return;await (0,g.Og)(A,w),P.ZP.success("Model deleted successfully"),U&&U({deleted:!0,model_info:{id:w}}),k()}catch(e){console.error("Error deleting the model:",e),P.ZP.error("Failed to delete model")}};return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(L.ZP,{icon:(0,r.jsx)(eU.Z,{}),onClick:k,className:"mb-4",children:"Back to Models"}),(0,r.jsxs)(C.Z,{children:["Public Model Name: ",lh(I)]}),(0,r.jsx)(S.Z,{className:"text-gray-500 font-mono",children:I.model_info.id})]}),"Admin"===M&&(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(b.Z,{icon:lS.Z,variant:"secondary",onClick:()=>J(!0),className:"flex items-center",children:"Re-use Credentials"}),(0,r.jsx)(b.Z,{icon:eV.Z,variant:"secondary",onClick:()=>B(!0),className:"flex items-center",children:"Delete Model"})]})]}),(0,r.jsxs)(eM.Z,{children:[(0,r.jsxs)(eD.Z,{className:"mb-6",children:[(0,r.jsx)(eL.Z,{children:"Overview"}),(0,r.jsx)(eL.Z,{children:"Raw JSON"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsxs)(eF.Z,{children:[(0,r.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6 mb-6",children:[(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Provider"}),(0,r.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[I.provider&&(0,r.jsx)("img",{src:e7(I.provider).logo,alt:"".concat(I.provider," logo"),className:"w-4 h-4",onError:e=>{let l=e.target,s=l.parentElement;if(s){var t;let e=document.createElement("div");e.className="w-4 h-4 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=(null===(t=I.provider)||void 0===t?void 0:t.charAt(0))||"-",s.replaceChild(e,l)}}}),(0,r.jsx)(C.Z,{children:I.provider||"Not Set"})]})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"LiteLLM Model"}),(0,r.jsx)("pre",{children:(0,r.jsx)(C.Z,{children:I.litellm_model_name||"Not Set"})})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Pricing"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(S.Z,{children:["Input: $",I.input_cost,"/1M tokens"]}),(0,r.jsxs)(S.Z,{children:["Output: $",I.output_cost,"/1M tokens"]})]})]})]}),(0,r.jsxs)("div",{className:"mb-6 text-sm text-gray-500 flex items-center gap-x-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Created At ",I.model_info.created_at?new Date(I.model_info.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Not Set"]}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Created By ",I.model_info.created_by||"Not Set"]})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(C.Z,{children:"Model Settings"}),"Admin"===M&&!X&&(0,r.jsx)(b.Z,{variant:"secondary",onClick:()=>Q(!0),className:"flex items-center",children:"Edit Model"})]}),V?(0,r.jsx)(E.Z,{form:z,onFinish:ea,initialValues:{model_name:V.model_name,litellm_model_name:V.litellm_model_name,api_base:V.litellm_params.api_base,custom_llm_provider:V.litellm_params.custom_llm_provider,organization:V.litellm_params.organization,tpm:V.litellm_params.tpm,rpm:V.litellm_params.rpm,max_retries:V.litellm_params.max_retries,timeout:V.litellm_params.timeout,stream_timeout:V.litellm_params.stream_timeout,input_cost:V.litellm_params.input_cost_per_token?1e6*V.litellm_params.input_cost_per_token:(null===(t=V.model_info)||void 0===t?void 0:t.input_cost_per_token)*1e6||null,output_cost:(null===(a=V.litellm_params)||void 0===a?void 0:a.output_cost_per_token)?1e6*V.litellm_params.output_cost_per_token:(null===(n=V.model_info)||void 0===n?void 0:n.output_cost_per_token)*1e6||null},layout:"vertical",onValuesChange:()=>G(!0),children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Model Name"}),X?(0,r.jsx)(E.Z.Item,{name:"model_name",className:"mb-0",children:(0,r.jsx)(Z.Z,{placeholder:"Enter model name"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:V.model_name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"LiteLLM Model Name"}),X?(0,r.jsx)(E.Z.Item,{name:"litellm_model_name",className:"mb-0",children:(0,r.jsx)(Z.Z,{placeholder:"Enter LiteLLM model name"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:V.litellm_model_name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Input Cost (per 1M tokens)"}),X?(0,r.jsx)(E.Z.Item,{name:"input_cost",className:"mb-0",children:(0,r.jsx)(lk.Z,{placeholder:"Enter input cost"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null==V?void 0:null===(o=V.litellm_params)||void 0===o?void 0:o.input_cost_per_token)?((null===(d=V.litellm_params)||void 0===d?void 0:d.input_cost_per_token)*1e6).toFixed(4):(null==V?void 0:null===(c=V.model_info)||void 0===c?void 0:c.input_cost_per_token)?(1e6*V.model_info.input_cost_per_token).toFixed(4):null})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Output Cost (per 1M tokens)"}),X?(0,r.jsx)(E.Z.Item,{name:"output_cost",className:"mb-0",children:(0,r.jsx)(lk.Z,{placeholder:"Enter output cost"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null==V?void 0:null===(m=V.litellm_params)||void 0===m?void 0:m.output_cost_per_token)?(1e6*V.litellm_params.output_cost_per_token).toFixed(4):(null==V?void 0:null===(u=V.model_info)||void 0===u?void 0:u.output_cost_per_token)?(1e6*V.model_info.output_cost_per_token).toFixed(4):null})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"API Base"}),X?(0,r.jsx)(E.Z.Item,{name:"api_base",className:"mb-0",children:(0,r.jsx)(Z.Z,{placeholder:"Enter API base"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(h=V.litellm_params)||void 0===h?void 0:h.api_base)||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Custom LLM Provider"}),X?(0,r.jsx)(E.Z.Item,{name:"custom_llm_provider",className:"mb-0",children:(0,r.jsx)(Z.Z,{placeholder:"Enter custom LLM provider"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(x=V.litellm_params)||void 0===x?void 0:x.custom_llm_provider)||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Organization"}),X?(0,r.jsx)(E.Z.Item,{name:"organization",className:"mb-0",children:(0,r.jsx)(Z.Z,{placeholder:"Enter organization"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(p=V.litellm_params)||void 0===p?void 0:p.organization)||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"TPM (Tokens per Minute)"}),X?(0,r.jsx)(E.Z.Item,{name:"tpm",className:"mb-0",children:(0,r.jsx)(lk.Z,{placeholder:"Enter TPM"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(j=V.litellm_params)||void 0===j?void 0:j.tpm)||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"RPM (Requests per Minute)"}),X?(0,r.jsx)(E.Z.Item,{name:"rpm",className:"mb-0",children:(0,r.jsx)(lk.Z,{placeholder:"Enter RPM"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(f=V.litellm_params)||void 0===f?void 0:f.rpm)||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Max Retries"}),X?(0,r.jsx)(E.Z.Item,{name:"max_retries",className:"mb-0",children:(0,r.jsx)(lk.Z,{placeholder:"Enter max retries"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(_=V.litellm_params)||void 0===_?void 0:_.max_retries)||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Timeout (seconds)"}),X?(0,r.jsx)(E.Z.Item,{name:"timeout",className:"mb-0",children:(0,r.jsx)(lk.Z,{placeholder:"Enter timeout"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(y=V.litellm_params)||void 0===y?void 0:y.timeout)||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Stream Timeout (seconds)"}),X?(0,r.jsx)(E.Z.Item,{name:"stream_timeout",className:"mb-0",children:(0,r.jsx)(lk.Z,{placeholder:"Enter stream timeout"})}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(N=V.litellm_params)||void 0===N?void 0:N.stream_timeout)||"Not Set"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Team ID"}),(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:I.model_info.team_id||"Not Set"})]})]}),X&&(0,r.jsxs)("div",{className:"mt-6 flex justify-end gap-2",children:[(0,r.jsx)(b.Z,{variant:"secondary",onClick:()=>{z.resetFields(),G(!1),Q(!1)},children:"Cancel"}),(0,r.jsx)(b.Z,{variant:"primary",onClick:()=>z.submit(),loading:Y,children:"Save Changes"})]})]})}):(0,r.jsx)(S.Z,{children:"Loading..."})]})]}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(eT.Z,{children:(0,r.jsx)("pre",{className:"bg-gray-100 p-4 rounded text-xs overflow-auto",children:JSON.stringify(I,null,2)})})})]})]}),K&&(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Model"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this model?"})})]})})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)(L.ZP,{onClick:er,className:"ml-2",danger:!0,children:"Delete"}),(0,r.jsx)(L.ZP,{onClick:()=>B(!1),children:"Cancel"})]})]})]})}),H&&!es?(0,r.jsx)(lA,{isVisible:H,onCancel:()=>J(!1),onAddCredential:et,existingCredential:ee,setIsCredentialModalOpen:J}):(0,r.jsx)(O.Z,{open:H,onCancel:()=>J(!1),title:"Using Existing Credential",children:(0,r.jsx)(S.Z,{children:I.litellm_params.litellm_credential_name})})]})}var lP=s(67960),lO=e=>{let{selectedProvider:l,providerModels:s,getPlaceholder:t}=e,i=E.Z.useFormInstance(),n=e=>{let l=e.target.value,s=(i.getFieldValue("model_mappings")||[]).map(e=>"custom"===e.public_name||"custom"===e.litellm_model?{public_name:l,litellm_model:l}:e);i.setFieldsValue({model_mappings:s})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(E.Z.Item,{label:"LiteLLM Model Name(s)",tooltip:"Actual model name used for making litellm.completion() / litellm.embedding() call.",className:"mb-0",children:[(0,r.jsx)(E.Z.Item,{name:"model",rules:[{required:!0,message:"Please select at least one model."}],noStyle:!0,children:l===a.Azure||l===a.OpenAI_Compatible||l===a.Ollama?(0,r.jsx)(Z.Z,{placeholder:t(l)}):s.length>0?(0,r.jsx)(A.default,{mode:"multiple",allowClear:!0,showSearch:!0,placeholder:"Select models",onChange:e=>{let l=Array.isArray(e)?e:[e];if(l.includes("all-wildcard"))i.setFieldsValue({model_name:void 0,model_mappings:[]});else{let e=l.map(e=>({public_name:e,litellm_model:e}));i.setFieldsValue({model_mappings:e})}},optionFilterProp:"children",filterOption:(e,l)=>{var s;return(null!==(s=null==l?void 0:l.label)&&void 0!==s?s:"").toLowerCase().includes(e.toLowerCase())},options:[{label:"Custom Model Name (Enter below)",value:"custom"},{label:"All ".concat(l," Models (Wildcard)"),value:"all-wildcard"},...s.map(e=>({label:e,value:e}))],style:{width:"100%"}}):(0,r.jsx)(Z.Z,{placeholder:t(l)})}),(0,r.jsx)(E.Z.Item,{noStyle:!0,shouldUpdate:(e,l)=>e.model!==l.model,children:e=>{let{getFieldValue:l}=e,s=l("model")||[];return(Array.isArray(s)?s:[s]).includes("custom")&&(0,r.jsx)(E.Z.Item,{name:"custom_model_name",rules:[{required:!0,message:"Please enter a custom model name."}],className:"mt-2",children:(0,r.jsx)(Z.Z,{placeholder:"Enter custom model name",onChange:n})})}})]}),(0,r.jsxs)(la.Z,{children:[(0,r.jsx)(lr.Z,{span:10}),(0,r.jsx)(lr.Z,{span:10,children:(0,r.jsx)(S.Z,{className:"mb-3 mt-1",children:"Actual model name used for making litellm.completion() call. We loadbalance models with the same public name"})})]})]})},lT=()=>{let e=E.Z.useFormInstance(),[l,s]=(0,i.useState)(0),t=E.Z.useWatch("model",e)||[],a=Array.isArray(t)?t:[t],n=E.Z.useWatch("custom_model_name",e),o=!a.includes("all-wildcard");if((0,i.useEffect)(()=>{if(n&&a.includes("custom")){let l=(e.getFieldValue("model_mappings")||[]).map(e=>"custom"===e.public_name||"custom"===e.litellm_model?{public_name:n,litellm_model:n}:e);e.setFieldValue("model_mappings",l),s(e=>e+1)}},[n,a,e]),(0,i.useEffect)(()=>{if(a.length>0&&!a.includes("all-wildcard")){let l=a.map(e=>"custom"===e&&n?{public_name:n,litellm_model:n}:{public_name:e,litellm_model:e});e.setFieldValue("model_mappings",l),s(e=>e+1)}},[a,n,e]),!o)return null;let d=[{title:"Public Name",dataIndex:"public_name",key:"public_name",render:(l,s,t)=>(0,r.jsx)(Z.Z,{value:l,onChange:l=>{let s=[...e.getFieldValue("model_mappings")];s[t].public_name=l.target.value,e.setFieldValue("model_mappings",s)}})},{title:"LiteLLM Model",dataIndex:"litellm_model",key:"litellm_model"}];return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(E.Z.Item,{label:"Model Mappings",name:"model_mappings",tooltip:"Map public model names to LiteLLM model names for load balancing",labelCol:{span:10},wrapperCol:{span:16},labelAlign:"left",required:!0,children:(0,r.jsx)(X.Z,{dataSource:e.getFieldValue("model_mappings"),columns:d,pagination:!1,size:"small"},l)})})},lL=s(63709),lM=s(90464);let{Link:lD}=G.default;var lF=e=>{let{showAdvancedSettings:l,setShowAdvancedSettings:s,teams:t}=e,[a]=E.Z.useForm(),[n,o]=i.useState(!1),[d,c]=i.useState("per_token"),m=(e,l)=>l&&(isNaN(Number(l))||0>Number(l))?Promise.reject("Please enter a valid positive number"):Promise.resolve(),u=(e,l)=>{if(!l)return Promise.resolve();try{return JSON.parse(l),Promise.resolve()}catch(e){return Promise.reject("Please enter valid JSON")}};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(N.Z,{className:"mt-2 mb-4",children:[(0,r.jsx)(k.Z,{children:(0,r.jsx)("b",{children:"Advanced Settings"})}),(0,r.jsx)(w.Z,{children:(0,r.jsxs)("div",{className:"bg-white rounded-lg",children:[(0,r.jsx)(E.Z.Item,{label:"Team",name:"team_id",className:"mb-4",children:(0,r.jsx)(J,{teams:t})}),(0,r.jsx)(E.Z.Item,{label:"Custom Pricing",name:"custom_pricing",valuePropName:"checked",className:"mb-4",children:(0,r.jsx)(lL.Z,{onChange:e=>{o(e),e||a.setFieldsValue({input_cost_per_token:void 0,output_cost_per_token:void 0,input_cost_per_second:void 0})},className:"bg-gray-600"})}),n&&(0,r.jsxs)("div",{className:"ml-6 pl-4 border-l-2 border-gray-200",children:[(0,r.jsx)(E.Z.Item,{label:"Pricing Model",name:"pricing_model",className:"mb-4",children:(0,r.jsx)(A.default,{defaultValue:"per_token",onChange:e=>c(e),options:[{value:"per_token",label:"Per Million Tokens"},{value:"per_second",label:"Per Second"}]})}),"per_token"===d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z.Item,{label:"Input Cost (per 1M tokens)",name:"input_cost_per_token",rules:[{validator:m}],className:"mb-4",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"Output Cost (per 1M tokens)",name:"output_cost_per_token",rules:[{validator:m}],className:"mb-4",children:(0,r.jsx)(Z.Z,{})})]}):(0,r.jsx)(E.Z.Item,{label:"Cost Per Second",name:"input_cost_per_second",rules:[{validator:m}],className:"mb-4",children:(0,r.jsx)(Z.Z,{})})]}),(0,r.jsx)(E.Z.Item,{label:"Use in pass through routes",name:"use_in_pass_through",valuePropName:"checked",className:"mb-4 mt-4",tooltip:(0,r.jsxs)("span",{children:["Allow using these credentials in pass through routes."," ",(0,r.jsx)(lD,{href:"https://docs.litellm.ai/docs/pass_through/vertex_ai",target:"_blank",children:"Learn more"})]}),children:(0,r.jsx)(lL.Z,{onChange:e=>{let l=a.getFieldValue("litellm_extra_params");try{let s=l?JSON.parse(l):{};e?s.use_in_pass_through=!0:delete s.use_in_pass_through,Object.keys(s).length>0?a.setFieldValue("litellm_extra_params",JSON.stringify(s,null,2)):a.setFieldValue("litellm_extra_params","")}catch(l){e?a.setFieldValue("litellm_extra_params",JSON.stringify({use_in_pass_through:!0},null,2)):a.setFieldValue("litellm_extra_params","")}},className:"bg-gray-600"})}),(0,r.jsx)(E.Z.Item,{label:"LiteLLM Params",name:"litellm_extra_params",tooltip:"Optional litellm params used for making a litellm.completion() call.",className:"mb-4 mt-4",rules:[{validator:u}],children:(0,r.jsx)(lM.Z,{rows:4,placeholder:'{ "rpm": 100, "timeout": 0, "stream_timeout": 0 }'})}),(0,r.jsxs)(la.Z,{className:"mb-4",children:[(0,r.jsx)(lr.Z,{span:10}),(0,r.jsx)(lr.Z,{span:10,children:(0,r.jsxs)(S.Z,{className:"text-gray-600 text-sm",children:["Pass JSON of litellm supported params"," ",(0,r.jsx)(lD,{href:"https://docs.litellm.ai/docs/completion/input",target:"_blank",children:"litellm.completion() call"})]})})]}),(0,r.jsx)(E.Z.Item,{label:"Model Info",name:"model_info_params",tooltip:"Optional model info params. Returned when calling `/model/info` endpoint.",className:"mb-0",rules:[{validator:u}],children:(0,r.jsx)(lM.Z,{rows:4,placeholder:'{ "mode": "chat" }'})})]})})]})})},lR=s(29),lU=s.n(lR),lz=s(23496),lV=s(35291),lq=s(23639);let{Text:lK}=G.default;var lB=e=>{let{formValues:l,accessToken:s,testMode:t,modelName:a="this model",onClose:n,onTestComplete:o}=e,[d,c]=i.useState(null),[m,u]=i.useState(null),[h,x]=i.useState(null),[p,j]=i.useState(!0),[f,_]=i.useState(!1),[y,v]=i.useState(!1),b=async()=>{j(!0),v(!1),c(null),u(null),x(null),_(!1),await new Promise(e=>setTimeout(e,100));try{console.log("Testing connection with form values:",l);let a=await ll(l,s,null);if(!a){console.log("No result from prepareModelAddRequest"),c("Failed to prepare model data. Please check your form inputs."),_(!1),j(!1);return}console.log("Result from prepareModelAddRequest:",a);let{litellmParamsObj:r,modelInfoObj:i,modelName:n}=a,o=await (0,g.Hx)(s,r,null==i?void 0:i.mode);if("success"===o.status)P.ZP.success("Connection test successful!"),c(null),_(!0);else{var e,t;let l=(null===(e=o.result)||void 0===e?void 0:e.error)||o.message||"Unknown error";c(l),u(r),x(null===(t=o.result)||void 0===t?void 0:t.raw_request_typed_dict),_(!1)}}catch(e){console.error("Test connection error:",e),c(e instanceof Error?e.message:String(e)),_(!1)}finally{j(!1),o&&o()}};i.useEffect(()=>{let e=setTimeout(()=>{b()},200);return()=>clearTimeout(e)},[]);let Z=e=>e?e.split("stack trace:")[0].trim().replace(/^litellm\.(.*?)Error: /,""):"Unknown error",N="string"==typeof d?Z(d):(null==d?void 0:d.message)?Z(d.message):"Unknown error",w=h?((e,l,s)=>{let t=JSON.stringify(l,null,2).split("\n").map(e=>"  ".concat(e)).join("\n"),a=Object.entries(s).map(e=>{let[l,s]=e;return"-H '".concat(l,": ").concat(s,"'")}).join(" \\\n  ");return"curl -X POST \\\n  ".concat(e," \\\n  ").concat(a?"".concat(a," \\\n  "):"","-H 'Content-Type: application/json' \\\n  -d '{\n").concat(t,"\n  }'")})(h.raw_request_api_base,h.raw_request_body,h.raw_request_headers||{}):"";return(0,r.jsxs)("div",{style:{padding:"24px",borderRadius:"8px",backgroundColor:"#fff"},children:[p?(0,r.jsxs)("div",{style:{textAlign:"center",padding:"32px 20px"},className:"jsx-776cdcbc0448e4ea",children:[(0,r.jsx)("div",{style:{marginBottom:"16px"},className:"jsx-776cdcbc0448e4ea loading-spinner",children:(0,r.jsx)("div",{style:{border:"3px solid #f3f3f3",borderTop:"3px solid #1890ff",borderRadius:"50%",width:"30px",height:"30px",animation:"spin 1s linear infinite",margin:"0 auto"},className:"jsx-776cdcbc0448e4ea"})}),(0,r.jsxs)(lK,{style:{fontSize:"16px"},children:["Testing connection to ",a,"..."]}),(0,r.jsx)(lU(),{id:"776cdcbc0448e4ea",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]}):f?(0,r.jsxs)("div",{style:{textAlign:"center",padding:"32px 20px"},children:[(0,r.jsx)("div",{style:{color:"#52c41a",fontSize:"32px",marginBottom:"16px"},children:(0,r.jsx)("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"check-circle",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"})})}),(0,r.jsxs)(lK,{type:"success",style:{fontSize:"18px",fontWeight:500},children:["Connection to ",a," successful!"]})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px"},children:[(0,r.jsx)(lV.Z,{style:{color:"#ff4d4f",fontSize:"24px",marginRight:"12px"}}),(0,r.jsxs)(lK,{type:"danger",style:{fontSize:"18px",fontWeight:500},children:["Connection to ",a," failed"]})]}),(0,r.jsxs)("div",{style:{backgroundColor:"#fff2f0",border:"1px solid #ffccc7",borderRadius:"8px",padding:"16px",marginBottom:"20px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.03)"},children:[(0,r.jsx)(lK,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Error: "}),(0,r.jsx)(lK,{type:"danger",style:{fontSize:"14px",lineHeight:"1.5"},children:N}),d&&(0,r.jsx)("div",{style:{marginTop:"12px"},children:(0,r.jsx)(L.ZP,{type:"link",onClick:()=>v(!y),style:{paddingLeft:0,height:"auto"},children:y?"Hide Details":"Show Details"})})]}),y&&(0,r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,r.jsx)(lK,{strong:!0,style:{display:"block",marginBottom:"8px",fontSize:"15px"},children:"Troubleshooting Details"}),(0,r.jsx)("pre",{style:{backgroundColor:"#f5f5f5",padding:"16px",borderRadius:"8px",fontSize:"13px",maxHeight:"200px",overflow:"auto",border:"1px solid #e8e8e8",lineHeight:"1.5"},children:"string"==typeof d?d:JSON.stringify(d,null,2)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(lK,{strong:!0,style:{display:"block",marginBottom:"8px",fontSize:"15px"},children:"API Request"}),(0,r.jsx)("pre",{style:{backgroundColor:"#f5f5f5",padding:"16px",borderRadius:"8px",fontSize:"13px",maxHeight:"250px",overflow:"auto",border:"1px solid #e8e8e8",lineHeight:"1.5"},children:w||"No request data available"}),(0,r.jsx)(L.ZP,{style:{marginTop:"8px"},icon:(0,r.jsx)(lq.Z,{}),onClick:()=>{navigator.clipboard.writeText(w||""),P.ZP.success("Copied to clipboard")},children:"Copy to Clipboard"})]})]})}),(0,r.jsx)(lz.Z,{style:{margin:"24px 0 16px"}}),(0,r.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,r.jsx)(L.ZP,{type:"link",href:"https://docs.litellm.ai/docs/providers",target:"_blank",icon:(0,r.jsx)(z.Z,{}),children:"View Documentation"})})]})};let lH=[{value:"chat",label:"Chat - /chat/completions"},{value:"completion",label:"Completion - /completions"},{value:"embedding",label:"Embedding - /embeddings"},{value:"audio_speech",label:"Audio Speech - /audio/speech"},{value:"audio_transcription",label:"Audio Transcription - /audio/transcriptions"},{value:"image_generation",label:"Image Generation - /images/generations"},{value:"rerank",label:"Rerank - /rerank"},{value:"realtime",label:"Realtime - /realtime"}],{Title:lJ,Link:lW}=G.default;var lG=e=>{let{form:l,handleOk:s,selectedProvider:t,setSelectedProvider:n,providerModels:o,setProviderModelsFn:d,getPlaceholder:c,uploadProps:m,showAdvancedSettings:u,setShowAdvancedSettings:h,teams:x,credentials:p,accessToken:g}=e,[j,f]=(0,i.useState)("chat"),[_,y]=(0,i.useState)(!1),[v,b]=(0,i.useState)(!1),[Z,N]=(0,i.useState)(""),w=async()=>{b(!0),N("test-".concat(Date.now())),y(!0)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(lJ,{level:2,children:"Add new model"}),(0,r.jsx)(lP.Z,{children:(0,r.jsx)(E.Z,{form:l,onFinish:s,labelCol:{span:10},wrapperCol:{span:16},labelAlign:"left",children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z.Item,{rules:[{required:!0,message:"Required"}],label:"Provider:",name:"custom_llm_provider",tooltip:"E.g. OpenAI, Azure OpenAI, Anthropic, Bedrock, etc.",labelCol:{span:10},labelAlign:"left",children:(0,r.jsx)(A.default,{showSearch:!0,value:t,onChange:e=>{n(e),d(e),l.setFieldsValue({model:[],model_name:void 0})},children:Object.entries(a).map(e=>{let[l,s]=e;return(0,r.jsx)(A.default.Option,{value:l,children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("img",{src:e8[s],alt:"".concat(l," logo"),className:"w-5 h-5",onError:e=>{let l=e.target,t=l.parentElement;if(t){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=s.charAt(0),t.replaceChild(e,l)}}}),(0,r.jsx)("span",{children:s})]})},l)})})}),(0,r.jsx)(lO,{selectedProvider:t,providerModels:o,getPlaceholder:c}),(0,r.jsx)(lT,{}),(0,r.jsx)(E.Z.Item,{label:"Mode",name:"mode",className:"mb-1",children:(0,r.jsx)(A.default,{style:{width:"100%"},value:j,onChange:e=>f(e),options:lH})}),(0,r.jsxs)(la.Z,{children:[(0,r.jsx)(lr.Z,{span:10}),(0,r.jsx)(lr.Z,{span:10,children:(0,r.jsxs)(S.Z,{className:"mb-5 mt-1",children:[(0,r.jsx)("strong",{children:"Optional"})," - LiteLLM endpoint to use when health checking this model ",(0,r.jsx)(lW,{href:"https://docs.litellm.ai/docs/proxy/health#health",target:"_blank",children:"Learn more"})]})})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(G.default.Text,{className:"text-sm text-gray-500 mb-2",children:"Either select existing credentials OR enter new provider credentials below"})}),(0,r.jsx)(E.Z.Item,{label:"Existing Credentials",name:"litellm_credential_name",children:(0,r.jsx)(A.default,{showSearch:!0,placeholder:"Select or search for existing credentials",optionFilterProp:"children",filterOption:(e,l)=>{var s;return(null!==(s=null==l?void 0:l.label)&&void 0!==s?s:"").toLowerCase().includes(e.toLowerCase())},options:[{value:null,label:"None"},...p.map(e=>({value:e.credential_name,label:e.credential_name}))],allowClear:!0})}),(0,r.jsxs)("div",{className:"flex items-center my-4",children:[(0,r.jsx)("div",{className:"flex-grow border-t border-gray-200"}),(0,r.jsx)("span",{className:"px-4 text-gray-500 text-sm",children:"OR"}),(0,r.jsx)("div",{className:"flex-grow border-t border-gray-200"})]}),(0,r.jsx)(E.Z.Item,{noStyle:!0,shouldUpdate:(e,l)=>e.litellm_credential_name!==l.litellm_credential_name||e.provider!==l.provider,children:e=>{let{getFieldValue:l}=e,s=l("litellm_credential_name");return(console.log("\uD83D\uDD11 Credential Name Changed:",s),s)?(0,r.jsx)("div",{className:"text-gray-500 text-sm text-center",children:"Using existing credentials - no additional provider fields needed"}):(0,r.jsx)(lo,{selectedProvider:t,uploadProps:m})}}),(0,r.jsx)(lF,{showAdvancedSettings:u,setShowAdvancedSettings:h,teams:x}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(V.Z,{title:"Get help on our github",children:(0,r.jsx)(G.default.Link,{href:"https://github.com/BerriAI/litellm/issues",children:"Need Help?"})}),(0,r.jsxs)("div",{className:"space-x-2",children:[(0,r.jsx)(L.ZP,{onClick:w,loading:v,children:"Test Connect"}),(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Add Model"})]})]})]})})}),(0,r.jsx)(O.Z,{title:"Connection Test Results",open:_,onCancel:()=>{y(!1),b(!1)},footer:[(0,r.jsx)(L.ZP,{onClick:()=>{y(!1),b(!1)},children:"Close"},"close")],width:700,children:_&&(0,r.jsx)(lB,{formValues:l.getFieldsValue(),accessToken:g,testMode:j,modelName:l.getFieldValue("model_name")||l.getFieldValue("model"),onClose:()=>{y(!1),b(!1)},onTestComplete:()=>b(!1)},Z)})]})},lY=s(49084);function l$(e){let{data:l=[],columns:s,isLoading:t=!1}=e,[a,n]=i.useState([{id:"model_info.created_at",desc:!0}]),o=(0,eZ.b7)({data:l,columns:s,state:{sorting:a},onSortingChange:n,getCoreRowModel:(0,eN.sC)(),getSortedRowModel:(0,eN.tj)(),enableSorting:!0});return(0,r.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(ew.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,r.jsx)(eC.Z,{children:o.getHeaderGroups().map(e=>(0,r.jsx)(eA.Z,{children:e.headers.map(e=>(0,r.jsx)(eI.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,eZ.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,r.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,r.jsx)(eG.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,r.jsx)(eY.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,r.jsx)(lY.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,r.jsx)(ek.Z,{children:t?(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{colSpan:s.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"\uD83D\uDE85 Loading models..."})})})}):o.getRowModel().rows.length>0?o.getRowModel().rows.map(e=>(0,r.jsx)(eA.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,r.jsx)(eS.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,eZ.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{colSpan:s.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"No models found"})})})})})]})})})}let lX=(e,l,s,t,a,i,n)=>[{header:"Model ID",accessorKey:"model_info.id",cell:e=>{let{row:s}=e,t=s.original;return(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)(V.Z,{title:t.model_info.id,children:(0,r.jsxs)(b.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>l(t.model_info.id),children:[t.model_info.id.slice(0,7),"..."]})})})}},{header:"Public Model Name",accessorKey:"model_name",cell:e=>{let{row:l}=e,s=t(l.original)||"-";return(0,r.jsx)(V.Z,{title:s,children:(0,r.jsx)("p",{className:"text-xs",children:s.length>20?s.slice(0,20)+"...":s})})}},{header:"Provider",accessorKey:"provider",cell:e=>{let{row:l}=e,s=l.original;return(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[s.provider&&(0,r.jsx)("img",{src:e7(s.provider).logo,alt:"".concat(s.provider," logo"),className:"w-4 h-4",onError:e=>{let l=e.target,t=l.parentElement;if(t){var a;let e=document.createElement("div");e.className="w-4 h-4 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=(null===(a=s.provider)||void 0===a?void 0:a.charAt(0))||"-",t.replaceChild(e,l)}}}),(0,r.jsx)("p",{className:"text-xs",children:s.provider||"-"})]})}},{header:"LiteLLM Model Name",accessorKey:"litellm_model_name",cell:e=>{let{row:l}=e,s=l.original;return(0,r.jsx)(V.Z,{title:s.litellm_model_name,children:(0,r.jsx)("pre",{className:"text-xs",children:s.litellm_model_name?s.litellm_model_name.slice(0,20)+(s.litellm_model_name.length>20?"...":""):"-"})})}},{header:"Created At",accessorKey:"model_info.created_at",sortingFn:"datetime",cell:e=>{let{row:l}=e,s=l.original;return(0,r.jsx)("span",{className:"text-xs",children:s.model_info.created_at?new Date(s.model_info.created_at).toLocaleDateString():"-"})}},{header:"Updated At",accessorKey:"model_info.updated_at",sortingFn:"datetime",cell:e=>{let{row:l}=e,s=l.original;return(0,r.jsx)("span",{className:"text-xs",children:s.model_info.updated_at?new Date(s.model_info.updated_at).toLocaleDateString():"-"})}},{header:"Created By",accessorKey:"model_info.created_by",cell:e=>{let{row:l}=e,s=l.original;return(0,r.jsx)("span",{className:"text-xs",children:s.model_info.created_by||"-"})}},{header:()=>(0,r.jsx)(V.Z,{title:"Cost per 1M tokens",children:(0,r.jsx)("span",{children:"Input Cost"})}),accessorKey:"input_cost",cell:e=>{let{row:l}=e,s=l.original;return(0,r.jsx)("pre",{className:"text-xs",children:s.input_cost||"-"})}},{header:()=>(0,r.jsx)(V.Z,{title:"Cost per 1M tokens",children:(0,r.jsx)("span",{children:"Output Cost"})}),accessorKey:"output_cost",cell:e=>{let{row:l}=e,s=l.original;return(0,r.jsx)("pre",{className:"text-xs",children:s.output_cost||"-"})}},{header:"Team ID",accessorKey:"model_info.team_id",cell:e=>{let{row:l}=e,t=l.original;return t.model_info.team_id?(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)(V.Z,{title:t.model_info.team_id,children:(0,r.jsxs)(b.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>s(t.model_info.team_id),children:[t.model_info.team_id.slice(0,7),"..."]})})}):"-"}},{header:"Credentials",accessorKey:"litellm_credential_name",cell:e=>{let{row:l}=e,s=l.original;return s.litellm_params&&s.litellm_params.litellm_credential_name?(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsxs)(V.Z,{title:s.litellm_params.litellm_credential_name,children:[s.litellm_params.litellm_credential_name.slice(0,7),"..."]})}):(0,r.jsx)("span",{className:"text-gray-400",children:"-"})}},{header:"Status",accessorKey:"model_info.db_model",cell:e=>{let{row:l}=e,s=l.original;return(0,r.jsx)("div",{className:"\n          inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium\n          ".concat(s.model_info.db_model?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-600","\n        "),children:s.model_info.db_model?"DB Model":"Config Model"})}},{id:"actions",header:"",cell:e=>{let{row:s}=e,t=s.original;return(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2 pr-4",children:[(0,r.jsx)(lj.Z,{icon:lt.Z,size:"sm",onClick:()=>{l(t.model_info.id),n(!0)}}),(0,r.jsx)(lj.Z,{icon:eV.Z,size:"sm",onClick:()=>{l(t.model_info.id),n(!1)}})]})}}],{Title:lQ,Link:l0}=G.default,l1={"BadRequestError (400)":"BadRequestErrorRetries","AuthenticationError  (401)":"AuthenticationErrorRetries","TimeoutError (408)":"TimeoutErrorRetries","RateLimitError (429)":"RateLimitErrorRetries","ContentPolicyViolationError (400)":"ContentPolicyViolationErrorRetries","InternalServerError (500)":"InternalServerErrorRetries"};var l2=e=>{let{accessToken:l,token:s,userRole:t,userID:n,modelData:o={data:[]},keys:d,setModelData:c,premiumUser:m,teams:u}=e,[h,x]=(0,i.useState)([]),[p]=E.Z.useForm(),[j,f]=(0,i.useState)(null),[_,y]=(0,i.useState)(""),[Z,N]=(0,i.useState)([]);Object.values(a).filter(e=>isNaN(Number(e)));let[w,k]=(0,i.useState)([]),[I,A]=(0,i.useState)(a.OpenAI),[O,T]=(0,i.useState)(""),[L,D]=(0,i.useState)(!1),[F,R]=(0,i.useState)(null),[U,z]=(0,i.useState)([]),[V,q]=(0,i.useState)([]),[K,B]=(0,i.useState)(null),[H,J]=(0,i.useState)([]),[Y,$]=(0,i.useState)([]),[X,Q]=(0,i.useState)([]),[ee,el]=(0,i.useState)([]),[es,et]=(0,i.useState)([]),[ea,er]=(0,i.useState)([]),[ei,en]=(0,i.useState)([]),[eo,ed]=(0,i.useState)([]),[ec,em]=(0,i.useState)([]),[eu,eh]=(0,i.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[ex,ep]=(0,i.useState)(null),[eg,ej]=(0,i.useState)(0),[ef,e_]=(0,i.useState)({}),[ey,ev]=(0,i.useState)([]),[eb,eZ]=(0,i.useState)(!1),[eN,eE]=(0,i.useState)(null),[eO,eU]=(0,i.useState)(null),[eV,eq]=(0,i.useState)([]),[eK,eB]=(0,i.useState)([]),[eH,eJ]=(0,i.useState)(!1),[eG,eY]=(0,i.useState)(null),[e$,eX]=(0,i.useState)(!1),[eQ,e0]=(0,i.useState)(null),e1=async(e,s,a)=>{if(console.log("Updating model metrics for group:",e),!l||!n||!t||!s||!a)return;console.log("inside updateModelMetrics - startTime:",s,"endTime:",a),B(e);let r=null==eN?void 0:eN.token;void 0===r&&(r=null);let i=eO;void 0===i&&(i=null),s.setHours(0),s.setMinutes(0),s.setSeconds(0),a.setHours(23),a.setMinutes(59),a.setSeconds(59);try{let o=await (0,g.o6)(l,n,t,e,s.toISOString(),a.toISOString(),r,i);console.log("Model metrics response:",o),$(o.data),Q(o.all_api_bases);let d=await (0,g.Rg)(l,e,s.toISOString(),a.toISOString());el(d.data),et(d.all_api_bases);let c=await (0,g.N8)(l,n,t,e,s.toISOString(),a.toISOString(),r,i);console.log("Model exceptions response:",c),er(c.data),en(c.exception_types);let m=await (0,g.fP)(l,n,t,e,s.toISOString(),a.toISOString(),r,i);if(console.log("slowResponses:",m),em(m),e){let t=await (0,g.n$)(l,null==s?void 0:s.toISOString().split("T")[0],null==a?void 0:a.toISOString().split("T")[0],e);e_(t);let r=await (0,g.v9)(l,null==s?void 0:s.toISOString().split("T")[0],null==a?void 0:a.toISOString().split("T")[0],e);ev(r)}}catch(e){console.error("Failed to fetch model metrics",e)}},e2=async e=>{try{let l=await (0,g.N3)(e);console.log("credentials: ".concat(JSON.stringify(l))),eB(l.credentials)}catch(e){console.error("Error fetching credentials:",e)}};(0,i.useEffect)(()=>{e1(K,eu.from,eu.to)},[eN,eO]);let e4={name:"file",accept:".json",beforeUpload:e=>{if("application/json"===e.type){let l=new FileReader;l.onload=e=>{if(e.target){let l=e.target.result;p.setFieldsValue({vertex_credentials:l})}},l.readAsText(e)}return!1},onChange(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?P.ZP.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&P.ZP.error("".concat(e.file.name," file upload failed."))}},e5=()=>{y(new Date().toLocaleString())},e8=async()=>{if(!l){console.error("Access token is missing");return}console.log("new modelGroupRetryPolicy:",ex);try{await (0,g.K_)(l,{router_settings:{model_group_retry_policy:ex}}),P.ZP.success("Retry settings saved successfully")}catch(e){console.error("Failed to save retry settings:",e),P.ZP.error("Failed to save retry settings")}};if((0,i.useEffect)(()=>{if(!l||!s||!t||!n)return;let e=async()=>{try{var e,s,a,r,i,o,d,m,u,h,x,p;let j=await (0,g.hy)(l);k(j);let f=await (0,g.AZ)(l,n,t);console.log("Model data response:",f.data),c(f);let _=new Set;for(let e=0;e<f.data.length;e++){let l=f.data[e];_.add(l.model_name)}console.log("all_model_groups:",_);let y=Array.from(_);y=y.sort(),z(y),console.log("array_model_groups:",y);let v="all";y.length>0&&(v=y[y.length-1],console.log("_initial_model_group:",v)),console.log("selectedModelGroup:",K);let b=await (0,g.o6)(l,n,t,v,null===(e=eu.from)||void 0===e?void 0:e.toISOString(),null===(s=eu.to)||void 0===s?void 0:s.toISOString(),null==eN?void 0:eN.token,eO);console.log("Model metrics response:",b),$(b.data),Q(b.all_api_bases);let Z=await (0,g.Rg)(l,v,null===(a=eu.from)||void 0===a?void 0:a.toISOString(),null===(r=eu.to)||void 0===r?void 0:r.toISOString());el(Z.data),et(Z.all_api_bases);let N=await (0,g.N8)(l,n,t,v,null===(i=eu.from)||void 0===i?void 0:i.toISOString(),null===(o=eu.to)||void 0===o?void 0:o.toISOString(),null==eN?void 0:eN.token,eO);console.log("Model exceptions response:",N),er(N.data),en(N.exception_types);let w=await (0,g.fP)(l,n,t,v,null===(d=eu.from)||void 0===d?void 0:d.toISOString(),null===(m=eu.to)||void 0===m?void 0:m.toISOString(),null==eN?void 0:eN.token,eO),S=await (0,g.n$)(l,null===(u=eu.from)||void 0===u?void 0:u.toISOString().split("T")[0],null===(h=eu.to)||void 0===h?void 0:h.toISOString().split("T")[0],v);e_(S);let C=await (0,g.v9)(l,null===(x=eu.from)||void 0===x?void 0:x.toISOString().split("T")[0],null===(p=eu.to)||void 0===p?void 0:p.toISOString().split("T")[0],v);ev(C),console.log("dailyExceptions:",S),console.log("dailyExceptionsPerDeplyment:",C),console.log("slowResponses:",w),em(w);let I=await (0,g.j2)(l);eq(null==I?void 0:I.end_users);let A=(await (0,g.BL)(l,n,t)).router_settings;console.log("routerSettingsInfo:",A);let E=A.model_group_retry_policy,P=A.num_retries;console.log("model_group_retry_policy:",E),console.log("default_retries:",P),ep(E),ej(P)}catch(e){console.error("There was an error fetching the model data",e)}};l&&s&&t&&n&&e();let a=async()=>{let e=await (0,g.qm)(l);console.log("received model cost map data: ".concat(Object.keys(e))),f(e)};null==j&&a(),e5()},[l,s,t,n,j,_]),!o||!l||!s||!t||!n)return(0,r.jsx)("div",{children:"Loading..."});let e7=[],ll=[];for(let e=0;e<o.data.length;e++){var lt,la,li;let l=o.data[e],s=null==l?void 0:null===(lt=l.litellm_params)||void 0===lt?void 0:lt.model,t=null==l?void 0:null===(la=l.litellm_params)||void 0===la?void 0:la.custom_llm_provider,a=null==l?void 0:l.model_info,r="",i="Undefined",n="Undefined",d="Undefined",c="Undefined",m={},u=e=>(console.log("GET PROVIDER CALLED! - ".concat(j)),null!=j&&"object"==typeof j&&e in j)?j[e].litellm_provider:"openai";if(s){let e=s.split("/"),l=e[0];(r=t)||(r=1===e.length?u(s):l)}else r="-";a&&(i=null==a?void 0:a.input_cost_per_token,n=null==a?void 0:a.output_cost_per_token,d=null==a?void 0:a.max_tokens,c=null==a?void 0:a.max_input_tokens),(null==l?void 0:l.litellm_params)&&(m=Object.fromEntries(Object.entries(null==l?void 0:l.litellm_params).filter(e=>{let[l]=e;return"model"!==l&&"api_base"!==l}))),o.data[e].provider=r,o.data[e].input_cost=i,o.data[e].output_cost=n,o.data[e].litellm_model_name=s,ll.push(r),o.data[e].input_cost&&(o.data[e].input_cost=(1e6*Number(o.data[e].input_cost)).toFixed(2)),o.data[e].output_cost&&(o.data[e].output_cost=(1e6*Number(o.data[e].output_cost)).toFixed(2)),o.data[e].max_tokens=d,o.data[e].max_input_tokens=c,o.data[e].api_base=null==l?void 0:null===(li=l.litellm_params)||void 0===li?void 0:li.api_base,o.data[e].cleanedLitellmParams=m,e7.push(l.model_name),console.log(o.data[e])}if(t&&"Admin Viewer"==t){let{Title:e,Paragraph:l}=G.default;return(0,r.jsxs)("div",{children:[(0,r.jsx)(e,{level:1,children:"Access Denied"}),(0,r.jsx)(l,{children:"Ask your proxy admin for access to view all models"})]})}let ln=async()=>{try{P.ZP.info("Running health check..."),T("");let e=await (0,g.EY)(l);T(e)}catch(e){console.error("Error running health check:",e),T("Error running health check")}},lo=(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"mb-1",children:"Select API Key Name"}),m?(0,r.jsxs)("div",{children:[(0,r.jsxs)(eP.Z,{defaultValue:"all-keys",children:[(0,r.jsx)(W.Z,{value:"all-keys",onClick:()=>{eE(null)},children:"All Keys"},"all-keys"),null==d?void 0:d.map((e,l)=>e&&null!==e.key_alias&&e.key_alias.length>0?(0,r.jsx)(W.Z,{value:String(l),onClick:()=>{eE(e)},children:e.key_alias},l):null)]}),(0,r.jsx)(S.Z,{className:"mt-1",children:"Select Customer Name"}),(0,r.jsxs)(eP.Z,{defaultValue:"all-customers",children:[(0,r.jsx)(W.Z,{value:"all-customers",onClick:()=>{eU(null)},children:"All Customers"},"all-customers"),null==eV?void 0:eV.map((e,l)=>(0,r.jsx)(W.Z,{value:e,onClick:()=>{eU(e)},children:e},l))]})]}):(0,r.jsxs)("div",{children:[(0,r.jsxs)(eP.Z,{defaultValue:"all-keys",children:[(0,r.jsx)(W.Z,{value:"all-keys",onClick:()=>{eE(null)},children:"All Keys"},"all-keys"),null==d?void 0:d.map((e,l)=>e&&null!==e.key_alias&&e.key_alias.length>0?(0,r.jsxs)(W.Z,{value:String(l),disabled:!0,onClick:()=>{eE(e)},children:["✨ ",e.key_alias," (Enterprise only Feature)"]},l):null)]}),(0,r.jsx)(S.Z,{className:"mt-1",children:"Select Customer Name"}),(0,r.jsxs)(eP.Z,{defaultValue:"all-customers",children:[(0,r.jsx)(W.Z,{value:"all-customers",onClick:()=>{eU(null)},children:"All Customers"},"all-customers"),null==eV?void 0:eV.map((e,l)=>(0,r.jsxs)(W.Z,{value:e,disabled:!0,onClick:()=>{eU(e)},children:["✨ ",e," (Enterprise only Feature)"]},l))]})]})]}),ld=e=>{var l,s;let{payload:t,active:a}=e;if(!a||!t)return null;let i=null===(s=t[0])||void 0===s?void 0:null===(l=s.payload)||void 0===l?void 0:l.date,n=t.sort((e,l)=>l.value-e.value);if(n.length>5){let e=n.length-5;(n=n.slice(0,5)).push({dataKey:"".concat(e," other deployments"),value:t.slice(5).reduce((e,l)=>e+l.value,0),color:"gray"})}return(0,r.jsxs)("div",{className:"w-150 rounded-tremor-default border border-tremor-border bg-tremor-background p-2 text-tremor-default shadow-tremor-dropdown",children:[i&&(0,r.jsxs)("p",{className:"text-tremor-content-emphasis mb-2",children:["Date: ",i]}),n.map((e,l)=>{let s=parseFloat(e.value.toFixed(5)),t=0===s&&e.value>0?"<0.00001":s.toFixed(5);return(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 mt-1 rounded-full bg-".concat(e.color,"-500")}),(0,r.jsx)("p",{className:"text-tremor-content",children:e.dataKey})]}),(0,r.jsx)("p",{className:"font-medium text-tremor-content-emphasis text-righ ml-2",children:t})]},l)})]})};console.log("selectedProvider: ".concat(I)),console.log("providerModels.length: ".concat(Z.length));let lc=Object.keys(a).find(e=>a[e]===I);return(lc&&w.find(e=>e.name===e6[lc]),eQ)?(0,r.jsx)("div",{className:"w-full h-full",children:(0,r.jsx)(lw,{teamId:eQ,onClose:()=>e0(null),accessToken:l,is_team_admin:"Admin"===t,is_proxy_admin:"Proxy Admin"===t,userModels:e7,editTeam:!1})}):(0,r.jsx)("div",{style:{width:"100%",height:"100%"},children:eG?(0,r.jsx)(lE,{modelId:eG,editModel:!0,onClose:()=>{eY(null),eX(!1)},modelData:o.data.find(e=>e.model_info.id===eG),accessToken:l,userID:n,userRole:t,setEditModalVisible:D,setSelectedModel:R,onModelUpdate:e=>{c({...o,data:o.data.map(l=>l.model_info.id===e.model_info.id?e:l)}),e5()}}):(0,r.jsxs)(eM.Z,{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,r.jsxs)(eD.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(eL.Z,{children:"All Models"}),(0,r.jsx)(eL.Z,{children:"Add Model"}),(0,r.jsx)(eL.Z,{children:"LLM Credentials"}),(0,r.jsx)(eL.Z,{children:(0,r.jsx)("pre",{children:"/health Models"})}),(0,r.jsx)(eL.Z,{children:"Model Analytics"}),(0,r.jsx)(eL.Z,{children:"Model Retry Settings"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[_&&(0,r.jsxs)(S.Z,{children:["Last Refreshed: ",_]}),(0,r.jsx)(lj.Z,{icon:ez.Z,variant:"shadow",size:"xs",className:"self-center",onClick:e5})]})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsxs)(eF.Z,{children:[(0,r.jsxs)(v.Z,{children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(S.Z,{children:"Filter by Public Model Name"}),(0,r.jsxs)(eP.Z,{className:"mb-4 mt-2 ml-2 w-50",defaultValue:K||void 0,onValueChange:e=>B("all"===e?"all":e),value:K||void 0,children:[(0,r.jsx)(W.Z,{value:"all",children:"All Models"}),U.map((e,l)=>(0,r.jsx)(W.Z,{value:e,onClick:()=>B(e),children:e},l))]})]}),(0,r.jsx)(l$,{columns:lX(m,eY,e0,lh,e=>{R(e),D(!0)},e5,eX),data:o.data.filter(e=>"all"===K||e.model_name===K||!K),isLoading:!1})]}),(0,r.jsx)(lp,{visible:L,onCancel:()=>{D(!1),R(null)},model:F,onSubmit:e=>lx(e,l,D,R)})]}),(0,r.jsx)(eF.Z,{className:"h-full",children:(0,r.jsx)(lG,{form:p,handleOk:()=>{p.validateFields().then(e=>{ls(e,l,p,e5)}).catch(e=>{console.error("Validation failed:",e)})},selectedProvider:I,setSelectedProvider:A,providerModels:Z,setProviderModelsFn:e=>{let l=le(e,j);N(l),console.log("providerModels: ".concat(l))},getPlaceholder:e9,uploadProps:e4,showAdvancedSettings:eH,setShowAdvancedSettings:eJ,teams:u,credentials:eK,accessToken:l})}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(lu,{accessToken:l,uploadProps:e4,credentialList:eK,fetchCredentials:e2})}),(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"`/health` will run a very small request through your models configured on litellm"}),(0,r.jsx)(b.Z,{onClick:ln,children:"Run `/health`"}),O&&(0,r.jsx)("pre",{children:JSON.stringify(O,null,2)})]})}),(0,r.jsxs)(eF.Z,{children:[(0,r.jsxs)(v.Z,{numItems:4,className:"mt-2 mb-2",children:[(0,r.jsxs)(lr.Z,{children:[(0,r.jsx)(S.Z,{children:"Select Time Range"}),(0,r.jsx)(lg.Z,{enableSelect:!0,value:eu,className:"mr-2",onValueChange:e=>{eh(e),e1(K,e.from,e.to)}})]}),(0,r.jsxs)(lr.Z,{className:"ml-2",children:[(0,r.jsx)(S.Z,{children:"Select Model Group"}),(0,r.jsx)(eP.Z,{defaultValue:K||U[0],value:K||U[0],children:U.map((e,l)=>(0,r.jsx)(W.Z,{value:e,onClick:()=>e1(e,eu.from,eu.to),children:e},l))})]}),(0,r.jsx)(lr.Z,{children:(0,r.jsx)(ly.Z,{trigger:"click",content:lo,overlayStyle:{width:"20vw"},children:(0,r.jsx)(b.Z,{icon:eW.Z,size:"md",variant:"secondary",className:"mt-4 ml-2",style:{border:"none"},onClick:()=>eZ(!0)})})})]}),(0,r.jsxs)(v.Z,{numItems:2,children:[(0,r.jsx)(lr.Z,{children:(0,r.jsx)(eT.Z,{className:"mr-2 max-h-[400px] min-h-[400px]",children:(0,r.jsxs)(eM.Z,{children:[(0,r.jsxs)(eD.Z,{variant:"line",defaultValue:"1",children:[(0,r.jsx)(eL.Z,{value:"1",children:"Avg. Latency per Token"}),(0,r.jsx)(eL.Z,{value:"2",children:"Time to first token"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsxs)(eF.Z,{children:[(0,r.jsx)("p",{className:"text-gray-500 italic",children:" (seconds/token)"}),(0,r.jsx)(S.Z,{className:"text-gray-500 italic mt-1 mb-1",children:"average Latency for successfull requests divided by the total tokens"}),Y&&X&&(0,r.jsx)(lf.Z,{title:"Model Latency",className:"h-72",data:Y,showLegend:!1,index:"date",categories:X,connectNulls:!0,customTooltip:ld})]}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(lb,{modelMetrics:ee,modelMetricsCategories:es,customTooltip:ld,premiumUser:m})})]})]})})}),(0,r.jsx)(lr.Z,{children:(0,r.jsx)(eT.Z,{className:"ml-2 max-h-[400px] min-h-[400px]  overflow-y-auto",children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Deployment"}),(0,r.jsx)(eI.Z,{children:"Success Responses"}),(0,r.jsxs)(eI.Z,{children:["Slow Responses ",(0,r.jsx)("p",{children:"Success Responses taking 600+s"})]})]})}),(0,r.jsx)(ek.Z,{children:ec.map((e,l)=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:e.api_base}),(0,r.jsx)(eS.Z,{children:e.total_count}),(0,r.jsx)(eS.Z,{children:e.slow_count})]},l))})]})})})]}),(0,r.jsx)(v.Z,{numItems:1,className:"gap-2 w-full mt-2",children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsxs)(C.Z,{children:["All Exceptions for ",K]}),(0,r.jsx)(l_.Z,{className:"h-60",data:ea,index:"model",categories:ei,stack:!0,yAxisWidth:30})]})}),(0,r.jsxs)(v.Z,{numItems:1,className:"gap-2 w-full mt-2",children:[(0,r.jsxs)(eT.Z,{children:[(0,r.jsxs)(C.Z,{children:["All Up Rate Limit Errors (429) for ",K]}),(0,r.jsxs)(v.Z,{numItems:1,children:[(0,r.jsxs)(lr.Z,{children:[(0,r.jsxs)(e3.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Num Rate Limit Errors ",ef.sum_num_rate_limit_exceptions]}),(0,r.jsx)(l_.Z,{className:"h-40",data:ef.daily_data,index:"date",colors:["rose"],categories:["num_rate_limit_exceptions"],onValueChange:e=>console.log(e)})]}),(0,r.jsx)(lr.Z,{})]})]}),m?(0,r.jsx)(r.Fragment,{children:ey.map((e,l)=>(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(C.Z,{children:e.api_base?e.api_base:"Unknown API Base"}),(0,r.jsx)(v.Z,{numItems:1,children:(0,r.jsxs)(lr.Z,{children:[(0,r.jsxs)(e3.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Num Rate Limit Errors (429) ",e.sum_num_rate_limit_exceptions]}),(0,r.jsx)(l_.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["rose"],categories:["num_rate_limit_exceptions"],onValueChange:e=>console.log(e)})]})})]},l))}):(0,r.jsx)(r.Fragment,{children:ey&&ey.length>0&&ey.slice(0,1).map((e,l)=>(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(C.Z,{children:"✨ Rate Limit Errors by Deployment"}),(0,r.jsx)("p",{className:"mb-2 text-gray-500 italic text-[12px]",children:"Upgrade to see exceptions for all deployments"}),(0,r.jsx)(b.Z,{variant:"primary",className:"mb-2",children:(0,r.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"Get Free Trial"})}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(C.Z,{children:e.api_base}),(0,r.jsx)(v.Z,{numItems:1,children:(0,r.jsxs)(lr.Z,{children:[(0,r.jsxs)(e3.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Num Rate Limit Errors ",e.sum_num_rate_limit_exceptions]}),(0,r.jsx)(l_.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["rose"],categories:["num_rate_limit_exceptions"],onValueChange:e=>console.log(e)})]})})]})]},l))})]})]}),(0,r.jsxs)(eF.Z,{children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(S.Z,{children:"Filter by Public Model Name"}),(0,r.jsx)(eP.Z,{className:"mb-4 mt-2 ml-2 w-50",defaultValue:K||U[0],value:K||U[0],onValueChange:e=>B(e),children:U.map((e,l)=>(0,r.jsx)(W.Z,{value:e,onClick:()=>B(e),children:e},l))})]}),(0,r.jsxs)(C.Z,{children:["Retry Policy for ",K]}),(0,r.jsx)(S.Z,{className:"mb-6",children:"How many retries should be attempted based on the Exception"}),l1&&(0,r.jsx)("table",{children:(0,r.jsx)("tbody",{children:Object.entries(l1).map((e,l)=>{var s;let[t,a]=e,i=null==ex?void 0:null===(s=ex[K])||void 0===s?void 0:s[a];return null==i&&(i=eg),(0,r.jsxs)("tr",{className:"flex justify-between items-center mt-2",children:[(0,r.jsx)("td",{children:(0,r.jsx)(S.Z,{children:t})}),(0,r.jsx)("td",{children:(0,r.jsx)(M.Z,{className:"ml-5",value:i,min:0,step:1,onChange:e=>{ep(l=>{var s;let t=null!==(s=null==l?void 0:l[K])&&void 0!==s?s:{};return{...null!=l?l:{},[K]:{...t,[a]:e}}})}})})]},l)})})}),(0,r.jsx)(b.Z,{className:"mt-6 mr-8",onClick:e8,children:"Save"})]})]})]})})},l4=e=>{let{visible:l,possibleUIRoles:s,onCancel:t,user:a,onSubmit:n}=e,[o,d]=(0,i.useState)(a),[c]=E.Z.useForm();(0,i.useEffect)(()=>{c.resetFields()},[a]);let m=async()=>{c.resetFields(),t()},u=async e=>{n(e),c.resetFields(),t()};return a?(0,r.jsx)(O.Z,{visible:l,onCancel:m,footer:null,title:"Edit User "+a.user_id,width:1e3,children:(0,r.jsx)(E.Z,{form:c,onFinish:u,initialValues:a,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z.Item,{className:"mt-8",label:"User Email",tooltip:"Email of the User",name:"user_email",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"user_id",name:"user_id",hidden:!0,children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"User Role",name:"user_role",children:(0,r.jsx)(A.default,{children:s&&Object.entries(s).map(e=>{let[l,{ui_label:s,description:t}]=e;return(0,r.jsx)(W.Z,{value:l,title:s,children:(0,r.jsxs)("div",{className:"flex",children:[s," ",(0,r.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:t})]})},l)})})}),(0,r.jsx)(E.Z.Item,{label:"Spend (USD)",name:"spend",tooltip:"(float) - Spend of all LLM calls completed by this user",help:"Across all keys (including keys with team_id).",children:(0,r.jsx)(M.Z,{min:0,step:1})}),(0,r.jsx)(E.Z.Item,{label:"User Budget (USD)",name:"max_budget",tooltip:"(float) - Maximum budget of this user",help:"Maximum budget of this user.",children:(0,r.jsx)(M.Z,{min:0,step:1})}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Save"})})]})})}):null},l5=s(15731);let l3=(e,l,s)=>[{header:"User ID",accessorKey:"user_id",cell:e=>{let{row:l}=e;return(0,r.jsx)(V.Z,{title:l.original.user_id,children:(0,r.jsx)("span",{className:"text-xs",children:l.original.user_id?"".concat(l.original.user_id.slice(0,7),"..."):"-"})})}},{header:"User Email",accessorKey:"user_email",cell:e=>{let{row:l}=e;return(0,r.jsx)("span",{className:"text-xs",children:l.original.user_email||"-"})}},{header:"Global Proxy Role",accessorKey:"user_role",cell:l=>{var s;let{row:t}=l;return(0,r.jsx)("span",{className:"text-xs",children:(null==e?void 0:null===(s=e[t.original.user_role])||void 0===s?void 0:s.ui_label)||"-"})}},{header:"User Spend ($ USD)",accessorKey:"spend",cell:e=>{let{row:l}=e;return(0,r.jsx)("span",{className:"text-xs",children:l.original.spend?l.original.spend.toFixed(2):"-"})}},{header:"User Max Budget ($ USD)",accessorKey:"max_budget",cell:e=>{let{row:l}=e;return(0,r.jsx)("span",{className:"text-xs",children:null!==l.original.max_budget?l.original.max_budget:"Unlimited"})}},{header:()=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:"SSO ID"}),(0,r.jsx)(V.Z,{title:"SSO ID is the ID of the user in the SSO provider. If the user is not using SSO, this will be null.",children:(0,r.jsx)(l5.Z,{className:"w-4 h-4"})})]}),accessorKey:"sso_user_id",cell:e=>{let{row:l}=e;return(0,r.jsx)("span",{className:"text-xs",children:null!==l.original.sso_user_id?l.original.sso_user_id:"-"})}},{header:"API Keys",accessorKey:"key_count",cell:e=>{let{row:l}=e;return(0,r.jsx)(v.Z,{numItems:2,children:l.original.key_count>0?(0,r.jsxs)(eO.Z,{size:"xs",color:"indigo",children:[l.original.key_count," Keys"]}):(0,r.jsx)(eO.Z,{size:"xs",color:"gray",children:"No Keys"})})}},{header:"Created At",accessorKey:"created_at",sortingFn:"datetime",cell:e=>{let{row:l}=e;return(0,r.jsx)("span",{className:"text-xs",children:l.original.created_at?new Date(l.original.created_at).toLocaleDateString():"-"})}},{header:"Updated At",accessorKey:"updated_at",sortingFn:"datetime",cell:e=>{let{row:l}=e;return(0,r.jsx)("span",{className:"text-xs",children:l.original.updated_at?new Date(l.original.updated_at).toLocaleDateString():"-"})}},{id:"actions",header:"",cell:e=>{let{row:t}=e;return(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(lj.Z,{icon:lt.Z,size:"sm",onClick:()=>l(t.original)}),(0,r.jsx)(lj.Z,{icon:eV.Z,size:"sm",onClick:()=>s(t.original.user_id)})]})}}];function l6(e){let{data:l=[],columns:s,isLoading:t=!1}=e,[a,n]=i.useState([{id:"created_at",desc:!0}]),o=(0,eZ.b7)({data:l,columns:s,state:{sorting:a},onSortingChange:n,getCoreRowModel:(0,eN.sC)(),getSortedRowModel:(0,eN.tj)(),enableSorting:!0});return(0,r.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(ew.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,r.jsx)(eC.Z,{children:o.getHeaderGroups().map(e=>(0,r.jsx)(eA.Z,{children:e.headers.map(e=>(0,r.jsx)(eI.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,eZ.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,r.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,r.jsx)(eG.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,r.jsx)(eY.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,r.jsx)(lY.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,r.jsx)(ek.Z,{children:t?(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{colSpan:s.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"\uD83D\uDE85 Loading users..."})})})}):l.length>0?o.getRowModel().rows.map(e=>(0,r.jsx)(eA.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,r.jsx)(eS.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,eZ.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{colSpan:s.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"No users found"})})})})})]})})})}var l8=s(67982),l7=e=>{var l;let{accessToken:s,possibleUIRoles:t,userID:a,userRole:n}=e,[o,d]=(0,i.useState)(!0),[c,m]=(0,i.useState)(null),[u,h]=(0,i.useState)(!1),[x,p]=(0,i.useState)({}),[j,f]=(0,i.useState)(!1),[_,y]=(0,i.useState)([]),{Paragraph:v}=G.default,{Option:N}=A.default;(0,i.useEffect)(()=>{(async()=>{if(!s){d(!1);return}try{let e=await (0,g.NL)(s);if(m(e),p(e.values||{}),s)try{let e=await (0,g.So)(s,a,n);if(e&&e.data){let l=e.data.map(e=>e.id);y(l)}}catch(e){console.error("Error fetching available models:",e)}}catch(e){console.error("Error fetching SSO settings:",e),P.ZP.error("Failed to fetch SSO settings")}finally{d(!1)}})()},[s]);let w=async()=>{if(s){f(!0);try{let e=await (0,g.nd)(s,x);m({...c,values:e.settings}),h(!1)}catch(e){console.error("Error updating SSO settings:",e),P.ZP.error("Failed to update settings")}finally{f(!1)}}},k=(e,l)=>{p(s=>({...s,[e]:l}))},C=(e,l,s)=>{var a;let i=l.type;return"user_role"===e&&t?(0,r.jsx)(A.default,{style:{width:"100%"},value:x[e]||"",onChange:l=>k(e,l),className:"mt-2",children:Object.entries(t).filter(e=>{let[l]=e;return l.includes("internal_user")}).map(e=>{let[l,{ui_label:s,description:t}]=e;return(0,r.jsx)(N,{value:l,children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{children:s}),(0,r.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:t})]})},l)})}):"budget_duration"===e?(0,r.jsx)(ep,{value:x[e]||null,onChange:l=>k(e,l),className:"mt-2"}):"boolean"===i?(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(lL.Z,{checked:!!x[e],onChange:l=>k(e,l)})}):"array"===i&&(null===(a=l.items)||void 0===a?void 0:a.enum)?(0,r.jsx)(A.default,{mode:"multiple",style:{width:"100%"},value:x[e]||[],onChange:l=>k(e,l),className:"mt-2",children:l.items.enum.map(e=>(0,r.jsx)(N,{value:e,children:e},e))}):"models"===e?(0,r.jsx)(A.default,{mode:"multiple",style:{width:"100%"},value:x[e]||[],onChange:l=>k(e,l),className:"mt-2",children:_.map(e=>(0,r.jsx)(N,{value:e,children:R(e)},e))}):"string"===i&&l.enum?(0,r.jsx)(A.default,{style:{width:"100%"},value:x[e]||"",onChange:l=>k(e,l),className:"mt-2",children:l.enum.map(e=>(0,r.jsx)(N,{value:e,children:e},e))}):(0,r.jsx)(Z.Z,{value:void 0!==x[e]?String(x[e]):"",onChange:l=>k(e,l.target.value),placeholder:l.description||"",className:"mt-2"})},I=(e,l)=>{if(null==l)return(0,r.jsx)("span",{className:"text-gray-400",children:"Not set"});if("user_role"===e&&t&&t[l]){let{ui_label:e,description:s}=t[l];return(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:e}),s&&(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:s})]})}return"budget_duration"===e?(0,r.jsx)("span",{children:ex(l)}):"boolean"==typeof l?(0,r.jsx)("span",{children:l?"Enabled":"Disabled"}):"models"===e&&Array.isArray(l)?0===l.length?(0,r.jsx)("span",{className:"text-gray-400",children:"None"}):(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:l.map((e,l)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:R(e)},l))}):"object"==typeof l?Array.isArray(l)?0===l.length?(0,r.jsx)("span",{className:"text-gray-400",children:"None"}):(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:l.map((e,l)=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:"object"==typeof e?JSON.stringify(e):String(e)},l))}):(0,r.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:JSON.stringify(l,null,2)}):(0,r.jsx)("span",{children:String(l)})};return o?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)(eH.Z,{size:"large"})}):c?(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)("div",{className:"flex justify-end items-center mb-4",children:!o&&c&&(u?(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(b.Z,{variant:"secondary",onClick:()=>{h(!1),p(c.values||{})},disabled:j,children:"Cancel"}),(0,r.jsx)(b.Z,{onClick:w,loading:j,children:"Save Changes"})]}):(0,r.jsx)(b.Z,{onClick:()=>h(!0),children:"Edit Settings"}))}),(null==c?void 0:null===(l=c.schema)||void 0===l?void 0:l.description)&&(0,r.jsx)(v,{className:"mb-4",children:c.schema.description}),(0,r.jsx)(l8.Z,{}),(0,r.jsx)("div",{className:"mt-4 space-y-4",children:(()=>{let{values:e,schema:l}=c;return l&&l.properties?Object.entries(l.properties).map(l=>{let[s,t]=l,a=e[s],i=s.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());return(0,r.jsxs)("div",{className:"mb-6 pb-6 border-b border-gray-200 last:border-0",children:[(0,r.jsx)(S.Z,{className:"font-medium text-lg",children:i}),(0,r.jsx)(v,{className:"text-sm text-gray-500 mt-1",children:t.description||"No description available"}),u?(0,r.jsx)("div",{className:"mt-2",children:C(s,t,a)}):(0,r.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:I(s,a)})]},s)}):(0,r.jsx)(S.Z,{children:"No schema information available"})})()})]}):(0,r.jsx)(eT.Z,{children:(0,r.jsx)(S.Z,{children:"No settings available or you do not have permission to view them."})})};console.log=function(){};var l9=e=>{let{accessToken:l,token:s,keys:t,userRole:a,userID:n,teams:o,setKeys:d}=e,[c,m]=(0,i.useState)(null),[u,h]=(0,i.useState)(null),[x,p]=(0,i.useState)(null),[j,f]=(0,i.useState)(1),[_,y]=i.useState(null),[v,Z]=(0,i.useState)(null),[N,w]=(0,i.useState)(!1),[k,S]=(0,i.useState)(null),[C,I]=(0,i.useState)(!1),[A,E]=(0,i.useState)(null),[O,T]=(0,i.useState)({}),[L,M]=(0,i.useState)(""),[D,F]=(0,i.useState)("users");window.addEventListener("beforeunload",function(){sessionStorage.clear()});let R=async()=>{if(A&&l)try{if(await (0,g.Eb)(l,[A]),P.ZP.success("User deleted successfully"),u){let e=u.filter(e=>e.user_id!==A);h(e)}}catch(e){console.error("Error deleting user:",e),P.ZP.error("Failed to delete user")}I(!1),E(null)},U=async()=>{S(null),w(!1)},z=async e=>{if(console.log("inside handleEditSubmit:",e),l&&s&&a&&n){try{await (0,g.pf)(l,e,null),P.ZP.success("User ".concat(e.user_id," updated successfully"))}catch(e){console.error("There was an error updating the user",e)}u&&h(u.map(l=>l.user_id===e.user_id?e:l)),S(null),w(!1)}};if((0,i.useEffect)(()=>{if(!l||!s||!a||!n)return;let e=async()=>{try{let e=sessionStorage.getItem("userList_".concat(j));if(e){let l=JSON.parse(e);m(l),h(l.users||[])}else{let e=await (0,g.Br)(l,null,a,!0,j,25);sessionStorage.setItem("userList_".concat(j),JSON.stringify(e)),m(e),h(e.users||[])}let s=sessionStorage.getItem("possibleUserRoles");if(s)T(JSON.parse(s));else{let e=await (0,g.lg)(l);sessionStorage.setItem("possibleUserRoles",JSON.stringify(e)),T(e)}}catch(e){console.error("There was an error fetching the model data",e)}};l&&s&&a&&n&&e()},[l,s,a,n,j]),!u||!l||!s||!a||!n)return(0,r.jsx)("div",{children:"Loading..."});let V=l3(O,e=>{S(e),w(!0)},e=>{E(e),I(!0)});return(0,r.jsxs)("div",{className:"w-full p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold",children:"Users"}),(0,r.jsx)("div",{className:"flex space-x-3",children:(0,r.jsx)(en,{userID:n,accessToken:l,teams:o,possibleUIRoles:O})})]}),(0,r.jsxs)(eM.Z,{defaultIndex:0,onIndexChange:e=>F(0===e?"users":"settings"),children:[(0,r.jsxs)(eD.Z,{className:"mb-4",children:[(0,r.jsx)(eL.Z,{children:"Users"}),(0,r.jsx)(eL.Z,{children:"Default User Settings"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"border-b px-6 py-4",children:(0,r.jsx)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing"," ",c&&c.users&&c.users.length>0?(c.page-1)*c.page_size+1:0," ","-"," ",c&&c.users?Math.min(c.page*c.page_size,c.total):0," ","of ",c?c.total:0," results"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>f(e=>Math.max(1,e-1)),disabled:!c||j<=1,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",c?c.page:"-"," of"," ",c?c.total_pages:"-"]}),(0,r.jsx)("button",{onClick:()=>f(e=>e+1),disabled:!c||j>=c.total_pages,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})})}),(0,r.jsx)(l6,{data:u||[],columns:V,isLoading:!u})]})}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(l7,{accessToken:l,possibleUIRoles:O,userID:n,userRole:a})})]})]}),(0,r.jsx)(l4,{visible:N,possibleUIRoles:O,onCancel:U,user:k,onSubmit:z}),C&&(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete User"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this user?"}),(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-900 mt-2",children:["User ID: ",A]})]})]})})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)(b.Z,{onClick:R,color:"red",className:"ml-2",children:"Delete"}),(0,r.jsx)(b.Z,{onClick:()=>{I(!1),E(null)},children:"Cancel"})]})]})]})})]})},se=e=>{let{accessToken:l,userID:s}=e,[t,a]=(0,i.useState)([]);(0,i.useEffect)(()=>{(async()=>{if(l&&s)try{let e=await (0,g.a6)(l);a(e)}catch(e){console.error("Error fetching available teams:",e)}})()},[l,s]);let n=async e=>{if(l&&s)try{await (0,g.cu)(l,e,{user_id:s,role:"user"}),P.ZP.success("Successfully joined team"),a(l=>l.filter(l=>l.team_id!==e))}catch(e){console.error("Error joining team:",e),P.ZP.error("Failed to join team")}};return(0,r.jsx)(eT.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Team Name"}),(0,r.jsx)(eI.Z,{children:"Description"}),(0,r.jsx)(eI.Z,{children:"Members"}),(0,r.jsx)(eI.Z,{children:"Models"}),(0,r.jsx)(eI.Z,{children:"Actions"})]})}),(0,r.jsxs)(ek.Z,{children:[t.map(e=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{children:e.team_alias})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{children:e.description||"No description available"})}),(0,r.jsx)(eS.Z,{children:(0,r.jsxs)(S.Z,{children:[e.members_with_roles.length," members"]})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)("div",{className:"flex flex-col",children:e.models&&0!==e.models.length?e.models.map((e,l)=>(0,r.jsx)(eO.Z,{size:"xs",className:"mb-1",color:"blue",children:(0,r.jsx)(S.Z,{children:e.length>30?"".concat(e.slice(0,30),"..."):e})},l)):(0,r.jsx)(eO.Z,{size:"xs",color:"red",children:(0,r.jsx)(S.Z,{children:"All Proxy Models"})})})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(b.Z,{size:"xs",variant:"secondary",onClick:()=>n(e.team_id),children:"Join Team"})})]},e.team_id)),0===t.length&&(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{colSpan:5,className:"text-center",children:(0,r.jsx)(S.Z,{children:"No available teams to join"})})})]})]})})};console.log=function(){};let sl=(e,l)=>{let s=[];return e&&e.models.length>0?(console.log("organization.models: ".concat(e.models)),s=e.models):s=l,U(s,l)};var ss=e=>{let{teams:l,searchParams:s,accessToken:t,setTeams:a,userID:n,userRole:o,organizations:d}=e,[c,m]=(0,i.useState)(""),[u,h]=(0,i.useState)(null),[x,p]=(0,i.useState)(null);(0,i.useEffect)(()=>{console.log("inside useeffect - ".concat(c)),t&&_(t,n,o,u,a),e_()},[c]);let[j]=E.Z.useForm(),[f]=E.Z.useForm(),{Title:C,Paragraph:I}=G.default,[T,U]=(0,i.useState)(""),[q,K]=(0,i.useState)(!1),[B,H]=(0,i.useState)(null),[J,W]=(0,i.useState)(null),[Y,$]=(0,i.useState)(!1),[X,Q]=(0,i.useState)(!1),[ee,el]=(0,i.useState)(!1),[es,et]=(0,i.useState)(!1),[ea,er]=(0,i.useState)([]),[ei,en]=(0,i.useState)(!1),[eo,ed]=(0,i.useState)(null),[ec,em]=(0,i.useState)([]),[eu,eh]=(0,i.useState)({}),[ex,ep]=(0,i.useState)([]);(0,i.useEffect)(()=>{console.log("currentOrgForCreateTeam: ".concat(x));let e=sl(x,ea);console.log("models: ".concat(e)),em(e),j.setFieldValue("models",[])},[x,ea]),(0,i.useEffect)(()=>{(async()=>{try{if(null==t)return;let e=(await (0,g.t3)(t)).guardrails.map(e=>e.guardrail_name);ep(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})()},[t]);let eg=async e=>{ed(e),en(!0)},ej=async()=>{if(null!=eo&&null!=l&&null!=t){try{await (0,g.rs)(t,eo),_(t,n,o,u,a)}catch(e){console.error("Error deleting the team:",e)}en(!1),ed(null)}};(0,i.useEffect)(()=>{(async()=>{try{if(null===n||null===o||null===t)return;let e=await F(n,o,t);e&&er(e)}catch(e){console.error("Error fetching user models:",e)}})()},[t,n,o,l]);let ef=async e=>{try{if(console.log("formValues: ".concat(JSON.stringify(e))),null!=t){var s;let r=null==e?void 0:e.team_alias,i=null!==(s=null==l?void 0:l.map(e=>e.team_alias))&&void 0!==s?s:[],n=(null==e?void 0:e.organization_id)||(null==u?void 0:u.organization_id);if(""===n||"string"!=typeof n?e.organization_id=null:e.organization_id=n.trim(),i.includes(r))throw Error("Team alias ".concat(r," already exists, please pick another alias"));P.ZP.info("Creating Team");let o=await (0,g.hT)(t,e);null!==l?a([...l,o]):a([o]),console.log("response for team create call: ".concat(o)),P.ZP.success("Team created"),j.resetFields(),Q(!1)}}catch(e){console.error("Error creating the team:",e),P.ZP.error("Error creating the team: "+e,20)}},e_=()=>{m(new Date().toLocaleString())};return(0,r.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:J?(0,r.jsx)(lw,{teamId:J,onClose:()=>{W(null),$(!1)},accessToken:t,is_team_admin:(e=>{if(null==e||null==e.members_with_roles)return!1;for(let l=0;l<e.members_with_roles.length;l++){let s=e.members_with_roles[l];if(s.user_id==n&&"admin"==s.role)return!0}return!1})(null==l?void 0:l.find(e=>e.team_id===J)),is_proxy_admin:"Admin"==o,userModels:ea,editTeam:Y}):(0,r.jsxs)(eM.Z,{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,r.jsxs)(eD.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(eL.Z,{children:"Your Teams"}),(0,r.jsx)(eL.Z,{children:"Available Teams"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&(0,r.jsxs)(S.Z,{children:["Last Refreshed: ",c]}),(0,r.jsx)(lj.Z,{icon:ez.Z,variant:"shadow",size:"xs",className:"self-center",onClick:e_})]})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsxs)(eF.Z,{children:[(0,r.jsxs)(S.Z,{children:["Click on “Team ID” to view team details ",(0,r.jsx)("b",{children:"and"})," manage team members."]}),(0,r.jsxs)(v.Z,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:[(0,r.jsx)(y.Z,{numColSpan:1,children:(0,r.jsxs)(eT.Z,{className:"w-full mx-auto flex-auto overflow-hidden overflow-y-auto max-h-[50vh]",children:[(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Team Name"}),(0,r.jsx)(eI.Z,{children:"Team ID"}),(0,r.jsx)(eI.Z,{children:"Created"}),(0,r.jsx)(eI.Z,{children:"Spend (USD)"}),(0,r.jsx)(eI.Z,{children:"Budget (USD)"}),(0,r.jsx)(eI.Z,{children:"Models"}),(0,r.jsx)(eI.Z,{children:"Organization"}),(0,r.jsx)(eI.Z,{children:"Info"})]})}),(0,r.jsx)(ek.Z,{children:l&&l.length>0?l.filter(e=>!u||e.organization_id===u.organization_id).sort((e,l)=>new Date(l.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.team_alias}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)(V.Z,{title:e.team_id,children:(0,r.jsxs)(b.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>{W(e.team_id)},children:[e.team_id.slice(0,7),"..."]})})})}),(0,r.jsx)(eS.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"}),(0,r.jsx)(eS.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.spend}),(0,r.jsx)(eS.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:null!==e.max_budget&&void 0!==e.max_budget?e.max_budget:"No limit"}),(0,r.jsx)(eS.Z,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},children:Array.isArray(e.models)?(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:0===e.models.length?(0,r.jsx)(eO.Z,{size:"xs",className:"mb-1",color:"red",children:(0,r.jsx)(S.Z,{children:"All Proxy Models"})}):e.models.map((e,l)=>"all-proxy-models"===e?(0,r.jsx)(eO.Z,{size:"xs",className:"mb-1",color:"red",children:(0,r.jsx)(S.Z,{children:"All Proxy Models"})},l):(0,r.jsx)(eO.Z,{size:"xs",className:"mb-1",color:"blue",children:(0,r.jsx)(S.Z,{children:e.length>30?"".concat(R(e).slice(0,30),"..."):R(e)})},l))}):null}),(0,r.jsx)(eS.Z,{children:e.organization_id}),(0,r.jsxs)(eS.Z,{children:[(0,r.jsxs)(S.Z,{children:[eu&&e.team_id&&eu[e.team_id]&&eu[e.team_id].keys&&eu[e.team_id].keys.length," ","Keys"]}),(0,r.jsxs)(S.Z,{children:[eu&&e.team_id&&eu[e.team_id]&&eu[e.team_id].members_with_roles&&eu[e.team_id].members_with_roles.length," ","Members"]})]}),(0,r.jsx)(eS.Z,{children:"Admin"==o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(lj.Z,{icon:lt.Z,size:"sm",onClick:()=>{W(e.team_id),$(!0)}}),(0,r.jsx)(lj.Z,{onClick:()=>eg(e.team_id),icon:eV.Z,size:"sm"})]}):null})]},e.team_id)):null})]}),ei&&(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Team"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this team ?"})})]})})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)(b.Z,{onClick:ej,color:"red",className:"ml-2",children:"Delete"}),(0,r.jsx)(b.Z,{onClick:()=>{en(!1),ed(null)},children:"Cancel"})]})]})]})})]})}),"Admin"==o||"Org Admin"==o?(0,r.jsxs)(y.Z,{numColSpan:1,children:[(0,r.jsx)(b.Z,{className:"mx-auto",onClick:()=>Q(!0),children:"+ Create New Team"}),(0,r.jsx)(O.Z,{title:"Create Team",visible:X,width:800,footer:null,onOk:()=>{Q(!1),j.resetFields()},onCancel:()=>{Q(!1),j.resetFields()},children:(0,r.jsxs)(E.Z,{form:j,onFinish:ef,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z.Item,{label:"Team Name",name:"team_alias",rules:[{required:!0,message:"Please input a team name"}],children:(0,r.jsx)(Z.Z,{placeholder:""})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Organization"," ",(0,r.jsx)(V.Z,{title:(0,r.jsxs)("span",{children:["Organizations can have multiple teams. Learn more about"," ",(0,r.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/user_management_heirarchy",target:"_blank",rel:"noopener noreferrer",style:{color:"#1890ff",textDecoration:"underline"},onClick:e=>e.stopPropagation(),children:"user management hierarchy"})]}),children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"organization_id",initialValue:u?u.organization_id:null,className:"mt-8",children:(0,r.jsx)(A.default,{showSearch:!0,allowClear:!0,placeholder:"Search or select an Organization",onChange:e=>{j.setFieldValue("organization_id",e),p((null==d?void 0:d.find(l=>l.organization_id===e))||null)},filterOption:(e,l)=>{var s;return!!l&&((null===(s=l.children)||void 0===s?void 0:s.toString())||"").toLowerCase().includes(e.toLowerCase())},optionFilterProp:"children",children:null==d?void 0:d.map(e=>(0,r.jsxs)(A.default.Option,{value:e.organization_id,children:[(0,r.jsx)("span",{className:"font-medium",children:e.organization_alias})," ",(0,r.jsxs)("span",{className:"text-gray-500",children:["(",e.organization_id,")"]})]},e.organization_id))})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Models"," ",(0,r.jsx)(V.Z,{title:"These are the models that your selected organization has access to",children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})]}),name:"models",children:(0,r.jsxs)(A.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,r.jsx)(A.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),ec.map(e=>(0,r.jsx)(A.default.Option,{value:e,children:R(e)},e))]})}),(0,r.jsx)(E.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,r.jsx)(M.Z,{step:.01,precision:2,width:200})}),(0,r.jsx)(E.Z.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",children:(0,r.jsxs)(A.default,{defaultValue:null,placeholder:"n/a",children:[(0,r.jsx)(A.default.Option,{value:"24h",children:"daily"}),(0,r.jsx)(A.default.Option,{value:"7d",children:"weekly"}),(0,r.jsx)(A.default.Option,{value:"30d",children:"monthly"})]})}),(0,r.jsx)(E.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,r.jsx)(M.Z,{step:1,width:400})}),(0,r.jsx)(E.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,r.jsx)(M.Z,{step:1,width:400})}),(0,r.jsxs)(N.Z,{className:"mt-20 mb-8",children:[(0,r.jsx)(k.Z,{children:(0,r.jsx)("b",{children:"Additional Settings"})}),(0,r.jsxs)(w.Z,{children:[(0,r.jsx)(E.Z.Item,{label:"Team ID",name:"team_id",help:"ID of the team you want to create. If not provided, it will be generated automatically.",children:(0,r.jsx)(Z.Z,{onChange:e=>{e.target.value=e.target.value.trim()}})}),(0,r.jsx)(E.Z.Item,{label:"Metadata",name:"metadata",help:"Additional team metadata. Enter metadata as JSON object.",children:(0,r.jsx)(D.Z.TextArea,{rows:4})}),(0,r.jsx)(E.Z.Item,{label:(0,r.jsxs)("span",{children:["Guardrails"," ",(0,r.jsx)(V.Z,{title:"Setup your first guardrail",children:(0,r.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,r.jsx)(z.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",className:"mt-8",help:"Select existing guardrails or enter new ones",children:(0,r.jsx)(A.default,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails",options:ex.map(e=>({value:e,label:e}))})})]})]})]}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Create Team"})})]})})]}):null]})]}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(se,{accessToken:t,userID:n})})]})]})})},st=e=>{var l;let{organizationId:s,onClose:t,accessToken:a,is_org_admin:n,is_proxy_admin:o,userModels:d,editOrg:c}=e,[m,u]=(0,i.useState)(null),[h,x]=(0,i.useState)(!0),[p]=E.Z.useForm(),[j,f]=(0,i.useState)(!1),[_,y]=(0,i.useState)(!1),[Z,N]=(0,i.useState)(!1),[w,k]=(0,i.useState)(null),I=n||o,O=async()=>{try{if(x(!0),!a)return;let e=await (0,g.t$)(a,s);u(e)}catch(e){P.ZP.error("Failed to load organization information"),console.error("Error fetching organization info:",e)}finally{x(!1)}};(0,i.useEffect)(()=>{O()},[s,a]);let T=async e=>{try{if(null==a)return;let l={user_email:e.user_email,user_id:e.user_id,role:e.role};await (0,g.vh)(a,s,l),P.ZP.success("Organization member added successfully"),y(!1),p.resetFields(),O()}catch(e){P.ZP.error("Failed to add organization member"),console.error("Error adding organization member:",e)}},F=async e=>{try{if(!a)return;let l={user_email:e.user_email,user_id:e.user_id,role:e.role};await (0,g.LY)(a,s,l),P.ZP.success("Organization member updated successfully"),N(!1),p.resetFields(),O()}catch(e){P.ZP.error("Failed to update organization member"),console.error("Error updating organization member:",e)}},U=async e=>{try{if(!a)return;await (0,g.Sb)(a,s,e.user_id),P.ZP.success("Organization member deleted successfully"),N(!1),p.resetFields(),O()}catch(e){P.ZP.error("Failed to delete organization member"),console.error("Error deleting organization member:",e)}},z=async e=>{try{if(!a)return;let l={organization_id:s,organization_alias:e.organization_alias,models:e.models,litellm_budget_table:{tpm_limit:e.tpm_limit,rpm_limit:e.rpm_limit,max_budget:e.max_budget,budget_duration:e.budget_duration},metadata:e.metadata?JSON.parse(e.metadata):null};await (0,g.VA)(a,l),P.ZP.success("Organization settings updated successfully"),f(!1),O()}catch(e){P.ZP.error("Failed to update organization settings"),console.error("Error updating organization:",e)}};return h?(0,r.jsx)("div",{className:"p-4",children:"Loading..."}):m?(0,r.jsxs)("div",{className:"w-full h-screen p-4 bg-white",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(L.ZP,{onClick:t,className:"mb-4",children:"← Back"}),(0,r.jsx)(C.Z,{children:m.organization_alias}),(0,r.jsx)(S.Z,{className:"text-gray-500 font-mono",children:m.organization_id})]})}),(0,r.jsxs)(eM.Z,{defaultIndex:c?2:0,children:[(0,r.jsxs)(eD.Z,{className:"mb-4",children:[(0,r.jsx)(eL.Z,{children:"Overview"}),(0,r.jsx)(eL.Z,{children:"Members"}),(0,r.jsx)(eL.Z,{children:"Settings"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(v.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Organization Details"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(S.Z,{children:["Created: ",new Date(m.created_at).toLocaleDateString()]}),(0,r.jsxs)(S.Z,{children:["Updated: ",new Date(m.updated_at).toLocaleDateString()]}),(0,r.jsxs)(S.Z,{children:["Created By: ",m.created_by]})]})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Budget Status"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(C.Z,{children:["$",m.spend.toFixed(6)]}),(0,r.jsxs)(S.Z,{children:["of ",null===m.litellm_budget_table.max_budget?"Unlimited":"$".concat(m.litellm_budget_table.max_budget)]}),m.litellm_budget_table.budget_duration&&(0,r.jsxs)(S.Z,{className:"text-gray-500",children:["Reset: ",m.litellm_budget_table.budget_duration]})]})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Rate Limits"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)(S.Z,{children:["TPM: ",m.litellm_budget_table.tpm_limit||"Unlimited"]}),(0,r.jsxs)(S.Z,{children:["RPM: ",m.litellm_budget_table.rpm_limit||"Unlimited"]}),m.litellm_budget_table.max_parallel_requests&&(0,r.jsxs)(S.Z,{children:["Max Parallel Requests: ",m.litellm_budget_table.max_parallel_requests]})]})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Models"}),(0,r.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:m.models.map((e,l)=>(0,r.jsx)(eO.Z,{color:"red",children:e},l))})]})]})}),(0,r.jsx)(eF.Z,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(eT.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[75vh]",children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"User ID"}),(0,r.jsx)(eI.Z,{children:"Role"}),(0,r.jsx)(eI.Z,{children:"Spend"}),(0,r.jsx)(eI.Z,{children:"Created At"}),(0,r.jsx)(eI.Z,{})]})}),(0,r.jsx)(ek.Z,{children:null===(l=m.members)||void 0===l?void 0:l.map((e,l)=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{className:"font-mono",children:e.user_id})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{className:"font-mono",children:e.user_role})}),(0,r.jsx)(eS.Z,{children:(0,r.jsxs)(S.Z,{children:["$",e.spend.toFixed(6)]})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{children:new Date(e.created_at).toLocaleString()})}),(0,r.jsx)(eS.Z,{children:I&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(lj.Z,{icon:lt.Z,size:"sm",onClick:()=>{k({role:e.user_role,user_email:e.user_email,user_id:e.user_id}),N(!0)}}),(0,r.jsx)(lj.Z,{icon:eV.Z,size:"sm",onClick:()=>{U(e)}})]})})]},l))})]})}),I&&(0,r.jsx)(b.Z,{onClick:()=>{y(!0)},children:"Add Member"})]})}),(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(C.Z,{children:"Organization Settings"}),I&&!j&&(0,r.jsx)(b.Z,{onClick:()=>f(!0),children:"Edit Settings"})]}),j?(0,r.jsxs)(E.Z,{form:p,onFinish:z,initialValues:{organization_alias:m.organization_alias,models:m.models,tpm_limit:m.litellm_budget_table.tpm_limit,rpm_limit:m.litellm_budget_table.rpm_limit,max_budget:m.litellm_budget_table.max_budget,budget_duration:m.litellm_budget_table.budget_duration,metadata:m.metadata?JSON.stringify(m.metadata,null,2):""},layout:"vertical",children:[(0,r.jsx)(E.Z.Item,{label:"Organization Name",name:"organization_alias",rules:[{required:!0,message:"Please input an organization name"}],children:(0,r.jsx)(D.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"Models",name:"models",children:(0,r.jsxs)(A.default,{mode:"multiple",placeholder:"Select models",children:[(0,r.jsx)(A.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),d.map(e=>(0,r.jsx)(A.default.Option,{value:e,children:R(e)},e))]})}),(0,r.jsx)(E.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,r.jsx)(M.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,r.jsxs)(A.default,{placeholder:"n/a",children:[(0,r.jsx)(A.default.Option,{value:"24h",children:"daily"}),(0,r.jsx)(A.default.Option,{value:"7d",children:"weekly"}),(0,r.jsx)(A.default.Option,{value:"30d",children:"monthly"})]})}),(0,r.jsx)(E.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,r.jsx)(M.Z,{step:1,style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,r.jsx)(M.Z,{step:1,style:{width:"100%"}})}),(0,r.jsx)(E.Z.Item,{label:"Metadata",name:"metadata",children:(0,r.jsx)(D.Z.TextArea,{rows:4})}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,r.jsx)(L.ZP,{onClick:()=>f(!1),children:"Cancel"}),(0,r.jsx)(b.Z,{type:"submit",children:"Save Changes"})]})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Organization Name"}),(0,r.jsx)("div",{children:m.organization_alias})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Organization ID"}),(0,r.jsx)("div",{className:"font-mono",children:m.organization_id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Created At"}),(0,r.jsx)("div",{children:new Date(m.created_at).toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Models"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:m.models.map((e,l)=>(0,r.jsx)(eO.Z,{color:"red",children:e},l))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Rate Limits"}),(0,r.jsxs)("div",{children:["TPM: ",m.litellm_budget_table.tpm_limit||"Unlimited"]}),(0,r.jsxs)("div",{children:["RPM: ",m.litellm_budget_table.rpm_limit||"Unlimited"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"font-medium",children:"Budget"}),(0,r.jsxs)("div",{children:["Max: ",null!==m.litellm_budget_table.max_budget?"$".concat(m.litellm_budget_table.max_budget):"No Limit"]}),(0,r.jsxs)("div",{children:["Reset: ",m.litellm_budget_table.budget_duration||"Never"]})]})]})]})})]})]}),(0,r.jsx)(lN,{isVisible:_,onCancel:()=>y(!1),onSubmit:T,accessToken:a,title:"Add Organization Member",roles:[{label:"org_admin",value:"org_admin",description:"Can add and remove members, and change their roles."},{label:"internal_user",value:"internal_user",description:"Can view/create keys for themselves within organization."},{label:"internal_user_viewer",value:"internal_user_viewer",description:"Can only view their keys within organization."}],defaultRole:"internal_user"}),(0,r.jsx)(lZ,{visible:Z,onCancel:()=>N(!1),onSubmit:F,initialData:w,mode:"edit",config:{title:"Edit Member",showEmail:!0,showUserId:!0,roleOptions:[{label:"Org Admin",value:"org_admin"},{label:"Internal User",value:"internal_user"},{label:"Internal User Viewer",value:"internal_user_viewer"}]}})]}):(0,r.jsx)("div",{className:"p-4",children:"Organization not found"})};let sa=async(e,l)=>{l(await (0,g.r6)(e))};var sr=e=>{let{organizations:l,userRole:s,userModels:t,accessToken:a,lastRefreshed:n,handleRefreshClick:o,currentOrg:d,guardrailsList:c=[],setOrganizations:m,premiumUser:u}=e,[h,x]=(0,i.useState)(null),[p,j]=(0,i.useState)(!1),[f,_]=(0,i.useState)(!1),[N,w]=(0,i.useState)(null),[k,C]=(0,i.useState)(!1),[I]=E.Z.useForm();(0,i.useEffect)(()=>{0===l.length&&a&&sa(a,m)},[l,a]);let T=e=>{e&&(w(e),_(!0))},L=async()=>{if(N&&a)try{await (0,g.cq)(a,N),P.ZP.success("Organization deleted successfully"),_(!1),w(null),sa(a,m)}catch(e){console.error("Error deleting organization:",e)}},F=async e=>{try{if(!a)return;console.log("values in organizations new create call: ".concat(JSON.stringify(e))),await (0,g.H1)(a,e),C(!1),I.resetFields(),sa(a,m)}catch(e){console.error("Error creating organization:",e)}};return u?h?(0,r.jsx)(st,{organizationId:h,onClose:()=>{x(null),j(!1)},accessToken:a,is_org_admin:!0,is_proxy_admin:"Admin"===s,userModels:t,editOrg:p}):(0,r.jsxs)(eM.Z,{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,r.jsxs)(eD.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)(eL.Z,{children:"Your Organizations"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[n&&(0,r.jsxs)(S.Z,{children:["Last Refreshed: ",n]}),(0,r.jsx)(lj.Z,{icon:ez.Z,variant:"shadow",size:"xs",className:"self-center",onClick:o})]})]}),(0,r.jsx)(eR.Z,{children:(0,r.jsxs)(eF.Z,{children:[(0,r.jsx)(S.Z,{children:"Click on “Organization ID” to view organization details."}),(0,r.jsxs)(v.Z,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:[(0,r.jsx)(y.Z,{numColSpan:1,children:(0,r.jsx)(eT.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Organization ID"}),(0,r.jsx)(eI.Z,{children:"Organization Name"}),(0,r.jsx)(eI.Z,{children:"Created"}),(0,r.jsx)(eI.Z,{children:"Spend (USD)"}),(0,r.jsx)(eI.Z,{children:"Budget (USD)"}),(0,r.jsx)(eI.Z,{children:"Models"}),(0,r.jsx)(eI.Z,{children:"TPM / RPM Limits"}),(0,r.jsx)(eI.Z,{children:"Info"}),(0,r.jsx)(eI.Z,{children:"Actions"})]})}),(0,r.jsx)(ek.Z,{children:l&&l.length>0?l.sort((e,l)=>new Date(l.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>{var l,t,a,i,n,o,d,c,m;return(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)(V.Z,{title:e.organization_id,children:(0,r.jsxs)(b.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>x(e.organization_id),children:[null===(l=e.organization_id)||void 0===l?void 0:l.slice(0,7),"..."]})})})}),(0,r.jsx)(eS.Z,{children:e.organization_alias}),(0,r.jsx)(eS.Z,{children:e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"}),(0,r.jsx)(eS.Z,{children:e.spend}),(0,r.jsx)(eS.Z,{children:(null===(t=e.litellm_budget_table)||void 0===t?void 0:t.max_budget)!==null&&(null===(a=e.litellm_budget_table)||void 0===a?void 0:a.max_budget)!==void 0?null===(i=e.litellm_budget_table)||void 0===i?void 0:i.max_budget:"No limit"}),(0,r.jsx)(eS.Z,{children:Array.isArray(e.models)&&(0,r.jsx)("div",{className:"flex flex-col",children:0===e.models.length?(0,r.jsx)(eO.Z,{size:"xs",className:"mb-1",color:"red",children:"All Proxy Models"}):e.models.map((e,l)=>"all-proxy-models"===e?(0,r.jsx)(eO.Z,{size:"xs",className:"mb-1",color:"red",children:"All Proxy Models"},l):(0,r.jsx)(eO.Z,{size:"xs",className:"mb-1",color:"blue",children:e.length>30?"".concat(R(e).slice(0,30),"..."):R(e)},l))})}),(0,r.jsx)(eS.Z,{children:(0,r.jsxs)(S.Z,{children:["TPM: ",(null===(n=e.litellm_budget_table)||void 0===n?void 0:n.tpm_limit)?null===(o=e.litellm_budget_table)||void 0===o?void 0:o.tpm_limit:"Unlimited",(0,r.jsx)("br",{}),"RPM: ",(null===(d=e.litellm_budget_table)||void 0===d?void 0:d.rpm_limit)?null===(c=e.litellm_budget_table)||void 0===c?void 0:c.rpm_limit:"Unlimited"]})}),(0,r.jsx)(eS.Z,{children:(0,r.jsxs)(S.Z,{children:[(null===(m=e.members)||void 0===m?void 0:m.length)||0," Members"]})}),(0,r.jsx)(eS.Z,{children:"Admin"===s&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(lj.Z,{icon:lt.Z,size:"sm",onClick:()=>{x(e.organization_id),j(!0)}}),(0,r.jsx)(lj.Z,{onClick:()=>T(e.organization_id),icon:eV.Z,size:"sm"})]})})]},e.organization_id)}):null})]})})}),("Admin"===s||"Org Admin"===s)&&(0,r.jsxs)(y.Z,{numColSpan:1,children:[(0,r.jsx)(b.Z,{className:"mx-auto",onClick:()=>C(!0),children:"+ Create New Organization"}),(0,r.jsx)(O.Z,{title:"Create Organization",visible:k,width:800,footer:null,onCancel:()=>{C(!1),I.resetFields()},children:(0,r.jsxs)(E.Z,{form:I,onFinish:F,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsx)(E.Z.Item,{label:"Organization Name",name:"organization_alias",rules:[{required:!0,message:"Please input an organization name"}],children:(0,r.jsx)(Z.Z,{placeholder:""})}),(0,r.jsx)(E.Z.Item,{label:"Models",name:"models",children:(0,r.jsxs)(A.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,r.jsx)(A.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),t&&t.length>0&&t.map(e=>(0,r.jsx)(A.default.Option,{value:e,children:R(e)},e))]})}),(0,r.jsx)(E.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,r.jsx)(M.Z,{step:.01,precision:2,width:200})}),(0,r.jsx)(E.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,r.jsxs)(A.default,{defaultValue:null,placeholder:"n/a",children:[(0,r.jsx)(A.default.Option,{value:"24h",children:"daily"}),(0,r.jsx)(A.default.Option,{value:"7d",children:"weekly"}),(0,r.jsx)(A.default.Option,{value:"30d",children:"monthly"})]})}),(0,r.jsx)(E.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,r.jsx)(M.Z,{step:1,width:400})}),(0,r.jsx)(E.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,r.jsx)(M.Z,{step:1,width:400})}),(0,r.jsx)(E.Z.Item,{label:"Metadata",name:"metadata",children:(0,r.jsx)(D.Z.TextArea,{rows:4})}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(b.Z,{type:"submit",children:"Create Organization"})})]})})]})]})]})}),f?(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Organization"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this organization?"})})]})})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)(b.Z,{onClick:L,color:"red",className:"ml-2",children:"Delete"}),(0,r.jsx)(b.Z,{onClick:()=>{_(!1),w(null)},children:"Cancel"})]})]})]})}):(0,r.jsx)(r.Fragment,{})]}):(0,r.jsx)("div",{children:(0,r.jsxs)(S.Z,{children:["This is a LiteLLM Enterprise feature, and requires a valid key to use. Get a trial key ",(0,r.jsx)("a",{href:"https://litellm.ai/pricing",target:"_blank",rel:"noopener noreferrer",children:"here"}),"."]})})},si=s(94789);let sn={google:"https://artificialanalysis.ai/img/logos/google_small.svg",microsoft:"https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg",okta:"https://www.okta.com/sites/default/files/Okta_Logo_BrightBlue_Medium.png",generic:""},so={google:{envVarMap:{google_client_id:"GOOGLE_CLIENT_ID",google_client_secret:"GOOGLE_CLIENT_SECRET"},fields:[{label:"GOOGLE CLIENT ID",name:"google_client_id"},{label:"GOOGLE CLIENT SECRET",name:"google_client_secret"}]},microsoft:{envVarMap:{microsoft_client_id:"MICROSOFT_CLIENT_ID",microsoft_client_secret:"MICROSOFT_CLIENT_SECRET",microsoft_tenant:"MICROSOFT_TENANT"},fields:[{label:"MICROSOFT CLIENT ID",name:"microsoft_client_id"},{label:"MICROSOFT CLIENT SECRET",name:"microsoft_client_secret"},{label:"MICROSOFT TENANT",name:"microsoft_tenant"}]},okta:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"GENERIC CLIENT ID",name:"generic_client_id"},{label:"GENERIC CLIENT SECRET",name:"generic_client_secret"},{label:"AUTHORIZATION ENDPOINT",name:"generic_authorization_endpoint",placeholder:"https://your-okta-domain/authorize"},{label:"TOKEN ENDPOINT",name:"generic_token_endpoint",placeholder:"https://your-okta-domain/token"},{label:"USERINFO ENDPOINT",name:"generic_userinfo_endpoint",placeholder:"https://your-okta-domain/userinfo"}]},generic:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"GENERIC CLIENT ID",name:"generic_client_id"},{label:"GENERIC CLIENT SECRET",name:"generic_client_secret"},{label:"AUTHORIZATION ENDPOINT",name:"generic_authorization_endpoint"},{label:"TOKEN ENDPOINT",name:"generic_token_endpoint"},{label:"USERINFO ENDPOINT",name:"generic_userinfo_endpoint"}]}};var sd=e=>{let{isAddSSOModalVisible:l,isInstructionsModalVisible:s,handleAddSSOOk:t,handleAddSSOCancel:a,handleShowInstructions:i,handleInstructionsOk:n,handleInstructionsCancel:o,form:d}=e,c=e=>{let l=so[e];return l?l.fields.map(e=>(0,r.jsx)(E.Z.Item,{label:e.label,name:e.name,rules:[{required:!0,message:"Please enter the ".concat(e.label.toLowerCase())}],children:e.name.includes("client")?(0,r.jsx)(D.Z.Password,{}):(0,r.jsx)(Z.Z,{placeholder:e.placeholder})},e.name)):null};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O.Z,{title:"Add SSO",visible:l,width:800,footer:null,onOk:t,onCancel:a,children:(0,r.jsxs)(E.Z,{form:d,onFinish:i,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z.Item,{label:"SSO Provider",name:"sso_provider",rules:[{required:!0,message:"Please select an SSO provider"}],children:(0,r.jsx)(A.default,{children:Object.entries(sn).map(e=>{let[l,s]=e;return(0,r.jsx)(A.default.Option,{value:l,children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 0"},children:[s&&(0,r.jsx)("img",{src:s,alt:l,style:{height:24,width:24,marginRight:12,objectFit:"contain"}}),(0,r.jsxs)("span",{children:[l.charAt(0).toUpperCase()+l.slice(1)," SSO"]})]})},l)})})}),(0,r.jsx)(E.Z.Item,{noStyle:!0,shouldUpdate:(e,l)=>e.sso_provider!==l.sso_provider,children:e=>{let{getFieldValue:l}=e,s=l("sso_provider");return s?c(s):null}}),(0,r.jsx)(E.Z.Item,{label:"Proxy Admin Email",name:"user_email",rules:[{required:!0,message:"Please enter the email of the proxy admin"}],children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"PROXY BASE URL",name:"proxy_base_url",rules:[{required:!0,message:"Please enter the proxy base url"}],children:(0,r.jsx)(Z.Z,{})})]}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Save"})})]})}),(0,r.jsxs)(O.Z,{title:"SSO Setup Instructions",visible:s,width:800,footer:null,onOk:n,onCancel:o,children:[(0,r.jsx)("p",{children:"Follow these steps to complete the SSO setup:"}),(0,r.jsx)(S.Z,{className:"mt-2",children:"1. DO NOT Exit this TAB"}),(0,r.jsx)(S.Z,{className:"mt-2",children:"2. Open a new tab, visit your proxy base url"}),(0,r.jsx)(S.Z,{className:"mt-2",children:"3. Confirm your SSO is configured correctly and you can login on the new Tab"}),(0,r.jsx)(S.Z,{className:"mt-2",children:"4. If Step 3 is successful, you can close this tab"}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{onClick:n,children:"Done"})})]})]})};let sc=()=>{let[e,l]=(0,i.useState)("http://localhost:4000");return(0,i.useEffect)(()=>{{let{protocol:e,host:s}=window.location;l("".concat(e,"//").concat(s))}},[]),e};var sm=e=>{let{searchParams:l,accessToken:s,showSSOBanner:t,premiumUser:a}=e,[o]=E.Z.useForm(),[d]=E.Z.useForm(),{Title:c,Paragraph:m}=G.default,[u,h]=(0,i.useState)(""),[x,p]=(0,i.useState)(null),[j,f]=(0,i.useState)(null),[_,y]=(0,i.useState)(!1),[Z,N]=(0,i.useState)(!1),[w,k]=(0,i.useState)(!1),[S,C]=(0,i.useState)(!1),[I,A]=(0,i.useState)(!1),[T,M]=(0,i.useState)(!1),[F,R]=(0,i.useState)(!1),[U,z]=(0,i.useState)(!1),[V,q]=(0,i.useState)(!1),[K,B]=(0,i.useState)([]),[H,J]=(0,i.useState)(null);(0,n.useRouter)();let[W,Y]=(0,i.useState)(null);console.log=function(){};let $=sc(),X="All IP Addresses Allowed",Q=$;Q+="/fallback/login";let ee=async()=>{try{if(!0!==a){P.ZP.error("This feature is only available for premium users. Please upgrade your account.");return}if(s){let e=await (0,g.PT)(s);B(e&&e.length>0?e:[X])}else B([X])}catch(e){console.error("Error fetching allowed IPs:",e),P.ZP.error("Failed to fetch allowed IPs ".concat(e)),B([X])}finally{!0===a&&R(!0)}},el=async e=>{try{if(s){await (0,g.eH)(s,e.ip);let l=await (0,g.PT)(s);B(l),P.ZP.success("IP address added successfully")}}catch(e){console.error("Error adding IP:",e),P.ZP.error("Failed to add IP address ".concat(e))}finally{z(!1)}},es=async e=>{J(e),q(!0)},et=async()=>{if(H&&s)try{await (0,g.$I)(s,H);let e=await (0,g.PT)(s);B(e.length>0?e:[X]),P.ZP.success("IP address deleted successfully")}catch(e){console.error("Error deleting IP:",e),P.ZP.error("Failed to delete IP address ".concat(e))}finally{q(!1),J(null)}};(0,i.useEffect)(()=>{(async()=>{if(null!=s){let e=[],l=await (0,g.Xd)(s,"proxy_admin_viewer");console.log("proxy admin viewer response: ",l);let t=l.users;console.log("proxy viewers response: ".concat(t)),t.forEach(l=>{e.push({user_role:l.user_role,user_id:l.user_id,user_email:l.user_email})}),console.log("proxy viewers: ".concat(t));let a=(await (0,g.Xd)(s,"proxy_admin")).users;a.forEach(l=>{e.push({user_role:l.user_role,user_id:l.user_id,user_email:l.user_email})}),console.log("proxy admins: ".concat(a)),console.log("combinedList: ".concat(e)),p(e),Y(await (0,g.lg)(s))}})()},[s]);let ea=async e=>{try{if(null!=s&&null!=x){var l;P.ZP.info("Making API Call"),e.user_email,e.user_id;let t=await (0,g.pf)(s,e,"proxy_admin"),a=(null===(l=t.data)||void 0===l?void 0:l.user_id)||t.user_id;(0,g.XO)(s,a).then(e=>{f(e),y(!0)}),console.log("response for team create call: ".concat(t));let r=x.findIndex(e=>(console.log("user.user_id=".concat(e.user_id,"; response.user_id=").concat(a)),e.user_id===t.user_id));console.log("foundIndex: ".concat(r)),-1==r&&(console.log("updates admin with new user"),x.push(t),p(x)),o.resetFields(),k(!1)}}catch(e){console.error("Error creating the key:",e)}},er=async e=>{if(null==s)return;let l=so[e.sso_provider],t={PROXY_BASE_URL:e.proxy_base_url};l&&Object.entries(l.envVarMap).forEach(l=>{let[s,a]=l;e[s]&&(t[a]=e[s])}),(0,g.K_)(s,{environment_variables:t})};return console.log("admins: ".concat(null==x?void 0:x.length)),(0,r.jsxs)("div",{className:"w-full m-2 mt-2 p-8",children:[(0,r.jsx)(c,{level:4,children:"Admin Access "}),(0,r.jsx)(m,{children:"Go to 'Internal Users' page to add other admins."}),(0,r.jsxs)(v.Z,{children:[(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(c,{level:4,children:" ✨ Security Settings"}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginTop:"1rem"},children:[(0,r.jsx)("div",{children:(0,r.jsx)(b.Z,{onClick:()=>!0===a?A(!0):P.ZP.error("Only premium users can add SSO"),children:"Add SSO"})}),(0,r.jsx)("div",{children:(0,r.jsx)(b.Z,{onClick:ee,children:"Allowed IPs"})})]})]}),(0,r.jsxs)("div",{className:"flex justify-start mb-4",children:[(0,r.jsx)(sd,{isAddSSOModalVisible:I,isInstructionsModalVisible:T,handleAddSSOOk:()=>{A(!1),o.resetFields()},handleAddSSOCancel:()=>{A(!1),o.resetFields()},handleShowInstructions:e=>{ea(e),er(e),A(!1),M(!0)},handleInstructionsOk:()=>{M(!1)},handleInstructionsCancel:()=>{M(!1)},form:o}),(0,r.jsx)(O.Z,{title:"Manage Allowed IP Addresses",width:800,visible:F,onCancel:()=>R(!1),footer:[(0,r.jsx)(b.Z,{className:"mx-1",onClick:()=>z(!0),children:"Add IP Address"},"add"),(0,r.jsx)(b.Z,{onClick:()=>R(!1),children:"Close"},"close")],children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"IP Address"}),(0,r.jsx)(eI.Z,{className:"text-right",children:"Action"})]})}),(0,r.jsx)(ek.Z,{children:K.map((e,l)=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:e}),(0,r.jsx)(eS.Z,{className:"text-right",children:e!==X&&(0,r.jsx)(b.Z,{onClick:()=>es(e),color:"red",size:"xs",children:"Delete"})})]},l))})]})}),(0,r.jsx)(O.Z,{title:"Add Allowed IP Address",visible:U,onCancel:()=>z(!1),footer:null,children:(0,r.jsxs)(E.Z,{onFinish:el,children:[(0,r.jsx)(E.Z.Item,{name:"ip",rules:[{required:!0,message:"Please enter an IP address"}],children:(0,r.jsx)(D.Z,{placeholder:"Enter IP address"})}),(0,r.jsx)(E.Z.Item,{children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Add IP Address"})})]})}),(0,r.jsx)(O.Z,{title:"Confirm Delete",visible:V,onCancel:()=>q(!1),onOk:et,footer:[(0,r.jsx)(b.Z,{className:"mx-1",onClick:()=>et(),children:"Yes"},"delete"),(0,r.jsx)(b.Z,{onClick:()=>q(!1),children:"Close"},"close")],children:(0,r.jsxs)("p",{children:["Are you sure you want to delete the IP address: ",H,"?"]})})]}),(0,r.jsxs)(si.Z,{title:"Login without SSO",color:"teal",children:["If you need to login without sso, you can access"," ",(0,r.jsxs)("a",{href:Q,target:"_blank",children:[(0,r.jsx)("b",{children:Q})," "]})]})]})]})},su=s(92858),sh=e=>{let{alertingSettings:l,handleInputChange:s,handleResetField:t,handleSubmit:a,premiumUser:i}=e,[n]=E.Z.useForm();return(0,r.jsxs)(E.Z,{form:n,onFinish:()=>{console.log("INSIDE ONFINISH");let e=n.getFieldsValue(),l=Object.entries(e).every(e=>{let[l,s]=e;return"boolean"!=typeof s&&(""===s||null==s)});console.log("formData: ".concat(JSON.stringify(e),", isEmpty: ").concat(l)),l?console.log("Some form fields are empty."):a(e)},labelAlign:"left",children:[l.map((e,l)=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsxs)(eS.Z,{align:"center",children:[(0,r.jsx)(S.Z,{children:e.field_name}),(0,r.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:e.field_description})]}),e.premium_field?i?(0,r.jsx)(E.Z.Item,{name:e.field_name,children:(0,r.jsx)(eS.Z,{children:"Integer"===e.field_type?(0,r.jsx)(M.Z,{step:1,value:e.field_value,onChange:l=>s(e.field_name,l)}):"Boolean"===e.field_type?(0,r.jsx)(su.Z,{checked:e.field_value,onChange:l=>s(e.field_name,l)}):(0,r.jsx)(D.Z,{value:e.field_value,onChange:l=>s(e.field_name,l)})})}):(0,r.jsx)(eS.Z,{children:(0,r.jsx)(b.Z,{className:"flex items-center justify-center",children:(0,r.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})})}):(0,r.jsx)(E.Z.Item,{name:e.field_name,className:"mb-0",valuePropName:"Boolean"===e.field_type?"checked":"value",children:(0,r.jsx)(eS.Z,{children:"Integer"===e.field_type?(0,r.jsx)(M.Z,{step:1,value:e.field_value,onChange:l=>s(e.field_name,l),className:"p-0"}):"Boolean"===e.field_type?(0,r.jsx)(su.Z,{checked:e.field_value,onChange:l=>{s(e.field_name,l),n.setFieldsValue({[e.field_name]:l})}}):(0,r.jsx)(D.Z,{value:e.field_value,onChange:l=>s(e.field_name,l)})})}),(0,r.jsx)(eS.Z,{children:!0==e.stored_in_db?(0,r.jsx)(eO.Z,{icon:ea.Z,className:"text-white",children:"In DB"}):!1==e.stored_in_db?(0,r.jsx)(eO.Z,{className:"text-gray bg-white outline",children:"In Config"}):(0,r.jsx)(eO.Z,{className:"text-gray bg-white outline",children:"Not Set"})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(lj.Z,{icon:eV.Z,color:"red",onClick:()=>t(e.field_name,l),children:"Reset"})})]},l)),(0,r.jsx)("div",{children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Update Settings"})})]})},sx=e=>{let{accessToken:l,premiumUser:s}=e,[t,a]=(0,i.useState)([]);return(0,i.useEffect)(()=>{l&&(0,g.RQ)(l).then(e=>{a(e)})},[l]),(0,r.jsx)(sh,{alertingSettings:t,handleInputChange:(e,l)=>{let s=t.map(s=>s.field_name===e?{...s,field_value:l}:s);console.log("updatedSettings: ".concat(JSON.stringify(s))),a(s)},handleResetField:(e,s)=>{if(l)try{let l=t.map(l=>l.field_name===e?{...l,stored_in_db:null,field_value:l.field_default_value}:l);a(l)}catch(e){console.log("ERROR OCCURRED!")}},handleSubmit:e=>{if(!l||(console.log("formValues: ".concat(e)),null==e||void 0==e))return;let s={};t.forEach(e=>{s[e.field_name]=e.field_value});let a={...e,...s};console.log("mergedFormValues: ".concat(JSON.stringify(a)));let{slack_alerting:r,...i}=a;console.log("slack_alerting: ".concat(r,", alertingArgs: ").concat(JSON.stringify(i)));try{(0,g.jA)(l,"alerting_args",i),"boolean"==typeof r&&(!0==r?(0,g.jA)(l,"alerting",["slack"]):(0,g.jA)(l,"alerting",[])),P.ZP.success("Wait 10s for proxy to update.")}catch(e){}},premiumUser:s})},sp=s(86582);let{Title:sg,Paragraph:sj}=G.default;console.log=function(){};var sf=e=>{let{accessToken:l,userRole:s,userID:t,premiumUser:a}=e,[n,o]=(0,i.useState)([]),[d,c]=(0,i.useState)([]),[m,u]=(0,i.useState)(!1),[h]=E.Z.useForm(),[x,p]=(0,i.useState)(null),[j,f]=(0,i.useState)([]),[_,y]=(0,i.useState)(""),[N,w]=(0,i.useState)({}),[k,C]=(0,i.useState)([]),[I,T]=(0,i.useState)(!1),[M,D]=(0,i.useState)([]),[F,R]=(0,i.useState)(null),[U,z]=(0,i.useState)([]),[V,q]=(0,i.useState)(!1),[K,B]=(0,i.useState)(null),H=e=>{k.includes(e)?C(k.filter(l=>l!==e)):C([...k,e])},J={llm_exceptions:"LLM Exceptions",llm_too_slow:"LLM Responses Too Slow",llm_requests_hanging:"LLM Requests Hanging",budget_alerts:"Budget Alerts (API Keys, Users)",db_exceptions:"Database Exceptions (Read/Write)",daily_reports:"Weekly/Monthly Spend Reports",outage_alerts:"Outage Alerts",region_outage_alerts:"Region Outage Alerts"};(0,i.useEffect)(()=>{l&&s&&t&&(0,g.BL)(l,t,s).then(e=>{console.log("callbacks",e),o(e.callbacks),D(e.available_callbacks);let l=e.alerts;if(console.log("alerts_data",l),l&&l.length>0){let e=l[0];console.log("_alert_info",e);let s=e.variables.SLACK_WEBHOOK_URL;console.log("catch_all_webhook",s),C(e.active_alerts),y(s),w(e.alerts_to_webhook)}c(l)})},[l,s,t]);let G=e=>k&&k.includes(e),Y=()=>{if(!l)return;let e={};d.filter(e=>"email"===e.name).forEach(l=>{var s;Object.entries(null!==(s=l.variables)&&void 0!==s?s:{}).forEach(l=>{let[s,t]=l,a=document.querySelector('input[name="'.concat(s,'"]'));a&&a.value&&(e[s]=null==a?void 0:a.value)})}),console.log("updatedVariables",e);try{(0,g.K_)(l,{general_settings:{alerting:["email"]},environment_variables:e})}catch(e){P.ZP.error("Failed to update alerts: "+e,20)}P.ZP.success("Email settings updated successfully")},$=async e=>{if(!l)return;let s={};Object.entries(e).forEach(e=>{let[l,t]=e;"callback"!==l&&(s[l]=t)});try{await (0,g.K_)(l,{environment_variables:s}),P.ZP.success("Callback added successfully"),u(!1),h.resetFields(),p(null)}catch(e){P.ZP.error("Failed to add callback: "+e,20)}},X=async e=>{if(!l)return;let s=null==e?void 0:e.callback,t={};Object.entries(e).forEach(e=>{let[l,s]=e;"callback"!==l&&(t[l]=s)});try{await (0,g.K_)(l,{environment_variables:t,litellm_settings:{success_callback:[s]}}),P.ZP.success("Callback ".concat(s," added successfully")),u(!1),h.resetFields(),p(null)}catch(e){P.ZP.error("Failed to add callback: "+e,20)}},Q=e=>{console.log("inside handleSelectedCallbackChange",e),p(e.litellm_callback_name),console.log("all callbacks",M),e&&e.litellm_callback_params?(z(e.litellm_callback_params),console.log("selectedCallbackParams",U)):z([])};return l?(console.log("callbacks: ".concat(n)),(0,r.jsxs)("div",{className:"w-full mx-4",children:[(0,r.jsx)(v.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,r.jsxs)(eM.Z,{children:[(0,r.jsxs)(eD.Z,{variant:"line",defaultValue:"1",children:[(0,r.jsx)(eL.Z,{value:"1",children:"Logging Callbacks"}),(0,r.jsx)(eL.Z,{value:"2",children:"Alerting Types"}),(0,r.jsx)(eL.Z,{value:"3",children:"Alerting Settings"}),(0,r.jsx)(eL.Z,{value:"4",children:"Email Alerts"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsxs)(eF.Z,{children:[(0,r.jsx)(sg,{level:4,children:"Active Logging Callbacks"}),(0,r.jsx)(v.Z,{numItems:2,children:(0,r.jsx)(eT.Z,{className:"max-h-[50vh]",children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eI.Z,{children:"Callback Name"})})}),(0,r.jsx)(ek.Z,{children:n.map((e,s)=>(0,r.jsxs)(eA.Z,{className:"flex justify-between",children:[(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{children:e.name})}),(0,r.jsx)(eS.Z,{children:(0,r.jsxs)(v.Z,{numItems:2,className:"flex justify-between",children:[(0,r.jsx)(lj.Z,{icon:lt.Z,size:"sm",onClick:()=>{B(e),q(!0)}}),(0,r.jsx)(b.Z,{onClick:()=>(0,g.jE)(l,e.name),className:"ml-2",variant:"secondary",children:"Test Callback"})]})})]},s))})]})})}),(0,r.jsx)(b.Z,{className:"mt-2",onClick:()=>T(!0),children:"Add Callback"})]}),(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsxs)(S.Z,{className:"my-2",children:["Alerts are only supported for Slack Webhook URLs. Get your webhook urls from"," ",(0,r.jsx)("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",style:{color:"blue"},children:"here"})]}),(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{}),(0,r.jsx)(eI.Z,{}),(0,r.jsx)(eI.Z,{children:"Slack Webhook URL"})]})}),(0,r.jsx)(ek.Z,{children:Object.entries(J).map((e,l)=>{let[s,t]=e;return(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:"region_outage_alerts"==s?a?(0,r.jsx)(su.Z,{id:"switch",name:"switch",checked:G(s),onChange:()=>H(s)}):(0,r.jsx)(b.Z,{className:"flex items-center justify-center",children:(0,r.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})}):(0,r.jsx)(su.Z,{id:"switch",name:"switch",checked:G(s),onChange:()=>H(s)})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{children:t})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(Z.Z,{name:s,type:"password",defaultValue:N&&N[s]?N[s]:_})})]},l)})})]}),(0,r.jsx)(b.Z,{size:"xs",className:"mt-2",onClick:()=>{if(!l)return;let e={};Object.entries(J).forEach(l=>{let[s,t]=l,a=document.querySelector('input[name="'.concat(s,'"]'));console.log("key",s),console.log("webhookInput",a);let r=(null==a?void 0:a.value)||"";console.log("newWebhookValue",r),e[s]=r}),console.log("updatedAlertToWebhooks",e);let s={general_settings:{alert_to_webhook_url:e,alert_types:k}};console.log("payload",s);try{(0,g.K_)(l,s)}catch(e){P.ZP.error("Failed to update alerts: "+e,20)}P.ZP.success("Alerts updated successfully")},children:"Save Changes"}),(0,r.jsx)(b.Z,{onClick:()=>(0,g.jE)(l,"slack"),className:"mx-2",children:"Test Alerts"})]})}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(sx,{accessToken:l,premiumUser:a})}),(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(sg,{level:4,children:"Email Settings"}),(0,r.jsxs)(S.Z,{children:[(0,r.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",style:{color:"blue"},children:" LiteLLM Docs: email alerts"})," ",(0,r.jsx)("br",{})]}),(0,r.jsx)("div",{className:"flex w-full",children:d.filter(e=>"email"===e.name).map((e,l)=>{var s;return(0,r.jsx)(eS.Z,{children:(0,r.jsx)("ul",{children:(0,r.jsx)(v.Z,{numItems:2,children:Object.entries(null!==(s=e.variables)&&void 0!==s?s:{}).map(e=>{let[l,s]=e;return(0,r.jsxs)("li",{className:"mx-2 my-2",children:[!0!=a&&("EMAIL_LOGO_URL"===l||"EMAIL_SUPPORT_CONTACT"===l)?(0,r.jsxs)("div",{children:[(0,r.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:(0,r.jsxs)(S.Z,{className:"mt-2",children:[" ","✨ ",l]})}),(0,r.jsx)(Z.Z,{name:l,defaultValue:s,type:"password",disabled:!0,style:{width:"400px"}})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)(S.Z,{className:"mt-2",children:l}),(0,r.jsx)(Z.Z,{name:l,defaultValue:s,type:"password",style:{width:"400px"}})]}),(0,r.jsxs)("p",{style:{fontSize:"small",fontStyle:"italic"},children:["SMTP_HOST"===l&&(0,r.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP host address, e.g. `smtp.resend.com`",(0,r.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PORT"===l&&(0,r.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP port number, e.g. `587`",(0,r.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_USERNAME"===l&&(0,r.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP username, e.g. `username`",(0,r.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PASSWORD"===l&&(0,r.jsx)("span",{style:{color:"red"},children:" Required * "}),"SMTP_SENDER_EMAIL"===l&&(0,r.jsxs)("div",{style:{color:"gray"},children:["Enter the sender email address, e.g. `sender@berri.ai`",(0,r.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"TEST_EMAIL_ADDRESS"===l&&(0,r.jsxs)("div",{style:{color:"gray"},children:["Email Address to send `Test Email Alert` to. example: `info@berri.ai`",(0,r.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"EMAIL_LOGO_URL"===l&&(0,r.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the Logo that appears in the email, pass a url to your logo"}),"EMAIL_SUPPORT_CONTACT"===l&&(0,r.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the support email address that appears in the email. Default is support@berri.ai"})]})]},l)})})})},l)})}),(0,r.jsx)(b.Z,{className:"mt-2",onClick:()=>Y(),children:"Save Changes"}),(0,r.jsx)(b.Z,{onClick:()=>(0,g.jE)(l,"email"),className:"mx-2",children:"Test Email Alerts"})]})})]})]})}),(0,r.jsxs)(O.Z,{title:"Add Logging Callback",visible:I,width:800,onCancel:()=>T(!1),footer:null,children:[(0,r.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/logging",className:"mb-8 mt-4",target:"_blank",style:{color:"blue"},children:" LiteLLM Docs: Logging"}),(0,r.jsx)(E.Z,{form:h,onFinish:X,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(sp.Z,{label:"Callback",name:"callback",rules:[{required:!0,message:"Please select a callback"}],children:(0,r.jsx)(A.default,{onChange:e=>{let l=M[e];l&&(console.log(l.ui_callback_name),Q(l))},children:M&&Object.values(M).map(e=>(0,r.jsx)(W.Z,{value:e.litellm_callback_name,children:e.ui_callback_name},e.litellm_callback_name))})}),U&&U.map(e=>(0,r.jsx)(sp.Z,{label:e,name:e,rules:[{required:!0,message:"Please enter the value for "+e}],children:(0,r.jsx)(Z.Z,{type:"password"})},e)),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Save"})})]})})]}),(0,r.jsx)(O.Z,{visible:V,width:800,title:"Edit ".concat(null==K?void 0:K.name," Settings"),onCancel:()=>q(!1),footer:null,children:(0,r.jsxs)(E.Z,{form:h,onFinish:$,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsx)(r.Fragment,{children:K&&K.variables&&Object.entries(K.variables).map(e=>{let[l,s]=e;return(0,r.jsx)(sp.Z,{label:l,name:l,children:(0,r.jsx)(Z.Z,{type:"password",defaultValue:s})},l)})}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Save"})})]})})]})):null},s_=s(92414),sy=s(46030);let{Option:sv}=A.default;var sb=e=>{let{models:l,accessToken:s,routerSettings:t,setRouterSettings:a}=e,[n]=E.Z.useForm(),[o,d]=(0,i.useState)(!1),[c,m]=(0,i.useState)("");return(0,r.jsxs)("div",{children:[(0,r.jsx)(b.Z,{className:"mx-auto",onClick:()=>d(!0),children:"+ Add Fallbacks"}),(0,r.jsx)(O.Z,{title:"Add Fallbacks",visible:o,width:800,footer:null,onOk:()=>{d(!1),n.resetFields()},onCancel:()=>{d(!1),n.resetFields()},children:(0,r.jsxs)(E.Z,{form:n,onFinish:e=>{console.log(e);let{model_name:l,models:r}=e,i=[...t.fallbacks||[],{[l]:r}],o={...t,fallbacks:i};console.log(o);try{(0,g.K_)(s,{router_settings:o}),a(o)}catch(e){P.ZP.error("Failed to update router settings: "+e,20)}P.ZP.success("router settings updated successfully"),d(!1),n.resetFields()},labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z.Item,{label:"Public Model Name",name:"model_name",rules:[{required:!0,message:"Set the model to fallback for"}],help:"required",children:(0,r.jsx)(eP.Z,{defaultValue:c,children:l&&l.map((e,l)=>(0,r.jsx)(W.Z,{value:e,onClick:()=>m(e),children:e},l))})}),(0,r.jsx)(E.Z.Item,{label:"Fallback Models",name:"models",rules:[{required:!0,message:"Please select a model"}],help:"required",children:(0,r.jsx)(s_.Z,{value:l,children:l&&l.filter(e=>e!=c).map(e=>(0,r.jsx)(sy.Z,{value:e,children:e},e))})})]}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Add Fallbacks"})})]})})]})},sZ=s(33619);async function sN(e,l){console.log=function(){},console.log("isLocal:",!1);let s=window.location.origin,t=new sZ.ZP.OpenAI({apiKey:l,baseURL:s,dangerouslyAllowBrowser:!0});try{let l=await t.chat.completions.create({model:e,messages:[{role:"user",content:"Hi, this is a test message"}],mock_testing_fallbacks:!0});P.ZP.success((0,r.jsxs)("span",{children:["Test model=",(0,r.jsx)("strong",{children:e}),", received model=",(0,r.jsx)("strong",{children:l.model}),". See"," ",(0,r.jsx)("a",{href:"#",onClick:()=>window.open("https://docs.litellm.ai/docs/proxy/reliability","_blank"),style:{textDecoration:"underline",color:"blue"},children:"curl"})]}))}catch(e){P.ZP.error("Error occurred while generating model response. Please try again. Error: ".concat(e),20)}}let sw={ttl:3600,lowest_latency_buffer:0},sk=e=>{let{selectedStrategy:l,strategyArgs:s,paramExplanation:t}=e;return(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(k.Z,{className:"text-sm font-medium text-tremor-content-strong dark:text-dark-tremor-content-strong",children:"Routing Strategy Specific Args"}),(0,r.jsx)(w.Z,{children:"latency-based-routing"==l?(0,r.jsx)(eT.Z,{children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Setting"}),(0,r.jsx)(eI.Z,{children:"Value"})]})}),(0,r.jsx)(ek.Z,{children:Object.entries(s).map(e=>{let[l,s]=e;return(0,r.jsxs)(eA.Z,{children:[(0,r.jsxs)(eS.Z,{children:[(0,r.jsx)(S.Z,{children:l}),(0,r.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:t[l]})]}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(Z.Z,{name:l,defaultValue:"object"==typeof s?JSON.stringify(s,null,2):s.toString()})})]},l)})})]})}):(0,r.jsx)(S.Z,{children:"No specific settings"})})]})};var sS=e=>{let{accessToken:l,userRole:s,userID:t,modelData:a}=e,[n,o]=(0,i.useState)({}),[d,c]=(0,i.useState)({}),[m,u]=(0,i.useState)([]),[h,x]=(0,i.useState)(!1),[p]=E.Z.useForm(),[j,f]=(0,i.useState)(null),[_,N]=(0,i.useState)(null),[w,k]=(0,i.useState)(null),I={routing_strategy_args:"(dict) Arguments to pass to the routing strategy",routing_strategy:"(string) Routing strategy to use",allowed_fails:"(int) Number of times a deployment can fail before being added to cooldown",cooldown_time:"(int) time in seconds to cooldown a deployment after failure",num_retries:"(int) Number of retries for failed requests. Defaults to 0.",timeout:"(float) Timeout for requests. Defaults to None.",retry_after:"(int) Minimum time to wait before retrying a failed request",ttl:"(int) Sliding window to look back over when calculating the average latency of a deployment. Default - 1 hour (in seconds).",lowest_latency_buffer:"(float) Shuffle between deployments within this % of the lowest latency. Default - 0 (i.e. always pick lowest latency)."};(0,i.useEffect)(()=>{l&&s&&t&&((0,g.BL)(l,t,s).then(e=>{console.log("callbacks",e);let l=e.router_settings;"model_group_retry_policy"in l&&delete l.model_group_retry_policy,o(l)}),(0,g.YU)(l).then(e=>{u(e)}))},[l,s,t]);let A=async e=>{if(!l)return;console.log("received key: ".concat(e)),console.log("routerSettings['fallbacks']: ".concat(n.fallbacks));let s=n.fallbacks.map(l=>(e in l&&delete l[e],l)).filter(e=>Object.keys(e).length>0),t={...n,fallbacks:s};try{await (0,g.K_)(l,{router_settings:t}),o(t),P.ZP.success("Router settings updated successfully")}catch(e){P.ZP.error("Failed to update router settings: "+e,20)}},O=(e,l)=>{u(m.map(s=>s.field_name===e?{...s,field_value:l}:s))},T=(e,s)=>{if(!l)return;let t=m[s].field_value;if(null!=t&&void 0!=t)try{(0,g.jA)(l,e,t);let s=m.map(l=>l.field_name===e?{...l,stored_in_db:!0}:l);u(s)}catch(e){}},L=(e,s)=>{if(l)try{(0,g.ao)(l,e);let s=m.map(l=>l.field_name===e?{...l,stored_in_db:null,field_value:null}:l);u(s)}catch(e){}},D=e=>{if(!l)return;console.log("router_settings",e);let s=Object.fromEntries(Object.entries(e).map(e=>{let[l,s]=e;if("routing_strategy_args"!==l&&"routing_strategy"!==l){var t;return[l,(null===(t=document.querySelector('input[name="'.concat(l,'"]')))||void 0===t?void 0:t.value)||s]}if("routing_strategy"==l)return[l,_];if("routing_strategy_args"==l&&"latency-based-routing"==_){let e={},l=document.querySelector('input[name="lowest_latency_buffer"]'),s=document.querySelector('input[name="ttl"]');return(null==l?void 0:l.value)&&(e.lowest_latency_buffer=Number(l.value)),(null==s?void 0:s.value)&&(e.ttl=Number(s.value)),console.log("setRoutingStrategyArgs: ".concat(e)),["routing_strategy_args",e]}return null}).filter(e=>null!=e));console.log("updatedVariables",s);try{(0,g.K_)(l,{router_settings:s})}catch(e){P.ZP.error("Failed to update router settings: "+e,20)}P.ZP.success("router settings updated successfully")};return l?(0,r.jsx)("div",{className:"w-full mx-4",children:(0,r.jsxs)(eM.Z,{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,r.jsxs)(eD.Z,{variant:"line",defaultValue:"1",children:[(0,r.jsx)(eL.Z,{value:"1",children:"Loadbalancing"}),(0,r.jsx)(eL.Z,{value:"2",children:"Fallbacks"}),(0,r.jsx)(eL.Z,{value:"3",children:"General"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(v.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:[(0,r.jsx)(C.Z,{children:"Router Settings"}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Setting"}),(0,r.jsx)(eI.Z,{children:"Value"})]})}),(0,r.jsx)(ek.Z,{children:Object.entries(n).filter(e=>{let[l,s]=e;return"fallbacks"!=l&&"context_window_fallbacks"!=l&&"routing_strategy_args"!=l}).map(e=>{let[l,s]=e;return(0,r.jsxs)(eA.Z,{children:[(0,r.jsxs)(eS.Z,{children:[(0,r.jsx)(S.Z,{children:l}),(0,r.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:I[l]})]}),(0,r.jsx)(eS.Z,{children:"routing_strategy"==l?(0,r.jsxs)(eP.Z,{defaultValue:s,className:"w-full max-w-md",onValueChange:N,children:[(0,r.jsx)(W.Z,{value:"usage-based-routing",children:"usage-based-routing"}),(0,r.jsx)(W.Z,{value:"latency-based-routing",children:"latency-based-routing"}),(0,r.jsx)(W.Z,{value:"simple-shuffle",children:"simple-shuffle"})]}):(0,r.jsx)(Z.Z,{name:l,defaultValue:"object"==typeof s?JSON.stringify(s,null,2):s.toString()})})]},l)})})]}),(0,r.jsx)(sk,{selectedStrategy:_,strategyArgs:n&&n.routing_strategy_args&&Object.keys(n.routing_strategy_args).length>0?n.routing_strategy_args:sw,paramExplanation:I})]}),(0,r.jsx)(y.Z,{children:(0,r.jsx)(b.Z,{className:"mt-2",onClick:()=>D(n),children:"Save Changes"})})]})}),(0,r.jsxs)(eF.Z,{children:[(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Model Name"}),(0,r.jsx)(eI.Z,{children:"Fallbacks"})]})}),(0,r.jsx)(ek.Z,{children:n.fallbacks&&n.fallbacks.map((e,s)=>Object.entries(e).map(e=>{let[t,a]=e;return(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:t}),(0,r.jsx)(eS.Z,{children:Array.isArray(a)?a.join(", "):a}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(b.Z,{onClick:()=>sN(t,l),children:"Test Fallback"})}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(lj.Z,{icon:eV.Z,size:"sm",onClick:()=>A(t)})})]},s.toString()+t)}))})]}),(0,r.jsx)(sb,{models:(null==a?void 0:a.data)?a.data.map(e=>e.model_name):[],accessToken:l,routerSettings:n,setRouterSettings:o})]}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(eT.Z,{children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Setting"}),(0,r.jsx)(eI.Z,{children:"Value"}),(0,r.jsx)(eI.Z,{children:"Status"}),(0,r.jsx)(eI.Z,{children:"Action"})]})}),(0,r.jsx)(ek.Z,{children:m.filter(e=>"TypedDictionary"!==e.field_type).map((e,l)=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsxs)(eS.Z,{children:[(0,r.jsx)(S.Z,{children:e.field_name}),(0,r.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:e.field_description})]}),(0,r.jsx)(eS.Z,{children:"Integer"==e.field_type?(0,r.jsx)(M.Z,{step:1,value:e.field_value,onChange:l=>O(e.field_name,l)}):null}),(0,r.jsx)(eS.Z,{children:!0==e.stored_in_db?(0,r.jsx)(eO.Z,{icon:ea.Z,className:"text-white",children:"In DB"}):!1==e.stored_in_db?(0,r.jsx)(eO.Z,{className:"text-gray bg-white outline",children:"In Config"}):(0,r.jsx)(eO.Z,{className:"text-gray bg-white outline",children:"Not Set"})}),(0,r.jsxs)(eS.Z,{children:[(0,r.jsx)(b.Z,{onClick:()=>T(e.field_name,l),children:"Update"}),(0,r.jsx)(lj.Z,{icon:eV.Z,color:"red",onClick:()=>L(e.field_name,l),children:"Reset"})]})]},l))})]})})})]})]})}):null},sC=s(93142),sI=s(45246),sA=s(96473),sE=e=>{let{value:l={},onChange:s}=e,[t,a]=(0,i.useState)(Object.entries(l)),n=e=>{let l=t.filter((l,s)=>s!==e);a(l),null==s||s(Object.fromEntries(l))},o=(e,l,r)=>{let i=[...t];i[e]=[l,r],a(i),null==s||s(Object.fromEntries(i))};return(0,r.jsxs)("div",{children:[t.map((e,l)=>{let[s,t]=e;return(0,r.jsxs)(sC.Z,{style:{display:"flex",marginBottom:8},align:"start",children:[(0,r.jsx)(Z.Z,{placeholder:"Header Name",value:s,onChange:e=>o(l,e.target.value,t)}),(0,r.jsx)(Z.Z,{placeholder:"Header Value",value:t,onChange:e=>o(l,s,e.target.value)}),(0,r.jsx)(sI.Z,{onClick:()=>n(l)})]},l)}),(0,r.jsx)(L.ZP,{type:"dashed",onClick:()=>{a([...t,["",""]])},icon:(0,r.jsx)(sA.Z,{}),children:"Add Header"})]})};let{Option:sP}=A.default;var sO=e=>{let{accessToken:l,setPassThroughItems:s,passThroughItems:t}=e,[a]=E.Z.useForm(),[n,o]=(0,i.useState)(!1),[d,c]=(0,i.useState)("");return(0,r.jsxs)("div",{children:[(0,r.jsx)(b.Z,{className:"mx-auto",onClick:()=>o(!0),children:"+ Add Pass-Through Endpoint"}),(0,r.jsx)(O.Z,{title:"Add Pass-Through Endpoint",visible:n,width:800,footer:null,onOk:()=>{o(!1),a.resetFields()},onCancel:()=>{o(!1),a.resetFields()},children:(0,r.jsxs)(E.Z,{form:a,onFinish:e=>{console.log(e);let r=[...t,{headers:e.headers,path:e.path,target:e.target}];try{(0,g.Vt)(l,e),s(r)}catch(e){P.ZP.error("Failed to update router settings: "+e,20)}P.ZP.success("Pass through endpoint successfully added"),o(!1),a.resetFields()},labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z.Item,{label:"Path",name:"path",rules:[{required:!0,message:"The route to be added to the LiteLLM Proxy Server."}],help:"required",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"Target",name:"target",rules:[{required:!0,message:"The URL to which requests for this path should be forwarded."}],help:"required",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(E.Z.Item,{label:"Headers",name:"headers",rules:[{required:!0,message:"Key-value pairs of headers to be forwarded with the request. You can set any key value pair here and it will be forwarded to your target endpoint"}],help:"required",children:(0,r.jsx)(sE,{})})]}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Add Pass-Through Endpoint"})})]})})]})},sT=e=>{let{accessToken:l,userRole:s,userID:t,modelData:a}=e,[n,o]=(0,i.useState)([]);(0,i.useEffect)(()=>{l&&s&&t&&(0,g.mp)(l).then(e=>{o(e.endpoints)})},[l,s,t]);let d=(e,s)=>{if(l)try{(0,g.EG)(l,e);let s=n.filter(l=>l.path!==e);o(s),P.ZP.success("Endpoint deleted successfully.")}catch(e){}};return l?(0,r.jsx)("div",{className:"w-full mx-4",children:(0,r.jsx)(eM.Z,{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Path"}),(0,r.jsx)(eI.Z,{children:"Target"}),(0,r.jsx)(eI.Z,{children:"Headers"}),(0,r.jsx)(eI.Z,{children:"Action"})]})}),(0,r.jsx)(ek.Z,{children:n.map((e,l)=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:(0,r.jsx)(S.Z,{children:e.path})}),(0,r.jsx)(eS.Z,{children:e.target}),(0,r.jsx)(eS.Z,{children:JSON.stringify(e.headers)}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)(lj.Z,{icon:eV.Z,color:"red",onClick:()=>d(e.path,l),children:"Reset"})})]},l))})]}),(0,r.jsx)(sO,{accessToken:l,setPassThroughItems:o,passThroughItems:n})]})})}):null},sL=e=>{let{isModalVisible:l,accessToken:s,setIsModalVisible:t,setBudgetList:a}=e,[i]=E.Z.useForm(),n=async e=>{if(null!=s&&void 0!=s)try{P.ZP.info("Making API Call");let l=await (0,g.Zr)(s,e);console.log("key create Response:",l),a(e=>e?[...e,l]:[l]),P.ZP.success("API Key Created"),i.resetFields()}catch(e){console.error("Error creating the key:",e),P.ZP.error("Error creating the key: ".concat(e),20)}};return(0,r.jsx)(O.Z,{title:"Create Budget",visible:l,width:800,footer:null,onOk:()=>{t(!1),i.resetFields()},onCancel:()=>{t(!1),i.resetFields()},children:(0,r.jsxs)(E.Z,{form:i,onFinish:n,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z.Item,{label:"Budget ID",name:"budget_id",rules:[{required:!0,message:"Please input a human-friendly name for the budget"}],help:"A human-friendly name for the budget",children:(0,r.jsx)(Z.Z,{placeholder:""})}),(0,r.jsx)(E.Z.Item,{label:"Max Tokens per minute",name:"tpm_limit",help:"Default is model limit.",children:(0,r.jsx)(M.Z,{step:1,precision:2,width:200})}),(0,r.jsx)(E.Z.Item,{label:"Max Requests per minute",name:"rpm_limit",help:"Default is model limit.",children:(0,r.jsx)(M.Z,{step:1,precision:2,width:200})}),(0,r.jsxs)(N.Z,{className:"mt-20 mb-8",children:[(0,r.jsx)(k.Z,{children:(0,r.jsx)("b",{children:"Optional Settings"})}),(0,r.jsxs)(w.Z,{children:[(0,r.jsx)(E.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,r.jsx)(M.Z,{step:.01,precision:2,width:200})}),(0,r.jsx)(E.Z.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",children:(0,r.jsxs)(A.default,{defaultValue:null,placeholder:"n/a",children:[(0,r.jsx)(A.default.Option,{value:"24h",children:"daily"}),(0,r.jsx)(A.default.Option,{value:"7d",children:"weekly"}),(0,r.jsx)(A.default.Option,{value:"30d",children:"monthly"})]})})]})]})]}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Create Budget"})})]})})},sM=e=>{let{isModalVisible:l,accessToken:s,setIsModalVisible:t,setBudgetList:a,existingBudget:n,handleUpdateCall:o}=e;console.log("existingBudget",n);let[d]=E.Z.useForm();(0,i.useEffect)(()=>{d.setFieldsValue(n)},[n,d]);let c=async e=>{if(null!=s&&void 0!=s)try{P.ZP.info("Making API Call"),t(!0);let l=await (0,g.qI)(s,e);a(e=>e?[...e,l]:[l]),P.ZP.success("Budget Updated"),d.resetFields(),o()}catch(e){console.error("Error creating the key:",e),P.ZP.error("Error creating the key: ".concat(e),20)}};return(0,r.jsx)(O.Z,{title:"Edit Budget",visible:l,width:800,footer:null,onOk:()=>{t(!1),d.resetFields()},onCancel:()=>{t(!1),d.resetFields()},children:(0,r.jsxs)(E.Z,{form:d,onFinish:c,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",initialValues:n,children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z.Item,{label:"Budget ID",name:"budget_id",rules:[{required:!0,message:"Please input a human-friendly name for the budget"}],help:"A human-friendly name for the budget",children:(0,r.jsx)(Z.Z,{placeholder:""})}),(0,r.jsx)(E.Z.Item,{label:"Max Tokens per minute",name:"tpm_limit",help:"Default is model limit.",children:(0,r.jsx)(M.Z,{step:1,precision:2,width:200})}),(0,r.jsx)(E.Z.Item,{label:"Max Requests per minute",name:"rpm_limit",help:"Default is model limit.",children:(0,r.jsx)(M.Z,{step:1,precision:2,width:200})}),(0,r.jsxs)(N.Z,{className:"mt-20 mb-8",children:[(0,r.jsx)(k.Z,{children:(0,r.jsx)("b",{children:"Optional Settings"})}),(0,r.jsxs)(w.Z,{children:[(0,r.jsx)(E.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,r.jsx)(M.Z,{step:.01,precision:2,width:200})}),(0,r.jsx)(E.Z.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",children:(0,r.jsxs)(A.default,{defaultValue:null,placeholder:"n/a",children:[(0,r.jsx)(A.default.Option,{value:"24h",children:"daily"}),(0,r.jsx)(A.default.Option,{value:"7d",children:"weekly"}),(0,r.jsx)(A.default.Option,{value:"30d",children:"monthly"})]})})]})]})]}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(L.ZP,{htmlType:"submit",children:"Save"})})]})})},sD=s(17906),sF=e=>{let{accessToken:l}=e,[s,t]=(0,i.useState)(!1),[a,n]=(0,i.useState)(!1),[o,d]=(0,i.useState)(null),[c,m]=(0,i.useState)([]);(0,i.useEffect)(()=>{l&&(0,g.O3)(l).then(e=>{m(e)})},[l]);let u=async(e,s)=>{console.log("budget_id",e),null!=l&&(d(c.find(l=>l.budget_id===e)||null),n(!0))},h=async(e,s)=>{if(null==l)return;P.ZP.info("Request made"),await (0,g.NV)(l,e);let t=[...c];t.splice(s,1),m(t),P.ZP.success("Budget Deleted.")},x=async()=>{null!=l&&(0,g.O3)(l).then(e=>{m(e)})};return(0,r.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[(0,r.jsx)(b.Z,{size:"sm",variant:"primary",className:"mb-2",onClick:()=>t(!0),children:"+ Create Budget"}),(0,r.jsx)(sL,{accessToken:l,isModalVisible:s,setIsModalVisible:t,setBudgetList:m}),o&&(0,r.jsx)(sM,{accessToken:l,isModalVisible:a,setIsModalVisible:n,setBudgetList:m,existingBudget:o,handleUpdateCall:x}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(S.Z,{children:"Create a budget to assign to customers."}),(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Budget ID"}),(0,r.jsx)(eI.Z,{children:"Max Budget"}),(0,r.jsx)(eI.Z,{children:"TPM"}),(0,r.jsx)(eI.Z,{children:"RPM"})]})}),(0,r.jsx)(ek.Z,{children:c.slice().sort((e,l)=>new Date(l.updated_at).getTime()-new Date(e.updated_at).getTime()).map((e,l)=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:e.budget_id}),(0,r.jsx)(eS.Z,{children:e.max_budget?e.max_budget:"n/a"}),(0,r.jsx)(eS.Z,{children:e.tpm_limit?e.tpm_limit:"n/a"}),(0,r.jsx)(eS.Z,{children:e.rpm_limit?e.rpm_limit:"n/a"}),(0,r.jsx)(lj.Z,{icon:lt.Z,size:"sm",onClick:()=>u(e.budget_id,l)}),(0,r.jsx)(lj.Z,{icon:eV.Z,size:"sm",onClick:()=>h(e.budget_id,l)})]},l))})]})]}),(0,r.jsxs)("div",{className:"mt-5",children:[(0,r.jsx)(S.Z,{className:"text-base",children:"How to use budget id"}),(0,r.jsxs)(eM.Z,{children:[(0,r.jsxs)(eD.Z,{children:[(0,r.jsx)(eL.Z,{children:"Assign Budget to Customer"}),(0,r.jsx)(eL.Z,{children:"Test it (Curl)"}),(0,r.jsx)(eL.Z,{children:"Test it (OpenAI SDK)"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{children:(0,r.jsx)(sD.Z,{language:"bash",children:"\ncurl -X POST --location '<your_proxy_base_url>/end_user/new' \n-H 'Authorization: Bearer <your-master-key>' \n-H 'Content-Type: application/json' \n-d '{\"user_id\": \"my-customer-id', \"budget_id\": \"<BUDGET_ID>\"}' # \uD83D\uDC48 KEY CHANGE\n\n            "})}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(sD.Z,{language:"bash",children:'\ncurl -X POST --location \'<your_proxy_base_url>/chat/completions\' \n-H \'Authorization: Bearer <your-master-key>\' \n-H \'Content-Type: application/json\' \n-d \'{\n  "model": "gpt-3.5-turbo\', \n  "messages":[{"role": "user", "content": "Hey, how\'s it going?"}],\n  "user": "my-customer-id"\n}\' # \uD83D\uDC48 KEY CHANGE\n\n            '})}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(sD.Z,{language:"python",children:'from openai import OpenAI\nclient = OpenAI(\n  base_url="<your_proxy_base_url>",\n  api_key="<your_proxy_key>"\n)\n\ncompletion = client.chat.completions.create(\n  model="gpt-3.5-turbo",\n  messages=[\n    {"role": "system", "content": "You are a helpful assistant."},\n    {"role": "user", "content": "Hello!"}\n  ],\n  user="my-customer-id"\n)\n\nprint(completion.choices[0].message)'})})]})]})]})]})},sR=s(77398),sU=s.n(sR),sz=s(20016);async function sV(e){try{let l=await fetch("http://ip-api.com/json/".concat(e)),s=await l.json();console.log("ip lookup data",s);let t=s.countryCode?s.countryCode.toUpperCase().split("").map(e=>String.fromCodePoint(e.charCodeAt(0)+127397)).join(""):"";return s.country?"".concat(t," ").concat(s.country):"Unknown"}catch(e){return console.error("Error looking up IP:",e),"Unknown"}}let sq=e=>{let{ipAddress:l}=e,[s,t]=i.useState("-");return i.useEffect(()=>{if(!l)return;let e=!0;return sV(l).then(l=>{e&&t(l)}).catch(()=>{e&&t("-")}),()=>{e=!1}},[l]),(0,r.jsx)("span",{children:s})},sK=e=>{try{return new Date(e).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).replace(",","")}catch(e){return"Error converting time"}},sB=e=>{let{utcTime:l}=e;return(0,r.jsx)("span",{style:{fontFamily:"monospace",width:"180px",display:"inline-block"},children:sK(l)})},sH=[{id:"expander",header:()=>null,cell:e=>{let{row:l}=e;return(0,r.jsx)(()=>{let[e,s]=i.useState(l.getIsExpanded()),t=i.useCallback(()=>{s(e=>!e),l.getToggleExpandedHandler()()},[l]);return l.getCanExpand()?(0,r.jsx)("button",{onClick:t,style:{cursor:"pointer"},"aria-label":e?"Collapse row":"Expand row",className:"w-6 h-6 flex items-center justify-center focus:outline-none",children:(0,r.jsx)("svg",{className:"w-4 h-4 transform transition-transform duration-75 ".concat(e?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):(0,r.jsx)("span",{className:"w-6 h-6 flex items-center justify-center",children:"●"})},{})}},{header:"Time",accessorKey:"startTime",cell:e=>(0,r.jsx)(sB,{utcTime:e.getValue()})},{header:"Status",accessorKey:"metadata.status",cell:e=>{let l="failure"!==(e.getValue()||"Success").toLowerCase();return(0,r.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat(l?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:l?"Success":"Failure"})}},{header:"Request ID",accessorKey:"request_id",cell:e=>(0,r.jsx)(V.Z,{title:String(e.getValue()||""),children:(0,r.jsx)("span",{className:"font-mono text-xs max-w-[15ch] truncate block",children:String(e.getValue()||"")})})},{header:"Cost",accessorKey:"spend",cell:e=>(0,r.jsxs)("span",{children:["$",Number(e.getValue()||0).toFixed(6)]})},{header:"Country",accessorKey:"requester_ip_address",cell:e=>(0,r.jsx)(sq,{ipAddress:e.getValue()})},{header:"Team Name",accessorKey:"metadata.user_api_key_team_alias",cell:e=>(0,r.jsx)(V.Z,{title:String(e.getValue()||"-"),children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Key Hash",accessorKey:"metadata.user_api_key",cell:e=>{let l=String(e.getValue()||"-");return(0,r.jsx)(V.Z,{title:l,children:(0,r.jsx)("span",{className:"font-mono max-w-[15ch] truncate block",children:l})})}},{header:"Key Name",accessorKey:"metadata.user_api_key_alias",cell:e=>(0,r.jsx)(V.Z,{title:String(e.getValue()||"-"),children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Model",accessorKey:"model",cell:e=>{let l=e.row.original.custom_llm_provider,s=String(e.getValue()||"");return(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[l&&(0,r.jsx)("img",{src:e7(l).logo,alt:"",className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,r.jsx)(V.Z,{title:s,children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:s})})]})}},{header:"Tokens",accessorKey:"total_tokens",cell:e=>{let l=e.row.original;return(0,r.jsxs)("span",{className:"text-sm",children:[String(l.total_tokens||"0"),(0,r.jsxs)("span",{className:"text-gray-400 text-xs ml-1",children:["(",String(l.prompt_tokens||"0"),"+",String(l.completion_tokens||"0"),")"]})]})}},{header:"Internal User",accessorKey:"user",cell:e=>(0,r.jsx)(V.Z,{title:String(e.getValue()||"-"),children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"End User",accessorKey:"end_user",cell:e=>(0,r.jsx)(V.Z,{title:String(e.getValue()||"-"),children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Tags",accessorKey:"request_tags",cell:e=>{let l=e.getValue();if(!l||0===Object.keys(l).length)return"-";let s=Object.entries(l),t=s[0],a=s.slice(1);return(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:(0,r.jsx)(V.Z,{title:(0,r.jsx)("div",{className:"flex flex-col gap-1",children:s.map(e=>{let[l,s]=e;return(0,r.jsxs)("span",{children:[l,": ",String(s)]},l)})}),children:(0,r.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[t[0],": ",String(t[1]),a.length>0&&" +".concat(a.length)]})})})}}],sJ=async(e,l,s,t)=>{console.log("prefetchLogDetails called with",e.length,"logs");let a=e.map(e=>{if(e.request_id)return console.log("Prefetching details for request_id:",e.request_id),t.prefetchQuery({queryKey:["logDetails",e.request_id,l],queryFn:async()=>{console.log("Fetching details for",e.request_id);let t=await (0,g.qk)(s,e.request_id,l);return console.log("Received details for",e.request_id,":",t?"success":"failed"),t},staleTime:6e5,gcTime:6e5})});try{let e=await Promise.all(a);return console.log("All prefetch promises completed:",e.length),e}catch(e){throw console.error("Error in prefetchLogDetails:",e),e}},sW=e=>{var l;let{errorInfo:s}=e,[t,a]=i.useState({}),[n,o]=i.useState(!1),d=e=>{a(l=>({...l,[e]:!l[e]}))},c=s.traceback&&(l=s.traceback)?Array.from(l.matchAll(/File "([^"]+)", line (\d+)/g)).map(e=>{let s=e[1],t=e[2],a=s.split("/").pop()||s,r=e.index||0,i=l.indexOf('File "',r+1),n=i>-1?l.substring(r,i).trim():l.substring(r).trim(),o=n.split("\n"),d="";return o.length>1&&(d=o[o.length-1].trim()),{filePath:s,fileName:a,lineNumber:t,code:d,inFunction:n.includes(" in ")?n.split(" in ")[1].split("\n")[0]:""}}):[];return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"p-4 border-b",children:(0,r.jsxs)("h3",{className:"text-lg font-medium flex items-center text-red-600",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Error Details"]})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"bg-red-50 rounded-md p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"text-red-800 font-medium w-20",children:"Type:"}),(0,r.jsx)("span",{className:"text-red-700",children:s.error_class||"Unknown Error"})]}),(0,r.jsxs)("div",{className:"flex mt-2",children:[(0,r.jsx)("span",{className:"text-red-800 font-medium w-20",children:"Message:"}),(0,r.jsx)("span",{className:"text-red-700",children:s.error_message||"Unknown error occurred"})]})]}),s.traceback&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h4",{className:"font-medium",children:"Traceback"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>{let e=!n;if(o(e),c.length>0){let l={};c.forEach((s,t)=>{l[t]=e}),a(l)}},className:"text-gray-500 hover:text-gray-700 flex items-center text-sm",children:n?"Collapse All":"Expand All"}),(0,r.jsxs)("button",{onClick:()=>navigator.clipboard.writeText(s.traceback||""),className:"text-gray-500 hover:text-gray-700 flex items-center",title:"Copy traceback",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),(0,r.jsx)("span",{className:"ml-1",children:"Copy"})]})]})]}),(0,r.jsx)("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden shadow-sm",children:c.map((e,l)=>(0,r.jsxs)("div",{className:"border-b border-gray-200 last:border-b-0",children:[(0,r.jsxs)("div",{className:"px-4 py-2 flex items-center justify-between cursor-pointer hover:bg-gray-50",onClick:()=>d(l),children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-gray-400 mr-2 w-12 text-right",children:e.lineNumber}),(0,r.jsx)("span",{className:"text-gray-600 font-medium",children:e.fileName}),(0,r.jsx)("span",{className:"text-gray-500 mx-1",children:"in"}),(0,r.jsx)("span",{className:"text-indigo-600 font-medium",children:e.inFunction||e.fileName})]}),(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-500 transition-transform ".concat(t[l]?"transform rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(t[l]||!1)&&e.code&&(0,r.jsx)("div",{className:"px-12 py-2 font-mono text-sm text-gray-800 bg-gray-50 overflow-x-auto border-t border-gray-100",children:e.code})]},l))})]})]})]})},sG=e=>{let{show:l}=e;return l?(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start",children:[(0,r.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,r.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Request/Response Data Not Available"}),(0,r.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["To view request and response details, enable prompt storage in your LiteLLM configuration by adding the following to your ",(0,r.jsx)("code",{className:"bg-blue-100 px-1 py-0.5 rounded",children:"proxy_config.yaml"})," file:"]}),(0,r.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"general_settings:\n  store_model_in_db: true\n  store_prompts_in_spend_logs: true"}),(0,r.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change."})]})]}):null};function sY(e){var l,s,t,a;let{accessToken:n,token:o,userRole:d,userID:m}=e,[u,h]=(0,i.useState)(""),[x,p]=(0,i.useState)(!1),[j,f]=(0,i.useState)(!1),[_,y]=(0,i.useState)(1),[v]=(0,i.useState)(50),b=(0,i.useRef)(null),Z=(0,i.useRef)(null),N=(0,i.useRef)(null),[w,k]=(0,i.useState)(sU()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),[S,C]=(0,i.useState)(sU()().format("YYYY-MM-DDTHH:mm")),[I,A]=(0,i.useState)(!1),[E,P]=(0,i.useState)(!1),[O,T]=(0,i.useState)(""),[L,M]=(0,i.useState)(""),[D,F]=(0,i.useState)(""),[R,U]=(0,i.useState)(""),[z,V]=(0,i.useState)("Team ID"),[q,K]=(0,i.useState)(d&&em.includes(d)),[B,H]=(0,i.useState)(null),J=(0,c.NL)();(0,i.useEffect)(()=>{function e(e){b.current&&!b.current.contains(e.target)&&f(!1),Z.current&&!Z.current.contains(e.target)&&p(!1),N.current&&!N.current.contains(e.target)&&P(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,i.useEffect)(()=>{d&&em.includes(d)&&K(!0)},[d]);let W=(0,sz.a)({queryKey:["logs","table",_,v,w,S,D,R,q?m:null],queryFn:async()=>{if(!n||!o||!d||!m)return console.log("Missing required auth parameters"),{data:[],total:0,page:1,page_size:v,total_pages:0};let e=sU()(w).utc().format("YYYY-MM-DD HH:mm:ss"),l=I?sU()(S).utc().format("YYYY-MM-DD HH:mm:ss"):sU()().utc().format("YYYY-MM-DD HH:mm:ss"),s=await (0,g.h3)(n,R||void 0,D||void 0,void 0,e,l,_,v,q?m:void 0);return await sJ(s.data,e,n,J),s.data=s.data.map(l=>{let s=J.getQueryData(["logDetails",l.request_id,e]);return(null==s?void 0:s.messages)&&(null==s?void 0:s.response)&&(l.messages=s.messages,l.response=s.response),l}),s},enabled:!!n&&!!o&&!!d&&!!m,refetchInterval:5e3,refetchIntervalInBackground:!0});if((0,i.useEffect)(()=>{var e;(null===(e=W.data)||void 0===e?void 0:e.data)&&B&&!W.data.data.some(e=>e.request_id===B)&&H(null)},[null===(l=W.data)||void 0===l?void 0:l.data,B]),!n||!o||!d||!m)return console.log("got None values for one of accessToken, token, userRole, userID"),null;let G=(null===(t=W.data)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.filter(e=>!u||e.request_id.includes(u)||e.model.includes(u)||e.user&&e.user.includes(u)))||[],Y=()=>{if(I)return"".concat(sU()(w).format("MMM D, h:mm A")," - ").concat(sU()(S).format("MMM D, h:mm A"));let e=sU()(),l=sU()(w),s=e.diff(l,"minutes");if(s<=15)return"Last 15 Minutes";if(s<=60)return"Last Hour";let t=e.diff(l,"hours");return t<=4?"Last 4 Hours":t<=24?"Last 24 Hours":t<=168?"Last 7 Days":"".concat(l.format("MMM D")," - ").concat(e.format("MMM D"))};return(0,r.jsxs)("div",{className:"w-full p-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,r.jsx)("h1",{className:"text-xl font-semibold",children:"Request Logs"})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"border-b px-6 py-4",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,r.jsxs)("div",{className:"relative w-64",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by Request ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:u,onChange:e=>h(e.target.value)}),(0,r.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,r.jsxs)("div",{className:"relative",ref:Z,children:[(0,r.jsxs)("button",{className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",onClick:()=>p(!x),children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filter"]}),x&&(0,r.jsx)("div",{className:"absolute left-0 mt-2 w-[500px] bg-white rounded-lg shadow-lg border p-4 z-50",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Where"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>f(!j),className:"px-3 py-1.5 border rounded-md bg-white text-sm min-w-[160px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-left flex justify-between items-center",children:[z,(0,r.jsx)("svg",{className:"h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),j&&(0,r.jsx)("div",{className:"absolute left-0 mt-1 w-[160px] bg-white border rounded-md shadow-lg z-50",children:["Team ID","Key Hash"].map(e=>(0,r.jsxs)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2 ".concat(z===e?"bg-blue-50 text-blue-600":""),onClick:()=>{V(e),f(!1),"Team ID"===e?M(""):T("")},children:[z===e&&(0,r.jsx)("svg",{className:"h-4 w-4 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e]},e))})]}),(0,r.jsx)("input",{type:"text",placeholder:"Enter value...",className:"px-3 py-1.5 border rounded-md text-sm flex-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:"Team ID"===z?O:L,onChange:e=>{"Team ID"===z?T(e.target.value):M(e.target.value)}}),(0,r.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded-md",onClick:()=>{T(""),M("")},children:(0,r.jsx)("span",{className:"text-gray-500",children:"\xd7"})})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{className:"px-3 py-1.5 text-sm border rounded-md hover:bg-gray-50",onClick:()=>{T(""),M(""),p(!1)},children:"Cancel"}),(0,r.jsx)("button",{className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700",onClick:()=>{F(O),U(L),y(1),p(!1)},children:"Apply Filters"})]})]})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"relative",ref:N,children:[(0,r.jsxs)("button",{onClick:()=>P(!E),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Y()]}),E&&(0,r.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border p-2 z-50",children:(0,r.jsxs)("div",{className:"space-y-1",children:[[{label:"Last 15 Minutes",value:15,unit:"minutes"},{label:"Last Hour",value:1,unit:"hours"},{label:"Last 4 Hours",value:4,unit:"hours"},{label:"Last 24 Hours",value:24,unit:"hours"},{label:"Last 7 Days",value:7,unit:"days"}].map(e=>(0,r.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(Y()===e.label?"bg-blue-50 text-blue-600":""),onClick:()=>{C(sU()().format("YYYY-MM-DDTHH:mm")),k(sU()().subtract(e.value,e.unit).format("YYYY-MM-DDTHH:mm")),P(!1),A(!1)},children:e.label},e.label)),(0,r.jsx)("div",{className:"border-t my-2"}),(0,r.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(I?"bg-blue-50 text-blue-600":""),onClick:()=>A(!I),children:"Custom Range"})]})})]}),(0,r.jsxs)("button",{onClick:()=>{W.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,r.jsx)("svg",{className:"w-4 h-4 ".concat(W.isFetching?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,r.jsx)("span",{children:"Refresh"})]})]}),I&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"datetime-local",value:w,onChange:e=>{k(e.target.value),y(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,r.jsx)("span",{className:"text-gray-500",children:"to"}),(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"datetime-local",value:S,onChange:e=>{C(e.target.value),y(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing"," ",W.isLoading?"...":W.data?(_-1)*v+1:0," ","-"," ",W.isLoading?"...":W.data?Math.min(_*v,W.data.total):0," ","of"," ",W.isLoading?"...":W.data?W.data.total:0," ","results"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",W.isLoading?"...":_," of"," ",W.isLoading?"...":W.data?W.data.total_pages:1]}),(0,r.jsx)("button",{onClick:()=>y(e=>Math.max(1,e-1)),disabled:W.isLoading||1===_,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,r.jsx)("button",{onClick:()=>y(e=>{var l;return Math.min((null===(l=W.data)||void 0===l?void 0:l.total_pages)||1,e+1)}),disabled:W.isLoading||_===((null===(a=W.data)||void 0===a?void 0:a.total_pages)||1),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}),(0,r.jsx)(eE,{columns:sH,data:G,renderSubComponent:s$,getRowCanExpand:()=>!0,onRowExpand:e=>{H(e)},expandedRequestId:B})]})]})}function s$(e){var l,s,t,a,i,n;let{row:o}=e,d=e=>{let l={...e};return"proxy_server_request"in l&&delete l.proxy_server_request,l},c=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},m=()=>{var e;return(null===(e=o.original.metadata)||void 0===e?void 0:e.proxy_server_request)?c(o.original.metadata.proxy_server_request):c(o.original.messages)},u=(null===(l=o.original.metadata)||void 0===l?void 0:l.status)==="failure",h=u?null===(s=o.original.metadata)||void 0===s?void 0:s.error_information:null,x=o.original.messages&&(Array.isArray(o.original.messages)?o.original.messages.length>0:Object.keys(o.original.messages).length>0),p=o.original.response&&Object.keys(c(o.original.response)).length>0,g=()=>u&&h?{error:{message:h.error_message||"An error occurred",type:h.error_class||"error",code:h.error_code||"unknown",param:null}}:c(o.original.response);return(0,r.jsxs)("div",{className:"p-6 bg-gray-50 space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"p-4 border-b",children:(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Request Details"})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 p-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Request ID:"}),(0,r.jsx)("span",{className:"font-mono text-sm",children:o.original.request_id})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Model:"}),(0,r.jsx)("span",{children:o.original.model})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,r.jsx)("span",{children:o.original.custom_llm_provider||"-"})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,r.jsx)("span",{children:o.original.startTime})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,r.jsx)("span",{children:o.original.endTime})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Tokens:"}),(0,r.jsxs)("span",{children:[o.original.total_tokens," (",o.original.prompt_tokens,"+",o.original.completion_tokens,")"]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Cost:"}),(0,r.jsxs)("span",{children:["$",Number(o.original.spend||0).toFixed(6)]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Cache Hit:"}),(0,r.jsx)("span",{children:o.original.cache_hit})]}),(null==o?void 0:null===(t=o.original)||void 0===t?void 0:t.requester_ip_address)&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"IP Address:"}),(0,r.jsx)("span",{children:null==o?void 0:null===(a=o.original)||void 0===a?void 0:a.requester_ip_address})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat("failure"!==((null===(i=o.original.metadata)||void 0===i?void 0:i.status)||"Success").toLowerCase()?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"failure"!==((null===(n=o.original.metadata)||void 0===n?void 0:n.status)||"Success").toLowerCase()?"Success":"Failure"})]})]})]})]}),(0,r.jsx)(sG,{show:!x&&!p}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Request"}),(0,r.jsx)("button",{onClick:()=>navigator.clipboard.writeText(JSON.stringify(m(),null,2)),className:"p-1 hover:bg-gray-200 rounded",title:"Copy request",disabled:!x,children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,r.jsx)("div",{className:"p-4 overflow-auto max-h-96",children:(0,r.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(m(),null,2)})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium",children:["Response",u&&(0,r.jsxs)("span",{className:"ml-2 text-sm text-red-600",children:["• HTTP code ",(null==h?void 0:h.error_code)||400]})]}),(0,r.jsx)("button",{onClick:()=>navigator.clipboard.writeText(JSON.stringify(g(),null,2)),className:"p-1 hover:bg-gray-200 rounded",title:"Copy response",disabled:!p,children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,r.jsx)("div",{className:"p-4 overflow-auto max-h-96 bg-gray-50",children:p?(0,r.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(g(),null,2)}):(0,r.jsx)("div",{className:"text-gray-500 text-sm italic text-center py-4",children:"Response data not available"})})]})]}),u&&h&&(0,r.jsx)(sW,{errorInfo:h}),o.original.request_tags&&Object.keys(o.original.request_tags).length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"flex justify-between items-center p-4 border-b",children:(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Request Tags"})}),(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(o.original.request_tags).map(e=>{let[l,s]=e;return(0,r.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[l,": ",String(s)]},l)})})})]}),o.original.metadata&&Object.keys(o.original.metadata).length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Metadata"}),(0,r.jsx)("button",{onClick:()=>{let e=d(o.original.metadata);navigator.clipboard.writeText(JSON.stringify(e,null,2))},className:"p-1 hover:bg-gray-200 rounded",title:"Copy metadata",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,r.jsx)("div",{className:"p-4 overflow-auto max-h-64",children:(0,r.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(d(o.original.metadata),null,2)})})]})]})}var sX=s(92699),sQ=e=>{let{proxySettings:l}=e,s="<your_proxy_base_url>";return l&&l.PROXY_BASE_URL&&void 0!==l.PROXY_BASE_URL&&(s=l.PROXY_BASE_URL),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(v.Z,{className:"gap-2 p-8 h-[80vh] w-full mt-2",children:(0,r.jsxs)("div",{className:"mb-5",children:[(0,r.jsx)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:"OpenAI Compatible Proxy: API Reference"}),(0,r.jsx)(S.Z,{className:"mt-2 mb-2",children:"LiteLLM is OpenAI Compatible. This means your API Key works with the OpenAI SDK. Just replace the base_url to point to your litellm proxy. Example Below "}),(0,r.jsxs)(eM.Z,{children:[(0,r.jsxs)(eD.Z,{children:[(0,r.jsx)(eL.Z,{children:"OpenAI Python SDK"}),(0,r.jsx)(eL.Z,{children:"LlamaIndex"}),(0,r.jsx)(eL.Z,{children:"Langchain Py"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{children:(0,r.jsx)(sD.Z,{language:"python",children:'\nimport openai\nclient = openai.OpenAI(\n    api_key="your_api_key",\n    base_url="'.concat(s,'" # LiteLLM Proxy is OpenAI compatible, Read More: https://docs.litellm.ai/docs/proxy/user_keys\n)\n\nresponse = client.chat.completions.create(\n    model="gpt-3.5-turbo", # model to send to the proxy\n    messages = [\n        {\n            "role": "user",\n            "content": "this is a test request, write a short poem"\n        }\n    ]\n)\n\nprint(response)\n            ')})}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(sD.Z,{language:"python",children:'\nimport os, dotenv\n\nfrom llama_index.llms import AzureOpenAI\nfrom llama_index.embeddings import AzureOpenAIEmbedding\nfrom llama_index import VectorStoreIndex, SimpleDirectoryReader, ServiceContext\n\nllm = AzureOpenAI(\n    engine="azure-gpt-3.5",               # model_name on litellm proxy\n    temperature=0.0,\n    azure_endpoint="'.concat(s,'", # litellm proxy endpoint\n    api_key="sk-1234",                    # litellm proxy API Key\n    api_version="2023-07-01-preview",\n)\n\nembed_model = AzureOpenAIEmbedding(\n    deployment_name="azure-embedding-model",\n    azure_endpoint="').concat(s,'",\n    api_key="sk-1234",\n    api_version="2023-07-01-preview",\n)\n\n\ndocuments = SimpleDirectoryReader("llama_index_data").load_data()\nservice_context = ServiceContext.from_defaults(llm=llm, embed_model=embed_model)\nindex = VectorStoreIndex.from_documents(documents, service_context=service_context)\n\nquery_engine = index.as_query_engine()\nresponse = query_engine.query("What did the author do growing up?")\nprint(response)\n\n            ')})}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(sD.Z,{language:"python",children:'\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.prompts.chat import (\n    ChatPromptTemplate,\n    HumanMessagePromptTemplate,\n    SystemMessagePromptTemplate,\n)\nfrom langchain.schema import HumanMessage, SystemMessage\n\nchat = ChatOpenAI(\n    openai_api_base="'.concat(s,'",\n    model = "gpt-3.5-turbo",\n    temperature=0.1\n)\n\nmessages = [\n    SystemMessage(\n        content="You are a helpful assistant that im using to make a test request to."\n    ),\n    HumanMessage(\n        content="test from litellm. tell me why it\'s amazing in 1 sentence"\n    ),\n]\nresponse = chat(messages)\n\nprint(response)\n\n            ')})})]})]})]})})})},s0=s(243),s1=s(94263);async function s2(e,l,s,t){console.log=function(){},console.log("isLocal:",!1);let a=window.location.origin,r=new sZ.ZP.OpenAI({apiKey:t,baseURL:a,dangerouslyAllowBrowser:!0});try{for await(let t of(await r.chat.completions.create({model:s,stream:!0,messages:e})))console.log(t),t.choices[0].delta.content&&l(t.choices[0].delta.content,t.model)}catch(e){P.ZP.error("Error occurred while generating model response. Please try again. Error: ".concat(e),20)}}var s4=e=>{let{accessToken:l,token:s,userRole:t,userID:a,disabledPersonalKeyCreation:n}=e,[o,d]=(0,i.useState)(n?"custom":"session"),[c,m]=(0,i.useState)(""),[u,h]=(0,i.useState)(""),[x,p]=(0,i.useState)([]),[j,f]=(0,i.useState)(void 0),[_,N]=(0,i.useState)(!1),[w,k]=(0,i.useState)([]),C=(0,i.useRef)(null),I=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e="session"===o?l:c;if(console.log("useApiKey:",e),!e||!s||!t||!a){console.log("useApiKey or token or userRole or userID is missing = ",e,s,t,a);return}(async()=>{try{let l=await (0,g.So)(null!=e?e:"",a,t);if(console.log("model_info:",l),(null==l?void 0:l.data.length)>0){let e=new Map;l.data.forEach(l=>{e.set(l.id,{value:l.id,label:l.id})});let s=Array.from(e.values());s.sort((e,l)=>e.label.localeCompare(l.label)),k(s),f(s[0].value)}}catch(e){console.error("Error fetching model info:",e)}})()},[l,a,t,o,c]),(0,i.useEffect)(()=>{I.current&&setTimeout(()=>{var e;null===(e=I.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},100)},[x]);let E=(e,l,s)=>{p(t=>{let a=t[t.length-1];return a&&a.role===e?[...t.slice(0,t.length-1),{role:e,content:a.content+l,model:s}]:[...t,{role:e,content:l,model:s}]})},O=async()=>{if(""===u.trim()||!s||!t||!a)return;let e="session"===o?l:c;if(!e){P.ZP.error("Please provide an API key or select Current UI Session");return}let r={role:"user",content:u},i=[...x.map(e=>{let{role:l,content:s}=e;return{role:l,content:s}}),r];p([...x,r]);try{j&&await s2(i,(e,l)=>E("assistant",e,l),j,e)}catch(e){console.error("Error fetching model response",e),E("assistant","Error fetching model response")}h("")};if(t&&"Admin Viewer"===t){let{Title:e,Paragraph:l}=G.default;return(0,r.jsxs)("div",{children:[(0,r.jsx)(e,{level:1,children:"Access Denied"}),(0,r.jsx)(l,{children:"Ask your proxy admin for access to test models"})]})}return(0,r.jsx)("div",{style:{width:"100%",position:"relative"},children:(0,r.jsx)(v.Z,{className:"gap-2 p-8 h-[80vh] w-full mt-2",children:(0,r.jsx)(eT.Z,{children:(0,r.jsxs)(eM.Z,{children:[(0,r.jsx)(eD.Z,{children:(0,r.jsx)(eL.Z,{children:"Chat"})}),(0,r.jsx)(eR.Z,{children:(0,r.jsxs)(eF.Z,{children:[(0,r.jsxs)("div",{className:"sm:max-w-2xl",children:[(0,r.jsxs)(v.Z,{numItems:2,children:[(0,r.jsxs)(y.Z,{children:[(0,r.jsx)(S.Z,{children:"API Key Source"}),(0,r.jsx)(A.default,{disabled:n,defaultValue:"session",style:{width:"100%"},onChange:e=>d(e),options:[{value:"session",label:"Current UI Session"},{value:"custom",label:"Virtual Key"}]}),"custom"===o&&(0,r.jsx)(Z.Z,{className:"mt-2",placeholder:"Enter custom API key",type:"password",onValueChange:m,value:c})]}),(0,r.jsxs)(y.Z,{className:"mx-2",children:[(0,r.jsx)(S.Z,{children:"Select Model:"}),(0,r.jsx)(A.default,{placeholder:"Select a Model",onChange:e=>{console.log("selected ".concat(e)),f(e),N("custom"===e)},options:[...w,{value:"custom",label:"Enter custom model"}],style:{width:"350px"},showSearch:!0}),_&&(0,r.jsx)(Z.Z,{className:"mt-2",placeholder:"Enter custom model name",onValueChange:e=>{C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{f(e)},500)}})]})]}),(0,r.jsx)(b.Z,{onClick:()=>{p([]),P.ZP.success("Chat history cleared.")},className:"mt-4",children:"Clear Chat"})]}),(0,r.jsxs)(ew.Z,{className:"mt-5",style:{display:"block",maxHeight:"60vh",overflowY:"auto"},children:[(0,r.jsx)(eC.Z,{children:(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{})})}),(0,r.jsxs)(ek.Z,{children:[x.map((e,l)=>(0,r.jsx)(eA.Z,{children:(0,r.jsxs)(eS.Z,{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[(0,r.jsx)("strong",{children:e.role}),"assistant"===e.role&&e.model&&(0,r.jsx)("span",{style:{fontSize:"12px",color:"#666",backgroundColor:"#f5f5f5",padding:"2px 6px",borderRadius:"4px",fontWeight:"normal"},children:e.model})]}),(0,r.jsx)("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",maxWidth:"100%"},children:(0,r.jsx)(s0.U,{components:{code(e){let{node:l,inline:s,className:t,children:a,...i}=e,n=/language-(\w+)/.exec(t||"");return!s&&n?(0,r.jsx)(sD.Z,{style:s1.Z,language:n[1],PreTag:"div",...i,children:String(a).replace(/\n$/,"")}):(0,r.jsx)("code",{className:t,...i,children:a})}},children:e.content})})]})},l)),(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{children:(0,r.jsx)("div",{ref:I,style:{height:"1px"}})})})]})]}),(0,r.jsx)("div",{className:"mt-3",style:{position:"absolute",bottom:5,width:"95%"},children:(0,r.jsxs)("div",{className:"flex",style:{marginTop:"16px"},children:[(0,r.jsx)(Z.Z,{type:"text",value:u,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"===e.key&&O()},placeholder:"Type your message..."}),(0,r.jsx)(b.Z,{onClick:O,className:"ml-2",children:"Send"})]})})]})})]})})})})},s5=s(19226),s3=s(45937),s6=s(92403),s8=s(28595),s7=s(68208),s9=s(9775),te=s(41361),tl=s(37527),ts=s(12660),tt=s(88009),ta=s(48231),tr=s(41169),ti=s(44625),tn=s(57400),to=s(55322);let{Sider:td}=s5.default,tc=[{key:"1",page:"api-keys",label:"Virtual Keys",icon:(0,r.jsx)(s6.Z,{})},{key:"3",page:"llm-playground",label:"Test Key",icon:(0,r.jsx)(s8.Z,{}),roles:eu},{key:"2",page:"models",label:"Models",icon:(0,r.jsx)(s7.Z,{}),roles:ec},{key:"4",page:"usage",label:"Usage",icon:(0,r.jsx)(s9.Z,{})},{key:"6",page:"teams",label:"Teams",icon:(0,r.jsx)(te.Z,{})},{key:"17",page:"organizations",label:"Organizations",icon:(0,r.jsx)(tl.Z,{}),roles:ec},{key:"5",page:"users",label:"Internal Users",icon:(0,r.jsx)(h.Z,{}),roles:ec},{key:"14",page:"api_ref",label:"API Reference",icon:(0,r.jsx)(ts.Z,{})},{key:"16",page:"model-hub",label:"Model Hub",icon:(0,r.jsx)(tt.Z,{})},{key:"15",page:"logs",label:"Logs",icon:(0,r.jsx)(ta.Z,{})},{key:"experimental",page:"experimental",label:"Experimental",icon:(0,r.jsx)(tr.Z,{}),roles:ec,children:[{key:"9",page:"caching",label:"Caching",icon:(0,r.jsx)(ti.Z,{}),roles:ec},{key:"10",page:"budgets",label:"Budgets",icon:(0,r.jsx)(tl.Z,{}),roles:ec},{key:"11",page:"guardrails",label:"Guardrails",icon:(0,r.jsx)(tn.Z,{}),roles:ec}]},{key:"settings",page:"settings",label:"Settings",icon:(0,r.jsx)(to.Z,{}),roles:ec,children:[{key:"11",page:"general-settings",label:"Router Settings",icon:(0,r.jsx)(to.Z,{}),roles:ec},{key:"12",page:"pass-through-settings",label:"Pass-Through",icon:(0,r.jsx)(ts.Z,{}),roles:ec},{key:"8",page:"settings",label:"Logging & Alerts",icon:(0,r.jsx)(to.Z,{}),roles:ec},{key:"13",page:"admin-panel",label:"Admin Settings",icon:(0,r.jsx)(to.Z,{}),roles:ec}]}];var tm=e=>{let{setPage:l,userRole:s,defaultSelectedKey:t}=e,a=(e=>{let l=tc.find(l=>l.page===e);if(l)return l.key;for(let l of tc)if(l.children){let s=l.children.find(l=>l.page===e);if(s)return s.key}return"1"})(t),i=tc.filter(e=>!e.roles||e.roles.includes(s));return(0,r.jsx)(s5.default,{style:{minHeight:"100vh"},children:(0,r.jsx)(td,{theme:"light",width:220,children:(0,r.jsx)(s3.Z,{mode:"inline",selectedKeys:[a],style:{borderRight:0,backgroundColor:"transparent",fontSize:"14px"},items:i.map(e=>{var s;return{key:e.key,icon:e.icon,label:e.label,children:null===(s=e.children)||void 0===s?void 0:s.map(e=>({key:e.key,icon:e.icon,label:e.label,onClick:()=>{let s=new URLSearchParams(window.location.search);s.set("page",e.page),window.history.pushState(null,"","?".concat(s.toString())),l(e.page)}})),onClick:e.children?void 0:()=>{let s=new URLSearchParams(window.location.search);s.set("page",e.page),window.history.pushState(null,"","?".concat(s.toString())),l(e.page)}}})})})})},tu=s(96889);console.log=function(){};var th=e=>{let{userID:l,userRole:s,accessToken:t,userSpend:a,userMaxBudget:n,selectedTeam:o}=e;console.log("userSpend: ".concat(a));let[d,c]=(0,i.useState)(null!==a?a:0),[m,u]=(0,i.useState)(o?o.max_budget:null);(0,i.useEffect)(()=>{if(o){if("Default Team"===o.team_alias)u(n);else{let e=!1;if(o.team_memberships)for(let s of o.team_memberships)s.user_id===l&&"max_budget"in s.litellm_budget_table&&null!==s.litellm_budget_table.max_budget&&(u(s.litellm_budget_table.max_budget),e=!0);e||u(o.max_budget)}}},[o,n]);let[h,x]=(0,i.useState)([]);(0,i.useEffect)(()=>{let e=async()=>{if(!t||!l||!s)return};(async()=>{try{if(null===l||null===s)return;if(null!==t){let e=(await (0,g.So)(t,l,s)).data.map(e=>e.id);console.log("available_model_names:",e),x(e)}}catch(e){console.error("Error fetching user models:",e)}})(),e()},[s,t,l]),(0,i.useEffect)(()=>{null!==a&&c(a)},[a]);let p=[];o&&o.models&&(p=o.models),p&&p.includes("all-proxy-models")?(console.log("user models:",h),p=h):p&&p.includes("all-team-models")?p=o.models:p&&0===p.length&&(p=h);let j=void 0!==d?d.toFixed(4):null;return console.log("spend in view user spend: ".concat(d)),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("div",{className:"flex justify-between gap-x-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content",children:"Total Spend"}),(0,r.jsxs)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:["$",j]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content",children:"Max Budget"}),(0,r.jsx)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:null!==m?"$".concat(m," limit"):"No limit"})]})]})})},tx=s(14042);let tp=e=>{let{key:l,info:s}=e;return{token:l,...s}};var tg=e=>{let{topKeys:l,accessToken:s,userID:t,userRole:a,teams:n}=e,[o,d]=(0,i.useState)(!1),[c,m]=(0,i.useState)(null),[u,h]=(0,i.useState)(void 0),[x,p]=(0,i.useState)("table"),j=async e=>{if(s)try{let l=await (0,g.t0)(s,e.api_key),t=tp(l);h(t),m(e.key),d(!0)}catch(e){console.error("Error fetching key info:",e)}},f=()=>{d(!1),m(null),h(void 0)};return i.useEffect(()=>{let e=e=>{"Escape"===e.key&&o&&f()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[o]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-4 flex justify-end items-center",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>p("table"),className:"px-3 py-1 text-sm rounded-md ".concat("table"===x?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"Table View"}),(0,r.jsx)("button",{onClick:()=>p("chart"),className:"px-3 py-1 text-sm rounded-md ".concat("chart"===x?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"Chart View"})]})}),"chart"===x?(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(l_.Z,{className:"mt-4 h-40 cursor-pointer hover:opacity-90",data:l,index:"key_alias",categories:["spend"],colors:["cyan"],yAxisWidth:80,tickGap:5,layout:"vertical",showXAxis:!1,showLegend:!1,valueFormatter:e=>e?"$".concat(e.toFixed(2)):"No Key Alias",onValueChange:e=>j(e),showTooltip:!0,customTooltip:e=>{var l,s,t;let a=null===(s=e.payload)||void 0===s?void 0:null===(l=s[0])||void 0===l?void 0:l.payload;return(0,r.jsx)("div",{className:"p-3 bg-black/90 shadow-lg rounded-lg text-white",children:(0,r.jsxs)("div",{className:"space-y-1.5",children:[(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"text-gray-300",children:"Key: "}),(0,r.jsxs)("span",{className:"font-mono text-gray-100",children:[null==a?void 0:null===(t=a.key)||void 0===t?void 0:t.slice(0,10),"..."]})]}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"text-gray-300",children:"Spend: "}),(0,r.jsxs)("span",{className:"text-white font-medium",children:["$",null==a?void 0:a.spend.toFixed(2)]})]})]})})}})}):(0,r.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,r.jsx)(eE,{columns:[{header:"Key ID",accessorKey:"api_key",cell:e=>(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)(V.Z,{title:e.getValue(),children:(0,r.jsx)(b.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>j(e.row.original),children:e.getValue()?"".concat(e.getValue().slice(0,7),"..."):"-"})})})},{header:"Key Alias",accessorKey:"key_alias",cell:e=>e.getValue()||"-"},{header:"Spend (USD)",accessorKey:"spend",cell:e=>"$".concat(Number(e.getValue()).toFixed(2))}],data:l,renderSubComponent:()=>(0,r.jsx)(r.Fragment,{}),getRowCanExpand:()=>!1,isLoading:!1})}),o&&c&&u&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&f()},children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl relative w-11/12 max-w-6xl max-h-[90vh] overflow-y-auto min-h-[750px]",children:[(0,r.jsx)("button",{onClick:f,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsx)("div",{className:"p-6 h-full",children:(0,r.jsx)(eB,{keyId:c,onClose:f,keyData:u,accessToken:s,userID:t,userRole:a,teams:n})})]})})]})};console.log("process.env.NODE_ENV","production"),console.log=function(){};let tj=e=>null!==e&&("Admin"===e||"Admin Viewer"===e);var tf=e=>{let{accessToken:l,token:s,userRole:t,userID:a,keys:n,premiumUser:o}=e,d=new Date,[c,m]=(0,i.useState)([]),[u,h]=(0,i.useState)([]),[x,p]=(0,i.useState)([]),[j,f]=(0,i.useState)([]),[_,Z]=(0,i.useState)([]),[N,w]=(0,i.useState)([]),[k,I]=(0,i.useState)([]),[A,E]=(0,i.useState)([]),[P,O]=(0,i.useState)([]),[T,L]=(0,i.useState)([]),[M,D]=(0,i.useState)({}),[F,R]=(0,i.useState)([]),[U,z]=(0,i.useState)(""),[V,q]=(0,i.useState)(["all-tags"]),[K,B]=(0,i.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[H,J]=(0,i.useState)(null),[G,Y]=(0,i.useState)(0),$=new Date(d.getFullYear(),d.getMonth(),1),X=new Date(d.getFullYear(),d.getMonth()+1,0),Q=er($),ee=er(X);function el(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0,notation:"compact",compactDisplay:"short"}).format(e)}console.log("keys in usage",n),console.log("premium user in usage",o);let es=async()=>{if(l)try{let e=await (0,g.g)(l);return console.log("usage tab: proxy_settings",e),e}catch(e){console.error("Error fetching proxy settings:",e)}};(0,i.useEffect)(()=>{ea(K.from,K.to)},[K,V]);let et=async(e,s,t)=>{if(!e||!s||!l)return;s.setHours(23,59,59,999),e.setHours(0,0,0,0),console.log("uiSelectedKey",t);let a=await (0,g.b1)(l,t,e.toISOString(),s.toISOString());console.log("End user data updated successfully",a),f(a)},ea=async(e,s)=>{if(!e||!s||!l)return;let t=await es();null!=t&&t.DISABLE_EXPENSIVE_DB_QUERIES||(s.setHours(23,59,59,999),e.setHours(0,0,0,0),w((await (0,g.J$)(l,e.toISOString(),s.toISOString(),0===V.length?void 0:V)).spend_per_tag),console.log("Tag spend data updated successfully"))};function er(e){let l=e.getFullYear(),s=e.getMonth()+1,t=e.getDate();return"".concat(l,"-").concat(s<10?"0"+s:s,"-").concat(t<10?"0"+t:t)}console.log("Start date is ".concat(Q)),console.log("End date is ".concat(ee));let ei=async(e,l,s)=>{try{let s=await e();l(s)}catch(e){console.error(s,e)}},en=(e,l,s,t)=>{let a=[],r=new Date(l),i=e=>{if(e.includes("-"))return e;{let[l,s]=e.split(" ");return new Date(new Date().getFullYear(),new Date("".concat(l," 01 2024")).getMonth(),parseInt(s)).toISOString().split("T")[0]}},n=new Map(e.map(e=>{let l=i(e.date);return[l,{...e,date:l}]}));for(;r<=s;){let e=r.toISOString().split("T")[0];if(n.has(e))a.push(n.get(e));else{let l={date:e,api_requests:0,total_tokens:0};t.forEach(e=>{l[e]||(l[e]=0)}),a.push(l)}r.setDate(r.getDate()+1)}return a},eo=async()=>{if(l)try{let e=await (0,g.FC)(l),s=new Date,t=new Date(s.getFullYear(),s.getMonth(),1),a=new Date(s.getFullYear(),s.getMonth()+1,0),r=en(e,t,a,[]),i=Number(r.reduce((e,l)=>e+(l.spend||0),0).toFixed(2));Y(i),m(r)}catch(e){console.error("Error fetching overall spend:",e)}},ed=()=>ei(()=>l&&s?(0,g.OU)(l,s,Q,ee):Promise.reject("No access token or token"),L,"Error fetching provider spend"),ec=async()=>{l&&await ei(async()=>(await (0,g.tN)(l)).map(e=>({key:e.api_key.substring(0,10),api_key:e.api_key,key_alias:e.key_alias,spend:Number(e.total_spend.toFixed(2))})),h,"Error fetching top keys")},em=async()=>{l&&await ei(async()=>(await (0,g.Au)(l)).map(e=>({key:e.model,spend:Number(e.total_spend.toFixed(2))})),p,"Error fetching top models")},eu=async()=>{l&&await ei(async()=>{let e=await (0,g.mR)(l),s=new Date,t=new Date(s.getFullYear(),s.getMonth(),1),a=new Date(s.getFullYear(),s.getMonth()+1,0);return Z(en(e.daily_spend,t,a,e.teams)),E(e.teams),e.total_spend_per_team.map(e=>({name:e.team_id||"",value:Number(e.total_spend||0).toFixed(2)}))},O,"Error fetching team spend")},eh=()=>{l&&ei(async()=>(await (0,g.X)(l)).tag_names,I,"Error fetching tag names")},ex=()=>{l&&ei(()=>{var e,s;return(0,g.J$)(l,null===(e=K.from)||void 0===e?void 0:e.toISOString(),null===(s=K.to)||void 0===s?void 0:s.toISOString(),void 0)},e=>w(e.spend_per_tag),"Error fetching top tags")},ep=()=>{l&&ei(()=>(0,g.b1)(l,null,void 0,void 0),f,"Error fetching top end users")},eg=async()=>{if(l)try{let e=await (0,g.wd)(l,Q,ee),s=new Date,t=new Date(s.getFullYear(),s.getMonth(),1),a=new Date(s.getFullYear(),s.getMonth()+1,0),r=en(e.daily_data||[],t,a,["api_requests","total_tokens"]);D({...e,daily_data:r})}catch(e){console.error("Error fetching global activity:",e)}},ej=async()=>{if(l)try{let e=await (0,g.xA)(l,Q,ee),s=new Date,t=new Date(s.getFullYear(),s.getMonth(),1),a=new Date(s.getFullYear(),s.getMonth()+1,0),r=e.map(e=>({...e,daily_data:en(e.daily_data||[],t,a,["api_requests","total_tokens"])}));R(r)}catch(e){console.error("Error fetching global activity per model:",e)}};return((0,i.useEffect)(()=>{(async()=>{if(l&&s&&t&&a){let e=await es();e&&(J(e),null!=e&&e.DISABLE_EXPENSIVE_DB_QUERIES)||(console.log("fetching data - valiue of proxySettings",H),eo(),ed(),ec(),em(),eg(),ej(),tj(t)&&(eu(),eh(),ex(),ep()))}})()},[l,s,t,a,Q,ee]),null==H?void 0:H.DISABLE_EXPENSIVE_DB_QUERIES)?(0,r.jsx)("div",{style:{width:"100%"},className:"p-8",children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(C.Z,{children:"Database Query Limit Reached"}),(0,r.jsxs)(S.Z,{className:"mt-4",children:["SpendLogs in DB has ",H.NUM_SPEND_LOGS_ROWS," rows.",(0,r.jsx)("br",{}),"Please follow our guide to view usage when SpendLogs has more than 1M rows."]}),(0,r.jsx)(b.Z,{className:"mt-4",children:(0,r.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/spending_monitoring",target:"_blank",children:"View Usage Guide"})})]})}):(0,r.jsx)("div",{style:{width:"100%"},className:"p-8",children:(0,r.jsxs)(eM.Z,{children:[(0,r.jsxs)(eD.Z,{className:"mt-2",children:[(0,r.jsx)(eL.Z,{children:"All Up"}),tj(t)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eL.Z,{children:"Team Based Usage"}),(0,r.jsx)(eL.Z,{children:"Customer Usage"}),(0,r.jsx)(eL.Z,{children:"Tag Based Usage"})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{})})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(eM.Z,{children:[(0,r.jsxs)(eD.Z,{variant:"solid",className:"mt-1",children:[(0,r.jsx)(eL.Z,{children:"Cost"}),(0,r.jsx)(eL.Z,{children:"Activity"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(v.Z,{numItems:2,className:"gap-2 h-[100vh] w-full",children:[(0,r.jsxs)(y.Z,{numColSpan:2,children:[(0,r.jsxs)(S.Z,{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content mb-2 mt-2 text-lg",children:["Project Spend ",new Date().toLocaleString("default",{month:"long"})," 1 - ",new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate()]}),(0,r.jsx)(th,{userID:a,userRole:t,accessToken:l,userSpend:G,selectedTeam:null,userMaxBudget:null})]}),(0,r.jsx)(y.Z,{numColSpan:2,children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(C.Z,{children:"Monthly Spend"}),(0,r.jsx)(l_.Z,{data:c,index:"date",categories:["spend"],colors:["cyan"],valueFormatter:e=>"$ ".concat(e.toFixed(2)),yAxisWidth:100,tickGap:5})]})}),(0,r.jsx)(y.Z,{numColSpan:1,children:(0,r.jsxs)(eT.Z,{className:"h-full",children:[(0,r.jsx)(C.Z,{children:"Top API Keys"}),(0,r.jsx)(tg,{topKeys:u,accessToken:l,userID:a,userRole:t,teams:null})]})}),(0,r.jsx)(y.Z,{numColSpan:1,children:(0,r.jsxs)(eT.Z,{className:"h-full",children:[(0,r.jsx)(C.Z,{children:"Top Models"}),(0,r.jsx)(l_.Z,{className:"mt-4 h-40",data:x,index:"key",categories:["spend"],colors:["cyan"],yAxisWidth:200,layout:"vertical",showXAxis:!1,showLegend:!1,valueFormatter:e=>"$".concat(e.toFixed(2))})]})}),(0,r.jsx)(y.Z,{numColSpan:1}),(0,r.jsx)(y.Z,{numColSpan:2,children:(0,r.jsxs)(eT.Z,{className:"mb-2",children:[(0,r.jsx)(C.Z,{children:"Spend by Provider"}),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(v.Z,{numItems:2,children:[(0,r.jsx)(y.Z,{numColSpan:1,children:(0,r.jsx)(tx.Z,{className:"mt-4 h-40",variant:"pie",data:T,index:"provider",category:"spend",colors:["cyan"],valueFormatter:e=>"$".concat(e.toFixed(2))})}),(0,r.jsx)(y.Z,{numColSpan:1,children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Provider"}),(0,r.jsx)(eI.Z,{children:"Spend"})]})}),(0,r.jsx)(ek.Z,{children:T.map(e=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:e.provider}),(0,r.jsx)(eS.Z,{children:1e-5>parseFloat(e.spend.toFixed(2))?"less than 0.00":e.spend.toFixed(2)})]},e.provider))})]})})]})})]})})]})}),(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(v.Z,{numItems:1,className:"gap-2 h-[75vh] w-full",children:[(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(C.Z,{children:"All Up"}),(0,r.jsxs)(v.Z,{numItems:2,children:[(0,r.jsxs)(y.Z,{children:[(0,r.jsxs)(e3.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["API Requests ",el(M.sum_api_requests)]}),(0,r.jsx)(lf.Z,{className:"h-40",data:M.daily_data,valueFormatter:el,index:"date",colors:["cyan"],categories:["api_requests"],onValueChange:e=>console.log(e)})]}),(0,r.jsxs)(y.Z,{children:[(0,r.jsxs)(e3.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Tokens ",el(M.sum_total_tokens)]}),(0,r.jsx)(l_.Z,{className:"h-40",data:M.daily_data,valueFormatter:el,index:"date",colors:["cyan"],categories:["total_tokens"],onValueChange:e=>console.log(e)})]})]})]}),(0,r.jsx)(r.Fragment,{children:F.map((e,l)=>(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(C.Z,{children:e.model}),(0,r.jsxs)(v.Z,{numItems:2,children:[(0,r.jsxs)(y.Z,{children:[(0,r.jsxs)(e3.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["API Requests ",el(e.sum_api_requests)]}),(0,r.jsx)(lf.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["cyan"],categories:["api_requests"],valueFormatter:el,onValueChange:e=>console.log(e)})]}),(0,r.jsxs)(y.Z,{children:[(0,r.jsxs)(e3.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Tokens ",el(e.sum_total_tokens)]}),(0,r.jsx)(l_.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["cyan"],categories:["total_tokens"],valueFormatter:el,onValueChange:e=>console.log(e)})]})]})]},l))})]})})]})]})}),(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(v.Z,{numItems:2,className:"gap-2 h-[75vh] w-full",children:[(0,r.jsxs)(y.Z,{numColSpan:2,children:[(0,r.jsxs)(eT.Z,{className:"mb-2",children:[(0,r.jsx)(C.Z,{children:"Total Spend Per Team"}),(0,r.jsx)(tu.Z,{data:P})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(C.Z,{children:"Daily Spend Per Team"}),(0,r.jsx)(l_.Z,{className:"h-72",data:_,showLegend:!0,index:"date",categories:A,yAxisWidth:80,stack:!0})]})]}),(0,r.jsx)(y.Z,{numColSpan:2})]})}),(0,r.jsxs)(eF.Z,{children:[(0,r.jsxs)("p",{className:"mb-2 text-gray-500 italic text-[12px]",children:["Customers of your LLM API calls. Tracked when a `user` param is passed in your LLM calls ",(0,r.jsx)("a",{className:"text-blue-500",href:"https://docs.litellm.ai/docs/proxy/users",target:"_blank",children:"docs here"})]}),(0,r.jsxs)(v.Z,{numItems:2,children:[(0,r.jsxs)(y.Z,{children:[(0,r.jsx)(S.Z,{children:"Select Time Range"}),(0,r.jsx)(lg.Z,{enableSelect:!0,value:K,onValueChange:e=>{B(e),et(e.from,e.to,null)}})]}),(0,r.jsxs)(y.Z,{children:[(0,r.jsx)(S.Z,{children:"Select Key"}),(0,r.jsxs)(eP.Z,{defaultValue:"all-keys",children:[(0,r.jsx)(W.Z,{value:"all-keys",onClick:()=>{et(K.from,K.to,null)},children:"All Keys"},"all-keys"),null==n?void 0:n.map((e,l)=>e&&null!==e.key_alias&&e.key_alias.length>0?(0,r.jsx)(W.Z,{value:String(l),onClick:()=>{et(K.from,K.to,e.token)},children:e.key_alias},l):null)]})]})]}),(0,r.jsx)(eT.Z,{className:"mt-4",children:(0,r.jsxs)(ew.Z,{className:"max-h-[70vh] min-h-[500px]",children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Customer"}),(0,r.jsx)(eI.Z,{children:"Spend"}),(0,r.jsx)(eI.Z,{children:"Total Events"})]})}),(0,r.jsx)(ek.Z,{children:null==j?void 0:j.map((e,l)=>{var s;return(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:e.end_user}),(0,r.jsx)(eS.Z,{children:null===(s=e.total_spend)||void 0===s?void 0:s.toFixed(4)}),(0,r.jsx)(eS.Z,{children:e.total_count})]},l)})})]})})]}),(0,r.jsxs)(eF.Z,{children:[(0,r.jsxs)(v.Z,{numItems:2,children:[(0,r.jsx)(y.Z,{numColSpan:1,children:(0,r.jsx)(lg.Z,{className:"mb-4",enableSelect:!0,value:K,onValueChange:e=>{B(e),ea(e.from,e.to)}})}),(0,r.jsx)(y.Z,{children:o?(0,r.jsx)("div",{children:(0,r.jsxs)(s_.Z,{value:V,onValueChange:e=>q(e),children:[(0,r.jsx)(sy.Z,{value:"all-tags",onClick:()=>q(["all-tags"]),children:"All Tags"},"all-tags"),k&&k.filter(e=>"all-tags"!==e).map((e,l)=>(0,r.jsx)(sy.Z,{value:String(e),children:e},e))]})}):(0,r.jsx)("div",{children:(0,r.jsxs)(s_.Z,{value:V,onValueChange:e=>q(e),children:[(0,r.jsx)(sy.Z,{value:"all-tags",onClick:()=>q(["all-tags"]),children:"All Tags"},"all-tags"),k&&k.filter(e=>"all-tags"!==e).map((e,l)=>(0,r.jsxs)(W.Z,{value:String(e),disabled:!0,children:["✨ ",e," (Enterprise only Feature)"]},e))]})})})]}),(0,r.jsxs)(v.Z,{numItems:2,className:"gap-2 h-[75vh] w-full mb-4",children:[(0,r.jsx)(y.Z,{numColSpan:2,children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)(C.Z,{children:"Spend Per Tag"}),(0,r.jsxs)(S.Z,{children:["Get Started Tracking cost per tag ",(0,r.jsx)("a",{className:"text-blue-500",href:"https://docs.litellm.ai/docs/proxy/cost_tracking",target:"_blank",children:"here"})]}),(0,r.jsx)(l_.Z,{className:"h-72",data:N,index:"name",categories:["spend"],colors:["cyan"]})]})}),(0,r.jsx)(y.Z,{numColSpan:2})]})]})]})]})})},t_=s(51853);let ty=e=>{let{responseTimeMs:l}=e;return null==l?null:(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-500 font-mono",children:[(0,r.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M12 6V12L16 14M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,r.jsxs)("span",{children:[l.toFixed(0),"ms"]})]})},tv=e=>{let l=e;if("string"==typeof l)try{l=JSON.parse(l)}catch(e){}return l},tb=e=>{let{label:l,value:s}=e,[t,a]=i.useState(!1),[n,o]=i.useState(!1),d=(null==s?void 0:s.toString())||"N/A",c=d.length>50?d.substring(0,50)+"...":d;return(0,r.jsx)("tr",{className:"hover:bg-gray-50",children:(0,r.jsx)("td",{className:"px-4 py-2 align-top",colSpan:2,children:(0,r.jsxs)("div",{className:"flex items-center justify-between group",children:[(0,r.jsxs)("div",{className:"flex items-center flex-1",children:[(0,r.jsx)("button",{onClick:()=>a(!t),className:"text-gray-400 hover:text-gray-600 mr-2",children:t?"▼":"▶"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-gray-600",children:l}),(0,r.jsx)("pre",{className:"mt-1 text-sm font-mono text-gray-800 whitespace-pre-wrap",children:t?d:c})]})]}),(0,r.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(d),o(!0),setTimeout(()=>o(!1),2e3)},className:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600",children:(0,r.jsx)(t_.Z,{className:"h-4 w-4"})})]})})})},tZ=e=>{var l,s,t,a,i,n,o,d,c,m,u,h,x,p;let{response:g}=e,j=null,f={},_={};try{if(null==g?void 0:g.error)try{let e="string"==typeof g.error.message?JSON.parse(g.error.message):g.error.message;j={message:(null==e?void 0:e.message)||"Unknown error",traceback:(null==e?void 0:e.traceback)||"No traceback available",litellm_params:(null==e?void 0:e.litellm_cache_params)||{},health_check_cache_params:(null==e?void 0:e.health_check_cache_params)||{}},f=tv(j.litellm_params)||{},_=tv(j.health_check_cache_params)||{}}catch(e){console.warn("Error parsing error details:",e),j={message:String(g.error.message||"Unknown error"),traceback:"Error parsing details",litellm_params:{},health_check_cache_params:{}}}else f=tv(null==g?void 0:g.litellm_cache_params)||{},_=tv(null==g?void 0:g.health_check_cache_params)||{}}catch(e){console.warn("Error in response parsing:",e),f={},_={}}let y={redis_host:(null==_?void 0:null===(t=_.redis_client)||void 0===t?void 0:null===(s=t.connection_pool)||void 0===s?void 0:null===(l=s.connection_kwargs)||void 0===l?void 0:l.host)||(null==_?void 0:null===(n=_.redis_async_client)||void 0===n?void 0:null===(i=n.connection_pool)||void 0===i?void 0:null===(a=i.connection_kwargs)||void 0===a?void 0:a.host)||(null==_?void 0:null===(o=_.connection_kwargs)||void 0===o?void 0:o.host)||(null==_?void 0:_.host)||"N/A",redis_port:(null==_?void 0:null===(m=_.redis_client)||void 0===m?void 0:null===(c=m.connection_pool)||void 0===c?void 0:null===(d=c.connection_kwargs)||void 0===d?void 0:d.port)||(null==_?void 0:null===(x=_.redis_async_client)||void 0===x?void 0:null===(h=x.connection_pool)||void 0===h?void 0:null===(u=h.connection_kwargs)||void 0===u?void 0:u.port)||(null==_?void 0:null===(p=_.connection_kwargs)||void 0===p?void 0:p.port)||(null==_?void 0:_.port)||"N/A",redis_version:(null==_?void 0:_.redis_version)||"N/A",startup_nodes:(()=>{try{var e,l,s,t,a,r,i,n,o,d,c,m,u;if(null==_?void 0:null===(e=_.redis_kwargs)||void 0===e?void 0:e.startup_nodes)return JSON.stringify(_.redis_kwargs.startup_nodes);let h=(null==_?void 0:null===(t=_.redis_client)||void 0===t?void 0:null===(s=t.connection_pool)||void 0===s?void 0:null===(l=s.connection_kwargs)||void 0===l?void 0:l.host)||(null==_?void 0:null===(i=_.redis_async_client)||void 0===i?void 0:null===(r=i.connection_pool)||void 0===r?void 0:null===(a=r.connection_kwargs)||void 0===a?void 0:a.host),x=(null==_?void 0:null===(d=_.redis_client)||void 0===d?void 0:null===(o=d.connection_pool)||void 0===o?void 0:null===(n=o.connection_kwargs)||void 0===n?void 0:n.port)||(null==_?void 0:null===(u=_.redis_async_client)||void 0===u?void 0:null===(m=u.connection_pool)||void 0===m?void 0:null===(c=m.connection_kwargs)||void 0===c?void 0:c.port);return h&&x?JSON.stringify([{host:h,port:x}]):"N/A"}catch(e){return"N/A"}})(),namespace:(null==_?void 0:_.namespace)||"N/A"};return(0,r.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,r.jsxs)(eM.Z,{children:[(0,r.jsxs)(eD.Z,{className:"border-b border-gray-200 px-4",children:[(0,r.jsx)(eL.Z,{className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800",children:"Summary"}),(0,r.jsx)(eL.Z,{className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800",children:"Raw Response"})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{className:"p-4",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(null==g?void 0:g.status)==="healthy"?(0,r.jsx)(ea.Z,{className:"h-5 w-5 text-green-500 mr-2"}):(0,r.jsx)(et.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,r.jsxs)(S.Z,{className:"text-sm font-medium ".concat((null==g?void 0:g.status)==="healthy"?"text-green-500":"text-red-500"),children:["Cache Status: ",(null==g?void 0:g.status)||"unhealthy"]})]}),(0,r.jsx)("table",{className:"w-full border-collapse",children:(0,r.jsxs)("tbody",{children:[j&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold text-red-600",children:"Error Details"})}),(0,r.jsx)(tb,{label:"Error Message",value:j.message}),(0,r.jsx)(tb,{label:"Traceback",value:j.traceback})]}),(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold",children:"Cache Details"})}),(0,r.jsx)(tb,{label:"Cache Configuration",value:String(null==f?void 0:f.type)}),(0,r.jsx)(tb,{label:"Ping Response",value:String(g.ping_response)}),(0,r.jsx)(tb,{label:"Set Cache Response",value:g.set_cache_response||"N/A"}),(0,r.jsx)(tb,{label:"litellm_settings.cache_params",value:JSON.stringify(f,null,2)}),(null==f?void 0:f.type)==="redis"&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold",children:"Redis Details"})}),(0,r.jsx)(tb,{label:"Redis Host",value:y.redis_host||"N/A"}),(0,r.jsx)(tb,{label:"Redis Port",value:y.redis_port||"N/A"}),(0,r.jsx)(tb,{label:"Redis Version",value:y.redis_version||"N/A"}),(0,r.jsx)(tb,{label:"Startup Nodes",value:y.startup_nodes||"N/A"}),(0,r.jsx)(tb,{label:"Namespace",value:y.namespace||"N/A"})]})]})})]})}),(0,r.jsx)(eF.Z,{className:"p-4",children:(0,r.jsx)("div",{className:"bg-gray-50 rounded-md p-4 font-mono text-sm",children:(0,r.jsx)("pre",{className:"whitespace-pre-wrap break-words overflow-auto max-h-[500px]",children:(()=>{try{let e={...g,litellm_cache_params:f,health_check_cache_params:_},l=JSON.parse(JSON.stringify(e,(e,l)=>{if("string"==typeof l)try{return JSON.parse(l)}catch(e){}return l}));return JSON.stringify(l,null,2)}catch(e){return"Error formatting JSON: "+e.message}})()})})})]})]})})},tN=e=>{let{accessToken:l,healthCheckResponse:s,runCachingHealthCheck:t,responseTimeMs:a}=e,[n,o]=i.useState(null),[d,c]=i.useState(!1),m=async()=>{c(!0);let e=performance.now();await t(),o(performance.now()-e),c(!1)};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(b.Z,{onClick:m,disabled:d,className:"bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white text-sm px-4 py-2 rounded-md",children:d?"Running Health Check...":"Run Health Check"}),(0,r.jsx)(ty,{responseTimeMs:n})]}),s&&(0,r.jsx)(tZ,{response:s})]})},tw=e=>{if(e)return e.toISOString().split("T")[0]};function tk(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0,notation:"compact",compactDisplay:"short"}).format(e)}var tS=e=>{let{accessToken:l,token:s,userRole:t,userID:a,premiumUser:n}=e,[o,d]=(0,i.useState)([]),[c,m]=(0,i.useState)([]),[u,h]=(0,i.useState)([]),[x,p]=(0,i.useState)([]),[j,f]=(0,i.useState)("0"),[_,b]=(0,i.useState)("0"),[Z,N]=(0,i.useState)("0"),[w,k]=(0,i.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[C,I]=(0,i.useState)(""),[A,E]=(0,i.useState)("");(0,i.useEffect)(()=>{l&&w&&((async()=>{p(await (0,g.zg)(l,tw(w.from),tw(w.to)))})(),I(new Date().toLocaleString()))},[l]);let O=Array.from(new Set(x.map(e=>{var l;return null!==(l=null==e?void 0:e.api_key)&&void 0!==l?l:""}))),T=Array.from(new Set(x.map(e=>{var l;return null!==(l=null==e?void 0:e.model)&&void 0!==l?l:""})));Array.from(new Set(x.map(e=>{var l;return null!==(l=null==e?void 0:e.call_type)&&void 0!==l?l:""})));let L=async(e,s)=>{e&&s&&l&&(s.setHours(23,59,59,999),e.setHours(0,0,0,0),p(await (0,g.zg)(l,tw(e),tw(s))))};(0,i.useEffect)(()=>{console.log("DATA IN CACHE DASHBOARD",x);let e=x;c.length>0&&(e=e.filter(e=>c.includes(e.api_key))),u.length>0&&(e=e.filter(e=>u.includes(e.model))),console.log("before processed data in cache dashboard",e);let l=0,s=0,t=0,a=e.reduce((e,a)=>{console.log("Processing item:",a),a.call_type||(console.log("Item has no call_type:",a),a.call_type="Unknown"),l+=(a.total_rows||0)-(a.cache_hit_true_rows||0),s+=a.cache_hit_true_rows||0,t+=a.cached_completion_tokens||0;let r=e.find(e=>e.name===a.call_type);return r?(r["LLM API requests"]+=(a.total_rows||0)-(a.cache_hit_true_rows||0),r["Cache hit"]+=a.cache_hit_true_rows||0,r["Cached Completion Tokens"]+=a.cached_completion_tokens||0,r["Generated Completion Tokens"]+=a.generated_completion_tokens||0):e.push({name:a.call_type,"LLM API requests":(a.total_rows||0)-(a.cache_hit_true_rows||0),"Cache hit":a.cache_hit_true_rows||0,"Cached Completion Tokens":a.cached_completion_tokens||0,"Generated Completion Tokens":a.generated_completion_tokens||0}),e},[]);f(tk(s)),b(tk(t));let r=s+l;r>0?N((s/r*100).toFixed(2)):N("0"),d(a),console.log("PROCESSED DATA IN CACHE DASHBOARD",a)},[c,u,w,x]);let M=async()=>{try{P.ZP.info("Running cache health check..."),E("");let e=await (0,g.Tj)(null!==l?l:"");console.log("CACHING HEALTH CHECK RESPONSE",e),E(e)}catch(l){let e;if(console.error("Error running health check:",l),l&&l.message)try{let s=JSON.parse(l.message);s.error&&(s=s.error),e=s}catch(s){e={message:l.message}}else e={message:"Unknown error occurred"};E({error:e})}};return(0,r.jsxs)(eM.Z,{className:"gap-2 p-8 h-full w-full mt-2 mb-8",children:[(0,r.jsxs)(eD.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(eL.Z,{children:"Cache Analytics"}),(0,r.jsx)(eL.Z,{children:(0,r.jsx)("pre",{children:"Cache Health"})})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[C&&(0,r.jsxs)(S.Z,{children:["Last Refreshed: ",C]}),(0,r.jsx)(lj.Z,{icon:ez.Z,variant:"shadow",size:"xs",className:"self-center",onClick:()=>{I(new Date().toLocaleString())}})]})]}),(0,r.jsxs)(eR.Z,{children:[(0,r.jsx)(eF.Z,{children:(0,r.jsxs)(eT.Z,{children:[(0,r.jsxs)(v.Z,{numItems:3,className:"gap-4 mt-4",children:[(0,r.jsx)(y.Z,{children:(0,r.jsx)(s_.Z,{placeholder:"Select API Keys",value:c,onValueChange:m,children:O.map(e=>(0,r.jsx)(sy.Z,{value:e,children:e},e))})}),(0,r.jsx)(y.Z,{children:(0,r.jsx)(s_.Z,{placeholder:"Select Models",value:u,onValueChange:h,children:T.map(e=>(0,r.jsx)(sy.Z,{value:e,children:e},e))})}),(0,r.jsx)(y.Z,{children:(0,r.jsx)(lg.Z,{enableSelect:!0,value:w,onValueChange:e=>{k(e),L(e.from,e.to)},selectPlaceholder:"Select date range"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 mt-4",children:[(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cache Hit Ratio"}),(0,r.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,r.jsxs)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:[Z,"%"]})})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cache Hits"}),(0,r.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,r.jsx)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:j})})]}),(0,r.jsxs)(eT.Z,{children:[(0,r.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cached Tokens"}),(0,r.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,r.jsx)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:_})})]})]}),(0,r.jsx)(e3.Z,{className:"mt-4",children:"Cache Hits vs API Requests"}),(0,r.jsx)(l_.Z,{title:"Cache Hits vs API Requests",data:o,stack:!0,index:"name",valueFormatter:tk,categories:["LLM API requests","Cache hit"],colors:["sky","teal"],yAxisWidth:48}),(0,r.jsx)(e3.Z,{className:"mt-4",children:"Cached Completion Tokens vs Generated Completion Tokens"}),(0,r.jsx)(l_.Z,{className:"mt-6",data:o,stack:!0,index:"name",valueFormatter:tk,categories:["Generated Completion Tokens","Cached Completion Tokens"],colors:["sky","teal"],yAxisWidth:48})]})}),(0,r.jsx)(eF.Z,{children:(0,r.jsx)(tN,{accessToken:l,healthCheckResponse:A,runCachingHealthCheck:M})})]})]})},tC=e=>{let{accessToken:l}=e,[s,t]=(0,i.useState)([]);return(0,i.useEffect)(()=>{l&&(async()=>{try{let e=await (0,g.t3)(l);console.log("guardrails: ".concat(JSON.stringify(e))),t(e.guardrails)}catch(e){console.error("Error fetching guardrails:",e)}})()},[l]),(0,r.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[(0,r.jsxs)(S.Z,{className:"mb-4",children:["Configured guardrails and their current status. Setup guardrails in config.yaml."," ",(0,r.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700 underline",children:"Docs"})]}),(0,r.jsx)(eT.Z,{children:(0,r.jsxs)(ew.Z,{children:[(0,r.jsx)(eC.Z,{children:(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eI.Z,{children:"Guardrail Name"}),(0,r.jsx)(eI.Z,{children:"Mode"}),(0,r.jsx)(eI.Z,{children:"Status"})]})}),(0,r.jsx)(ek.Z,{children:s&&0!==s.length?null==s?void 0:s.map((e,l)=>(0,r.jsxs)(eA.Z,{children:[(0,r.jsx)(eS.Z,{children:e.guardrail_name}),(0,r.jsx)(eS.Z,{children:e.litellm_params.mode}),(0,r.jsx)(eS.Z,{children:(0,r.jsx)("div",{className:"inline-flex rounded-full px-2 py-1 text-xs font-medium\n                    ".concat(e.litellm_params.default_on?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.litellm_params.default_on?"Always On":"Per Request"})})]},l)):(0,r.jsx)(eA.Z,{children:(0,r.jsx)(eS.Z,{colSpan:3,className:"mt-4 text-gray-500 text-center py-4",children:"No guardrails configured"})})})]})})]})};let tI=new d.S;function tA(){let[e,l]=(0,i.useState)(""),[s,t]=(0,i.useState)(!1),[a,d]=(0,i.useState)(!1),[m,u]=(0,i.useState)(null),[h,x]=(0,i.useState)(null),[p,j]=(0,i.useState)(null),[y,v]=(0,i.useState)([]),[b,Z]=(0,i.useState)([]),[N,w]=(0,i.useState)({PROXY_BASE_URL:"",PROXY_LOGOUT_URL:""}),[k,S]=(0,i.useState)(!0),C=(0,n.useSearchParams)(),[I,A]=(0,i.useState)({data:[]}),[E,P]=(0,i.useState)(null),O=C.get("userID"),T=C.get("invitation_id"),[L,M]=(0,i.useState)(()=>C.get("page")||"api-keys"),[D,F]=(0,i.useState)(null);return(0,i.useEffect)(()=>{P(function(e){let l=document.cookie.split("; ").find(l=>l.startsWith(e+"="));return l?l.split("=")[1]:null}("token"))},[]),(0,i.useEffect)(()=>{if(!E)return;let e=(0,o.o)(E);if(e){if(console.log("Decoded token:",e),console.log("Decoded key:",e.key),F(e.key),d(e.disabled_non_admin_personal_key_creation),e.user_role){let s=function(e){if(!e)return"Undefined Role";switch(console.log("Received user role: ".concat(e.toLowerCase())),console.log("Received user role length: ".concat(e.toLowerCase().length)),e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"org_admin":return"Org Admin";case"internal_user":return"Internal User";case"internal_viewer":return"Internal Viewer";case"app_user":return"App User";default:return"Unknown Role"}}(e.user_role);console.log("Decoded user_role:",s),l(s),"Admin Viewer"==s&&M("usage")}else console.log("User role not defined");e.user_email?u(e.user_email):console.log("User Email is not set ".concat(e)),e.login_method?S("username_password"==e.login_method):console.log("User Email is not set ".concat(e)),e.premium_user&&t(e.premium_user),e.auth_header_name&&(0,g.K8)(e.auth_header_name)}},[E]),(0,i.useEffect)(()=>{D&&O&&e&&e_(O,e,D,Z),D&&O&&e&&_(D,O,e,null,x),D&&sa(D,v)},[D,O,e]),(0,r.jsx)(i.Suspense,{fallback:(0,r.jsx)("div",{children:"Loading..."}),children:(0,r.jsx)(c.aH,{client:tI,children:T?(0,r.jsx)(e5,{userID:O,userRole:e,premiumUser:s,teams:h,keys:p,setUserRole:l,userEmail:m,setUserEmail:u,setTeams:x,setKeys:j,organizations:y}):(0,r.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,r.jsx)(f,{userID:O,userRole:e,premiumUser:s,userEmail:m,setProxySettings:w,proxySettings:N,accessToken:D}),(0,r.jsxs)("div",{className:"flex flex-1 overflow-auto",children:[(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)(tm,{setPage:e=>{let l=new URLSearchParams(C);l.set("page",e),window.history.pushState(null,"","?".concat(l.toString())),M(e)},userRole:e,defaultSelectedKey:L})}),"api-keys"==L?(0,r.jsx)(e5,{userID:O,userRole:e,premiumUser:s,teams:h,keys:p,setUserRole:l,userEmail:m,setUserEmail:u,setTeams:x,setKeys:j,organizations:y}):"models"==L?(0,r.jsx)(l2,{userID:O,userRole:e,token:E,keys:p,accessToken:D,modelData:I,setModelData:A,premiumUser:s,teams:h}):"llm-playground"==L?(0,r.jsx)(s4,{userID:O,userRole:e,token:E,accessToken:D,disabledPersonalKeyCreation:a}):"users"==L?(0,r.jsx)(l9,{userID:O,userRole:e,token:E,keys:p,teams:h,accessToken:D,setKeys:j}):"teams"==L?(0,r.jsx)(ss,{teams:h,setTeams:x,searchParams:C,accessToken:D,userID:O,userRole:e,organizations:y}):"organizations"==L?(0,r.jsx)(sr,{organizations:y,setOrganizations:v,userModels:b,accessToken:D,userRole:e,premiumUser:s}):"admin-panel"==L?(0,r.jsx)(sm,{setTeams:x,searchParams:C,accessToken:D,showSSOBanner:k,premiumUser:s}):"api_ref"==L?(0,r.jsx)(sQ,{proxySettings:N}):"settings"==L?(0,r.jsx)(sf,{userID:O,userRole:e,accessToken:D,premiumUser:s}):"budgets"==L?(0,r.jsx)(sF,{accessToken:D}):"guardrails"==L?(0,r.jsx)(tC,{accessToken:D}):"general-settings"==L?(0,r.jsx)(sS,{userID:O,userRole:e,accessToken:D,modelData:I}):"model-hub"==L?(0,r.jsx)(sX.Z,{accessToken:D,publicPage:!1,premiumUser:s}):"caching"==L?(0,r.jsx)(tS,{userID:O,userRole:e,token:E,accessToken:D,premiumUser:s}):"pass-through-settings"==L?(0,r.jsx)(sT,{userID:O,userRole:e,accessToken:D,modelData:I}):"logs"==L?(0,r.jsx)(sY,{userID:O,userRole:e,token:E,accessToken:D}):(0,r.jsx)(tf,{userID:O,userRole:e,token:E,accessToken:D,keys:p,premiumUser:s})]})]})})})}},3914:function(e,l,s){"use strict";function t(){let e=window.location.hostname,l=["Lax","Strict","None"];["/","/ui"].forEach(s=>{document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=".concat(s,";"),document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=".concat(s,"; domain=").concat(e,";"),l.forEach(l=>{let t="None"===l?" Secure;":"";document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=".concat(s,"; SameSite=").concat(l,";").concat(t),document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=".concat(s,"; domain=").concat(e,"; SameSite=").concat(l,";").concat(t)})}),console.log("After clearing cookies:",document.cookie)}function a(e){let l=document.cookie.split("; ").find(l=>l.startsWith(e+"="));return l?l.split("=")[1]:null}s.d(l,{b:function(){return t},e:function(){return a}})}},function(e){e.O(0,[665,990,42,261,899,394,250,699,971,117,744],function(){return e(e.s=1900)}),_N_E=e.O()}]);