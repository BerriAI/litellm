(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{79615:function(e,s,t){Promise.resolve().then(t.bind(t,74961))},74961:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return eE}});var l=t(3827),n=t(64090),r=t(47907),a=t(8792),o=t(2179),i=e=>{let{userID:s,userRole:t,userEmail:n,showSSOBanner:r}=e;return console.log("User ID:",s),console.log("userEmail:",n),(0,l.jsxs)("nav",{className:"left-0 right-0 top-0 flex justify-between items-center h-12 mb-4",children:[(0,l.jsx)("div",{className:"text-left my-2 absolute top-0 left-0",children:(0,l.jsx)("div",{className:"flex flex-col items-center",children:(0,l.jsx)(a.default,{href:"/",children:(0,l.jsx)("button",{className:"text-gray-800 text-2xl py-1 rounded text-center",children:(0,l.jsx)("img",{src:"/get_image",width:200,height:200,alt:"LiteLLM Brand",className:"mr-2"})})})})}),(0,l.jsxs)("div",{className:"text-right mx-4 my-2 absolute top-0 right-0 flex items-center justify-end space-x-2",children:[r?(0,l.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/ui#setup-ssoauth-for-ui",target:"_blank",className:"mr-2",children:(0,l.jsx)(o.Z,{variant:"primary",size:"lg",children:"Enable SSO"})}):null,(0,l.jsxs)(o.Z,{variant:"secondary",size:"lg",children:[n,(0,l.jsxs)("p",{children:["Role: ",t]}),(0,l.jsxs)("p",{children:["ID: ",s]})]})]})]})},c=t(80588);let d=async(e,s,t)=>{try{if(console.log("Form Values in keyCreateCall:",t),t.description&&(t.metadata||(t.metadata={}),t.metadata.description=t.description,delete t.description,t.metadata=JSON.stringify(t.metadata)),t.metadata){console.log("formValues.metadata:",t.metadata);try{t.metadata=JSON.parse(t.metadata)}catch(e){throw c.ZP.error("Failed to parse metadata: "+e),Error("Failed to parse metadata: "+e)}}console.log("Form Values after check:",t);let l=await fetch("/key/generate",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({user_id:s,...t})});if(!l.ok){let e=await l.text();throw c.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let n=await l.json();return console.log("API Response:",n),n}catch(e){throw console.error("Failed to create key:",e),e}},h=async(e,s,t)=>{try{if(console.log("Form Values in keyCreateCall:",t),t.description&&(t.metadata||(t.metadata={}),t.metadata.description=t.description,delete t.description,t.metadata=JSON.stringify(t.metadata)),t.metadata){console.log("formValues.metadata:",t.metadata);try{t.metadata=JSON.parse(t.metadata)}catch(e){throw c.ZP.error("Failed to parse metadata: "+e),Error("Failed to parse metadata: "+e)}}console.log("Form Values after check:",t);let l=await fetch("/user/new",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({user_id:s,...t})});if(!l.ok){let e=await l.text();throw c.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let n=await l.json();return console.log("API Response:",n),n}catch(e){throw console.error("Failed to create key:",e),e}},m=async(e,s)=>{try{console.log("in keyDeleteCall:",s),c.ZP.info("Making key delete request");let t=await fetch("/key/delete",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({keys:[s]})});if(!t.ok){let e=await t.text();throw c.ZP.error("Failed to delete key: "+e),Error("Network response was not ok")}let l=await t.json();return console.log(l),c.ZP.success("API Key Deleted"),l}catch(e){throw console.error("Failed to create key:",e),e}},u=async function(e,s,t){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{let n="/user/info";"App Owner"==t&&s&&(n="".concat(n,"/?user_id=").concat(s)),console.log("in userInfoCall viewAll=",l),l&&(n="".concat(n,"/?view_all=true")),c.ZP.info("Requesting user data");let r=await fetch(n,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!r.ok){let e=await r.text();throw c.ZP.error(e),Error("Network response was not ok")}let a=await r.json();return console.log("API Response:",a),c.ZP.info("Received user data"),a}catch(e){throw console.error("Failed to create key:",e),e}},x=async(e,s,t)=>{try{c.ZP.info("Requesting model data");let s=await fetch("/v2/model/info",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok){let e=await s.text();throw c.ZP.error(e),Error("Network response was not ok")}let t=await s.json();return c.ZP.info("Received model data"),t}catch(e){throw console.error("Failed to create key:",e),e}},p=async(e,s,t)=>{try{c.ZP.info("Requesting model data");let s=await fetch("/models",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok){let e=await s.text();throw c.ZP.error(e),Error("Network response was not ok")}let t=await s.json();return c.ZP.info("Received model data"),t}catch(e){throw console.error("Failed to create key:",e),e}},j=async(e,s)=>{try{let t="/global/spend/logs";console.log("in keySpendLogsCall:",t);let l=await fetch("".concat(t,"/?api_key=").concat(s),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!l.ok){let e=await l.text();throw c.ZP.error(e),Error("Network response was not ok")}let n=await l.json();return console.log(n),n}catch(e){throw console.error("Failed to create key:",e),e}},g=async(e,s,t,l,n,r)=>{try{console.log("user role in spend logs call: ".concat(t));let s="/spend/logs";s="App Owner"==t?"".concat(s,"/?user_id=").concat(l,"&start_date=").concat(n,"&end_date=").concat(r):"".concat(s,"/?start_date=").concat(n,"&end_date=").concat(r),c.ZP.info("Making spend logs request");let a=await fetch(s,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok){let e=await a.text();throw c.ZP.error(e),Error("Network response was not ok")}let o=await a.json();return console.log(o),c.ZP.success("Spend Logs received"),o}catch(e){throw console.error("Failed to create key:",e),e}},Z=async e=>{try{c.ZP.info("Making spend logs request");let s=await fetch("/global/spend/logs",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok){let e=await s.text();throw c.ZP.error(e),Error("Network response was not ok")}let t=await s.json();return console.log(t),c.ZP.success("Spend Logs received"),t}catch(e){throw console.error("Failed to create key:",e),e}},y=async e=>{try{c.ZP.info("Making spend keys request");let s=await fetch("/global/spend/keys?limit=5",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok){let e=await s.text();throw c.ZP.error(e),Error("Network response was not ok")}let t=await s.json();return console.log(t),c.ZP.success("Spend Logs received"),t}catch(e){throw console.error("Failed to create key:",e),e}},f=async(e,s)=>{try{s&&JSON.stringify({api_key:s}),c.ZP.info("Making top end users request");let t={method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}};s&&(t.body=JSON.stringify({api_key:s}));let l=await fetch("/global/spend/end_users",t);if(!l.ok){let e=await l.text();throw c.ZP.error(e),Error("Network response was not ok")}let n=await l.json();return console.log(n),c.ZP.success("Top End users received"),n}catch(e){throw console.error("Failed to create key:",e),e}},w=async e=>{try{c.ZP.info("Making top models request");let s=await fetch("/global/spend/models?limit=5",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok){let e=await s.text();throw c.ZP.error(e),Error("Network response was not ok")}let t=await s.json();return console.log(t),c.ZP.success("Top Models received"),t}catch(e){throw console.error("Failed to create key:",e),e}},k=async(e,s)=>{try{let t=await fetch("/v2/key/info",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({keys:s})});if(!t.ok){let e=await t.text();throw c.ZP.error(e),Error("Network response was not ok")}let l=await t.json();return console.log(l),l}catch(e){throw console.error("Failed to create key:",e),e}},_=async(e,s)=>{try{let t="/spend/users";console.log("in spendUsersCall:",t);let l=await fetch("".concat(t,"/?user_id=").concat(s),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!l.ok){let e=await l.text();throw c.ZP.error(e),Error("Network response was not ok")}let n=await l.json();return console.log(n),n}catch(e){throw console.error("Failed to get spend for user",e),e}},b=async(e,s,t,l)=>{try{let n=await fetch("/user/request_model",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({models:[s],user_id:t,justification:l})});if(!n.ok){let e=await n.text();throw c.ZP.error("Failed to delete key: "+e),Error("Network response was not ok")}let r=await n.json();return console.log(r),c.ZP.success(""),r}catch(e){throw console.error("Failed to create key:",e),e}},v=async e=>{try{let s="/user/get_requests";console.log("in userGetRequesedtModelsCall:",s);let t=await fetch(s,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw c.ZP.error("Failed to delete key: "+e),Error("Network response was not ok")}let l=await t.json();return console.log(l),c.ZP.success(""),l}catch(e){throw console.error("Failed to get requested models:",e),e}},S=async(e,s)=>{try{let t="/user/get_users?role=".concat(s);console.log("in userGetAllUsersCall:",t);let l=await fetch(t,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!l.ok){let e=await l.text();throw c.ZP.error("Failed to delete key: "+e),Error("Network response was not ok")}let n=await l.json();return console.log(n),c.ZP.success("Got all users"),n}catch(e){throw console.error("Failed to get requested models:",e),e}},N=async(e,s)=>{try{console.log("Form Values in teamCreateCall:",s);let t=await fetch("/team/new",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({...s})});if(!t.ok){let e=await t.text();throw c.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let l=await t.json();return console.log("API Response:",l),l}catch(e){throw console.error("Failed to create key:",e),e}},A=async(e,s,t)=>{try{console.log("Form Values in teamMemberAddCall:",t);let l=await fetch("/team/member_add",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({team_id:s,member:t})});if(!l.ok){let e=await l.text();throw c.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let n=await l.json();return console.log("API Response:",n),n}catch(e){throw console.error("Failed to create key:",e),e}},C=async(e,s)=>{try{console.log("Form Values in userUpdateUserCall:",s);let t=await fetch("/user/update",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({user_role:"proxy_admin_viewer",...s})});if(!t.ok){let e=await t.text();throw c.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let l=await t.json();return console.log("API Response:",l),c.ZP.success("User role updated"),l}catch(e){throw console.error("Failed to create key:",e),e}},I=async(e,s)=>{try{let t=await fetch("/global/predict/spend/logs",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({data:s})});if(!t.ok){let e=await t.text();throw c.ZP.error(e),Error("Network response was not ok")}let l=await t.json();return console.log(l),l}catch(e){throw console.error("Failed to create key:",e),e}};var P=t(10384),T=t(46453),E=t(71801),F=t(17189),M=t(12143),O=t(77171),R=t(42539),D=t(88707),U=t(1861);let{Option:L}=F.default;var z=e=>{let{userID:s,teamID:t,userRole:r,accessToken:a,data:i,userModels:h,setData:m}=e,[u]=M.Z.useForm(),[x,p]=(0,n.useState)(!1),[j,g]=(0,n.useState)(null),Z=()=>{p(!1),u.resetFields()},y=()=>{p(!1),g(null),u.resetFields()},f=async e=>{try{c.ZP.info("Making API Call"),p(!0);let t=await d(a,s,e);m(e=>e?[...e,t]:[t]),g(t.key),c.ZP.success("API Key Created"),u.resetFields(),localStorage.removeItem("userData"+s)}catch(e){console.error("Error creating the key:",e)}};return(0,l.jsxs)("div",{children:[(0,l.jsx)(o.Z,{className:"mx-auto",onClick:()=>p(!0),children:"+ Create New Key"}),(0,l.jsx)(O.Z,{title:"Create Key",visible:x,width:800,footer:null,onOk:Z,onCancel:y,children:(0,l.jsxs)(M.Z,{form:u,onFinish:f,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:["App Owner"===r||"Admin"===r?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M.Z.Item,{label:"Key Name",name:"key_alias",children:(0,l.jsx)(R.Z,{})}),(0,l.jsx)(M.Z.Item,{label:"Team ID",name:"team_id",children:(0,l.jsx)(R.Z,{placeholder:"ai_team",defaultValue:t||""})}),(0,l.jsx)(M.Z.Item,{label:"Models",name:"models",children:(0,l.jsx)(F.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:h.map(e=>(0,l.jsx)(L,{value:e,children:e},e))})}),(0,l.jsx)(M.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,l.jsx)(D.Z,{step:.01,precision:2,width:200})}),(0,l.jsx)(M.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,l.jsxs)(F.default,{defaultValue:null,placeholder:"n/a",children:[(0,l.jsx)(F.default.Option,{value:"24h",children:"daily"}),(0,l.jsx)(F.default.Option,{value:"30d",children:"monthly"})]})}),(0,l.jsx)(M.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,l.jsx)(D.Z,{step:1,width:400})}),(0,l.jsx)(M.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,l.jsx)(D.Z,{step:1,width:400})}),(0,l.jsx)(M.Z.Item,{label:"Expire Key (eg: 30s, 30h, 30d)",name:"duration",children:(0,l.jsx)(R.Z,{})}),(0,l.jsx)(M.Z.Item,{label:"Metadata",name:"metadata",children:(0,l.jsx)(R.Z.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M.Z.Item,{label:"Key Name",name:"key_alias",children:(0,l.jsx)(R.Z,{})}),(0,l.jsx)(M.Z.Item,{label:"Team ID (Contact Group)",name:"team_id",children:(0,l.jsx)(R.Z,{placeholder:"ai_team"})}),(0,l.jsx)(M.Z.Item,{label:"Description",name:"description",children:(0,l.jsx)(R.Z.TextArea,{placeholder:"Enter description",rows:4})})]}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(U.ZP,{htmlType:"submit",children:"Create Key"})})]})}),j&&(0,l.jsx)(O.Z,{title:"Save your key",visible:x,onOk:Z,onCancel:y,footer:null,children:(0,l.jsxs)(T.Z,{numItems:1,className:"gap-2 w-full",children:[(0,l.jsx)(P.Z,{numColSpan:1,children:(0,l.jsxs)("p",{children:["Please save this secret key somewhere safe and accessible. For security reasons, ",(0,l.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,l.jsx)(P.Z,{numColSpan:1,children:null!=j?(0,l.jsxs)(E.Z,{children:["API Key: ",j]}):(0,l.jsx)(E.Z,{children:"Key being created, this might take 30s"})})]})})]})},q=t(33393),B=t(13810),K=t(61244),V=t(10827),J=t(3851),G=t(2044),W=t(64167),$=t(74480),Y=t(7178),H=t(9853),X=t(56863),Q=t(42440),ee=e=>{let{token:s,accessToken:t,keySpend:r,keyBudget:a,keyName:i}=e,[c,d]=(0,n.useState)(!1),[h,m]=(0,n.useState)(null),[u,x]=(0,n.useState)(""),[p,g]=(0,n.useState)(null),Z=async()=>{try{if(null==t||null==s)return;console.log("accessToken: ".concat(t,"; token: ").concat(s));let e=await j(t,s);console.log("Response:",e),m(e);let l=await I(t,e);console.log("Response2:",l);let n=[...e,...l.response];m(n),x(l.predicted_spend),console.log("Combined Data:",n)}catch(e){console.error("There was an error fetching the data",e)}};return s?(0,l.jsxs)("div",{children:[(0,l.jsx)(o.Z,{size:"xs",onClick:()=>{console.log("Show Modal triggered"),d(!0),Z()},children:"View Spend Report"}),(0,l.jsxs)(O.Z,{visible:c,width:1400,onOk:()=>{d(!1)},onCancel:()=>{d(!1)},footer:null,children:[(0,l.jsxs)(Q.Z,{style:{textAlign:"left"},children:["Key Name: ",i]}),(0,l.jsxs)(X.Z,{children:["Monthly Spend $",r]}),(0,l.jsx)(Q.Z,{children:u}),(0,l.jsx)(B.Z,{className:"mt-6 mb-6",children:h&&(0,l.jsx)(H.Z,{className:"mt-6",data:h,colors:["blue","amber"],index:"date",categories:["spend","predicted_spend"],yAxisWidth:80})})]})]}):null},es=e=>{let{userID:s,accessToken:t,data:r,setData:a}=e,[i,c]=(0,n.useState)(!1),[d,h]=(0,n.useState)(!1),[u,x]=(0,n.useState)(null),p=async e=>{null!=r&&(x(e),localStorage.removeItem("userData"+s),h(!0))},j=async()=>{if(null!=u&&null!=r){try{await m(t,u);let e=r.filter(e=>e.token!==u);a(e)}catch(e){console.error("Error deleting the key:",e)}h(!1),x(null)}};if(null!=r)return console.log("RERENDER TRIGGERED"),(0,l.jsxs)(B.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh] mb-4",children:[(0,l.jsxs)(V.Z,{className:"mt-5",children:[(0,l.jsx)(W.Z,{children:(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)($.Z,{children:"Key Alias"}),(0,l.jsx)($.Z,{children:"Secret Key"}),(0,l.jsx)($.Z,{children:"Spend (USD)"}),(0,l.jsx)($.Z,{children:"Key Budget (USD)"}),(0,l.jsx)($.Z,{children:"Spend Report"}),(0,l.jsx)($.Z,{children:"Team ID"}),(0,l.jsx)($.Z,{children:"Metadata"}),(0,l.jsx)($.Z,{children:"Models"}),(0,l.jsx)($.Z,{children:"TPM / RPM Limits"}),(0,l.jsx)($.Z,{children:"Expires"})]})}),(0,l.jsx)(J.Z,{children:r.map(e=>(console.log(e),"litellm-dashboard"===e.team_id)?null:(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)(G.Z,{children:null!=e.key_alias?(0,l.jsx)(E.Z,{children:e.key_alias}):(0,l.jsx)(E.Z,{children:"Not Set"})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(E.Z,{children:e.key_name})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(E.Z,{children:e.spend})}),(0,l.jsx)(G.Z,{children:null!=e.max_budget?(0,l.jsx)(E.Z,{children:e.max_budget}):(0,l.jsx)(E.Z,{children:"Unlimited Budget"})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(ee,{token:e.token,accessToken:t,keySpend:e.spend,keyBudget:e.max_budget,keyName:e.key_name})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(E.Z,{children:e.team_id})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(E.Z,{children:JSON.stringify(e.metadata)})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(E.Z,{children:JSON.stringify(e.models)})}),(0,l.jsx)(G.Z,{children:(0,l.jsxs)(E.Z,{children:["TPM Limit: ",e.tpm_limit?e.tpm_limit:"Unlimited"," ",(0,l.jsx)("br",{})," RPM Limit:"," ",e.rpm_limit?e.rpm_limit:"Unlimited"]})}),(0,l.jsx)(G.Z,{children:null!=e.expires?(0,l.jsx)(E.Z,{children:e.expires}):(0,l.jsx)(E.Z,{children:"Never expires"})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(K.Z,{onClick:()=>p(e.token),icon:q.Z,size:"sm"})})]},e.token))})]}),d&&(0,l.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,l.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,l.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,l.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,l.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,l.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,l.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,l.jsx)("div",{className:"sm:flex sm:items-start",children:(0,l.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,l.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Key"}),(0,l.jsx)("div",{className:"mt-2",children:(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this key ?"})})]})})}),(0,l.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,l.jsx)(o.Z,{onClick:j,color:"red",className:"ml-2",children:"Delete"}),(0,l.jsx)(o.Z,{onClick:()=>{h(!1),x(null)},children:"Cancel"})]})]})]})})]})},et=e=>{let{userID:s,userSpendData:t,userRole:r,accessToken:a}=e;console.log("User SpendData:",t);let[o,i]=(0,n.useState)(null==t?void 0:t.spend),[c,d]=(0,n.useState)((null==t?void 0:t.max_budget)||null);return(0,n.useEffect)(()=>{(async()=>{if("Admin"===r)try{let e=await _(a,"litellm-proxy-budget");console.log("Result from callSpendUsers:",e);let s=e[0];i(null==s?void 0:s.spend),d((null==s?void 0:s.max_budget)||null)}catch(e){console.error("Failed to get spend for user",e)}})()},[r,a,s]),(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(B.Z,{className:"mx-auto mb-4",children:[(0,l.jsxs)(X.Z,{children:["$",o]}),(0,l.jsxs)(Q.Z,{children:["/ ",null!==c?"$".concat(c," limit"):"No limit"]})]})})},el=t(36083),en=t(68967),er=t(27166),ea=e=>{let{teams:s,setSelectedTeam:t}=e,{Title:r,Paragraph:a}=el.default,[o,i]=(0,n.useState)("");return(0,l.jsxs)("div",{className:"mt-10",children:[(0,l.jsx)(r,{level:4,children:"Default Team"}),(0,l.jsx)(a,{children:"If you belong to multiple teams, this setting controls which team is used by default when creating new API Keys."}),s&&s.length>0?(0,l.jsx)(en.Z,{defaultValue:"0",children:s.map((e,s)=>(0,l.jsx)(er.Z,{value:String(s),onClick:()=>t(e),children:e.team_alias},s))}):(0,l.jsxs)(a,{children:["No team created. ",(0,l.jsx)("b",{children:"Defaulting to personal account."})]})]})},eo=t(37963);console.log("isLocal:",!1);var ei=e=>{let{userID:s,userRole:t,teams:a,keys:o,setUserRole:i,userEmail:c,setUserEmail:d,setTeams:h,setKeys:m}=e,[x,j]=(0,n.useState)(null),g=(0,r.useSearchParams)();g.get("viewSpend"),(0,r.useRouter)();let Z=g.get("token"),[y,f]=(0,n.useState)(null),[w,k]=(0,n.useState)([]),[_,b]=(0,n.useState)(a?a[0]:null);if(window.addEventListener("beforeunload",function(){sessionStorage.clear()}),(0,n.useEffect)(()=>{if(Z){let e=(0,eo.o)(Z);if(e){if(console.log("Decoded token:",e),console.log("Decoded key:",e.key),f(e.key),e.user_role){let s=function(e){if(!e)return"Undefined Role";switch(console.log("Received user role: ".concat(e)),e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"app_user":return"App User";default:return"Unknown Role"}}(e.user_role);console.log("Decoded user_role:",s),i(s)}else console.log("User role not defined");e.user_email?d(e.user_email):console.log("User Email is not set ".concat(e))}}if(s&&y&&t&&!o&&!x){let e=sessionStorage.getItem("userModels"+s);e?k(JSON.parse(e)):(async()=>{try{let e=await u(y,s,t);console.log("received teams in user dashboard: ".concat(Object.keys(e),"; team values: ").concat(Object.entries(e.teams))),j(e.user_info),m(e.keys),h(e.teams),b(e.teams?e.teams[0]:null),sessionStorage.setItem("userData"+s,JSON.stringify(e.keys)),sessionStorage.setItem("userSpendData"+s,JSON.stringify(e.user_info));let l=(await p(y,s,t)).data.map(e=>e.id);console.log("available_model_names:",l),k(l),console.log("userModels:",w),sessionStorage.setItem("userModels"+s,JSON.stringify(l))}catch(e){console.error("There was an error fetching the data",e)}})()}},[s,Z,y,o,t]),null==s||null==Z){let e="/sso/key/generate";return console.log("Full URL:",e),window.location.href=e,null}if(null==y)return null;if(null==t&&i("App Owner"),t&&"Admin Viewer"==t){let{Title:e,Paragraph:s}=el.default;return(0,l.jsxs)("div",{children:[(0,l.jsx)(e,{level:1,children:"Access Denied"}),(0,l.jsx)(s,{children:"Ask your proxy admin for access to create keys"})]})}return(0,l.jsx)("div",{children:(0,l.jsx)(T.Z,{numItems:1,className:"gap-0 p-10 h-[75vh] w-full",children:(0,l.jsxs)(P.Z,{numColSpan:1,children:[(0,l.jsx)(et,{userID:s,userSpendData:x,userRole:t,accessToken:y}),(0,l.jsx)(es,{userID:s,accessToken:y,data:o,setData:m}),(0,l.jsx)(z,{userID:s,teamID:_?_.team_id:null,userRole:t,userModels:w,accessToken:y,data:o,setData:m}),(0,l.jsx)(ea,{teams:a,setSelectedTeam:b})]})})})},ec=t(5);let{Option:ed}=F.default;var eh=e=>{let{userModels:s,accessToken:t,userID:r}=e,[a]=M.Z.useForm(),[i,d]=(0,n.useState)(!1),h=async e=>{try{c.ZP.info("Requesting access");let{selectedModel:s,accessReason:l}=e;await b(t,s,r,l),d(!0)}catch(e){console.error("Error requesting access:",e)}};return(0,l.jsxs)("div",{children:[(0,l.jsx)(o.Z,{size:"xs",onClick:()=>d(!0),children:"Request Access"}),(0,l.jsx)(O.Z,{title:"Request Access",visible:i,width:800,footer:null,onOk:()=>{d(!1),a.resetFields()},onCancel:()=>{d(!1),a.resetFields()},children:(0,l.jsxs)(M.Z,{form:a,onFinish:h,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsx)(M.Z.Item,{label:"Select Model",name:"selectedModel",children:(0,l.jsx)(F.default,{placeholder:"Select model",style:{width:"100%"},children:s.map(e=>(0,l.jsx)(ed,{value:e,children:e},e))})}),(0,l.jsx)(M.Z.Item,{label:"Reason for Access",name:"accessReason",children:(0,l.jsx)(R.Z.TextArea,{rows:4,placeholder:"Enter reason for access"})}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(o.Z,{children:"Request Access"})})]})})]})},em=e=>{let{accessToken:s,token:t,userRole:r,userID:a}=e,[i,c]=(0,n.useState)({data:[]}),[d,h]=(0,n.useState)([]);if((0,n.useEffect)(()=>{if(!s||!t||!r||!a)return;let e=async()=>{try{let e=await x(s,a,r);if(console.log("Model data response:",e.data),c(e),"Admin"===r&&s){let e=await v(s);console.log("Pending Requests:",d),h(e.requests||[])}}catch(e){console.error("There was an error fetching the model data",e)}};s&&t&&r&&a&&e()},[s,t,r,a]),!i||!s||!t||!r||!a)return(0,l.jsx)("div",{children:"Loading..."});let m=[];for(let e=0;e<i.data.length;e++){var u;let s=i.data[e],t=null==s?void 0:null===(u=s.litellm_params)||void 0===u?void 0:u.model,l=null==s?void 0:s.model_info,n="openai",r="",a="Undefined",o="Undefined",c="Undefined";if(t){let e=t.split("/"),s=e[0];r=1===e.length?n:s}else r=n;l&&(a=null==l?void 0:l.input_cost_per_token,o=null==l?void 0:l.output_cost_per_token,c=null==l?void 0:l.max_tokens),i.data[e].provider=r,i.data[e].input_cost=a,i.data[e].output_cost=o,i.data[e].max_tokens=c,m.push(s.model_name),console.log(i.data[e])}if(r&&"Admin Viewer"==r){let{Title:e,Paragraph:s}=el.default;return(0,l.jsxs)("div",{children:[(0,l.jsx)(e,{level:1,children:"Access Denied"}),(0,l.jsx)(s,{children:"Ask your proxy admin for access to view all models"})]})}return(0,l.jsx)("div",{style:{width:"100%"},children:(0,l.jsxs)(T.Z,{className:"gap-2 p-10 h-[75vh] w-full",children:[(0,l.jsx)(B.Z,{children:(0,l.jsxs)(V.Z,{className:"mt-5",children:[(0,l.jsx)(W.Z,{children:(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"Model Name "})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"Provider"})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"Access"})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"Input Price per token ($)"})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"Output Price per token ($)"})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"Max Tokens"})})]})}),(0,l.jsx)(J.Z,{children:i.data.map(e=>(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:e.model_name})}),(0,l.jsx)(G.Z,{children:e.provider}),(0,l.jsx)(G.Z,{children:e.user_access?(0,l.jsx)(ec.Z,{color:"green",children:"Yes"}):(0,l.jsx)(eh,{userModels:m,accessToken:s,userID:a})}),(0,l.jsx)(G.Z,{children:e.input_cost}),(0,l.jsx)(G.Z,{children:e.output_cost}),(0,l.jsx)(G.Z,{children:e.max_tokens})]},e.model_name))})]})}),"Admin"===r&&d&&d.length>0?(0,l.jsx)(B.Z,{children:(0,l.jsxs)(V.Z,{children:[(0,l.jsxs)(W.Z,{children:[(0,l.jsx)(Q.Z,{children:"Pending Requests"}),(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"User ID"})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"Requested Models"})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"Justification"})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"Justification"})})]})]}),(0,l.jsx)(J.Z,{children:d.map(e=>(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)(G.Z,{children:(0,l.jsx)("p",{children:e.user_id})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)("p",{children:e.models[0]})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)("p",{children:e.justification})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)("p",{children:e.user_id})}),(0,l.jsx)(o.Z,{children:"Approve"}),(0,l.jsx)(o.Z,{variant:"secondary",className:"ml-2",children:"Deny"})]},e.request_id))})]})}):null]})})},eu=t(92836),ex=t(26734),ep=t(41608),ej=t(32126),eg=t(23682);let{Option:eZ}=F.default;var ey=e=>{let{userID:s,accessToken:t}=e,[r]=M.Z.useForm(),[a,i]=(0,n.useState)(!1),[d,m]=(0,n.useState)(null),[u,x]=(0,n.useState)([]);(0,n.useEffect)(()=>{(async()=>{try{let e=await p(t,s,"any"),l=[];for(let s=0;s<e.data.length;s++){let t=e.data[s];l.push(t.id)}console.log("Model data response:",e.data),console.log("Available models:",l),x(l)}catch(e){console.error("Error fetching model data:",e)}})()},[]);let j=()=>{i(!1),r.resetFields()},g=()=>{i(!1),m(null),r.resetFields()},Z=async e=>{try{c.ZP.info("Making API Call"),i(!0),console.log("formValues in create user:",e);let l=await h(t,s,e);console.log("user create Response:",l),m(l.key),c.ZP.success("API user Created"),r.resetFields(),localStorage.removeItem("userData"+s)}catch(e){console.error("Error creating the user:",e)}};return(0,l.jsxs)("div",{children:[(0,l.jsx)(o.Z,{className:"mx-auto",onClick:()=>i(!0),children:"+ Create New User"}),(0,l.jsx)(O.Z,{title:"Create User",visible:a,width:800,footer:null,onOk:j,onCancel:g,children:(0,l.jsxs)(M.Z,{form:r,onFinish:Z,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsx)(M.Z.Item,{label:"User ID",name:"user_id",children:(0,l.jsx)(R.Z,{placeholder:"Enter User ID"})}),(0,l.jsx)(M.Z.Item,{label:"Team ID",name:"team_id",children:(0,l.jsx)(R.Z,{placeholder:"ai_team"})}),(0,l.jsx)(M.Z.Item,{label:"Models",name:"models",children:(0,l.jsx)(F.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:u.map(e=>(0,l.jsx)(eZ,{value:e,children:e},e))})}),(0,l.jsx)(M.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,l.jsx)(D.Z,{step:.01,precision:2,width:200})}),(0,l.jsx)(M.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,l.jsx)(D.Z,{step:1,width:400})}),(0,l.jsx)(M.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,l.jsx)(D.Z,{step:1,width:400})}),(0,l.jsx)(M.Z.Item,{label:"Duration (eg: 30s, 30h, 30d)",name:"duration",children:(0,l.jsx)(R.Z,{})}),(0,l.jsx)(M.Z.Item,{label:"Metadata",name:"metadata",children:(0,l.jsx)(R.Z.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(U.ZP,{htmlType:"submit",children:"Create User"})})]})}),d&&(0,l.jsxs)(O.Z,{title:"Save Your User",visible:a,onOk:j,onCancel:g,footer:null,children:[(0,l.jsxs)("p",{children:["Please save this secret user somewhere safe and accessible. For security reasons, ",(0,l.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret user, you will need to generate a new one."]}),(0,l.jsx)("p",{children:null!=d?"API user: ".concat(d):"User being created, this might take 30s"})]})]})},ef=e=>{let{accessToken:s,token:t,keys:r,userRole:a,userID:o,setKeys:i}=e,[c,d]=(0,n.useState)(null),[h,m]=(0,n.useState)(null),[x,p]=(0,n.useState)(1);if((0,n.useEffect)(()=>{if(!s||!t||!a||!o)return;let e=async()=>{try{let e=await u(s,null,a,!0);console.log("user data response:",e),d(e)}catch(e){console.error("There was an error fetching the model data",e)}};s&&t&&a&&o&&!c&&e();let l=async()=>{try{let e=await f(s,null);console.log("user data response:",e),m(e)}catch(e){console.error("There was an error fetching the model data",e)}};a&&("Admin"==a||"Admin Viewer"==a)&&!h&&l()},[s,t,a,o]),!c||!s||!t||!a||!o)return(0,l.jsx)("div",{children:"Loading..."});let j=async e=>{try{let t=await f(s,e);console.log("user data response:",t),m(t)}catch(e){console.error("There was an error fetching the model data",e)}};return(0,l.jsx)("div",{style:{width:"100%"},children:(0,l.jsxs)(T.Z,{className:"gap-2 p-10 h-[75vh] w-full",children:[(0,l.jsx)(ey,{userID:o,accessToken:s}),(0,l.jsx)(B.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh] mb-4",children:(0,l.jsxs)(ex.Z,{children:[(0,l.jsxs)(ep.Z,{variant:"line",defaultValue:"1",children:[(0,l.jsx)(eu.Z,{value:"1",children:"Key Owners"}),(0,l.jsx)(eu.Z,{value:"2",children:"End-Users"})]}),(0,l.jsxs)(eg.Z,{children:[(0,l.jsx)(ej.Z,{children:(0,l.jsxs)(V.Z,{className:"mt-5",children:[(0,l.jsx)(W.Z,{children:(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)($.Z,{children:"User ID"}),(0,l.jsx)($.Z,{children:"User Role"}),(0,l.jsx)($.Z,{children:"User Models"}),(0,l.jsx)($.Z,{children:"User Spend ($ USD)"}),(0,l.jsx)($.Z,{children:"User Max Budget ($ USD)"})]})}),(0,l.jsx)(J.Z,{children:c.map(e=>(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)(G.Z,{children:e.user_id}),(0,l.jsx)(G.Z,{children:e.user_role?e.user_role:"app_owner"}),(0,l.jsx)(G.Z,{children:e.models&&e.models.length>0?e.models:"All Models"}),(0,l.jsx)(G.Z,{children:e.spend?e.spend:0}),(0,l.jsx)(G.Z,{children:e.max_budget?e.max_budget:"Unlimited"})]},e.user_id))})]})}),(0,l.jsxs)(ej.Z,{children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-1"}),(0,l.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,l.jsx)(E.Z,{className:"w-1/4 mr-2 text-right",children:"Key"}),(0,l.jsx)(en.Z,{defaultValue:"1",className:"w-3/4",children:null==r?void 0:r.map((e,s)=>{if(e&&null!==e.key_name&&e.key_name.length>0)return(0,l.jsx)(er.Z,{value:String(s),onClick:()=>j(e.token),children:e.key_name},s)})})]})]}),(0,l.jsxs)(V.Z,{children:[(0,l.jsx)(W.Z,{children:(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)($.Z,{children:"End User"}),(0,l.jsx)($.Z,{children:"Spend"}),(0,l.jsx)($.Z,{children:"Total Events"})]})}),(0,l.jsx)(J.Z,{children:null==h?void 0:h.map((e,s)=>(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)(G.Z,{children:e.end_user}),(0,l.jsx)(G.Z,{children:e.total_spend}),(0,l.jsx)(G.Z,{children:e.total_events})]},s))})]})]})]})]})}),function(){if(!c)return null;let e=Math.ceil(c.length/25),s=Math.min(25*x,c.length);return(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:["Showing ",(x-1)*25+1," – ",s," of ",c.length]}),(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-l focus:outline-none",disabled:1===x,onClick:()=>p(x-1),children:"← Prev"}),(0,l.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-r focus:outline-none",disabled:x===e,onClick:()=>p(x+1),children:"Next →"})]})]})}()]})})},ew=t(8510),ek=e=>{let{teams:s,searchParams:t,accessToken:r,setTeams:a}=e,[i]=M.Z.useForm(),[d]=M.Z.useForm(),{Title:h,Paragraph:m}=el.default,[u,x]=(0,n.useState)(""),[p,j]=(0,n.useState)(s?s[0]:null),[g,Z]=(0,n.useState)(!1),[y,f]=(0,n.useState)(!1),w=async e=>{try{if(null!=r){c.ZP.info("Making API Call");let t=await N(r,e);null!==s?a([...s,t]):a([t]),console.log("response for team create call: ".concat(t)),Z(!1)}}catch(e){console.error("Error creating the key:",e)}},k=async e=>{try{if(null!=r&&null!=s){c.ZP.info("Making API Call");let t={role:"user",user_email:e.user_email,user_id:e.user_id},l=await A(r,p.team_id,t);console.log("response for team create call: ".concat(l.data));let n=s.findIndex(e=>(console.log("team.team_id=".concat(e.team_id,"; response.data.team_id=").concat(l.data.team_id)),e.team_id===l.data.team_id));if(console.log("foundIndex: ".concat(n)),-1!==n){let e=[...s];e[n]=l.data,a(e),j(l.data)}f(!1)}}catch(e){console.error("Error creating the key:",e)}};return console.log("received teams ".concat(s)),(0,l.jsx)("div",{className:"w-full",children:(0,l.jsxs)(T.Z,{numItems:1,className:"gap-2 p-2 h-[75vh] w-full",children:[(0,l.jsxs)(P.Z,{numColSpan:1,children:[(0,l.jsx)(h,{level:4,children:"All Teams"}),(0,l.jsx)(B.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,l.jsxs)(V.Z,{children:[(0,l.jsx)(W.Z,{children:(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)($.Z,{children:"Team Name"}),(0,l.jsx)($.Z,{children:"Spend (USD)"}),(0,l.jsx)($.Z,{children:"Budget (USD)"}),(0,l.jsx)($.Z,{children:"TPM / RPM Limits"})]})}),(0,l.jsx)(J.Z,{children:s&&s.length>0?s.map(e=>(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)(G.Z,{children:e.team_alias}),(0,l.jsx)(G.Z,{children:e.spend}),(0,l.jsx)(G.Z,{children:e.max_budget?e.max_budget:"No limit"}),(0,l.jsx)(G.Z,{children:(0,l.jsxs)(E.Z,{children:["TPM Limit:"," ",e.tpm_limit?e.tpm_limit:"Unlimited"," ",(0,l.jsx)("br",{})," RPM Limit:"," ",e.rpm_limit?e.rpm_limit:"Unlimited"]})}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(K.Z,{icon:ew.Z,size:"sm"})})]},e.team_id)):null})]})})]}),(0,l.jsxs)(P.Z,{numColSpan:1,children:[(0,l.jsx)(o.Z,{className:"mx-auto",onClick:()=>Z(!0),children:"+ Create New Team"}),(0,l.jsx)(O.Z,{title:"Create Team",visible:g,width:800,footer:null,onOk:()=>{Z(!1),i.resetFields()},onCancel:()=>{Z(!1),i.resetFields()},children:(0,l.jsxs)(M.Z,{form:i,onFinish:w,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M.Z.Item,{label:"Team Name",name:"team_alias",children:(0,l.jsx)(R.Z,{})}),(0,l.jsx)(M.Z.Item,{label:"Models",name:"models",children:(0,l.jsx)(F.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"}})}),(0,l.jsx)(M.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,l.jsx)(D.Z,{step:.01,precision:2,width:200})}),(0,l.jsx)(M.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,l.jsx)(D.Z,{step:1,width:400})}),(0,l.jsx)(M.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,l.jsx)(D.Z,{step:1,width:400})})]}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(U.ZP,{htmlType:"submit",children:"Create Team"})})]})})]}),(0,l.jsxs)(P.Z,{numColSpan:1,children:[(0,l.jsx)(h,{level:4,children:"Team Members"}),(0,l.jsx)(m,{children:"If you belong to multiple teams, this setting controls which teams members you see."}),s&&s.length>0?(0,l.jsx)(en.Z,{defaultValue:"0",children:s.map((e,s)=>(0,l.jsx)(er.Z,{value:String(s),onClick:()=>{j(e)},children:e.team_alias},s))}):(0,l.jsxs)(m,{children:["No team created. ",(0,l.jsx)("b",{children:"Defaulting to personal account."})]})]}),(0,l.jsx)(P.Z,{numColSpan:1,children:(0,l.jsx)(B.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,l.jsxs)(V.Z,{children:[(0,l.jsx)(W.Z,{children:(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)($.Z,{children:"Member Name"}),(0,l.jsx)($.Z,{children:"Role"}),(0,l.jsx)($.Z,{children:"Action"})]})}),(0,l.jsx)(J.Z,{children:p?p.members_with_roles.map((e,s)=>(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)(G.Z,{children:e.user_email?e.user_email:e.user_id?e.user_id:null}),(0,l.jsx)(G.Z,{children:e.role}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(K.Z,{icon:ew.Z,size:"sm"})})]},s)):null})]})})}),(0,l.jsxs)(P.Z,{numColSpan:1,children:[(0,l.jsx)(o.Z,{className:"mx-auto mb-5",onClick:()=>f(!0),children:"+ Add member"}),(0,l.jsx)(O.Z,{title:"Add member",visible:y,width:800,footer:null,onOk:()=>{f(!1),d.resetFields()},onCancel:()=>{f(!1),d.resetFields()},children:(0,l.jsxs)(M.Z,{form:i,onFinish:k,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M.Z.Item,{label:"Email",name:"user_email",className:"mb-4",children:(0,l.jsx)(R.Z,{name:"user_email",className:"px-3 py-2 border rounded-md w-full"})}),(0,l.jsx)("div",{className:"text-center mb-4",children:"OR"}),(0,l.jsx)(M.Z.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,l.jsx)(R.Z,{name:"user_id",className:"px-3 py-2 border rounded-md w-full"})})]}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(U.ZP,{htmlType:"submit",children:"Add member"})})]})})]})]})})},e_=e=>{let{searchParams:s,accessToken:t}=e,[r]=M.Z.useForm(),[a]=M.Z.useForm(),{Title:i,Paragraph:d}=el.default,[h,m]=(0,n.useState)(""),[u,x]=(0,n.useState)(null),[p,j]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{if(null!=t){let e=[],s=await S(t,"proxy_admin_viewer");s.forEach(s=>{e.push({user_role:s.user_role,user_id:s.user_id,user_email:s.user_email})}),console.log("proxy viewers: ".concat(s));let l=await S(t,"proxy_admin");l.forEach(s=>{e.push({user_role:s.user_role,user_id:s.user_id,user_email:s.user_email})}),console.log("proxy admins: ".concat(l)),console.log("combinedList: ".concat(e)),x(e)}})()},[t]);let g=async e=>{try{if(null!=t&&null!=u){c.ZP.info("Making API Call"),e.user_email,e.user_id;let s=await C(t,e);console.log("response for team create call: ".concat(s));let l=u.findIndex(e=>(console.log("user.user_id=".concat(e.user_id,"; response.user_id=").concat(s.user_id)),e.user_id===s.user_id));console.log("foundIndex: ".concat(l)),-1==l&&(console.log("updates admin with new user"),u.push(s),x(u)),j(!1)}}catch(e){console.error("Error creating the key:",e)}};return console.log("admins: ".concat(null==u?void 0:u.length)),(0,l.jsxs)("div",{className:"w-full m-2",children:[(0,l.jsx)(i,{level:4,children:"Restricted Access"}),(0,l.jsxs)(d,{children:["Add other people to just view spend. They cannot create keys, teams or grant users access to new models."," ",(0,l.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/ui#restrict-ui-access",children:"Requires SSO Setup"})]}),(0,l.jsxs)(T.Z,{numItems:1,className:"gap-2 p-0 w-full",children:[(0,l.jsx)(P.Z,{numColSpan:1,children:(0,l.jsx)(B.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,l.jsxs)(V.Z,{children:[(0,l.jsx)(W.Z,{children:(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)($.Z,{children:"Member Name"}),(0,l.jsx)($.Z,{children:"Role"}),(0,l.jsx)($.Z,{children:"Action"})]})}),(0,l.jsx)(J.Z,{children:u?u.map((e,s)=>(0,l.jsxs)(Y.Z,{children:[(0,l.jsx)(G.Z,{children:e.user_email?e.user_email:e.user_id?e.user_id:null}),(0,l.jsx)(G.Z,{children:e.user_role}),(0,l.jsx)(G.Z,{children:(0,l.jsx)(K.Z,{icon:ew.Z,size:"sm"})})]},s)):null})]})})}),(0,l.jsxs)(P.Z,{numColSpan:1,children:[(0,l.jsx)(o.Z,{className:"mx-auto mb-5",onClick:()=>j(!0),children:"+ Add viewer"}),(0,l.jsx)(O.Z,{title:"Add viewer",visible:p,width:800,footer:null,onOk:()=>{j(!1),a.resetFields()},onCancel:()=>{j(!1),a.resetFields()},children:(0,l.jsxs)(M.Z,{form:r,onFinish:g,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M.Z.Item,{label:"Email",name:"user_email",className:"mb-4",children:(0,l.jsx)(R.Z,{name:"user_email",className:"px-3 py-2 border rounded-md w-full"})}),(0,l.jsx)("div",{className:"text-center mb-4",children:"OR"}),(0,l.jsx)(M.Z.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,l.jsx)(R.Z,{name:"user_id",className:"px-3 py-2 border rounded-md w-full"})})]}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(U.ZP,{htmlType:"submit",children:"Add member"})})]})})]})]})]})},eb=t(12968),ev=t(67951);async function eS(e,s,t,l){console.log("isLocal:",!1);let n=window.location.origin,r=new eb.ZP.OpenAI({apiKey:l,baseURL:n,dangerouslyAllowBrowser:!0});for await(let l of(await r.chat.completions.create({model:t,stream:!0,messages:[{role:"user",content:e}]})))console.log(l),l.choices[0].delta.content&&s(l.choices[0].delta.content)}var eN=e=>{let{accessToken:s,token:t,userRole:r,userID:a}=e,[o,i]=(0,n.useState)(""),[c,d]=(0,n.useState)([]),[h,m]=(0,n.useState)(void 0),[u,x]=(0,n.useState)(null);(0,n.useEffect)(()=>{s&&t&&r&&a&&(async()=>{let e=await p(s,a,r);console.log("model_info:",e),(null==e?void 0:e.data.length)>0&&(x(e.data),m(e.data[0].id))})()},[s,a,r]);let j=(e,s)=>{d(t=>{let l=t[t.length-1];return l&&l.role===e?[...t.slice(0,t.length-1),{role:e,content:l.content+s}]:[...t,{role:e,content:s}]})},g=async()=>{if(""!==o.trim()&&s&&t&&r&&a){d(e=>[...e,{role:"user",content:o}]);try{h&&await eS(o,e=>j("assistant",e),h,s)}catch(e){console.error("Error fetching model response",e),j("assistant","Error fetching model response")}i("")}};if(r&&"Admin Viewer"==r){let{Title:e,Paragraph:s}=el.default;return(0,l.jsxs)("div",{children:[(0,l.jsx)(e,{level:1,children:"Access Denied"}),(0,l.jsx)(s,{children:"Ask your proxy admin for access to test models"})]})}return(0,l.jsx)("div",{style:{width:"100%",position:"relative"},children:(0,l.jsx)(T.Z,{className:"gap-2 p-10 h-[75vh] w-full",children:(0,l.jsx)(B.Z,{children:(0,l.jsxs)(ex.Z,{children:[(0,l.jsxs)(ep.Z,{className:"mt-4",children:[(0,l.jsx)(eu.Z,{children:"Chat"}),(0,l.jsx)(eu.Z,{children:"API Reference"})]}),(0,l.jsxs)(eg.Z,{children:[(0,l.jsxs)(ej.Z,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{children:"Select Model:"}),(0,l.jsx)("select",{value:h||"",onChange:e=>m(e.target.value),children:null==u?void 0:u.map(e=>(0,l.jsx)("option",{value:e.id,children:e.id},e.id))})]}),(0,l.jsxs)(V.Z,{className:"mt-5",style:{display:"block",maxHeight:"60vh",overflowY:"auto"},children:[(0,l.jsx)(W.Z,{children:(0,l.jsx)(Y.Z,{children:(0,l.jsx)(G.Z,{children:(0,l.jsx)(Q.Z,{children:"Chat"})})})}),(0,l.jsx)(J.Z,{children:c.map((e,s)=>(0,l.jsx)(Y.Z,{children:(0,l.jsx)(G.Z,{children:"".concat(e.role,": ").concat(e.content)})},s))})]}),(0,l.jsx)("div",{className:"mt-3",style:{position:"absolute",bottom:5,width:"95%"},children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("input",{type:"text",value:o,onChange:e=>i(e.target.value),className:"flex-1 p-2 border rounded-md mr-2",placeholder:"Type your message..."}),(0,l.jsx)("button",{onClick:g,className:"p-2 bg-blue-500 text-white rounded-md",children:"Send"})]})})]}),(0,l.jsx)(ej.Z,{children:(0,l.jsxs)(ex.Z,{children:[(0,l.jsxs)(ep.Z,{children:[(0,l.jsx)(eu.Z,{children:"OpenAI Python SDK"}),(0,l.jsx)(eu.Z,{children:"LlamaIndex"}),(0,l.jsx)(eu.Z,{children:"Langchain Py"})]}),(0,l.jsxs)(eg.Z,{children:[(0,l.jsx)(ej.Z,{children:(0,l.jsx)(ev.Z,{language:"python",children:'\nimport openai\nclient = openai.OpenAI(\n    api_key="your_api_key",\n    base_url="http://0.0.0.0:4000" # proxy base url\n)\n\nresponse = client.chat.completions.create(\n    model="gpt-3.5-turbo", # model to use from Models Tab\n    messages = [\n        {\n            "role": "user",\n            "content": "this is a test request, write a short poem"\n        }\n    ],\n    extra_body={\n        "metadata": {\n            "generation_name": "ishaan-generation-openai-client",\n            "generation_id": "openai-client-gen-id22",\n            "trace_id": "openai-client-trace-id22",\n            "trace_user_id": "openai-client-user-id2"\n        }\n    }\n)\n\nprint(response)\n            '})}),(0,l.jsx)(ej.Z,{children:(0,l.jsx)(ev.Z,{language:"python",children:'\nimport os, dotenv\n\nfrom llama_index.llms import AzureOpenAI\nfrom llama_index.embeddings import AzureOpenAIEmbedding\nfrom llama_index import VectorStoreIndex, SimpleDirectoryReader, ServiceContext\n\nllm = AzureOpenAI(\n    engine="azure-gpt-3.5",               # model_name on litellm proxy\n    temperature=0.0,\n    azure_endpoint="http://0.0.0.0:4000", # litellm proxy endpoint\n    api_key="sk-1234",                    # litellm proxy API Key\n    api_version="2023-07-01-preview",\n)\n\nembed_model = AzureOpenAIEmbedding(\n    deployment_name="azure-embedding-model",\n    azure_endpoint="http://0.0.0.0:4000",\n    api_key="sk-1234",\n    api_version="2023-07-01-preview",\n)\n\n\ndocuments = SimpleDirectoryReader("llama_index_data").load_data()\nservice_context = ServiceContext.from_defaults(llm=llm, embed_model=embed_model)\nindex = VectorStoreIndex.from_documents(documents, service_context=service_context)\n\nquery_engine = index.as_query_engine()\nresponse = query_engine.query("What did the author do growing up?")\nprint(response)\n\n            '})}),(0,l.jsx)(ej.Z,{children:(0,l.jsx)(ev.Z,{language:"python",children:'\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.prompts.chat import (\n    ChatPromptTemplate,\n    HumanMessagePromptTemplate,\n    SystemMessagePromptTemplate,\n)\nfrom langchain.schema import HumanMessage, SystemMessage\n\nchat = ChatOpenAI(\n    openai_api_base="http://0.0.0.0:8000",\n    model = "gpt-3.5-turbo",\n    temperature=0.1,\n    extra_body={\n        "metadata": {\n            "generation_name": "ishaan-generation-langchain-client",\n            "generation_id": "langchain-client-gen-id22",\n            "trace_id": "langchain-client-trace-id22",\n            "trace_user_id": "langchain-client-user-id2"\n        }\n    }\n)\n\nmessages = [\n    SystemMessage(\n        content="You are a helpful assistant that im using to make a test request to."\n    ),\n    HumanMessage(\n        content="test from litellm. tell me why it\'s amazing in 1 sentence"\n    ),\n]\nresponse = chat(messages)\n\nprint(response)\n\n            '})})]})]})})]})]})})})})},eA=t(33509),eC=t(30569);let{Sider:eI}=eA.default;var eP=e=>{let{setPage:s,userRole:t,defaultSelectedKey:n}=e;return"Admin Viewer"==t?(0,l.jsx)(eA.default,{style:{minHeight:"100vh",maxWidth:"120px"},children:(0,l.jsx)(eI,{width:120,children:(0,l.jsxs)(eC.Z,{mode:"inline",defaultSelectedKeys:n||["4"],style:{height:"100%",borderRight:0},children:[(0,l.jsx)(eC.Z.Item,{onClick:()=>s("api-keys"),children:"API Keys"},"4"),(0,l.jsx)(eC.Z.Item,{onClick:()=>s("models"),children:"Models"},"2"),(0,l.jsx)(eC.Z.Item,{onClick:()=>s("llm-playground"),children:"Chat UI"},"3"),(0,l.jsx)(eC.Z.Item,{onClick:()=>s("usage"),children:"Usage"},"1")]})})}):(0,l.jsx)(eA.default,{style:{minHeight:"100vh",maxWidth:"120px"},children:(0,l.jsx)(eI,{width:120,children:(0,l.jsxs)(eC.Z,{mode:"inline",defaultSelectedKeys:n||["1"],style:{height:"100%",borderRight:0},children:[(0,l.jsx)(eC.Z.Item,{onClick:()=>s("api-keys"),children:"API Keys"},"1"),(0,l.jsx)(eC.Z.Item,{onClick:()=>s("models"),children:"Models"},"2"),(0,l.jsx)(eC.Z.Item,{onClick:()=>s("llm-playground"),children:"Chat UI"},"3"),(0,l.jsx)(eC.Z.Item,{onClick:()=>s("usage"),children:"Usage"},"4"),"Admin"==t?(0,l.jsx)(eC.Z.Item,{onClick:()=>s("users"),children:"Users"},"5"):null,"Admin"==t?(0,l.jsx)(eC.Z.Item,{onClick:()=>s("teams"),children:"Teams"},"6"):null,"Admin"==t?(0,l.jsx)(eC.Z.Item,{onClick:()=>s("admin-panel"),children:"Admin"},"7"):null]})})})},eT=e=>{let{accessToken:s,token:t,userRole:r,userID:a}=e,o=new Date,[i,c]=(0,n.useState)([]),[d,h]=(0,n.useState)([]),[m,u]=(0,n.useState)([]),[x,p]=(0,n.useState)([]),j=new Date(o.getFullYear(),o.getMonth(),1),f=new Date(o.getFullYear(),o.getMonth()+1,0),_=v(j),b=v(f);function v(e){let s=e.getFullYear(),t=e.getMonth()+1,l=e.getDate();return"".concat(s,"-").concat(t<10?"0"+t:t,"-").concat(l<10?"0"+l:l)}return console.log("Start date is ".concat(_)),console.log("End date is ".concat(b)),(0,n.useEffect)(()=>{s&&t&&r&&a&&(async()=>{try{if(console.log("user role: ".concat(r)),"Admin"==r||"Admin Viewer"==r){let e=await Z(s);c(e);let t=(await y(s)).map(e=>({key:(e.key_name||e.key_alias||e.api_key).substring(0,7),spend:e.total_spend}));h(t);let l=(await w(s)).map(e=>({key:e.model,spend:e.total_spend}));u(l)}else"App Owner"==r&&await g(s,t,r,a,_,b).then(async e=>{if(console.log("result from spend logs call",e),"daily_spend"in e){let s=e.daily_spend;console.log("daily spend",s),c(s);let t=e.top_api_keys;h(t)}else{let t=(await k(s,function(e){let s=[];e.forEach(e=>{Object.entries(e).forEach(e=>{let[t,l]=e;"spend"!==t&&"startTime"!==t&&"models"!==t&&"users"!==t&&s.push({key:t,spend:l})})}),s.sort((e,s)=>Number(s.spend)-Number(e.spend));let t=s.slice(0,5).map(e=>e.key);return console.log("topKeys: ".concat(Object.keys(t[0]))),t}(e))).info.map(e=>({key:(e.key_name||e.key_alias||e.token).substring(0,7),spend:e.spend}));h(t),p(function(e){let s={};e.forEach(e=>{Object.entries(e.users).forEach(e=>{let[t,l]=e;""!==t&&null!=t&&"None"!=t&&(s[t]||(s[t]=0),s[t]+=l)})});let t=Object.entries(s).map(e=>{let[s,t]=e;return{user_id:s,spend:t}});t.sort((e,s)=>s.spend-e.spend);let l=t.slice(0,5);return console.log("topKeys: ".concat(Object.values(l[0]))),l}(e)),c(e)}})}catch(e){console.error("There was an error fetching the data",e)}})()},[s,t,r,a,_,b]),(0,l.jsx)("div",{style:{width:"100%"},children:(0,l.jsxs)(T.Z,{numItems:2,className:"gap-2 p-10 h-[75vh] w-full",children:[(0,l.jsx)(P.Z,{numColSpan:2,children:(0,l.jsxs)(B.Z,{children:[(0,l.jsx)(Q.Z,{children:"Monthly Spend"}),(0,l.jsx)(H.Z,{data:i,index:"date",categories:["spend"],colors:["blue"],valueFormatter:e=>"$ ".concat(new Intl.NumberFormat("us").format(e).toString()),yAxisWidth:100,tickGap:5})]})}),(0,l.jsx)(P.Z,{numColSpan:1,children:(0,l.jsxs)(B.Z,{children:[(0,l.jsx)(Q.Z,{children:"Top API Keys"}),(0,l.jsx)(H.Z,{className:"mt-4 h-40",data:d,index:"key",categories:["spend"],colors:["blue"],yAxisWidth:80,tickGap:5,layout:"vertical",showXAxis:!1,showLegend:!1})]})}),(0,l.jsx)(P.Z,{numColSpan:1,children:(0,l.jsxs)(B.Z,{children:[(0,l.jsx)(Q.Z,{children:"Top Users"}),(0,l.jsx)(H.Z,{className:"mt-4 h-40",data:x,index:"user_id",categories:["spend"],colors:["blue"],yAxisWidth:200,layout:"vertical",showXAxis:!1,showLegend:!1})]})}),(0,l.jsx)(P.Z,{numColSpan:1,children:(0,l.jsxs)(B.Z,{children:[(0,l.jsx)(Q.Z,{children:"Top Models"}),(0,l.jsx)(H.Z,{className:"mt-4 h-40",data:m,index:"key",categories:["spend"],colors:["blue"],yAxisWidth:200,layout:"vertical",showXAxis:!1,showLegend:!1})]})})]})})},eE=()=>{let{Title:e,Paragraph:s}=el.default,[t,a]=(0,n.useState)(""),[o,c]=(0,n.useState)(null),[d,h]=(0,n.useState)(null),[m,u]=(0,n.useState)(null),[x,p]=(0,n.useState)(!0),j=(0,r.useSearchParams)(),g=j.get("userID"),Z=j.get("token"),[y,f]=(0,n.useState)("api-keys"),[w,k]=(0,n.useState)(null);return(0,n.useEffect)(()=>{if(Z){let e=(0,eo.o)(Z);if(e){if(console.log("Decoded token:",e),console.log("Decoded key:",e.key),k(e.key),e.user_role){let s=function(e){if(!e)return"Undefined Role";switch(console.log("Received user role: ".concat(e.toLowerCase())),console.log("Received user role length: ".concat(e.toLowerCase().length)),e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"app_user":return"App User";default:return"Unknown Role"}}(e.user_role);console.log("Decoded user_role:",s),a(s),"Admin Viewer"==s&&f("usage")}else console.log("User role not defined");e.user_email?c(e.user_email):console.log("User Email is not set ".concat(e)),e.login_method?p("username_password"==e.login_method):console.log("User Email is not set ".concat(e))}}},[Z]),(0,l.jsx)(n.Suspense,{fallback:(0,l.jsx)("div",{children:"Loading..."}),children:(0,l.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,l.jsx)(i,{userID:g,userRole:t,userEmail:o,showSSOBanner:x}),(0,l.jsxs)("div",{className:"flex flex-1 overflow-auto",children:[(0,l.jsx)(eP,{setPage:f,userRole:t,defaultSelectedKey:null}),"api-keys"==y?(0,l.jsx)(ei,{userID:g,userRole:t,teams:d,keys:m,setUserRole:a,userEmail:o,setUserEmail:c,setTeams:h,setKeys:u}):"models"==y?(0,l.jsx)(em,{userID:g,userRole:t,token:Z,accessToken:w}):"llm-playground"==y?(0,l.jsx)(eN,{userID:g,userRole:t,token:Z,accessToken:w}):"users"==y?(0,l.jsx)(ef,{userID:g,userRole:t,token:Z,keys:m,accessToken:w,setKeys:u}):"teams"==y?(0,l.jsx)(ek,{teams:d,setTeams:h,searchParams:j,accessToken:w}):"admin-panel"==y?(0,l.jsx)(e_,{setTeams:h,searchParams:j,accessToken:w}):(0,l.jsx)(eT,{userID:g,userRole:t,token:Z,accessToken:w})]})]})})}}},function(e){e.O(0,[730,971,69,744],function(){return e(e.s=79615)}),_N_E=e.O()}]);