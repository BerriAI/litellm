(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[813],{38502:function(e,t,l){Promise.resolve().then(l.bind(l,42954))},62338:function(e,t,l){"use strict";l.d(t,{v:function(){return s.Z}});var s=l(40278)},16312:function(e,t,l){"use strict";l.d(t,{z:function(){return s.Z}});var s=l(20831)},19130:function(e,t,l){"use strict";l.d(t,{RM:function(){return a.Z},SC:function(){return o.Z},iA:function(){return s.Z},pj:function(){return n.Z},ss:function(){return r.Z},xs:function(){return i.Z}});var s=l(21626),a=l(97214),n=l(28241),r=l(58834),i=l(69552),o=l(71876)},42954:function(e,t,l){"use strict";l.r(t);var s=l(57437),a=l(18143),n=l(80443),r=l(2265);t.default=()=>{let{accessToken:e,token:t,userRole:l,userId:i,premiumUser:o}=(0,n.Z)(),[c,d]=(0,r.useState)([]);return(0,s.jsx)(a.Z,{accessToken:e,token:t,userRole:l,userID:i,keys:c,premiumUser:o})}},39789:function(e,t,l){"use strict";l.d(t,{Z:function(){return i}});var s=l(57437),a=l(2265),n=l(21487),r=l(84264),i=e=>{let{value:t,onValueChange:l,label:i="Select Time Range",className:o="",showTimeRange:c=!0}=e,[d,u]=(0,a.useState)(!1),x=(0,a.useRef)(null),m=(0,a.useCallback)(e=>{u(!0),setTimeout(()=>u(!1),1500),l(e),requestIdleCallback(()=>{if(e.from){let t;let s={...e},a=new Date(e.from);t=new Date(e.to?e.to:e.from),a.toDateString(),t.toDateString(),a.setHours(0,0,0,0),t.setHours(23,59,59,999),s.from=a,s.to=t,l(s)}},{timeout:100})},[l]),h=(0,a.useCallback)((e,t)=>{if(!e||!t)return"";let l=e=>e.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0,timeZoneName:"short"});if(e.toDateString()!==t.toDateString())return"".concat(l(e)," - ").concat(l(t));{let l=e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),s=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),a=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZoneName:"short"});return"".concat(l,": ").concat(s," - ").concat(a)}},[]);return(0,s.jsxs)("div",{className:o,children:[i&&(0,s.jsx)(r.Z,{className:"mb-2",children:i}),(0,s.jsxs)("div",{className:"relative w-fit",children:[(0,s.jsx)("div",{ref:x,children:(0,s.jsx)(n.Z,{enableSelect:!0,value:t,onValueChange:m,placeholder:"Select date range",enableClear:!1,style:{zIndex:100}})}),d&&(0,s.jsx)("div",{className:"absolute top-1/2 animate-pulse",style:{left:"calc(100% + 8px)",transform:"translateY(-50%)",zIndex:110},children:(0,s.jsxs)("div",{className:"flex items-center gap-1 text-green-600 text-sm font-medium bg-white px-2 py-1 rounded-full border border-green-200 shadow-sm whitespace-nowrap",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-green-500 text-white rounded-full flex items-center justify-center text-xs",children:"âœ“"}),(0,s.jsx)("span",{className:"text-xs",children:"Selected"})]})})]}),c&&t.from&&t.to&&(0,s.jsx)(r.Z,{className:"mt-2 text-xs text-gray-500",children:h(t.from,t.to)})]})}},4863:function(e,t,l){"use strict";l.d(t,{Z:function(){return g}});var s=l(57437),a=l(2265),n=l(62338),r=l(94292),i=l(19250);let o=e=>{let{key:t,info:l}=e;return{token:t,...l}};var c=l(12322),d=l(89970),u=l(16312),x=l(59872),m=l(44633),h=l(86462),g=e=>{let{topKeys:t,accessToken:l,userID:g,userRole:p,teams:f,premiumUser:j,showTags:v=!1}=e,[y,b]=(0,a.useState)(!1),[w,N]=(0,a.useState)(null),[k,S]=(0,a.useState)(void 0),[_,C]=(0,a.useState)("table"),[Z,D]=(0,a.useState)(new Set),E=e=>{D(t=>{let l=new Set(t);return l.has(e)?l.delete(e):l.add(e),l})},T=async e=>{if(l)try{let t=await (0,i.keyInfoV1Call)(l,e.api_key),s=o(t);S(s),N(e.api_key),b(!0)}catch(e){console.error("Error fetching key info:",e)}},V=()=>{b(!1),N(null),S(void 0)};a.useEffect(()=>{let e=e=>{"Escape"===e.key&&y&&V()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[y]);let R=[{header:"Key ID",accessorKey:"api_key",cell:e=>(0,s.jsx)("div",{className:"overflow-hidden",children:(0,s.jsx)(d.Z,{title:e.getValue(),children:(0,s.jsx)(u.z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>T(e.row.original),children:e.getValue()?"".concat(e.getValue().slice(0,7),"..."):"-"})})})},{header:"Key Alias",accessorKey:"key_alias",cell:e=>e.getValue()||"-"}],L={header:"Spend (USD)",accessorKey:"spend",cell:e=>{let t=e.getValue();return t>0&&t<.01?"<$0.01":"$".concat((0,x.pw)(t,2))}},I=v?[...R,{header:"Tags",accessorKey:"tags",cell:e=>{let t=e.getValue(),l=e.row.original.api_key,a=Z.has(l);if(!t||0===t.length)return"-";let n=t.sort((e,t)=>t.usage-e.usage),r=a?n:n.slice(0,2),i=t.length>2;return(0,s.jsx)("div",{className:"overflow-hidden",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-1",children:[r.map((e,t)=>(0,s.jsx)(d.Z,{title:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-300",children:"Tag Name:"})," ",e.tag]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-300",children:"Spend:"})," ",e.usage>0&&e.usage<.01?"<$0.01":"$".concat((0,x.pw)(e.usage,2))]})]}),children:(0,s.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[e.tag.slice(0,7),"..."]})},t)),i&&(0,s.jsx)("button",{onClick:()=>E(l),className:"ml-1 p-1 hover:bg-gray-200 rounded-full transition-colors",title:a?"Show fewer tags":"Show all tags",children:a?(0,s.jsx)(m.Z,{className:"h-3 w-3 text-gray-500"}):(0,s.jsx)(h.Z,{className:"h-3 w-3 text-gray-500"})})]})})}},L]:[...R,L],M=t.map(e=>({...e,display_key_alias:e.key_alias&&e.key_alias.length>10?"".concat(e.key_alias.slice(0,10),"..."):e.key_alias||"-"}));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-4 flex justify-end items-center",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>C("table"),className:"px-3 py-1 text-sm rounded-md ".concat("table"===_?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"Table View"}),(0,s.jsx)("button",{onClick:()=>C("chart"),className:"px-3 py-1 text-sm rounded-md ".concat("chart"===_?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"Chart View"})]})}),"chart"===_?(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)(n.v,{className:"mt-4 h-40 cursor-pointer hover:opacity-90",data:M,index:"display_key_alias",categories:["spend"],colors:["cyan"],yAxisWidth:120,tickGap:5,layout:"vertical",showLegend:!1,valueFormatter:e=>"$".concat((0,x.pw)(e,2)),onValueChange:e=>T(e),showTooltip:!0,customTooltip:e=>{var t,l;let a=null===(l=e.payload)||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:t.payload;return(0,s.jsx)("div",{className:"relative z-50 p-3 bg-black/90 shadow-lg rounded-lg text-white max-w-xs",children:(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"text-gray-300",children:"Key Alias: "}),(0,s.jsx)("span",{className:"font-mono text-gray-100 break-all",children:null==a?void 0:a.key_alias})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"text-gray-300",children:"Key ID: "}),(0,s.jsx)("span",{className:"font-mono text-gray-100 break-all",children:null==a?void 0:a.api_key})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("span",{className:"text-gray-300",children:"Spend: "}),(0,s.jsxs)("span",{className:"text-white font-medium",children:["$",(0,x.pw)(null==a?void 0:a.spend,2)]})]})]})})}})}):(0,s.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,s.jsx)(c.w,{columns:I,data:t,renderSubComponent:()=>(0,s.jsx)(s.Fragment,{}),getRowCanExpand:()=>!1,isLoading:!1})}),y&&w&&k&&(console.log("Rendering modal with:",{isModalOpen:y,selectedKey:w,keyData:k}),(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&V()},children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl relative w-11/12 max-w-6xl max-h-[90vh] overflow-y-auto min-h-[750px]",children:[(0,s.jsx)("button",{onClick:V,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,s.jsx)("div",{className:"p-6 h-full",children:(0,s.jsx)(r.Z,{keyId:w,onClose:V,keyData:k,accessToken:l,userID:g,userRole:p,teams:f,premiumUser:j})})]})}))]})}},12322:function(e,t,l){"use strict";l.d(t,{w:function(){return o}});var s=l(57437),a=l(2265),n=l(71594),r=l(24525),i=l(19130);function o(e){let{data:t=[],columns:l,getRowCanExpand:o,renderSubComponent:c,isLoading:d=!1,loadingMessage:u="\uD83D\uDE85 Loading logs...",noDataMessage:x="No logs found"}=e,m=(0,n.b7)({data:t,columns:l,getRowCanExpand:o,getRowId:(e,t)=>{var l;return null!==(l=null==e?void 0:e.request_id)&&void 0!==l?l:String(t)},getCoreRowModel:(0,r.sC)(),getExpandedRowModel:(0,r.rV)()});return(0,s.jsx)("div",{className:"rounded-lg custom-border overflow-x-auto w-full max-w-full box-border",children:(0,s.jsxs)(i.iA,{className:"[&_td]:py-0.5 [&_th]:py-1 table-fixed w-full box-border",style:{minWidth:"400px"},children:[(0,s.jsx)(i.ss,{children:m.getHeaderGroups().map(e=>(0,s.jsx)(i.SC,{children:e.headers.map(e=>(0,s.jsx)(i.xs,{className:"py-1 h-8",children:e.isPlaceholder?null:(0,n.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(i.RM,{children:d?(0,s.jsx)(i.SC,{children:(0,s.jsx)(i.pj,{colSpan:l.length,className:"h-8 text-center",children:(0,s.jsx)("div",{className:"text-center text-gray-500",children:(0,s.jsx)("p",{children:u})})})}):m.getRowModel().rows.length>0?m.getRowModel().rows.map(e=>(0,s.jsxs)(a.Fragment,{children:[(0,s.jsx)(i.SC,{className:"h-8",children:e.getVisibleCells().map(e=>(0,s.jsx)(i.pj,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,n.ie)(e.column.columnDef.cell,e.getContext())},e.id))}),e.getIsExpanded()&&(0,s.jsx)(i.SC,{children:(0,s.jsx)(i.pj,{colSpan:e.getVisibleCells().length,className:"p-0",children:(0,s.jsx)("div",{className:"w-full max-w-full overflow-hidden box-border",children:c({row:e})})})})]},e.id)):(0,s.jsx)(i.SC,{children:(0,s.jsx)(i.pj,{colSpan:l.length,className:"h-8 text-center",children:(0,s.jsx)("div",{className:"text-center text-gray-500",children:(0,s.jsx)("p",{children:x})})})})})]})})}},47375:function(e,t,l){"use strict";var s=l(57437),a=l(2265),n=l(19250),r=l(59872);t.Z=e=>{let{userID:t,userRole:l,accessToken:i,userSpend:o,userMaxBudget:c,selectedTeam:d}=e;console.log("userSpend: ".concat(o));let[u,x]=(0,a.useState)(null!==o?o:0),[m,h]=(0,a.useState)(d?Number((0,r.pw)(d.max_budget,4)):null);(0,a.useEffect)(()=>{if(d){if("Default Team"===d.team_alias)h(c);else{let e=!1;if(d.team_memberships)for(let l of d.team_memberships)l.user_id===t&&"max_budget"in l.litellm_budget_table&&null!==l.litellm_budget_table.max_budget&&(h(l.litellm_budget_table.max_budget),e=!0);e||h(d.max_budget)}}},[d,c]);let[g,p]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=async()=>{if(!i||!t||!l)return};(async()=>{try{if(null===t||null===l)return;if(null!==i){let e=(await (0,n.modelAvailableCall)(i,t,l)).data.map(e=>e.id);console.log("available_model_names:",e),p(e)}}catch(e){console.error("Error fetching user models:",e)}})(),e()},[l,i,t]),(0,a.useEffect)(()=>{null!==o&&x(o)},[o]);let f=[];d&&d.models&&(f=d.models),f&&f.includes("all-proxy-models")?(console.log("user models:",g),f=g):f&&f.includes("all-team-models")?f=d.models:f&&0===f.length&&(f=g);let j=null!==m?"$".concat((0,r.pw)(Number(m),4)," limit"):"No limit",v=void 0!==u?(0,r.pw)(u,4):null;return console.log("spend in view user spend: ".concat(u)),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("div",{className:"flex justify-between gap-x-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content",children:"Total Spend"}),(0,s.jsxs)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:["$",v]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content",children:"Max Budget"}),(0,s.jsx)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:j})]})]})})}}},function(e){e.O(0,[1114,1491,4556,2417,2926,1529,3709,2409,2525,3603,2284,7908,9011,9678,5319,7519,7996,7281,395,2344,1487,7732,1160,6294,8049,131,2202,874,4292,8143,2971,2117,1744],function(){return e(e.s=38502)}),_N_E=e.O()}]);