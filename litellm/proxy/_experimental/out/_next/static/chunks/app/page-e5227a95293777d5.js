(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8598:function(e,t,l){Promise.resolve().then(l.t.bind(l,5250,23)),Promise.resolve().then(l.bind(l,3239))},3239:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return F}});var r=l(3827),s=l(4090),a=l(588);let n=async(e,t,l)=>{try{if(console.log("Form Values in keyCreateCall:",l),l.metadata)try{l.metadata=JSON.parse(l.metadata)}catch(e){a.ZP.error("Failed to parse metadata: "+e)}let r=await fetch("/key/generate",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({user_id:t,...l})});if(!r.ok){let e=await r.text();throw a.ZP.error("Failed to create key: "+e),console.error("Error response from the server:",e),Error("Network response was not ok")}let s=await r.json();return console.log("API Response:",s),s}catch(e){throw console.error("Failed to create key:",e),e}},o=async(e,t)=>{try{console.log("in keyDeleteCall:",t);let l=await fetch("/key/delete",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({keys:[t]})});if(!l.ok){let e=await l.text();throw a.ZP.error("Failed to delete key: "+e),Error("Network response was not ok")}let r=await l.json();return console.log(r),a.ZP.success("API Key Deleted"),r}catch(e){throw console.error("Failed to create key:",e),e}},i=async(e,t)=>{try{let l="/user/info";console.log("in userInfoCall:",l);let r=await fetch("".concat(l,"/?user_id=").concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!r.ok){let e=await r.text();throw a.ZP.error(e),Error("Network response was not ok")}let s=await r.json();return console.log(s),s}catch(e){throw console.error("Failed to create key:",e),e}};var c=l(384),d=l(6453),h=l(2179),u=l(1801),x=l(6776),m=l(2902),j=l(7171),y=l(9714),Z=l(8707),p=l(1861);let{Option:k}=x.default;var g=e=>{let{userID:t,accessToken:l,data:o,setData:i}=e,[x]=m.Z.useForm(),[k,g]=(0,s.useState)(!1),[f,w]=(0,s.useState)(null),b=()=>{g(!1),x.resetFields()},C=()=>{g(!1),w(null),x.resetFields()},S=async e=>{try{a.ZP.info("Making API Call"),e.models&&""!==e.models.trim()?e.models=e.models.split(",").map(e=>e.trim()):e.models=[],g(!0);let r=await n(l,t,e);i(e=>e?[...e,r]:[r]),w(r.key),a.ZP.success("API Key Created"),x.resetFields()}catch(e){console.error("Error creating the key:",e)}};return(0,r.jsxs)("div",{children:[(0,r.jsx)(h.Z,{className:"mx-auto",onClick:()=>g(!0),children:"+ Create New Key"}),(0,r.jsx)(j.Z,{title:"Create Key",visible:k,width:800,footer:null,onOk:b,onCancel:C,children:(0,r.jsxs)(m.Z,{form:x,onFinish:S,labelCol:{span:6},wrapperCol:{span:16},labelAlign:"left",children:[(0,r.jsx)(m.Z.Item,{label:"Key Name",name:"key_alias",children:(0,r.jsx)(y.Z,{})}),(0,r.jsx)(m.Z.Item,{label:"Models (Comma Separated). Eg: gpt-3.5-turbo,gpt-4",name:"models",children:(0,r.jsx)(y.Z,{placeholder:"gpt-4,gpt-3.5-turbo"})}),(0,r.jsx)(m.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,r.jsx)(Z.Z,{step:.01,precision:2,width:200})}),(0,r.jsx)(m.Z.Item,{label:"Duration (eg: 30s, 30h, 30d)",name:"duration",children:(0,r.jsx)(y.Z,{})}),(0,r.jsx)(m.Z.Item,{label:"Team ID",name:"team_id",children:(0,r.jsx)(y.Z,{placeholder:"ai_team"})}),(0,r.jsx)(m.Z.Item,{label:"Metadata",name:"metadata",children:(0,r.jsx)(y.Z.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,r.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,r.jsx)(p.ZP,{htmlType:"submit",children:"Create Key"})})]})}),f&&(0,r.jsx)(j.Z,{title:"Save your key",visible:k,onOk:b,onCancel:C,footer:null,children:(0,r.jsxs)(d.Z,{numItems:1,className:"gap-2 w-full",children:[(0,r.jsx)(c.Z,{numColSpan:1,children:(0,r.jsxs)("p",{children:["Please save this secret key somewhere safe and accessible. For security reasons, ",(0,r.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,r.jsx)(c.Z,{numColSpan:1,children:null!=f?(0,r.jsxs)(u.Z,{children:["API Key: ",f]}):(0,r.jsx)(u.Z,{children:"Key being created, this might take 30s"})})]})})]})},f=l(3393),w=l(3810),b=l(1244),C=l(827),S=l(3851),I=l(2044),N=l(4167),P=l(4480),E=l(2287),_=l(2440),v=e=>{let{userID:t,accessToken:l,data:s,setData:a}=e,n=async e=>{if(null!=s)try{await o(l,e);let t=s.filter(t=>t.token!==e);a(t)}catch(e){console.error("Error deleting the key:",e)}};if(null!=s)return console.log("RERENDER TRIGGERED"),(0,r.jsxs)(w.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh] mb-4",children:[(0,r.jsx)(_.Z,{children:"API Keys"}),(0,r.jsxs)(C.Z,{className:"mt-5",children:[(0,r.jsx)(N.Z,{children:(0,r.jsxs)(E.Z,{children:[(0,r.jsx)(P.Z,{children:"Key Alias"}),(0,r.jsx)(P.Z,{children:"Secret Key"}),(0,r.jsx)(P.Z,{children:"Spend (USD)"}),(0,r.jsx)(P.Z,{children:"Key Budget (USD)"}),(0,r.jsx)(P.Z,{children:"Team ID"}),(0,r.jsx)(P.Z,{children:"Metadata"}),(0,r.jsx)(P.Z,{children:"Expires"})]})}),(0,r.jsx)(S.Z,{children:s.map(e=>(console.log(e),"litellm-dashboard"===e.team_id)?null:(0,r.jsxs)(E.Z,{children:[(0,r.jsx)(I.Z,{children:null!=e.key_alias?(0,r.jsx)(u.Z,{children:e.key_alias}):(0,r.jsx)(u.Z,{children:"Not Set"})}),(0,r.jsx)(I.Z,{children:(0,r.jsx)(u.Z,{children:e.key_name})}),(0,r.jsx)(I.Z,{children:(0,r.jsx)(u.Z,{children:e.spend})}),(0,r.jsx)(I.Z,{children:null!=e.max_budget?(0,r.jsx)(u.Z,{children:e.max_budget}):(0,r.jsx)(u.Z,{children:"Unlimited Budget"})}),(0,r.jsx)(I.Z,{children:(0,r.jsx)(u.Z,{children:e.team_id})}),(0,r.jsx)(I.Z,{children:(0,r.jsx)(u.Z,{children:JSON.stringify(e.metadata)})}),(0,r.jsx)(I.Z,{children:null!=e.expires?(0,r.jsx)(u.Z,{children:e.expires}):(0,r.jsx)(u.Z,{children:"Never expires"})}),(0,r.jsx)(I.Z,{children:(0,r.jsx)(b.Z,{onClick:()=>n(e.token),icon:f.Z,size:"xs"})})]},e.token))})]})]})},D=l(7907),T=l(7963),F=()=>{let[e,t]=(0,s.useState)(null),l=(0,D.useSearchParams)(),a=l.get("userID"),n=l.get("token"),[o,h]=(0,s.useState)(null);if((0,s.useEffect)(()=>{if(n){let e=(0,T.o)(n);e&&(console.log("Decoded token:",e),console.log("Decoded key:",e.key),h(e.key))}a&&o&&!e&&(async()=>{try{let e=await i(o,a);t(e.keys)}catch(e){console.error("There was an error fetching the data",e)}})()},[a,n,o,e]),null==a||null==n){let e="/sso/key/generate";return console.log("Full URL:",e),window.location.href=e,null}return null==o?null:(0,r.jsx)(d.Z,{numItems:1,className:"gap-0 p-10 h-[75vh] w-full",children:(0,r.jsxs)(c.Z,{numColSpan:1,children:[(0,r.jsx)(v,{userID:a,accessToken:o,data:e,setData:t}),(0,r.jsx)(g,{userID:a,accessToken:o,data:e,setData:t})]})})}}},function(e){e.O(0,[448,971,69,744],function(){return e(e.s=8598)}),_N_E=e.O()}]);