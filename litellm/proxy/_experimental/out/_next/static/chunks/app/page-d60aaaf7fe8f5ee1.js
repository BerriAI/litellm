(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1900:function(e,s,t){Promise.resolve().then(t.bind(t,95851))},12011:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return _}});var l=t(57437),a=t(2265),r=t(99376),n=t(20831),i=t(94789),o=t(12514),c=t(49804),d=t(67101),m=t(84264),u=t(49566),h=t(96761),x=t(84566),p=t(19250),g=t(14474),j=t(13634),f=t(73002),v=t(3914);function _(){let[e]=j.Z.useForm(),s=(0,r.useSearchParams)();(0,v.e)("token");let t=s.get("invitation_id"),_=s.get("action"),[y,b]=(0,a.useState)(null),[N,Z]=(0,a.useState)(""),[w,k]=(0,a.useState)(""),[S,C]=(0,a.useState)(null),[I,P]=(0,a.useState)(""),[A,T]=(0,a.useState)(""),[E,L]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(0,p.MO)().then(e=>{console.log("ui config in onboarding.tsx:",e),L(!1)})},[]),(0,a.useEffect)(()=>{t&&!E&&(0,p.W_)(t).then(e=>{let s=e.login_url;console.log("login_url:",s),P(s);let t=e.token,l=(0,g.o)(t);T(t),console.log("decoded:",l),b(l.key),console.log("decoded user email:",l.user_email),k(l.user_email),C(l.user_id)})},[t,E]),(0,l.jsx)("div",{className:"mx-auto w-full max-w-md mt-10",children:(0,l.jsxs)(o.Z,{children:[(0,l.jsx)(h.Z,{className:"text-sm mb-5 text-center",children:"\uD83D\uDE85 LiteLLM"}),(0,l.jsx)(h.Z,{className:"text-xl",children:"reset_password"===_?"Reset Password":"Sign up"}),(0,l.jsx)(m.Z,{children:"reset_password"===_?"Reset your password to access Admin UI.":"Claim your user account to login to Admin UI."}),"reset_password"!==_&&(0,l.jsx)(i.Z,{className:"mt-4",title:"SSO",icon:x.GH$,color:"sky",children:(0,l.jsxs)(d.Z,{numItems:2,className:"flex justify-between items-center",children:[(0,l.jsx)(c.Z,{children:"SSO is under the Enterprise Tier."}),(0,l.jsx)(c.Z,{children:(0,l.jsx)(n.Z,{variant:"primary",className:"mb-2",children:(0,l.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"Get Free Trial"})})})]})}),(0,l.jsxs)(j.Z,{className:"mt-10 mb-5 mx-auto",layout:"vertical",onFinish:e=>{console.log("in handle submit. accessToken:",y,"token:",A,"formValues:",e),y&&A&&(e.user_email=w,S&&t&&(0,p.m_)(y,t,S,e.password).then(e=>{let s="/ui/";s+="?login=success",document.cookie="token="+A,console.log("redirecting to:",s);let t=(0,p.zX)();console.log("proxyBaseUrl:",t),t?window.location.href=t+s:window.location.href=s}))},children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.Z.Item,{label:"Email Address",name:"user_email",children:(0,l.jsx)(u.Z,{type:"email",disabled:!0,value:w,defaultValue:w,className:"max-w-md"})}),(0,l.jsx)(j.Z.Item,{label:"Password",name:"password",rules:[{required:!0,message:"password required to sign up"}],help:"reset_password"===_?"Enter your new password":"Create a password for your account",children:(0,l.jsx)(u.Z,{placeholder:"",type:"password",className:"max-w-md"})})]}),(0,l.jsx)("div",{className:"mt-10",children:(0,l.jsx)(f.ZP,{htmlType:"submit",children:"reset_password"===_?"Reset Password":"Sign Up"})})]})]})})}},95851:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return n6}});var l,a,r,n,i,o,c,d,m,u,h=t(57437),x=t(2265),p=t(99376),g=t(14474),j=t(21623),f=t(29827),v=t(27648),_=t(80795),y=t(19250),b=t(15883),N=t(40428),Z=t(3914);let w=async e=>{if(!e)return null;try{return await (0,y.g)(e)}catch(e){return console.error("Error fetching proxy settings:",e),null}};var k=e=>{let{userID:s,userEmail:t,userRole:l,premiumUser:a,proxySettings:r,setProxySettings:n,accessToken:i}=e,o=(0,y.zX)(),[c,d]=(0,x.useState)("");(0,x.useEffect)(()=>{(async()=>{if(i){let e=await w(i);console.log("response from fetchProxySettings",e),e&&n(e)}})()},[i]),(0,x.useEffect)(()=>{d((null==r?void 0:r.PROXY_LOGOUT_URL)||"")},[r]);let m=[{key:"1",label:(0,h.jsxs)("div",{className:"py-1",children:[(0,h.jsxs)("p",{className:"text-sm text-gray-600",children:["Role: ",l]}),(0,h.jsxs)("p",{className:"text-sm text-gray-600",children:["Email: ",t||"Unknown"]}),(0,h.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,h.jsx)(b.Z,{})," ",s]}),(0,h.jsxs)("p",{className:"text-sm text-gray-600",children:["Premium User: ",String(a)]})]})},{key:"2",label:(0,h.jsxs)("p",{className:"text-sm hover:text-gray-900",onClick:()=>{(0,Z.b)(),window.location.href=c},children:[(0,h.jsx)(N.Z,{})," Logout"]})}];return(0,h.jsx)("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:(0,h.jsx)("div",{className:"w-full",children:(0,h.jsxs)("div",{className:"flex items-center h-12 px-4",children:[(0,h.jsx)("div",{className:"flex items-center flex-shrink-0",children:(0,h.jsx)(v.default,{href:"/",className:"flex items-center",children:(0,h.jsx)("img",{src:o+"/get_image",alt:"LiteLLM Brand",className:"h-8 w-auto"})})}),(0,h.jsxs)("div",{className:"flex items-center space-x-5 ml-auto",children:[(0,h.jsx)("a",{href:"https://docs.litellm.ai/docs/",target:"_blank",rel:"noopener noreferrer",className:"text-[13px] text-gray-600 hover:text-gray-900 transition-colors",children:"Docs"}),(0,h.jsx)(_.Z,{menu:{items:m,style:{padding:"4px",marginTop:"4px"}},children:(0,h.jsxs)("button",{className:"inline-flex items-center text-[13px] text-gray-600 hover:text-gray-900 transition-colors",children:["User",(0,h.jsx)("svg",{className:"ml-1 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 9l-7 7-7-7"})})]})})]})]})})})};let S=async(e,s,t,l,a)=>{let r;r="Admin"!=t&&"Admin Viewer"!=t?await (0,y.It)(e,(null==l?void 0:l.organization_id)||null,s):await (0,y.It)(e,(null==l?void 0:l.organization_id)||null),console.log("givenTeams: ".concat(r)),a(r)};var C=t(49804),I=t(67101),P=t(20831),A=t(49566),T=t(87452),E=t(88829),L=t(72208),O=t(84264),M=t(96761),D=t(29233),F=t(52787),R=t(13634),z=t(41021),q=t(91679),U=t(29967),V=t(73002),K=t(64482),B=t(30150),H=e=>{let{step:s=.01,style:t={width:"100%"},placeholder:l="Enter a numerical value",min:a,max:r,onChange:n,...i}=e;return(0,h.jsx)(B.Z,{onWheel:e=>e.currentTarget.blur(),step:s,style:t,placeholder:l,min:a,max:r,onChange:n,...i})};let G=async(e,s,t)=>{try{if(null===e||null===s)return;if(null!==t){let l=(await (0,y.So)(t,e,s,!0,null,!0)).data.map(e=>e.id),a=[],r=[];return l.forEach(e=>{e.endsWith("/*")?a.push(e):r.push(e)}),[...a,...r]}}catch(e){console.error("Error fetching user models:",e)}},J=e=>{if(e.endsWith("/*")){let s=e.replace("/*","");return"All ".concat(s," models")}return e},Y=(e,s)=>{let t=[],l=[];return console.log("teamModels",e),console.log("allModels",s),e.forEach(e=>{if(e.endsWith("/*")){let a=e.replace("/*",""),r=s.filter(e=>e.startsWith(a+"/"));l.push(...r),t.push(e)}else l.push(e)}),[...t,...l].filter((e,s,t)=>t.indexOf(e)===s)};var W=t(20577),$=t(15424),X=t(89970);let Q=(e,s)=>["metadata","config","enforced_params","aliases"].includes(e)||"json"===s.format,ee=e=>{if(!e)return!0;try{return JSON.parse(e),!0}catch(e){return!1}},es=(e,s,t)=>{let l={max_budget:"Enter maximum budget in USD (e.g., 100.50)",budget_duration:"Select a time period for budget reset",tpm_limit:"Enter maximum tokens per minute (whole number)",rpm_limit:"Enter maximum requests per minute (whole number)",duration:"Enter duration (e.g., 30s, 24h, 7d)",metadata:'Enter JSON object with key-value pairs\nExample: {"team": "research", "project": "nlp"}',config:'Enter configuration as JSON object\nExample: {"setting": "value"}',permissions:"Enter comma-separated permission strings",enforced_params:'Enter parameters as JSON object\nExample: {"param": "value"}',blocked:"Enter true/false or specific block conditions",aliases:'Enter aliases as JSON object\nExample: {"alias1": "value1", "alias2": "value2"}',models:"Select one or more model names",key_alias:"Enter a unique identifier for this key",tags:"Enter comma-separated tag strings"}[e]||({string:"Text input",number:"Numeric input",integer:"Whole number input",boolean:"True/False value"})[t]||"Text input";return Q(e,s)?"".concat(l,"\nMust be valid JSON format"):s.enum?"Select from available options\nAllowed values: ".concat(s.enum.join(", ")):l};var et=e=>{let{schemaComponent:s,excludedFields:t=[],form:l,overrideLabels:a={},overrideTooltips:r={},customValidation:n={},defaultValues:i={}}=e,[o,c]=(0,x.useState)(null),[d,m]=(0,x.useState)(null);(0,x.useEffect)(()=>{(async()=>{try{let e=(await (0,y.lP)()).components.schemas[s];if(!e)throw Error('Schema component "'.concat(s,'" not found'));c(e);let a={};Object.keys(e.properties).filter(e=>!t.includes(e)&&void 0!==i[e]).forEach(e=>{a[e]=i[e]}),l.setFieldsValue(a)}catch(e){console.error("Schema fetch error:",e),m(e instanceof Error?e.message:"Failed to fetch schema")}})()},[s,l,t]);let u=e=>{if(e.type)return e.type;if(e.anyOf){let s=e.anyOf.map(e=>e.type);if(s.includes("number")||s.includes("integer"))return"number";s.includes("string")}return"string"},p=(e,s)=>{var t;let l;let c=u(s),d=null==o?void 0:null===(t=o.required)||void 0===t?void 0:t.includes(e),m=a[e]||s.title||e,x=r[e]||s.description,p=[];d&&p.push({required:!0,message:"".concat(m," is required")}),n[e]&&p.push({validator:n[e]}),Q(e,s)&&p.push({validator:async(e,s)=>{if(s&&!ee(s))throw Error("Please enter valid JSON")}});let g=x?(0,h.jsxs)("span",{children:[m," ",(0,h.jsx)(X.Z,{title:x,children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}):m;return l=Q(e,s)?(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:"Enter as JSON",className:"font-mono"}):s.enum?(0,h.jsx)(F.default,{children:s.enum.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:e},e))}):"number"===c||"integer"===c?(0,h.jsx)(W.Z,{style:{width:"100%"},precision:"integer"===c?0:void 0}):"duration"===e?(0,h.jsx)(A.Z,{placeholder:"eg: 30s, 30h, 30d"}):(0,h.jsx)(A.Z,{placeholder:x||""}),(0,h.jsx)(R.Z.Item,{label:g,name:e,className:"mt-8",rules:p,initialValue:i[e],help:(0,h.jsx)("div",{className:"text-xs text-gray-500",children:es(e,s,c)}),children:l},e)};return d?(0,h.jsxs)("div",{className:"text-red-500",children:["Error: ",d]}):(null==o?void 0:o.properties)?(0,h.jsx)("div",{children:Object.entries(o.properties).filter(e=>{let[s]=e;return!t.includes(s)}).map(e=>{let[s,t]=e;return p(s,t)})}):null},el=e=>{let{onChange:s,value:t,className:l,accessToken:a,placeholder:r="Select vector stores",disabled:n=!1}=e,[i,o]=(0,x.useState)([]),[c,d]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{(async()=>{if(a){d(!0);try{let e=await (0,y.Ou)(a);e.data&&o(e.data)}catch(e){console.error("Error fetching vector stores:",e)}finally{d(!1)}}})()},[a]),(0,h.jsx)("div",{children:(0,h.jsx)(F.default,{mode:"multiple",placeholder:r,onChange:s,value:t,loading:c,className:l,options:i.map(e=>({label:"".concat(e.vector_store_name||e.vector_store_id," (").concat(e.vector_store_id,")"),value:e.vector_store_id,title:e.vector_store_description||e.vector_store_id})),optionFilterProp:"label",showSearch:!0,style:{width:"100%"},disabled:n})})},ea=function(e){let{onChange:s,value:t,accessToken:l,placeholder:a="Select vector stores",premiumUser:r=!1}=e;return r?(0,h.jsx)(el,{onChange:s,value:t,accessToken:l,placeholder:a}):(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[(0,h.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-50 border border-blue-200 text-blue-800 text-sm font-medium opacity-50",children:"✨ premium-vector-store-1"}),(0,h.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-50 border border-blue-200 text-blue-800 text-sm font-medium opacity-50",children:"✨ premium-vector-store-2"})]}),(0,h.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,h.jsxs)(O.Z,{className:"text-sm text-yellow-800",children:["Vector store access control is a LiteLLM Enterprise feature. Get a trial key ",(0,h.jsx)("a",{href:"https://www.litellm.ai/#pricing",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"here"}),"."]})})]})},er=e=>{let{onChange:s,value:t,className:l,accessToken:a,placeholder:r="Select MCP servers",disabled:n=!1}=e,[i,o]=(0,x.useState)([]),[c,d]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{(async()=>{if(a){d(!0);try{let e=await (0,y.U8)(a);e&&Array.isArray(e)?o(e):e.data&&Array.isArray(e.data)&&o(e.data)}catch(e){console.error("Error fetching MCP servers:",e)}finally{d(!1)}}})()},[a]),(0,h.jsx)("div",{children:(0,h.jsx)(F.default,{mode:"multiple",placeholder:r,onChange:s,value:t,loading:c,className:l,options:i.map(e=>({label:"".concat(e.alias," (").concat(e.server_id,")"),value:e.server_id,title:e.description||e.alias})),optionFilterProp:"label",showSearch:!0,style:{width:"100%"},disabled:n})})},en=function(e){let{onChange:s,value:t,accessToken:l,placeholder:a="Select MCP servers",premiumUser:r=!1}=e;return r?(0,h.jsx)(er,{onChange:s,value:t,accessToken:l,placeholder:a}):(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[(0,h.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-purple-50 border border-purple-200 text-purple-800 text-sm font-medium opacity-50",children:"✨ premium-mcp-server-1"}),(0,h.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-purple-50 border border-purple-200 text-purple-800 text-sm font-medium opacity-50",children:"✨ premium-mcp-server-2"})]}),(0,h.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,h.jsxs)(O.Z,{className:"text-sm text-yellow-800",children:["MCP server access control is a LiteLLM Enterprise feature. Get a trial key ",(0,h.jsx)("a",{href:"https://www.litellm.ai/#pricing",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"here"}),"."]})})]})},ei=e=>{let{teams:s,value:t,onChange:l}=e;return(0,h.jsx)(F.default,{showSearch:!0,placeholder:"Search or select a team",value:t,onChange:l,filterOption:(e,t)=>{if(!t)return!1;let l=null==s?void 0:s.find(e=>e.team_id===t.key);if(!l)return!1;let a=e.toLowerCase().trim(),r=(l.team_alias||"").toLowerCase(),n=(l.team_id||"").toLowerCase();return r.includes(a)||n.includes(a)},optionFilterProp:"children",children:null==s?void 0:s.map(e=>(0,h.jsxs)(F.default.Option,{value:e.team_id,children:[(0,h.jsx)("span",{className:"font-medium",children:e.team_alias})," ",(0,h.jsxs)("span",{className:"text-gray-500",children:["(",e.team_id,")"]})]},e.team_id))})},eo=t(12514),ec=t(82182),ed=t(22452),em=t(74998);(l=o||(o={})).Braintrust="Braintrust",l.CustomCallbackAPI="Custom Callback API",l.Datadog="Datagog",l.Langfuse="Langfuse",l.LangSmith="LangSmith",l.Lago="Lago",l.OpenMeter="OpenMeter",l.OTel="Open Telemetry",l.S3="S3",l.Arize="Arize";let eu={Braintrust:"braintrust",CustomCallbackAPI:"custom_callback_api",Datadog:"datadog",Langfuse:"langfuse",LangSmith:"langsmith",Lago:"lago",OpenMeter:"openmeter",OTel:"otel",S3:"s3",Arize:"arize"},eh="/ui/assets/logos/",ex={Langfuse:{logo:"".concat(eh,"langfuse.png"),supports_key_team_logging:!0,dynamic_params:{langfuse_public_key:"text",langfuse_secret_key:"password",langfuse_host:"text"}},Arize:{logo:"".concat(eh,"arize.png"),supports_key_team_logging:!0,dynamic_params:{arize_api_key:"password",arize_space_id:"text"}},LangSmith:{logo:"".concat(eh,"langsmith.png"),supports_key_team_logging:!0,dynamic_params:{langsmith_api_key:"password",langsmith_project:"text",langsmith_base_url:"text"}},Braintrust:{logo:"".concat(eh,"braintrust.png"),supports_key_team_logging:!1,dynamic_params:{}},"Custom Callback API":{logo:"".concat(eh,"custom.svg"),supports_key_team_logging:!1,dynamic_params:{}},Datagog:{logo:"".concat(eh,"datadog.png"),supports_key_team_logging:!1,dynamic_params:{}},Lago:{logo:"".concat(eh,"lago.svg"),supports_key_team_logging:!1,dynamic_params:{}},OpenMeter:{logo:"".concat(eh,"openmeter.png"),supports_key_team_logging:!1,dynamic_params:{}},"Open Telemetry":{logo:"".concat(eh,"otel.png"),supports_key_team_logging:!1,dynamic_params:{}},S3:{logo:"".concat(eh,"aws.svg"),supports_key_team_logging:!1,dynamic_params:{}}},{Option:ep}=F.default;var eg=e=>{let{value:s=[],onChange:t}=e,l=Object.entries(ex).filter(e=>{let[s,t]=e;return t.supports_key_team_logging}).map(e=>{let[s,t]=e;return s}),a=e=>{null==t||t(e)},r=e=>{a(s.filter((s,t)=>t!==e))},n=(e,t,l)=>{let r=[...s];if("callback_name"===t){let s=eu[l]||l;r[e]={...r[e],[t]:s,callback_vars:{}}}else r[e]={...r[e],[t]:l};a(r)},i=(e,t,l)=>{let r=[...s];r[e]={...r[e],callback_vars:{...r[e].callback_vars,[t]:l}},a(r)},o=(e,s)=>{var t,l;if(!e.callback_name)return null;let a=null===(t=Object.entries(eu).find(s=>{let[t,l]=s;return l===e.callback_name}))||void 0===t?void 0:t[0];if(!a)return null;let r=(null===(l=ex[a])||void 0===l?void 0:l.dynamic_params)||{};return 0===Object.keys(r).length?null:(0,h.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-100",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,h.jsx)("div",{className:"w-3 h-3 bg-blue-100 rounded-full flex items-center justify-center",children:(0,h.jsx)("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"})}),(0,h.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Integration Parameters"})]}),(0,h.jsx)("div",{className:"grid grid-cols-1 gap-4",children:Object.entries(r).map(t=>{let[l,a]=t;return(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)("label",{className:"text-sm font-medium text-gray-700 capitalize flex items-center space-x-1",children:[(0,h.jsx)("span",{children:l.replace(/_/g," ")}),(0,h.jsx)(X.Z,{title:"Environment variable reference recommended: os.environ/".concat(l.toUpperCase()),children:(0,h.jsx)($.Z,{className:"text-gray-400 cursor-help text-xs"})}),"password"===a&&(0,h.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800",children:"Sensitive"})]}),(0,h.jsx)("input",{type:"password"===a?"password":"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",placeholder:"os.environ/".concat(l.toUpperCase()),value:e.callback_vars[l]||"",onChange:e=>i(s,l,e.target.value)})]},l)})})]})};return(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)(ec.Z,{className:"w-5 h-5 text-blue-500"}),(0,h.jsx)("span",{className:"text-base font-semibold text-gray-800",children:"Logging Integrations"}),(0,h.jsx)(X.Z,{title:"Configure callback logging integrations for this team.",children:(0,h.jsx)($.Z,{className:"text-gray-400 cursor-help"})})]}),(0,h.jsx)(P.Z,{variant:"secondary",onClick:()=>{a([...s,{callback_name:"",callback_type:"success",callback_vars:{}}])},icon:ed.Z,size:"sm",className:"hover:border-blue-400 hover:text-blue-500",type:"button",children:"Add Integration"})]}),(0,h.jsx)("div",{className:"space-y-4",children:s.map((e,s)=>{var t,a;let i=e.callback_name?null===(t=Object.entries(eu).find(s=>{let[t,l]=s;return l===e.callback_name}))||void 0===t?void 0:t[0]:void 0,c=i?null===(a=ex[i])||void 0===a?void 0:a.logo:null;return(0,h.jsxs)(eo.Z,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200",decoration:"top",decorationColor:"blue",children:[(0,h.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&(0,h.jsx)("img",{src:c,alt:i,className:"w-5 h-5 object-contain"}),(0,h.jsxs)("span",{className:"text-sm font-medium",children:[i||"New Integration"," Configuration"]})]}),(0,h.jsx)(P.Z,{variant:"light",onClick:()=>r(s),icon:em.Z,size:"xs",color:"red",className:"hover:bg-red-50",type:"button",children:"Remove"})]}),(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Integration Type"}),(0,h.jsx)(F.default,{value:i,placeholder:"Select integration",onChange:e=>n(s,"callback_name",e),className:"w-full",optionLabelProp:"label",children:l.map(e=>{var s;let t=null===(s=ex[e])||void 0===s?void 0:s.logo;return(0,h.jsx)(ep,{value:e,label:e,children:(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,h.jsx)("img",{src:t,alt:e,className:"w-4 h-4 object-contain"}),(0,h.jsx)("span",{children:e})]})},e)})})]}),(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Event Type"}),(0,h.jsxs)(F.default,{value:e.callback_type,onChange:e=>n(s,"callback_type",e),className:"w-full",children:[(0,h.jsx)(ep,{value:"success",children:(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,h.jsx)("span",{children:"Success Only"})]})}),(0,h.jsx)(ep,{value:"failure",children:(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),(0,h.jsx)("span",{children:"Failure Only"})]})}),(0,h.jsx)(ep,{value:"success_and_failure",children:(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,h.jsx)("span",{children:"Success & Failure"})]})})]})]})]}),o(e,s)]})]},s)})}),0===s.length&&(0,h.jsxs)("div",{className:"text-center py-12 text-gray-500 border-2 border-dashed border-gray-200 rounded-lg bg-gray-50/50",children:[(0,h.jsx)(ec.Z,{className:"w-12 h-12 text-gray-300 mb-3 mx-auto"}),(0,h.jsx)("div",{className:"text-base font-medium mb-1",children:"No logging integrations configured"}),(0,h.jsx)("div",{className:"text-sm text-gray-400",children:'Click "Add Integration" to configure logging for this team'})]})]})},ej=t(57365),ef=t(93192);function ev(e){let{isInvitationLinkModalVisible:s,setIsInvitationLinkModalVisible:t,baseUrl:l,invitationLinkData:a,modalType:r="invitation"}=e,{Title:n,Paragraph:i}=ef.default,o=()=>{if(!l)return"";let e=new URL(l).pathname,s=e&&"/"!==e?"".concat(e,"/ui"):"ui";if(null==a?void 0:a.has_user_setup_sso)return new URL(s,l).toString();let t="".concat(s,"?invitation_id=").concat(null==a?void 0:a.id);return"resetPassword"===r&&(t+="&action=reset_password"),new URL(t,l).toString()};return(0,h.jsxs)(q.Z,{title:"invitation"===r?"Invitation Link":"Reset Password Link",visible:s,width:800,footer:null,onOk:()=>{t(!1)},onCancel:()=>{t(!1)},children:[(0,h.jsx)(i,{children:"invitation"===r?"Copy and send the generated link to onboard this user to the proxy.":"Copy and send the generated link to the user to reset their password."}),(0,h.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,h.jsx)(O.Z,{className:"text-base",children:"User ID"}),(0,h.jsx)(O.Z,{children:null==a?void 0:a.user_id})]}),(0,h.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,h.jsx)(O.Z,{children:"invitation"===r?"Invitation Link":"Reset Password Link"}),(0,h.jsx)(O.Z,{children:(0,h.jsx)(O.Z,{children:o()})})]}),(0,h.jsx)("div",{className:"flex justify-end mt-5",children:(0,h.jsx)(D.CopyToClipboard,{text:o(),onCopy:()=>z.ZP.success("Copied!"),children:(0,h.jsx)(P.Z,{variant:"primary",children:"invitation"===r?"Copy invitation link":"Copy password reset link"})})})]})}var e_=t(85010),ey=t(72188),eb=t(73879),eN=t(34310),eZ=t(38434),ew=t(26349),ek=t(35291),eS=t(3632),eC=t(15452),eI=t.n(eC),eP=t(71157),eA=t(44643),eT=t(88532),eE=e=>{let{accessToken:s,teams:t,possibleUIRoles:l,onUsersCreated:a}=e,[r,n]=(0,x.useState)(!1),[i,o]=(0,x.useState)([]),[c,d]=(0,x.useState)(!1),[m,u]=(0,x.useState)(null),[p,g]=(0,x.useState)(null),[j,f]=(0,x.useState)(null),[v,_]=(0,x.useState)(null),[b,N]=(0,x.useState)(null),[Z,w]=(0,x.useState)("http://localhost:4000");(0,x.useEffect)(()=>{(async()=>{try{let e=await (0,y.g)(s);N(e)}catch(e){console.error("Error fetching UI settings:",e)}})(),w(new URL("/",window.location.href).toString())},[s]);let k=async()=>{d(!0);let e=i.map(e=>({...e,status:"pending"}));o(e);let t=!1;for(let a=0;a<e.length;a++){var l,r,n;let i=e[a];try{let e={user_email:i.user_email,user_role:i.user_role};if(i.teams&&"string"==typeof i.teams&&""!==i.teams.trim()&&(e.teams=i.teams.split(",").map(e=>e.trim()).filter(Boolean),0===e.teams.length&&delete e.teams),i.models&&"string"==typeof i.models&&""!==i.models.trim()&&(e.models=i.models.split(",").map(e=>e.trim()).filter(Boolean),0===e.models.length&&delete e.models),i.max_budget&&""!==i.max_budget.toString().trim()){let s=parseFloat(i.max_budget.toString());!isNaN(s)&&s>0&&(e.max_budget=s)}i.budget_duration&&""!==i.budget_duration.trim()&&(e.budget_duration=i.budget_duration.trim()),i.metadata&&"string"==typeof i.metadata&&""!==i.metadata.trim()&&(e.metadata=i.metadata.trim()),console.log("Sending user data:",e);let r=await (0,y.Ov)(s,null,e);if(console.log("Full response:",r),r&&(r.key||r.user_id)){t=!0,console.log("Success case triggered");let e=(null===(l=r.data)||void 0===l?void 0:l.user_id)||r.user_id;try{if(null==b?void 0:b.SSO_ENABLED){let e=new URL("/ui",Z).toString();o(s=>s.map((s,t)=>t===a?{...s,status:"success",key:r.key||r.user_id,invitation_link:e}:s))}else{let t=await (0,y.XO)(s,e),l=new URL("/ui?invitation_id=".concat(t.id),Z).toString();o(e=>e.map((e,s)=>s===a?{...e,status:"success",key:r.key||r.user_id,invitation_link:l}:e))}}catch(e){console.error("Error creating invitation:",e),o(e=>e.map((e,s)=>s===a?{...e,status:"success",key:r.key||r.user_id,error:"User created but failed to generate invitation link"}:e))}}else{console.log("Error case triggered");let e=(null==r?void 0:r.error)||"Failed to create user";console.log("Error message:",e),o(s=>s.map((s,t)=>t===a?{...s,status:"failed",error:e}:s))}}catch(s){console.error("Caught error:",s);let e=(null==s?void 0:null===(n=s.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.error)||(null==s?void 0:s.message)||String(s);o(s=>s.map((s,t)=>t===a?{...s,status:"failed",error:e}:s))}}d(!1),t&&a&&a()};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(P.Z,{className:"mx-auto mb-0",onClick:()=>n(!0),children:"+ Bulk Invite Users"}),(0,h.jsx)(q.Z,{title:"Bulk Invite Users",visible:r,width:800,onCancel:()=>n(!1),bodyStyle:{maxHeight:"70vh",overflow:"auto"},footer:null,children:(0,h.jsx)("div",{className:"flex flex-col",children:0===i.length?(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsxs)("div",{className:"flex items-center mb-4",children:[(0,h.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"1"}),(0,h.jsx)("h3",{className:"text-lg font-medium",children:"Download and fill the template"})]}),(0,h.jsxs)("div",{className:"ml-11 mb-6",children:[(0,h.jsx)("p",{className:"mb-4",children:"Add multiple users at once by following these steps:"}),(0,h.jsxs)("ol",{className:"list-decimal list-inside space-y-2 ml-2 mb-4",children:[(0,h.jsx)("li",{children:"Download our CSV template"}),(0,h.jsx)("li",{children:"Add your users' information to the spreadsheet"}),(0,h.jsx)("li",{children:"Save the file and upload it here"}),(0,h.jsx)("li",{children:"After creation, download the results file containing the API keys for each user"})]}),(0,h.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200 mb-4",children:[(0,h.jsx)("h4",{className:"font-medium mb-2",children:"Template Column Names"}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,h.jsxs)("div",{className:"flex items-start",children:[(0,h.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"font-medium",children:"user_email"}),(0,h.jsx)("p",{className:"text-sm text-gray-600",children:"User's email address (required)"})]})]}),(0,h.jsxs)("div",{className:"flex items-start",children:[(0,h.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"font-medium",children:"user_role"}),(0,h.jsx)("p",{className:"text-sm text-gray-600",children:'User\'s role (one of: "proxy_admin", "proxy_admin_view_only", "internal_user", "internal_user_view_only")'})]})]}),(0,h.jsxs)("div",{className:"flex items-start",children:[(0,h.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"font-medium",children:"teams"}),(0,h.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated team IDs (e.g., "team-1,team-2")'})]})]}),(0,h.jsxs)("div",{className:"flex items-start",children:[(0,h.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"font-medium",children:"max_budget"}),(0,h.jsx)("p",{className:"text-sm text-gray-600",children:'Maximum budget as a number (e.g., "100")'})]})]}),(0,h.jsxs)("div",{className:"flex items-start",children:[(0,h.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"font-medium",children:"budget_duration"}),(0,h.jsx)("p",{className:"text-sm text-gray-600",children:'Budget reset period (e.g., "30d", "1mo")'})]})]}),(0,h.jsxs)("div",{className:"flex items-start",children:[(0,h.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"font-medium",children:"models"}),(0,h.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated allowed models (e.g., "gpt-3.5-turbo,gpt-4")'})]})]})]})]}),(0,h.jsxs)(P.Z,{onClick:()=>{let e=new Blob([eI().unparse([["user_email","user_role","teams","max_budget","budget_duration","models"],["user@example.com","internal_user","team-id-1,team-id-2","100","30d","gpt-3.5-turbo,gpt-4"]])],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="bulk_users_template.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(s)},size:"lg",className:"w-full md:w-auto",children:[(0,h.jsx)(eb.Z,{className:"mr-2"})," Download CSV Template"]})]}),(0,h.jsxs)("div",{className:"flex items-center mb-4",children:[(0,h.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"2"}),(0,h.jsx)("h3",{className:"text-lg font-medium",children:"Upload your completed CSV"})]}),(0,h.jsxs)("div",{className:"ml-11",children:[v?(0,h.jsxs)("div",{className:"mb-4 p-4 rounded-md border ".concat(j?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"),children:[(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center",children:[j?(0,h.jsx)(eN.Z,{className:"text-red-500 text-xl mr-3"}):(0,h.jsx)(eZ.Z,{className:"text-blue-500 text-xl mr-3"}),(0,h.jsxs)("div",{children:[(0,h.jsx)(ef.default.Text,{strong:!0,className:j?"text-red-800":"text-blue-800",children:v.name}),(0,h.jsxs)(ef.default.Text,{className:"block text-xs ".concat(j?"text-red-600":"text-blue-600"),children:[(v.size/1024).toFixed(1)," KB • ",new Date().toLocaleDateString()]})]})]}),(0,h.jsxs)(P.Z,{size:"xs",variant:"secondary",onClick:()=>{_(null),o([]),u(null),g(null),f(null)},className:"flex items-center",children:[(0,h.jsx)(ew.Z,{className:"mr-1"})," Remove"]})]}),j?(0,h.jsxs)("div",{className:"mt-3 text-red-600 text-sm flex items-start",children:[(0,h.jsx)(ek.Z,{className:"mr-2 mt-0.5"}),(0,h.jsx)("span",{children:j})]}):!p&&(0,h.jsxs)("div",{className:"mt-3 flex items-center",children:[(0,h.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,h.jsx)("div",{className:"bg-blue-500 h-1.5 rounded-full w-full animate-pulse"})}),(0,h.jsx)("span",{className:"ml-2 text-xs text-blue-600",children:"Processing..."})]})]}):(0,h.jsx)(e_.default,{beforeUpload:e=>((u(null),g(null),f(null),_(e),"text/csv"===e.type||e.name.endsWith(".csv"))?e.size>5242880?f("File is too large (".concat((e.size/1048576).toFixed(1)," MB). Please upload a CSV file smaller than 5MB.")):eI().parse(e,{complete:e=>{if(!e.data||0===e.data.length){g("The CSV file appears to be empty. Please upload a file with data."),o([]);return}if(1===e.data.length){g("The CSV file only contains headers but no user data. Please add user data to your CSV."),o([]);return}let s=e.data[0];if(0===s.length||1===s.length&&""===s[0]){g("The CSV file doesn't contain any column headers. Please make sure your CSV has headers."),o([]);return}let l=["user_email","user_role"].filter(e=>!s.includes(e));if(l.length>0){g("Your CSV is missing these required columns: ".concat(l.join(", "),". Please add these columns to your CSV file.")),o([]);return}try{let l=e.data.slice(1).map((e,l)=>{var a,r,n,i,o,c;if(0===e.length||1===e.length&&""===e[0])return null;if(e.length<s.length)return{rowNumber:l+2,isValid:!1,error:"Row ".concat(l+2," has fewer columns than the header row. Please ensure all data is properly formatted."),user_email:"",user_role:""};let d={user_email:(null===(a=e[s.indexOf("user_email")])||void 0===a?void 0:a.trim())||"",user_role:(null===(r=e[s.indexOf("user_role")])||void 0===r?void 0:r.trim())||"",teams:null===(n=e[s.indexOf("teams")])||void 0===n?void 0:n.trim(),max_budget:null===(i=e[s.indexOf("max_budget")])||void 0===i?void 0:i.trim(),budget_duration:null===(o=e[s.indexOf("budget_duration")])||void 0===o?void 0:o.trim(),models:null===(c=e[s.indexOf("models")])||void 0===c?void 0:c.trim(),rowNumber:l+2,isValid:!0,error:""},m=[];if(d.user_email?d.user_email.includes("@")&&d.user_email.includes(".")||m.push("Invalid email format (must contain @ and domain)"):m.push("Email is required"),d.user_role){let e=["proxy_admin","proxy_admin_view_only","internal_user","internal_user_view_only"];e.includes(d.user_role)||m.push('Invalid role "'.concat(d.user_role,'". Must be one of: ').concat(e.join(", ")))}else m.push("Role is required");if(d.max_budget&&""!==d.max_budget.toString().trim()&&(isNaN(parseFloat(d.max_budget.toString()))?m.push('Max budget "'.concat(d.max_budget,'" must be a number')):0>=parseFloat(d.max_budget.toString())&&m.push("Max budget must be greater than 0")),d.budget_duration&&!d.budget_duration.match(/^\d+[dhmwy]$|^\d+mo$/)&&m.push('Invalid budget duration format "'.concat(d.budget_duration,'". Use format like "30d", "1mo", "2w", "6h"')),d.teams&&"string"==typeof d.teams&&t&&t.length>0){let e=t.map(e=>e.team_id),s=d.teams.split(",").map(e=>e.trim()).filter(s=>!e.includes(s));s.length>0&&m.push("Unknown team(s): ".concat(s.join(", ")))}return m.length>0&&(d.isValid=!1,d.error=m.join(", ")),d}).filter(Boolean),a=l.filter(e=>e.isValid);o(l),0===l.length?g("No valid data rows found in the CSV file. Please check your file format."):0===a.length?u("No valid users found in the CSV. Please check the errors below and fix your CSV file."):a.length<l.length?u("Found ".concat(l.length-a.length," row(s) with errors out of ").concat(l.length," total rows. Please correct them before proceeding.")):z.ZP.success("Successfully parsed ".concat(a.length," users"))}catch(s){let e=s instanceof Error?s.message:"Unknown error";u("Error parsing CSV: ".concat(e)),o([])}},error:e=>{u("Failed to parse CSV file: ".concat(e.message)),o([])},header:!1}):(f("Invalid file type: ".concat(e.name,". Please upload a CSV file (.csv extension).")),z.ZP.error("Invalid file type. Please upload a CSV file.")),!1),accept:".csv",maxCount:1,showUploadList:!1,children:(0,h.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-colors cursor-pointer",children:[(0,h.jsx)(eS.Z,{className:"text-3xl text-gray-400 mb-2"}),(0,h.jsx)("p",{className:"mb-1",children:"Drag and drop your CSV file here"}),(0,h.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"or"}),(0,h.jsx)(P.Z,{size:"sm",children:"Browse files"}),(0,h.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"Only CSV files (.csv) are supported"})]})}),p&&(0,h.jsx)("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,h.jsxs)("div",{className:"flex items-start",children:[(0,h.jsx)(eT.Z,{className:"h-5 w-5 text-yellow-500 mr-2 mt-0.5"}),(0,h.jsxs)("div",{children:[(0,h.jsx)(ef.default.Text,{strong:!0,className:"text-yellow-800",children:"CSV Structure Error"}),(0,h.jsx)(ef.default.Paragraph,{className:"text-yellow-700 mt-1 mb-0",children:p}),(0,h.jsx)(ef.default.Paragraph,{className:"text-yellow-700 mt-2 mb-0",children:"Please download our template and ensure your CSV follows the required format."})]})]})})]})]}):(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsxs)("div",{className:"flex items-center mb-4",children:[(0,h.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"3"}),(0,h.jsx)("h3",{className:"text-lg font-medium",children:i.some(e=>"success"===e.status||"failed"===e.status)?"User Creation Results":"Review and create users"})]}),m&&(0,h.jsx)("div",{className:"ml-11 mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:(0,h.jsxs)("div",{className:"flex items-start",children:[(0,h.jsx)(ek.Z,{className:"text-red-500 mr-2 mt-1"}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"text-red-600 font-medium",children:m}),i.some(e=>!e.isValid)&&(0,h.jsxs)("ul",{className:"mt-2 list-disc list-inside text-red-600 text-sm",children:[(0,h.jsx)("li",{children:"Check the table below for specific errors in each row"}),(0,h.jsx)("li",{children:"Common issues include invalid email formats, missing required fields, or incorrect role values"}),(0,h.jsx)("li",{children:"Fix these issues in your CSV file and upload again"})]})]})]})}),(0,h.jsxs)("div",{className:"ml-11",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,h.jsx)("div",{className:"flex items-center",children:i.some(e=>"success"===e.status||"failed"===e.status)?(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(O.Z,{className:"text-lg font-medium mr-3",children:"Creation Summary"}),(0,h.jsxs)(O.Z,{className:"text-sm bg-green-100 text-green-800 px-2 py-1 rounded mr-2",children:[i.filter(e=>"success"===e.status).length," Successful"]}),i.some(e=>"failed"===e.status)&&(0,h.jsxs)(O.Z,{className:"text-sm bg-red-100 text-red-800 px-2 py-1 rounded",children:[i.filter(e=>"failed"===e.status).length," Failed"]})]}):(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(O.Z,{className:"text-lg font-medium mr-3",children:"User Preview"}),(0,h.jsxs)(O.Z,{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded",children:[i.filter(e=>e.isValid).length," of ",i.length," users valid"]})]})}),!i.some(e=>"success"===e.status||"failed"===e.status)&&(0,h.jsxs)("div",{className:"flex space-x-3",children:[(0,h.jsx)(P.Z,{onClick:()=>{o([]),u(null)},variant:"secondary",children:"Back"}),(0,h.jsx)(P.Z,{onClick:k,disabled:0===i.filter(e=>e.isValid).length||c,children:c?"Creating...":"Create ".concat(i.filter(e=>e.isValid).length," Users")})]})]}),i.some(e=>"success"===e.status)&&(0,h.jsx)("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,h.jsxs)("div",{className:"flex items-start",children:[(0,h.jsx)("div",{className:"mr-3 mt-1",children:(0,h.jsx)(eA.Z,{className:"h-5 w-5 text-blue-500"})}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium text-blue-800",children:"User creation complete"}),(0,h.jsxs)(O.Z,{className:"block text-sm text-blue-700 mt-1",children:[(0,h.jsx)("span",{className:"font-medium",children:"Next step:"})," Download the credentials file containing API keys and invitation links. Users will need these API keys to make LLM requests through LiteLLM."]})]})]})}),(0,h.jsx)(ey.Z,{dataSource:i,columns:[{title:"Row",dataIndex:"rowNumber",key:"rowNumber",width:80},{title:"Email",dataIndex:"user_email",key:"user_email"},{title:"Role",dataIndex:"user_role",key:"user_role"},{title:"Teams",dataIndex:"teams",key:"teams"},{title:"Budget",dataIndex:"max_budget",key:"max_budget"},{title:"Status",key:"status",render:(e,s)=>s.isValid?s.status&&"pending"!==s.status?"success"===s.status?(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(eA.Z,{className:"h-5 w-5 text-green-500 mr-2"}),(0,h.jsx)("span",{className:"text-green-500",children:"Success"})]}),s.invitation_link&&(0,h.jsx)("div",{className:"mt-1",children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("span",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:s.invitation_link}),(0,h.jsx)(D.CopyToClipboard,{text:s.invitation_link,onCopy:()=>z.ZP.success("Invitation link copied!"),children:(0,h.jsx)("button",{className:"ml-1 text-blue-500 text-xs hover:text-blue-700",children:"Copy"})})]})})]}):(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(eP.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,h.jsx)("span",{className:"text-red-500",children:"Failed"})]}),s.error&&(0,h.jsx)("span",{className:"text-sm text-red-500 ml-7",children:JSON.stringify(s.error)})]}):(0,h.jsx)("span",{className:"text-gray-500",children:"Pending"}):(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(eP.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,h.jsx)("span",{className:"text-red-500",children:"Invalid"})]}),s.error&&(0,h.jsx)("span",{className:"text-sm text-red-500 ml-7",children:s.error})]})}],size:"small",pagination:{pageSize:5},scroll:{y:300},rowClassName:e=>e.isValid?"":"bg-red-50"}),!i.some(e=>"success"===e.status||"failed"===e.status)&&(0,h.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,h.jsx)(P.Z,{onClick:()=>{o([]),u(null)},variant:"secondary",className:"mr-3",children:"Back"}),(0,h.jsx)(P.Z,{onClick:k,disabled:0===i.filter(e=>e.isValid).length||c,children:c?"Creating...":"Create ".concat(i.filter(e=>e.isValid).length," Users")})]}),i.some(e=>"success"===e.status||"failed"===e.status)&&(0,h.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,h.jsx)(P.Z,{onClick:()=>{o([]),u(null)},variant:"secondary",className:"mr-3",children:"Start New Bulk Import"}),(0,h.jsxs)(P.Z,{onClick:()=>{let e=i.map(e=>({user_email:e.user_email,user_role:e.user_role,status:e.status,key:e.key||"",invitation_link:e.invitation_link||"",error:e.error||""})),s=new Blob([eI().unparse(e)],{type:"text/csv"}),t=window.URL.createObjectURL(s),l=document.createElement("a");l.href=t,l.download="bulk_users_results.csv",document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(t)},variant:"primary",className:"flex items-center",children:[(0,h.jsx)(eb.Z,{className:"mr-2"})," Download User Credentials"]})]})]})]})})})]})};let{Option:eL}=F.default;var eO=e=>{let{userID:s,accessToken:t,teams:l,possibleUIRoles:a,onUserCreated:r,isEmbedded:n=!1}=e,i=(0,f.NL)(),[o,c]=(0,x.useState)(null),[d]=R.Z.useForm(),[m,u]=(0,x.useState)(!1),[p,g]=(0,x.useState)(!1),[j,v]=(0,x.useState)([]),[_,b]=(0,x.useState)(!1),[N,Z]=(0,x.useState)(null),[w,k]=(0,x.useState)(null);(0,x.useEffect)(()=>{let e=async()=>{try{let e=await (0,y.So)(t,s,"any"),l=[];for(let s=0;s<e.data.length;s++){let t=e.data[s];l.push(t.id)}console.log("Model data response:",e.data),console.log("Available models:",l),v(l);let a=await (0,y.g)(t);console.log("uiSettingsResponse:",a),c(a)}catch(e){console.error("Error fetching model data:",e)}};k((0,y.zX)()),e()},[]);let S=async e=>{var l,a,c;try{z.ZP.info("Making API Call"),n||u(!0),e.models&&0!==e.models.length||"proxy_admin"===e.user_role||(console.log("formValues.user_role",e.user_role),e.models=["no-default-models"]),console.log("formValues in create user:",e);let a=await (0,y.Ov)(t,null,e);await i.invalidateQueries({queryKey:["userList"]}),console.log("user create Response:",a),g(!0);let c=(null===(l=a.data)||void 0===l?void 0:l.user_id)||a.user_id;if(r&&n){r(c),d.resetFields();return}if(null==o?void 0:o.SSO_ENABLED){let e={id:crypto.randomUUID(),user_id:c,is_accepted:!1,accepted_at:null,expires_at:new Date(Date.now()+6048e5),created_at:new Date,created_by:s,updated_at:new Date,updated_by:s,has_user_setup_sso:!0};Z(e),b(!0)}else(0,y.XO)(t,c).then(e=>{e.has_user_setup_sso=!1,Z(e),b(!0)});z.ZP.success("API user Created"),d.resetFields(),localStorage.removeItem("userData"+s)}catch(s){let e=(null===(c=s.response)||void 0===c?void 0:null===(a=c.data)||void 0===a?void 0:a.detail)||(null==s?void 0:s.message)||"Error creating the user";z.ZP.error(e),console.error("Error creating the user:",s)}};return n?(0,h.jsxs)(R.Z,{form:d,onFinish:S,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsx)(R.Z.Item,{label:"User Email",name:"user_email",children:(0,h.jsx)(A.Z,{placeholder:""})}),(0,h.jsx)(R.Z.Item,{label:"User Role",name:"user_role",children:(0,h.jsx)(F.default,{children:a&&Object.entries(a).map(e=>{let[s,{ui_label:t,description:l}]=e;return(0,h.jsx)(ej.Z,{value:s,title:t,children:(0,h.jsxs)("div",{className:"flex",children:[t," ",(0,h.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:l})]})},s)})})}),(0,h.jsx)(R.Z.Item,{label:"Team ID",name:"team_id",children:(0,h.jsx)(F.default,{placeholder:"Select Team ID",style:{width:"100%"},children:l?l.map(e=>(0,h.jsx)(eL,{value:e.team_id,children:e.team_alias},e.team_id)):(0,h.jsx)(eL,{value:null,children:"Default Team"},"default")})}),(0,h.jsx)(R.Z.Item,{label:"Metadata",name:"metadata",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Create User"})})]}):(0,h.jsxs)("div",{className:"flex gap-2",children:[(0,h.jsx)(P.Z,{className:"mx-auto mb-0",onClick:()=>u(!0),children:"+ Invite User"}),(0,h.jsx)(eE,{accessToken:t,teams:l,possibleUIRoles:a}),(0,h.jsxs)(q.Z,{title:"Invite User",visible:m,width:800,footer:null,onOk:()=>{u(!1),d.resetFields()},onCancel:()=>{u(!1),g(!1),d.resetFields()},children:[(0,h.jsx)(O.Z,{className:"mb-1",children:"Create a User who can own keys"}),(0,h.jsxs)(R.Z,{form:d,onFinish:S,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsx)(R.Z.Item,{label:"User Email",name:"user_email",children:(0,h.jsx)(A.Z,{placeholder:""})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Global Proxy Role"," ",(0,h.jsx)(X.Z,{title:"This is the role that the user will globally on the proxy. This role is independent of any team/org specific roles.",children:(0,h.jsx)($.Z,{})})]}),name:"user_role",children:(0,h.jsx)(F.default,{children:a&&Object.entries(a).map(e=>{let[s,{ui_label:t,description:l}]=e;return(0,h.jsx)(ej.Z,{value:s,title:t,children:(0,h.jsxs)("div",{className:"flex",children:[t," ",(0,h.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:l})]})},s)})})}),(0,h.jsx)(R.Z.Item,{label:"Team ID",className:"gap-2",name:"team_id",help:"If selected, user will be added as a 'user' role to the team.",children:(0,h.jsx)(F.default,{placeholder:"Select Team ID",style:{width:"100%"},children:l?l.map(e=>(0,h.jsx)(eL,{value:e.team_id,children:e.team_alias},e.team_id)):(0,h.jsx)(eL,{value:null,children:"Default Team"},"default")})}),(0,h.jsx)(R.Z.Item,{label:"Metadata",name:"metadata",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,h.jsxs)(T.Z,{children:[(0,h.jsx)(L.Z,{children:(0,h.jsx)(M.Z,{children:"Personal Key Creation"})}),(0,h.jsx)(E.Z,{children:(0,h.jsx)(R.Z.Item,{className:"gap-2",label:(0,h.jsxs)("span",{children:["Models"," ",(0,h.jsx)(X.Z,{title:"Models user has access to, outside of team scope.",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"models",help:"Models user has access to, outside of team scope.",children:(0,h.jsxs)(F.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,h.jsx)(F.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),j.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:J(e)},e))]})})})]}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Create User"})})]})]}),p&&(0,h.jsx)(ev,{isInvitationLinkModalVisible:_,setIsInvitationLinkModalVisible:b,baseUrl:w||"",invitationLinkData:N})]})},eM=t(7310),eD=t.n(eM);let eF=["Admin","Admin Viewer","proxy_admin","proxy_admin_viewer","org_admin"],eR=["Internal User","Internal Viewer"],ez=["Internal User","Admin"],eq=e=>eF.includes(e),{Option:eU}=F.default,eV=e=>e?({"24h":"daily","7d":"weekly","30d":"monthly"})[e]||e:"Not set";var eK=e=>{let{value:s,onChange:t,className:l="",style:a={}}=e;return(0,h.jsxs)(F.default,{style:{width:"100%",...a},value:s||void 0,onChange:t,className:l,placeholder:"n/a",children:[(0,h.jsx)(eU,{value:"24h",children:"daily"}),(0,h.jsx)(eU,{value:"7d",children:"weekly"}),(0,h.jsx)(eU,{value:"30d",children:"monthly"})]})};function eB(e,s){let t=structuredClone(e);for(let[e,l]of Object.entries(s))e in t&&(t[e]=l);return t}let eH=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e?"-":e.toLocaleString("en-US",{minimumFractionDigits:s,maximumFractionDigits:s})},{Option:eG}=F.default,eJ=e=>{let s=[];if(console.log("data:",JSON.stringify(e)),e)for(let t of e)t.metadata&&t.metadata.tags&&s.push(...t.metadata.tags);let t=Array.from(new Set(s)).map(e=>({value:e,label:e}));return console.log("uniqueTags:",t),t},eY=async(e,s,t,l)=>{try{if(null===e||null===s)return[];if(null!==t){let a=(await (0,y.So)(t,e,s,!0,l,!0)).data.map(e=>e.id);return console.log("available_model_names:",a),a}return[]}catch(e){return console.error("Error fetching user models:",e),[]}},eW=async(e,s,t,l)=>{try{if(null===e||null===s)return;if(null!==t){let a=(await (0,y.So)(t,e,s)).data.map(e=>e.id);console.log("available_model_names:",a),l(a)}}catch(e){console.error("Error fetching user models:",e)}};var e$=e=>{let{userID:s,team:t,teams:l,userRole:a,accessToken:r,data:n,addKey:i,premiumUser:o=!1}=e,[c]=R.Z.useForm(),[d,m]=(0,x.useState)(!1),[u,p]=(0,x.useState)(null),[g,j]=(0,x.useState)(null),[f,v]=(0,x.useState)([]),[_,b]=(0,x.useState)([]),[N,Z]=(0,x.useState)("you"),[w,k]=(0,x.useState)(eJ(n)),[S,B]=(0,x.useState)([]),[G,Y]=(0,x.useState)([]),[W,Q]=(0,x.useState)(t),[ee,es]=(0,x.useState)(!1),[el,er]=(0,x.useState)(null),[eo,ec]=(0,x.useState)({}),[ed,em]=(0,x.useState)([]),[eu,eh]=(0,x.useState)(!1),ex=()=>{m(!1),c.resetFields(),Y([])},ep=()=>{m(!1),p(null),Q(null),c.resetFields(),Y([])};(0,x.useEffect)(()=>{s&&a&&r&&eW(s,a,r,v)},[r,s,a]),(0,x.useEffect)(()=>{(async()=>{try{let e=(await (0,y.t3)(r)).guardrails.map(e=>e.guardrail_name);B(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})()},[r]),(0,x.useEffect)(()=>{(async()=>{try{if(r){let e=sessionStorage.getItem("possibleUserRoles");if(e)ec(JSON.parse(e));else{let e=await (0,y.lg)(r);sessionStorage.setItem("possibleUserRoles",JSON.stringify(e)),ec(e)}}}catch(e){console.error("Error fetching possible user roles:",e)}})()},[r]);let ej=_.includes("no-default-models")&&!W,ef=async e=>{try{var t,l,a;let o=null!==(t=null==e?void 0:e.key_alias)&&void 0!==t?t:"",d=null!==(l=null==e?void 0:e.team_id)&&void 0!==l?l:null;if((null!==(a=null==n?void 0:n.filter(e=>e.team_id===d).map(e=>e.key_alias))&&void 0!==a?a:[]).includes(o))throw Error("Key alias ".concat(o," already exists for team with ID ").concat(d,", please provide another key alias"));z.ZP.info("Making API Call"),m(!0),"you"===N&&(e.user_id=s);let u={};try{u=JSON.parse(e.metadata||"{}")}catch(e){console.error("Error parsing metadata:",e)}"service_account"===N&&(u.service_account_id=e.key_alias),G.length>0&&(u={...u,logging:G.filter(e=>e.callback_name)}),e.metadata=JSON.stringify(u),e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0&&(e.object_permission={vector_stores:e.allowed_vector_store_ids},delete e.allowed_vector_store_ids),e.allowed_mcp_server_ids&&e.allowed_mcp_server_ids.length>0&&(e.object_permission||(e.object_permission={}),e.object_permission.mcp_servers=e.allowed_mcp_server_ids,delete e.allowed_mcp_server_ids);let h=await (0,y.wX)(r,s,e);console.log("key create Response:",h),i(h),p(h.key),j(h.soft_budget),z.ZP.success("API Key Created"),c.resetFields(),localStorage.removeItem("userData"+s)}catch(e){console.log("error in create key:",e),z.ZP.error("Error creating the key: ".concat(e))}};(0,x.useEffect)(()=>{if(s&&a&&r){var e;eY(s,a,r,null!==(e=null==W?void 0:W.team_id)&&void 0!==e?e:null).then(e=>{var s;b(Array.from(new Set([...null!==(s=null==W?void 0:W.models)&&void 0!==s?s:[],...e])))})}c.setFieldValue("models",[])},[W,r,s,a]);let ev=async e=>{if(!e){em([]);return}eh(!0);try{let s=new URLSearchParams;if(s.append("user_email",e),null==r)return;let t=(await (0,y.u5)(r,s)).map(e=>({label:"".concat(e.user_email," (").concat(e.user_id,")"),value:e.user_id,user:e}));em(t)}catch(e){console.error("Error fetching users:",e),z.ZP.error("Failed to search for users")}finally{eh(!1)}},e_=(0,x.useCallback)(eD()(e=>ev(e),300),[r]),ey=(e,s)=>{let t=s.user;c.setFieldsValue({user_id:t.user_id})};return(0,h.jsxs)("div",{children:[a&&ez.includes(a)&&(0,h.jsx)(P.Z,{className:"mx-auto",onClick:()=>m(!0),children:"+ Create New Key"}),(0,h.jsx)(q.Z,{visible:d,width:1e3,footer:null,onOk:ex,onCancel:ep,children:(0,h.jsxs)(R.Z,{form:c,onFinish:ef,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsxs)("div",{className:"mb-8",children:[(0,h.jsx)(M.Z,{className:"mb-4",children:"Key Ownership"}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Owned By"," ",(0,h.jsx)(X.Z,{title:"Select who will own this API key",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),className:"mb-4",children:(0,h.jsxs)(U.ZP.Group,{onChange:e=>Z(e.target.value),value:N,children:[(0,h.jsx)(U.ZP,{value:"you",children:"You"}),(0,h.jsx)(U.ZP,{value:"service_account",children:"Service Account"}),"Admin"===a&&(0,h.jsx)(U.ZP,{value:"another_user",children:"Another User"})]})}),"another_user"===N&&(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["User ID"," ",(0,h.jsx)(X.Z,{title:"The user who will own this key and be responsible for its usage",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"user_id",className:"mt-4",rules:[{required:"another_user"===N,message:"Please input the user ID of the user you are assigning the key to"}],children:(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{display:"flex",marginBottom:"8px"},children:[(0,h.jsx)(F.default,{showSearch:!0,placeholder:"Type email to search for users",filterOption:!1,onSearch:e=>{e_(e)},onSelect:(e,s)=>ey(e,s),options:ed,loading:eu,allowClear:!0,style:{width:"100%"},notFoundContent:eu?"Searching...":"No users found"}),(0,h.jsx)(V.ZP,{onClick:()=>es(!0),style:{marginLeft:"8px"},children:"Create User"})]}),(0,h.jsx)("div",{className:"text-xs text-gray-500",children:"Search by email to find users"})]})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Team"," ",(0,h.jsx)(X.Z,{title:"The team this key belongs to, which determines available models and budget limits",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"team_id",initialValue:t?t.team_id:null,className:"mt-4",children:(0,h.jsx)(ei,{teams:l,onChange:e=>{Q((null==l?void 0:l.find(s=>s.team_id===e))||null)}})})]}),ej&&(0,h.jsx)("div",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,h.jsx)(O.Z,{className:"text-blue-800 text-sm",children:"Please select a team to continue configuring your API key."})}),!ej&&(0,h.jsxs)("div",{className:"mb-8",children:[(0,h.jsx)(M.Z,{className:"mb-4",children:"Key Details"}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["you"===N||"another_user"===N?"Key Name":"Service Account ID"," ",(0,h.jsx)(X.Z,{title:"you"===N||"another_user"===N?"A descriptive name to identify this key":"Unique identifier for this service account",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"key_alias",rules:[{required:!0,message:"Please input a ".concat("you"===N?"key name":"service account ID")}],help:"required",children:(0,h.jsx)(A.Z,{placeholder:""})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Models"," ",(0,h.jsx)(X.Z,{title:"Select which models this key can access. Choose 'All Team Models' to grant access to all models available to the team",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"models",rules:[{required:!0,message:"Please select a model"}],help:"required",className:"mt-4",children:(0,h.jsxs)(F.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},onChange:e=>{e.includes("all-team-models")&&c.setFieldsValue({models:["all-team-models"]})},children:[(0,h.jsx)(eG,{value:"all-team-models",children:"All Team Models"},"all-team-models"),_.map(e=>(0,h.jsx)(eG,{value:e,children:J(e)},e))]})})]}),!ej&&(0,h.jsx)("div",{className:"mb-8",children:(0,h.jsxs)(T.Z,{className:"mt-4 mb-4",children:[(0,h.jsx)(L.Z,{children:(0,h.jsx)(M.Z,{className:"m-0",children:"Optional Settings"})}),(0,h.jsxs)(E.Z,{children:[(0,h.jsx)(R.Z.Item,{className:"mt-4",label:(0,h.jsxs)("span",{children:["Max Budget (USD)"," ",(0,h.jsx)(X.Z,{title:"Maximum amount in USD this key can spend. When reached, the key will be blocked from making further requests",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"max_budget",help:"Budget cannot exceed team max budget: $".concat((null==t?void 0:t.max_budget)!==null&&(null==t?void 0:t.max_budget)!==void 0?null==t?void 0:t.max_budget:"unlimited"),rules:[{validator:async(e,s)=>{if(s&&t&&null!==t.max_budget&&s>t.max_budget)throw Error("Budget cannot exceed team max budget: $".concat(eH(t.max_budget,4)))}}],children:(0,h.jsx)(H,{step:.01,precision:2,width:200})}),(0,h.jsx)(R.Z.Item,{className:"mt-4",label:(0,h.jsxs)("span",{children:["Reset Budget"," ",(0,h.jsx)(X.Z,{title:"How often the budget should reset. For example, setting 'daily' will reset the budget every 24 hours",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"budget_duration",help:"Team Reset Budget: ".concat((null==t?void 0:t.budget_duration)!==null&&(null==t?void 0:t.budget_duration)!==void 0?null==t?void 0:t.budget_duration:"None"),children:(0,h.jsx)(eK,{onChange:e=>c.setFieldValue("budget_duration",e)})}),(0,h.jsx)(R.Z.Item,{className:"mt-4",label:(0,h.jsxs)("span",{children:["Tokens per minute Limit (TPM)"," ",(0,h.jsx)(X.Z,{title:"Maximum number of tokens this key can process per minute. Helps control usage and costs",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"tpm_limit",help:"TPM cannot exceed team TPM limit: ".concat((null==t?void 0:t.tpm_limit)!==null&&(null==t?void 0:t.tpm_limit)!==void 0?null==t?void 0:t.tpm_limit:"unlimited"),rules:[{validator:async(e,s)=>{if(s&&t&&null!==t.tpm_limit&&s>t.tpm_limit)throw Error("TPM limit cannot exceed team TPM limit: ".concat(t.tpm_limit))}}],children:(0,h.jsx)(H,{step:1,width:400})}),(0,h.jsx)(R.Z.Item,{className:"mt-4",label:(0,h.jsxs)("span",{children:["Requests per minute Limit (RPM)"," ",(0,h.jsx)(X.Z,{title:"Maximum number of API requests this key can make per minute. Helps prevent abuse and manage load",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"rpm_limit",help:"RPM cannot exceed team RPM limit: ".concat((null==t?void 0:t.rpm_limit)!==null&&(null==t?void 0:t.rpm_limit)!==void 0?null==t?void 0:t.rpm_limit:"unlimited"),rules:[{validator:async(e,s)=>{if(s&&t&&null!==t.rpm_limit&&s>t.rpm_limit)throw Error("RPM limit cannot exceed team RPM limit: ".concat(t.rpm_limit))}}],children:(0,h.jsx)(H,{step:1,width:400})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Expire Key"," ",(0,h.jsx)(X.Z,{title:"Set when this key should expire. Format: 30s (seconds), 30m (minutes), 30h (hours), 30d (days)",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"duration",className:"mt-4",children:(0,h.jsx)(A.Z,{placeholder:"e.g., 30d"})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Guardrails"," ",(0,h.jsx)(X.Z,{title:"Apply safety guardrails to this key to filter content or enforce policies",children:(0,h.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",className:"mt-4",help:"Select existing guardrails or enter new ones",children:(0,h.jsx)(F.default,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails",options:S.map(e=>({value:e,label:e}))})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Allowed Vector Stores"," ",(0,h.jsx)(X.Z,{title:"Select which vector stores this key can access. If none selected, the key will have access to all available vector stores",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-4",help:"Select vector stores this key can access. Leave empty for access to all vector stores",children:(0,h.jsx)(ea,{onChange:e=>c.setFieldValue("allowed_vector_store_ids",e),value:c.getFieldValue("allowed_vector_store_ids"),accessToken:r,placeholder:"Select vector stores (optional)",premiumUser:o})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,h.jsx)(X.Z,{title:"Select which MCP servers this key can access. If none selected, the key will have access to all available MCP servers",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_server_ids",className:"mt-4",help:"Select MCP servers this key can access. Leave empty for access to all MCP servers",children:(0,h.jsx)(en,{onChange:e=>c.setFieldValue("allowed_mcp_server_ids",e),value:c.getFieldValue("allowed_mcp_server_ids"),accessToken:r,placeholder:"Select MCP servers (optional)",premiumUser:o})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Metadata"," ",(0,h.jsx)(X.Z,{title:"JSON object with additional information about this key. Used for tracking or custom logic",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"metadata",className:"mt-4",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Tags"," ",(0,h.jsx)(X.Z,{title:"Tags for tracking spend and/or doing tag-based routing. Used for analytics and filtering",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"tags",className:"mt-4",help:"Tags for tracking spend and/or doing tag-based routing.",children:(0,h.jsx)(F.default,{mode:"tags",style:{width:"100%"},placeholder:"Enter tags",tokenSeparators:[","],options:w})}),(0,h.jsxs)(T.Z,{className:"mt-4 mb-4",children:[(0,h.jsx)(L.Z,{children:(0,h.jsx)("b",{children:"Logging Settings"})}),(0,h.jsx)(E.Z,{children:(0,h.jsx)("div",{className:"mt-4",children:(0,h.jsx)(eg,{value:G,onChange:Y})})})]}),(0,h.jsxs)(T.Z,{className:"mt-4 mb-4",children:[(0,h.jsx)(L.Z,{children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("b",{children:"Advanced Settings"}),(0,h.jsx)(X.Z,{title:(0,h.jsxs)("span",{children:["Learn more about advanced settings in our"," ",(0,h.jsx)("a",{href:y.H2?"".concat(y.H2,"/#/key%20management/generate_key_fn_key_generate_post"):"/#/key%20management/generate_key_fn_key_generate_post",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300",children:"documentation"})]}),children:(0,h.jsx)($.Z,{className:"text-gray-400 hover:text-gray-300 cursor-help"})})]})}),(0,h.jsx)(E.Z,{children:(0,h.jsx)(et,{schemaComponent:"GenerateKeyRequest",form:c,excludedFields:["key_alias","team_id","models","duration","metadata","tags","guardrails","max_budget","budget_duration","tpm_limit","rpm_limit"]})})]})]})]})}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{htmlType:"submit",disabled:ej,style:{opacity:ej?.5:1},children:"Create Key"})})]})}),ee&&(0,h.jsx)(q.Z,{title:"Create New User",visible:ee,onCancel:()=>es(!1),footer:null,width:800,children:(0,h.jsx)(eO,{userID:s,accessToken:r,teams:l,possibleUIRoles:eo,onUserCreated:e=>{er(e),c.setFieldsValue({user_id:e}),es(!1)},isEmbedded:!0})}),u&&(0,h.jsx)(q.Z,{visible:d,onOk:ex,onCancel:ep,footer:null,children:(0,h.jsxs)(I.Z,{numItems:1,className:"gap-2 w-full",children:[(0,h.jsx)(M.Z,{children:"Save your Key"}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)("p",{children:["Please save this secret key somewhere safe and accessible. For security reasons, ",(0,h.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,h.jsx)(C.Z,{numColSpan:1,children:null!=u?(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"mt-3",children:"API Key:"}),(0,h.jsx)("div",{style:{background:"#f8f8f8",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:(0,h.jsx)("pre",{style:{wordWrap:"break-word",whiteSpace:"normal"},children:u})}),(0,h.jsx)(D.CopyToClipboard,{text:u,onCopy:()=>{z.ZP.success("API Key copied to clipboard")},children:(0,h.jsx)(P.Z,{className:"mt-3",children:"Copy API Key"})})]}):(0,h.jsx)(O.Z,{children:"Key being created, this might take 30s"})})]})})]})},eX=t(7366),eQ=e=>{let{selectedTeam:s,currentOrg:t,selectedKeyAlias:l,accessToken:a,createClicked:r}=e,[n,i]=(0,x.useState)({keys:[],total_count:0,current_page:1,total_pages:0}),[o,c]=(0,x.useState)(!0),[d,m]=(0,x.useState)(null),u=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(console.log("calling fetchKeys"),!a){console.log("accessToken",a);return}c(!0);let s="number"==typeof e.page?e.page:1,t="number"==typeof e.pageSize?e.pageSize:100,l=await (0,y.OD)(a,null,null,null,null,null,s,t);console.log("data",l),i(l),m(null)}catch(e){m(e instanceof Error?e:Error("An error occurred"))}finally{c(!1)}};return(0,x.useEffect)(()=>{u(),console.log("selectedTeam",s,"currentOrg",t,"accessToken",a,"selectedKeyAlias",l)},[s,t,a,l,r]),{keys:n.keys,isLoading:o,error:d,pagination:{currentPage:n.current_page,totalPages:n.total_pages,totalCount:n.total_count},refresh:u,setKeys:e=>{i(s=>{let t="function"==typeof e?e(s.keys):e;return{...s,keys:t}})}}},e0=t(27281),e1=t(41649),e2=t(12485),e4=t(18135),e5=t(35242),e6=t(29706),e3=t(77991),e8=t(77331),e7=t(23628),e9=e=>{let{value:s,onChange:t}=e;return(0,h.jsx)(eg,{value:s,onChange:t})};let se=["logging"],ss=e=>e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(e=>{let[s]=e;return!se.includes(s)})):{},st=e=>e&&"object"==typeof e&&Array.isArray(e.logging)?e.logging:[],sl=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return JSON.stringify(ss(e),null,s)};function sa(e){var s,t,l,a;let{keyData:r,onCancel:n,onSubmit:i,teams:o,accessToken:c,userID:d,userRole:m,premiumUser:u=!1}=e,[p]=R.Z.useForm(),[g,j]=(0,x.useState)([]),f=null==o?void 0:o.find(e=>e.team_id===r.team_id),[v,_]=(0,x.useState)([]);(0,x.useEffect)(()=>{(async()=>{if(d&&m&&c)try{if(null===r.team_id){let e=(await (0,y.So)(c,d,m)).data.map(e=>e.id);_(e)}else if(null==f?void 0:f.team_id){let e=await eY(d,m,c,f.team_id);_(Array.from(new Set([...f.models,...e])))}}catch(e){console.error("Error fetching models:",e)}})()},[d,m,c,f,r.team_id]);let b={...r,budget_duration:(a=r.budget_duration)&&({"24h":"daily","7d":"weekly","30d":"monthly"})[a]||null,metadata:sl(r.metadata),guardrails:(null===(s=r.metadata)||void 0===s?void 0:s.guardrails)||[],vector_stores:(null===(t=r.object_permission)||void 0===t?void 0:t.vector_stores)||[],mcp_servers:(null===(l=r.object_permission)||void 0===l?void 0:l.mcp_servers)||[],logging_settings:st(r.metadata)};return(0,h.jsxs)(R.Z,{form:p,onFinish:i,initialValues:b,layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{label:"Key Alias",name:"key_alias",children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"Models",name:"models",children:(0,h.jsxs)(F.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[v.length>0&&(0,h.jsx)(F.default.Option,{value:"all-team-models",children:"All Team Models"}),v.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:e},e))]})}),(0,h.jsx)(R.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,h.jsx)(H,{step:.01,style:{width:"100%"},placeholder:"Enter a numerical value"})}),(0,h.jsx)(R.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,h.jsxs)(F.default,{placeholder:"n/a",children:[(0,h.jsx)(F.default.Option,{value:"daily",children:"Daily"}),(0,h.jsx)(F.default.Option,{value:"weekly",children:"Weekly"}),(0,h.jsx)(F.default.Option,{value:"monthly",children:"Monthly"})]})}),(0,h.jsx)(R.Z.Item,{label:"TPM Limit",name:"tpm_limit",children:(0,h.jsx)(H,{min:0})}),(0,h.jsx)(R.Z.Item,{label:"RPM Limit",name:"rpm_limit",children:(0,h.jsx)(H,{min:0})}),(0,h.jsx)(R.Z.Item,{label:"Max Parallel Requests",name:"max_parallel_requests",children:(0,h.jsx)(H,{min:0})}),(0,h.jsx)(R.Z.Item,{label:"Model TPM Limit",name:"model_tpm_limit",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:'{"gpt-4": 100, "claude-v1": 200}'})}),(0,h.jsx)(R.Z.Item,{label:"Model RPM Limit",name:"model_rpm_limit",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:'{"gpt-4": 100, "claude-v1": 200}'})}),(0,h.jsx)(R.Z.Item,{label:"Guardrails",name:"guardrails",children:(0,h.jsx)(F.default,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails"})}),(0,h.jsx)(R.Z.Item,{label:"Vector Stores",name:"vector_stores",children:(0,h.jsx)(el,{onChange:e=>p.setFieldValue("vector_stores",e),value:p.getFieldValue("vector_stores"),accessToken:c||"",placeholder:"Select vector stores"})}),(0,h.jsx)(R.Z.Item,{label:"MCP Servers",name:"mcp_servers",children:(0,h.jsx)(er,{onChange:e=>p.setFieldValue("mcp_servers",e),value:p.getFieldValue("mcp_servers"),accessToken:c||"",placeholder:"Select MCP servers"})}),(0,h.jsx)(R.Z.Item,{label:"Team ID",name:"team_id",children:(0,h.jsx)(F.default,{placeholder:"Select team",style:{width:"100%"},children:null==o?void 0:o.map(e=>(0,h.jsx)(F.default.Option,{value:e.team_id,children:"".concat(e.team_alias," (").concat(e.team_id,")")},e.team_id))})}),(0,h.jsx)(R.Z.Item,{label:"Logging Settings",name:"logging_settings",children:(0,h.jsx)(e9,{value:p.getFieldValue("logging_settings"),onChange:e=>p.setFieldValue("logging_settings",e)})}),(0,h.jsx)(R.Z.Item,{label:"Metadata",name:"metadata",children:(0,h.jsx)(K.default.TextArea,{rows:10})}),(0,h.jsx)(R.Z.Item,{name:"token",hidden:!0,children:(0,h.jsx)(K.default,{})}),(0,h.jsx)("div",{className:"sticky z-10 bg-white p-4 border-t border-gray-200 bottom-[-1.5rem] inset-x-[-1.5rem]",children:(0,h.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,h.jsx)(V.ZP,{onClick:n,children:"Cancel"}),(0,h.jsx)(P.Z,{type:"submit",children:"Save Changes"})]})})]})}function sr(e){let{selectedToken:s,visible:t,onClose:l,accessToken:a,premiumUser:r}=e,[n]=R.Z.useForm(),[i,o]=(0,x.useState)(null),[c,d]=(0,x.useState)(null),[m,u]=(0,x.useState)(null),[p,g]=(0,x.useState)(!1);(0,x.useEffect)(()=>{t&&s&&n.setFieldsValue({key_alias:s.key_alias,max_budget:s.max_budget,tpm_limit:s.tpm_limit,rpm_limit:s.rpm_limit,duration:s.duration||""})},[t,s,n]),(0,x.useEffect)(()=>{t||(o(null),g(!1),n.resetFields())},[t,n]),(0,x.useEffect)(()=>{(null==c?void 0:c.duration)?u((e=>{if(!e)return null;try{let s;let t=new Date;if(e.endsWith("s"))s=(0,eX.Z)(t,{seconds:parseInt(e)});else if(e.endsWith("h"))s=(0,eX.Z)(t,{hours:parseInt(e)});else if(e.endsWith("d"))s=(0,eX.Z)(t,{days:parseInt(e)});else throw Error("Invalid duration format");return s.toLocaleString()}catch(e){return null}})(c.duration)):u(null)},[null==c?void 0:c.duration]);let j=async()=>{if(s&&a){g(!0);try{let e=await n.validateFields(),t=await (0,y.s0)(a,s.token,e);o(t.key),z.ZP.success("API Key regenerated successfully")}catch(e){console.error("Error regenerating key:",e),z.ZP.error("Failed to regenerate API Key"),g(!1)}}},f=()=>{o(null),g(!1),n.resetFields(),l()};return(0,h.jsx)(q.Z,{title:"Regenerate API Key",open:t,onCancel:f,footer:i?[(0,h.jsx)(P.Z,{onClick:f,children:"Close"},"close")]:[(0,h.jsx)(P.Z,{onClick:f,className:"mr-2",children:"Cancel"},"cancel"),(0,h.jsx)(P.Z,{onClick:j,disabled:p,children:p?"Regenerating...":"Regenerate"},"regenerate")],children:i?(0,h.jsxs)(I.Z,{numItems:1,className:"gap-2 w-full",children:[(0,h.jsx)(M.Z,{children:"Regenerated Key"}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)("p",{children:["Please replace your old key with the new key generated. For security reasons, ",(0,h.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,h.jsxs)(C.Z,{numColSpan:1,children:[(0,h.jsx)(O.Z,{className:"mt-3",children:"Key Alias:"}),(0,h.jsx)("div",{className:"bg-gray-100 p-2 rounded mb-2",children:(0,h.jsx)("pre",{className:"break-words whitespace-normal",children:(null==s?void 0:s.key_alias)||"No alias set"})}),(0,h.jsx)(O.Z,{className:"mt-3",children:"New API Key:"}),(0,h.jsx)("div",{className:"bg-gray-100 p-2 rounded mb-2",children:(0,h.jsx)("pre",{className:"break-words whitespace-normal",children:i})}),(0,h.jsx)(D.CopyToClipboard,{text:i,onCopy:()=>z.ZP.success("API Key copied to clipboard"),children:(0,h.jsx)(P.Z,{className:"mt-3",children:"Copy API Key"})})]})]}):(0,h.jsxs)(R.Z,{form:n,layout:"vertical",onValuesChange:e=>{"duration"in e&&d(s=>({...s,duration:e.duration}))},children:[(0,h.jsx)(R.Z.Item,{name:"key_alias",label:"Key Alias",children:(0,h.jsx)(A.Z,{disabled:!0})}),(0,h.jsx)(R.Z.Item,{name:"max_budget",label:"Max Budget (USD)",children:(0,h.jsx)(W.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{name:"tpm_limit",label:"TPM Limit",children:(0,h.jsx)(W.Z,{style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{name:"rpm_limit",label:"RPM Limit",children:(0,h.jsx)(W.Z,{style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{name:"duration",label:"Expire Key (eg: 30s, 30h, 30d)",className:"mt-8",children:(0,h.jsx)(A.Z,{placeholder:""})}),(0,h.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Current expiry: ",(null==s?void 0:s.expires)?new Date(s.expires).toLocaleString():"Never"]}),m&&(0,h.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["New expiry: ",m]})]})})}var sn=t(79814),si=function(e){let{vectorStores:s,accessToken:t}=e,[l,a]=(0,x.useState)([]);(0,x.useEffect)(()=>{(async()=>{if(t&&0!==s.length)try{let e=await (0,y.Ou)(t);e.data&&a(e.data.map(e=>({vector_store_id:e.vector_store_id,vector_store_name:e.vector_store_name})))}catch(e){console.error("Error fetching vector stores:",e)}})()},[t,s.length]);let r=e=>{let s=l.find(s=>s.vector_store_id===e);return s?"".concat(s.vector_store_name||s.vector_store_id," (").concat(s.vector_store_id,")"):e};return(0,h.jsxs)("div",{className:"space-y-3",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)(sn.Z,{className:"h-4 w-4 text-blue-600"}),(0,h.jsx)(O.Z,{className:"font-semibold text-gray-900",children:"Vector Stores"}),(0,h.jsx)(e1.Z,{color:"blue",size:"xs",children:s.length})]}),s.length>0?(0,h.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map((e,s)=>(0,h.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-50 border border-blue-200 text-blue-800 text-sm font-medium",children:r(e)},s))}):(0,h.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-50 border border-gray-200",children:[(0,h.jsx)(sn.Z,{className:"h-4 w-4 text-gray-400"}),(0,h.jsx)(O.Z,{className:"text-gray-500 text-sm",children:"No vector stores configured"})]})]})},so=t(25327),sc=function(e){let{mcpServers:s,accessToken:t}=e,[l,a]=(0,x.useState)([]);(0,x.useEffect)(()=>{(async()=>{if(t&&0!==s.length)try{let e=await (0,y.U8)(t);e&&Array.isArray(e)?a(e):e.data&&Array.isArray(e.data)&&a(e.data)}catch(e){console.error("Error fetching MCP servers:",e)}})()},[t,s.length]);let r=e=>{let s=l.find(s=>s.server_id===e);if(s){let t=e.length>7?"".concat(e.slice(0,3),"...").concat(e.slice(-4)):e;return"".concat(s.alias," (").concat(t,")")}return e};return(0,h.jsxs)("div",{className:"space-y-3",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)(so.Z,{className:"h-4 w-4 text-green-600"}),(0,h.jsx)(O.Z,{className:"font-semibold text-gray-900",children:"MCP Servers"}),(0,h.jsx)(e1.Z,{color:"green",size:"xs",children:s.length})]}),s.length>0?(0,h.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map((e,s)=>(0,h.jsx)(X.Z,{title:"Full ID: ".concat(e),placement:"top",children:(0,h.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-green-50 border border-green-200 text-green-800 text-sm font-medium cursor-help",children:r(e)})},s))}):(0,h.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-50 border border-gray-200",children:[(0,h.jsx)(so.Z,{className:"h-4 w-4 text-gray-400"}),(0,h.jsx)(O.Z,{className:"text-gray-500 text-sm",children:"No MCP servers configured"})]})]})},sd=function(e){let{objectPermission:s,variant:t="card",className:l="",accessToken:a}=e,r=(null==s?void 0:s.vector_stores)||[],n=(null==s?void 0:s.mcp_servers)||[],i=(0,h.jsxs)("div",{className:"card"===t?"grid grid-cols-1 md:grid-cols-2 gap-6":"space-y-4",children:[(0,h.jsx)(si,{vectorStores:r,accessToken:a}),(0,h.jsx)(sc,{mcpServers:n,accessToken:a})]});return"card"===t?(0,h.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 ".concat(l),children:[(0,h.jsx)("div",{className:"flex items-center gap-2 mb-6",children:(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-semibold text-gray-900",children:"Object Permissions"}),(0,h.jsx)(O.Z,{className:"text-xs text-gray-500",children:"Access control for Vector Stores and MCP Servers"})]})}),i]}):(0,h.jsxs)("div",{className:"".concat(l),children:[(0,h.jsx)(O.Z,{className:"font-medium text-gray-900 mb-3",children:"Object Permissions"}),i]})},sm=function(e){let{loggingConfigs:s=[],variant:t="card",className:l=""}=e,a=e=>{var s;return(null===(s=Object.entries(eu).find(s=>{let[t,l]=s;return l===e}))||void 0===s?void 0:s[0])||e},r=e=>{switch(e){case"success":return"green";case"failure":return"red";case"success_and_failure":return"blue";default:return"gray"}},n=e=>{switch(e){case"success":return"Success Only";case"failure":return"Failure Only";case"success_and_failure":return"Success & Failure";default:return e}},i=(0,h.jsxs)("div",{className:"space-y-3",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)(ec.Z,{className:"h-4 w-4 text-blue-600"}),(0,h.jsx)(O.Z,{className:"font-semibold text-gray-900",children:"Logging Integrations"}),(0,h.jsx)(e1.Z,{color:"blue",size:"xs",children:s.length})]}),s.length>0?(0,h.jsx)("div",{className:"space-y-3",children:s.map((e,s)=>{var t;let l=a(e.callback_name),i=null===(t=ex[l])||void 0===t?void 0:t.logo;return(0,h.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 border border-blue-200",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3",children:[i?(0,h.jsx)("img",{src:i,alt:l,className:"w-5 h-5 object-contain"}):(0,h.jsx)(ec.Z,{className:"h-5 w-5 text-gray-400"}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium text-blue-800",children:l}),(0,h.jsxs)(O.Z,{className:"text-xs text-blue-600",children:[Object.keys(e.callback_vars).length," parameters configured"]})]})]}),(0,h.jsx)(e1.Z,{color:r(e.callback_type),size:"sm",children:n(e.callback_type)})]},s)})}):(0,h.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-50 border border-gray-200",children:[(0,h.jsx)(ec.Z,{className:"h-4 w-4 text-gray-400"}),(0,h.jsx)(O.Z,{className:"text-gray-500 text-sm",children:"No logging integrations configured"})]})]});return"card"===t?(0,h.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 ".concat(l),children:[(0,h.jsx)("div",{className:"flex items-center gap-2 mb-6",children:(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-semibold text-gray-900",children:"Logging Settings"}),(0,h.jsx)(O.Z,{className:"text-xs text-gray-500",children:"Active logging integrations for this team"})]})}),i]}):(0,h.jsxs)("div",{className:"".concat(l),children:[(0,h.jsx)(O.Z,{className:"font-medium text-gray-900 mb-3",children:"Logging Settings"}),i]})};function su(e){var s,t;let{keyId:l,onClose:a,keyData:r,accessToken:n,userID:i,userRole:o,teams:c,onKeyDataUpdate:d,onDelete:m,premiumUser:u}=e,[p,g]=(0,x.useState)(!1),[j]=R.Z.useForm(),[f,v]=(0,x.useState)(!1),[_,b]=(0,x.useState)(!1);if(!r)return(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsx)(P.Z,{icon:e8.Z,variant:"light",onClick:a,className:"mb-4",children:"Back to Keys"}),(0,h.jsx)(O.Z,{children:"Key not found"})]});let N=async e=>{try{var s,t;if(!n)return;let l=e.token;if(e.key=l,void 0!==e.vector_stores&&(e.object_permission={...r.object_permission,vector_stores:e.vector_stores||[]},delete e.vector_stores),void 0!==e.mcp_servers&&(e.object_permission={...r.object_permission,mcp_servers:e.mcp_servers||[]},delete e.mcp_servers),e.metadata&&"string"==typeof e.metadata)try{let t=JSON.parse(e.metadata);e.metadata={...t,...(null===(s=e.guardrails)||void 0===s?void 0:s.length)>0?{guardrails:e.guardrails}:{},...e.logging_settings?{logging:e.logging_settings}:{}}}catch(e){console.error("Error parsing metadata JSON:",e),z.ZP.error("Invalid metadata JSON");return}else e.metadata={...e.metadata||{},...(null===(t=e.guardrails)||void 0===t?void 0:t.length)>0?{guardrails:e.guardrails}:{},...e.logging_settings?{logging:e.logging_settings}:{}};delete e.logging_settings,e.budget_duration&&(e.budget_duration=({daily:"24h",weekly:"7d",monthly:"30d"})[e.budget_duration]);let a=await (0,y.Nc)(n,e);d&&d(a),z.ZP.success("Key updated successfully"),g(!1)}catch(e){z.ZP.error("Failed to update key"),console.error("Error updating key:",e)}},Z=async()=>{try{if(!n)return;await (0,y.I1)(n,r.token),z.ZP.success("Key deleted successfully"),m&&m(),a()}catch(e){console.error("Error deleting the key:",e),z.ZP.error("Failed to delete key")}};return(0,h.jsxs)("div",{className:"w-full h-screen p-4",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(P.Z,{icon:e8.Z,variant:"light",onClick:a,className:"mb-4",children:"Back to Keys"}),(0,h.jsx)(M.Z,{children:r.key_alias||"API Key"}),(0,h.jsx)(O.Z,{className:"text-gray-500 font-mono",children:r.token})]}),o&&ez.includes(o)&&(0,h.jsxs)("div",{className:"flex gap-2",children:[(0,h.jsx)(X.Z,{title:u?"":"This is a LiteLLM Enterprise feature, and requires a valid key to use.",children:(0,h.jsx)("span",{className:"inline-block",children:(0,h.jsx)(P.Z,{icon:e7.Z,variant:"secondary",onClick:()=>b(!0),className:"flex items-center",disabled:!u,children:"Regenerate Key"})})}),(0,h.jsx)(P.Z,{icon:em.Z,variant:"secondary",onClick:()=>v(!0),className:"flex items-center",children:"Delete Key"})]})]}),(0,h.jsx)(sr,{selectedToken:r,visible:_,onClose:()=>b(!1),accessToken:n,premiumUser:u}),f&&(0,h.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,h.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,h.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,h.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,h.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,h.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,h.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,h.jsx)("div",{className:"sm:flex sm:items-start",children:(0,h.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,h.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Key"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this key?"})})]})})}),(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)(P.Z,{onClick:Z,color:"red",className:"ml-2",children:"Delete"}),(0,h.jsx)(P.Z,{onClick:()=>v(!1),children:"Cancel"})]})]})]})}),(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{className:"mb-4",children:[(0,h.jsx)(e2.Z,{children:"Overview"}),(0,h.jsx)(e2.Z,{children:"Settings"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Spend"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsxs)(M.Z,{children:["$",eH(r.spend,4)]}),(0,h.jsxs)(O.Z,{children:["of ",null!==r.max_budget?"$".concat(eH(r.max_budget)):"Unlimited"]})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Rate Limits"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsxs)(O.Z,{children:["TPM: ",null!==r.tpm_limit?r.tpm_limit:"Unlimited"]}),(0,h.jsxs)(O.Z,{children:["RPM: ",null!==r.rpm_limit?r.rpm_limit:"Unlimited"]})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Models"}),(0,h.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:r.models&&r.models.length>0?r.models.map((e,s)=>(0,h.jsx)(e1.Z,{color:"red",children:e},s)):(0,h.jsx)(O.Z,{children:"No models specified"})})]}),(0,h.jsx)(eo.Z,{children:(0,h.jsx)(sd,{objectPermission:r.object_permission,variant:"inline",accessToken:n})}),(0,h.jsx)(sm,{loggingConfigs:st(r.metadata),variant:"card"})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(eo.Z,{className:"overflow-y-auto max-h-[65vh]",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(M.Z,{children:"Key Settings"}),!p&&o&&ez.includes(o)&&(0,h.jsx)(P.Z,{variant:"light",onClick:()=>g(!0),children:"Edit Settings"})]}),p?(0,h.jsx)(sa,{keyData:r,onCancel:()=>g(!1),onSubmit:N,teams:c,accessToken:n,userID:i,userRole:o}):(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Key ID"}),(0,h.jsx)(O.Z,{className:"font-mono",children:r.token})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Key Alias"}),(0,h.jsx)(O.Z,{children:r.key_alias||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Secret Key"}),(0,h.jsx)(O.Z,{className:"font-mono",children:r.key_name})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Team ID"}),(0,h.jsx)(O.Z,{children:r.team_id||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Organization"}),(0,h.jsx)(O.Z,{children:r.organization_id||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Created"}),(0,h.jsx)(O.Z,{children:new Date(r.created_at).toLocaleString()})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Expires"}),(0,h.jsx)(O.Z,{children:r.expires?new Date(r.expires).toLocaleString():"Never"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Spend"}),(0,h.jsxs)(O.Z,{children:["$",eH(r.spend,4)," USD"]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Budget"}),(0,h.jsx)(O.Z,{children:null!==r.max_budget?"$".concat(eH(r.max_budget,2)):"Unlimited"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Models"}),(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:r.models&&r.models.length>0?r.models.map((e,s)=>(0,h.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:e},s)):(0,h.jsx)(O.Z,{children:"No models specified"})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Rate Limits"}),(0,h.jsxs)(O.Z,{children:["TPM: ",null!==r.tpm_limit?r.tpm_limit:"Unlimited"]}),(0,h.jsxs)(O.Z,{children:["RPM: ",null!==r.rpm_limit?r.rpm_limit:"Unlimited"]}),(0,h.jsxs)(O.Z,{children:["Max Parallel Requests: ",null!==r.max_parallel_requests?r.max_parallel_requests:"Unlimited"]}),(0,h.jsxs)(O.Z,{children:["Model TPM Limits: ",(null===(s=r.metadata)||void 0===s?void 0:s.model_tpm_limit)?JSON.stringify(r.metadata.model_tpm_limit):"Unlimited"]}),(0,h.jsxs)(O.Z,{children:["Model RPM Limits: ",(null===(t=r.metadata)||void 0===t?void 0:t.model_rpm_limit)?JSON.stringify(r.metadata.model_rpm_limit):"Unlimited"]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Metadata"}),(0,h.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:sl(r.metadata)})]}),(0,h.jsx)(sd,{objectPermission:r.object_permission,variant:"inline",className:"pt-4 border-t border-gray-200",accessToken:n}),(0,h.jsx)(sm,{loggingConfigs:st(r.metadata),variant:"inline",className:"pt-4 border-t border-gray-200"})]})]})})]})]})]})}var sh=t(2356),sx=e=>{let{options:s,onApplyFilters:t,onResetFilters:l,initialValues:a={},buttonLabel:r="Filters"}=e,[n,i]=(0,x.useState)(!1),[o,c]=(0,x.useState)(a),[d,m]=(0,x.useState)({}),[u,p]=(0,x.useState)({}),[g,j]=(0,x.useState)({}),f=(0,x.useCallback)(eD()(async(e,s)=>{if(s.isSearchable&&s.searchFn){p(e=>({...e,[s.name]:!0}));try{let t=await s.searchFn(e);m(e=>({...e,[s.name]:t}))}catch(e){console.error("Error searching:",e),m(e=>({...e,[s.name]:[]}))}finally{p(e=>({...e,[s.name]:!1}))}}},300),[]),v=(e,s)=>{let l={...o,[e]:s};c(l),t(l)};return(0,h.jsxs)("div",{className:"w-full",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,h.jsx)(V.ZP,{icon:(0,h.jsx)(sh.Z,{className:"h-4 w-4"}),onClick:()=>i(!n),className:"flex items-center gap-2",children:r}),(0,h.jsx)(V.ZP,{onClick:()=>{let e={};s.forEach(s=>{e[s.name]=""}),c(e),l()},children:"Reset Filters"})]}),n&&(0,h.jsx)("div",{className:"grid grid-cols-3 gap-x-6 gap-y-4 mb-6",children:["Team ID","Status","Organization ID","Key Alias","User ID","Key Hash","Model"].map(e=>{let t=s.find(s=>s.label===e||s.name===e);return t?(0,h.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:t.label||t.name}),t.isSearchable?(0,h.jsx)(F.default,{showSearch:!0,className:"w-full",placeholder:"Search ".concat(t.label||t.name,"..."),value:o[t.name]||void 0,onChange:e=>v(t.name,e),onSearch:e=>{j(s=>({...s,[t.name]:e})),t.searchFn&&f(e,t)},filterOption:!1,loading:u[t.name],options:d[t.name]||[],allowClear:!0}):t.options?(0,h.jsx)(F.default,{className:"w-full",placeholder:"Select ".concat(t.label||t.name,"..."),value:o[t.name]||void 0,onChange:e=>v(t.name,e),allowClear:!0,children:t.options.map(e=>(0,h.jsx)(F.default.Option,{value:e.value,children:e.label},e.value))}):(0,h.jsx)(K.default,{className:"w-full",placeholder:"Enter ".concat(t.label||t.name,"..."),value:o[t.name]||"",onChange:e=>v(t.name,e.target.value),allowClear:!0})]},t.name):null})})]})},sp=t(16593);let sg=async e=>{if(!e)return[];try{let s=[],t=1,l=!0;for(;l;){let a=await (0,y.OD)(e,null,"",null,null,null,t,100),r=a.keys.map(e=>e.key_alias).filter(Boolean);s=[...s,...r],t<a.total_pages?t++:l=!1}return Array.from(new Set(s))}catch(e){return console.error("Error fetching all key aliases:",e),[]}},sj=async(e,s)=>{if(!e)return[];try{let t=[],l=1,a=!0;for(;a;){let r=await (0,y.It)(e,s||null,null);t=[...t,...r],l<r.total_pages?l++:a=!1}return t}catch(e){return console.error("Error fetching all teams:",e),[]}},sf=async e=>{if(!e)return[];try{let s=[],t=1,l=!0;for(;l;){let a=await (0,y.r6)(e);s=[...s,...a],t<a.total_pages?t++:l=!1}return s}catch(e){return console.error("Error fetching all organizations:",e),[]}},sv=()=>{let[e,s]=(0,x.useState)("http://localhost:4000");return(0,x.useEffect)(()=>{{let{protocol:e,host:t}=window.location;s("".concat(e,"//").concat(t))}},[]),e};var s_=t(71594),sy=t(24525),sb=t(47323),sN=t(21626),sZ=t(97214),sw=t(28241),sk=t(58834),sS=t(69552),sC=t(71876),sI=t(86462),sP=t(47686),sA=t(44633),sT=t(49084);function sE(e){let{keys:s,setKeys:t,isLoading:l=!1,pagination:a,onPageChange:r,pageSize:n=50,teams:i,selectedTeam:o,setSelectedTeam:c,selectedKeyAlias:d,setSelectedKeyAlias:m,accessToken:u,userID:p,userRole:g,organizations:j,setCurrentOrg:f,refresh:v,onSortChange:_,currentSort:b,premiumUser:N}=e,[Z,w]=(0,x.useState)(null),[k,S]=(0,x.useState)([]),[C,I]=x.useState(()=>b?[{id:b.sortBy,desc:"desc"===b.sortOrder}]:[{id:"created_at",desc:!0}]),[A,T]=(0,x.useState)({}),{filters:E,filteredKeys:L,allKeyAliases:M,allTeams:D,allOrganizations:F,handleFilterChange:R,handleFilterReset:z}=function(e){let{keys:s,teams:t,organizations:l,accessToken:a}=e,r={"Team ID":"","Organization ID":"","Key Alias":"","User ID":"","Sort By":"created_at","Sort Order":"desc"},[n,i]=(0,x.useState)(r),[o,c]=(0,x.useState)(t||[]),[d,m]=(0,x.useState)(l||[]),[u,h]=(0,x.useState)(s),p=(0,x.useRef)(0),g=(0,x.useCallback)(eD()(async e=>{if(!a)return;let s=Date.now();p.current=s;try{let t=await (0,y.OD)(a,e["Organization ID"]||null,e["Team ID"]||null,e["Key Alias"]||null,e["User ID"]||null,e["Key Hash"]||null,1,25,e["Sort By"]||null,e["Sort Order"]||null);s===p.current&&t&&(h(t.keys),console.log("called from debouncedSearch filters:",JSON.stringify(e)),console.log("called from debouncedSearch data:",JSON.stringify(t)))}catch(e){console.error("Error searching users:",e)}},300),[a]);(0,x.useEffect)(()=>{if(!s){h([]);return}let e=[...s];n["Team ID"]&&(e=e.filter(e=>e.team_id===n["Team ID"])),n["Organization ID"]&&(e=e.filter(e=>e.organization_id===n["Organization ID"])),h(e)},[s,n]),(0,x.useEffect)(()=>{let e=async()=>{let e=await sj(a);e.length>0&&c(e);let s=await sf(a);s.length>0&&m(s)};a&&e()},[a]);let j=(0,sp.a)({queryKey:["allKeys"],queryFn:async()=>{if(!a)throw Error("Access token required");return await sg(a)},enabled:!!a}).data||[];return(0,x.useEffect)(()=>{t&&t.length>0&&c(e=>e.length<t.length?t:e)},[t]),(0,x.useEffect)(()=>{l&&l.length>0&&m(e=>e.length<l.length?l:e)},[l]),{filters:n,filteredKeys:u,allKeyAliases:j,allTeams:o,allOrganizations:d,handleFilterChange:e=>{i({"Team ID":e["Team ID"]||"","Organization ID":e["Organization ID"]||"","Key Alias":e["Key Alias"]||"","User ID":e["User ID"]||"","Sort By":e["Sort By"]||"created_at","Sort Order":e["Sort Order"]||"desc"}),g({...n,...e})},handleFilterReset:()=>{i(r),g(r)}}}({keys:s,teams:i,organizations:j,accessToken:u});(0,x.useEffect)(()=>{if(u){let e=s.map(e=>e.user_id).filter(e=>null!==e);(async()=>{S((await (0,y.Of)(u,e,1,100)).users)})()}},[u,s]),(0,x.useEffect)(()=>{if(v){let e=()=>{v()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}},[v]);let q=[{id:"expander",header:()=>null,cell:e=>{let{row:s}=e;return s.getCanExpand()?(0,h.jsx)("button",{onClick:s.getToggleExpandedHandler(),style:{cursor:"pointer"},children:s.getIsExpanded()?"▼":"▶"}):null}},{id:"token",accessorKey:"token",header:"Key ID",cell:e=>(0,h.jsx)("div",{className:"overflow-hidden",children:(0,h.jsx)(X.Z,{title:e.getValue(),children:(0,h.jsx)(P.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>w(e.getValue()),children:e.getValue()?"".concat(e.getValue().slice(0,7),"..."):"-"})})})},{id:"key_alias",accessorKey:"key_alias",header:"Key Alias",cell:e=>{let s=e.getValue();return(0,h.jsx)(X.Z,{title:s,children:s?s.length>20?"".concat(s.slice(0,20),"..."):s:"-"})}},{id:"key_name",accessorKey:"key_name",header:"Secret Key",cell:e=>(0,h.jsx)("span",{className:"font-mono text-xs",children:e.getValue()})},{id:"team_alias",accessorKey:"team_id",header:"Team Alias",cell:e=>{let{row:s,getValue:t}=e,l=t(),a=null==i?void 0:i.find(e=>e.team_id===l);return(null==a?void 0:a.team_alias)||"Unknown"}},{id:"team_id",accessorKey:"team_id",header:"Team ID",cell:e=>(0,h.jsx)(X.Z,{title:e.getValue(),children:e.getValue()?"".concat(e.getValue().slice(0,7),"..."):"-"})},{id:"organization_id",accessorKey:"organization_id",header:"Organization ID",cell:e=>e.getValue()?e.renderValue():"-"},{id:"user_email",accessorKey:"user_id",header:"User Email",cell:e=>{let s=e.getValue(),t=k.find(e=>e.user_id===s);return(null==t?void 0:t.user_email)?(0,h.jsx)(X.Z,{title:null==t?void 0:t.user_email,children:(0,h.jsxs)("span",{children:[null==t?void 0:t.user_email.slice(0,20),"..."]})}):"-"}},{id:"user_id",accessorKey:"user_id",header:"User ID",cell:e=>{let s=e.getValue();return s&&s.length>15?(0,h.jsx)(X.Z,{title:s,children:(0,h.jsxs)("span",{children:[s.slice(0,7),"..."]})}):s||"-"}},{id:"created_at",accessorKey:"created_at",header:"Created At",cell:e=>{let s=e.getValue();return s?new Date(s).toLocaleDateString():"-"}},{id:"created_by",accessorKey:"created_by",header:"Created By",cell:e=>{let s=e.getValue();return s&&s.length>15?(0,h.jsx)(X.Z,{title:s,children:(0,h.jsxs)("span",{children:[s.slice(0,7),"..."]})}):s}},{id:"updated_at",accessorKey:"updated_at",header:"Updated At",cell:e=>{let s=e.getValue();return s?new Date(s).toLocaleDateString():"Never"}},{id:"expires",accessorKey:"expires",header:"Expires",cell:e=>{let s=e.getValue();return s?new Date(s).toLocaleDateString():"Never"}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",cell:e=>eH(e.getValue(),4)},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",cell:e=>{let s=e.getValue();return null===s?"Unlimited":"$".concat(eH(s))}},{id:"budget_reset_at",accessorKey:"budget_reset_at",header:"Budget Reset",cell:e=>{let s=e.getValue();return s?new Date(s).toLocaleString():"Never"}},{id:"models",accessorKey:"models",header:"Models",cell:e=>{let s=e.getValue();return(0,h.jsx)("div",{className:"flex flex-col py-2",children:Array.isArray(s)?(0,h.jsx)("div",{className:"flex flex-col",children:0===s.length?(0,h.jsx)(e1.Z,{size:"xs",className:"mb-1",color:"red",children:(0,h.jsx)(O.Z,{children:"All Proxy Models"})}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"flex items-start",children:[s.length>3&&(0,h.jsx)("div",{children:(0,h.jsx)(sb.Z,{icon:A[e.row.id]?sI.Z:sP.Z,className:"cursor-pointer",size:"xs",onClick:()=>{T(s=>({...s,[e.row.id]:!s[e.row.id]}))}})}),(0,h.jsxs)("div",{className:"flex flex-wrap gap-1",children:[s.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,h.jsx)(e1.Z,{size:"xs",color:"red",children:(0,h.jsx)(O.Z,{children:"All Proxy Models"})},s):(0,h.jsx)(e1.Z,{size:"xs",color:"blue",children:(0,h.jsx)(O.Z,{children:e.length>30?"".concat(J(e).slice(0,30),"..."):J(e)})},s)),s.length>3&&!A[e.row.id]&&(0,h.jsx)(e1.Z,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,h.jsxs)(O.Z,{children:["+",s.length-3," ",s.length-3==1?"more model":"more models"]})}),A[e.row.id]&&(0,h.jsx)("div",{className:"flex flex-wrap gap-1",children:s.slice(3).map((e,s)=>"all-proxy-models"===e?(0,h.jsx)(e1.Z,{size:"xs",color:"red",children:(0,h.jsx)(O.Z,{children:"All Proxy Models"})},s+3):(0,h.jsx)(e1.Z,{size:"xs",color:"blue",children:(0,h.jsx)(O.Z,{children:e.length>30?"".concat(J(e).slice(0,30),"..."):J(e)})},s+3))})]})]})})}):null})}},{id:"rate_limits",header:"Rate Limits",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{children:["TPM: ",null!==t.tpm_limit?t.tpm_limit:"Unlimited"]}),(0,h.jsxs)("div",{children:["RPM: ",null!==t.rpm_limit?t.rpm_limit:"Unlimited"]})]})}}];console.log("keys: ".concat(JSON.stringify(s)));let U=(0,s_.b7)({data:L,columns:q.filter(e=>"expander"!==e.id),state:{sorting:C},onSortingChange:e=>{let s="function"==typeof e?e(C):e;if(console.log("newSorting: ".concat(JSON.stringify(s))),I(s),s&&s.length>0){let e=s[0],t=e.id,l=e.desc?"desc":"asc";console.log("sortBy: ".concat(t,", sortOrder: ").concat(l)),R({...E,"Sort By":t,"Sort Order":l}),null==_||_(t,l)}},getCoreRowModel:(0,sy.sC)(),getSortedRowModel:(0,sy.tj)(),enableSorting:!0,manualSorting:!1});return x.useEffect(()=>{b&&I([{id:b.sortBy,desc:"desc"===b.sortOrder}])},[b]),(0,h.jsx)("div",{className:"w-full h-full overflow-hidden",children:Z?(0,h.jsx)(su,{keyId:Z,onClose:()=>w(null),keyData:L.find(e=>e.token===Z),onKeyDataUpdate:e=>{t(s=>s.map(s=>s.token===e.token?eB(s,e):s))},onDelete:()=>{t(e=>e.filter(e=>e.token!==Z))},accessToken:u,userID:p,userRole:g,teams:D,premiumUser:N}):(0,h.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,h.jsx)("div",{className:"w-full mb-6",children:(0,h.jsx)(sx,{options:[{name:"Team ID",label:"Team ID",isSearchable:!0,searchFn:async e=>D&&0!==D.length?D.filter(s=>s.team_id.toLowerCase().includes(e.toLowerCase())||s.team_alias&&s.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:"".concat(e.team_alias||e.team_id," (").concat(e.team_id,")"),value:e.team_id})):[]},{name:"Organization ID",label:"Organization ID",isSearchable:!0,searchFn:async e=>F&&0!==F.length?F.filter(s=>{var t,l;return null!==(l=null===(t=s.organization_id)||void 0===t?void 0:t.toLowerCase().includes(e.toLowerCase()))&&void 0!==l&&l}).filter(e=>null!==e.organization_id&&void 0!==e.organization_id).map(e=>({label:"".concat(e.organization_id||"Unknown"," (").concat(e.organization_id,")"),value:e.organization_id})):[]},{name:"Key Alias",label:"Key Alias",isSearchable:!0,searchFn:async e=>M.filter(s=>s.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e}))},{name:"User ID",label:"User ID",isSearchable:!1},{name:"Key Hash",label:"Key Hash",isSearchable:!1}],onApplyFilters:R,initialValues:E,onResetFilters:z})}),(0,h.jsxs)("div",{className:"flex items-center justify-between w-full mb-4",children:[(0,h.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",l?"...":"".concat((a.currentPage-1)*n+1," - ").concat(Math.min(a.currentPage*n,a.totalCount))," of ",l?"...":a.totalCount," results"]}),(0,h.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,h.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",l?"...":a.currentPage," of ",l?"...":a.totalPages]}),(0,h.jsx)("button",{onClick:()=>r(a.currentPage-1),disabled:l||1===a.currentPage,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,h.jsx)("button",{onClick:()=>r(a.currentPage+1),disabled:l||a.currentPage===a.totalPages,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),(0,h.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,h.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsxs)(sN.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,h.jsx)(sk.Z,{children:U.getHeaderGroups().map(e=>(0,h.jsx)(sC.Z,{children:e.headers.map(e=>(0,h.jsx)(sS.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,h.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,h.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,s_.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,h.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,h.jsx)(sA.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,h.jsx)(sI.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,h.jsx)(sT.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,h.jsx)(sZ.Z,{children:l?(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:q.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:"\uD83D\uDE85 Loading keys..."})})})}):L.length>0?U.getRowModel().rows.map(e=>(0,h.jsx)(sC.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,h.jsx)(sw.Z,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("models"===e.column.id&&e.getValue().length>3?"px-0":""),children:(0,s_.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:q.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:"No keys found"})})})})})]})})})})]})})}var sL=e=>{let{userID:s,userRole:t,accessToken:l,selectedTeam:a,setSelectedTeam:r,data:n,setData:i,teams:o,premiumUser:c,currentOrg:d,organizations:m,setCurrentOrg:u,selectedKeyAlias:p,setSelectedKeyAlias:g,createClicked:j}=e,[f,v]=(0,x.useState)(!1),[_,b]=(0,x.useState)(!1),[N,Z]=(0,x.useState)(null),[w,k]=(0,x.useState)(null),[S,T]=(0,x.useState)(null),[E,L]=(0,x.useState)((null==a?void 0:a.team_id)||"");(0,x.useEffect)(()=>{L((null==a?void 0:a.team_id)||"")},[a]);let{keys:F,isLoading:U,error:V,pagination:K,refresh:B,setKeys:H}=eQ({selectedTeam:a,currentOrg:d,selectedKeyAlias:p,accessToken:l,createClicked:j}),[J,Y]=(0,x.useState)(!1),[$,X]=(0,x.useState)(!1),[Q,ee]=(0,x.useState)(null),[es,et]=(0,x.useState)([]),el=new Set,[ea,er]=(0,x.useState)(!1),[en,ei]=(0,x.useState)(!1),[eo,ec]=(0,x.useState)(null),[ed,em]=(0,x.useState)(null),[eu]=R.Z.useForm(),[eh,ex]=(0,x.useState)(null),[ep,eg]=(0,x.useState)(el),[ej,ef]=(0,x.useState)([]);(0,x.useEffect)(()=>{console.log("in calculateNewExpiryTime for selectedToken",Q),(null==ed?void 0:ed.duration)?ex((e=>{if(!e)return null;try{let s;let t=new Date;if(e.endsWith("s"))s=(0,eX.Z)(t,{seconds:parseInt(e)});else if(e.endsWith("h"))s=(0,eX.Z)(t,{hours:parseInt(e)});else if(e.endsWith("d"))s=(0,eX.Z)(t,{days:parseInt(e)});else throw Error("Invalid duration format");return s.toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})}catch(e){return null}})(ed.duration)):ex(null),console.log("calculateNewExpiryTime:",eh)},[Q,null==ed?void 0:ed.duration]),(0,x.useEffect)(()=>{(async()=>{try{if(null===s||null===t||null===l)return;let e=await G(s,t,l);e&&et(e)}catch(e){console.error("Error fetching user models:",e)}})()},[l,s,t]),(0,x.useEffect)(()=>{if(o){let e=new Set;o.forEach((s,t)=>{let l=s.team_id;e.add(l)}),eg(e)}},[o]);let ev=async()=>{if(null!=N&&null!=n){try{await (0,y.I1)(l,N);let e=n.filter(e=>e.token!==N);i(e)}catch(e){console.error("Error deleting the key:",e)}b(!1),Z(null)}},e_=(e,s)=>{em(t=>({...t,[e]:s}))},ey=async()=>{if(!c){z.ZP.error("Regenerate API Key is an Enterprise feature. Please upgrade to use this feature.");return}if(null!=Q)try{let e=await eu.validateFields(),s=await (0,y.s0)(l,Q.token,e);if(ec(s.key),n){let t=n.map(t=>t.token===(null==Q?void 0:Q.token)?{...t,key_name:s.key_name,...e}:t);i(t)}ei(!1),eu.resetFields(),z.ZP.success("API Key regenerated successfully")}catch(e){console.error("Error regenerating key:",e),z.ZP.error("Failed to regenerate API Key")}};return(0,h.jsxs)("div",{children:[(0,h.jsx)(sE,{keys:F,setKeys:H,isLoading:U,pagination:K,onPageChange:e=>{B({page:e})},pageSize:100,teams:o,selectedTeam:a,setSelectedTeam:r,accessToken:l,userID:s,userRole:t,organizations:m,setCurrentOrg:u,refresh:B,selectedKeyAlias:p,setSelectedKeyAlias:g,premiumUser:c}),_&&(0,h.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,h.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,h.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,h.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,h.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,h.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,h.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,h.jsx)("div",{className:"sm:flex sm:items-start",children:(0,h.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,h.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Key"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this key ?"})})]})})}),(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)(P.Z,{onClick:ev,color:"red",className:"ml-2",children:"Delete"}),(0,h.jsx)(P.Z,{onClick:()=>{b(!1),Z(null)},children:"Cancel"})]})]})]})}),(0,h.jsx)(q.Z,{title:"Regenerate API Key",visible:en,onCancel:()=>{ei(!1),eu.resetFields()},footer:[(0,h.jsx)(P.Z,{onClick:()=>{ei(!1),eu.resetFields()},className:"mr-2",children:"Cancel"},"cancel"),(0,h.jsx)(P.Z,{onClick:ey,disabled:!c,children:c?"Regenerate":"Upgrade to Regenerate"},"regenerate")],children:c?(0,h.jsxs)(R.Z,{form:eu,layout:"vertical",onValuesChange:(e,s)=>{"duration"in e&&e_("duration",e.duration)},children:[(0,h.jsx)(R.Z.Item,{name:"key_alias",label:"Key Alias",children:(0,h.jsx)(A.Z,{disabled:!0})}),(0,h.jsx)(R.Z.Item,{name:"max_budget",label:"Max Budget (USD)",children:(0,h.jsx)(W.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{name:"tpm_limit",label:"TPM Limit",children:(0,h.jsx)(W.Z,{style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{name:"rpm_limit",label:"RPM Limit",children:(0,h.jsx)(W.Z,{style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{name:"duration",label:"Expire Key (eg: 30s, 30h, 30d)",className:"mt-8",children:(0,h.jsx)(A.Z,{placeholder:""})}),(0,h.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Current expiry:"," ",(null==Q?void 0:Q.expires)!=null?new Date(Q.expires).toLocaleString():"Never"]}),eh&&(0,h.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["New expiry: ",eh]})]}):(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"mb-2 text-gray-500 italic text-[12px]",children:"Upgrade to use this feature"}),(0,h.jsx)(P.Z,{variant:"primary",className:"mb-2",children:(0,h.jsx)("a",{href:"https://calendly.com/d/4mp-gd3-k5k/litellm-1-1-onboarding-chat",target:"_blank",children:"Get Free Trial"})})]})}),eo&&(0,h.jsx)(q.Z,{visible:!!eo,onCancel:()=>ec(null),footer:[(0,h.jsx)(P.Z,{onClick:()=>ec(null),children:"Close"},"close")],children:(0,h.jsxs)(I.Z,{numItems:1,className:"gap-2 w-full",children:[(0,h.jsx)(M.Z,{children:"Regenerated Key"}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)("p",{children:["Please replace your old key with the new key generated. For security reasons, ",(0,h.jsx)("b",{children:"you will not be able to view it again"})," ","through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,h.jsxs)(C.Z,{numColSpan:1,children:[(0,h.jsx)(O.Z,{className:"mt-3",children:"Key Alias:"}),(0,h.jsx)("div",{style:{background:"#f8f8f8",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:(0,h.jsx)("pre",{style:{wordWrap:"break-word",whiteSpace:"normal"},children:(null==Q?void 0:Q.key_alias)||"No alias set"})}),(0,h.jsx)(O.Z,{className:"mt-3",children:"New API Key:"}),(0,h.jsx)("div",{style:{background:"#f8f8f8",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:(0,h.jsx)("pre",{style:{wordWrap:"break-word",whiteSpace:"normal"},children:eo})}),(0,h.jsx)(D.CopyToClipboard,{text:eo,onCopy:()=>z.ZP.success("API Key copied to clipboard"),children:(0,h.jsx)(P.Z,{className:"mt-3",children:"Copy API Key"})})]})]})})]})},sO=t(12011),sM=e=>{let{userID:s,userRole:t,teams:l,keys:a,setUserRole:r,userEmail:n,setUserEmail:i,setTeams:o,setKeys:c,premiumUser:d,organizations:m,addKey:u,createClicked:j}=e,[f,v]=(0,x.useState)(null),[_,b]=(0,x.useState)(null),N=(0,p.useSearchParams)(),w=function(e){console.log("COOKIES",document.cookie);let s=document.cookie.split("; ").find(s=>s.startsWith(e+"="));return s?s.split("=")[1]:null}("token"),k=N.get("invitation_id"),[P,A]=(0,x.useState)(null),[T,E]=(0,x.useState)(null),[L,O]=(0,x.useState)([]),[M,D]=(0,x.useState)(null),[F,R]=(0,x.useState)(null),[z,q]=(0,x.useState)(null);if(window.addEventListener("beforeunload",function(){sessionStorage.clear()}),(0,x.useEffect)(()=>{if(w){let e=(0,g.o)(w);if(e){if(console.log("Decoded token:",e),console.log("Decoded key:",e.key),A(e.key),e.user_role){let s=function(e){if(!e)return"Undefined Role";switch(console.log("Received user role: ".concat(e)),e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"app_user":return"App User";case"internal_user":return"Internal User";case"internal_user_viewer":return"Internal Viewer";default:return"Unknown Role"}}(e.user_role);console.log("Decoded user_role:",s),r(s)}else console.log("User role not defined");e.user_email?i(e.user_email):console.log("User Email is not set ".concat(e))}}if(s&&P&&t&&!a&&!f){let e=sessionStorage.getItem("userModels"+s);e?O(JSON.parse(e)):(console.log("currentOrg: ".concat(JSON.stringify(_))),(async()=>{try{let e=await (0,y.g)(P);D(e);let l=await (0,y.Br)(P,s,t,!1,null,null);v(l.user_info),console.log("userSpendData: ".concat(JSON.stringify(f))),(null==l?void 0:l.teams[0].keys)?c(l.keys.concat(l.teams.filter(e=>"Admin"===t||e.user_id===s).flatMap(e=>e.keys))):c(l.keys),sessionStorage.setItem("userData"+s,JSON.stringify(l.keys)),sessionStorage.setItem("userSpendData"+s,JSON.stringify(l.user_info));let a=(await (0,y.So)(P,s,t)).data.map(e=>e.id);console.log("available_model_names:",a),O(a),console.log("userModels:",L),sessionStorage.setItem("userModels"+s,JSON.stringify(a))}catch(e){console.error("There was an error fetching the data",e),e.message.includes("Invalid proxy server token passed")&&U()}})(),S(P,s,t,_,o))}},[s,w,P,a,t]),(0,x.useEffect)(()=>{P&&(async()=>{try{let e=await (0,y.e2)(P,[P]);console.log("keyInfo: ",e)}catch(e){e.message.includes("Invalid proxy server token passed")&&U()}})()},[P]),(0,x.useEffect)(()=>{console.log("currentOrg: ".concat(JSON.stringify(_),", accessToken: ").concat(P,", userID: ").concat(s,", userRole: ").concat(t)),P&&(console.log("fetching teams"),S(P,s,t,_,o))},[_]),(0,x.useEffect)(()=>{if(null!==a&&null!=F&&null!==F.team_id){let e=0;for(let s of(console.log("keys: ".concat(JSON.stringify(a))),a))F.hasOwnProperty("team_id")&&null!==s.team_id&&s.team_id===F.team_id&&(e+=s.spend);console.log("sum: ".concat(e)),E(e)}else if(null!==a){let e=0;for(let s of a)e+=s.spend;E(e)}},[F]),null!=k)return(0,h.jsx)(sO.default,{});function U(){(0,Z.b)();let e=(0,y.zX)();console.log("proxyBaseUrl:",e);let s=e?"".concat(e,"/sso/key/generate"):"/sso/key/generate";return console.log("Full URL:",s),window.location.href=s,null}if(null==w)return console.log("All cookies before redirect:",document.cookie),U(),null;try{let e=(0,g.o)(w);console.log("Decoded token:",e);let s=e.exp,t=Math.floor(Date.now()/1e3);if(s&&t>=s)return console.log("Token expired, redirecting to login"),U(),null}catch(e){return console.error("Error decoding token:",e),(0,Z.b)(),U(),null}if(null==P)return null;if(null==s)return(0,h.jsx)("h1",{children:"User ID is not set"});if(null==t&&r("App Owner"),t&&"Admin Viewer"==t){let{Title:e,Paragraph:s}=ef.default;return(0,h.jsxs)("div",{children:[(0,h.jsx)(e,{level:1,children:"Access Denied"}),(0,h.jsx)(s,{children:"Ask your proxy admin for access to create keys"})]})}return console.log("inside user dashboard, selected team",F),console.log("All cookies after redirect:",document.cookie),(0,h.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,h.jsx)(I.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,h.jsxs)(C.Z,{numColSpan:1,className:"flex flex-col gap-2",children:[(0,h.jsx)(e$,{userID:s,team:F,teams:l,userRole:t,accessToken:P,data:a,addKey:u,premiumUser:d},F?F.team_id:null),(0,h.jsx)(sL,{userID:s,userRole:t,accessToken:P,selectedTeam:F||null,setSelectedTeam:R,selectedKeyAlias:z,setSelectedKeyAlias:q,data:a,setData:c,premiumUser:d,teams:l,currentOrg:_,setCurrentOrg:b,organizations:m,createClicked:j})]})})})},sD=t(97765);(a=c||(c={})).OpenAI="OpenAI",a.OpenAI_Compatible="OpenAI-Compatible Endpoints (Together AI, etc.)",a.OpenAI_Text="OpenAI Text Completion",a.OpenAI_Text_Compatible="OpenAI-Compatible Text Completion Models (Together AI, etc.)",a.Azure="Azure",a.Azure_AI_Studio="Azure AI Foundry (Studio)",a.Anthropic="Anthropic",a.Vertex_AI="Vertex AI (Anthropic, Gemini, etc.)",a.Google_AI_Studio="Google AI Studio",a.Bedrock="Amazon Bedrock",a.Groq="Groq",a.MistralAI="Mistral AI",a.Deepseek="Deepseek",a.Cohere="Cohere",a.Databricks="Databricks",a.Ollama="Ollama",a.xAI="xAI",a.AssemblyAI="AssemblyAI",a.Cerebras="Cerebras",a.Sambanova="Sambanova",a.Perplexity="Perplexity",a.TogetherAI="TogetherAI",a.Openrouter="Openrouter",a.FireworksAI="Fireworks AI",a.Triton="Triton",a.Deepgram="Deepgram",a.ElevenLabs="ElevenLabs";let sF={OpenAI:"openai",OpenAI_Text:"text-completion-openai",Azure:"azure",Azure_AI_Studio:"azure_ai",Anthropic:"anthropic",Google_AI_Studio:"gemini",Bedrock:"bedrock",Groq:"groq",MistralAI:"mistral",Cohere:"cohere",OpenAI_Compatible:"openai",OpenAI_Text_Compatible:"text-completion-openai",Vertex_AI:"vertex_ai",Databricks:"databricks",xAI:"xai",Deepseek:"deepseek",Ollama:"ollama",AssemblyAI:"assemblyai",Cerebras:"cerebras",Sambanova:"sambanova",Perplexity:"perplexity",TogetherAI:"together_ai",Openrouter:"openrouter",FireworksAI:"fireworks_ai",Triton:"triton",Deepgram:"deepgram",ElevenLabs:"elevenlabs"},sR="/ui/assets/logos/",sz={Anthropic:"".concat(sR,"anthropic.svg"),AssemblyAI:"".concat(sR,"assemblyai_small.png"),Azure:"".concat(sR,"microsoft_azure.svg"),"Azure AI Foundry (Studio)":"".concat(sR,"microsoft_azure.svg"),"Amazon Bedrock":"".concat(sR,"bedrock.svg"),Cerebras:"".concat(sR,"cerebras.svg"),Cohere:"".concat(sR,"cohere.svg"),Databricks:"".concat(sR,"databricks.svg"),Deepseek:"".concat(sR,"deepseek.svg"),"Fireworks AI":"".concat(sR,"fireworks.svg"),Groq:"".concat(sR,"groq.svg"),"Google AI Studio":"".concat(sR,"google.svg"),"Mistral AI":"".concat(sR,"mistral.svg"),Ollama:"".concat(sR,"ollama.svg"),OpenAI:"".concat(sR,"openai_small.svg"),"OpenAI Text Completion":"".concat(sR,"openai_small.svg"),"OpenAI-Compatible Text Completion Models (Together AI, etc.)":"".concat(sR,"openai_small.svg"),"OpenAI-Compatible Endpoints (Together AI, etc.)":"".concat(sR,"openai_small.svg"),Openrouter:"".concat(sR,"openrouter.svg"),Perplexity:"".concat(sR,"perplexity-ai.svg"),Sambanova:"".concat(sR,"sambanova.svg"),TogetherAI:"".concat(sR,"togetherai.svg"),"Vertex AI (Anthropic, Gemini, etc.)":"".concat(sR,"google.svg"),xAI:"".concat(sR,"xai.svg"),Triton:"".concat(sR,"nvidia_triton.png"),Deepgram:"".concat(sR,"deepgram.png"),ElevenLabs:"".concat(sR,"elevenlabs.png")},sq=e=>{if(!e)return{logo:"",displayName:"-"};if("gemini"===e.toLowerCase()){let e="Google AI Studio";return{logo:sz[e],displayName:e}}let s=Object.keys(sF).find(s=>sF[s].toLowerCase()===e.toLowerCase());if(!s)return{logo:"",displayName:e};let t=c[s];return{logo:sz[t],displayName:t}},sU=e=>"Vertex AI (Anthropic, Gemini, etc.)"===e?"gemini-pro":"Anthropic"==e||"Amazon Bedrock"==e?"claude-3-opus":"Google AI Studio"==e?"gemini-pro":"Azure AI Foundry (Studio)"==e?"azure_ai/command-r-plus":"Azure"==e?"azure/my-deployment":"gpt-3.5-turbo",sV=(e,s)=>{console.log("Provider key: ".concat(e));let t=sF[e];console.log("Provider mapped to: ".concat(t));let l=[];return e&&"object"==typeof s&&(Object.entries(s).forEach(e=>{let[s,a]=e;null!==a&&"object"==typeof a&&"litellm_provider"in a&&(a.litellm_provider===t||a.litellm_provider.includes(t))&&l.push(s)}),"Cohere"==e&&(console.log("Adding cohere chat models"),Object.entries(s).forEach(e=>{let[s,t]=e;null!==t&&"object"==typeof t&&"litellm_provider"in t&&"cohere_chat"===t.litellm_provider&&l.push(s)}))),l},sK=async(e,s,t)=>{try{console.log("handling submit for formValues:",e);let s=e.model_mappings||[];if("model_mappings"in e&&delete e.model_mappings,e.model&&e.model.includes("all-wildcard")){let t=sF[e.custom_llm_provider]+"/*";e.model_name=t,s.push({public_name:t,litellm_model:t}),e.model=t}let t=[];for(let l of s){let s={},a={},r=l.public_name;for(let[t,r]of(s.model=l.litellm_model,e.input_cost_per_token&&(e.input_cost_per_token=Number(e.input_cost_per_token)/1e6),e.output_cost_per_token&&(e.output_cost_per_token=Number(e.output_cost_per_token)/1e6),s.model=l.litellm_model,console.log("formValues add deployment:",e),Object.entries(e)))if(""!==r&&"custom_pricing"!==t&&"pricing_model"!==t&&"cache_control"!==t){if("model_name"==t)s.model=r;else if("custom_llm_provider"==t){console.log("custom_llm_provider:",r);let e=sF[r];s.custom_llm_provider=e,console.log("custom_llm_provider mappingResult:",e)}else if("model"==t)continue;else if("base_model"===t)a[t]=r;else if("team_id"===t)a.team_id=r;else if("model_access_group"===t)a.access_groups=r;else if("mode"==t)console.log("placing mode in modelInfo"),a.mode=r,delete s.mode;else if("custom_model_name"===t)s.model=r;else if("litellm_extra_params"==t){console.log("litellm_extra_params:",r);let e={};if(r&&void 0!=r){try{e=JSON.parse(r)}catch(e){throw z.ZP.error("Failed to parse LiteLLM Extra Params: "+e,10),Error("Failed to parse litellm_extra_params: "+e)}for(let[t,l]of Object.entries(e))s[t]=l}}else if("model_info_params"==t){console.log("model_info_params:",r);let e={};if(r&&void 0!=r){try{e=JSON.parse(r)}catch(e){throw z.ZP.error("Failed to parse LiteLLM Extra Params: "+e,10),Error("Failed to parse litellm_extra_params: "+e)}for(let[s,t]of Object.entries(e))a[s]=t}}else if("input_cost_per_token"===t||"output_cost_per_token"===t||"input_cost_per_second"===t){r&&(s[t]=Number(r));continue}else s[t]=r}t.push({litellmParamsObj:s,modelInfoObj:a,modelName:r})}return t}catch(e){z.ZP.error("Failed to create model: "+e,10)}},sB=async(e,s,t,l)=>{try{let a=await sK(e,s,t);if(!a||0===a.length)return;for(let e of a){let{litellmParamsObj:t,modelInfoObj:l,modelName:a}=e,r={model_name:a,litellm_params:t,model_info:l},n=await (0,y.kK)(s,r);console.log("response for model create call: ".concat(n.data))}l&&l(),t.resetFields()}catch(e){z.ZP.error("Failed to add model: "+e,10)}};var sH=t(53410),sG=t(47451),sJ=t(69410);let{Link:sY}=ef.default,sW={[c.OpenAI]:[{key:"api_base",label:"API Base",type:"select",options:["https://api.openai.com/v1","https://eu.api.openai.com"],defaultValue:"https://api.openai.com/v1"},{key:"organization",label:"OpenAI Organization ID",placeholder:"[OPTIONAL] my-unique-org"},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[c.OpenAI_Text]:[{key:"api_base",label:"API Base",type:"select",options:["https://api.openai.com/v1","https://eu.api.openai.com"],defaultValue:"https://api.openai.com/v1"},{key:"organization",label:"OpenAI Organization ID",placeholder:"[OPTIONAL] my-unique-org"},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[c.Vertex_AI]:[{key:"vertex_project",label:"Vertex Project",placeholder:"adroit-cadet-1234..",required:!0},{key:"vertex_location",label:"Vertex Location",placeholder:"us-east-1",required:!0},{key:"vertex_credentials",label:"Vertex Credentials",required:!0,type:"upload"}],[c.AssemblyAI]:[{key:"api_base",label:"API Base",type:"select",required:!0,options:["https://api.assemblyai.com","https://api.eu.assemblyai.com"]},{key:"api_key",label:"AssemblyAI API Key",type:"password",required:!0}],[c.Azure]:[{key:"api_base",label:"API Base",placeholder:"https://...",required:!0},{key:"api_version",label:"API Version",placeholder:"2023-07-01-preview",tooltip:"By default litellm will use the latest version. If you want to use a different version, you can specify it here"},{key:"base_model",label:"Base Model",placeholder:"azure/gpt-3.5-turbo"},{key:"api_key",label:"Azure API Key",type:"password",required:!0}],[c.Azure_AI_Studio]:[{key:"api_base",label:"API Base",placeholder:"https://<test>.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-10-21",tooltip:"Enter your full Target URI from Azure Foundry here. Example:  https://litellm8397336933.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-10-21",required:!0},{key:"api_key",label:"Azure API Key",type:"password",required:!0}],[c.OpenAI_Compatible]:[{key:"api_base",label:"API Base",placeholder:"https://...",required:!0},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[c.OpenAI_Text_Compatible]:[{key:"api_base",label:"API Base",placeholder:"https://...",required:!0},{key:"api_key",label:"OpenAI API Key",type:"password",required:!0}],[c.Bedrock]:[{key:"aws_access_key_id",label:"AWS Access Key ID",type:"password",required:!1,tooltip:"You can provide the raw key or the environment variable (e.g. `os.environ/MY_SECRET_KEY`)."},{key:"aws_secret_access_key",label:"AWS Secret Access Key",type:"password",required:!1,tooltip:"You can provide the raw key or the environment variable (e.g. `os.environ/MY_SECRET_KEY`)."},{key:"aws_region_name",label:"AWS Region Name",placeholder:"us-east-1",required:!1,tooltip:"You can provide the raw key or the environment variable (e.g. `os.environ/MY_SECRET_KEY`)."}],[c.Ollama]:[{key:"api_base",label:"API Base",placeholder:"http://localhost:11434",defaultValue:"http://localhost:11434",required:!1,tooltip:"The base URL for your Ollama server. Defaults to http://localhost:11434 if not specified."}],[c.Anthropic]:[{key:"api_key",label:"API Key",placeholder:"sk-",type:"password",required:!0}],[c.Deepgram]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.ElevenLabs]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.Google_AI_Studio]:[{key:"api_key",label:"API Key",placeholder:"aig-",type:"password",required:!0}],[c.Groq]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.MistralAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.Deepseek]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.Cohere]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.Databricks]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.xAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.Cerebras]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.Sambanova]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.Perplexity]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.TogetherAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.Openrouter]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.FireworksAI]:[{key:"api_key",label:"API Key",type:"password",required:!0}],[c.Triton]:[{key:"api_key",label:"API Key",type:"password",required:!1},{key:"api_base",label:"API Base",placeholder:"http://localhost:8000/generate",required:!1}]};var s$=e=>{let{selectedProvider:s,uploadProps:t}=e,l=c[s],a=R.Z.useFormInstance(),r=x.useMemo(()=>sW[l]||[],[l]),n={name:"file",accept:".json",beforeUpload:e=>{if("application/json"===e.type){let s=new FileReader;s.onload=e=>{if(e.target){let s=e.target.result;console.log("Setting field value from JSON, length: ".concat(s.length)),a.setFieldsValue({vertex_credentials:s}),console.log("Form values after setting:",a.getFieldsValue())}},s.readAsText(e)}return!1},onChange(e){console.log("Upload onChange triggered in ProviderSpecificFields"),console.log("Current form values:",a.getFieldsValue()),"uploading"!==e.file.status&&console.log(e.file,e.fileList)}};return(0,h.jsx)(h.Fragment,{children:r.map(e=>{var s;return(0,h.jsxs)(x.Fragment,{children:[(0,h.jsx)(R.Z.Item,{label:e.label,name:e.key,rules:e.required?[{required:!0,message:"Required"}]:void 0,tooltip:e.tooltip,className:"vertex_credentials"===e.key?"mb-0":void 0,children:"select"===e.type?(0,h.jsx)(F.default,{placeholder:e.placeholder,defaultValue:e.defaultValue,children:null===(s=e.options)||void 0===s?void 0:s.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:e},e))}):"upload"===e.type?(0,h.jsx)(e_.default,{...n,onChange:s=>{(null==t?void 0:t.onChange)&&t.onChange(s),setTimeout(()=>{let s=a.getFieldValue(e.key);console.log("".concat(e.key," value after upload:"),JSON.stringify(s))},500)},children:(0,h.jsx)(V.ZP,{icon:(0,h.jsx)(eS.Z,{}),children:"Click to Upload"})}):(0,h.jsx)(A.Z,{placeholder:e.placeholder,type:"password"===e.type?"password":"text"})}),"vertex_credentials"===e.key&&(0,h.jsx)(sG.Z,{children:(0,h.jsx)(sJ.Z,{children:(0,h.jsx)(O.Z,{className:"mb-3 mt-1",children:"Give a gcp service account(.json file)"})})}),"base_model"===e.key&&(0,h.jsxs)(sG.Z,{children:[(0,h.jsx)(sJ.Z,{span:10}),(0,h.jsx)(sJ.Z,{span:10,children:(0,h.jsxs)(O.Z,{className:"mb-2",children:["The actual model your azure deployment uses. Used for accurate cost tracking. Select name from"," ",(0,h.jsx)(sY,{href:"https://github.com/BerriAI/litellm/blob/main/model_prices_and_context_window.json",target:"_blank",children:"here"})]})})]})]},e.key)})})};let{Title:sX,Link:sQ}=ef.default;var s0=e=>{let{isVisible:s,onCancel:t,onAddCredential:l,onUpdateCredential:a,uploadProps:r,addOrEdit:n,existingCredential:i}=e,[o]=R.Z.useForm(),[d,m]=(0,x.useState)(c.OpenAI),[u,p]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{i&&(o.setFieldsValue({credential_name:i.credential_name,custom_llm_provider:i.credential_info.custom_llm_provider,api_base:i.credential_values.api_base,api_version:i.credential_values.api_version,base_model:i.credential_values.base_model,api_key:i.credential_values.api_key}),m(i.credential_info.custom_llm_provider))},[i]),(0,h.jsx)(q.Z,{title:"add"===n?"Add New Credential":"Edit Credential",visible:s,onCancel:()=>{t(),o.resetFields()},footer:null,width:600,children:(0,h.jsxs)(R.Z,{form:o,onFinish:e=>{let s=Object.entries(e).reduce((e,s)=>{let[t,l]=s;return""!==l&&null!=l&&(e[t]=l),e},{});"add"===n?l(s):a(s),o.resetFields()},layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{label:"Credential Name:",name:"credential_name",rules:[{required:!0,message:"Credential name is required"}],initialValue:null==i?void 0:i.credential_name,children:(0,h.jsx)(A.Z,{placeholder:"Enter a friendly name for these credentials",disabled:null!=i&&!!i.credential_name})}),(0,h.jsx)(R.Z.Item,{rules:[{required:!0,message:"Required"}],label:"Provider:",name:"custom_llm_provider",tooltip:"Helper to auto-populate provider specific fields",children:(0,h.jsx)(F.default,{showSearch:!0,onChange:e=>{m(e),o.setFieldValue("custom_llm_provider",e)},children:Object.entries(c).map(e=>{let[s,t]=e;return(0,h.jsx)(F.default.Option,{value:s,children:(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("img",{src:sz[t],alt:"".concat(s," logo"),className:"w-5 h-5",onError:e=>{let s=e.target,l=s.parentElement;if(l){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=t.charAt(0),l.replaceChild(e,s)}}}),(0,h.jsx)("span",{children:t})]})},s)})})}),(0,h.jsx)(s$,{selectedProvider:d,uploadProps:r}),(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)(X.Z,{title:"Get help on our github",children:(0,h.jsx)(sQ,{href:"https://github.com/BerriAI/litellm/issues",children:"Need Help?"})}),(0,h.jsxs)("div",{children:[(0,h.jsx)(V.ZP,{onClick:()=>{t(),o.resetFields()},style:{marginRight:10},children:"Cancel"}),(0,h.jsx)(V.ZP,{htmlType:"submit",children:"add"===n?"Add Credential":"Update Credential"})]})]})]})})},s1=e=>{let{accessToken:s,uploadProps:t,credentialList:l,fetchCredentials:a}=e,[r,n]=(0,x.useState)(!1),[i,o]=(0,x.useState)(!1),[c,d]=(0,x.useState)(null),[m]=R.Z.useForm(),u=["credential_name","custom_llm_provider"],p=async e=>{if(!s)return;let t=Object.entries(e).filter(e=>{let[s]=e;return!u.includes(s)}).reduce((e,s)=>{let[t,l]=s;return{...e,[t]:l}},{}),l={credential_name:e.credential_name,credential_values:t,credential_info:{custom_llm_provider:e.custom_llm_provider}};await (0,y.eZ)(s,e.credential_name,l),z.ZP.success("Credential updated successfully"),o(!1),a(s)},g=async e=>{if(!s)return;let t=Object.entries(e).filter(e=>{let[s]=e;return!u.includes(s)}).reduce((e,s)=>{let[t,l]=s;return{...e,[t]:l}},{}),l={credential_name:e.credential_name,credential_values:t,credential_info:{custom_llm_provider:e.custom_llm_provider}};await (0,y.oC)(s,l),z.ZP.success("Credential added successfully"),n(!1),a(s)};(0,x.useEffect)(()=>{s&&a(s)},[s]);let j=e=>{let s={openai:"blue",azure:"indigo",anthropic:"purple",default:"gray"},t=s[e.toLowerCase()]||s.default;return(0,h.jsx)(e1.Z,{color:t,size:"xs",children:e})},f=async e=>{s&&(await (0,y.gX)(s,e),z.ZP.success("Credential deleted successfully"),a(s))};return(0,h.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[(0,h.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,h.jsxs)(O.Z,{children:["Configured credentials for different AI providers. Add and manage your API credentials."," ",(0,h.jsx)("a",{href:"https://docs.litellm.ai/docs/credentials",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700 underline",children:"Docs"})]})}),(0,h.jsx)(eo.Z,{children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Credential Name"}),(0,h.jsx)(sS.Z,{children:"Provider"}),(0,h.jsx)(sS.Z,{children:"Description"})]})}),(0,h.jsx)(sZ.Z,{children:l&&0!==l.length?l.map((e,s)=>{var t,l;return(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:e.credential_name}),(0,h.jsx)(sw.Z,{children:j((null===(t=e.credential_info)||void 0===t?void 0:t.custom_llm_provider)||"-")}),(0,h.jsx)(sw.Z,{children:(null===(l=e.credential_info)||void 0===l?void 0:l.description)||"-"}),(0,h.jsxs)(sw.Z,{children:[(0,h.jsx)(P.Z,{icon:sH.Z,variant:"light",size:"sm",onClick:()=>{d(e),o(!0)}}),(0,h.jsx)(P.Z,{icon:em.Z,variant:"light",size:"sm",onClick:()=>f(e.credential_name)})]})]},s)}):(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:4,className:"text-center py-4 text-gray-500",children:"No credentials configured"})})})]})}),(0,h.jsx)(P.Z,{onClick:()=>n(!0),className:"mt-4",children:"Add Credential"}),r&&(0,h.jsx)(s0,{onAddCredential:g,isVisible:r,onCancel:()=>n(!1),uploadProps:t,addOrEdit:"add",onUpdateCredential:p,existingCredential:null}),i&&(0,h.jsx)(s0,{onAddCredential:g,isVisible:i,existingCredential:c,onUpdateCredential:p,uploadProps:t,onCancel:()=>o(!1),addOrEdit:"edit"})]})};let s2=e=>{var s;return(null==e?void 0:null===(s=e.model_info)||void 0===s?void 0:s.team_public_model_name)?e.model_info.team_public_model_name:(null==e?void 0:e.model_name)||"-"};var s4=t(53003),s5=e=>{let{value:s,onValueChange:t,label:l="Select Time Range",className:a="",showTimeRange:r=!0}=e;return(0,h.jsxs)("div",{className:a,children:[l&&(0,h.jsx)(O.Z,{className:"mb-2",children:l}),(0,h.jsx)(s4.Z,{enableSelect:!0,value:s,onValueChange:e=>{if(e.from){let s;let l={...e},a=new Date(e.from);s=new Date(e.to?e.to:e.from),a.toDateString(),s.toDateString(),a.setHours(0,0,0,0),s.setHours(23,59,59,999),l.from=a,l.to=s,t(l)}else t(e)}}),r&&s.from&&s.to&&(0,h.jsx)(O.Z,{className:"mt-1 text-xs text-gray-500",children:((e,s)=>{if(!e||!s)return"";let t=e=>e.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0,timeZoneName:"short"});if(e.toDateString()!==s.toDateString())return"".concat(t(e)," - ").concat(t(s));{let t=e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),l=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),a=s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZoneName:"short"});return"".concat(t,": ").concat(l," - ").concat(a)}})(s.from,s.to)})]})},s6=t(75105),s3=t(40278),s8=t(14301),s7=t(59664),s9=e=>{let{modelMetrics:s,modelMetricsCategories:t,customTooltip:l,premiumUser:a}=e;return(0,h.jsx)(s7.Z,{title:"Time to First token (s)",className:"h-72",data:s,index:"date",showLegend:!1,categories:t,colors:["indigo","rose"],connectNulls:!0,customTooltip:l})},te=e=>{let{teamData:s,canEditTeam:t,handleMemberDelete:l,setSelectedEditMember:a,setIsEditMemberModalVisible:r,setIsAddMemberModalVisible:n}=e,i=e=>{if(null==e)return"0";if("number"==typeof e){let s=Number(e);return s===Math.floor(s)?s.toString():eH(s,8).replace(/\.?0+$/,"")}return"0"},o=e=>{if(!e)return 0;let t=s.team_memberships.find(s=>s.user_id===e);return(null==t?void 0:t.spend)||0},c=e=>{var t;if(!e)return null;let l=s.team_memberships.find(s=>s.user_id===e);console.log("membership=".concat(l));let a=null==l?void 0:null===(t=l.litellm_budget_table)||void 0===t?void 0:t.max_budget;return null==a?null:i(a)};return(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsx)(eo.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"User ID"}),(0,h.jsx)(sS.Z,{children:"User Email"}),(0,h.jsx)(sS.Z,{children:"Role"}),(0,h.jsxs)(sS.Z,{children:["Team Member Spend (USD)"," ",(0,h.jsx)(X.Z,{title:"This is the amount spent by a user in the team.",children:(0,h.jsx)($.Z,{})})]}),(0,h.jsx)(sS.Z,{children:"Team Member Budget (USD)"}),(0,h.jsx)(sS.Z,{})]})}),(0,h.jsx)(sZ.Z,{children:s.team_info.members_with_roles.map((e,s)=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{className:"font-mono",children:e.user_id})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{className:"font-mono",children:e.user_email?e.user_email:"No Email"})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{className:"font-mono",children:e.role})}),(0,h.jsx)(sw.Z,{children:(0,h.jsxs)(O.Z,{className:"font-mono",children:["$",eH(o(e.user_id),4)]})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{className:"font-mono",children:c(e.user_id)?"$".concat(eH(Number(c(e.user_id)),4)):"No Limit"})}),(0,h.jsx)(sw.Z,{children:t&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>{a(e),r(!0)}}),(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>l(e)})]})})]},s))})]})}),(0,h.jsx)(P.Z,{onClick:()=>n(!0),children:"Add Member"})]})},ts=t(61994),tt=t(85180),tl=t(89245),ta=t(78355);let tr={"/key/generate":"Member can generate a virtual key for this team","/key/update":"Member can update a virtual key belonging to this team","/key/delete":"Member can delete a virtual key belonging to this team","/key/info":"Member can get info about a virtual key belonging to this team","/key/regenerate":"Member can regenerate a virtual key belonging to this team","/key/{key_id}/regenerate":"Member can regenerate a virtual key belonging to this team","/key/list":"Member can list virtual keys belonging to this team","/key/block":"Member can block a virtual key belonging to this team","/key/unblock":"Member can unblock a virtual key belonging to this team"},tn=e=>e.includes("/info")||e.includes("/list")?"GET":"POST",ti=e=>{let s=tn(e),t=tr[e];if(!t){for(let[s,l]of Object.entries(tr))if(e.includes(s)){t=l;break}}return t||(t="Access ".concat(e)),{method:s,endpoint:e,description:t,route:e}};var to=e=>{let{teamId:s,accessToken:t,canEditTeam:l}=e,[a,r]=(0,x.useState)([]),[n,i]=(0,x.useState)([]),[o,c]=(0,x.useState)(!0),[d,m]=(0,x.useState)(!1),[u,p]=(0,x.useState)(!1),g=async()=>{try{if(c(!0),!t)return;let e=await (0,y.aC)(t,s),l=e.all_available_permissions||[];r(l);let a=e.team_member_permissions||[];i(a),p(!1)}catch(e){z.ZP.error("Failed to load permissions"),console.error("Error fetching permissions:",e)}finally{c(!1)}};(0,x.useEffect)(()=>{g()},[s,t]);let j=(e,s)=>{i(s?[...n,e]:n.filter(s=>s!==e)),p(!0)},f=async()=>{try{if(!t)return;m(!0),await (0,y.TF)(t,s,n),z.ZP.success("Permissions updated successfully"),p(!1)}catch(e){z.ZP.error("Failed to update permissions"),console.error("Error updating permissions:",e)}finally{m(!1)}};if(o)return(0,h.jsx)("div",{className:"p-6 text-center",children:"Loading permissions..."});let v=a.length>0;return(0,h.jsxs)(eo.Z,{className:"bg-white shadow-md rounded-md p-6",children:[(0,h.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center border-b pb-4 mb-6",children:[(0,h.jsx)(M.Z,{className:"mb-2 sm:mb-0",children:"Member Permissions"}),l&&u&&(0,h.jsxs)("div",{className:"flex gap-3",children:[(0,h.jsx)(V.ZP,{icon:(0,h.jsx)(tl.Z,{}),onClick:()=>{g()},children:"Reset"}),(0,h.jsxs)(P.Z,{onClick:f,loading:d,className:"flex items-center gap-2",children:[(0,h.jsx)(ta.Z,{})," Save Changes"]})]})]}),(0,h.jsx)(O.Z,{className:"mb-6 text-gray-600",children:"Control what team members can do when they are not team admins."}),v?(0,h.jsxs)(sN.Z,{className:"mt-4",children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Method"}),(0,h.jsx)(sS.Z,{children:"Endpoint"}),(0,h.jsx)(sS.Z,{children:"Description"}),(0,h.jsx)(sS.Z,{className:"text-right",children:"Access"})]})}),(0,h.jsx)(sZ.Z,{children:a.map(e=>{let s=ti(e);return(0,h.jsxs)(sC.Z,{className:"hover:bg-gray-50 transition-colors",children:[(0,h.jsx)(sw.Z,{children:(0,h.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("GET"===s.method?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:s.method})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)("span",{className:"font-mono text-sm text-gray-800",children:s.endpoint})}),(0,h.jsx)(sw.Z,{className:"text-gray-700",children:s.description}),(0,h.jsx)(sw.Z,{className:"text-right",children:(0,h.jsx)(ts.Z,{checked:n.includes(e),onChange:s=>j(e,s.target.checked),disabled:!l})})]},e)})})]}):(0,h.jsx)("div",{className:"py-12",children:(0,h.jsx)(tt.Z,{description:"No permissions available"})})]})},tc=e=>{var s,t,l;let{visible:a,onCancel:r,onSubmit:n,initialData:i,mode:o,config:c}=e,[d]=R.Z.useForm();console.log("Initial Data:",i),(0,x.useEffect)(()=>{if(a){if("edit"===o&&i)d.setFieldsValue({...i,role:i.role||c.defaultRole});else{var e;d.resetFields(),d.setFieldsValue({role:c.defaultRole||(null===(e=c.roleOptions[0])||void 0===e?void 0:e.value)})}}},[a,i,o,d,c.defaultRole,c.roleOptions]);let m=async e=>{try{let s=Object.entries(e).reduce((e,s)=>{let[t,l]=s;return{...e,[t]:"string"==typeof l?l.trim():l}},{});n(s),d.resetFields()}catch(e){console.error("Form submission error:",e)}},u=e=>{switch(e.type){case"input":return(0,h.jsx)(K.default,{className:"px-3 py-2 border rounded-md w-full",onChange:e=>{e.target.value=e.target.value.trim()}});case"select":var s;return(0,h.jsx)(F.default,{children:null===(s=e.options)||void 0===s?void 0:s.map(e=>(0,h.jsx)(F.default.Option,{value:e.value,children:e.label},e.value))});default:return null}};return(0,h.jsx)(q.Z,{title:c.title||("add"===o?"Add Member":"Edit Member"),open:a,width:800,footer:null,onCancel:r,children:(0,h.jsxs)(R.Z,{form:d,onFinish:m,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[c.showEmail&&(0,h.jsx)(R.Z.Item,{label:"Email",name:"user_email",className:"mb-4",rules:[{type:"email",message:"Please enter a valid email!"}],children:(0,h.jsx)(K.default,{className:"px-3 py-2 border rounded-md w-full",placeholder:"user@example.com",onChange:e=>{e.target.value=e.target.value.trim()}})}),c.showEmail&&c.showUserId&&(0,h.jsx)("div",{className:"text-center mb-4",children:(0,h.jsx)(O.Z,{children:"OR"})}),c.showUserId&&(0,h.jsx)(R.Z.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,h.jsx)(K.default,{className:"px-3 py-2 border rounded-md w-full",placeholder:"user_123",onChange:e=>{e.target.value=e.target.value.trim()}})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("span",{children:"Role"}),"edit"===o&&i&&(0,h.jsxs)("span",{className:"text-gray-500 text-sm",children:["(Current: ",(t=i.role,(null===(l=c.roleOptions.find(e=>e.value===t))||void 0===l?void 0:l.label)||t),")"]})]}),name:"role",className:"mb-4",rules:[{required:!0,message:"Please select a role!"}],children:(0,h.jsx)(F.default,{children:"edit"===o&&i?[...c.roleOptions.filter(e=>e.value===i.role),...c.roleOptions.filter(e=>e.value!==i.role)].map(e=>(0,h.jsx)(F.default.Option,{value:e.value,children:e.label},e.value)):c.roleOptions.map(e=>(0,h.jsx)(F.default.Option,{value:e.value,children:e.label},e.value))})}),null===(s=c.additionalFields)||void 0===s?void 0:s.map(e=>(0,h.jsx)(R.Z.Item,{label:e.label,name:e.name,className:"mb-4",rules:e.rules,children:u(e)},e.name)),(0,h.jsxs)("div",{className:"text-right mt-6",children:[(0,h.jsx)(V.ZP,{onClick:r,className:"mr-2",children:"Cancel"}),(0,h.jsx)(V.ZP,{type:"default",htmlType:"submit",children:"add"===o?"Add Member":"Save Changes"})]})]})})},td=e=>{let{isVisible:s,onCancel:t,onSubmit:l,accessToken:a,title:r="Add Team Member",roles:n=[{label:"admin",value:"admin",description:"Admin role. Can create team keys, add members, and manage settings."},{label:"user",value:"user",description:"User role. Can view team info, but not manage it."}],defaultRole:i="user"}=e,[o]=R.Z.useForm(),[c,d]=(0,x.useState)([]),[m,u]=(0,x.useState)(!1),[p,g]=(0,x.useState)("user_email"),j=async(e,s)=>{if(!e){d([]);return}u(!0);try{let t=new URLSearchParams;if(t.append(s,e),null==a)return;let l=(await (0,y.u5)(a,t)).map(e=>({label:"user_email"===s?"".concat(e.user_email):"".concat(e.user_id),value:"user_email"===s?e.user_email:e.user_id,user:e}));d(l)}catch(e){console.error("Error fetching users:",e)}finally{u(!1)}},f=(0,x.useCallback)(eD()((e,s)=>j(e,s),300),[]),v=(e,s)=>{g(s),f(e,s)},_=(e,s)=>{let t=s.user;o.setFieldsValue({user_email:t.user_email,user_id:t.user_id,role:o.getFieldValue("role")})};return(0,h.jsx)(q.Z,{title:r,open:s,onCancel:()=>{o.resetFields(),d([]),t()},footer:null,width:800,children:(0,h.jsxs)(R.Z,{form:o,onFinish:l,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",initialValues:{role:i},children:[(0,h.jsx)(R.Z.Item,{label:"Email",name:"user_email",className:"mb-4",children:(0,h.jsx)(F.default,{showSearch:!0,className:"w-full",placeholder:"Search by email",filterOption:!1,onSearch:e=>v(e,"user_email"),onSelect:(e,s)=>_(e,s),options:"user_email"===p?c:[],loading:m,allowClear:!0})}),(0,h.jsx)("div",{className:"text-center mb-4",children:"OR"}),(0,h.jsx)(R.Z.Item,{label:"User ID",name:"user_id",className:"mb-4",children:(0,h.jsx)(F.default,{showSearch:!0,className:"w-full",placeholder:"Search by user ID",filterOption:!1,onSearch:e=>v(e,"user_id"),onSelect:(e,s)=>_(e,s),options:"user_id"===p?c:[],loading:m,allowClear:!0})}),(0,h.jsx)(R.Z.Item,{label:"Member Role",name:"role",className:"mb-4",children:(0,h.jsx)(F.default,{defaultValue:i,children:n.map(e=>(0,h.jsx)(F.default.Option,{value:e.value,children:(0,h.jsxs)(X.Z,{title:e.description,children:[(0,h.jsx)("span",{className:"font-medium",children:e.label}),(0,h.jsxs)("span",{className:"ml-2 text-gray-500 text-sm",children:["- ",e.description]})]})},e.value))})}),(0,h.jsx)("div",{className:"text-right mt-4",children:(0,h.jsx)(V.ZP,{type:"default",htmlType:"submit",children:"Add Member"})})]})})},tm=e=>{var s,t,l,a,r,n,i,o;let{teamId:c,onClose:d,accessToken:m,is_team_admin:u,is_proxy_admin:p,userModels:g,editTeam:j,premiumUser:f=!1}=e,[v,_]=(0,x.useState)(null),[b,N]=(0,x.useState)(!0),[Z,w]=(0,x.useState)(!1),[k]=R.Z.useForm(),[S,C]=(0,x.useState)(!1),[A,T]=(0,x.useState)(null),[E,L]=(0,x.useState)(!1);console.log("userModels in team info",g);let D=u||p,q=async()=>{try{if(N(!0),!m)return;let e=await (0,y.Xm)(m,c);_(e)}catch(e){z.ZP.error("Failed to load team information"),console.error("Error fetching team info:",e)}finally{N(!1)}};(0,x.useEffect)(()=>{q()},[c,m]);let U=async e=>{try{if(null==m)return;let s={user_email:e.user_email,user_id:e.user_id,role:e.role};await (0,y.cu)(m,c,s),z.ZP.success("Team member added successfully"),w(!1),k.resetFields(),q()}catch(a){var s,t,l;let e="Failed to add team member";(null==a?void 0:null===(l=a.raw)||void 0===l?void 0:null===(t=l.detail)||void 0===t?void 0:null===(s=t.error)||void 0===s?void 0:s.includes("Assigning team admins is a premium feature"))?e="Assigning admins is an enterprise-only feature. Please upgrade your LiteLLM plan to enable this.":(null==a?void 0:a.message)&&(e=a.message),z.ZP.error(e),console.error("Error adding team member:",a)}},B=async e=>{try{if(null==m)return;let s={user_email:e.user_email,user_id:e.user_id,role:e.role};z.ZP.destroy(),await (0,y.sN)(m,c,s),z.ZP.success("Team member updated successfully"),C(!1),q()}catch(l){var s,t;let e="Failed to update team member";(null==l?void 0:null===(t=l.raw)||void 0===t?void 0:null===(s=t.detail)||void 0===s?void 0:s.includes("Assigning team admins is a premium feature"))?e="Assigning admins is an enterprise-only feature. Please upgrade your LiteLLM plan to enable this.":(null==l?void 0:l.message)&&(e=l.message),C(!1),z.ZP.destroy(),z.ZP.error(e),console.error("Error updating team member:",l)}},G=async e=>{try{if(null==m)return;await (0,y.Lp)(m,c,e),z.ZP.success("Team member removed successfully"),q()}catch(e){z.ZP.error("Failed to remove team member"),console.error("Error removing team member:",e)}},Y=async e=>{try{if(!m)return;let s={};try{s=e.metadata?JSON.parse(e.metadata):{}}catch(e){z.ZP.error("Invalid JSON in metadata field");return}let t={team_id:c,team_alias:e.team_alias,models:e.models,tpm_limit:e.tpm_limit,rpm_limit:e.rpm_limit,max_budget:e.max_budget,budget_duration:e.budget_duration,metadata:{...s,guardrails:e.guardrails||[],logging:e.logging_settings||[]},organization_id:e.organization_id};void 0!==e.team_member_budget&&(t.team_member_budget=Number(e.team_member_budget)),void 0!==e.team_member_key_duration&&(t.team_member_key_duration=e.team_member_key_duration),(void 0!==e.vector_stores||void 0!==e.mcp_servers)&&(t.object_permission={...null==v?void 0:v.team_info.object_permission,vector_stores:e.vector_stores||[],mcp_servers:e.mcp_servers||[]}),await (0,y.Gh)(m,t),z.ZP.success("Team settings updated successfully"),L(!1),q()}catch(e){console.error("Error updating team:",e)}};if(b)return(0,h.jsx)("div",{className:"p-4",children:"Loading..."});if(!(null==v?void 0:v.team_info))return(0,h.jsx)("div",{className:"p-4",children:"Team not found"});let{team_info:W}=v;return(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,h.jsxs)("div",{children:[(0,h.jsx)(V.ZP,{onClick:d,className:"mb-4",children:"← Back"}),(0,h.jsx)(M.Z,{children:W.team_alias}),(0,h.jsx)(O.Z,{className:"text-gray-500 font-mono",children:W.team_id})]})}),(0,h.jsxs)(e4.Z,{defaultIndex:j?3:0,children:[(0,h.jsx)(e5.Z,{className:"mb-4",children:[(0,h.jsx)(e2.Z,{children:"Overview"},"overview"),...D?[(0,h.jsx)(e2.Z,{children:"Members"},"members"),(0,h.jsx)(e2.Z,{children:"Member Permissions"},"member-permissions"),(0,h.jsx)(e2.Z,{children:"Settings"},"settings")]:[]]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Budget Status"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsxs)(M.Z,{children:["$",eH(W.spend,4)]}),(0,h.jsxs)(O.Z,{children:["of ",null===W.max_budget?"Unlimited":"$".concat(eH(W.max_budget,4))]}),W.budget_duration&&(0,h.jsxs)(O.Z,{className:"text-gray-500",children:["Reset: ",W.budget_duration]}),(0,h.jsx)("br",{}),W.team_member_budget_table&&(0,h.jsxs)(O.Z,{className:"text-gray-500",children:["Team Member Budget: $",eH(W.team_member_budget_table.max_budget,4)]})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Rate Limits"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsxs)(O.Z,{children:["TPM: ",W.tpm_limit||"Unlimited"]}),(0,h.jsxs)(O.Z,{children:["RPM: ",W.rpm_limit||"Unlimited"]}),W.max_parallel_requests&&(0,h.jsxs)(O.Z,{children:["Max Parallel Requests: ",W.max_parallel_requests]})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Models"}),(0,h.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:0===W.models.length?(0,h.jsx)(e1.Z,{color:"red",children:"All proxy models"}):W.models.map((e,s)=>(0,h.jsx)(e1.Z,{color:"red",children:e},s))})]}),(0,h.jsx)(sd,{objectPermission:W.object_permission,variant:"card",accessToken:m}),(0,h.jsx)(sm,{loggingConfigs:(null===(s=W.metadata)||void 0===s?void 0:s.logging)||[],variant:"card"})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(te,{teamData:v,canEditTeam:D,handleMemberDelete:G,setSelectedEditMember:T,setIsEditMemberModalVisible:C,setIsAddMemberModalVisible:w})}),D&&(0,h.jsx)(e6.Z,{children:(0,h.jsx)(to,{teamId:c,accessToken:m,canEditTeam:D})}),(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(eo.Z,{className:"overflow-y-auto max-h-[65vh]",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(M.Z,{children:"Team Settings"}),D&&!E&&(0,h.jsx)(P.Z,{onClick:()=>L(!0),children:"Edit Settings"})]}),E?(0,h.jsxs)(R.Z,{form:k,onFinish:Y,initialValues:{...W,team_alias:W.team_alias,models:W.models,tpm_limit:W.tpm_limit,rpm_limit:W.rpm_limit,max_budget:W.max_budget,budget_duration:W.budget_duration,guardrails:(null===(t=W.metadata)||void 0===t?void 0:t.guardrails)||[],metadata:W.metadata?JSON.stringify((e=>{let{logging:s,...t}=e;return t})(W.metadata),null,2):"",logging_settings:(null===(l=W.metadata)||void 0===l?void 0:l.logging)||[],organization_id:W.organization_id,vector_stores:(null===(a=W.object_permission)||void 0===a?void 0:a.vector_stores)||[],mcp_servers:(null===(r=W.object_permission)||void 0===r?void 0:r.mcp_servers)||[]},layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{label:"Team Name",name:"team_alias",rules:[{required:!0,message:"Please input a team name"}],children:(0,h.jsx)(K.default,{type:""})}),(0,h.jsx)(R.Z.Item,{label:"Models",name:"models",children:(0,h.jsxs)(F.default,{mode:"multiple",placeholder:"Select models",children:[(0,h.jsx)(F.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),Array.from(new Set(g)).map((e,s)=>(0,h.jsx)(F.default.Option,{value:e,children:J(e)},s))]})}),(0,h.jsx)(R.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,h.jsx)(H,{step:.01,precision:2,style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{label:"Team Member Budget (USD)",name:"team_member_budget",tooltip:"This is the individual budget for a user in the team.",children:(0,h.jsx)(H,{step:.01,precision:2,style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{label:"Team Member Key Duration",name:"team_member_key_duration",tooltip:"Set a limit to the duration of a team member's key.",children:(0,h.jsxs)(F.default,{placeholder:"n/a",children:[(0,h.jsx)(F.default.Option,{value:"1d",children:"1 day"}),(0,h.jsx)(F.default.Option,{value:"1w",children:"1 week"}),(0,h.jsx)(F.default.Option,{value:"1mo",children:"1 month"})]})}),(0,h.jsx)(R.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,h.jsxs)(F.default,{placeholder:"n/a",children:[(0,h.jsx)(F.default.Option,{value:"24h",children:"daily"}),(0,h.jsx)(F.default.Option,{value:"7d",children:"weekly"}),(0,h.jsx)(F.default.Option,{value:"30d",children:"monthly"})]})}),(0,h.jsx)(R.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,h.jsx)(H,{step:1,style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,h.jsx)(H,{step:1,style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Guardrails"," ",(0,h.jsx)(X.Z,{title:"Setup your first guardrail",children:(0,h.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",help:"Select existing guardrails or enter new ones",children:(0,h.jsx)(F.default,{mode:"tags",placeholder:"Select or enter guardrails"})}),(0,h.jsx)(R.Z.Item,{label:"Vector Stores",name:"vector_stores",children:(0,h.jsx)(el,{onChange:e=>k.setFieldValue("vector_stores",e),value:k.getFieldValue("vector_stores"),accessToken:m||"",placeholder:"Select vector stores"})}),(0,h.jsx)(R.Z.Item,{label:"MCP Servers",name:"mcp_servers",children:(0,h.jsx)(er,{onChange:e=>k.setFieldValue("mcp_servers",e),value:k.getFieldValue("mcp_servers"),accessToken:m||"",placeholder:"Select MCP servers"})}),(0,h.jsx)(R.Z.Item,{label:"Organization ID",name:"organization_id",children:(0,h.jsx)(K.default,{type:""})}),(0,h.jsx)(R.Z.Item,{label:"Logging Settings",name:"logging_settings",children:(0,h.jsx)(e9,{value:k.getFieldValue("logging_settings"),onChange:e=>k.setFieldValue("logging_settings",e)})}),(0,h.jsx)(R.Z.Item,{label:"Metadata",name:"metadata",children:(0,h.jsx)(K.default.TextArea,{rows:10})}),(0,h.jsx)("div",{className:"sticky z-10 bg-white p-4 border-t border-gray-200 bottom-[-1.5rem] inset-x-[-1.5rem]",children:(0,h.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,h.jsx)(V.ZP,{htmlType:"button",onClick:()=>L(!1),children:"Cancel"}),(0,h.jsx)(P.Z,{type:"submit",children:"Save Changes"})]})})]}):(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Team Name"}),(0,h.jsx)("div",{children:W.team_alias})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Team ID"}),(0,h.jsx)("div",{className:"font-mono",children:W.team_id})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Created At"}),(0,h.jsx)("div",{children:new Date(W.created_at).toLocaleString()})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Models"}),(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:W.models.map((e,s)=>(0,h.jsx)(e1.Z,{color:"red",children:e},s))})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Rate Limits"}),(0,h.jsxs)("div",{children:["TPM: ",W.tpm_limit||"Unlimited"]}),(0,h.jsxs)("div",{children:["RPM: ",W.rpm_limit||"Unlimited"]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Team Budget"}),(0,h.jsxs)("div",{children:["Max Budget: ",null!==W.max_budget?"$".concat(eH(W.max_budget,4)):"No Limit"]}),(0,h.jsxs)("div",{children:["Budget Reset: ",W.budget_duration||"Never"]})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)(O.Z,{className:"font-medium",children:["Team Member Settings"," ",(0,h.jsx)(X.Z,{title:"These are limits on individual team members",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),(0,h.jsxs)("div",{children:["Max Budget: ",(null===(n=W.team_member_budget_table)||void 0===n?void 0:n.max_budget)||"No Limit"]}),(0,h.jsxs)("div",{children:["Key Duration: ",(null===(i=W.metadata)||void 0===i?void 0:i.team_member_key_duration)||"No Limit"]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Organization ID"}),(0,h.jsx)("div",{children:W.organization_id})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Status"}),(0,h.jsx)(e1.Z,{color:W.blocked?"red":"green",children:W.blocked?"Blocked":"Active"})]}),(0,h.jsx)(sd,{objectPermission:W.object_permission,variant:"inline",className:"pt-4 border-t border-gray-200",accessToken:m}),(0,h.jsx)(sm,{loggingConfigs:(null===(o=W.metadata)||void 0===o?void 0:o.logging)||[],variant:"inline",className:"pt-4 border-t border-gray-200"})]})]})})]})]}),(0,h.jsx)(tc,{visible:S,onCancel:()=>C(!1),onSubmit:B,initialData:A,mode:"edit",config:{title:"Edit Member",showEmail:!0,showUserId:!0,roleOptions:[{label:"Admin",value:"admin"},{label:"User",value:"user"}]}}),(0,h.jsx)(td,{isVisible:Z,onCancel:()=>w(!1),onSubmit:U,accessToken:m})]})},tu=t(45589);let{Title:th,Link:tx}=ef.default;var tp=e=>{let{isVisible:s,onCancel:t,onAddCredential:l,existingCredential:a,setIsCredentialModalOpen:r}=e,[n]=R.Z.useForm();return console.log("existingCredential in add credentials tab: ".concat(JSON.stringify(a))),(0,h.jsx)(q.Z,{title:"Reuse Credentials",visible:s,onCancel:()=>{t(),n.resetFields()},footer:null,width:600,children:(0,h.jsxs)(R.Z,{form:n,onFinish:e=>{l(e),n.resetFields(),r(!1)},layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{label:"Credential Name:",name:"credential_name",rules:[{required:!0,message:"Credential name is required"}],initialValue:null==a?void 0:a.credential_name,children:(0,h.jsx)(A.Z,{placeholder:"Enter a friendly name for these credentials"})}),Object.entries((null==a?void 0:a.credential_values)||{}).map(e=>{let[s,t]=e;return(0,h.jsx)(R.Z.Item,{label:s,name:s,initialValue:t,children:(0,h.jsx)(A.Z,{placeholder:"Enter ".concat(s),disabled:!0})},s)}),(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)(X.Z,{title:"Get help on our github",children:(0,h.jsx)(tx,{href:"https://github.com/BerriAI/litellm/issues",children:"Need Help?"})}),(0,h.jsxs)("div",{children:[(0,h.jsx)(V.ZP,{onClick:()=>{t(),n.resetFields()},style:{marginRight:10},children:"Cancel"}),(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Reuse Credentials"})]})]})]})})},tg=t(63709),tj=t(45246),tf=t(96473);let{Text:tv}=ef.default;var t_=e=>{let{form:s,showCacheControl:t,onCacheControlChange:l}=e,a=e=>{let t=s.getFieldValue("litellm_extra_params");try{let l=t?JSON.parse(t):{};e.length>0?l.cache_control_injection_points=e:delete l.cache_control_injection_points,Object.keys(l).length>0?s.setFieldValue("litellm_extra_params",JSON.stringify(l,null,2)):s.setFieldValue("litellm_extra_params","")}catch(e){console.error("Error updating cache control points:",e)}};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{label:"Cache Control Injection Points",name:"cache_control",valuePropName:"checked",className:"mb-4",tooltip:"Tell litellm where to inject cache control checkpoints. You can specify either by role (to apply to all messages of that role) or by specific message index.",children:(0,h.jsx)(tg.Z,{onChange:l,className:"bg-gray-600"})}),t&&(0,h.jsxs)("div",{className:"ml-6 pl-4 border-l-2 border-gray-200",children:[(0,h.jsx)(tv,{className:"text-sm text-gray-500 block mb-4",children:"Providers like Anthropic, Bedrock API require users to specify where to inject cache control checkpoints, litellm can automatically add them for you as a cost saving feature."}),(0,h.jsx)(R.Z.List,{name:"cache_control_injection_points",initialValue:[{location:"message"}],children:(e,t)=>{let{add:l,remove:r}=t;return(0,h.jsxs)(h.Fragment,{children:[e.map((t,l)=>(0,h.jsxs)("div",{className:"flex items-center mb-4 gap-4",children:[(0,h.jsx)(R.Z.Item,{...t,label:"Type",name:[t.name,"location"],initialValue:"message",className:"mb-0",style:{width:"180px"},children:(0,h.jsx)(F.default,{disabled:!0,options:[{value:"message",label:"Message"}]})}),(0,h.jsx)(R.Z.Item,{...t,label:"Role",name:[t.name,"role"],className:"mb-0",style:{width:"180px"},tooltip:"LiteLLM will mark all messages of this role as cacheable",children:(0,h.jsx)(F.default,{placeholder:"Select a role",allowClear:!0,options:[{value:"user",label:"User"},{value:"system",label:"System"},{value:"assistant",label:"Assistant"}],onChange:()=>{a(s.getFieldValue("cache_control_points"))}})}),(0,h.jsx)(R.Z.Item,{...t,label:"Index",name:[t.name,"index"],className:"mb-0",style:{width:"180px"},tooltip:"(Optional) If set litellm will mark the message at this index as cacheable",children:(0,h.jsx)(H,{type:"number",placeholder:"Optional",step:1,min:0,onChange:()=>{a(s.getFieldValue("cache_control_points"))}})}),e.length>1&&(0,h.jsx)(tj.Z,{className:"text-red-500 cursor-pointer text-lg ml-12",onClick:()=>{r(t.name),setTimeout(()=>{a(s.getFieldValue("cache_control_points"))},0)}})]},t.key)),(0,h.jsx)(R.Z.Item,{children:(0,h.jsxs)("button",{type:"button",className:"flex items-center justify-center w-full border border-dashed border-gray-300 py-2 px-4 text-gray-600 hover:text-blue-600 hover:border-blue-300 transition-all rounded",onClick:()=>l(),children:[(0,h.jsx)(tf.Z,{className:"mr-2"}),"Add Injection Point"]})})]})}})]})]})};function ty(e){var s,t,l,a,r,n,i,o,c,d,m,u,p,g,j,f,v,_,b,N,Z,w,k;let{modelId:S,onClose:C,modelData:T,accessToken:E,userID:L,userRole:D,editModel:U,setEditModalVisible:B,setSelectedModel:G,onModelUpdate:J,modelAccessGroups:Y}=e,[W]=R.Z.useForm(),[$,X]=(0,x.useState)(null),[Q,ee]=(0,x.useState)(!1),[es,et]=(0,x.useState)(!1),[el,ea]=(0,x.useState)(!1),[er,en]=(0,x.useState)(!1),[ei,ec]=(0,x.useState)(!1),[ed,eu]=(0,x.useState)(null),[eh,ex]=(0,x.useState)(!1),ep="Admin"===D||T.model_info.created_by===L,eg=(null===(s=T.litellm_params)||void 0===s?void 0:s.litellm_credential_name)!=null&&(null===(t=T.litellm_params)||void 0===t?void 0:t.litellm_credential_name)!=void 0;console.log("usingExistingCredential, ",eg),console.log("modelData.litellm_params.litellm_credential_name, ",T.litellm_params.litellm_credential_name),(0,x.useEffect)(()=>{let e=async()=>{var e;if(!E)return;let s=await (0,y.ix)(E,S);console.log("modelInfoResponse, ",s);let t=s.data[0];X(t),(null==t?void 0:null===(e=t.litellm_params)||void 0===e?void 0:e.cache_control_injection_points)&&ex(!0)};(async()=>{if(console.log("accessToken, ",E),!E||eg)return;let e=await (0,y.Qg)(E,null,S);console.log("existingCredentialResponse, ",e),eu({credential_name:e.credential_name,credential_values:e.credential_values,credential_info:e.credential_info})})(),e()},[E,S]);let ej=async e=>{var s;if(console.log("values, ",e),!E)return;let t={credential_name:e.credential_name,model_id:S,credential_info:{custom_llm_provider:null===(s=$.litellm_params)||void 0===s?void 0:s.custom_llm_provider}};z.ZP.info("Storing credential.."),console.log("credentialResponse, ",await (0,y.oC)(E,t)),z.ZP.success("Credential stored successfully")},ef=async e=>{try{var s;let t;if(!E)return;en(!0),console.log("values.model_name, ",e.model_name);let l={...$.litellm_params,model:e.litellm_model_name,api_base:e.api_base,custom_llm_provider:e.custom_llm_provider,organization:e.organization,tpm:e.tpm,rpm:e.rpm,max_retries:e.max_retries,timeout:e.timeout,stream_timeout:e.stream_timeout,input_cost_per_token:e.input_cost/1e6,output_cost_per_token:e.output_cost/1e6};e.cache_control&&(null===(s=e.cache_control_injection_points)||void 0===s?void 0:s.length)>0?l.cache_control_injection_points=e.cache_control_injection_points:delete l.cache_control_injection_points;try{t=e.model_info?JSON.parse(e.model_info):T.model_info,e.model_access_group&&(t={...t,access_groups:e.model_access_group})}catch(e){z.ZP.error("Invalid JSON in Model Info");return}let a={model_name:e.model_name,litellm_params:l,model_info:t};await (0,y.$D)(E,a,S);let r={...$,model_name:e.model_name,litellm_model_name:e.litellm_model_name,litellm_params:l,model_info:t};X(r),J&&J(r),z.ZP.success("Model settings updated successfully"),ea(!1),ec(!1)}catch(e){console.error("Error updating model:",e),z.ZP.error("Failed to update model settings")}finally{en(!1)}};if(!T)return(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsx)(V.ZP,{icon:(0,h.jsx)(e8.Z,{}),onClick:C,className:"mb-4",children:"Back to Models"}),(0,h.jsx)(O.Z,{children:"Model not found"})]});let ev=async()=>{try{if(!E)return;await (0,y.Og)(E,S),z.ZP.success("Model deleted successfully"),J&&J({deleted:!0,model_info:{id:S}}),C()}catch(e){console.error("Error deleting the model:",e),z.ZP.error("Failed to delete model")}};return(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(V.ZP,{icon:(0,h.jsx)(e8.Z,{}),onClick:C,className:"mb-4",children:"Back to Models"}),(0,h.jsxs)(M.Z,{children:["Public Model Name: ",s2(T)]}),(0,h.jsx)(O.Z,{className:"text-gray-500 font-mono",children:T.model_info.id})]}),(0,h.jsxs)("div",{className:"flex gap-2",children:["Admin"===D&&(0,h.jsx)(P.Z,{icon:tu.Z,variant:"secondary",onClick:()=>et(!0),className:"flex items-center",children:"Re-use Credentials"}),ep&&(0,h.jsx)(P.Z,{icon:em.Z,variant:"secondary",onClick:()=>ee(!0),className:"flex items-center",children:"Delete Model"})]})]}),(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{className:"mb-6",children:[(0,h.jsx)(e2.Z,{children:"Overview"}),(0,h.jsx)(e2.Z,{children:"Raw JSON"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsxs)(e6.Z,{children:[(0,h.jsxs)(I.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6 mb-6",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Provider"}),(0,h.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[T.provider&&(0,h.jsx)("img",{src:sq(T.provider).logo,alt:"".concat(T.provider," logo"),className:"w-4 h-4",onError:e=>{let s=e.target,t=s.parentElement;if(t){var l;let e=document.createElement("div");e.className="w-4 h-4 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=(null===(l=T.provider)||void 0===l?void 0:l.charAt(0))||"-",t.replaceChild(e,s)}}}),(0,h.jsx)(M.Z,{children:T.provider||"Not Set"})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"LiteLLM Model"}),(0,h.jsx)("pre",{children:(0,h.jsx)(M.Z,{children:T.litellm_model_name||"Not Set"})})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Pricing"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsxs)(O.Z,{children:["Input: $",T.input_cost,"/1M tokens"]}),(0,h.jsxs)(O.Z,{children:["Output: $",T.output_cost,"/1M tokens"]})]})]})]}),(0,h.jsxs)("div",{className:"mb-6 text-sm text-gray-500 flex items-center gap-x-6",children:[(0,h.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,h.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Created At ",T.model_info.created_at?new Date(T.model_info.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Not Set"]}),(0,h.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,h.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Created By ",T.model_info.created_by||"Not Set"]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(M.Z,{children:"Model Settings"}),ep&&!ei&&(0,h.jsx)(P.Z,{variant:"secondary",onClick:()=>ec(!0),className:"flex items-center",children:"Edit Model"})]}),$?(0,h.jsx)(R.Z,{form:W,onFinish:ef,initialValues:{model_name:$.model_name,litellm_model_name:$.litellm_model_name,api_base:$.litellm_params.api_base,custom_llm_provider:$.litellm_params.custom_llm_provider,organization:$.litellm_params.organization,tpm:$.litellm_params.tpm,rpm:$.litellm_params.rpm,max_retries:$.litellm_params.max_retries,timeout:$.litellm_params.timeout,stream_timeout:$.litellm_params.stream_timeout,input_cost:$.litellm_params.input_cost_per_token?1e6*$.litellm_params.input_cost_per_token:(null===(l=$.model_info)||void 0===l?void 0:l.input_cost_per_token)*1e6||null,output_cost:(null===(a=$.litellm_params)||void 0===a?void 0:a.output_cost_per_token)?1e6*$.litellm_params.output_cost_per_token:(null===(r=$.model_info)||void 0===r?void 0:r.output_cost_per_token)*1e6||null,cache_control:null!==(n=$.litellm_params)&&void 0!==n&&!!n.cache_control_injection_points,cache_control_injection_points:(null===(i=$.litellm_params)||void 0===i?void 0:i.cache_control_injection_points)||[],model_access_group:Array.isArray(null===(o=$.model_info)||void 0===o?void 0:o.access_groups)?$.model_info.access_groups:[]},layout:"vertical",onValuesChange:()=>ea(!0),children:(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Model Name"}),ei?(0,h.jsx)(R.Z.Item,{name:"model_name",className:"mb-0",children:(0,h.jsx)(A.Z,{placeholder:"Enter model name"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:$.model_name})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"LiteLLM Model Name"}),ei?(0,h.jsx)(R.Z.Item,{name:"litellm_model_name",className:"mb-0",children:(0,h.jsx)(A.Z,{placeholder:"Enter LiteLLM model name"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:$.litellm_model_name})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Input Cost (per 1M tokens)"}),ei?(0,h.jsx)(R.Z.Item,{name:"input_cost",className:"mb-0",children:(0,h.jsx)(H,{placeholder:"Enter input cost"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null==$?void 0:null===(c=$.litellm_params)||void 0===c?void 0:c.input_cost_per_token)?((null===(d=$.litellm_params)||void 0===d?void 0:d.input_cost_per_token)*1e6).toFixed(4):(null==$?void 0:null===(m=$.model_info)||void 0===m?void 0:m.input_cost_per_token)?(1e6*$.model_info.input_cost_per_token).toFixed(4):null})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Output Cost (per 1M tokens)"}),ei?(0,h.jsx)(R.Z.Item,{name:"output_cost",className:"mb-0",children:(0,h.jsx)(H,{placeholder:"Enter output cost"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null==$?void 0:null===(u=$.litellm_params)||void 0===u?void 0:u.output_cost_per_token)?(1e6*$.litellm_params.output_cost_per_token).toFixed(4):(null==$?void 0:null===(p=$.model_info)||void 0===p?void 0:p.output_cost_per_token)?(1e6*$.model_info.output_cost_per_token).toFixed(4):null})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"API Base"}),ei?(0,h.jsx)(R.Z.Item,{name:"api_base",className:"mb-0",children:(0,h.jsx)(A.Z,{placeholder:"Enter API base"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(g=$.litellm_params)||void 0===g?void 0:g.api_base)||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Custom LLM Provider"}),ei?(0,h.jsx)(R.Z.Item,{name:"custom_llm_provider",className:"mb-0",children:(0,h.jsx)(A.Z,{placeholder:"Enter custom LLM provider"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(j=$.litellm_params)||void 0===j?void 0:j.custom_llm_provider)||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Organization"}),ei?(0,h.jsx)(R.Z.Item,{name:"organization",className:"mb-0",children:(0,h.jsx)(A.Z,{placeholder:"Enter organization"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(f=$.litellm_params)||void 0===f?void 0:f.organization)||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"TPM (Tokens per Minute)"}),ei?(0,h.jsx)(R.Z.Item,{name:"tpm",className:"mb-0",children:(0,h.jsx)(H,{placeholder:"Enter TPM"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(v=$.litellm_params)||void 0===v?void 0:v.tpm)||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"RPM (Requests per Minute)"}),ei?(0,h.jsx)(R.Z.Item,{name:"rpm",className:"mb-0",children:(0,h.jsx)(H,{placeholder:"Enter RPM"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(_=$.litellm_params)||void 0===_?void 0:_.rpm)||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Max Retries"}),ei?(0,h.jsx)(R.Z.Item,{name:"max_retries",className:"mb-0",children:(0,h.jsx)(H,{placeholder:"Enter max retries"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(b=$.litellm_params)||void 0===b?void 0:b.max_retries)||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Timeout (seconds)"}),ei?(0,h.jsx)(R.Z.Item,{name:"timeout",className:"mb-0",children:(0,h.jsx)(H,{placeholder:"Enter timeout"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(N=$.litellm_params)||void 0===N?void 0:N.timeout)||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Stream Timeout (seconds)"}),ei?(0,h.jsx)(R.Z.Item,{name:"stream_timeout",className:"mb-0",children:(0,h.jsx)(H,{placeholder:"Enter stream timeout"})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(Z=$.litellm_params)||void 0===Z?void 0:Z.stream_timeout)||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Model Access Groups"}),ei?(0,h.jsx)(R.Z.Item,{name:"model_access_group",className:"mb-0",children:(0,h.jsx)(F.default,{mode:"tags",showSearch:!0,placeholder:"Select existing groups or type to create new ones",optionFilterProp:"children",tokenSeparators:[","],maxTagCount:"responsive",allowClear:!0,style:{width:"100%"},options:null==Y?void 0:Y.map(e=>({value:e,label:e}))})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(w=$.model_info)||void 0===w?void 0:w.access_groups)?Array.isArray($.model_info.access_groups)?$.model_info.access_groups.length>0?(0,h.jsx)("div",{className:"flex flex-wrap gap-1",children:$.model_info.access_groups.map((e,s)=>(0,h.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e},s))}):"No groups assigned":$.model_info.access_groups:"Not Set"})]}),ei?(0,h.jsx)(t_,{form:W,showCacheControl:eh,onCacheControlChange:e=>ex(e)}):(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Cache Control"}),(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(null===(k=$.litellm_params)||void 0===k?void 0:k.cache_control_injection_points)?(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{children:"Enabled"}),(0,h.jsx)("div",{className:"mt-2",children:$.litellm_params.cache_control_injection_points.map((e,s)=>(0,h.jsxs)("div",{className:"text-sm text-gray-600 mb-1",children:["Location: ",e.location,",",e.role&&(0,h.jsxs)("span",{children:[" Role: ",e.role]}),void 0!==e.index&&(0,h.jsxs)("span",{children:[" Index: ",e.index]})]},s))})]}):"Disabled"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Model Info"}),ei?(0,h.jsx)(R.Z.Item,{name:"model_info",className:"mb-0",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:'{"gpt-4": 100, "claude-v1": 200}',defaultValue:JSON.stringify(T.model_info,null,2)})}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:(0,h.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:JSON.stringify($.model_info,null,2)})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Team ID"}),(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:T.model_info.team_id||"Not Set"})]})]}),ei&&(0,h.jsxs)("div",{className:"mt-6 flex justify-end gap-2",children:[(0,h.jsx)(P.Z,{variant:"secondary",onClick:()=>{W.resetFields(),ea(!1),ec(!1)},children:"Cancel"}),(0,h.jsx)(P.Z,{variant:"primary",onClick:()=>W.submit(),loading:er,children:"Save Changes"})]})]})}):(0,h.jsx)(O.Z,{children:"Loading..."})]})]}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(eo.Z,{children:(0,h.jsx)("pre",{className:"bg-gray-100 p-4 rounded text-xs overflow-auto",children:JSON.stringify(T,null,2)})})})]})]}),Q&&(0,h.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,h.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,h.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,h.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,h.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,h.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,h.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,h.jsx)("div",{className:"sm:flex sm:items-start",children:(0,h.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,h.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Model"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this model?"})})]})})}),(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)(V.ZP,{onClick:ev,className:"ml-2",danger:!0,children:"Delete"}),(0,h.jsx)(V.ZP,{onClick:()=>ee(!1),children:"Cancel"})]})]})]})}),es&&!eg?(0,h.jsx)(tp,{isVisible:es,onCancel:()=>et(!1),onAddCredential:ej,existingCredential:ed,setIsCredentialModalOpen:et}):(0,h.jsx)(q.Z,{open:es,onCancel:()=>et(!1),title:"Using Existing Credential",children:(0,h.jsx)(O.Z,{children:T.litellm_params.litellm_credential_name})})]})}var tb=t(67960),tN=e=>{let{selectedProvider:s,providerModels:t,getPlaceholder:l}=e,a=R.Z.useFormInstance(),r=e=>{let s=e.target.value,t=(a.getFieldValue("model_mappings")||[]).map(e=>"custom"===e.public_name||"custom"===e.litellm_model?{public_name:s,litellm_model:s}:e);a.setFieldsValue({model_mappings:t})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(R.Z.Item,{label:"LiteLLM Model Name(s)",tooltip:"Actual model name used for making litellm.completion() / litellm.embedding() call.",className:"mb-0",children:[(0,h.jsx)(R.Z.Item,{name:"model",rules:[{required:!0,message:"Please select at least one model."}],noStyle:!0,children:s===c.Azure||s===c.OpenAI_Compatible||s===c.Ollama?(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(A.Z,{placeholder:l(s)})}):t.length>0?(0,h.jsx)(F.default,{mode:"multiple",allowClear:!0,showSearch:!0,placeholder:"Select models",onChange:e=>{let s=Array.isArray(e)?e:[e];if(s.includes("all-wildcard"))a.setFieldsValue({model_name:void 0,model_mappings:[]});else if(JSON.stringify(a.getFieldValue("model"))!==JSON.stringify(s)){let e=s.map(e=>({public_name:e,litellm_model:e}));a.setFieldsValue({model:s,model_mappings:e})}},optionFilterProp:"children",filterOption:(e,s)=>{var t;return(null!==(t=null==s?void 0:s.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},options:[{label:"Custom Model Name (Enter below)",value:"custom"},{label:"All ".concat(s," Models (Wildcard)"),value:"all-wildcard"},...t.map(e=>({label:e,value:e}))],style:{width:"100%"}}):(0,h.jsx)(A.Z,{placeholder:l(s)})}),(0,h.jsx)(R.Z.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.model!==s.model,children:e=>{let{getFieldValue:s}=e,t=s("model")||[];return(Array.isArray(t)?t:[t]).includes("custom")&&(0,h.jsx)(R.Z.Item,{name:"custom_model_name",rules:[{required:!0,message:"Please enter a custom model name."}],className:"mt-2",children:(0,h.jsx)(A.Z,{placeholder:"Enter custom model name",onChange:r})})}})]}),(0,h.jsxs)(sG.Z,{children:[(0,h.jsx)(sJ.Z,{span:10}),(0,h.jsx)(sJ.Z,{span:10,children:(0,h.jsx)(O.Z,{className:"mb-3 mt-1",children:"Actual model name used for making litellm.completion() call. We loadbalance models with the same public name"})})]})]})},tZ=()=>{let e=R.Z.useFormInstance(),[s,t]=(0,x.useState)(0),l=R.Z.useWatch("model",e)||[],a=Array.isArray(l)?l:[l],r=R.Z.useWatch("custom_model_name",e),n=!a.includes("all-wildcard");if((0,x.useEffect)(()=>{if(r&&a.includes("custom")){let s=(e.getFieldValue("model_mappings")||[]).map(e=>"custom"===e.public_name||"custom"===e.litellm_model?{public_name:r,litellm_model:r}:e);e.setFieldValue("model_mappings",s),t(e=>e+1)}},[r,a,e]),(0,x.useEffect)(()=>{if(a.length>0&&!a.includes("all-wildcard")){let s=e.getFieldValue("model_mappings")||[];if(s.length!==a.length||!a.every(e=>s.some(s=>"custom"===e?"custom"===s.litellm_model||s.litellm_model===r:s.litellm_model===e))){let s=a.map(e=>"custom"===e&&r?{public_name:r,litellm_model:r}:{public_name:e,litellm_model:e});e.setFieldValue("model_mappings",s),t(e=>e+1)}}},[a,r,e]),!n)return null;let i=[{title:"Public Name",dataIndex:"public_name",key:"public_name",render:(s,t,l)=>(0,h.jsx)(A.Z,{value:s,onChange:s=>{let t=[...e.getFieldValue("model_mappings")];t[l].public_name=s.target.value,e.setFieldValue("model_mappings",t)}})},{title:"LiteLLM Model",dataIndex:"litellm_model",key:"litellm_model"}];return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(R.Z.Item,{label:"Model Mappings",name:"model_mappings",tooltip:"Map public model names to LiteLLM model names for load balancing",labelCol:{span:10},wrapperCol:{span:16},labelAlign:"left",required:!0,children:(0,h.jsx)(ey.Z,{dataSource:e.getFieldValue("model_mappings"),columns:i,pagination:!1,size:"small"},s)})})},tw=t(90464);let{Link:tk}=ef.default;var tS=e=>{let{showAdvancedSettings:s,setShowAdvancedSettings:t,teams:l}=e,[a]=R.Z.useForm(),[r,n]=x.useState(!1),[i,o]=x.useState("per_token"),[c,d]=x.useState(!1),m=(e,s)=>s&&(isNaN(Number(s))||0>Number(s))?Promise.reject("Please enter a valid positive number"):Promise.resolve(),u=(e,s)=>{if(!s)return Promise.resolve();try{return JSON.parse(s),Promise.resolve()}catch(e){return Promise.reject("Please enter valid JSON")}};return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(T.Z,{className:"mt-2 mb-4",children:[(0,h.jsx)(L.Z,{children:(0,h.jsx)("b",{children:"Advanced Settings"})}),(0,h.jsx)(E.Z,{children:(0,h.jsxs)("div",{className:"bg-white rounded-lg",children:[(0,h.jsx)(R.Z.Item,{label:"Custom Pricing",name:"custom_pricing",valuePropName:"checked",className:"mb-4",children:(0,h.jsx)(tg.Z,{onChange:e=>{n(e),e||a.setFieldsValue({input_cost_per_token:void 0,output_cost_per_token:void 0,input_cost_per_second:void 0})},className:"bg-gray-600"})}),r&&(0,h.jsxs)("div",{className:"ml-6 pl-4 border-l-2 border-gray-200",children:[(0,h.jsx)(R.Z.Item,{label:"Pricing Model",name:"pricing_model",className:"mb-4",children:(0,h.jsx)(F.default,{defaultValue:"per_token",onChange:e=>o(e),options:[{value:"per_token",label:"Per Million Tokens"},{value:"per_second",label:"Per Second"}]})}),"per_token"===i?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{label:"Input Cost (per 1M tokens)",name:"input_cost_per_token",rules:[{validator:m}],className:"mb-4",children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"Output Cost (per 1M tokens)",name:"output_cost_per_token",rules:[{validator:m}],className:"mb-4",children:(0,h.jsx)(A.Z,{})})]}):(0,h.jsx)(R.Z.Item,{label:"Cost Per Second",name:"input_cost_per_second",rules:[{validator:m}],className:"mb-4",children:(0,h.jsx)(A.Z,{})})]}),(0,h.jsx)(R.Z.Item,{label:"Use in pass through routes",name:"use_in_pass_through",valuePropName:"checked",className:"mb-4 mt-4",tooltip:(0,h.jsxs)("span",{children:["Allow using these credentials in pass through routes."," ",(0,h.jsx)(tk,{href:"https://docs.litellm.ai/docs/pass_through/vertex_ai",target:"_blank",children:"Learn more"})]}),children:(0,h.jsx)(tg.Z,{onChange:e=>{let s=a.getFieldValue("litellm_extra_params");try{let t=s?JSON.parse(s):{};e?t.use_in_pass_through=!0:delete t.use_in_pass_through,Object.keys(t).length>0?a.setFieldValue("litellm_extra_params",JSON.stringify(t,null,2)):a.setFieldValue("litellm_extra_params","")}catch(s){e?a.setFieldValue("litellm_extra_params",JSON.stringify({use_in_pass_through:!0},null,2)):a.setFieldValue("litellm_extra_params","")}},className:"bg-gray-600"})}),(0,h.jsx)(t_,{form:a,showCacheControl:c,onCacheControlChange:e=>{if(d(e),!e){let e=a.getFieldValue("litellm_extra_params");try{let s=e?JSON.parse(e):{};delete s.cache_control_injection_points,Object.keys(s).length>0?a.setFieldValue("litellm_extra_params",JSON.stringify(s,null,2)):a.setFieldValue("litellm_extra_params","")}catch(e){a.setFieldValue("litellm_extra_params","")}}}}),(0,h.jsx)(R.Z.Item,{label:"LiteLLM Params",name:"litellm_extra_params",tooltip:"Optional litellm params used for making a litellm.completion() call.",className:"mb-4 mt-4",rules:[{validator:u}],children:(0,h.jsx)(tw.Z,{rows:4,placeholder:'{ "rpm": 100, "timeout": 0, "stream_timeout": 0 }'})}),(0,h.jsxs)(sG.Z,{className:"mb-4",children:[(0,h.jsx)(sJ.Z,{span:10}),(0,h.jsx)(sJ.Z,{span:10,children:(0,h.jsxs)(O.Z,{className:"text-gray-600 text-sm",children:["Pass JSON of litellm supported params"," ",(0,h.jsx)(tk,{href:"https://docs.litellm.ai/docs/completion/input",target:"_blank",children:"litellm.completion() call"})]})})]}),(0,h.jsx)(R.Z.Item,{label:"Model Info",name:"model_info_params",tooltip:"Optional model info params. Returned when calling `/model/info` endpoint.",className:"mb-0",rules:[{validator:u}],children:(0,h.jsx)(tw.Z,{rows:4,placeholder:'{ "mode": "chat" }'})})]})})]})})},tC=t(29),tI=t.n(tC),tP=t(23496),tA=t(23639);let{Text:tT}=ef.default;var tE=e=>{let{formValues:s,accessToken:t,testMode:l,modelName:a="this model",onClose:r,onTestComplete:n}=e,[i,o]=x.useState(null),[c,d]=x.useState(null),[m,u]=x.useState(null),[p,g]=x.useState(!0),[j,f]=x.useState(!1),[v,_]=x.useState(!1),b=async()=>{g(!0),_(!1),o(null),d(null),u(null),f(!1),await new Promise(e=>setTimeout(e,100));try{console.log("Testing connection with form values:",s);let a=await sK(s,t,null);if(!a){console.log("No result from prepareModelAddRequest"),o("Failed to prepare model data. Please check your form inputs."),f(!1),g(!1);return}console.log("Result from prepareModelAddRequest:",a);let{litellmParamsObj:r,modelInfoObj:n,modelName:i}=a[0],c=await (0,y.Hx)(t,r,null==n?void 0:n.mode);if("success"===c.status)z.ZP.success("Connection test successful!"),o(null),f(!0);else{var e,l;let s=(null===(e=c.result)||void 0===e?void 0:e.error)||c.message||"Unknown error";o(s),d(r),u(null===(l=c.result)||void 0===l?void 0:l.raw_request_typed_dict),f(!1)}}catch(e){console.error("Test connection error:",e),o(e instanceof Error?e.message:String(e)),f(!1)}finally{g(!1),n&&n()}};x.useEffect(()=>{let e=setTimeout(()=>{b()},200);return()=>clearTimeout(e)},[]);let N=e=>e?e.split("stack trace:")[0].trim().replace(/^litellm\.(.*?)Error: /,""):"Unknown error",Z="string"==typeof i?N(i):(null==i?void 0:i.message)?N(i.message):"Unknown error",w=m?((e,s,t)=>{let l=JSON.stringify(s,null,2).split("\n").map(e=>"  ".concat(e)).join("\n"),a=Object.entries(t).map(e=>{let[s,t]=e;return"-H '".concat(s,": ").concat(t,"'")}).join(" \\\n  ");return"curl -X POST \\\n  ".concat(e," \\\n  ").concat(a?"".concat(a," \\\n  "):"","-H 'Content-Type: application/json' \\\n  -d '{\n").concat(l,"\n  }'")})(m.raw_request_api_base,m.raw_request_body,m.raw_request_headers||{}):"";return(0,h.jsxs)("div",{style:{padding:"24px",borderRadius:"8px",backgroundColor:"#fff"},children:[p?(0,h.jsxs)("div",{style:{textAlign:"center",padding:"32px 20px"},className:"jsx-776cdcbc0448e4ea",children:[(0,h.jsx)("div",{style:{marginBottom:"16px"},className:"jsx-776cdcbc0448e4ea loading-spinner",children:(0,h.jsx)("div",{style:{border:"3px solid #f3f3f3",borderTop:"3px solid #1890ff",borderRadius:"50%",width:"30px",height:"30px",animation:"spin 1s linear infinite",margin:"0 auto"},className:"jsx-776cdcbc0448e4ea"})}),(0,h.jsxs)(tT,{style:{fontSize:"16px"},children:["Testing connection to ",a,"..."]}),(0,h.jsx)(tI(),{id:"776cdcbc0448e4ea",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]}):j?(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"32px 20px"},children:[(0,h.jsx)("div",{style:{color:"#52c41a",fontSize:"24px",display:"flex",alignItems:"center"},children:(0,h.jsx)("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"check-circle",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",children:(0,h.jsx)("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"})})}),(0,h.jsxs)(tT,{type:"success",style:{fontSize:"18px",fontWeight:500,marginLeft:"10px"},children:["Connection to ",a," successful!"]})]}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px"},children:[(0,h.jsx)(ek.Z,{style:{color:"#ff4d4f",fontSize:"24px",marginRight:"12px"}}),(0,h.jsxs)(tT,{type:"danger",style:{fontSize:"18px",fontWeight:500},children:["Connection to ",a," failed"]})]}),(0,h.jsxs)("div",{style:{backgroundColor:"#fff2f0",border:"1px solid #ffccc7",borderRadius:"8px",padding:"16px",marginBottom:"20px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.03)"},children:[(0,h.jsx)(tT,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Error: "}),(0,h.jsx)(tT,{type:"danger",style:{fontSize:"14px",lineHeight:"1.5"},children:Z}),i&&(0,h.jsx)("div",{style:{marginTop:"12px"},children:(0,h.jsx)(V.ZP,{type:"link",onClick:()=>_(!v),style:{paddingLeft:0,height:"auto"},children:v?"Hide Details":"Show Details"})})]}),v&&(0,h.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,h.jsx)(tT,{strong:!0,style:{display:"block",marginBottom:"8px",fontSize:"15px"},children:"Troubleshooting Details"}),(0,h.jsx)("pre",{style:{backgroundColor:"#f5f5f5",padding:"16px",borderRadius:"8px",fontSize:"13px",maxHeight:"200px",overflow:"auto",border:"1px solid #e8e8e8",lineHeight:"1.5"},children:"string"==typeof i?i:JSON.stringify(i,null,2)})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(tT,{strong:!0,style:{display:"block",marginBottom:"8px",fontSize:"15px"},children:"API Request"}),(0,h.jsx)("pre",{style:{backgroundColor:"#f5f5f5",padding:"16px",borderRadius:"8px",fontSize:"13px",maxHeight:"250px",overflow:"auto",border:"1px solid #e8e8e8",lineHeight:"1.5"},children:w||"No request data available"}),(0,h.jsx)(V.ZP,{style:{marginTop:"8px"},icon:(0,h.jsx)(tA.Z,{}),onClick:()=>{navigator.clipboard.writeText(w||""),z.ZP.success("Copied to clipboard")},children:"Copy to Clipboard"})]})]})}),(0,h.jsx)(tP.Z,{style:{margin:"24px 0 16px"}}),(0,h.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,h.jsx)(V.ZP,{type:"link",href:"https://docs.litellm.ai/docs/providers",target:"_blank",icon:(0,h.jsx)($.Z,{}),children:"View Documentation"})})]})};let tL=[{value:"chat",label:"Chat - /chat/completions"},{value:"completion",label:"Completion - /completions"},{value:"embedding",label:"Embedding - /embeddings"},{value:"audio_speech",label:"Audio Speech - /audio/speech"},{value:"audio_transcription",label:"Audio Transcription - /audio/transcriptions"},{value:"image_generation",label:"Image Generation - /images/generations"},{value:"rerank",label:"Rerank - /rerank"},{value:"realtime",label:"Realtime - /realtime"}],{Title:tO,Link:tM}=ef.default;var tD=e=>{let{form:s,handleOk:t,selectedProvider:l,setSelectedProvider:a,providerModels:r,setProviderModelsFn:n,getPlaceholder:i,uploadProps:o,showAdvancedSettings:d,setShowAdvancedSettings:m,teams:u,credentials:p,accessToken:g,userRole:j}=e,[f,v]=(0,x.useState)("chat"),[_,b]=(0,x.useState)(!1),[N,Z]=(0,x.useState)(!1),[w,k]=(0,x.useState)(""),S=async()=>{Z(!0),k("test-".concat(Date.now())),b(!0)},[C,I]=(0,x.useState)([]);(0,x.useEffect)(()=>{(async()=>{I((await (0,y.So)(g,"","",!1,null,!0,!0)).data.map(e=>e.id))})()},[g]);let P=eF.includes(j);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(tO,{level:2,children:"Add new model"}),(0,h.jsx)(tb.Z,{children:(0,h.jsx)(R.Z,{form:s,onFinish:t,labelCol:{span:10},wrapperCol:{span:16},labelAlign:"left",children:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{rules:[{required:!0,message:"Required"}],label:"Provider:",name:"custom_llm_provider",tooltip:"E.g. OpenAI, Azure OpenAI, Anthropic, Bedrock, etc.",labelCol:{span:10},labelAlign:"left",children:(0,h.jsx)(F.default,{showSearch:!0,value:l,onChange:e=>{a(e),n(e),s.setFieldsValue({model:[],model_name:void 0})},children:Object.entries(c).map(e=>{let[s,t]=e;return(0,h.jsx)(F.default.Option,{value:s,children:(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("img",{src:sz[t],alt:"".concat(s," logo"),className:"w-5 h-5",onError:e=>{let s=e.target,l=s.parentElement;if(l){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=t.charAt(0),l.replaceChild(e,s)}}}),(0,h.jsx)("span",{children:t})]})},s)})})}),(0,h.jsx)(tN,{selectedProvider:l,providerModels:r,getPlaceholder:i}),(0,h.jsx)(tZ,{}),(0,h.jsx)(R.Z.Item,{label:"Mode",name:"mode",className:"mb-1",children:(0,h.jsx)(F.default,{style:{width:"100%"},value:f,onChange:e=>v(e),options:tL})}),(0,h.jsxs)(sG.Z,{children:[(0,h.jsx)(sJ.Z,{span:10}),(0,h.jsx)(sJ.Z,{span:10,children:(0,h.jsxs)(O.Z,{className:"mb-5 mt-1",children:[(0,h.jsx)("strong",{children:"Optional"})," - LiteLLM endpoint to use when health checking this model ",(0,h.jsx)(tM,{href:"https://docs.litellm.ai/docs/proxy/health#health",target:"_blank",children:"Learn more"})]})})]}),(0,h.jsx)("div",{className:"mb-4",children:(0,h.jsx)(ef.default.Text,{className:"text-sm text-gray-500 mb-2",children:"Either select existing credentials OR enter new provider credentials below"})}),(0,h.jsx)(R.Z.Item,{label:"Existing Credentials",name:"litellm_credential_name",children:(0,h.jsx)(F.default,{showSearch:!0,placeholder:"Select or search for existing credentials",optionFilterProp:"children",filterOption:(e,s)=>{var t;return(null!==(t=null==s?void 0:s.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},options:[{value:null,label:"None"},...p.map(e=>({value:e.credential_name,label:e.credential_name}))],allowClear:!0})}),(0,h.jsxs)("div",{className:"flex items-center my-4",children:[(0,h.jsx)("div",{className:"flex-grow border-t border-gray-200"}),(0,h.jsx)("span",{className:"px-4 text-gray-500 text-sm",children:"OR"}),(0,h.jsx)("div",{className:"flex-grow border-t border-gray-200"})]}),(0,h.jsx)(R.Z.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.litellm_credential_name!==s.litellm_credential_name||e.provider!==s.provider,children:e=>{let{getFieldValue:s}=e,t=s("litellm_credential_name");return(console.log("\uD83D\uDD11 Credential Name Changed:",t),t)?(0,h.jsx)("div",{className:"text-gray-500 text-sm text-center",children:"Using existing credentials - no additional provider fields needed"}):(0,h.jsx)(s$,{selectedProvider:l,uploadProps:o})}}),(0,h.jsxs)("div",{className:"flex items-center my-4",children:[(0,h.jsx)("div",{className:"flex-grow border-t border-gray-200"}),(0,h.jsx)("span",{className:"px-4 text-gray-500 text-sm",children:"Additional Model Info Settings"}),(0,h.jsx)("div",{className:"flex-grow border-t border-gray-200"})]}),(0,h.jsx)(R.Z.Item,{label:"Team",name:"team_id",className:"mb-4",tooltip:"Only keys for this team, will be able to call this model.",rules:[{required:!P,message:"Please select a team."}],children:(0,h.jsx)(ei,{teams:u})}),P&&(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(R.Z.Item,{label:"Model Access Group",name:"model_access_group",className:"mb-4",tooltip:"Use model access groups to give users access to select models, and add new ones to the group over time.",children:(0,h.jsx)(F.default,{mode:"tags",showSearch:!0,placeholder:"Select existing groups or type to create new ones",optionFilterProp:"children",tokenSeparators:[","],options:C.map(e=>({value:e,label:e})),maxTagCount:"responsive",allowClear:!0})})}),(0,h.jsx)(tS,{showAdvancedSettings:d,setShowAdvancedSettings:m,teams:u}),(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(X.Z,{title:"Get help on our github",children:(0,h.jsx)(ef.default.Link,{href:"https://github.com/BerriAI/litellm/issues",children:"Need Help?"})}),(0,h.jsxs)("div",{className:"space-x-2",children:[(0,h.jsx)(V.ZP,{onClick:S,loading:N,children:"Test Connect"}),(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Add Model"})]})]})]})})}),(0,h.jsx)(q.Z,{title:"Connection Test Results",open:_,onCancel:()=>{b(!1),Z(!1)},footer:[(0,h.jsx)(V.ZP,{onClick:()=>{b(!1),Z(!1)},children:"Close"},"close")],width:700,children:_&&(0,h.jsx)(tE,{formValues:s.getFieldsValue(),accessToken:g,testMode:f,modelName:s.getFieldValue("model_name")||s.getFieldValue("model"),onClose:()=>{b(!1),Z(!1)},onTestComplete:()=>Z(!1)},w)})]})};function tF(e){let{data:s=[],columns:t,isLoading:l=!1,table:a}=e,[r,n]=x.useState([{id:"model_info.created_at",desc:!0}]),[i]=x.useState("onChange"),[o,c]=x.useState({}),[d,m]=x.useState({}),u=(0,s_.b7)({data:s,columns:t,state:{sorting:r,columnSizing:o,columnVisibility:d},columnResizeMode:i,onSortingChange:n,onColumnSizingChange:c,onColumnVisibilityChange:m,getCoreRowModel:(0,sy.sC)(),getSortedRowModel:(0,sy.tj)(),enableSorting:!0,enableColumnResizing:!0,defaultColumn:{minSize:40,maxSize:500}});return x.useEffect(()=>{a&&(a.current=u)},[u,a]),(0,h.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsx)("div",{className:"relative min-w-full",children:(0,h.jsxs)(sN.Z,{className:"[&_td]:py-2 [&_th]:py-2 w-full",children:[(0,h.jsx)(sk.Z,{children:u.getHeaderGroups().map(e=>(0,h.jsx)(sC.Z,{children:e.headers.map(e=>(0,h.jsxs)(sS.Z,{className:"py-1 h-8 relative ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)] z-20 w-[120px] ml-8":""),style:{width:"actions"===e.id?120:e.getSize(),position:"actions"===e.id?"sticky":"relative",right:"actions"===e.id?0:"auto"},onClick:e.column.getCanSort()?e.column.getToggleSortingHandler():void 0,children:[(0,h.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,h.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,s_.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&e.column.getCanSort()&&(0,h.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,h.jsx)(sA.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,h.jsx)(sI.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,h.jsx)(sT.Z,{className:"h-4 w-4 text-gray-400"})})]}),e.column.getCanResize()&&(0,h.jsx)("div",{onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:"absolute right-0 top-0 h-full w-2 cursor-col-resize select-none touch-none ".concat(e.column.getIsResizing()?"bg-blue-500":"hover:bg-blue-200")})]},e.id))},e.id))}),(0,h.jsx)(sZ.Z,{children:l?(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:t.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:"\uD83D\uDE85 Loading models..."})})})}):u.getRowModel().rows.length>0?u.getRowModel().rows.map(e=>(0,h.jsx)(sC.Z,{children:e.getVisibleCells().map(e=>(0,h.jsx)(sw.Z,{className:"py-0.5 ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)] z-20 w-[120px] ml-8":""),style:{width:"actions"===e.column.id?120:e.column.getSize(),position:"actions"===e.column.id?"sticky":"relative",right:"actions"===e.column.id?0:"auto"},children:(0,s_.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:t.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:"No models found"})})})})})]})})})})}let tR=(e,s,t,l,a,r,n,i,o,c,d)=>[{header:"Model ID",accessorKey:"model_info.id",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)(X.Z,{title:t.model_info.id,children:(0,h.jsx)("div",{className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left w-full truncate whitespace-nowrap cursor-pointer max-w-[15ch]",onClick:()=>l(t.model_info.id),children:t.model_info.id})})}},{header:"Public Model Name",accessorKey:"model_name",cell:e=>{let{row:s}=e,t=r(s.original)||"-";return(0,h.jsx)(X.Z,{title:t,children:(0,h.jsx)("div",{className:"text-xs truncate whitespace-nowrap",children:t})})}},{header:"Provider",accessorKey:"provider",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[t.provider&&(0,h.jsx)("img",{src:sq(t.provider).logo,alt:"".concat(t.provider," logo"),className:"w-4 h-4",onError:e=>{let s=e.target,l=s.parentElement;if(l){var a;let e=document.createElement("div");e.className="w-4 h-4 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=(null===(a=t.provider)||void 0===a?void 0:a.charAt(0))||"-",l.replaceChild(e,s)}}}),(0,h.jsx)("p",{className:"text-xs",children:t.provider||"-"})]})}},{header:"LiteLLM Model Name",accessorKey:"litellm_model_name",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)(X.Z,{title:t.litellm_model_name,children:(0,h.jsx)("div",{className:"text-xs truncate whitespace-nowrap",children:t.litellm_model_name||"-"})})}},{header:"Created At",accessorKey:"model_info.created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("span",{className:"text-xs",children:t.model_info.created_at?new Date(t.model_info.created_at).toLocaleDateString():"-"})}},{header:"Updated At",accessorKey:"model_info.updated_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("span",{className:"text-xs",children:t.model_info.updated_at?new Date(t.model_info.updated_at).toLocaleDateString():"-"})}},{header:"Created By",accessorKey:"model_info.created_by",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("span",{className:"text-xs",children:t.model_info.created_by||"-"})}},{header:()=>(0,h.jsx)(X.Z,{title:"Cost per 1M tokens",children:(0,h.jsx)("span",{children:"Input Cost"})}),accessorKey:"input_cost",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("pre",{className:"text-xs",children:t.input_cost||"-"})}},{header:()=>(0,h.jsx)(X.Z,{title:"Cost per 1M tokens",children:(0,h.jsx)("span",{children:"Output Cost"})}),accessorKey:"output_cost",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("pre",{className:"text-xs",children:t.output_cost||"-"})}},{header:"Team ID",accessorKey:"model_info.team_id",cell:e=>{let{row:s}=e,t=s.original;return t.model_info.team_id?(0,h.jsx)("div",{className:"overflow-hidden",children:(0,h.jsx)(X.Z,{title:t.model_info.team_id,children:(0,h.jsxs)(P.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>a(t.model_info.team_id),children:[t.model_info.team_id.slice(0,7),"..."]})})}):"-"}},{header:"Model Access Group",accessorKey:"model_info.model_access_group",enableSorting:!1,cell:e=>{let{row:s}=e,t=s.original,l=t.model_info.access_groups;if(!l||0===l.length)return"-";let a=t.model_info.id,r=c.has(a),n=l.length>1,i=()=>{let e=new Set(c);r?e.delete(a):e.add(a),d(e)};return(0,h.jsxs)("div",{className:"flex items-center gap-1 overflow-hidden",children:[(0,h.jsx)(e1.Z,{size:"xs",color:"blue",className:"text-xs px-1.5 py-0.5 h-5 leading-tight flex-shrink-0",children:l[0]}),(r||!n&&2===l.length)&&l.slice(1).map((e,s)=>(0,h.jsx)(e1.Z,{size:"xs",color:"blue",className:"text-xs px-1.5 py-0.5 h-5 leading-tight flex-shrink-0",children:e},s+1)),n&&(0,h.jsx)("button",{onClick:e=>{e.stopPropagation(),i()},className:"text-xs text-blue-600 hover:text-blue-800 px-1 py-0.5 rounded hover:bg-blue-50 h-5 leading-tight flex-shrink-0 whitespace-nowrap",children:r?"−":"+".concat(l.length-1)})]})}},{header:"Credentials",accessorKey:"litellm_credential_name",cell:e=>{let{row:s}=e,t=s.original;return t.litellm_params&&t.litellm_params.litellm_credential_name?(0,h.jsx)("div",{className:"overflow-hidden",children:(0,h.jsxs)(X.Z,{title:t.litellm_params.litellm_credential_name,children:[t.litellm_params.litellm_credential_name.slice(0,7),"..."]})}):(0,h.jsx)("span",{className:"text-gray-400",children:"-"})}},{header:"Status",accessorKey:"model_info.db_model",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("div",{className:"\n          inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium\n          ".concat(t.model_info.db_model?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-600","\n        "),children:t.model_info.db_model?"DB Model":"Config Model"})}},{id:"actions",header:"",cell:t=>{var a;let{row:r}=t,n=r.original,i="Admin"===e||(null===(a=n.model_info)||void 0===a?void 0:a.created_by)===s;return(0,h.jsxs)("div",{className:"flex items-center justify-end gap-2 pr-4",children:[(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>{i&&(l(n.model_info.id),o(!0))},className:i?"cursor-pointer":"opacity-50 cursor-not-allowed"}),(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>{i&&(l(n.model_info.id),o(!1))},className:i?"cursor-pointer":"opacity-50 cursor-not-allowed"})]})}}];var tz=t(15731),tq=t(91126);let tU=(e,s,t,l,a,r,n,i,o,c,d)=>[{header:()=>(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)(ts.Z,{checked:t,indeterminate:s.length>0&&!t,onChange:e=>a(e.target.checked),onClick:e=>e.stopPropagation()}),(0,h.jsx)("span",{children:"Model ID"})]}),accessorKey:"model_info.id",enableSorting:!0,sortingFn:"alphanumeric",cell:e=>{let{row:t}=e,a=t.original,r=a.model_name,n=s.includes(r);return(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)(ts.Z,{checked:n,onChange:e=>l(r,e.target.checked),onClick:e=>e.stopPropagation()}),(0,h.jsx)(X.Z,{title:a.model_info.id,children:(0,h.jsx)("div",{className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left w-full truncate whitespace-nowrap cursor-pointer max-w-[15ch]",onClick:()=>d&&d(a.model_info.id),children:a.model_info.id})})]})}},{header:"Model Name",accessorKey:"model_name",enableSorting:!0,sortingFn:"alphanumeric",cell:e=>{let{row:s}=e,t=s.original,l=i(t)||t.model_name;return(0,h.jsx)("div",{className:"font-medium text-sm",children:(0,h.jsx)(X.Z,{title:l,children:(0,h.jsx)("div",{className:"truncate max-w-[200px]",children:l})})})}},{header:"Health Status",accessorKey:"health_status",enableSorting:!0,sortingFn:(e,s,t)=>{var l,a;let r=e.getValue("health_status")||"unknown",n=s.getValue("health_status")||"unknown",i={healthy:0,checking:1,unknown:2,unhealthy:3};return(null!==(l=i[r])&&void 0!==l?l:4)-(null!==(a=i[n])&&void 0!==a?a:4)},cell:s=>{var t;let{row:l}=s,a=l.original,r={status:a.health_status,loading:a.health_loading,error:a.health_error};if(r.loading)return(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsxs)("div",{className:"flex space-x-1",children:[(0,h.jsx)("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),(0,h.jsx)("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),(0,h.jsx)("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]}),(0,h.jsx)(O.Z,{className:"text-gray-600 text-sm",children:"Checking..."})]});let i=a.model_name,o="healthy"===r.status&&(null===(t=e[i])||void 0===t?void 0:t.successResponse);return(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[n(r.status),o&&c&&(0,h.jsx)(X.Z,{title:"View response details",placement:"top",children:(0,h.jsx)("button",{onClick:()=>{var s;return c(i,null===(s=e[i])||void 0===s?void 0:s.successResponse)},className:"p-1 text-green-600 hover:text-green-800 hover:bg-green-50 rounded cursor-pointer transition-colors",children:(0,h.jsx)(tz.Z,{className:"h-4 w-4"})})})]})}},{header:"Error Details",accessorKey:"health_error",enableSorting:!1,cell:s=>{let{row:t}=s,l=t.original.model_name,a=e[l];if(!(null==a?void 0:a.error))return(0,h.jsx)(O.Z,{className:"text-gray-400 text-sm",children:"No errors"});let r=a.error,n=a.fullError||a.error;return(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("div",{className:"max-w-[200px]",children:(0,h.jsx)(X.Z,{title:r,placement:"top",children:(0,h.jsx)(O.Z,{className:"text-red-600 text-sm truncate",children:r})})}),o&&n!==r&&(0,h.jsx)(X.Z,{title:"View full error details",placement:"top",children:(0,h.jsx)("button",{onClick:()=>o(l,r,n),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded cursor-pointer transition-colors",children:(0,h.jsx)(tz.Z,{className:"h-4 w-4"})})})]})}},{header:"Last Check",accessorKey:"last_check",enableSorting:!0,sortingFn:(e,s,t)=>{let l=e.getValue("last_check")||"Never checked",a=s.getValue("last_check")||"Never checked";if("Never checked"===l&&"Never checked"===a)return 0;if("Never checked"===l)return 1;if("Never checked"===a)return -1;if("Check in progress..."===l&&"Check in progress..."===a)return 0;if("Check in progress..."===l)return -1;if("Check in progress..."===a)return 1;let r=new Date(l),n=new Date(a);return isNaN(r.getTime())&&isNaN(n.getTime())?0:isNaN(r.getTime())?1:isNaN(n.getTime())?-1:n.getTime()-r.getTime()},cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)(O.Z,{className:"text-gray-600 text-sm",children:t.health_loading?"Check in progress...":t.last_check})}},{header:"Last Success",accessorKey:"last_success",enableSorting:!0,sortingFn:(e,s,t)=>{let l=e.getValue("last_success")||"Never succeeded",a=s.getValue("last_success")||"Never succeeded";if("Never succeeded"===l&&"Never succeeded"===a)return 0;if("Never succeeded"===l)return 1;if("Never succeeded"===a)return -1;if("None"===l&&"None"===a)return 0;if("None"===l)return 1;if("None"===a)return -1;let r=new Date(l),n=new Date(a);return isNaN(r.getTime())&&isNaN(n.getTime())?0:isNaN(r.getTime())?1:isNaN(n.getTime())?-1:n.getTime()-r.getTime()},cell:s=>{let{row:t}=s,l=e[t.original.model_name],a=(null==l?void 0:l.lastSuccess)||"None";return(0,h.jsx)(O.Z,{className:"text-gray-600 text-sm",children:a})}},{header:"Actions",id:"actions",cell:e=>{let{row:s}=e,t=s.original,l=t.model_name,a=t.health_status&&"none"!==t.health_status,n=t.health_loading?"Checking...":a?"Re-run Health Check":"Run Health Check";return(0,h.jsx)(X.Z,{title:n,placement:"top",children:(0,h.jsx)("button",{className:"p-2 rounded-md transition-colors ".concat(t.health_loading?"text-gray-400 cursor-not-allowed bg-gray-100":"text-indigo-600 hover:text-indigo-700 hover:bg-indigo-50"),onClick:()=>{t.health_loading||r(l)},disabled:t.health_loading,children:t.health_loading?(0,h.jsxs)("div",{className:"flex space-x-1",children:[(0,h.jsx)("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-pulse"}),(0,h.jsx)("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),(0,h.jsx)("div",{className:"w-1 h-1 bg-gray-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]}):a?(0,h.jsx)(e7.Z,{className:"h-4 w-4"}):(0,h.jsx)(tq.Z,{className:"h-4 w-4"})})})},enableSorting:!1}],tV=[{pattern:/Missing .* API Key/i,replacement:"Missing API Key"},{pattern:/Connection timeout/i,replacement:"Connection timeout"},{pattern:/Network.*not.*ok/i,replacement:"Network connection failed"},{pattern:/403.*Forbidden/i,replacement:"Access forbidden - check API key permissions"},{pattern:/401.*Unauthorized/i,replacement:"Unauthorized - invalid API key"},{pattern:/429.*rate limit/i,replacement:"Rate limit exceeded"},{pattern:/500.*Internal Server Error/i,replacement:"Provider internal server error"},{pattern:/litellm\.AuthenticationError/i,replacement:"Authentication failed"},{pattern:/litellm\.RateLimitError/i,replacement:"Rate limit exceeded"},{pattern:/litellm\.APIError/i,replacement:"API error"}];var tK=e=>{let{accessToken:s,modelData:t,all_models_on_proxy:l,getDisplayModelName:a,setSelectedModelId:r}=e,[n,i]=(0,x.useState)({}),[o,c]=(0,x.useState)([]),[d,m]=(0,x.useState)(!1),[u,p]=(0,x.useState)(!1),[g,j]=(0,x.useState)(null),[f,v]=(0,x.useState)(!1),[_,b]=(0,x.useState)(null),N=(0,x.useRef)(null);(0,x.useEffect)(()=>{s&&(null==t?void 0:t.data)&&(async()=>{let e={};t.data.forEach(s=>{e[s.model_name]={status:"none",lastCheck:"None",lastSuccess:"None",loading:!1,error:void 0,fullError:void 0,successResponse:void 0}});try{let l=await (0,y.xO)(s);l&&l.latest_health_checks&&"object"==typeof l.latest_health_checks&&Object.entries(l.latest_health_checks).forEach(s=>{let[l,a]=s;if(!a)return;let r=null,n=t.data.find(e=>e.model_name===l);if(n)r=n.model_name;else{let e=t.data.find(e=>e.model_info&&e.model_info.id===l);if(e)r=e.model_name;else if(a.model_name){let e=t.data.find(e=>e.model_name===a.model_name);e&&(r=e.model_name)}}if(r){let s=a.error_message||void 0;e[r]={status:a.status||"unknown",lastCheck:a.checked_at?new Date(a.checked_at).toLocaleString():"None",lastSuccess:"healthy"===a.status&&a.checked_at?new Date(a.checked_at).toLocaleString():"None",loading:!1,error:s?Z(s):void 0,fullError:s,successResponse:"healthy"===a.status?a:void 0}}})}catch(e){console.warn("Failed to load health check history (using default states):",e)}i(e)})()},[s,t]);let Z=e=>{var s;if(!e)return"Health check failed";let t="string"==typeof e?e:JSON.stringify(e),l=t.match(/(\w+Error):\s*(\d{3})/i);if(l)return"".concat(l[1],": ").concat(l[2]);let a=t.match(/(AuthenticationError|RateLimitError|BadRequestError|InternalServerError|TimeoutError|NotFoundError|ForbiddenError|ServiceUnavailableError|BadGatewayError|ContentPolicyViolationError|\w+Error)/i),r=t.match(/\b(400|401|403|404|408|429|500|502|503|504)\b/);if(a&&r)return"".concat(a[1],": ").concat(r[1]);if(r){let e=r[1];return"".concat({400:"BadRequestError",401:"AuthenticationError",403:"ForbiddenError",404:"NotFoundError",408:"TimeoutError",429:"RateLimitError",500:"InternalServerError",502:"BadGatewayError",503:"ServiceUnavailableError",504:"GatewayTimeoutError"}[e],": ").concat(e)}if(a){let e=a[1],s={AuthenticationError:"401",RateLimitError:"429",BadRequestError:"400",InternalServerError:"500",TimeoutError:"408",NotFoundError:"404",ForbiddenError:"403",ServiceUnavailableError:"503",BadGatewayError:"502",GatewayTimeoutError:"504",ContentPolicyViolationError:"400"}[e];return s?"".concat(e,": ").concat(s):e}for(let{pattern:e,replacement:s}of tV)if(e.test(t))return s;if(/missing.*api.*key|invalid.*key|unauthorized/i.test(t))return"AuthenticationError: 401";if(/rate.*limit|too.*many.*requests/i.test(t))return"RateLimitError: 429";if(/timeout|timed.*out/i.test(t))return"TimeoutError: 408";if(/not.*found/i.test(t))return"NotFoundError: 404";if(/forbidden|access.*denied/i.test(t))return"ForbiddenError: 403";if(/internal.*server.*error/i.test(t))return"InternalServerError: 500";let n=t.replace(/[\n\r]+/g," ").replace(/\s+/g," ").trim(),i=null===(s=n.split(/[.!?]/)[0])||void 0===s?void 0:s.trim();return i&&i.length>0?i.length>100?i.substring(0,97)+"...":i:n.length>100?n.substring(0,97)+"...":n},w=async e=>{if(s){i(s=>({...s,[e]:{...s[e],loading:!0,status:"checking"}}));try{var l,a;let r=await (0,y.Nz)(s,e),n=new Date().toLocaleString();if(r.unhealthy_count>0&&r.unhealthy_endpoints&&r.unhealthy_endpoints.length>0){let s=(null===(l=r.unhealthy_endpoints[0])||void 0===l?void 0:l.error)||"Health check failed",t=Z(s);i(l=>{var a;return{...l,[e]:{status:"unhealthy",lastCheck:n,lastSuccess:(null===(a=l[e])||void 0===a?void 0:a.lastSuccess)||"None",loading:!1,error:t,fullError:s}}})}else i(s=>({...s,[e]:{status:"healthy",lastCheck:n,lastSuccess:n,loading:!1,successResponse:r}}));try{let l=await (0,y.xO)(s),r=t.data.find(s=>s.model_name===e);if(r){let s=r.model_info.id,t=null===(a=l.latest_health_checks)||void 0===a?void 0:a[s];if(t){let s=t.error_message||void 0;i(l=>{var a,r,n,i,o,c,d;return{...l,[e]:{status:t.status||(null===(a=l[e])||void 0===a?void 0:a.status)||"unknown",lastCheck:t.checked_at?new Date(t.checked_at).toLocaleString():(null===(r=l[e])||void 0===r?void 0:r.lastCheck)||"None",lastSuccess:"healthy"===t.status?t.checked_at?new Date(t.checked_at).toLocaleString():(null===(n=l[e])||void 0===n?void 0:n.lastSuccess)||"None":(null===(i=l[e])||void 0===i?void 0:i.lastSuccess)||"None",loading:!1,error:s?Z(s):null===(o=l[e])||void 0===o?void 0:o.error,fullError:s||(null===(c=l[e])||void 0===c?void 0:c.fullError),successResponse:"healthy"===t.status?t:null===(d=l[e])||void 0===d?void 0:d.successResponse}}})}}}catch(e){console.debug("Could not fetch updated status from database (non-critical):",e)}}catch(a){let s=new Date().toLocaleString(),t=a instanceof Error?a.message:String(a),l=Z(t);i(a=>{var r;return{...a,[e]:{status:"unhealthy",lastCheck:s,lastSuccess:(null===(r=a[e])||void 0===r?void 0:r.lastSuccess)||"None",loading:!1,error:l,fullError:t}}})}}},k=async()=>{let e=o.length>0?o:l,a=e.reduce((e,s)=>(e[s]={...n[s],loading:!0,status:"checking"},e),{});i(e=>({...e,...a}));let r={},c=e.map(async e=>{if(s)try{let l=await (0,y.Nz)(s,e);r[e]=l;let a=new Date().toLocaleString();if(l.unhealthy_count>0&&l.unhealthy_endpoints&&l.unhealthy_endpoints.length>0){var t;let s=(null===(t=l.unhealthy_endpoints[0])||void 0===t?void 0:t.error)||"Health check failed",r=Z(s);i(t=>{var l;return{...t,[e]:{status:"unhealthy",lastCheck:a,lastSuccess:(null===(l=t[e])||void 0===l?void 0:l.lastSuccess)||"None",loading:!1,error:r,fullError:s}}})}else i(s=>({...s,[e]:{status:"healthy",lastCheck:a,lastSuccess:a,loading:!1,successResponse:l}}))}catch(a){console.error("Health check failed for ".concat(e,":"),a);let s=new Date().toLocaleString(),t=a instanceof Error?a.message:String(a),l=Z(t);i(a=>{var r;return{...a,[e]:{status:"unhealthy",lastCheck:s,lastSuccess:(null===(r=a[e])||void 0===r?void 0:r.lastSuccess)||"None",loading:!1,error:l,fullError:t}}})}});await Promise.allSettled(c);try{if(!s)return;let l=await (0,y.xO)(s);l.latest_health_checks&&Object.entries(l.latest_health_checks).forEach(s=>{let[l,a]=s,r=t.data.find(e=>e.model_info.id===l);if(r&&e.includes(r.model_name)&&a){let e=r.model_name,s=a.error_message||void 0;i(t=>{let l=t[e];return{...t,[e]:{status:a.status||(null==l?void 0:l.status)||"unknown",lastCheck:a.checked_at?new Date(a.checked_at).toLocaleString():(null==l?void 0:l.lastCheck)||"None",lastSuccess:"healthy"===a.status&&a.checked_at?new Date(a.checked_at).toLocaleString():(null==l?void 0:l.lastSuccess)||"None",loading:!1,error:s?Z(s):null==l?void 0:l.error,fullError:s||(null==l?void 0:l.fullError),successResponse:"healthy"===a.status?a:null==l?void 0:l.successResponse}}})}})}catch(e){console.warn("Failed to fetch updated health statuses from database (non-critical):",e)}},S=e=>{m(e),e?c(l):c([])},C=()=>{p(!1),j(null)},I=()=>{v(!1),b(null)};return(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:"mb-6",children:(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(M.Z,{children:"Model Health Status"}),(0,h.jsx)(O.Z,{className:"text-gray-600 mt-1",children:"Run health checks on individual models to verify they are working correctly"})]}),(0,h.jsxs)("div",{className:"flex items-center gap-3",children:[o.length>0&&(0,h.jsx)(P.Z,{size:"sm",variant:"light",onClick:()=>S(!1),className:"px-3 py-1 text-sm",children:"Clear Selection"}),(0,h.jsx)(P.Z,{size:"sm",variant:"secondary",onClick:k,disabled:Object.values(n).some(e=>e.loading),className:"px-3 py-1 text-sm",children:o.length>0&&o.length<l.length?"Run Selected Checks":"Run All Checks"})]})]})}),(0,h.jsx)("div",{children:(0,h.jsx)(tF,{columns:tU(n,o,d,(e,s)=>{s?c(s=>[...s,e]):(c(s=>s.filter(s=>s!==e)),m(!1))},S,w,e=>{switch(e){case"healthy":return(0,h.jsx)(e1.Z,{color:"emerald",children:"healthy"});case"unhealthy":return(0,h.jsx)(e1.Z,{color:"red",children:"unhealthy"});case"checking":return(0,h.jsx)(e1.Z,{color:"blue",children:"checking"});case"none":return(0,h.jsx)(e1.Z,{color:"gray",children:"none"});default:return(0,h.jsx)(e1.Z,{color:"gray",children:"unknown"})}},a,(e,s,t)=>{j({modelName:e,cleanedError:s,fullError:t}),p(!0)},(e,s)=>{b({modelName:e,response:s}),v(!0)},r),data:t.data.map(e=>{let s=n[e.model_name]||{status:"none",lastCheck:"None",loading:!1};return{model_name:e.model_name,model_info:e.model_info,provider:e.provider,litellm_model_name:e.litellm_model_name,health_status:s.status,last_check:s.lastCheck,last_success:s.lastSuccess||"None",health_loading:s.loading,health_error:s.error,health_full_error:s.fullError}}),isLoading:!1,table:N})}),(0,h.jsx)(q.Z,{title:g?"Health Check Error - ".concat(g.modelName):"Error Details",open:u,onCancel:C,footer:[(0,h.jsx)(V.ZP,{onClick:C,children:"Close"},"close")],width:800,children:g&&(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Error:"}),(0,h.jsx)("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,h.jsx)(O.Z,{className:"text-red-800",children:g.cleanedError})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Full Error Details:"}),(0,h.jsx)("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md max-h-96 overflow-y-auto",children:(0,h.jsx)("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:g.fullError})})]})]})}),(0,h.jsx)(q.Z,{title:_?"Health Check Response - ".concat(_.modelName):"Response Details",open:f,onCancel:I,footer:[(0,h.jsx)(V.ZP,{onClick:I,children:"Close"},"close")],width:800,children:_&&(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Status:"}),(0,h.jsx)("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-md",children:(0,h.jsx)(O.Z,{className:"text-green-800",children:"Health check passed successfully"})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Response Details:"}),(0,h.jsx)("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md max-h-96 overflow-y-auto",children:(0,h.jsx)("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:JSON.stringify(_.response,null,2)})})]})]})})]})},tB=t(92858),tH=t(61778),tG=t(12660),tJ=t(93142),tY=e=>{let{value:s={},onChange:t}=e,[l,a]=(0,x.useState)(Object.entries(s)),r=e=>{let s=l.filter((s,t)=>t!==e);a(s),null==t||t(Object.fromEntries(s))},n=(e,s,r)=>{let n=[...l];n[e]=[s,r],a(n),null==t||t(Object.fromEntries(n))};return(0,h.jsxs)("div",{children:[l.map((e,s)=>{let[t,l]=e;return(0,h.jsxs)(tJ.Z,{style:{display:"flex",marginBottom:8},align:"center",children:[(0,h.jsx)(A.Z,{placeholder:"Header Name",value:t,onChange:e=>n(s,e.target.value,l)}),(0,h.jsx)(A.Z,{placeholder:"Header Value",value:l,onChange:e=>n(s,t,e.target.value)}),(0,h.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:(0,h.jsx)(tj.Z,{onClick:()=>r(s),style:{cursor:"pointer"}})})]},s)}),(0,h.jsx)(V.ZP,{type:"dashed",onClick:()=>{a([...l,["",""]])},icon:(0,h.jsx)(tf.Z,{}),children:"Add Header"})]})},tW=t(77565),t$=e=>{let{pathValue:s,targetValue:t,includeSubpath:l}=e,a=(0,y.zX)();return s&&t?(0,h.jsxs)(eo.Z,{className:"p-5",children:[(0,h.jsx)(M.Z,{className:"text-lg font-semibold text-gray-900 mb-2",children:"Route Preview"}),(0,h.jsx)(sD.Z,{className:"text-gray-600 mb-5",children:"How your requests will be routed"}),(0,h.jsxs)("div",{className:"space-y-5",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:"text-base font-semibold text-gray-900 mb-3",children:"Basic routing:"}),(0,h.jsxs)("div",{className:"flex items-center gap-4",children:[(0,h.jsxs)("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,h.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Your endpoint"}),(0,h.jsx)("code",{className:"font-mono text-sm text-gray-900",children:s?"".concat(a).concat(s):""})]}),(0,h.jsx)("div",{className:"text-gray-400",children:(0,h.jsx)(tW.Z,{className:"text-lg"})}),(0,h.jsxs)("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,h.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Forwards to"}),(0,h.jsx)("code",{className:"font-mono text-sm text-gray-900",children:t})]})]})]}),l&&(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:"text-base font-semibold text-gray-900 mb-3",children:"With subpaths:"}),(0,h.jsxs)("div",{className:"flex items-center gap-4",children:[(0,h.jsxs)("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,h.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Your endpoint + subpath"}),(0,h.jsxs)("code",{className:"font-mono text-sm text-gray-900",children:[s&&"".concat(a).concat(s),(0,h.jsx)("span",{className:"text-blue-600",children:"/v1/text-to-image/base/model"})]})]}),(0,h.jsx)("div",{className:"text-gray-400",children:(0,h.jsx)(tW.Z,{className:"text-lg"})}),(0,h.jsxs)("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,h.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Forwards to"}),(0,h.jsxs)("code",{className:"font-mono text-sm text-gray-900",children:[t,(0,h.jsx)("span",{className:"text-blue-600",children:"/v1/text-to-image/base/model"})]})]})]}),(0,h.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:["Any path after ",s," will be appended to the target URL"]})]})}),!l&&(0,h.jsx)("div",{className:"mt-4 p-3 bg-blue-50 rounded-md border border-blue-200",children:(0,h.jsxs)("div",{className:"flex items-start",children:[(0,h.jsx)($.Z,{className:"text-blue-500 mt-0.5 mr-2 flex-shrink-0"}),(0,h.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,h.jsx)("span",{className:"font-medium",children:"Not seeing the routing you wanted?"})," Try enabling - Include Subpaths - above - this allows subroutes like ",(0,h.jsx)("code",{className:"bg-blue-100 px-1 py-0.5 rounded font-mono text-xs",children:"/api/v1/models"})," to be forwarded automatically."]})]})})]})]}):null};let{Option:tX}=F.default;var tQ=e=>{let{accessToken:s,setPassThroughItems:t,passThroughItems:l}=e,[a]=R.Z.useForm(),[r,n]=(0,x.useState)(!1),[i,o]=(0,x.useState)(!1),[c,d]=(0,x.useState)(""),[m,u]=(0,x.useState)(""),[p,g]=(0,x.useState)(""),[j,f]=(0,x.useState)(!0),v=()=>{a.resetFields(),u(""),g(""),f(!0),n(!1)},_=e=>{let s=e;e&&!e.startsWith("/")&&(s="/"+e),u(s),a.setFieldsValue({path:s})},b=async e=>{console.log("addPassThrough called with:",e),o(!0);try{console.log("formValues: ".concat(JSON.stringify(e)));let r=(await (0,y.Vt)(s,e)).endpoints[0],i=[...l,r];t(i),z.ZP.success("Pass-through endpoint created successfully"),a.resetFields(),u(""),g(""),f(!0),n(!1)}catch(e){z.ZP.error("Error creating pass-through endpoint: "+e,20)}finally{o(!1)}};return(0,h.jsxs)("div",{children:[(0,h.jsx)(P.Z,{className:"mx-auto mb-4 mt-4",onClick:()=>n(!0),children:"+ Add Pass-Through Endpoint"}),(0,h.jsx)(q.Z,{title:(0,h.jsxs)("div",{className:"flex items-center space-x-3 pb-4 border-b border-gray-100",children:[(0,h.jsx)(tG.Z,{className:"text-xl text-blue-500"}),(0,h.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add Pass-Through Endpoint"})]}),open:r,width:1e3,onCancel:v,footer:null,className:"top-8",styles:{body:{padding:"24px"},header:{padding:"24px 24px 0 24px",border:"none"}},children:(0,h.jsxs)("div",{className:"mt-6",children:[(0,h.jsx)(tH.Z,{message:"What is a Pass-Through Endpoint?",description:"Route requests from your LiteLLM proxy to any external API. Perfect for custom models, image generation APIs, or any service you want to proxy through LiteLLM.",type:"info",showIcon:!0,className:"mb-6"}),(0,h.jsxs)(R.Z,{form:a,onFinish:b,layout:"vertical",className:"space-y-6",initialValues:{include_subpath:!0,path:m,target:p},children:[(0,h.jsxs)(eo.Z,{className:"p-5",children:[(0,h.jsx)(M.Z,{className:"text-lg font-semibold text-gray-900 mb-2",children:"Route Configuration"}),(0,h.jsx)(sD.Z,{className:"text-gray-600 mb-5",children:"Configure how requests to your domain will be forwarded to the target API"}),(0,h.jsxs)("div",{className:"space-y-5",children:[(0,h.jsx)(R.Z.Item,{label:(0,h.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Path Prefix"}),name:"path",rules:[{required:!0,message:"Path is required",pattern:/^\//}],extra:(0,h.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Example: /bria, /adobe-photoshop, /elasticsearch"}),className:"mb-4",children:(0,h.jsx)("div",{className:"flex items-center",children:(0,h.jsx)(A.Z,{placeholder:"bria",value:m,onChange:e=>_(e.target.value),className:"flex-1"})})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Target URL"}),name:"target",rules:[{required:!0,message:"Target URL is required"},{type:"url",message:"Please enter a valid URL"}],extra:(0,h.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Example:https://engine.prod.bria-api.com"}),className:"mb-4",children:(0,h.jsx)(A.Z,{placeholder:"https://engine.prod.bria-api.com",value:p,onChange:e=>{g(e.target.value),a.setFieldsValue({target:e.target.value})}})}),(0,h.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Include Subpaths"}),(0,h.jsx)("div",{className:"text-xs text-gray-500 mt-0.5",children:"Forward all subpaths to the target API (recommended for REST APIs)"})]}),(0,h.jsx)(R.Z.Item,{name:"include_subpath",valuePropName:"checked",className:"mb-0",children:(0,h.jsx)(tB.Z,{checked:j,onChange:f})})]})]})]}),(0,h.jsx)(t$,{pathValue:m,targetValue:p,includeSubpath:j}),(0,h.jsxs)(eo.Z,{className:"p-6",children:[(0,h.jsx)(M.Z,{className:"text-lg font-semibold text-gray-900 mb-2",children:"Headers"}),(0,h.jsx)(sD.Z,{className:"text-gray-600 mb-6",children:"Add headers that will be sent with every request to the target API"}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Authentication Headers",(0,h.jsx)(X.Z,{title:"Authentication and other headers to forward with requests",children:(0,h.jsx)($.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"headers",rules:[{required:!0,message:"Please configure the headers"}],extra:(0,h.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:[(0,h.jsx)("div",{className:"font-medium mb-1",children:"Add authentication tokens and other required headers"}),(0,h.jsx)("div",{children:"Common examples: auth_token, Authorization, x-api-key"})]}),children:(0,h.jsx)(tY,{})})]}),(0,h.jsxs)(eo.Z,{className:"p-6",children:[(0,h.jsx)(M.Z,{className:"text-lg font-semibold text-gray-900 mb-2",children:"Billing"}),(0,h.jsx)(sD.Z,{className:"text-gray-600 mb-6",children:"Optional cost tracking for this endpoint"}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Cost Per Request (USD)",(0,h.jsx)(X.Z,{title:"Optional: Track costs for requests to this endpoint",children:(0,h.jsx)($.Z,{className:"ml-2 text-gray-400 hover:text-gray-600"})})]}),name:"cost_per_request",extra:(0,h.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"The cost charged for each request through this endpoint"}),children:(0,h.jsx)(H,{min:0,step:.001,precision:4,placeholder:"2.0000",size:"large"})})]}),(0,h.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-100",children:[(0,h.jsx)(P.Z,{variant:"secondary",onClick:v,children:"Cancel"}),(0,h.jsx)(P.Z,{variant:"primary",loading:i,onClick:()=>{console.log("Submit button clicked"),a.submit()},children:i?"Creating...":"Add Pass-Through Endpoint"})]})]})]})})]})},t0=t(87769),t1=t(42208);let t2=e=>{let{value:s}=e,[t,l]=(0,x.useState)(!1),a=JSON.stringify(s,null,2);return(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("pre",{className:"font-mono text-xs bg-gray-50 p-2 rounded max-w-md overflow-auto",children:t?a:"••••••••"}),(0,h.jsx)("button",{onClick:()=>l(!t),className:"p-1 hover:bg-gray-100 rounded",type:"button",children:t?(0,h.jsx)(t0.Z,{className:"w-4 h-4 text-gray-500"}):(0,h.jsx)(t1.Z,{className:"w-4 h-4 text-gray-500"})})]})};var t4=e=>{let{endpointData:s,onClose:t,accessToken:l,isAdmin:a,onEndpointUpdated:r}=e,[n,i]=(0,x.useState)(s),[o,c]=(0,x.useState)(!1),[d,m]=(0,x.useState)(!1),[u]=R.Z.useForm(),p=async e=>{try{if(!l||!(null==n?void 0:n.id))return;let s={};if(e.headers)try{s="string"==typeof e.headers?JSON.parse(e.headers):e.headers}catch(e){z.ZP.error("Invalid JSON format for headers");return}let t={path:n.path,target:e.target,headers:s,include_subpath:e.include_subpath,cost_per_request:e.cost_per_request};await (0,y.Tx)(l,n.id,t),i({...n,...t}),m(!1),r&&r()}catch(e){console.error("Error updating endpoint:",e),z.ZP.error("Failed to update pass through endpoint")}},g=async()=>{try{if(!l||!(null==n?void 0:n.id))return;await (0,y.EG)(l,n.id),z.ZP.success("Pass through endpoint deleted successfully"),t(),r&&r()}catch(e){console.error("Error deleting endpoint:",e),z.ZP.error("Failed to delete pass through endpoint")}};return o?(0,h.jsx)("div",{className:"p-4",children:"Loading..."}):n?(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,h.jsxs)("div",{children:[(0,h.jsx)(V.ZP,{onClick:t,className:"mb-4",children:"← Back"}),(0,h.jsxs)(M.Z,{children:["Pass Through Endpoint: ",n.path]}),(0,h.jsx)(O.Z,{className:"text-gray-500 font-mono",children:n.id})]})}),(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{className:"mb-4",children:[(0,h.jsx)(e2.Z,{children:"Overview"},"overview"),a?(0,h.jsx)(e2.Z,{children:"Settings"},"settings"):(0,h.jsx)(h.Fragment,{})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsxs)(e6.Z,{children:[(0,h.jsxs)(I.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Path"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)(M.Z,{className:"font-mono",children:n.path})})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Target"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)(M.Z,{children:n.target})})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Configuration"}),(0,h.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,h.jsx)("div",{children:(0,h.jsx)(e1.Z,{color:n.include_subpath?"green":"gray",children:n.include_subpath?"Include Subpath":"Exact Path"})}),void 0!==n.cost_per_request&&(0,h.jsx)("div",{children:(0,h.jsxs)(O.Z,{children:["Cost per request: $",n.cost_per_request]})})]})]})]}),(0,h.jsx)("div",{className:"mt-6",children:(0,h.jsx)(t$,{pathValue:n.path,targetValue:n.target,includeSubpath:n.include_subpath||!1})}),n.headers&&Object.keys(n.headers).length>0&&(0,h.jsxs)(eo.Z,{className:"mt-6",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Headers"}),(0,h.jsxs)(e1.Z,{color:"blue",children:[Object.keys(n.headers).length," headers configured"]})]}),(0,h.jsx)("div",{className:"mt-4",children:(0,h.jsx)(t2,{value:n.headers})})]})]}),a&&(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(M.Z,{children:"Pass Through Endpoint Settings"}),(0,h.jsx)("div",{className:"space-x-2",children:!d&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(P.Z,{onClick:()=>m(!0),children:"Edit Settings"}),(0,h.jsx)(P.Z,{onClick:g,variant:"secondary",color:"red",children:"Delete Endpoint"})]})})]}),d?(0,h.jsxs)(R.Z,{form:u,onFinish:p,initialValues:{target:n.target,headers:n.headers?JSON.stringify(n.headers,null,2):"",include_subpath:n.include_subpath||!1,cost_per_request:n.cost_per_request},layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{label:"Target URL",name:"target",rules:[{required:!0,message:"Please input a target URL"}],children:(0,h.jsx)(A.Z,{placeholder:"https://api.example.com"})}),(0,h.jsx)(R.Z.Item,{label:"Headers (JSON)",name:"headers",children:(0,h.jsx)(K.default.TextArea,{rows:5,placeholder:'{"Authorization": "Bearer your-token", "Content-Type": "application/json"}'})}),(0,h.jsx)(R.Z.Item,{label:"Include Subpath",name:"include_subpath",valuePropName:"checked",children:(0,h.jsx)(tg.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"Cost per Request",name:"cost_per_request",children:(0,h.jsx)(W.Z,{min:0,step:.01,precision:2,placeholder:"0.00",addonBefore:"$"})}),(0,h.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,h.jsx)(V.ZP,{onClick:()=>m(!1),children:"Cancel"}),(0,h.jsx)(P.Z,{children:"Save Changes"})]})]}):(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Path"}),(0,h.jsx)("div",{className:"font-mono",children:n.path})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Target URL"}),(0,h.jsx)("div",{children:n.target})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Include Subpath"}),(0,h.jsx)(e1.Z,{color:n.include_subpath?"green":"gray",children:n.include_subpath?"Yes":"No"})]}),void 0!==n.cost_per_request&&(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Cost per Request"}),(0,h.jsxs)("div",{children:["$",n.cost_per_request]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Headers"}),n.headers&&Object.keys(n.headers).length>0?(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)(t2,{value:n.headers})}):(0,h.jsx)("div",{className:"text-gray-500",children:"No headers configured"})]})]})]})})]})]})]}):(0,h.jsx)("div",{className:"p-4",children:"Pass through endpoint not found"})};function t5(e){let{data:s=[],columns:t,getRowCanExpand:l,renderSubComponent:a,isLoading:r=!1,loadingMessage:n="\uD83D\uDE85 Loading logs...",noDataMessage:i="No logs found"}=e,o=(0,s_.b7)({data:s,columns:t,getRowCanExpand:l,getRowId:(e,s)=>{var t;return null!==(t=null==e?void 0:e.request_id)&&void 0!==t?t:String(s)},getCoreRowModel:(0,sy.sC)(),getExpandedRowModel:(0,sy.rV)()});return(0,h.jsx)("div",{className:"rounded-lg custom-border",children:(0,h.jsxs)(sN.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,h.jsx)(sk.Z,{children:o.getHeaderGroups().map(e=>(0,h.jsx)(sC.Z,{children:e.headers.map(e=>(0,h.jsx)(sS.Z,{className:"py-1 h-8",children:e.isPlaceholder?null:(0,s_.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,h.jsx)(sZ.Z,{children:r?(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:t.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:n})})})}):o.getRowModel().rows.length>0?o.getRowModel().rows.map(e=>(0,h.jsxs)(x.Fragment,{children:[(0,h.jsx)(sC.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,h.jsx)(sw.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,s_.ie)(e.column.columnDef.cell,e.getContext())},e.id))}),e.getIsExpanded()&&(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:e.getVisibleCells().length,children:a({row:e})})})]},e.id)):(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:t.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:i})})})})})]})})}let t6=e=>{let{value:s}=e,[t,l]=(0,x.useState)(!1),a=JSON.stringify(s);return(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("span",{className:"font-mono text-xs",children:t?a:"••••••••"}),(0,h.jsx)("button",{onClick:()=>l(!t),className:"p-1 hover:bg-gray-100 rounded",type:"button",children:t?(0,h.jsx)(t0.Z,{className:"w-4 h-4 text-gray-500"}):(0,h.jsx)(t1.Z,{className:"w-4 h-4 text-gray-500"})})]})};var t3=e=>{let{accessToken:s,userRole:t,userID:l,modelData:a}=e,[r,n]=(0,x.useState)([]),[i,o]=(0,x.useState)(null),[c,d]=(0,x.useState)(!1),[m,u]=(0,x.useState)(null);(0,x.useEffect)(()=>{s&&t&&l&&(0,y.mp)(s).then(e=>{n(e.endpoints)})},[s,t,l]);let p=async e=>{u(e),d(!0)},g=async()=>{if(null!=m&&s){try{await (0,y.EG)(s,m);let e=r.filter(e=>e.id!==m);n(e),z.ZP.success("Endpoint deleted successfully.")}catch(e){console.error("Error deleting the endpoint:",e),z.ZP.error("Error deleting the endpoint: "+e)}d(!1),u(null)}},j=(e,s)=>{p(e)},f=[{header:"ID",accessorKey:"id",cell:e=>(0,h.jsx)(X.Z,{title:e.row.original.id,children:(0,h.jsx)("div",{className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left w-full truncate whitespace-nowrap cursor-pointer max-w-[15ch]",onClick:()=>e.row.original.id&&o(e.row.original.id),children:e.row.original.id})})},{header:"Path",accessorKey:"path"},{header:"Target",accessorKey:"target",cell:e=>(0,h.jsx)(O.Z,{children:e.getValue()})},{header:"Headers",accessorKey:"headers",cell:e=>(0,h.jsx)(t6,{value:e.getValue()||{}})},{header:"Actions",id:"actions",cell:e=>{let{row:s}=e;return(0,h.jsxs)("div",{className:"flex space-x-1",children:[(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>s.original.id&&o(s.original.id),title:"Edit"}),(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>j(s.original.id,s.index),title:"Delete"})]})}}];if(!s)return null;if(i){console.log("selectedEndpointId",i),console.log("generalSettings",r);let e=r.find(e=>e.id===i);return e?(0,h.jsx)(t4,{endpointData:e,onClose:()=>o(null),accessToken:s,isAdmin:"Admin"===t||"admin"===t,onEndpointUpdated:()=>{s&&(0,y.mp)(s).then(e=>{n(e.endpoints)})}}):(0,h.jsx)("div",{children:"Endpoint not found"})}return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(M.Z,{children:"Pass Through Endpoints"}),(0,h.jsx)(O.Z,{className:"text-tremor-content",children:"Configure and manage your pass-through endpoints"})]}),(0,h.jsx)(tQ,{accessToken:s,setPassThroughItems:n,passThroughItems:r}),(0,h.jsx)(t5,{data:r,columns:f,renderSubComponent:()=>(0,h.jsx)("div",{}),getRowCanExpand:()=>!1,isLoading:!1,noDataMessage:"No pass-through endpoints configured"}),c&&(0,h.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,h.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,h.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,h.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,h.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,h.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,h.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,h.jsx)("div",{className:"sm:flex sm:items-start",children:(0,h.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,h.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Pass-Through Endpoint"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this pass-through endpoint? This action cannot be undone."})})]})})}),(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)(P.Z,{onClick:g,color:"red",className:"ml-2",children:"Delete"}),(0,h.jsx)(P.Z,{onClick:()=>{d(!1),u(null)},children:"Cancel"})]})]})]})})]})};let{Title:t8,Link:t7}=ef.default,t9={"BadRequestError (400)":"BadRequestErrorRetries","AuthenticationError  (401)":"AuthenticationErrorRetries","TimeoutError (408)":"TimeoutErrorRetries","RateLimitError (429)":"RateLimitErrorRetries","ContentPolicyViolationError (400)":"ContentPolicyViolationErrorRetries","InternalServerError (500)":"InternalServerErrorRetries"};var le=e=>{let{accessToken:s,token:t,userRole:l,userID:a,modelData:r={data:[]},keys:n,setModelData:i,premiumUser:o,teams:d}=e,[m,u]=(0,x.useState)([]),[p]=R.Z.useForm(),[g,j]=(0,x.useState)(null),[f,v]=(0,x.useState)(""),[_,b]=(0,x.useState)([]);Object.values(c).filter(e=>isNaN(Number(e)));let[N,Z]=(0,x.useState)([]),[w,k]=(0,x.useState)(c.OpenAI),[S,C]=(0,x.useState)(null),[A,T]=(0,x.useState)(!1),[E,L]=(0,x.useState)(!1),[D,F]=(0,x.useState)(null),[q,U]=(0,x.useState)([]),[V,K]=(0,x.useState)([]),[B,H]=(0,x.useState)([]),[G,J]=(0,x.useState)(null),[Y,X]=(0,x.useState)([]),[Q,ee]=(0,x.useState)([]),[es,et]=(0,x.useState)([]),[el,ea]=(0,x.useState)([]),[er,en]=(0,x.useState)([]),[ei,ec]=(0,x.useState)([]),[ed,em]=(0,x.useState)([]),[eu,eh]=(0,x.useState)([]),[ex,ep]=(0,x.useState)([]),[eg,ev]=(0,x.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[e_,ey]=(0,x.useState)(null),[eb,eN]=(0,x.useState)(0),[eZ,ew]=(0,x.useState)({}),[ek,eS]=(0,x.useState)([]),[eC,eI]=(0,x.useState)(!1),[eP,eA]=(0,x.useState)(null),[eT,eE]=(0,x.useState)(null),[eL,eO]=(0,x.useState)([]),[eM,eD]=(0,x.useState)([]),[eR,ez]=(0,x.useState)(!1),[eq,eU]=(0,x.useState)(null),[eV,eK]=(0,x.useState)(!1),[eB,eH]=(0,x.useState)(null),[eG,eJ]=(0,x.useState)(null),[eY,eW]=(0,x.useState)(null),[e$,eX]=(0,x.useState)(null),[eQ,e1]=(0,x.useState)("personal"),[e8,e9]=(0,x.useState)("current_team"),[se,ss]=(0,x.useState)(!1),[st,sl]=(0,x.useState)(!1),[sa,sr]=(0,x.useState)(new Set),sn=(0,x.useRef)(null),si=(0,x.useRef)(null),so=async(e,t,r)=>{if(console.log("Updating model metrics for group:",e),!s||!a||!l||!t||!r)return;console.log("inside updateModelMetrics - startTime:",t,"endTime:",r),J(e);let n=null==eP?void 0:eP.token;void 0===n&&(n=null);let i=eT;void 0===i&&(i=null);try{let o=await (0,y.o6)(s,a,l,e,t.toISOString(),r.toISOString(),n,i);console.log("Model metrics response:",o),ee(o.data),et(o.all_api_bases);let c=await (0,y.Rg)(s,e,t.toISOString(),r.toISOString());ea(c.data),en(c.all_api_bases);let d=await (0,y.N8)(s,a,l,e,t.toISOString(),r.toISOString(),n,i);console.log("Model exceptions response:",d),ec(d.data),em(d.exception_types);let m=await (0,y.fP)(s,a,l,e,t.toISOString(),r.toISOString(),n,i);if(console.log("slowResponses:",m),ep(m),e){let l=await (0,y.n$)(s,null==t?void 0:t.toISOString().split("T")[0],null==r?void 0:r.toISOString().split("T")[0],e);ew(l);let a=await (0,y.v9)(s,null==t?void 0:t.toISOString().split("T")[0],null==r?void 0:r.toISOString().split("T")[0],e);eS(a)}}catch(e){console.error("Failed to fetch model metrics",e)}},sc=async e=>{try{let s=await (0,y.N3)(e);console.log("credentials: ".concat(JSON.stringify(s))),eD(s.credentials)}catch(e){console.error("Error fetching credentials:",e)}};(0,x.useEffect)(()=>{so(G,eg.from,eg.to)},[eP,eT,eG]),(0,x.useEffect)(()=>{let e=e=>{sn.current&&!sn.current.contains(e.target)&&sl(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let sd={name:"file",accept:".json",beforeUpload:e=>{if("application/json"===e.type){let s=new FileReader;s.onload=e=>{if(e.target){let s=e.target.result;console.log("Resetting vertex_credentials to JSON; jsonStr: ".concat(s)),p.setFieldsValue({vertex_credentials:s}),console.log("Form values right after setting:",p.getFieldsValue())}},s.readAsText(e)}return!1},onChange(e){console.log("Upload onChange triggered with values:",e),console.log("Current form values:",p.getFieldsValue()),"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?z.ZP.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&z.ZP.error("".concat(e.file.name," file upload failed."))}},sm=()=>{v(new Date().toLocaleString())},su=async()=>{if(!s){console.error("Access token is missing");return}console.log("new modelGroupRetryPolicy:",e_);try{await (0,y.K_)(s,{router_settings:{model_group_retry_policy:e_}}),z.ZP.success("Retry settings saved successfully")}catch(e){console.error("Failed to save retry settings:",e),z.ZP.error("Failed to save retry settings")}};if((0,x.useEffect)(()=>{if(!s||!t||!l||!a)return;let e=async()=>{try{var e,t,r,n,o,c,d,m,u,h,x,p;let g=await (0,y.AZ)(s,a,l);console.log("Model data response:",g.data),i(g);let j=await (0,y.hy)(s);j&&Z(j);let f=new Set;for(let e=0;e<g.data.length;e++){let s=g.data[e];f.add(s.model_name)}console.log("all_model_groups:",f);let v=Array.from(f);v=v.sort(),U(v);let _=new Set;for(let e=0;e<g.data.length;e++){let s=g.data[e].model_info;if(s){let e=s.access_groups;if(e)for(let s=0;s<e.length;s++)_.add(e[s])}}K(Array.from(_)),console.log("array_model_groups:",v);let b="all";v.length>0&&(b=v[v.length-1],console.log("_initial_model_group:",b)),console.log("selectedModelGroup:",G);let N=await (0,y.o6)(s,a,l,b,null===(e=eg.from)||void 0===e?void 0:e.toISOString(),null===(t=eg.to)||void 0===t?void 0:t.toISOString(),null==eP?void 0:eP.token,eT);console.log("Model metrics response:",N),ee(N.data),et(N.all_api_bases);let w=await (0,y.Rg)(s,b,null===(r=eg.from)||void 0===r?void 0:r.toISOString(),null===(n=eg.to)||void 0===n?void 0:n.toISOString());ea(w.data),en(w.all_api_bases);let k=await (0,y.N8)(s,a,l,b,null===(o=eg.from)||void 0===o?void 0:o.toISOString(),null===(c=eg.to)||void 0===c?void 0:c.toISOString(),null==eP?void 0:eP.token,eT);console.log("Model exceptions response:",k),ec(k.data),em(k.exception_types);let S=await (0,y.fP)(s,a,l,b,null===(d=eg.from)||void 0===d?void 0:d.toISOString(),null===(m=eg.to)||void 0===m?void 0:m.toISOString(),null==eP?void 0:eP.token,eT),C=await (0,y.n$)(s,null===(u=eg.from)||void 0===u?void 0:u.toISOString().split("T")[0],null===(h=eg.to)||void 0===h?void 0:h.toISOString().split("T")[0],b);ew(C);let I=await (0,y.v9)(s,null===(x=eg.from)||void 0===x?void 0:x.toISOString().split("T")[0],null===(p=eg.to)||void 0===p?void 0:p.toISOString().split("T")[0],b);eS(I),console.log("dailyExceptions:",C),console.log("dailyExceptionsPerDeplyment:",I),console.log("slowResponses:",S),ep(S);let P=await (0,y.j2)(s);eO(null==P?void 0:P.end_users);let A=(await (0,y.BL)(s,a,l)).router_settings;console.log("routerSettingsInfo:",A);let T=A.model_group_retry_policy,E=A.num_retries;console.log("model_group_retry_policy:",T),console.log("default_retries:",E),ey(T),eN(E)}catch(e){console.error("There was an error fetching the model data",e)}};s&&t&&l&&a&&e();let r=async()=>{let e=await (0,y.qm)(s);console.log("received model cost map data: ".concat(Object.keys(e))),j(e)};null==g&&r(),sm()},[s,t,l,a,g,f,eG]),!r||!s||!t||!l||!a)return(0,h.jsx)("div",{children:"Loading..."});let sx=[],sp=[];for(let e=0;e<r.data.length;e++){var sg,sj,sf;let s=r.data[e],t=null==s?void 0:null===(sg=s.litellm_params)||void 0===sg?void 0:sg.model,l=null==s?void 0:null===(sj=s.litellm_params)||void 0===sj?void 0:sj.custom_llm_provider,a=null==s?void 0:s.model_info,n="",i="Undefined",o="Undefined",c="Undefined",d="Undefined",m={},u=e=>(console.log("GET PROVIDER CALLED! - ".concat(g)),null!=g&&"object"==typeof g&&e in g)?g[e].litellm_provider:"openai";if(t){let e=t.split("/"),s=e[0];(n=l)||(n=1===e.length?u(t):s)}else n="-";a&&(i=null==a?void 0:a.input_cost_per_token,o=null==a?void 0:a.output_cost_per_token,c=null==a?void 0:a.max_tokens,d=null==a?void 0:a.max_input_tokens),(null==s?void 0:s.litellm_params)&&(m=Object.fromEntries(Object.entries(null==s?void 0:s.litellm_params).filter(e=>{let[s]=e;return"model"!==s&&"api_base"!==s}))),r.data[e].provider=n,r.data[e].input_cost=i,r.data[e].output_cost=o,r.data[e].litellm_model_name=t,sp.push(n),r.data[e].input_cost&&(r.data[e].input_cost=(1e6*Number(r.data[e].input_cost)).toFixed(2)),r.data[e].output_cost&&(r.data[e].output_cost=(1e6*Number(r.data[e].output_cost)).toFixed(2)),r.data[e].max_tokens=c,r.data[e].max_input_tokens=d,r.data[e].api_base=null==s?void 0:null===(sf=s.litellm_params)||void 0===sf?void 0:sf.api_base,r.data[e].cleanedLitellmParams=m,sx.push(s.model_name),console.log(r.data[e])}if(l&&"Admin Viewer"==l){let{Title:e,Paragraph:s}=ef.default;return(0,h.jsxs)("div",{children:[(0,h.jsx)(e,{level:1,children:"Access Denied"}),(0,h.jsx)(s,{children:"Ask your proxy admin for access to view all models"})]})}let sv=(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"mb-1",children:"Select API Key Name"}),o?(0,h.jsxs)("div",{children:[(0,h.jsxs)(e0.Z,{defaultValue:"all-keys",children:[(0,h.jsx)(ej.Z,{value:"all-keys",onClick:()=>{eA(null)},children:"All Keys"},"all-keys"),null==n?void 0:n.map((e,s)=>e&&null!==e.key_alias&&e.key_alias.length>0?(0,h.jsx)(ej.Z,{value:String(s),onClick:()=>{eA(e)},children:e.key_alias},s):null)]}),(0,h.jsx)(O.Z,{className:"mt-1",children:"Select Customer Name"}),(0,h.jsxs)(e0.Z,{defaultValue:"all-customers",children:[(0,h.jsx)(ej.Z,{value:"all-customers",onClick:()=>{eE(null)},children:"All Customers"},"all-customers"),null==eL?void 0:eL.map((e,s)=>(0,h.jsx)(ej.Z,{value:e,onClick:()=>{eE(e)},children:e},s))]}),(0,h.jsx)(O.Z,{className:"mt-1",children:"Select Team"}),(0,h.jsxs)(e0.Z,{className:"w-64 relative z-50",defaultValue:"all",value:null!=eY?eY:"all",onValueChange:e=>eW("all"===e?null:e),children:[(0,h.jsx)(ej.Z,{value:"all",children:"All Teams"}),null==d?void 0:d.filter(e=>e.team_id).map(e=>(0,h.jsx)(ej.Z,{value:e.team_id,children:e.team_alias?"".concat(e.team_alias," (").concat(e.team_id.slice(0,8),"...)"):"Team ".concat(e.team_id.slice(0,8),"...")},e.team_id))]})]}):(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"mt-1",children:"Select Team"}),(0,h.jsxs)(e0.Z,{className:"w-64 relative z-50",defaultValue:"all",value:null!=eY?eY:"all",onValueChange:e=>eW("all"===e?null:e),children:[(0,h.jsx)(ej.Z,{value:"all",children:"All Teams"}),null==d?void 0:d.filter(e=>e.team_id).map(e=>(0,h.jsx)(ej.Z,{value:e.team_id,children:e.team_alias?"".concat(e.team_alias," (").concat(e.team_id.slice(0,8),"...)"):"Team ".concat(e.team_id.slice(0,8),"...")},e.team_id))]})]})]}),s_=e=>{var s,t;let{payload:l,active:a}=e;if(!a||!l)return null;let r=null===(t=l[0])||void 0===t?void 0:null===(s=t.payload)||void 0===s?void 0:s.date,n=l.sort((e,s)=>s.value-e.value);if(n.length>5){let e=n.length-5;(n=n.slice(0,5)).push({dataKey:"".concat(e," other deployments"),value:l.slice(5).reduce((e,s)=>e+s.value,0),color:"gray"})}return(0,h.jsxs)("div",{className:"w-150 rounded-tremor-default border border-tremor-border bg-tremor-background p-2 text-tremor-default shadow-tremor-dropdown",children:[r&&(0,h.jsxs)("p",{className:"text-tremor-content-emphasis mb-2",children:["Date: ",r]}),n.map((e,s)=>{let t=parseFloat(e.value.toFixed(5)),l=0===t&&e.value>0?"<0.00001":t.toFixed(5);return(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("div",{className:"w-2 h-2 mt-1 rounded-full bg-".concat(e.color,"-500")}),(0,h.jsx)("p",{className:"text-tremor-content",children:e.dataKey})]}),(0,h.jsx)("p",{className:"font-medium text-tremor-content-emphasis text-righ ml-2",children:l})]},s)})]})};console.log("selectedProvider: ".concat(w)),console.log("providerModels.length: ".concat(_.length));let sy=Object.keys(c).find(e=>c[e]===w);return(sy&&N&&N.find(e=>e.name===sF[sy]),eB)?(0,h.jsx)("div",{className:"w-full h-full",children:(0,h.jsx)(tm,{teamId:eB,onClose:()=>eH(null),accessToken:s,is_team_admin:"Admin"===l,is_proxy_admin:"Proxy Admin"===l,userModels:sx,editTeam:!1,onUpdate:sm})}):(0,h.jsx)("div",{style:{width:"100%",height:"100%"},children:eq?(0,h.jsx)(ty,{modelId:eq,editModel:!0,onClose:()=>{eU(null),eK(!1)},modelData:r.data.find(e=>e.model_info.id===eq),accessToken:s,userID:a,userRole:l,setEditModalVisible:L,setSelectedModel:F,onModelUpdate:e=>{i({...r,data:r.data.map(s=>s.model_info.id===e.model_info.id?e:s)}),sm()},modelAccessGroups:V}):(0,h.jsxs)(e4.Z,{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,h.jsxs)(e5.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,h.jsxs)("div",{className:"flex",children:[eF.includes(l)?(0,h.jsx)(e2.Z,{children:"All Models"}):(0,h.jsx)(e2.Z,{children:"Your Models"}),(0,h.jsx)(e2.Z,{children:"Add Model"}),eF.includes(l)&&(0,h.jsx)(e2.Z,{children:"LLM Credentials"}),eF.includes(l)&&(0,h.jsx)(e2.Z,{children:"Pass-Through Endpoints"}),eF.includes(l)&&(0,h.jsx)(e2.Z,{children:"Health Status"}),eF.includes(l)&&(0,h.jsx)(e2.Z,{children:"Model Analytics"}),eF.includes(l)&&(0,h.jsx)(e2.Z,{children:"Model Retry Settings"})]}),(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[f&&(0,h.jsxs)(O.Z,{children:["Last Refreshed: ",f]}),(0,h.jsx)(sb.Z,{icon:e7.Z,variant:"shadow",size:"xs",className:"self-center",onClick:sm})]})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsx)(I.Z,{children:(0,h.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,h.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,h.jsxs)("div",{children:[(0,h.jsx)(M.Z,{children:"Model Management"}),eF.includes(l)?(0,h.jsx)(O.Z,{className:"text-tremor-content",children:"Add and manage models for the proxy"}):(0,h.jsx)(O.Z,{className:"text-tremor-content",children:"Add models for teams you are an admin for."})]})}),(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,h.jsx)("div",{className:"border-b px-6 py-4",children:(0,h.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-4 border-2 border-gray-200",children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center gap-4",children:[(0,h.jsx)(O.Z,{className:"text-lg font-semibold text-gray-900",children:"Current Team:"}),(0,h.jsxs)(e0.Z,{className:"w-80",defaultValue:"personal",value:eQ,onValueChange:e=>e1(e),children:[(0,h.jsx)(ej.Z,{value:"personal",children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,h.jsx)("span",{className:"font-medium",children:"Personal"})]})}),null==d?void 0:d.filter(e=>e.team_id).map(e=>(0,h.jsx)(ej.Z,{value:e.team_id,children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,h.jsx)("span",{className:"font-medium",children:e.team_alias?"".concat(e.team_alias.slice(0,30),"..."):"Team ".concat(e.team_id.slice(0,30),"...")})]})},e.team_id))]})]}),"current_team"===e8&&(0,h.jsxs)("div",{className:"flex items-start gap-2 mt-2 bg-gray-50 rounded",children:[(0,h.jsx)($.Z,{className:"text-gray-400 mt-0.5 flex-shrink-0 text-xs"}),(0,h.jsx)("div",{className:"text-xs text-gray-500",children:"personal"===eQ?(0,h.jsxs)("span",{children:["To access these models: Create a Virtual Key without selecting a team on the "," ",(0,h.jsx)("a",{href:"/?login=success&page=api-keys",className:"text-gray-600 hover:text-gray-800 underline",children:"Virtual Keys page"})]}):(0,h.jsxs)("span",{children:['To access these models: Create a Virtual Key and select Team as "',eQ,'" on the '," ",(0,h.jsx)("a",{href:"/?login=success&page=api-keys",className:"text-gray-600 hover:text-gray-800 underline",children:"Virtual Keys page"})]})})]})]}),(0,h.jsxs)("div",{className:"flex items-center gap-4",children:[(0,h.jsx)(O.Z,{className:"text-lg font-semibold text-gray-900",children:"View:"}),(0,h.jsxs)(e0.Z,{className:"w-64",defaultValue:"current_team",value:e8,onValueChange:e=>e9(e),children:[(0,h.jsx)(ej.Z,{value:"current_team",children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),(0,h.jsx)("span",{className:"font-medium",children:"Current Team Models"})]})}),(0,h.jsx)(ej.Z,{value:"all",children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full"}),(0,h.jsx)("span",{className:"font-medium",children:"All Available Models"})]})})]})]})]}),(0,h.jsx)("div",{className:"flex items-center justify-between",children:(0,h.jsxs)("div",{className:"flex items-center gap-3",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)(O.Z,{children:"Filter by Public Model Name:"}),(0,h.jsxs)(e0.Z,{className:"w-64",defaultValue:null!=G?G:"all",onValueChange:e=>J("all"===e?"all":e),value:null!=G?G:"all",children:[(0,h.jsx)(ej.Z,{value:"all",children:"All Models"}),q.map((e,s)=>(0,h.jsx)(ej.Z,{value:e,children:e},s))]})]}),(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)(O.Z,{children:"Filter by Model Access Group:"}),(0,h.jsxs)(e0.Z,{className:"w-64",defaultValue:"all",value:null!=e$?e$:"all",onValueChange:e=>eX("all"===e?null:e),children:[(0,h.jsx)(ej.Z,{value:"all",children:"All Model Access Groups"}),V.map((e,s)=>(0,h.jsx)(ej.Z,{value:e,children:e},s))]})]})]})}),(0,h.jsx)("div",{className:"flex justify-between items-center",children:(0,h.jsxs)(O.Z,{className:"text-sm text-gray-700",children:["Showing ",r&&r.data.length>0?r.data.filter(e=>{var s,t,l,a;let r="all"===G||e.model_name===G||!G,n="all"===e$||(null===(s=e.model_info.access_groups)||void 0===s?void 0:s.includes(e$))||!e$,i=!0;return"current_team"===e8&&(i="personal"===eQ?(null===(t=e.model_info)||void 0===t?void 0:t.direct_access)===!0:(null===(a=e.model_info)||void 0===a?void 0:null===(l=a.access_via_team_ids)||void 0===l?void 0:l.includes(eQ))===!0),r&&n&&i}).length:0," results"]})})]})}),(0,h.jsx)(tF,{columns:tR(l,a,o,eU,eH,s2,e=>{F(e),L(!0)},sm,eK,sa,sr),data:r.data.filter(e=>{var s,t,l,a;let r="all"===G||e.model_name===G||!G,n="all"===e$||(null===(s=e.model_info.access_groups)||void 0===s?void 0:s.includes(e$))||!e$,i=!0;return"current_team"===e8&&(i="personal"===eQ?(null===(t=e.model_info)||void 0===t?void 0:t.direct_access)===!0:(null===(a=e.model_info)||void 0===a?void 0:null===(l=a.access_via_team_ids)||void 0===l?void 0:l.includes(eQ))===!0),r&&n&&i}),isLoading:!1,table:si})]})]})})}),(0,h.jsx)(e6.Z,{className:"h-full",children:(0,h.jsx)(tD,{form:p,handleOk:()=>{p.validateFields().then(e=>{sB(e,s,p,sm)}).catch(e=>{console.error("Validation failed:",e)})},selectedProvider:w,setSelectedProvider:k,providerModels:_,setProviderModelsFn:e=>{let s=sV(e,g);b(s),console.log("providerModels: ".concat(s))},getPlaceholder:sU,uploadProps:sd,showAdvancedSettings:eR,setShowAdvancedSettings:ez,teams:d,credentials:eM,accessToken:s,userRole:l})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(s1,{accessToken:s,uploadProps:sd,credentialList:eM,fetchCredentials:sc})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(t3,{accessToken:s,userRole:l,userID:a,modelData:r})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(tK,{accessToken:s,modelData:r,all_models_on_proxy:sx,getDisplayModelName:s2,setSelectedModelId:eU})}),(0,h.jsxs)(e6.Z,{children:[(0,h.jsxs)(I.Z,{numItems:4,className:"mt-2 mb-2",children:[(0,h.jsx)(sJ.Z,{children:(0,h.jsx)(s5,{value:eg,className:"mr-2",onValueChange:e=>{ev(e),so(G,e.from,e.to)}})}),(0,h.jsxs)(sJ.Z,{className:"ml-2",children:[(0,h.jsx)(O.Z,{children:"Select Model Group"}),(0,h.jsx)(e0.Z,{defaultValue:G||q[0],value:G||q[0],children:q.map((e,s)=>(0,h.jsx)(ej.Z,{value:e,onClick:()=>so(e,eg.from,eg.to),children:e},s))})]}),(0,h.jsx)(sJ.Z,{children:(0,h.jsx)(s8.Z,{trigger:"click",content:sv,overlayStyle:{width:"20vw"},children:(0,h.jsx)(P.Z,{icon:sh.Z,size:"md",variant:"secondary",className:"mt-4 ml-2",style:{border:"none"},onClick:()=>eI(!0)})})})]}),(0,h.jsxs)(I.Z,{numItems:2,children:[(0,h.jsx)(sJ.Z,{children:(0,h.jsx)(eo.Z,{className:"mr-2 max-h-[400px] min-h-[400px]",children:(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{variant:"line",defaultValue:"1",children:[(0,h.jsx)(e2.Z,{value:"1",children:"Avg. Latency per Token"}),(0,h.jsx)(e2.Z,{value:"2",children:"Time to first token"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsxs)(e6.Z,{children:[(0,h.jsx)("p",{className:"text-gray-500 italic",children:" (seconds/token)"}),(0,h.jsx)(O.Z,{className:"text-gray-500 italic mt-1 mb-1",children:"average Latency for successfull requests divided by the total tokens"}),Q&&es&&(0,h.jsx)(s6.Z,{title:"Model Latency",className:"h-72",data:Q,showLegend:!1,index:"date",categories:es,connectNulls:!0,customTooltip:s_})]}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(s9,{modelMetrics:el,modelMetricsCategories:er,customTooltip:s_,premiumUser:o})})]})]})})}),(0,h.jsx)(sJ.Z,{children:(0,h.jsx)(eo.Z,{className:"ml-2 max-h-[400px] min-h-[400px]  overflow-y-auto",children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Deployment"}),(0,h.jsx)(sS.Z,{children:"Success Responses"}),(0,h.jsxs)(sS.Z,{children:["Slow Responses ",(0,h.jsx)("p",{children:"Success Responses taking 600+s"})]})]})}),(0,h.jsx)(sZ.Z,{children:ex.map((e,s)=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:e.api_base}),(0,h.jsx)(sw.Z,{children:e.total_count}),(0,h.jsx)(sw.Z,{children:e.slow_count})]},s))})]})})})]}),(0,h.jsx)(I.Z,{numItems:1,className:"gap-2 w-full mt-2",children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)(M.Z,{children:["All Exceptions for ",G]}),(0,h.jsx)(s3.Z,{className:"h-60",data:ei,index:"model",categories:ed,stack:!0,yAxisWidth:30})]})}),(0,h.jsxs)(I.Z,{numItems:1,className:"gap-2 w-full mt-2",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)(M.Z,{children:["All Up Rate Limit Errors (429) for ",G]}),(0,h.jsxs)(I.Z,{numItems:1,children:[(0,h.jsxs)(sJ.Z,{children:[(0,h.jsxs)(sD.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Num Rate Limit Errors ",eZ.sum_num_rate_limit_exceptions]}),(0,h.jsx)(s3.Z,{className:"h-40",data:eZ.daily_data,index:"date",colors:["rose"],categories:["num_rate_limit_exceptions"],onValueChange:e=>console.log(e)})]}),(0,h.jsx)(sJ.Z,{})]})]}),o?(0,h.jsx)(h.Fragment,{children:ek.map((e,s)=>(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:e.api_base?e.api_base:"Unknown API Base"}),(0,h.jsx)(I.Z,{numItems:1,children:(0,h.jsxs)(sJ.Z,{children:[(0,h.jsxs)(sD.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Num Rate Limit Errors (429) ",e.sum_num_rate_limit_exceptions]}),(0,h.jsx)(s3.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["rose"],categories:["num_rate_limit_exceptions"],onValueChange:e=>console.log(e)})]})})]},s))}):(0,h.jsx)(h.Fragment,{children:ek&&ek.length>0&&ek.slice(0,1).map((e,s)=>(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"✨ Rate Limit Errors by Deployment"}),(0,h.jsx)("p",{className:"mb-2 text-gray-500 italic text-[12px]",children:"Upgrade to see exceptions for all deployments"}),(0,h.jsx)(P.Z,{variant:"primary",className:"mb-2",children:(0,h.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"Get Free Trial"})}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:e.api_base}),(0,h.jsx)(I.Z,{numItems:1,children:(0,h.jsxs)(sJ.Z,{children:[(0,h.jsxs)(sD.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Num Rate Limit Errors ",e.sum_num_rate_limit_exceptions]}),(0,h.jsx)(s3.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["rose"],categories:["num_rate_limit_exceptions"],onValueChange:e=>console.log(e)})]})})]})]},s))})]})]}),(0,h.jsxs)(e6.Z,{children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(O.Z,{children:"Filter by Public Model Name"}),(0,h.jsx)(e0.Z,{className:"mb-4 mt-2 ml-2 w-50",defaultValue:G||q[0],value:G||q[0],onValueChange:e=>J(e),children:q.map((e,s)=>(0,h.jsx)(ej.Z,{value:e,onClick:()=>J(e),children:e},s))})]}),(0,h.jsxs)(M.Z,{children:["Retry Policy for ",G]}),(0,h.jsx)(O.Z,{className:"mb-6",children:"How many retries should be attempted based on the Exception"}),t9&&(0,h.jsx)("table",{children:(0,h.jsx)("tbody",{children:Object.entries(t9).map((e,s)=>{var t;let[l,a]=e,r=null==e_?void 0:null===(t=e_[G])||void 0===t?void 0:t[a];return null==r&&(r=eb),(0,h.jsxs)("tr",{className:"flex justify-between items-center mt-2",children:[(0,h.jsx)("td",{children:(0,h.jsx)(O.Z,{children:l})}),(0,h.jsx)("td",{children:(0,h.jsx)(W.Z,{className:"ml-5",value:r,min:0,step:1,onChange:e=>{ey(s=>{var t;let l=null!==(t=null==s?void 0:s[G])&&void 0!==t?t:{};return{...null!=s?s:{},[G]:{...l,[a]:e}}})}})})]},s)})})}),(0,h.jsx)(P.Z,{className:"mt-6 mr-8",onClick:su,children:"Save"})]})]})]})})},ls=e=>{let{visible:s,possibleUIRoles:t,onCancel:l,user:a,onSubmit:r}=e,[n,i]=(0,x.useState)(a),[o]=R.Z.useForm();(0,x.useEffect)(()=>{o.resetFields()},[a]);let c=async()=>{o.resetFields(),l()},d=async e=>{r(e),o.resetFields(),l()};return a?(0,h.jsx)(q.Z,{visible:s,onCancel:c,footer:null,title:"Edit User "+a.user_id,width:1e3,children:(0,h.jsx)(R.Z,{form:o,onFinish:d,initialValues:a,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{className:"mt-8",label:"User Email",tooltip:"Email of the User",name:"user_email",children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"user_id",name:"user_id",hidden:!0,children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"User Role",name:"user_role",children:(0,h.jsx)(F.default,{children:t&&Object.entries(t).map(e=>{let[s,{ui_label:t,description:l}]=e;return(0,h.jsx)(ej.Z,{value:s,title:t,children:(0,h.jsxs)("div",{className:"flex",children:[t," ",(0,h.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:l})]})},s)})})}),(0,h.jsx)(R.Z.Item,{label:"Spend (USD)",name:"spend",tooltip:"(float) - Spend of all LLM calls completed by this user",help:"Across all keys (including keys with team_id).",children:(0,h.jsx)(W.Z,{min:0,step:.01})}),(0,h.jsx)(R.Z.Item,{label:"User Budget (USD)",name:"max_budget",tooltip:"(float) - Maximum budget of this user",help:"Maximum budget of this user.",children:(0,h.jsx)(H,{min:0,step:.01})}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Save"})})]})})}):null};let lt=(e,s,t,l,a)=>[{header:"User ID",accessorKey:"user_id",cell:e=>{let{row:s}=e;return(0,h.jsx)(X.Z,{title:s.original.user_id,children:(0,h.jsx)("span",{className:"text-xs",children:s.original.user_id?"".concat(s.original.user_id.slice(0,7),"..."):"-"})})}},{header:"User Email",accessorKey:"user_email",cell:e=>{let{row:s}=e;return(0,h.jsx)("span",{className:"text-xs",children:s.original.user_email||"-"})}},{header:"Global Proxy Role",accessorKey:"user_role",cell:s=>{var t;let{row:l}=s;return(0,h.jsx)("span",{className:"text-xs",children:(null==e?void 0:null===(t=e[l.original.user_role])||void 0===t?void 0:t.ui_label)||"-"})}},{header:"User Spend ($ USD)",accessorKey:"spend",cell:e=>{let{row:s}=e;return(0,h.jsx)("span",{className:"text-xs",children:s.original.spend?eH(s.original.spend,4):"-"})}},{header:"User Max Budget ($ USD)",accessorKey:"max_budget",cell:e=>{let{row:s}=e;return(0,h.jsx)("span",{className:"text-xs",children:null!==s.original.max_budget?s.original.max_budget:"Unlimited"})}},{header:()=>(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("span",{children:"SSO ID"}),(0,h.jsx)(X.Z,{title:"SSO ID is the ID of the user in the SSO provider. If the user is not using SSO, this will be null.",children:(0,h.jsx)(tz.Z,{className:"w-4 h-4"})})]}),accessorKey:"sso_user_id",cell:e=>{let{row:s}=e;return(0,h.jsx)("span",{className:"text-xs",children:null!==s.original.sso_user_id?s.original.sso_user_id:"-"})}},{header:"API Keys",accessorKey:"key_count",cell:e=>{let{row:s}=e;return(0,h.jsx)(I.Z,{numItems:2,children:s.original.key_count>0?(0,h.jsxs)(e1.Z,{size:"xs",color:"indigo",children:[s.original.key_count," Keys"]}):(0,h.jsx)(e1.Z,{size:"xs",color:"gray",children:"No Keys"})})}},{header:"Created At",accessorKey:"created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e;return(0,h.jsx)("span",{className:"text-xs",children:s.original.created_at?new Date(s.original.created_at).toLocaleDateString():"-"})}},{header:"Updated At",accessorKey:"updated_at",sortingFn:"datetime",cell:e=>{let{row:s}=e;return(0,h.jsx)("span",{className:"text-xs",children:s.original.updated_at?new Date(s.original.updated_at).toLocaleDateString():"-"})}},{id:"actions",header:"",cell:e=>{let{row:s}=e;return(0,h.jsxs)("div",{className:"flex gap-2",children:[(0,h.jsx)(X.Z,{title:"Edit user details",zIndex:9999,children:(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>a(s.original.user_id,!0)})}),(0,h.jsx)(X.Z,{title:"Delete user",zIndex:9999,children:(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>t(s.original.user_id)})}),(0,h.jsx)(X.Z,{title:"Reset Password",zIndex:9999,children:(0,h.jsx)(sb.Z,{icon:e7.Z,size:"sm",onClick:()=>l(s.original.user_id)})})]})}}];var ll=t(16853);function la(e){let{userData:s,onCancel:t,onSubmit:l,teams:a,accessToken:r,userID:n,userRole:i,userModels:o,possibleUIRoles:c}=e,[d]=R.Z.useForm();return x.useEffect(()=>{var e,t,l,a,r;d.setFieldsValue({user_id:s.user_id,user_email:null===(e=s.user_info)||void 0===e?void 0:e.user_email,user_role:null===(t=s.user_info)||void 0===t?void 0:t.user_role,models:(null===(l=s.user_info)||void 0===l?void 0:l.models)||[],max_budget:null===(a=s.user_info)||void 0===a?void 0:a.max_budget,metadata:(null===(r=s.user_info)||void 0===r?void 0:r.metadata)?JSON.stringify(s.user_info.metadata,null,2):void 0})},[s,d]),(0,h.jsxs)(R.Z,{form:d,onFinish:e=>{if(e.metadata&&"string"==typeof e.metadata)try{e.metadata=JSON.parse(e.metadata)}catch(e){console.error("Error parsing metadata JSON:",e);return}l(e)},layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{label:"User ID",name:"user_id",children:(0,h.jsx)(A.Z,{disabled:!0})}),(0,h.jsx)(R.Z.Item,{label:"Email",name:"user_email",children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Global Proxy Role"," ",(0,h.jsx)(X.Z,{title:"This is the role that the user will globally on the proxy. This role is independent of any team/org specific roles.",children:(0,h.jsx)($.Z,{})})]}),name:"user_role",children:(0,h.jsx)(F.default,{children:c&&Object.entries(c).map(e=>{let[s,{ui_label:t,description:l}]=e;return(0,h.jsx)(ej.Z,{value:s,title:t,children:(0,h.jsxs)("div",{className:"flex",children:[t," ",(0,h.jsx)("p",{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:l})]})},s)})})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Personal Models"," ",(0,h.jsx)(X.Z,{title:"Select which models this user can access outside of team-scope. Choose 'All Proxy Models' to grant access to all models available on the proxy.",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"models",children:(0,h.jsxs)(F.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},disabled:!eF.includes(i||""),children:[(0,h.jsx)(F.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),o.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:J(e)},e))]})}),(0,h.jsx)(R.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,h.jsx)(W.Z,{step:.01,precision:2,style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{label:"Metadata",name:"metadata",children:(0,h.jsx)(ll.Z,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,h.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,h.jsx)(P.Z,{variant:"secondary",onClick:t,children:"Cancel"}),(0,h.jsx)(P.Z,{type:"submit",children:"Save Changes"})]})]})}function lr(e){var s,t,l,a,r,n,i,o,c,d,m,u,p,g,j,f,v,_,b,N,Z,w,k,S,C,A,T;let{userId:E,onClose:L,accessToken:D,userRole:F,onDelete:R,possibleUIRoles:q,initialTab:U=0,startInEditMode:V=!1}=e,[K,B]=(0,x.useState)(null),[H,G]=(0,x.useState)(!1),[J,Y]=(0,x.useState)(!0),[W,$]=(0,x.useState)(V),[X,Q]=(0,x.useState)([]),[ee,es]=(0,x.useState)(!1),[et,el]=(0,x.useState)(null),[ea,er]=(0,x.useState)(null),[en,ei]=(0,x.useState)(U);x.useEffect(()=>{er((0,y.zX)())},[]),x.useEffect(()=>{console.log("userId: ".concat(E,", userRole: ").concat(F,", accessToken: ").concat(D)),(async()=>{try{if(!D)return;let e=await (0,y.Br)(D,E,F||"",!1,null,null,!0);B(e);let s=(await (0,y.So)(D,E,F||"")).data.map(e=>e.id);Q(s)}catch(e){console.error("Error fetching user data:",e),z.ZP.error("Failed to fetch user data")}finally{Y(!1)}})()},[D,E,F]);let ec=async()=>{if(!D){z.ZP.error("Access token not found");return}try{z.ZP.success("Generating password reset link...");let e=await (0,y.XO)(D,E);el(e),es(!0)}catch(e){z.ZP.error("Failed to generate password reset link")}},ed=async()=>{try{if(!D)return;await (0,y.Eb)(D,[E]),z.ZP.success("User deleted successfully"),R&&R(),L()}catch(e){console.error("Error deleting user:",e),z.ZP.error("Failed to delete user")}},eu=async e=>{try{if(!D||!K)return;await (0,y.pf)(D,e,null),B({...K,user_info:{...K.user_info,user_email:e.user_email,models:e.models,max_budget:e.max_budget,metadata:e.metadata}}),z.ZP.success("User updated successfully"),$(!1)}catch(e){console.error("Error updating user:",e),z.ZP.error("Failed to update user")}};return J?(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsx)(P.Z,{icon:e8.Z,variant:"light",onClick:L,className:"mb-4",children:"Back to Users"}),(0,h.jsx)(O.Z,{children:"Loading user data..."})]}):K?(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(P.Z,{icon:e8.Z,variant:"light",onClick:L,className:"mb-4",children:"Back to Users"}),(0,h.jsx)(M.Z,{children:(null===(s=K.user_info)||void 0===s?void 0:s.user_email)||"User"}),(0,h.jsx)(O.Z,{className:"text-gray-500 font-mono",children:K.user_id})]}),F&&ez.includes(F)&&(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)(P.Z,{icon:e7.Z,variant:"secondary",onClick:ec,className:"flex items-center",children:"Reset Password"}),(0,h.jsx)(P.Z,{icon:em.Z,variant:"secondary",onClick:()=>G(!0),className:"flex items-center",children:"Delete User"})]})]}),H&&(0,h.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,h.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,h.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,h.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,h.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,h.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,h.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,h.jsx)("div",{className:"sm:flex sm:items-start",children:(0,h.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,h.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete User"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this user?"})})]})})}),(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)(P.Z,{onClick:ed,color:"red",className:"ml-2",children:"Delete"}),(0,h.jsx)(P.Z,{onClick:()=>G(!1),children:"Cancel"})]})]})]})}),(0,h.jsxs)(e4.Z,{defaultIndex:en,onIndexChange:ei,children:[(0,h.jsxs)(e5.Z,{className:"mb-4",children:[(0,h.jsx)(e2.Z,{children:"Overview"}),(0,h.jsx)(e2.Z,{children:"Details"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Spend"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsxs)(M.Z,{children:["$",eH((null===(t=K.user_info)||void 0===t?void 0:t.spend)||0,4)]}),(0,h.jsxs)(O.Z,{children:["of ",(null===(l=K.user_info)||void 0===l?void 0:l.max_budget)!==null?"$".concat(eH(K.user_info.max_budget,4)):"Unlimited"]})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Teams"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsxs)(O.Z,{children:[(null===(a=K.teams)||void 0===a?void 0:a.length)||0," teams"]})})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"API Keys"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsxs)(O.Z,{children:[(null===(r=K.keys)||void 0===r?void 0:r.length)||0," keys"]})})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Personal Models"}),(0,h.jsx)("div",{className:"mt-2",children:(null===(i=K.user_info)||void 0===i?void 0:null===(n=i.models)||void 0===n?void 0:n.length)&&(null===(c=K.user_info)||void 0===c?void 0:null===(o=c.models)||void 0===o?void 0:o.length)>0?null===(m=K.user_info)||void 0===m?void 0:null===(d=m.models)||void 0===d?void 0:d.map((e,s)=>(0,h.jsx)(O.Z,{children:e},s)):(0,h.jsx)(O.Z,{children:"All proxy models"})})]})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(M.Z,{children:"User Settings"}),!W&&F&&ez.includes(F)&&(0,h.jsx)(P.Z,{variant:"light",onClick:()=>$(!0),children:"Edit Settings"})]}),W&&K?(0,h.jsx)(la,{userData:K,onCancel:()=>$(!1),onSubmit:eu,teams:K.teams,accessToken:D,userID:E,userRole:F,userModels:X,possibleUIRoles:q}):(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"User ID"}),(0,h.jsx)(O.Z,{className:"font-mono",children:K.user_id})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Email"}),(0,h.jsx)(O.Z,{children:(null===(u=K.user_info)||void 0===u?void 0:u.user_email)||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Role"}),(0,h.jsx)(O.Z,{children:(null===(p=K.user_info)||void 0===p?void 0:p.user_role)||"Not Set"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Created"}),(0,h.jsx)(O.Z,{children:(null===(g=K.user_info)||void 0===g?void 0:g.created_at)?new Date(K.user_info.created_at).toLocaleString():"Unknown"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Last Updated"}),(0,h.jsx)(O.Z,{children:(null===(j=K.user_info)||void 0===j?void 0:j.updated_at)?new Date(K.user_info.updated_at).toLocaleString():"Unknown"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Teams"}),(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:(null===(f=K.teams)||void 0===f?void 0:f.length)&&(null===(v=K.teams)||void 0===v?void 0:v.length)>0?null===(_=K.teams)||void 0===_?void 0:_.map((e,s)=>(0,h.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:e.team_alias||e.team_id},s)):(0,h.jsx)(O.Z,{children:"No teams"})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Models"}),(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:(null===(N=K.user_info)||void 0===N?void 0:null===(b=N.models)||void 0===b?void 0:b.length)&&(null===(w=K.user_info)||void 0===w?void 0:null===(Z=w.models)||void 0===Z?void 0:Z.length)>0?null===(S=K.user_info)||void 0===S?void 0:null===(k=S.models)||void 0===k?void 0:k.map((e,s)=>(0,h.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:e},s)):(0,h.jsx)(O.Z,{children:"All proxy models"})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"API Keys"}),(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:(null===(C=K.keys)||void 0===C?void 0:C.length)&&(null===(A=K.keys)||void 0===A?void 0:A.length)>0?K.keys.map((e,s)=>(0,h.jsx)("span",{className:"px-2 py-1 bg-green-100 rounded text-xs",children:e.key_alias||e.token},s)):(0,h.jsx)(O.Z,{children:"No API keys"})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Metadata"}),(0,h.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:JSON.stringify((null===(T=K.user_info)||void 0===T?void 0:T.metadata)||{},null,2)})]})]})]})})]})]}),(0,h.jsx)(ev,{isInvitationLinkModalVisible:ee,setIsInvitationLinkModalVisible:es,baseUrl:ea||"",invitationLinkData:et,modalType:"resetPassword"})]}):(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsx)(P.Z,{icon:e8.Z,variant:"light",onClick:L,className:"mb-4",children:"Back to Users"}),(0,h.jsx)(O.Z,{children:"User not found"})]})}function ln(e){let{data:s=[],columns:t,isLoading:l=!1,onSortChange:a,currentSort:r,accessToken:n,userRole:i,possibleUIRoles:o,handleEdit:c,handleDelete:d,handleResetPassword:m}=e,[u,p]=x.useState([{id:(null==r?void 0:r.sortBy)||"created_at",desc:(null==r?void 0:r.sortOrder)==="desc"}]),[g,j]=x.useState(null),[f,v]=x.useState(!1),_=function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];j(e),v(s)},y=x.useMemo(()=>o?lt(o,c,d,m,_):t,[o,c,d,m,_,t]),b=(0,s_.b7)({data:s,columns:y,state:{sorting:u},onSortingChange:e=>{if(p(e),e.length>0){let s=e[0],t=s.id,l=s.desc?"desc":"asc";null==a||a(t,l)}},getCoreRowModel:(0,sy.sC)(),getSortedRowModel:(0,sy.tj)(),enableSorting:!0});return(x.useEffect(()=>{r&&p([{id:r.sortBy,desc:"desc"===r.sortOrder}])},[r]),g)?(0,h.jsx)(lr,{userId:g,onClose:()=>{j(null),v(!1)},accessToken:n,userRole:i,possibleUIRoles:o,initialTab:f?1:0,startInEditMode:f}):(0,h.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsxs)(sN.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,h.jsx)(sk.Z,{children:b.getHeaderGroups().map(e=>(0,h.jsx)(sC.Z,{children:e.headers.map(e=>(0,h.jsx)(sS.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,h.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,h.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,s_.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,h.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,h.jsx)(sA.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,h.jsx)(sI.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,h.jsx)(sT.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,h.jsx)(sZ.Z,{children:l?(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:y.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:"\uD83D\uDE85 Loading users..."})})})}):s.length>0?b.getRowModel().rows.map(e=>(0,h.jsx)(sC.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,h.jsx)(sw.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:()=>{"user_id"===e.column.id&&_(e.getValue(),!1)},style:{cursor:"user_id"===e.column.id?"pointer":"default",color:"user_id"===e.column.id?"#3b82f6":"inherit"},children:(0,s_.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:y.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:"No users found"})})})})})]})})})}var li=t(67982),lo=t(87908),lc=e=>{var s;let{accessToken:t,possibleUIRoles:l,userID:a,userRole:r}=e,[n,i]=(0,x.useState)(!0),[o,c]=(0,x.useState)(null),[d,m]=(0,x.useState)(!1),[u,p]=(0,x.useState)({}),[g,j]=(0,x.useState)(!1),[f,v]=(0,x.useState)([]),{Paragraph:_}=ef.default,{Option:b}=F.default;(0,x.useEffect)(()=>{(async()=>{if(!t){i(!1);return}try{let e=await (0,y.NL)(t);if(c(e),p(e.values||{}),t)try{let e=await (0,y.So)(t,a,r);if(e&&e.data){let s=e.data.map(e=>e.id);v(s)}}catch(e){console.error("Error fetching available models:",e)}}catch(e){console.error("Error fetching SSO settings:",e),z.ZP.error("Failed to fetch SSO settings")}finally{i(!1)}})()},[t]);let N=async()=>{if(t){j(!0);try{let e=Object.entries(u).reduce((e,s)=>{let[t,l]=s;return e[t]=""===l?null:l,e},{}),s=await (0,y.nd)(t,e);c({...o,values:s.settings}),m(!1)}catch(e){console.error("Error updating SSO settings:",e),z.ZP.error("Failed to update settings")}finally{j(!1)}}},Z=(e,s)=>{p(t=>({...t,[e]:s}))},w=e=>e&&Array.isArray(e)?e.map(e=>"string"==typeof e?{team_id:e,user_role:"user"}:"object"==typeof e&&e.team_id?{team_id:e.team_id,max_budget_in_team:e.max_budget_in_team,user_role:e.user_role||"user"}:{team_id:"",user_role:"user"}):[],k=e=>{let s=w(e),t=(e,t,l)=>{let a=[...s];a[e]={...a[e],[t]:l},Z("teams",a)},l=e=>{Z("teams",s.filter((s,t)=>t!==e))};return(0,h.jsxs)("div",{className:"space-y-3",children:[s.map((e,s)=>(0,h.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,h.jsxs)(O.Z,{className:"font-medium",children:["Team ",s+1]}),(0,h.jsx)(P.Z,{size:"sm",variant:"secondary",icon:ew.Z,onClick:()=>l(s),className:"text-red-500 hover:text-red-700",children:"Remove"})]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"text-sm font-medium mb-1",children:"Team ID"}),(0,h.jsx)(A.Z,{value:e.team_id,onChange:e=>t(s,"team_id",e.target.value),placeholder:"Enter team ID"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"text-sm font-medium mb-1",children:"Max Budget in Team"}),(0,h.jsx)(W.Z,{style:{width:"100%"},value:e.max_budget_in_team,onChange:e=>t(s,"max_budget_in_team",e),placeholder:"Optional",min:0,step:.01,precision:2})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"text-sm font-medium mb-1",children:"User Role"}),(0,h.jsxs)(F.default,{style:{width:"100%"},value:e.user_role,onChange:e=>t(s,"user_role",e),children:[(0,h.jsx)(b,{value:"user",children:"User"}),(0,h.jsx)(b,{value:"admin",children:"Admin"})]})]})]})]},s)),(0,h.jsx)(P.Z,{variant:"secondary",icon:tf.Z,onClick:()=>{Z("teams",[...s,{team_id:"",user_role:"user"}])},className:"w-full",children:"Add Team"})]})},S=(e,s,t)=>{var a;let r=s.type;if("teams"===e)return(0,h.jsx)("div",{className:"mt-2",children:k(u[e]||[])});if("user_role"===e&&l)return(0,h.jsx)(F.default,{style:{width:"100%"},value:u[e]||"",onChange:s=>Z(e,s),className:"mt-2",children:Object.entries(l).filter(e=>{let[s]=e;return s.includes("internal_user")}).map(e=>{let[s,{ui_label:t,description:l}]=e;return(0,h.jsx)(b,{value:s,children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("span",{children:t}),(0,h.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:l})]})},s)})});if("budget_duration"===e)return(0,h.jsx)(eK,{value:u[e]||null,onChange:s=>Z(e,s),className:"mt-2"});if("boolean"===r)return(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)(tg.Z,{checked:!!u[e],onChange:s=>Z(e,s)})});if("array"===r&&(null===(a=s.items)||void 0===a?void 0:a.enum))return(0,h.jsx)(F.default,{mode:"multiple",style:{width:"100%"},value:u[e]||[],onChange:s=>Z(e,s),className:"mt-2",children:s.items.enum.map(e=>(0,h.jsx)(b,{value:e,children:e},e))});if("models"===e)return(0,h.jsxs)(F.default,{mode:"multiple",style:{width:"100%"},value:u[e]||[],onChange:s=>Z(e,s),className:"mt-2",children:[(0,h.jsx)(b,{value:"no-default-models",children:"No Default Models"}),f.map(e=>(0,h.jsx)(b,{value:e,children:J(e)},e))]});if("string"===r&&s.enum)return(0,h.jsx)(F.default,{style:{width:"100%"},value:u[e]||"",onChange:s=>Z(e,s),className:"mt-2",children:s.enum.map(e=>(0,h.jsx)(b,{value:e,children:e},e))});else return(0,h.jsx)(A.Z,{value:void 0!==u[e]?String(u[e]):"",onChange:s=>Z(e,s.target.value),placeholder:s.description||"",className:"mt-2"})},C=(e,s)=>{if(null==s)return(0,h.jsx)("span",{className:"text-gray-400",children:"Not set"});if("teams"===e&&Array.isArray(s)){if(0===s.length)return(0,h.jsx)("span",{className:"text-gray-400",children:"No teams assigned"});let e=w(s);return(0,h.jsx)("div",{className:"space-y-2 mt-1",children:e.map((e,s)=>(0,h.jsx)("div",{className:"border rounded-lg p-3 bg-white",children:(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{className:"font-medium text-gray-600",children:"Team ID:"}),(0,h.jsx)("p",{className:"text-gray-900",children:e.team_id||"Not specified"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{className:"font-medium text-gray-600",children:"Max Budget:"}),(0,h.jsx)("p",{className:"text-gray-900",children:void 0!==e.max_budget_in_team?"$".concat(eH(e.max_budget_in_team,4)):"No limit"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{className:"font-medium text-gray-600",children:"Role:"}),(0,h.jsx)("p",{className:"text-gray-900 capitalize",children:e.user_role})]})]})},s))})}if("user_role"===e&&l&&l[s]){let{ui_label:e,description:t}=l[s];return(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{className:"font-medium",children:e}),t&&(0,h.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:t})]})}return"budget_duration"===e?(0,h.jsx)("span",{children:eV(s)}):"boolean"==typeof s?(0,h.jsx)("span",{children:s?"Enabled":"Disabled"}):"models"===e&&Array.isArray(s)?0===s.length?(0,h.jsx)("span",{className:"text-gray-400",children:"None"}):(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:s.map((e,s)=>(0,h.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:J(e)},s))}):"object"==typeof s?Array.isArray(s)?0===s.length?(0,h.jsx)("span",{className:"text-gray-400",children:"None"}):(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:s.map((e,s)=>(0,h.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:"object"==typeof e?JSON.stringify(e):String(e)},s))}):(0,h.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:JSON.stringify(s,null,2)}):(0,h.jsx)("span",{children:String(s)})};return n?(0,h.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,h.jsx)(lo.Z,{size:"large"})}):o?(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(M.Z,{children:"Default User Settings"}),!n&&o&&(d?(0,h.jsxs)("div",{className:"flex gap-2",children:[(0,h.jsx)(P.Z,{variant:"secondary",onClick:()=>{m(!1),p(o.values||{})},disabled:g,children:"Cancel"}),(0,h.jsx)(P.Z,{onClick:N,loading:g,children:"Save Changes"})]}):(0,h.jsx)(P.Z,{onClick:()=>m(!0),children:"Edit Settings"}))]}),(null==o?void 0:null===(s=o.field_schema)||void 0===s?void 0:s.description)&&(0,h.jsx)(_,{className:"mb-4",children:o.field_schema.description}),(0,h.jsx)(li.Z,{}),(0,h.jsx)("div",{className:"mt-4 space-y-4",children:(()=>{let{values:e,field_schema:s}=o;return s&&s.properties?Object.entries(s.properties).map(s=>{let[t,l]=s,a=e[t],r=t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());return(0,h.jsxs)("div",{className:"mb-6 pb-6 border-b border-gray-200 last:border-0",children:[(0,h.jsx)(O.Z,{className:"font-medium text-lg",children:r}),(0,h.jsx)(_,{className:"text-sm text-gray-500 mt-1",children:l.description||"No description available"}),d?(0,h.jsx)("div",{className:"mt-2",children:S(t,l,a)}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:C(t,a)})]},t)}):(0,h.jsx)(O.Z,{children:"No schema information available"})})()})]}):(0,h.jsx)(eo.Z,{children:(0,h.jsx)(O.Z,{children:"No settings available or you do not have permission to view them."})})},ld=t(19616);let lm={email:"",user_id:"",user_role:"",sso_user_id:"",team:"",model:"",min_spend:null,max_spend:null,sort_by:"created_at",sort_order:"desc"};var lu=e=>{var s;let{accessToken:t,token:l,userRole:a,userID:r,teams:n}=e,i=(0,f.NL)(),[o,c]=(0,x.useState)(1),[d,m]=(0,x.useState)(!1),[u,p]=(0,x.useState)(null),[g,j]=(0,x.useState)(!1),[v,_]=(0,x.useState)(null),[b,N]=(0,x.useState)("users"),[Z,w]=(0,x.useState)(lm),[k,S,C]=(0,ld.G)(Z,{wait:300}),[I,A]=(0,x.useState)(!1),[T,E]=(0,x.useState)(!1),[L,O]=(0,x.useState)(null),[M,D]=(0,x.useState)(null),F=e=>{_(e),j(!0)};(0,x.useEffect)(()=>()=>{C.cancel()},[C]),(0,x.useEffect)(()=>{D((0,y.zX)())},[]);let R=e=>{w(s=>{let t={...s,...e};return S(t),t})},q=async e=>{if(!t){z.ZP.error("Access token not found");return}try{z.ZP.success("Generating password reset link...");let s=await (0,y.XO)(t,e);O(s),E(!0)}catch(e){z.ZP.error("Failed to generate password reset link")}},U=async()=>{if(v&&t)try{await (0,y.Eb)(t,[v]),i.setQueriesData({queryKey:["userList"]},e=>{if(void 0===e)return e;let s=e.users.filter(e=>e.user_id!==v);return{...e,users:s}}),z.ZP.success("User deleted successfully")}catch(e){console.error("Error deleting user:",e),z.ZP.error("Failed to delete user")}j(!1),_(null)},V=async()=>{p(null),m(!1)},K=async e=>{if(console.log("inside handleEditSubmit:",e),t&&l&&a&&r){try{let s=await (0,y.pf)(t,e,null);i.setQueriesData({queryKey:["userList"]},e=>{if(void 0===e)return e;let t=e.users.map(e=>e.user_id===s.data.user_id?eB(e,s.data):e);return{...e,users:t}}),z.ZP.success("User ".concat(e.user_id," updated successfully"))}catch(e){console.error("There was an error updating the user",e)}p(null),m(!1)}},B=async e=>{c(e)},H=(0,sp.a)({queryKey:["userList",{debouncedFilter:k,currentPage:o}],queryFn:async()=>{if(!t)throw Error("Access token required");return await (0,y.Of)(t,k.user_id?[k.user_id]:null,o,25,k.email||null,k.user_role||null,k.team||null,k.sso_user_id||null,k.sort_by,k.sort_order)},enabled:!!(t&&l&&a&&r),placeholderData:e=>e}),G=H.data,J=(0,sp.a)({queryKey:["userRoles"],initialData:()=>({}),queryFn:async()=>{if(!t)throw Error("Access token required");return await (0,y.lg)(t)},enabled:!!(t&&l&&a&&r)}).data;if(H.isLoading||!t||!l||!a||!r)return(0,h.jsx)("div",{children:"Loading..."});let Y=lt(J,e=>{p(e),m(!0)},F,q,()=>{});return(0,h.jsxs)("div",{className:"w-full p-6",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,h.jsx)("h1",{className:"text-xl font-semibold",children:"Users"}),(0,h.jsx)("div",{className:"flex space-x-3",children:(0,h.jsx)(eO,{userID:r,accessToken:t,teams:n,possibleUIRoles:J})})]}),(0,h.jsxs)(e4.Z,{defaultIndex:0,onIndexChange:e=>N(0===e?"users":"settings"),children:[(0,h.jsxs)(e5.Z,{className:"mb-4",children:[(0,h.jsx)(e2.Z,{children:"Users"}),(0,h.jsx)(e2.Z,{children:"Default User Settings"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,h.jsx)("div",{className:"border-b px-6 py-4",children:(0,h.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,h.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,h.jsxs)("div",{className:"relative w-64",children:[(0,h.jsx)("input",{type:"text",placeholder:"Search by email...",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Z.email,onChange:e=>R({email:e.target.value})}),(0,h.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,h.jsxs)("button",{className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 ".concat(I?"bg-gray-100":""),onClick:()=>A(!I),children:[(0,h.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters",(Z.user_id||Z.user_role||Z.team)&&(0,h.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500"})]}),(0,h.jsxs)("button",{className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",onClick:()=>{R(lm)},children:[(0,h.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reset Filters"]})]}),I&&(0,h.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mt-3",children:[(0,h.jsxs)("div",{className:"relative w-64",children:[(0,h.jsx)("input",{type:"text",placeholder:"Filter by User ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Z.user_id,onChange:e=>R({user_id:e.target.value})}),(0,h.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,h.jsx)("div",{className:"w-64",children:(0,h.jsx)(e0.Z,{value:Z.user_role,onValueChange:e=>R({user_role:e}),placeholder:"Select Role",children:Object.entries(J).map(e=>{let[s,t]=e;return(0,h.jsx)(ej.Z,{value:s,children:t.ui_label},s)})})}),(0,h.jsx)("div",{className:"w-64",children:(0,h.jsx)(e0.Z,{value:Z.team,onValueChange:e=>R({team:e}),placeholder:"Select Team",children:null==n?void 0:n.map(e=>(0,h.jsx)(ej.Z,{value:e.team_id,children:e.team_alias||e.team_id},e.team_id))})}),(0,h.jsx)("div",{className:"relative w-64",children:(0,h.jsx)("input",{type:"text",placeholder:"Filter by SSO ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Z.sso_user_id,onChange:e=>R({sso_user_id:e.target.value})})})]}),(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing"," ",G&&G.users&&G.users.length>0?(G.page-1)*G.page_size+1:0," ","-"," ",G&&G.users?Math.min(G.page*G.page_size,G.total):0," ","of ",G?G.total:0," results"]}),(0,h.jsxs)("div",{className:"flex space-x-2",children:[(0,h.jsx)("button",{onClick:()=>B(o-1),disabled:1===o,className:"px-3 py-1 text-sm border rounded-md ".concat(1===o?"bg-gray-100 text-gray-400 cursor-not-allowed":"hover:bg-gray-50"),children:"Previous"}),(0,h.jsx)("button",{onClick:()=>B(o+1),disabled:!G||o>=G.total_pages,className:"px-3 py-1 text-sm border rounded-md ".concat(!G||o>=G.total_pages?"bg-gray-100 text-gray-400 cursor-not-allowed":"hover:bg-gray-50"),children:"Next"})]})]})]})}),(0,h.jsx)(ln,{data:(null===(s=H.data)||void 0===s?void 0:s.users)||[],columns:Y,isLoading:H.isLoading,accessToken:t,userRole:a,onSortChange:(e,s)=>{R({sort_by:e,sort_order:s})},currentSort:{sortBy:Z.sort_by,sortOrder:Z.sort_order},possibleUIRoles:J,handleEdit:e=>{p(e),m(!0)},handleDelete:F,handleResetPassword:q})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lc,{accessToken:t,possibleUIRoles:J,userID:r,userRole:a})})]})]}),(0,h.jsx)(ls,{visible:d,possibleUIRoles:J,onCancel:V,user:u,onSubmit:K}),g&&(0,h.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,h.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,h.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,h.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,h.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,h.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,h.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,h.jsx)("div",{className:"sm:flex sm:items-start",children:(0,h.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,h.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete User"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this user?"}),(0,h.jsxs)("p",{className:"text-sm font-medium text-gray-900 mt-2",children:["User ID: ",v]})]})]})})}),(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)(P.Z,{onClick:U,color:"red",className:"ml-2",children:"Delete"}),(0,h.jsx)(P.Z,{onClick:()=>{j(!1),_(null)},children:"Cancel"})]})]})]})}),(0,h.jsx)(ev,{isInvitationLinkModalVisible:T,setIsInvitationLinkModalVisible:E,baseUrl:M||"",invitationLinkData:L,modalType:"resetPassword"})]})},lh=e=>{var s;let{accessToken:t,userID:l,userRole:a}=e,[r,n]=(0,x.useState)(!0),[i,o]=(0,x.useState)(null),[c,d]=(0,x.useState)(!1),[m,u]=(0,x.useState)({}),[p,g]=(0,x.useState)(!1),[j,f]=(0,x.useState)([]),{Paragraph:v}=ef.default,{Option:_}=F.default;(0,x.useEffect)(()=>{(async()=>{if(!t){n(!1);return}try{let e=await (0,y.EB)(t);if(o(e),u(e.values||{}),t)try{let e=await (0,y.So)(t,l,a);if(e&&e.data){let s=e.data.map(e=>e.id);f(s)}}catch(e){console.error("Error fetching available models:",e)}}catch(e){console.error("Error fetching team SSO settings:",e),z.ZP.error("Failed to fetch team settings")}finally{n(!1)}})()},[t]);let b=async()=>{if(t){g(!0);try{let e=await (0,y.r1)(t,m);o({...i,values:e.settings}),d(!1),z.ZP.success("Default team settings updated successfully")}catch(e){console.error("Error updating team settings:",e),z.ZP.error("Failed to update team settings")}finally{g(!1)}}},N=(e,s)=>{u(t=>({...t,[e]:s}))},Z=(e,s,t)=>{var l;let a=s.type;return"budget_duration"===e?(0,h.jsx)(eK,{value:m[e]||null,onChange:s=>N(e,s),className:"mt-2"}):"boolean"===a?(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)(tg.Z,{checked:!!m[e],onChange:s=>N(e,s)})}):"array"===a&&(null===(l=s.items)||void 0===l?void 0:l.enum)?(0,h.jsx)(F.default,{mode:"multiple",style:{width:"100%"},value:m[e]||[],onChange:s=>N(e,s),className:"mt-2",children:s.items.enum.map(e=>(0,h.jsx)(_,{value:e,children:e},e))}):"models"===e?(0,h.jsx)(F.default,{mode:"multiple",style:{width:"100%"},value:m[e]||[],onChange:s=>N(e,s),className:"mt-2",children:j.map(e=>(0,h.jsx)(_,{value:e,children:J(e)},e))}):"string"===a&&s.enum?(0,h.jsx)(F.default,{style:{width:"100%"},value:m[e]||"",onChange:s=>N(e,s),className:"mt-2",children:s.enum.map(e=>(0,h.jsx)(_,{value:e,children:e},e))}):(0,h.jsx)(A.Z,{value:void 0!==m[e]?String(m[e]):"",onChange:s=>N(e,s.target.value),placeholder:s.description||"",className:"mt-2"})},w=(e,s)=>null==s?(0,h.jsx)("span",{className:"text-gray-400",children:"Not set"}):"budget_duration"===e?(0,h.jsx)("span",{children:eV(s)}):"boolean"==typeof s?(0,h.jsx)("span",{children:s?"Enabled":"Disabled"}):"models"===e&&Array.isArray(s)?0===s.length?(0,h.jsx)("span",{className:"text-gray-400",children:"None"}):(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:s.map((e,s)=>(0,h.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:J(e)},s))}):"object"==typeof s?Array.isArray(s)?0===s.length?(0,h.jsx)("span",{className:"text-gray-400",children:"None"}):(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:s.map((e,s)=>(0,h.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:"object"==typeof e?JSON.stringify(e):String(e)},s))}):(0,h.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:JSON.stringify(s,null,2)}):(0,h.jsx)("span",{children:String(s)});return r?(0,h.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,h.jsx)(lo.Z,{size:"large"})}):i?(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(M.Z,{className:"text-xl",children:"Default Team Settings"}),!r&&i&&(c?(0,h.jsxs)("div",{className:"flex gap-2",children:[(0,h.jsx)(P.Z,{variant:"secondary",onClick:()=>{d(!1),u(i.values||{})},disabled:p,children:"Cancel"}),(0,h.jsx)(P.Z,{onClick:b,loading:p,children:"Save Changes"})]}):(0,h.jsx)(P.Z,{onClick:()=>d(!0),children:"Edit Settings"}))]}),(0,h.jsx)(O.Z,{children:"These settings will be applied by default when creating new teams."}),(null==i?void 0:null===(s=i.field_schema)||void 0===s?void 0:s.description)&&(0,h.jsx)(v,{className:"mb-4 mt-2",children:i.field_schema.description}),(0,h.jsx)(li.Z,{}),(0,h.jsx)("div",{className:"mt-4 space-y-4",children:(()=>{let{values:e,field_schema:s}=i;return s&&s.properties?Object.entries(s.properties).map(s=>{let[t,l]=s,a=e[t],r=t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());return(0,h.jsxs)("div",{className:"mb-6 pb-6 border-b border-gray-200 last:border-0",children:[(0,h.jsx)(O.Z,{className:"font-medium text-lg",children:r}),(0,h.jsx)(v,{className:"text-sm text-gray-500 mt-1",children:l.description||"No description available"}),c?(0,h.jsx)("div",{className:"mt-2",children:Z(t,l,a)}):(0,h.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded",children:w(t,a)})]},t)}):(0,h.jsx)(O.Z,{children:"No schema information available"})})()})]}):(0,h.jsx)(eo.Z,{children:(0,h.jsx)(O.Z,{children:"No team settings available or you do not have permission to view them."})})},lx=e=>{let{accessToken:s,userID:t}=e,[l,a]=(0,x.useState)([]);(0,x.useEffect)(()=>{(async()=>{if(s&&t)try{let e=await (0,y.a6)(s);a(e)}catch(e){console.error("Error fetching available teams:",e)}})()},[s,t]);let r=async e=>{if(s&&t)try{await (0,y.cu)(s,e,{user_id:t,role:"user"}),z.ZP.success("Successfully joined team"),a(s=>s.filter(s=>s.team_id!==e))}catch(e){console.error("Error joining team:",e),z.ZP.error("Failed to join team")}};return(0,h.jsx)(eo.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Team Name"}),(0,h.jsx)(sS.Z,{children:"Description"}),(0,h.jsx)(sS.Z,{children:"Members"}),(0,h.jsx)(sS.Z,{children:"Models"}),(0,h.jsx)(sS.Z,{children:"Actions"})]})}),(0,h.jsxs)(sZ.Z,{children:[l.map(e=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{children:e.team_alias})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{children:e.description||"No description available"})}),(0,h.jsx)(sw.Z,{children:(0,h.jsxs)(O.Z,{children:[e.members_with_roles.length," members"]})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)("div",{className:"flex flex-col",children:e.models&&0!==e.models.length?e.models.map((e,s)=>(0,h.jsx)(e1.Z,{size:"xs",className:"mb-1",color:"blue",children:(0,h.jsx)(O.Z,{children:e.length>30?"".concat(e.slice(0,30),"..."):e})},s)):(0,h.jsx)(e1.Z,{size:"xs",color:"red",children:(0,h.jsx)(O.Z,{children:"All Proxy Models"})})})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(P.Z,{size:"xs",variant:"secondary",onClick:()=>r(e.team_id),children:"Join Team"})})]},e.team_id)),0===l.length&&(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:5,className:"text-center",children:(0,h.jsx)(O.Z,{children:"No available teams to join"})})})]})]})})};let lp=(e,s)=>{let t=[];return e&&e.models.length>0?(console.log("organization.models: ".concat(e.models)),t=e.models):t=s,Y(t,s)};var lg=e=>{let{teams:s,searchParams:t,accessToken:l,setTeams:a,userID:r,userRole:n,organizations:i,premiumUser:o=!1}=e,[c,d]=(0,x.useState)(""),[m,u]=(0,x.useState)(null),[p,g]=(0,x.useState)(null),[j,f]=(0,x.useState)(!1),[v,_]=(0,x.useState)({team_id:"",team_alias:"",organization_id:"",sort_by:"created_at",sort_order:"desc"});(0,x.useEffect)(()=>{console.log("inside useeffect - ".concat(c)),l&&S(l,r,n,m,a),eL()},[c]);let[b]=R.Z.useForm(),[N]=R.Z.useForm(),{Title:Z,Paragraph:w}=ef.default,[k,M]=(0,x.useState)(""),[D,U]=(0,x.useState)(!1),[B,Y]=(0,x.useState)(null),[W,Q]=(0,x.useState)(null),[ee,es]=(0,x.useState)(!1),[et,el]=(0,x.useState)(!1),[er,ei]=(0,x.useState)(!1),[ec,ed]=(0,x.useState)(!1),[eu,eh]=(0,x.useState)([]),[ex,ep]=(0,x.useState)(!1),[ev,e_]=(0,x.useState)(null),[ey,eb]=(0,x.useState)([]),[eN,eZ]=(0,x.useState)({}),[ew,ek]=(0,x.useState)([]),[eS,eC]=(0,x.useState)({}),[eI,eP]=(0,x.useState)([]);(0,x.useEffect)(()=>{console.log("currentOrgForCreateTeam: ".concat(p));let e=lp(p,eu);console.log("models: ".concat(e)),eb(e),b.setFieldValue("models",[])},[p,eu]),(0,x.useEffect)(()=>{(async()=>{try{if(null==l)return;let e=(await (0,y.t3)(l)).guardrails.map(e=>e.guardrail_name);ek(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})()},[l]),(0,x.useEffect)(()=>{s&&eZ(s.reduce((e,s)=>(e[s.team_id]={keys:s.keys||[],team_info:{members_with_roles:s.members_with_roles||[]}},e),{}))},[s]);let eA=async e=>{e_(e),ep(!0)},eT=async()=>{if(null!=ev&&null!=s&&null!=l){try{await (0,y.rs)(l,ev),S(l,r,n,m,a)}catch(e){console.error("Error deleting the team:",e)}ep(!1),e_(null)}};(0,x.useEffect)(()=>{(async()=>{try{if(null===r||null===n||null===l)return;let e=await G(r,n,l);e&&eh(e)}catch(e){console.error("Error fetching user models:",e)}})()},[l,r,n,s]);let eE=async e=>{try{if(console.log("formValues: ".concat(JSON.stringify(e))),null!=l){var t;let r=null==e?void 0:e.team_alias,n=null!==(t=null==s?void 0:s.map(e=>e.team_alias))&&void 0!==t?t:[],i=(null==e?void 0:e.organization_id)||(null==m?void 0:m.organization_id);if(""===i||"string"!=typeof i?e.organization_id=null:e.organization_id=i.trim(),n.includes(r))throw Error("Team alias ".concat(r," already exists, please pick another alias"));if(z.ZP.info("Creating Team"),eI.length>0){let s={};if(e.metadata)try{s=JSON.parse(e.metadata)}catch(e){console.warn("Invalid JSON in metadata field, starting with empty object")}s={...s,logging:eI.filter(e=>e.callback_name)},e.metadata=JSON.stringify(s)}e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0&&(e.object_permission={vector_stores:e.allowed_vector_store_ids},delete e.allowed_vector_store_ids),e.allowed_mcp_server_ids&&e.allowed_mcp_server_ids.length>0&&(e.object_permission||(e.object_permission={}),e.object_permission.mcp_servers=e.allowed_mcp_server_ids,delete e.allowed_mcp_server_ids);let o=await (0,y.hT)(l,e);null!==s?a([...s,o]):a([o]),console.log("response for team create call: ".concat(o)),z.ZP.success("Team created"),b.resetFields(),eP([]),el(!1)}}catch(e){console.error("Error creating the team:",e),z.ZP.error("Error creating the team: "+e,20)}},eL=()=>{d(new Date().toLocaleString())},eO=(e,s)=>{let t={...v,[e]:s};_(t),l&&(0,y.JO)(l,t.organization_id||null,null,t.team_id||null,t.team_alias||null).then(e=>{e&&e.teams&&a(e.teams)}).catch(e=>{console.error("Error fetching teams:",e)})};return(0,h.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,h.jsx)(I.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,h.jsxs)(C.Z,{numColSpan:1,className:"flex flex-col gap-2",children:["Admin"!=n&&"Org Admin"!=n||W?null:(0,h.jsx)(P.Z,{className:"w-fit",onClick:()=>el(!0),children:"+ Create New Team"}),W?(0,h.jsx)(tm,{teamId:W,onUpdate:e=>{a(s=>null==s?s:s.map(s=>e.team_id===s.team_id?eB(s,e):s))},onClose:()=>{Q(null),es(!1)},accessToken:l,is_team_admin:(e=>{if(null==e||null==e.members_with_roles)return!1;for(let s=0;s<e.members_with_roles.length;s++){let t=e.members_with_roles[s];if(t.user_id==r&&"admin"==t.role)return!0}return!1})(null==s?void 0:s.find(e=>e.team_id===W)),is_proxy_admin:"Admin"==n,userModels:eu,editTeam:ee}):(0,h.jsxs)(e4.Z,{className:"gap-2 h-[75vh] w-full",children:[(0,h.jsxs)(e5.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)(e2.Z,{children:"Your Teams"}),(0,h.jsx)(e2.Z,{children:"Available Teams"}),eq(n||"")&&(0,h.jsx)(e2.Z,{children:"Default Team Settings"})]}),(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&(0,h.jsxs)(O.Z,{children:["Last Refreshed: ",c]}),(0,h.jsx)(sb.Z,{icon:e7.Z,variant:"shadow",size:"xs",className:"self-center",onClick:eL})]})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsxs)(e6.Z,{children:[(0,h.jsxs)(O.Z,{children:["Click on “Team ID” to view team details ",(0,h.jsx)("b",{children:"and"})," manage team members."]}),(0,h.jsxs)(I.Z,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:[(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(eo.Z,{className:"w-full mx-auto flex-auto overflow-hidden overflow-y-auto max-h-[50vh]",children:[(0,h.jsx)("div",{className:"border-b px-6 py-4",children:(0,h.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,h.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,h.jsxs)("div",{className:"relative w-64",children:[(0,h.jsx)("input",{type:"text",placeholder:"Search by Team Name...",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:v.team_alias,onChange:e=>eO("team_alias",e.target.value)}),(0,h.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,h.jsxs)("button",{className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 ".concat(j?"bg-gray-100":""),onClick:()=>f(!j),children:[(0,h.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters",(v.team_id||v.team_alias||v.organization_id)&&(0,h.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500"})]}),(0,h.jsxs)("button",{className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",onClick:()=>{_({team_id:"",team_alias:"",organization_id:"",sort_by:"created_at",sort_order:"desc"}),l&&(0,y.JO)(l,null,r||null,null,null).then(e=>{e&&e.teams&&a(e.teams)}).catch(e=>{console.error("Error fetching teams:",e)})},children:[(0,h.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reset Filters"]})]}),j&&(0,h.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mt-3",children:[(0,h.jsxs)("div",{className:"relative w-64",children:[(0,h.jsx)("input",{type:"text",placeholder:"Enter Team ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:v.team_id,onChange:e=>eO("team_id",e.target.value)}),(0,h.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,h.jsx)("div",{className:"w-64",children:(0,h.jsx)(e0.Z,{value:v.organization_id||"",onValueChange:e=>eO("organization_id",e),placeholder:"Select Organization",children:null==i?void 0:i.map(e=>(0,h.jsx)(ej.Z,{value:e.organization_id||"",children:e.organization_alias||e.organization_id},e.organization_id))})})]})]})}),(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Team Name"}),(0,h.jsx)(sS.Z,{children:"Team ID"}),(0,h.jsx)(sS.Z,{children:"Created"}),(0,h.jsx)(sS.Z,{children:"Spend (USD)"}),(0,h.jsx)(sS.Z,{children:"Budget (USD)"}),(0,h.jsx)(sS.Z,{children:"Models"}),(0,h.jsx)(sS.Z,{children:"Organization"}),(0,h.jsx)(sS.Z,{children:"Info"})]})}),(0,h.jsx)(sZ.Z,{children:s&&s.length>0?s.filter(e=>!m||e.organization_id===m.organization_id).sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.team_alias}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)("div",{className:"overflow-hidden",children:(0,h.jsx)(X.Z,{title:e.team_id,children:(0,h.jsxs)(P.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>{Q(e.team_id)},children:[e.team_id.slice(0,7),"..."]})})})}),(0,h.jsx)(sw.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"}),(0,h.jsx)(sw.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:eH(e.spend,4)}),(0,h.jsx)(sw.Z,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:null!==e.max_budget&&void 0!==e.max_budget?e.max_budget:"No limit"}),(0,h.jsx)(sw.Z,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:e.models.length>3?"px-0":"",children:(0,h.jsx)("div",{className:"flex flex-col",children:Array.isArray(e.models)?(0,h.jsx)("div",{className:"flex flex-col",children:0===e.models.length?(0,h.jsx)(e1.Z,{size:"xs",className:"mb-1",color:"red",children:(0,h.jsx)(O.Z,{children:"All Proxy Models"})}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"flex items-start",children:[e.models.length>3&&(0,h.jsx)("div",{children:(0,h.jsx)(sb.Z,{icon:eS[e.team_id]?sI.Z:sP.Z,className:"cursor-pointer",size:"xs",onClick:()=>{eC(s=>({...s,[e.team_id]:!s[e.team_id]}))}})}),(0,h.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.models.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,h.jsx)(e1.Z,{size:"xs",color:"red",children:(0,h.jsx)(O.Z,{children:"All Proxy Models"})},s):(0,h.jsx)(e1.Z,{size:"xs",color:"blue",children:(0,h.jsx)(O.Z,{children:e.length>30?"".concat(J(e).slice(0,30),"..."):J(e)})},s)),e.models.length>3&&!eS[e.team_id]&&(0,h.jsx)(e1.Z,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,h.jsxs)(O.Z,{children:["+",e.models.length-3," ",e.models.length-3==1?"more model":"more models"]})}),eS[e.team_id]&&(0,h.jsx)("div",{className:"flex flex-wrap gap-1",children:e.models.slice(3).map((e,s)=>"all-proxy-models"===e?(0,h.jsx)(e1.Z,{size:"xs",color:"red",children:(0,h.jsx)(O.Z,{children:"All Proxy Models"})},s+3):(0,h.jsx)(e1.Z,{size:"xs",color:"blue",children:(0,h.jsx)(O.Z,{children:e.length>30?"".concat(J(e).slice(0,30),"..."):J(e)})},s+3))})]})]})})}):null})}),(0,h.jsx)(sw.Z,{children:e.organization_id}),(0,h.jsxs)(sw.Z,{children:[(0,h.jsxs)(O.Z,{children:[eN&&e.team_id&&eN[e.team_id]&&eN[e.team_id].keys&&eN[e.team_id].keys.length," ","Keys"]}),(0,h.jsxs)(O.Z,{children:[eN&&e.team_id&&eN[e.team_id]&&eN[e.team_id].team_info&&eN[e.team_id].team_info.members_with_roles&&eN[e.team_id].team_info.members_with_roles.length," ","Members"]})]}),(0,h.jsx)(sw.Z,{children:"Admin"==n?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>{Q(e.team_id),es(!0)}}),(0,h.jsx)(sb.Z,{onClick:()=>eA(e.team_id),icon:em.Z,size:"sm"})]}):null})]},e.team_id)):null})]}),ex&&(0,h.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,h.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,h.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,h.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,h.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,h.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,h.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,h.jsx)("div",{className:"sm:flex sm:items-start",children:(0,h.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,h.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Team"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this team ?"})})]})})}),(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)(P.Z,{onClick:eT,color:"red",className:"ml-2",children:"Delete"}),(0,h.jsx)(P.Z,{onClick:()=>{ep(!1),e_(null)},children:"Cancel"})]})]})]})})]})}),"Admin"==n||"Org Admin"==n?(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)(q.Z,{title:"Create Team",visible:et,width:1e3,footer:null,onOk:()=>{el(!1),b.resetFields(),eP([])},onCancel:()=>{el(!1),b.resetFields(),eP([])},children:(0,h.jsxs)(R.Z,{form:b,onFinish:eE,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{label:"Team Name",name:"team_alias",rules:[{required:!0,message:"Please input a team name"}],children:(0,h.jsx)(A.Z,{placeholder:""})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Organization"," ",(0,h.jsx)(X.Z,{title:(0,h.jsxs)("span",{children:["Organizations can have multiple teams. Learn more about"," ",(0,h.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/user_management_heirarchy",target:"_blank",rel:"noopener noreferrer",style:{color:"#1890ff",textDecoration:"underline"},onClick:e=>e.stopPropagation(),children:"user management hierarchy"})]}),children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"organization_id",initialValue:m?m.organization_id:null,className:"mt-8",children:(0,h.jsx)(F.default,{showSearch:!0,allowClear:!0,placeholder:"Search or select an Organization",onChange:e=>{b.setFieldValue("organization_id",e),g((null==i?void 0:i.find(s=>s.organization_id===e))||null)},filterOption:(e,s)=>{var t;return!!s&&((null===(t=s.children)||void 0===t?void 0:t.toString())||"").toLowerCase().includes(e.toLowerCase())},optionFilterProp:"children",children:null==i?void 0:i.map(e=>(0,h.jsxs)(F.default.Option,{value:e.organization_id,children:[(0,h.jsx)("span",{className:"font-medium",children:e.organization_alias})," ",(0,h.jsxs)("span",{className:"text-gray-500",children:["(",e.organization_id,")"]})]},e.organization_id))})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Models"," ",(0,h.jsx)(X.Z,{title:"These are the models that your selected team has access to",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"models",children:(0,h.jsxs)(F.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,h.jsx)(F.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),ey.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:J(e)},e))]})}),(0,h.jsx)(R.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,h.jsx)(H,{step:.01,precision:2,width:200})}),(0,h.jsx)(R.Z.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",children:(0,h.jsxs)(F.default,{defaultValue:null,placeholder:"n/a",children:[(0,h.jsx)(F.default.Option,{value:"24h",children:"daily"}),(0,h.jsx)(F.default.Option,{value:"7d",children:"weekly"}),(0,h.jsx)(F.default.Option,{value:"30d",children:"monthly"})]})}),(0,h.jsx)(R.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,h.jsx)(H,{step:1,width:400})}),(0,h.jsx)(R.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,h.jsx)(H,{step:1,width:400})}),(0,h.jsxs)(T.Z,{className:"mt-20 mb-8",children:[(0,h.jsx)(L.Z,{children:(0,h.jsx)("b",{children:"Additional Settings"})}),(0,h.jsxs)(E.Z,{children:[(0,h.jsx)(R.Z.Item,{label:"Team ID",name:"team_id",help:"ID of the team you want to create. If not provided, it will be generated automatically.",children:(0,h.jsx)(A.Z,{onChange:e=>{e.target.value=e.target.value.trim()}})}),(0,h.jsx)(R.Z.Item,{label:"Team Member Budget (USD)",name:"team_member_budget",normalize:e=>e?Number(e):void 0,tooltip:"This is the individual budget for a user in the team.",children:(0,h.jsx)(H,{step:.01,precision:2,width:200})}),(0,h.jsx)(R.Z.Item,{label:"Team Member Key Duration",name:"team_member_key_duration",tooltip:"Set a limit to the duration of a team member's key.",children:(0,h.jsxs)(F.default,{defaultValue:null,placeholder:"n/a",children:[(0,h.jsx)(F.default.Option,{value:"1d",children:"1 day"}),(0,h.jsx)(F.default.Option,{value:"1w",children:"1 week"}),(0,h.jsx)(F.default.Option,{value:"1mo",children:"1 month"})]})}),(0,h.jsx)(R.Z.Item,{label:"Metadata",name:"metadata",help:"Additional team metadata. Enter metadata as JSON object.",children:(0,h.jsx)(K.default.TextArea,{rows:4})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Guardrails"," ",(0,h.jsx)(X.Z,{title:"Setup your first guardrail",children:(0,h.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",className:"mt-8",help:"Select existing guardrails or enter new ones",children:(0,h.jsx)(F.default,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails",options:ew.map(e=>({value:e,label:e}))})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Allowed Vector Stores"," ",(0,h.jsx)(X.Z,{title:"Select which vector stores this team can access by default. Leave empty for access to all vector stores",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-8",help:"Select vector stores this team can access. Leave empty for access to all vector stores",children:(0,h.jsx)(ea,{onChange:e=>b.setFieldValue("allowed_vector_store_ids",e),value:b.getFieldValue("allowed_vector_store_ids"),accessToken:l||"",placeholder:"Select vector stores (optional)",premiumUser:o})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,h.jsx)(X.Z,{title:"Select which MCP servers this team can access by default. Leave empty for access to all MCP servers",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_server_ids",className:"mt-8",help:"Select MCP servers this team can access. Leave empty for access to all MCP servers",children:(0,h.jsx)(en,{onChange:e=>b.setFieldValue("allowed_mcp_server_ids",e),value:b.getFieldValue("allowed_mcp_server_ids"),accessToken:l||"",placeholder:"Select MCP servers (optional)",premiumUser:o})})]})]}),(0,h.jsxs)(T.Z,{className:"mt-8 mb-8",children:[(0,h.jsx)(L.Z,{children:(0,h.jsx)("b",{children:"Logging Settings"})}),(0,h.jsx)(E.Z,{children:(0,h.jsx)("div",{className:"mt-4",children:(0,h.jsx)(eg,{value:eI,onChange:eP})})})]})]}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Create Team"})})]})})}):null]})]}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lx,{accessToken:l,userID:r})}),eq(n||"")&&(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lh,{accessToken:l,userID:r||"",userRole:n||""})})]})]})]})})})},lj=e=>{var s,t,l,a;let{organizationId:r,onClose:n,accessToken:i,is_org_admin:o,is_proxy_admin:c,userModels:d,editOrg:m}=e,[u,p]=(0,x.useState)(null),[g,j]=(0,x.useState)(!0),[f]=R.Z.useForm(),[v,_]=(0,x.useState)(!1),[b,N]=(0,x.useState)(!1),[Z,w]=(0,x.useState)(!1),[k,S]=(0,x.useState)(null),C=o||c,T=async()=>{try{if(j(!0),!i)return;let e=await (0,y.t$)(i,r);p(e)}catch(e){z.ZP.error("Failed to load organization information"),console.error("Error fetching organization info:",e)}finally{j(!1)}};(0,x.useEffect)(()=>{T()},[r,i]);let E=async e=>{try{if(null==i)return;let s={user_email:e.user_email,user_id:e.user_id,role:e.role};await (0,y.vh)(i,r,s),z.ZP.success("Organization member added successfully"),N(!1),f.resetFields(),T()}catch(e){z.ZP.error("Failed to add organization member"),console.error("Error adding organization member:",e)}},L=async e=>{try{if(!i)return;let s={user_email:e.user_email,user_id:e.user_id,role:e.role};await (0,y.LY)(i,r,s),z.ZP.success("Organization member updated successfully"),w(!1),f.resetFields(),T()}catch(e){z.ZP.error("Failed to update organization member"),console.error("Error updating organization member:",e)}},D=async e=>{try{if(!i)return;await (0,y.Sb)(i,r,e.user_id),z.ZP.success("Organization member deleted successfully"),w(!1),f.resetFields(),T()}catch(e){z.ZP.error("Failed to delete organization member"),console.error("Error deleting organization member:",e)}},q=async e=>{try{if(!i)return;let s={organization_id:r,organization_alias:e.organization_alias,models:e.models,litellm_budget_table:{tpm_limit:e.tpm_limit,rpm_limit:e.rpm_limit,max_budget:e.max_budget,budget_duration:e.budget_duration},metadata:e.metadata?JSON.parse(e.metadata):null};(void 0!==e.vector_stores||void 0!==e.mcp_servers)&&(s.object_permission={...null==u?void 0:u.object_permission,vector_stores:e.vector_stores||[],mcp_servers:e.mcp_servers||[]}),await (0,y.VA)(i,s),z.ZP.success("Organization settings updated successfully"),_(!1),T()}catch(e){z.ZP.error("Failed to update organization settings"),console.error("Error updating organization:",e)}};return g?(0,h.jsx)("div",{className:"p-4",children:"Loading..."}):u?(0,h.jsxs)("div",{className:"w-full h-screen p-4 bg-white",children:[(0,h.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,h.jsxs)("div",{children:[(0,h.jsx)(V.ZP,{onClick:n,className:"mb-4",children:"← Back"}),(0,h.jsx)(M.Z,{children:u.organization_alias}),(0,h.jsx)(O.Z,{className:"text-gray-500 font-mono",children:u.organization_id})]})}),(0,h.jsxs)(e4.Z,{defaultIndex:m?2:0,children:[(0,h.jsxs)(e5.Z,{className:"mb-4",children:[(0,h.jsx)(e2.Z,{children:"Overview"}),(0,h.jsx)(e2.Z,{children:"Members"}),(0,h.jsx)(e2.Z,{children:"Settings"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Organization Details"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsxs)(O.Z,{children:["Created: ",new Date(u.created_at).toLocaleDateString()]}),(0,h.jsxs)(O.Z,{children:["Updated: ",new Date(u.updated_at).toLocaleDateString()]}),(0,h.jsxs)(O.Z,{children:["Created By: ",u.created_by]})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Budget Status"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsxs)(M.Z,{children:["$",eH(u.spend,4)]}),(0,h.jsxs)(O.Z,{children:["of ",null===u.litellm_budget_table.max_budget?"Unlimited":"$".concat(eH(u.litellm_budget_table.max_budget,4))]}),u.litellm_budget_table.budget_duration&&(0,h.jsxs)(O.Z,{className:"text-gray-500",children:["Reset: ",u.litellm_budget_table.budget_duration]})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Rate Limits"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsxs)(O.Z,{children:["TPM: ",u.litellm_budget_table.tpm_limit||"Unlimited"]}),(0,h.jsxs)(O.Z,{children:["RPM: ",u.litellm_budget_table.rpm_limit||"Unlimited"]}),u.litellm_budget_table.max_parallel_requests&&(0,h.jsxs)(O.Z,{children:["Max Parallel Requests: ",u.litellm_budget_table.max_parallel_requests]})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Models"}),(0,h.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:0===u.models.length?(0,h.jsx)(e1.Z,{color:"red",children:"All proxy models"}):u.models.map((e,s)=>(0,h.jsx)(e1.Z,{color:"red",children:e},s))})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Teams"}),(0,h.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:null===(s=u.teams)||void 0===s?void 0:s.map((e,s)=>(0,h.jsx)(e1.Z,{color:"red",children:e.team_id},s))})]}),(0,h.jsx)(sd,{objectPermission:u.object_permission,variant:"card",accessToken:i})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsx)(eo.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[75vh]",children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"User ID"}),(0,h.jsx)(sS.Z,{children:"Role"}),(0,h.jsx)(sS.Z,{children:"Spend"}),(0,h.jsx)(sS.Z,{children:"Created At"}),(0,h.jsx)(sS.Z,{})]})}),(0,h.jsx)(sZ.Z,{children:null===(t=u.members)||void 0===t?void 0:t.map((e,s)=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{className:"font-mono",children:e.user_id})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{className:"font-mono",children:e.user_role})}),(0,h.jsx)(sw.Z,{children:(0,h.jsxs)(O.Z,{children:["$",eH(e.spend,4)]})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{children:new Date(e.created_at).toLocaleString()})}),(0,h.jsx)(sw.Z,{children:C&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>{S({role:e.user_role,user_email:e.user_email,user_id:e.user_id}),w(!0)}}),(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>{D(e)}})]})})]},s))})]})}),C&&(0,h.jsx)(P.Z,{onClick:()=>{N(!0)},children:"Add Member"})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(eo.Z,{className:"overflow-y-auto max-h-[65vh]",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(M.Z,{children:"Organization Settings"}),C&&!v&&(0,h.jsx)(P.Z,{onClick:()=>_(!0),children:"Edit Settings"})]}),v?(0,h.jsxs)(R.Z,{form:f,onFinish:q,initialValues:{organization_alias:u.organization_alias,models:u.models,tpm_limit:u.litellm_budget_table.tpm_limit,rpm_limit:u.litellm_budget_table.rpm_limit,max_budget:u.litellm_budget_table.max_budget,budget_duration:u.litellm_budget_table.budget_duration,metadata:u.metadata?JSON.stringify(u.metadata,null,2):"",vector_stores:(null===(l=u.object_permission)||void 0===l?void 0:l.vector_stores)||[],mcp_servers:(null===(a=u.object_permission)||void 0===a?void 0:a.mcp_servers)||[]},layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{label:"Organization Name",name:"organization_alias",rules:[{required:!0,message:"Please input an organization name"}],children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"Models",name:"models",children:(0,h.jsxs)(F.default,{mode:"multiple",placeholder:"Select models",children:[(0,h.jsx)(F.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),d.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:J(e)},e))]})}),(0,h.jsx)(R.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,h.jsx)(H,{step:.01,precision:2,style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,h.jsxs)(F.default,{placeholder:"n/a",children:[(0,h.jsx)(F.default.Option,{value:"24h",children:"daily"}),(0,h.jsx)(F.default.Option,{value:"7d",children:"weekly"}),(0,h.jsx)(F.default.Option,{value:"30d",children:"monthly"})]})}),(0,h.jsx)(R.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,h.jsx)(H,{step:1,style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,h.jsx)(H,{step:1,style:{width:"100%"}})}),(0,h.jsx)(R.Z.Item,{label:"Vector Stores",name:"vector_stores",children:(0,h.jsx)(el,{onChange:e=>f.setFieldValue("vector_stores",e),value:f.getFieldValue("vector_stores"),accessToken:i||"",placeholder:"Select vector stores"})}),(0,h.jsx)(R.Z.Item,{label:"MCP Servers",name:"mcp_servers",children:(0,h.jsx)(er,{onChange:e=>f.setFieldValue("mcp_servers",e),value:f.getFieldValue("mcp_servers"),accessToken:i||"",placeholder:"Select MCP servers"})}),(0,h.jsx)(R.Z.Item,{label:"Metadata",name:"metadata",children:(0,h.jsx)(K.default.TextArea,{rows:4})}),(0,h.jsx)("div",{className:"sticky z-10 bg-white p-4 border-t border-gray-200 bottom-[-1.5rem] inset-x-[-1.5rem]",children:(0,h.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,h.jsx)(V.ZP,{onClick:()=>_(!1),children:"Cancel"}),(0,h.jsx)(P.Z,{type:"submit",children:"Save Changes"})]})})]}):(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Organization Name"}),(0,h.jsx)("div",{children:u.organization_alias})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Organization ID"}),(0,h.jsx)("div",{className:"font-mono",children:u.organization_id})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Created At"}),(0,h.jsx)("div",{children:new Date(u.created_at).toLocaleString()})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Models"}),(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:u.models.map((e,s)=>(0,h.jsx)(e1.Z,{color:"red",children:e},s))})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Rate Limits"}),(0,h.jsxs)("div",{children:["TPM: ",u.litellm_budget_table.tpm_limit||"Unlimited"]}),(0,h.jsxs)("div",{children:["RPM: ",u.litellm_budget_table.rpm_limit||"Unlimited"]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Budget"}),(0,h.jsxs)("div",{children:["Max: ",null!==u.litellm_budget_table.max_budget?"$".concat(eH(u.litellm_budget_table.max_budget,4)):"No Limit"]}),(0,h.jsxs)("div",{children:["Reset: ",u.litellm_budget_table.budget_duration||"Never"]})]}),(0,h.jsx)(sd,{objectPermission:u.object_permission,variant:"inline",className:"pt-4 border-t border-gray-200",accessToken:i})]})]})})]})]}),(0,h.jsx)(td,{isVisible:b,onCancel:()=>N(!1),onSubmit:E,accessToken:i,title:"Add Organization Member",roles:[{label:"org_admin",value:"org_admin",description:"Can add and remove members, and change their roles."},{label:"internal_user",value:"internal_user",description:"Can view/create keys for themselves within organization."},{label:"internal_user_viewer",value:"internal_user_viewer",description:"Can only view their keys within organization."}],defaultRole:"internal_user"}),(0,h.jsx)(tc,{visible:Z,onCancel:()=>w(!1),onSubmit:L,initialData:k,mode:"edit",config:{title:"Edit Member",showEmail:!0,showUserId:!0,roleOptions:[{label:"Org Admin",value:"org_admin"},{label:"Internal User",value:"internal_user"},{label:"Internal User Viewer",value:"internal_user_viewer"}]}})]}):(0,h.jsx)("div",{className:"p-4",children:"Organization not found"})};let lf=async(e,s)=>{s(await (0,y.r6)(e))};var lv=e=>{let{organizations:s,userRole:t,userModels:l,accessToken:a,lastRefreshed:r,handleRefreshClick:n,currentOrg:i,guardrailsList:o=[],setOrganizations:c,premiumUser:d}=e,[m,u]=(0,x.useState)(null),[p,g]=(0,x.useState)(!1),[j,f]=(0,x.useState)(!1),[v,_]=(0,x.useState)(null),[b,N]=(0,x.useState)(!1),[Z]=R.Z.useForm(),[w,k]=(0,x.useState)({});(0,x.useEffect)(()=>{0===s.length&&a&&lf(a,c)},[s,a]);let S=e=>{e&&(_(e),f(!0))},T=async()=>{if(v&&a)try{await (0,y.cq)(a,v),z.ZP.success("Organization deleted successfully"),f(!1),_(null),lf(a,c)}catch(e){console.error("Error deleting organization:",e)}},E=async e=>{try{if(!a)return;console.log("values in organizations new create call: ".concat(JSON.stringify(e))),e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0&&(e.object_permission={vector_stores:e.allowed_vector_store_ids},delete e.allowed_vector_store_ids),e.allowed_mcp_server_ids&&e.allowed_mcp_server_ids.length>0&&(e.object_permission||(e.object_permission={}),e.object_permission.mcp_servers=e.allowed_mcp_server_ids,delete e.allowed_mcp_server_ids),await (0,y.H1)(a,e),N(!1),Z.resetFields(),lf(a,c)}catch(e){console.error("Error creating organization:",e)}},L=()=>{N(!1),Z.resetFields()};return d?m?(0,h.jsx)(lj,{organizationId:m,onClose:()=>{u(null),g(!1)},accessToken:a,is_org_admin:!0,is_proxy_admin:"Admin"===t,userModels:l,editOrg:p}):(0,h.jsxs)("div",{className:"w-full mx-4 h-[75vh]",children:[(0,h.jsx)(I.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,h.jsxs)(C.Z,{numColSpan:1,className:"flex flex-col gap-2",children:[("Admin"===t||"Org Admin"===t)&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(P.Z,{className:"w-fit",onClick:()=>N(!0),children:"+ Create New Organization"}),(0,h.jsx)(q.Z,{title:"Create Organization",visible:b,width:800,footer:null,onCancel:L,children:(0,h.jsxs)(R.Z,{form:Z,onFinish:E,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsx)(R.Z.Item,{label:"Organization Name",name:"organization_alias",rules:[{required:!0,message:"Please input an organization name"}],children:(0,h.jsx)(A.Z,{placeholder:""})}),(0,h.jsx)(R.Z.Item,{label:"Models",name:"models",children:(0,h.jsxs)(F.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,h.jsx)(F.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),l&&l.length>0&&l.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:J(e)},e))]})}),(0,h.jsx)(R.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,h.jsx)(H,{step:.01,precision:2,width:200})}),(0,h.jsx)(R.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,h.jsxs)(F.default,{defaultValue:null,placeholder:"n/a",children:[(0,h.jsx)(F.default.Option,{value:"24h",children:"daily"}),(0,h.jsx)(F.default.Option,{value:"7d",children:"weekly"}),(0,h.jsx)(F.default.Option,{value:"30d",children:"monthly"})]})}),(0,h.jsx)(R.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,h.jsx)(H,{step:1,width:400})}),(0,h.jsx)(R.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,h.jsx)(H,{step:1,width:400})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Allowed Vector Stores"," ",(0,h.jsx)(X.Z,{title:"Select which vector stores this organization can access by default. Leave empty for access to all vector stores",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-4",help:"Select vector stores this organization can access. Leave empty for access to all vector stores",children:(0,h.jsx)(el,{onChange:e=>Z.setFieldValue("allowed_vector_store_ids",e),value:Z.getFieldValue("allowed_vector_store_ids"),accessToken:a||"",placeholder:"Select vector stores (optional)"})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,h.jsx)(X.Z,{title:"Select which MCP servers this organization can access by default. Leave empty for access to all MCP servers",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_server_ids",className:"mt-4",help:"Select MCP servers this organization can access. Leave empty for access to all MCP servers",children:(0,h.jsx)(er,{onChange:e=>Z.setFieldValue("allowed_mcp_server_ids",e),value:Z.getFieldValue("allowed_mcp_server_ids"),accessToken:a||"",placeholder:"Select MCP servers (optional)"})}),(0,h.jsx)(R.Z.Item,{label:"Metadata",name:"metadata",children:(0,h.jsx)(K.default.TextArea,{rows:4})}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(P.Z,{type:"submit",children:"Create Organization"})})]})})]}),(0,h.jsxs)(e4.Z,{className:"gap-2 h-[75vh] w-full",children:[(0,h.jsxs)(e5.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,h.jsx)("div",{className:"flex",children:(0,h.jsx)(e2.Z,{children:"Your Organizations"})}),(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[r&&(0,h.jsxs)(O.Z,{children:["Last Refreshed: ",r]}),(0,h.jsx)(sb.Z,{icon:e7.Z,variant:"shadow",size:"xs",className:"self-center",onClick:n})]})]}),(0,h.jsx)(e3.Z,{children:(0,h.jsxs)(e6.Z,{children:[(0,h.jsx)(O.Z,{children:"Click on “Organization ID” to view organization details."}),(0,h.jsxs)(I.Z,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:[(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)(eo.Z,{className:"w-full mx-auto flex-auto overflow-y-auto max-h-[50vh]",children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Organization ID"}),(0,h.jsx)(sS.Z,{children:"Organization Name"}),(0,h.jsx)(sS.Z,{children:"Created"}),(0,h.jsx)(sS.Z,{children:"Spend (USD)"}),(0,h.jsx)(sS.Z,{children:"Budget (USD)"}),(0,h.jsx)(sS.Z,{children:"Models"}),(0,h.jsx)(sS.Z,{children:"TPM / RPM Limits"}),(0,h.jsx)(sS.Z,{children:"Info"}),(0,h.jsx)(sS.Z,{children:"Actions"})]})}),(0,h.jsx)(sZ.Z,{children:s&&s.length>0?s.sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>{var s,l,a,r,n,i,o,c,d;return(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:(0,h.jsx)("div",{className:"overflow-hidden",children:(0,h.jsx)(X.Z,{title:e.organization_id,children:(0,h.jsxs)(P.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>u(e.organization_id),children:[null===(s=e.organization_id)||void 0===s?void 0:s.slice(0,7),"..."]})})})}),(0,h.jsx)(sw.Z,{children:e.organization_alias}),(0,h.jsx)(sw.Z,{children:e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"}),(0,h.jsx)(sw.Z,{children:eH(e.spend,4)}),(0,h.jsx)(sw.Z,{children:(null===(l=e.litellm_budget_table)||void 0===l?void 0:l.max_budget)!==null&&(null===(a=e.litellm_budget_table)||void 0===a?void 0:a.max_budget)!==void 0?null===(r=e.litellm_budget_table)||void 0===r?void 0:r.max_budget:"No limit"}),(0,h.jsx)(sw.Z,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:e.models.length>3?"px-0":"",children:(0,h.jsx)("div",{className:"flex flex-col",children:Array.isArray(e.models)?(0,h.jsx)("div",{className:"flex flex-col",children:0===e.models.length?(0,h.jsx)(e1.Z,{size:"xs",className:"mb-1",color:"red",children:(0,h.jsx)(O.Z,{children:"All Proxy Models"})}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"flex items-start",children:[e.models.length>3&&(0,h.jsx)("div",{children:(0,h.jsx)(sb.Z,{icon:w[e.organization_id||""]?sI.Z:sP.Z,className:"cursor-pointer",size:"xs",onClick:()=>{k(s=>({...s,[e.organization_id||""]:!s[e.organization_id||""]}))}})}),(0,h.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.models.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,h.jsx)(e1.Z,{size:"xs",color:"red",children:(0,h.jsx)(O.Z,{children:"All Proxy Models"})},s):(0,h.jsx)(e1.Z,{size:"xs",color:"blue",children:(0,h.jsx)(O.Z,{children:e.length>30?"".concat(J(e).slice(0,30),"..."):J(e)})},s)),e.models.length>3&&!w[e.organization_id||""]&&(0,h.jsx)(e1.Z,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,h.jsxs)(O.Z,{children:["+",e.models.length-3," ",e.models.length-3==1?"more model":"more models"]})}),w[e.organization_id||""]&&(0,h.jsx)("div",{className:"flex flex-wrap gap-1",children:e.models.slice(3).map((e,s)=>"all-proxy-models"===e?(0,h.jsx)(e1.Z,{size:"xs",color:"red",children:(0,h.jsx)(O.Z,{children:"All Proxy Models"})},s+3):(0,h.jsx)(e1.Z,{size:"xs",color:"blue",children:(0,h.jsx)(O.Z,{children:e.length>30?"".concat(J(e).slice(0,30),"..."):J(e)})},s+3))})]})]})})}):null})}),(0,h.jsx)(sw.Z,{children:(0,h.jsxs)(O.Z,{children:["TPM: ",(null===(n=e.litellm_budget_table)||void 0===n?void 0:n.tpm_limit)?null===(i=e.litellm_budget_table)||void 0===i?void 0:i.tpm_limit:"Unlimited",(0,h.jsx)("br",{}),"RPM: ",(null===(o=e.litellm_budget_table)||void 0===o?void 0:o.rpm_limit)?null===(c=e.litellm_budget_table)||void 0===c?void 0:c.rpm_limit:"Unlimited"]})}),(0,h.jsx)(sw.Z,{children:(0,h.jsxs)(O.Z,{children:[(null===(d=e.members)||void 0===d?void 0:d.length)||0," Members"]})}),(0,h.jsx)(sw.Z,{children:"Admin"===t&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>{u(e.organization_id),g(!0)}}),(0,h.jsx)(sb.Z,{onClick:()=>S(e.organization_id),icon:em.Z,size:"sm"})]})})]},e.organization_id)}):null})]})})}),("Admin"===t||"Org Admin"===t)&&(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)(q.Z,{title:"Create Organization",visible:b,width:800,footer:null,onCancel:L,children:(0,h.jsxs)(R.Z,{form:Z,onFinish:E,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsx)(R.Z.Item,{label:"Organization Name",name:"organization_alias",rules:[{required:!0,message:"Please input an organization name"}],children:(0,h.jsx)(A.Z,{placeholder:""})}),(0,h.jsx)(R.Z.Item,{label:"Models",name:"models",children:(0,h.jsxs)(F.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,h.jsx)(F.default.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),l&&l.length>0&&l.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:J(e)},e))]})}),(0,h.jsx)(R.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,h.jsx)(H,{step:.01,precision:2,width:200})}),(0,h.jsx)(R.Z.Item,{label:"Reset Budget",name:"budget_duration",children:(0,h.jsxs)(F.default,{defaultValue:null,placeholder:"n/a",children:[(0,h.jsx)(F.default.Option,{value:"24h",children:"daily"}),(0,h.jsx)(F.default.Option,{value:"7d",children:"weekly"}),(0,h.jsx)(F.default.Option,{value:"30d",children:"monthly"})]})}),(0,h.jsx)(R.Z.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,h.jsx)(H,{step:1,width:400})}),(0,h.jsx)(R.Z.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,h.jsx)(H,{step:1,width:400})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Allowed Vector Stores"," ",(0,h.jsx)(X.Z,{title:"Select which vector stores this organization can access by default. Leave empty for access to all vector stores",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-4",help:"Select vector stores this organization can access. Leave empty for access to all vector stores",children:(0,h.jsx)(el,{onChange:e=>Z.setFieldValue("allowed_vector_store_ids",e),value:Z.getFieldValue("allowed_vector_store_ids"),accessToken:a||"",placeholder:"Select vector stores (optional)"})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,h.jsx)(X.Z,{title:"Select which MCP servers this organization can access by default. Leave empty for access to all MCP servers",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_server_ids",className:"mt-4",help:"Select MCP servers this organization can access. Leave empty for access to all MCP servers",children:(0,h.jsx)(er,{onChange:e=>Z.setFieldValue("allowed_vector_store_ids",e),value:Z.getFieldValue("allowed_vector_store_ids"),accessToken:a||"",placeholder:"Select vector stores (optional)"})}),(0,h.jsx)(R.Z.Item,{label:"Metadata",name:"metadata",children:(0,h.jsx)(K.default.TextArea,{rows:4})}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(P.Z,{type:"submit",children:"Create Organization"})})]})})})]})]})})]})]})}),j?(0,h.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,h.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,h.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,h.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,h.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,h.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,h.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,h.jsx)("div",{className:"sm:flex sm:items-start",children:(0,h.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,h.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Organization"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this organization?"})})]})})}),(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)(P.Z,{onClick:T,color:"red",className:"ml-2",children:"Delete"}),(0,h.jsx)(P.Z,{onClick:()=>{f(!1),_(null)},children:"Cancel"})]})]})]})}):(0,h.jsx)(h.Fragment,{})]}):(0,h.jsx)("div",{children:(0,h.jsxs)(O.Z,{children:["This is a LiteLLM Enterprise feature, and requires a valid key to use. Get a trial key ",(0,h.jsx)("a",{href:"https://www.litellm.ai/#pricing",target:"_blank",rel:"noopener noreferrer",children:"here"}),"."]})})},l_=t(94789);let ly={google:"https://artificialanalysis.ai/img/logos/google_small.svg",microsoft:"https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg",okta:"https://www.okta.com/sites/default/files/Okta_Logo_BrightBlue_Medium.png",generic:""},lb={google:{envVarMap:{google_client_id:"GOOGLE_CLIENT_ID",google_client_secret:"GOOGLE_CLIENT_SECRET"},fields:[{label:"GOOGLE CLIENT ID",name:"google_client_id"},{label:"GOOGLE CLIENT SECRET",name:"google_client_secret"}]},microsoft:{envVarMap:{microsoft_client_id:"MICROSOFT_CLIENT_ID",microsoft_client_secret:"MICROSOFT_CLIENT_SECRET",microsoft_tenant:"MICROSOFT_TENANT"},fields:[{label:"MICROSOFT CLIENT ID",name:"microsoft_client_id"},{label:"MICROSOFT CLIENT SECRET",name:"microsoft_client_secret"},{label:"MICROSOFT TENANT",name:"microsoft_tenant"}]},okta:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"GENERIC CLIENT ID",name:"generic_client_id"},{label:"GENERIC CLIENT SECRET",name:"generic_client_secret"},{label:"AUTHORIZATION ENDPOINT",name:"generic_authorization_endpoint",placeholder:"https://your-okta-domain/authorize"},{label:"TOKEN ENDPOINT",name:"generic_token_endpoint",placeholder:"https://your-okta-domain/token"},{label:"USERINFO ENDPOINT",name:"generic_userinfo_endpoint",placeholder:"https://your-okta-domain/userinfo"}]},generic:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"GENERIC CLIENT ID",name:"generic_client_id"},{label:"GENERIC CLIENT SECRET",name:"generic_client_secret"},{label:"AUTHORIZATION ENDPOINT",name:"generic_authorization_endpoint"},{label:"TOKEN ENDPOINT",name:"generic_token_endpoint"},{label:"USERINFO ENDPOINT",name:"generic_userinfo_endpoint"}]}};var lN=e=>{let{isAddSSOModalVisible:s,isInstructionsModalVisible:t,handleAddSSOOk:l,handleAddSSOCancel:a,handleShowInstructions:r,handleInstructionsOk:n,handleInstructionsCancel:i,form:o,accessToken:c,ssoConfigured:d=!1}=e,[m,u]=(0,x.useState)(!1);(0,x.useEffect)(()=>{(async()=>{if(s&&c)try{let s=await (0,y.PY)(c);if(console.log("Raw SSO data received:",s),s&&s.values){console.log("SSO values:",s.values),console.log("user_email from API:",s.values.user_email);let l=null;if(s.values.google_client_id)l="google";else if(s.values.microsoft_client_id)l="microsoft";else if(s.values.generic_client_id){var e,t;l=(null===(e=s.values.generic_authorization_endpoint)||void 0===e?void 0:e.includes("okta"))||(null===(t=s.values.generic_authorization_endpoint)||void 0===t?void 0:t.includes("auth0"))?"okta":"generic"}let a={sso_provider:l,proxy_base_url:s.values.proxy_base_url,user_email:s.values.user_email,...s.values};console.log("Setting form values:",a),o.resetFields(),setTimeout(()=>{o.setFieldsValue(a),console.log("Form values set, current form values:",o.getFieldsValue())},100)}}catch(e){console.error("Failed to load SSO settings:",e)}})()},[s,c,o]);let p=async e=>{if(!c){z.ZP.error("No access token available");return}try{await (0,y.$o)(c,e),r(e)}catch(e){console.error("Failed to save SSO settings:",e),z.ZP.error("Failed to save SSO settings")}},g=async()=>{if(!c){z.ZP.error("No access token available");return}try{await (0,y.$o)(c,{google_client_id:"",google_client_secret:"",microsoft_client_id:"",microsoft_client_secret:"",microsoft_tenant:"",generic_client_id:"",generic_client_secret:"",generic_authorization_endpoint:"",generic_token_endpoint:"",generic_userinfo_endpoint:"",proxy_base_url:"",user_email:"",sso_provider:""}),o.resetFields(),u(!1),l(),z.ZP.success("SSO settings cleared successfully")}catch(e){console.error("Failed to clear SSO settings:",e),z.ZP.error("Failed to clear SSO settings")}},j=e=>{let s=lb[e];return s?s.fields.map(e=>(0,h.jsx)(R.Z.Item,{label:e.label,name:e.name,rules:[{required:!0,message:"Please enter the ".concat(e.label.toLowerCase())}],children:e.name.includes("client")?(0,h.jsx)(K.default.Password,{}):(0,h.jsx)(A.Z,{placeholder:e.placeholder})},e.name)):null};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(q.Z,{title:d?"Edit SSO Settings":"Add SSO",visible:s,width:800,footer:null,onOk:l,onCancel:a,children:(0,h.jsxs)(R.Z,{form:o,onFinish:p,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{label:"SSO Provider",name:"sso_provider",rules:[{required:!0,message:"Please select an SSO provider"}],children:(0,h.jsx)(F.default,{children:Object.entries(ly).map(e=>{let[s,t]=e;return(0,h.jsx)(F.default.Option,{value:s,children:(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 0"},children:[t&&(0,h.jsx)("img",{src:t,alt:s,style:{height:24,width:24,marginRight:12,objectFit:"contain"}}),(0,h.jsxs)("span",{children:[s.charAt(0).toUpperCase()+s.slice(1)," SSO"]})]})},s)})})}),(0,h.jsx)(R.Z.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.sso_provider!==s.sso_provider,children:e=>{let{getFieldValue:s}=e,t=s("sso_provider");return t?j(t):null}}),(0,h.jsx)(R.Z.Item,{label:"Proxy Admin Email",name:"user_email",rules:[{required:!0,message:"Please enter the email of the proxy admin"}],children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"PROXY BASE URL",name:"proxy_base_url",rules:[{required:!0,message:"Please enter the proxy base url"}],children:(0,h.jsx)(A.Z,{})})]}),(0,h.jsxs)("div",{style:{textAlign:"right",marginTop:"10px",display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"8px"},children:[d&&(0,h.jsx)(V.ZP,{onClick:()=>u(!0),style:{backgroundColor:"#6366f1",borderColor:"#6366f1",color:"white"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#5558eb",e.currentTarget.style.borderColor="#5558eb"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#6366f1",e.currentTarget.style.borderColor="#6366f1"},children:"Clear"}),(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Save"})]})]})}),(0,h.jsxs)(q.Z,{title:"Confirm Clear SSO Settings",visible:m,onOk:g,onCancel:()=>u(!1),okText:"Yes, Clear",cancelText:"Cancel",okButtonProps:{danger:!0,style:{backgroundColor:"#dc2626",borderColor:"#dc2626"}},children:[(0,h.jsx)("p",{children:"Are you sure you want to clear all SSO settings? This action cannot be undone."}),(0,h.jsx)("p",{children:"Users will no longer be able to login using SSO after this change."})]}),(0,h.jsxs)(q.Z,{title:"SSO Setup Instructions",visible:t,width:800,footer:null,onOk:n,onCancel:i,children:[(0,h.jsx)("p",{children:"Follow these steps to complete the SSO setup:"}),(0,h.jsx)(O.Z,{className:"mt-2",children:"1. DO NOT Exit this TAB"}),(0,h.jsx)(O.Z,{className:"mt-2",children:"2. Open a new tab, visit your proxy base url"}),(0,h.jsx)(O.Z,{className:"mt-2",children:"3. Confirm your SSO is configured correctly and you can login on the new Tab"}),(0,h.jsx)(O.Z,{className:"mt-2",children:"4. If Step 3 is successful, you can close this tab"}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{onClick:n,children:"Done"})})]})]})},lZ=t(62272),lw=t(92403),lk=t(29271),lS=t(34419);let lC=e=>{if(!e)return"An unknown error occurred";if("string"==typeof e)return e;if(e.message)try{let s=JSON.parse(e.message);if(s.error&&s.error.message)return s.error.message;return"string"==typeof s?s:JSON.stringify(s,null,2)}catch(s){return e.message}if(e.response&&e.response.data){if("string"==typeof e.response.data)return e.response.data;if(e.response.data.message)return e.response.data.message;if(e.response.data.error)return"string"==typeof e.response.data.error?e.response.data.error:e.response.data.error.message||JSON.stringify(e.response.data.error)}return String(e)};var lI=e=>{let{accessToken:s,userID:t,proxySettings:l}=e,[a]=R.Z.useForm(),[r,n]=(0,x.useState)(!1),[i,o]=(0,x.useState)(null),[c,d]=(0,x.useState)("<your_proxy_base_url>");(0,x.useEffect)(()=>{let e="<your_proxy_base_url>";d(l&&l.PROXY_BASE_URL&&void 0!==l.PROXY_BASE_URL?l.PROXY_BASE_URL:window.location.origin)},[l]);let m="".concat(c,"/scim/v2"),u=async e=>{if(!s||!t){z.ZP.error("You need to be logged in to create a SCIM token");return}try{n(!0);let l={key_alias:e.key_alias||"SCIM Access Token",team_id:null,models:[],allowed_routes:["/scim/*"]},a=await (0,y.wX)(s,t,l);o(a),z.ZP.success("SCIM token created successfully")}catch(e){console.error("Error creating SCIM token:",e),z.ZP.error("Failed to create SCIM token: "+lC(e))}finally{n(!1)}};return(0,h.jsx)(I.Z,{numItems:1,children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)("div",{className:"flex items-center mb-4",children:(0,h.jsx)(M.Z,{children:"SCIM Configuration"})}),(0,h.jsx)(O.Z,{className:"text-gray-600",children:"System for Cross-domain Identity Management (SCIM) allows you to automatically provision and manage users and groups in LiteLLM."}),(0,h.jsx)(li.Z,{}),(0,h.jsxs)("div",{className:"space-y-8",children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center mb-2",children:[(0,h.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 mr-2",children:"1"}),(0,h.jsxs)(M.Z,{className:"text-lg flex items-center",children:[(0,h.jsx)(lZ.Z,{className:"h-5 w-5 mr-2"}),"SCIM Tenant URL"]})]}),(0,h.jsx)(O.Z,{className:"text-gray-600 mb-3",children:"Use this URL in your identity provider SCIM integration settings."}),(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(A.Z,{value:m,disabled:!0,className:"flex-grow"}),(0,h.jsx)(D.CopyToClipboard,{text:m,onCopy:()=>z.ZP.success("URL copied to clipboard"),children:(0,h.jsxs)(P.Z,{variant:"primary",className:"ml-2 flex items-center",children:[(0,h.jsx)(tA.Z,{className:"h-4 w-4 mr-1"}),"Copy"]})})]})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center mb-2",children:[(0,h.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 mr-2",children:"2"}),(0,h.jsxs)(M.Z,{className:"text-lg flex items-center",children:[(0,h.jsx)(lw.Z,{className:"h-5 w-5 mr-2"}),"Authentication Token"]})]}),(0,h.jsx)(l_.Z,{title:"Using SCIM",color:"blue",className:"mb-4",children:"You need a SCIM token to authenticate with the SCIM API. Create one below and use it in your SCIM provider configuration."}),i?(0,h.jsxs)(eo.Z,{className:"border border-yellow-300 bg-yellow-50",children:[(0,h.jsxs)("div",{className:"flex items-center mb-2 text-yellow-800",children:[(0,h.jsx)(lk.Z,{className:"h-5 w-5 mr-2"}),(0,h.jsx)(M.Z,{className:"text-lg text-yellow-800",children:"Your SCIM Token"})]}),(0,h.jsx)(O.Z,{className:"text-yellow-800 mb-4 font-medium",children:"Make sure to copy this token now. You will not be able to see it again."}),(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(A.Z,{value:i.key,className:"flex-grow mr-2 bg-white",type:"password",disabled:!0}),(0,h.jsx)(D.CopyToClipboard,{text:i.key,onCopy:()=>z.ZP.success("Token copied to clipboard"),children:(0,h.jsxs)(P.Z,{variant:"primary",className:"flex items-center",children:[(0,h.jsx)(tA.Z,{className:"h-4 w-4 mr-1"}),"Copy"]})})]}),(0,h.jsxs)(P.Z,{className:"mt-4 flex items-center",variant:"secondary",onClick:()=>o(null),children:[(0,h.jsx)(lS.Z,{className:"h-4 w-4 mr-1"}),"Create Another Token"]})]}):(0,h.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,h.jsxs)(R.Z,{form:a,onFinish:u,layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{name:"key_alias",label:"Token Name",rules:[{required:!0,message:"Please enter a name for your token"}],children:(0,h.jsx)(A.Z,{placeholder:"SCIM Access Token"})}),(0,h.jsx)(R.Z.Item,{children:(0,h.jsxs)(P.Z,{variant:"primary",type:"submit",loading:r,className:"flex items-center",children:[(0,h.jsx)(lw.Z,{className:"h-4 w-4 mr-1"}),"Create SCIM Token"]})})]})})]})]})]})})},lP=e=>{let{accessToken:s,onSuccess:t}=e,[l]=R.Z.useForm(),[a,r]=(0,x.useState)(!1);(0,x.useEffect)(()=>{(async()=>{if(s)try{let e=await (0,y.PY)(s);if(e&&e.values){let s=e.values.ui_access_mode,t={};s&&"object"==typeof s?t={ui_access_mode_type:s.type,restricted_sso_group:s.restricted_sso_group,sso_group_jwt_field:s.sso_group_jwt_field}:"string"==typeof s&&(t={ui_access_mode_type:s,restricted_sso_group:e.values.restricted_sso_group,sso_group_jwt_field:e.values.team_ids_jwt_field||e.values.sso_group_jwt_field}),l.setFieldsValue(t)}}catch(e){console.error("Failed to load UI access settings:",e)}})()},[s,l]);let n=async e=>{if(!s){z.ZP.error("No access token available");return}r(!0);try{let l={ui_access_mode:{type:e.ui_access_mode_type,restricted_sso_group:e.restricted_sso_group,sso_group_jwt_field:e.sso_group_jwt_field}};await (0,y.$o)(s,l),t()}catch(e){console.error("Failed to save UI access settings:",e),z.ZP.error("Failed to save UI access settings")}finally{r(!1)}};return(0,h.jsxs)("div",{style:{padding:"16px"},children:[(0,h.jsx)("div",{style:{marginBottom:"16px"},children:(0,h.jsx)(O.Z,{style:{fontSize:"14px",color:"#6b7280"},children:"Configure who can access the UI interface and how group information is extracted from JWT tokens."})}),(0,h.jsxs)(R.Z,{form:l,onFinish:n,layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{label:"UI Access Mode",name:"ui_access_mode_type",tooltip:"Controls who can access the UI interface",children:(0,h.jsxs)(F.default,{placeholder:"Select access mode",children:[(0,h.jsx)(F.default.Option,{value:"all_authenticated_users",children:"All Authenticated Users"}),(0,h.jsx)(F.default.Option,{value:"restricted_sso_group",children:"Restricted SSO Group"})]})}),(0,h.jsx)(R.Z.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.ui_access_mode_type!==s.ui_access_mode_type,children:e=>{let{getFieldValue:s}=e;return"restricted_sso_group"===s("ui_access_mode_type")?(0,h.jsx)(R.Z.Item,{label:"Restricted SSO Group",name:"restricted_sso_group",rules:[{required:!0,message:"Please enter the restricted SSO group"}],children:(0,h.jsx)(A.Z,{placeholder:"ui-access-group"})}):null}}),(0,h.jsx)(R.Z.Item,{label:"SSO Group JWT Field",name:"sso_group_jwt_field",tooltip:"JWT field name that contains team/group information. Use dot notation to access nested fields.",children:(0,h.jsx)(A.Z,{placeholder:"groups"})}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"16px"},children:(0,h.jsx)(V.ZP,{type:"primary",htmlType:"submit",loading:a,style:{backgroundColor:"#6366f1",borderColor:"#6366f1"},children:"Update UI Access Control"})})]})]})},lA=e=>{let{searchParams:s,accessToken:t,userID:l,showSSOBanner:a,premiumUser:r,proxySettings:n}=e,[i]=R.Z.useForm(),[o]=R.Z.useForm(),{Title:c,Paragraph:d}=ef.default,[m,u]=(0,x.useState)(""),[g,j]=(0,x.useState)(null),[f,v]=(0,x.useState)(null),[_,b]=(0,x.useState)(!1),[N,Z]=(0,x.useState)(!1),[w,k]=(0,x.useState)(!1),[S,C]=(0,x.useState)(!1),[I,A]=(0,x.useState)(!1),[T,E]=(0,x.useState)(!1),[L,O]=(0,x.useState)(!1),[M,D]=(0,x.useState)(!1),[F,U]=(0,x.useState)(!1),[B,H]=(0,x.useState)(!1),[G,J]=(0,x.useState)([]),[Y,W]=(0,x.useState)(null),[$,X]=(0,x.useState)(!1);(0,p.useRouter)();let[Q,ee]=(0,x.useState)(null);console.log=function(){};let es=sv(),et="All IP Addresses Allowed",el=es;el+="/fallback/login";let ea=async()=>{if(t&&r)try{let e=await (0,y.PY)(t);if(console.log("SSO data:",e),e&&e.values){let s=e.values.google_client_id&&e.values.google_client_secret,t=e.values.microsoft_client_id&&e.values.microsoft_client_secret,l=e.values.generic_client_id&&e.values.generic_client_secret;X(s||t||l)}else X(!1)}catch(e){console.error("Error checking SSO configuration:",e),X(!1)}},er=async()=>{try{if(!0!==r){z.ZP.error("This feature is only available for premium users. Please upgrade your account.");return}if(t){let e=await (0,y.PT)(t);J(e&&e.length>0?e:[et])}else J([et])}catch(e){console.error("Error fetching allowed IPs:",e),z.ZP.error("Failed to fetch allowed IPs ".concat(e)),J([et])}finally{!0===r&&O(!0)}},en=async e=>{try{if(t){await (0,y.eH)(t,e.ip);let s=await (0,y.PT)(t);J(s),z.ZP.success("IP address added successfully")}}catch(e){console.error("Error adding IP:",e),z.ZP.error("Failed to add IP address ".concat(e))}finally{D(!1)}},ei=async e=>{W(e),U(!0)},ec=async()=>{if(Y&&t)try{await (0,y.$I)(t,Y);let e=await (0,y.PT)(t);J(e.length>0?e:[et]),z.ZP.success("IP address deleted successfully")}catch(e){console.error("Error deleting IP:",e),z.ZP.error("Failed to delete IP address ".concat(e))}finally{U(!1),W(null)}};(0,x.useEffect)(()=>{(async()=>{if(null!=t){let e=[],s=await (0,y.Xd)(t,"proxy_admin_viewer");console.log("proxy admin viewer response: ",s);let l=s.users;console.log("proxy viewers response: ".concat(l)),l.forEach(s=>{e.push({user_role:s.user_role,user_id:s.user_id,user_email:s.user_email})}),console.log("proxy viewers: ".concat(l));let a=(await (0,y.Xd)(t,"proxy_admin")).users;a.forEach(s=>{e.push({user_role:s.user_role,user_id:s.user_id,user_email:s.user_email})}),console.log("proxy admins: ".concat(a)),console.log("combinedList: ".concat(e)),j(e),ee(await (0,y.lg)(t))}})()},[t]),(0,x.useEffect)(()=>{ea()},[t,r]);let ed=()=>{H(!1)};return console.log("admins: ".concat(null==g?void 0:g.length)),(0,h.jsxs)("div",{className:"w-full m-2 mt-2 p-8",children:[(0,h.jsx)(c,{level:4,children:"Admin Access "}),(0,h.jsx)(d,{children:"Go to 'Internal Users' page to add other admins."}),(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{children:[(0,h.jsx)(e2.Z,{children:"Security Settings"}),(0,h.jsx)(e2.Z,{children:"SCIM"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsxs)(e6.Z,{children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(c,{level:4,children:" ✨ Security Settings"}),(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginTop:"1rem",marginLeft:"0.5rem"},children:[(0,h.jsx)("div",{children:(0,h.jsx)(P.Z,{style:{width:"150px"},onClick:()=>!0===r?A(!0):z.ZP.error("Only premium users can add SSO"),children:$?"Edit SSO Settings":"Add SSO"})}),(0,h.jsx)("div",{children:(0,h.jsx)(P.Z,{style:{width:"150px"},onClick:er,children:"Allowed IPs"})}),(0,h.jsx)("div",{children:(0,h.jsx)(P.Z,{style:{width:"150px"},onClick:()=>!0===r?H(!0):z.ZP.error("Only premium users can configure UI access control"),children:"UI Access Control"})})]})]}),(0,h.jsxs)("div",{className:"flex justify-start mb-4",children:[(0,h.jsx)(lN,{isAddSSOModalVisible:I,isInstructionsModalVisible:T,handleAddSSOOk:()=>{A(!1),i.resetFields(),t&&r&&ea()},handleAddSSOCancel:()=>{A(!1),i.resetFields()},handleShowInstructions:e=>{A(!1),E(!0)},handleInstructionsOk:()=>{E(!1),t&&r&&ea()},handleInstructionsCancel:()=>{E(!1),t&&r&&ea()},form:i,accessToken:t,ssoConfigured:$}),(0,h.jsx)(q.Z,{title:"Manage Allowed IP Addresses",width:800,visible:L,onCancel:()=>O(!1),footer:[(0,h.jsx)(P.Z,{className:"mx-1",onClick:()=>D(!0),children:"Add IP Address"},"add"),(0,h.jsx)(P.Z,{onClick:()=>O(!1),children:"Close"},"close")],children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"IP Address"}),(0,h.jsx)(sS.Z,{className:"text-right",children:"Action"})]})}),(0,h.jsx)(sZ.Z,{children:G.map((e,s)=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:e}),(0,h.jsx)(sw.Z,{className:"text-right",children:e!==et&&(0,h.jsx)(P.Z,{onClick:()=>ei(e),color:"red",size:"xs",children:"Delete"})})]},s))})]})}),(0,h.jsx)(q.Z,{title:"Add Allowed IP Address",visible:M,onCancel:()=>D(!1),footer:null,children:(0,h.jsxs)(R.Z,{onFinish:en,children:[(0,h.jsx)(R.Z.Item,{name:"ip",rules:[{required:!0,message:"Please enter an IP address"}],children:(0,h.jsx)(K.default,{placeholder:"Enter IP address"})}),(0,h.jsx)(R.Z.Item,{children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Add IP Address"})})]})}),(0,h.jsx)(q.Z,{title:"Confirm Delete",visible:F,onCancel:()=>U(!1),onOk:ec,footer:[(0,h.jsx)(P.Z,{className:"mx-1",onClick:()=>ec(),children:"Yes"},"delete"),(0,h.jsx)(P.Z,{onClick:()=>U(!1),children:"Close"},"close")],children:(0,h.jsxs)("p",{children:["Are you sure you want to delete the IP address: ",Y,"?"]})}),(0,h.jsx)(q.Z,{title:"UI Access Control Settings",visible:B,width:600,footer:null,onOk:ed,onCancel:()=>{H(!1)},children:(0,h.jsx)(lP,{accessToken:t,onSuccess:()=>{ed(),z.ZP.success("UI Access Control settings updated successfully")}})})]}),(0,h.jsxs)(l_.Z,{title:"Login without SSO",color:"teal",children:["If you need to login without sso, you can access"," ",(0,h.jsxs)("a",{href:el,target:"_blank",children:[(0,h.jsx)("b",{children:el})," "]})]})]}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lI,{accessToken:t,userID:l,proxySettings:n})})]})]})]})};let{Title:lT}=ef.default;var lE=e=>{let{accessToken:s}=e,[t,l]=(0,x.useState)(!0),[a,r]=(0,x.useState)([]);(0,x.useEffect)(()=>{n()},[s]);let n=async()=>{if(s){l(!0);try{let e=await (0,y.pu)(s);r(e.settings)}catch(e){console.error("Failed to fetch email event settings:",e),z.ZP.error("Failed to fetch email event settings")}finally{l(!1)}}},i=(e,s)=>{r(a.map(t=>t.event===e?{...t,enabled:s}:t))},o=async()=>{if(s)try{await (0,y.qW)(s,{settings:a}),z.ZP.success("Email event settings updated successfully")}catch(e){console.error("Failed to update email event settings:",e),z.ZP.error("Failed to update email event settings")}},c=async()=>{if(s)try{await (0,y.jr)(s),z.ZP.success("Email event settings reset to defaults"),n()}catch(e){console.error("Failed to reset email event settings:",e),z.ZP.error("Failed to reset email event settings")}},d=e=>{if(e.includes("Virtual Key Created"))return"An email will be sent to the user when a new virtual key is created with their user ID";if(e.includes("New User Invitation"))return"An email will be sent to the email address of the user when a new user is created";{let s=e.split(/(?=[A-Z])/).join(" ").toLowerCase();return"Receive an email notification when ".concat(s)}};return(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(lT,{level:4,children:"Email Notifications"}),(0,h.jsx)(O.Z,{children:"Select which events should trigger email notifications."}),(0,h.jsx)(tP.Z,{}),t?(0,h.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:(0,h.jsx)(lo.Z,{size:"large"})}):(0,h.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(ts.Z,{checked:e.enabled,onChange:s=>i(e.event,s.target.checked)}),(0,h.jsxs)("div",{className:"ml-3",children:[(0,h.jsx)(O.Z,{children:e.event}),(0,h.jsx)("div",{className:"text-sm text-gray-500 block",children:d(e.event)})]})]},e.event))}),(0,h.jsxs)("div",{className:"mt-6 flex space-x-4",children:[(0,h.jsx)(P.Z,{onClick:o,disabled:t,children:"Save Changes"}),(0,h.jsx)(P.Z,{onClick:c,variant:"secondary",disabled:t,children:"Reset to Defaults"})]})]})};let{Title:lL}=ef.default;var lO=e=>{let{accessToken:s,premiumUser:t,alerts:l}=e,a=()=>{if(!s)return;let e={};l.filter(e=>"email"===e.name).forEach(s=>{var t;Object.entries(null!==(t=s.variables)&&void 0!==t?t:{}).forEach(s=>{let[t,l]=s,a=document.querySelector('input[name="'.concat(t,'"]'));a&&a.value&&(e[t]=null==a?void 0:a.value)})}),console.log("updatedVariables",e);try{(0,y.K_)(s,{general_settings:{alerting:["email"]},environment_variables:e})}catch(e){z.ZP.error("Failed to update alerts: "+e,20)}z.ZP.success("Email settings updated successfully")};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"mt-6 mb-6",children:(0,h.jsx)(lE,{accessToken:s})}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(lL,{level:4,children:"Email Server Settings"}),(0,h.jsxs)(O.Z,{children:[(0,h.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",style:{color:"blue"},children:" LiteLLM Docs: email alerts"})," ",(0,h.jsx)("br",{})]}),(0,h.jsx)("div",{className:"flex w-full",children:l.filter(e=>"email"===e.name).map((e,s)=>{var l;return(0,h.jsx)(sw.Z,{children:(0,h.jsx)("ul",{children:(0,h.jsx)(I.Z,{numItems:2,children:Object.entries(null!==(l=e.variables)&&void 0!==l?l:{}).map(e=>{let[s,l]=e;return(0,h.jsxs)("li",{className:"mx-2 my-2",children:[!0!=t&&("EMAIL_LOGO_URL"===s||"EMAIL_SUPPORT_CONTACT"===s)?(0,h.jsxs)("div",{children:[(0,h.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:(0,h.jsxs)(O.Z,{className:"mt-2",children:[" ","✨ ",s]})}),(0,h.jsx)(A.Z,{name:s,defaultValue:l,type:"password",disabled:!0,style:{width:"400px"}})]}):(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"mt-2",children:s}),(0,h.jsx)(A.Z,{name:s,defaultValue:l,type:"password",style:{width:"400px"}})]}),(0,h.jsxs)("p",{style:{fontSize:"small",fontStyle:"italic"},children:["SMTP_HOST"===s&&(0,h.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP host address, e.g. `smtp.resend.com`",(0,h.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PORT"===s&&(0,h.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP port number, e.g. `587`",(0,h.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_USERNAME"===s&&(0,h.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP username, e.g. `username`",(0,h.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PASSWORD"===s&&(0,h.jsx)("span",{style:{color:"red"},children:" Required * "}),"SMTP_SENDER_EMAIL"===s&&(0,h.jsxs)("div",{style:{color:"gray"},children:["Enter the sender email address, e.g. `sender@berri.ai`",(0,h.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"TEST_EMAIL_ADDRESS"===s&&(0,h.jsxs)("div",{style:{color:"gray"},children:["Email Address to send `Test Email Alert` to. example: `info@berri.ai`",(0,h.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"EMAIL_LOGO_URL"===s&&(0,h.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the Logo that appears in the email, pass a url to your logo"}),"EMAIL_SUPPORT_CONTACT"===s&&(0,h.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the support email address that appears in the email. Default is support@berri.ai"})]})]},s)})})})},s)})}),(0,h.jsx)(P.Z,{className:"mt-2",onClick:()=>a(),children:"Save Changes"}),(0,h.jsx)(P.Z,{onClick:()=>s&&(0,y.jE)(s,"email"),className:"mx-2",children:"Test Email Alerts"})]})]})},lM=e=>{let{alertingSettings:s,handleInputChange:t,handleResetField:l,handleSubmit:a,premiumUser:r}=e,[n]=R.Z.useForm();return(0,h.jsxs)(R.Z,{form:n,onFinish:()=>{console.log("INSIDE ONFINISH");let e=n.getFieldsValue(),s=Object.entries(e).every(e=>{let[s,t]=e;return"boolean"!=typeof t&&(""===t||null==t)});console.log("formData: ".concat(JSON.stringify(e),", isEmpty: ").concat(s)),s?console.log("Some form fields are empty."):a(e)},labelAlign:"left",children:[s.map((e,s)=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsxs)(sw.Z,{align:"center",children:[(0,h.jsx)(O.Z,{children:e.field_name}),(0,h.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:e.field_description})]}),e.premium_field?r?(0,h.jsx)(R.Z.Item,{name:e.field_name,children:(0,h.jsx)(sw.Z,{children:"Integer"===e.field_type?(0,h.jsx)(W.Z,{step:1,value:e.field_value,onChange:s=>t(e.field_name,s)}):"Boolean"===e.field_type?(0,h.jsx)(tB.Z,{checked:e.field_value,onChange:s=>t(e.field_name,s)}):(0,h.jsx)(K.default,{value:e.field_value,onChange:s=>t(e.field_name,s)})})}):(0,h.jsx)(sw.Z,{children:(0,h.jsx)(P.Z,{className:"flex items-center justify-center",children:(0,h.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})})}):(0,h.jsx)(R.Z.Item,{name:e.field_name,className:"mb-0",valuePropName:"Boolean"===e.field_type?"checked":"value",children:(0,h.jsx)(sw.Z,{children:"Integer"===e.field_type?(0,h.jsx)(W.Z,{step:1,value:e.field_value,onChange:s=>t(e.field_name,s),className:"p-0"}):"Boolean"===e.field_type?(0,h.jsx)(tB.Z,{checked:e.field_value,onChange:s=>{t(e.field_name,s),n.setFieldsValue({[e.field_name]:s})}}):(0,h.jsx)(K.default,{value:e.field_value,onChange:s=>t(e.field_name,s)})})}),(0,h.jsx)(sw.Z,{children:!0==e.stored_in_db?(0,h.jsx)(e1.Z,{icon:eA.Z,className:"text-white",children:"In DB"}):!1==e.stored_in_db?(0,h.jsx)(e1.Z,{className:"text-gray bg-white outline",children:"In Config"}):(0,h.jsx)(e1.Z,{className:"text-gray bg-white outline",children:"Not Set"})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(sb.Z,{icon:em.Z,color:"red",onClick:()=>l(e.field_name,s),children:"Reset"})})]},s)),(0,h.jsx)("div",{children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Update Settings"})})]})},lD=e=>{let{accessToken:s,premiumUser:t}=e,[l,a]=(0,x.useState)([]);return(0,x.useEffect)(()=>{s&&(0,y.RQ)(s).then(e=>{a(e)})},[s]),(0,h.jsx)(lM,{alertingSettings:l,handleInputChange:(e,s)=>{let t=l.map(t=>t.field_name===e?{...t,field_value:s}:t);console.log("updatedSettings: ".concat(JSON.stringify(t))),a(t)},handleResetField:(e,t)=>{if(s)try{let s=l.map(s=>s.field_name===e?{...s,stored_in_db:null,field_value:s.field_default_value}:s);a(s)}catch(e){console.log("ERROR OCCURRED!")}},handleSubmit:e=>{if(!s||(console.log("formValues: ".concat(e)),null==e||void 0==e))return;let t={};l.forEach(e=>{t[e.field_name]=e.field_value});let a={...e,...t};console.log("mergedFormValues: ".concat(JSON.stringify(a)));let{slack_alerting:r,...n}=a;console.log("slack_alerting: ".concat(r,", alertingArgs: ").concat(JSON.stringify(n)));try{(0,y.jA)(s,"alerting_args",n),"boolean"==typeof r&&(!0==r?(0,y.jA)(s,"alerting",["slack"]):(0,y.jA)(s,"alerting",[])),z.ZP.success("Wait 10s for proxy to update.")}catch(e){}},premiumUser:t})},lF=t(86582);let{Title:lR,Paragraph:lz}=ef.default;var lq=e=>{let{accessToken:s,userRole:t,userID:l,premiumUser:a}=e,[r,n]=(0,x.useState)([]),[i,c]=(0,x.useState)([]),[d,m]=(0,x.useState)(!1),[u]=R.Z.useForm(),[p,g]=(0,x.useState)(null),[j,f]=(0,x.useState)(""),[v,_]=(0,x.useState)({}),[b,N]=(0,x.useState)([]),[Z,w]=(0,x.useState)(!1),[k,S]=(0,x.useState)([]),[C,T]=(0,x.useState)([]),[E,L]=(0,x.useState)(!1),[M,D]=(0,x.useState)(null),[U,K]=(0,x.useState)(!1),[B,H]=(0,x.useState)(null),G=e=>{b.includes(e)?N(b.filter(s=>s!==e)):N([...b,e])},J={llm_exceptions:"LLM Exceptions",llm_too_slow:"LLM Responses Too Slow",llm_requests_hanging:"LLM Requests Hanging",budget_alerts:"Budget Alerts (API Keys, Users)",db_exceptions:"Database Exceptions (Read/Write)",daily_reports:"Weekly/Monthly Spend Reports",outage_alerts:"Outage Alerts",region_outage_alerts:"Region Outage Alerts"};(0,x.useEffect)(()=>{s&&t&&l&&(0,y.BL)(s,l,t).then(e=>{n(e.callbacks),S(e.available_callbacks);let s=e.alerts;if(s&&s.length>0){let e=s[0],t=e.variables.SLACK_WEBHOOK_URL;N(e.active_alerts),f(t),_(e.alerts_to_webhook)}c(s)})},[s,t,l]);let Y=e=>b&&b.includes(e),W=async e=>{if(!s)return;let t={};Object.entries(e).forEach(e=>{let[s,l]=e;"callback"!==s&&(t[s]=l)});try{await (0,y.K_)(s,{environment_variables:t}),z.ZP.success("Callback added successfully"),m(!1),u.resetFields(),g(null)}catch(e){z.ZP.error("Failed to add callback: "+e,20)}},$=async e=>{if(!s)return;let t=null==e?void 0:e.callback,l={};Object.entries(e).forEach(e=>{let[s,t]=e;"callback"!==s&&(l[s]=t)});try{await (0,y.K_)(s,{environment_variables:l,litellm_settings:{success_callback:[t]}}),z.ZP.success("Callback ".concat(t," added successfully")),m(!1),u.resetFields(),g(null)}catch(e){z.ZP.error("Failed to add callback: "+e,20)}},X=e=>{g(e.litellm_callback_name),e&&e.litellm_callback_params?T(e.litellm_callback_params):T([])},Q=e=>{H(e),K(!0)},ee=async()=>{if(B&&s)try{if(await (0,y.Oz)(s,B),z.ZP.success("Callback ".concat(B," deleted successfully")),l&&t){let e=await (0,y.BL)(s,l,t);n(e.callbacks)}K(!1),H(null)}catch(e){console.error("Failed to delete callback:",e),z.ZP.error("Failed to delete callback: ".concat(e))}};return s?(0,h.jsxs)("div",{className:"w-full mx-4",children:[(0,h.jsx)(I.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{variant:"line",defaultValue:"1",children:[(0,h.jsx)(e2.Z,{value:"1",children:"Logging Callbacks"}),(0,h.jsx)(e2.Z,{value:"2",children:"Alerting Types"}),(0,h.jsx)(e2.Z,{value:"3",children:"Alerting Settings"}),(0,h.jsx)(e2.Z,{value:"4",children:"Email Alerts"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsxs)(e6.Z,{children:[(0,h.jsx)(lR,{level:4,children:"Active Logging Callbacks"}),(0,h.jsx)(I.Z,{numItems:2,children:(0,h.jsx)(eo.Z,{className:"max-h-[50vh]",children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sS.Z,{children:"Callback Name"})})}),(0,h.jsx)(sZ.Z,{children:r.map((e,t)=>(0,h.jsxs)(sC.Z,{className:"flex justify-between",children:[(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{children:e.name})}),(0,h.jsx)(sw.Z,{children:(0,h.jsxs)(I.Z,{numItems:2,className:"flex justify-between",children:[(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>{D(e),L(!0)}}),(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>Q(e.name),className:"text-red-500 hover:text-red-700 cursor-pointer"}),(0,h.jsx)(P.Z,{onClick:()=>(0,y.jE)(s,e.name),className:"ml-2",variant:"secondary",children:"Test Callback"})]})})]},t))})]})})}),(0,h.jsx)(P.Z,{className:"mt-2",onClick:()=>w(!0),children:"Add Callback"})]}),(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)(O.Z,{className:"my-2",children:["Alerts are only supported for Slack Webhook URLs. Get your webhook urls from"," ",(0,h.jsx)("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",style:{color:"blue"},children:"here"})]}),(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{}),(0,h.jsx)(sS.Z,{}),(0,h.jsx)(sS.Z,{children:"Slack Webhook URL"})]})}),(0,h.jsx)(sZ.Z,{children:Object.entries(J).map((e,s)=>{let[t,l]=e;return(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:"region_outage_alerts"==t?a?(0,h.jsx)(tB.Z,{id:"switch",name:"switch",checked:Y(t),onChange:()=>G(t)}):(0,h.jsx)(P.Z,{className:"flex items-center justify-center",children:(0,h.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})}):(0,h.jsx)(tB.Z,{id:"switch",name:"switch",checked:Y(t),onChange:()=>G(t)})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(O.Z,{children:l})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(A.Z,{name:t,type:"password",defaultValue:v&&v[t]?v[t]:j})})]},s)})})]}),(0,h.jsx)(P.Z,{size:"xs",className:"mt-2",onClick:()=>{if(!s)return;let e={};Object.entries(J).forEach(s=>{let[t,l]=s,a=document.querySelector('input[name="'.concat(t,'"]')),r=(null==a?void 0:a.value)||"";e[t]=r});try{(0,y.K_)(s,{general_settings:{alert_to_webhook_url:e,alert_types:b}})}catch(e){z.ZP.error("Failed to update alerts: "+e,20)}z.ZP.success("Alerts updated successfully")},children:"Save Changes"}),(0,h.jsx)(P.Z,{onClick:()=>(0,y.jE)(s,"slack"),className:"mx-2",children:"Test Alerts"})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lD,{accessToken:s,premiumUser:a})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lO,{accessToken:s,premiumUser:a,alerts:i})})]})]})}),(0,h.jsxs)(q.Z,{title:"Add Logging Callback",visible:Z,width:800,onCancel:()=>w(!1),footer:null,children:[(0,h.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/logging",className:"mb-8 mt-4",target:"_blank",style:{color:"blue"},children:[" ","LiteLLM Docs: Logging"]}),(0,h.jsx)(R.Z,{form:u,onFinish:$,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(lF.Z,{label:"Callback",name:"callback",rules:[{required:!0,message:"Please select a callback"}],children:(0,h.jsx)(F.default,{onChange:e=>{let s=k[e];s&&X(s)},children:Object.entries(o).map(e=>{var s;let[t,l]=e;return(0,h.jsx)(ej.Z,{value:eu[t],children:(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(null===(s=ex[l])||void 0===s?void 0:s.logo)?(0,h.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,h.jsx)("img",{src:ex[l].logo,alt:"".concat(t," logo"),className:"w-5 h-5",onError:e=>{e.currentTarget.style.display="none"}})}):(0,h.jsx)("div",{className:"w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",children:l.charAt(0).toUpperCase()}),(0,h.jsx)("span",{children:l})]})},l)})})}),C&&C.map(e=>(0,h.jsx)(lF.Z,{label:e,name:e,rules:[{required:!0,message:"Please enter the value for "+e}],children:(0,h.jsx)(A.Z,{type:"password"})},e)),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Save"})})]})})]}),(0,h.jsx)(q.Z,{visible:E,width:800,title:"Edit ".concat(null==M?void 0:M.name," Settings"),onCancel:()=>L(!1),footer:null,children:(0,h.jsxs)(R.Z,{form:u,onFinish:W,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsx)(h.Fragment,{children:M&&M.variables&&Object.entries(M.variables).map(e=>{let[s,t]=e;return(0,h.jsx)(lF.Z,{label:s,name:s,children:(0,h.jsx)(A.Z,{type:"password",defaultValue:t})},s)})}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Save"})})]})}),(0,h.jsx)(q.Z,{title:"Confirm Delete",visible:U,onOk:ee,onCancel:()=>{K(!1),H(null)},okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},children:(0,h.jsxs)("p",{children:["Are you sure you want to delete the callback - ",B,"? This action cannot be undone."]})})]}):null},lU=t(92414),lV=t(46030);let{Option:lK}=F.default;var lB=e=>{let{models:s,accessToken:t,routerSettings:l,setRouterSettings:a}=e,[r]=R.Z.useForm(),[n,i]=(0,x.useState)(!1),[o,c]=(0,x.useState)("");return(0,h.jsxs)("div",{children:[(0,h.jsx)(P.Z,{className:"mx-auto",onClick:()=>i(!0),children:"+ Add Fallbacks"}),(0,h.jsx)(q.Z,{title:"Add Fallbacks",visible:n,width:800,footer:null,onOk:()=>{i(!1),r.resetFields()},onCancel:()=>{i(!1),r.resetFields()},children:(0,h.jsxs)(R.Z,{form:r,onFinish:e=>{console.log(e);let{model_name:s,models:n}=e,o=[...l.fallbacks||[],{[s]:n}],c={...l,fallbacks:o};console.log(c);try{(0,y.K_)(t,{router_settings:c}),a(c)}catch(e){z.ZP.error("Failed to update router settings: "+e,20)}z.ZP.success("router settings updated successfully"),i(!1),r.resetFields()},labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{label:"Public Model Name",name:"model_name",rules:[{required:!0,message:"Set the model to fallback for"}],help:"required",children:(0,h.jsx)(e0.Z,{defaultValue:o,children:s&&s.map((e,s)=>(0,h.jsx)(ej.Z,{value:e,onClick:()=>c(e),children:e},s))})}),(0,h.jsx)(R.Z.Item,{label:"Fallback Models",name:"models",rules:[{required:!0,message:"Please select a model"}],help:"required",children:(0,h.jsx)(lU.Z,{value:s,children:s&&s.filter(e=>e!=o).map(e=>(0,h.jsx)(lV.Z,{value:e,children:e},e))})})]}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Add Fallbacks"})})]})})]})},lH=t(26433);async function lG(e,s){console.log=function(){},console.log("isLocal:",!1);let t=window.location.origin,l=new lH.ZP.OpenAI({apiKey:s,baseURL:t,dangerouslyAllowBrowser:!0});try{let s=await l.chat.completions.create({model:e,messages:[{role:"user",content:"Hi, this is a test message"}],mock_testing_fallbacks:!0});z.ZP.success((0,h.jsxs)("span",{children:["Test model=",(0,h.jsx)("strong",{children:e}),", received model=",(0,h.jsx)("strong",{children:s.model}),". See"," ",(0,h.jsx)("a",{href:"#",onClick:()=>window.open("https://docs.litellm.ai/docs/proxy/reliability","_blank"),style:{textDecoration:"underline",color:"blue"},children:"curl"})]}))}catch(e){z.ZP.error("Error occurred while generating model response. Please try again. Error: ".concat(e),20)}}let lJ={ttl:3600,lowest_latency_buffer:0},lY=e=>{let{selectedStrategy:s,strategyArgs:t,paramExplanation:l}=e;return(0,h.jsxs)(T.Z,{children:[(0,h.jsx)(L.Z,{className:"text-sm font-medium text-tremor-content-strong dark:text-dark-tremor-content-strong",children:"Routing Strategy Specific Args"}),(0,h.jsx)(E.Z,{children:"latency-based-routing"==s?(0,h.jsx)(eo.Z,{children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Setting"}),(0,h.jsx)(sS.Z,{children:"Value"})]})}),(0,h.jsx)(sZ.Z,{children:Object.entries(t).map(e=>{let[s,t]=e;return(0,h.jsxs)(sC.Z,{children:[(0,h.jsxs)(sw.Z,{children:[(0,h.jsx)(O.Z,{children:s}),(0,h.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:l[s]})]}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(A.Z,{name:s,defaultValue:"object"==typeof t?JSON.stringify(t,null,2):t.toString()})})]},s)})})]})}):(0,h.jsx)(O.Z,{children:"No specific settings"})})]})};var lW=e=>{let{accessToken:s,userRole:t,userID:l,modelData:a}=e,[r,n]=(0,x.useState)({}),[i,o]=(0,x.useState)({}),[c,d]=(0,x.useState)([]),[m,u]=(0,x.useState)(!1),[p]=R.Z.useForm(),[g,j]=(0,x.useState)(null),[f,v]=(0,x.useState)(null),[_,b]=(0,x.useState)(null),N={routing_strategy_args:"(dict) Arguments to pass to the routing strategy",routing_strategy:"(string) Routing strategy to use",allowed_fails:"(int) Number of times a deployment can fail before being added to cooldown",cooldown_time:"(int) time in seconds to cooldown a deployment after failure",num_retries:"(int) Number of retries for failed requests. Defaults to 0.",timeout:"(float) Timeout for requests. Defaults to None.",retry_after:"(int) Minimum time to wait before retrying a failed request",ttl:"(int) Sliding window to look back over when calculating the average latency of a deployment. Default - 1 hour (in seconds).",lowest_latency_buffer:"(float) Shuffle between deployments within this % of the lowest latency. Default - 0 (i.e. always pick lowest latency)."};(0,x.useEffect)(()=>{s&&t&&l&&((0,y.BL)(s,l,t).then(e=>{console.log("callbacks",e);let s=e.router_settings;"model_group_retry_policy"in s&&delete s.model_group_retry_policy,n(s)}),(0,y.YU)(s).then(e=>{d(e)}))},[s,t,l]);let Z=async e=>{if(!s)return;console.log("received key: ".concat(e)),console.log("routerSettings['fallbacks']: ".concat(r.fallbacks));let t=r.fallbacks.map(s=>(e in s&&delete s[e],s)).filter(e=>Object.keys(e).length>0),l={...r,fallbacks:t};try{await (0,y.K_)(s,{router_settings:l}),n(l),z.ZP.success("Router settings updated successfully")}catch(e){z.ZP.error("Failed to update router settings: "+e,20)}},w=(e,s)=>{d(c.map(t=>t.field_name===e?{...t,field_value:s}:t))},k=(e,t)=>{if(!s)return;let l=c[t].field_value;if(null!=l&&void 0!=l)try{(0,y.jA)(s,e,l);let t=c.map(s=>s.field_name===e?{...s,stored_in_db:!0}:s);d(t)}catch(e){}},S=(e,t)=>{if(s)try{(0,y.ao)(s,e);let t=c.map(s=>s.field_name===e?{...s,stored_in_db:null,field_value:null}:s);d(t)}catch(e){}},T=e=>{if(!s)return;console.log("router_settings",e);let t=Object.fromEntries(Object.entries(e).map(e=>{let[s,t]=e;if("routing_strategy_args"!==s&&"routing_strategy"!==s){var l;return[s,(null===(l=document.querySelector('input[name="'.concat(s,'"]')))||void 0===l?void 0:l.value)||t]}if("routing_strategy"==s)return[s,f];if("routing_strategy_args"==s&&"latency-based-routing"==f){let e={},s=document.querySelector('input[name="lowest_latency_buffer"]'),t=document.querySelector('input[name="ttl"]');return(null==s?void 0:s.value)&&(e.lowest_latency_buffer=Number(s.value)),(null==t?void 0:t.value)&&(e.ttl=Number(t.value)),console.log("setRoutingStrategyArgs: ".concat(e)),["routing_strategy_args",e]}return null}).filter(e=>null!=e));console.log("updatedVariables",t);try{(0,y.K_)(s,{router_settings:t})}catch(e){z.ZP.error("Failed to update router settings: "+e,20)}z.ZP.success("router settings updated successfully")};return s?(0,h.jsx)("div",{className:"w-full mx-4",children:(0,h.jsxs)(e4.Z,{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,h.jsxs)(e5.Z,{variant:"line",defaultValue:"1",children:[(0,h.jsx)(e2.Z,{value:"1",children:"Loadbalancing"}),(0,h.jsx)(e2.Z,{value:"2",children:"Fallbacks"}),(0,h.jsx)(e2.Z,{value:"3",children:"General"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:[(0,h.jsx)(M.Z,{children:"Router Settings"}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Setting"}),(0,h.jsx)(sS.Z,{children:"Value"})]})}),(0,h.jsx)(sZ.Z,{children:Object.entries(r).filter(e=>{let[s,t]=e;return"fallbacks"!=s&&"context_window_fallbacks"!=s&&"routing_strategy_args"!=s}).map(e=>{let[s,t]=e;return(0,h.jsxs)(sC.Z,{children:[(0,h.jsxs)(sw.Z,{children:[(0,h.jsx)(O.Z,{children:s}),(0,h.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:N[s]})]}),(0,h.jsx)(sw.Z,{children:"routing_strategy"==s?(0,h.jsxs)(e0.Z,{defaultValue:t,className:"w-full max-w-md",onValueChange:v,children:[(0,h.jsx)(ej.Z,{value:"usage-based-routing",children:"usage-based-routing"}),(0,h.jsx)(ej.Z,{value:"latency-based-routing",children:"latency-based-routing"}),(0,h.jsx)(ej.Z,{value:"simple-shuffle",children:"simple-shuffle"})]}):(0,h.jsx)(A.Z,{name:s,defaultValue:"object"==typeof t?JSON.stringify(t,null,2):t.toString()})})]},s)})})]}),(0,h.jsx)(lY,{selectedStrategy:f,strategyArgs:r&&r.routing_strategy_args&&Object.keys(r.routing_strategy_args).length>0?r.routing_strategy_args:lJ,paramExplanation:N})]}),(0,h.jsx)(C.Z,{children:(0,h.jsx)(P.Z,{className:"mt-2",onClick:()=>T(r),children:"Save Changes"})})]})}),(0,h.jsxs)(e6.Z,{children:[(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Model Name"}),(0,h.jsx)(sS.Z,{children:"Fallbacks"})]})}),(0,h.jsx)(sZ.Z,{children:r.fallbacks&&r.fallbacks.map((e,t)=>Object.entries(e).map(e=>{let[l,a]=e;return(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:l}),(0,h.jsx)(sw.Z,{children:Array.isArray(a)?a.join(", "):a}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(P.Z,{onClick:()=>lG(l,s),children:"Test Fallback"})}),(0,h.jsx)(sw.Z,{children:(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>Z(l)})})]},t.toString()+l)}))})]}),(0,h.jsx)(lB,{models:(null==a?void 0:a.data)?a.data.map(e=>e.model_name):[],accessToken:s,routerSettings:r,setRouterSettings:n})]}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(eo.Z,{children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Setting"}),(0,h.jsx)(sS.Z,{children:"Value"}),(0,h.jsx)(sS.Z,{children:"Status"}),(0,h.jsx)(sS.Z,{children:"Action"})]})}),(0,h.jsx)(sZ.Z,{children:c.filter(e=>"TypedDictionary"!==e.field_type).map((e,s)=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsxs)(sw.Z,{children:[(0,h.jsx)(O.Z,{children:e.field_name}),(0,h.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:e.field_description})]}),(0,h.jsx)(sw.Z,{children:"Integer"==e.field_type?(0,h.jsx)(W.Z,{step:1,value:e.field_value,onChange:s=>w(e.field_name,s)}):null}),(0,h.jsx)(sw.Z,{children:!0==e.stored_in_db?(0,h.jsx)(e1.Z,{icon:eA.Z,className:"text-white",children:"In DB"}):!1==e.stored_in_db?(0,h.jsx)(e1.Z,{className:"text-gray bg-white outline",children:"In Config"}):(0,h.jsx)(e1.Z,{className:"text-gray bg-white outline",children:"Not Set"})}),(0,h.jsxs)(sw.Z,{children:[(0,h.jsx)(P.Z,{onClick:()=>k(e.field_name,s),children:"Update"}),(0,h.jsx)(sb.Z,{icon:em.Z,color:"red",onClick:()=>S(e.field_name,s),children:"Reset"})]})]},s))})]})})})]})]})}):null},l$=e=>{let{isModalVisible:s,accessToken:t,setIsModalVisible:l,setBudgetList:a}=e,[r]=R.Z.useForm(),n=async e=>{if(null!=t&&void 0!=t)try{z.ZP.info("Making API Call");let s=await (0,y.Zr)(t,e);console.log("key create Response:",s),a(e=>e?[...e,s]:[s]),z.ZP.success("Budget Created"),r.resetFields()}catch(e){console.error("Error creating the key:",e),z.ZP.error("Error creating the key: ".concat(e),20)}};return(0,h.jsx)(q.Z,{title:"Create Budget",visible:s,width:800,footer:null,onOk:()=>{l(!1),r.resetFields()},onCancel:()=>{l(!1),r.resetFields()},children:(0,h.jsxs)(R.Z,{form:r,onFinish:n,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{label:"Budget ID",name:"budget_id",rules:[{required:!0,message:"Please input a human-friendly name for the budget"}],help:"A human-friendly name for the budget",children:(0,h.jsx)(A.Z,{placeholder:""})}),(0,h.jsx)(R.Z.Item,{label:"Max Tokens per minute",name:"tpm_limit",help:"Default is model limit.",children:(0,h.jsx)(W.Z,{step:1,precision:2,width:200})}),(0,h.jsx)(R.Z.Item,{label:"Max Requests per minute",name:"rpm_limit",help:"Default is model limit.",children:(0,h.jsx)(W.Z,{step:1,precision:2,width:200})}),(0,h.jsxs)(T.Z,{className:"mt-20 mb-8",children:[(0,h.jsx)(L.Z,{children:(0,h.jsx)("b",{children:"Optional Settings"})}),(0,h.jsxs)(E.Z,{children:[(0,h.jsx)(R.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,h.jsx)(W.Z,{step:.01,precision:2,width:200})}),(0,h.jsx)(R.Z.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",children:(0,h.jsxs)(F.default,{defaultValue:null,placeholder:"n/a",children:[(0,h.jsx)(F.default.Option,{value:"24h",children:"daily"}),(0,h.jsx)(F.default.Option,{value:"7d",children:"weekly"}),(0,h.jsx)(F.default.Option,{value:"30d",children:"monthly"})]})})]})]})]}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Create Budget"})})]})})},lX=e=>{let{isModalVisible:s,accessToken:t,setIsModalVisible:l,setBudgetList:a,existingBudget:r,handleUpdateCall:n}=e;console.log("existingBudget",r);let[i]=R.Z.useForm();(0,x.useEffect)(()=>{i.setFieldsValue(r)},[r,i]);let o=async e=>{if(null!=t&&void 0!=t)try{z.ZP.info("Making API Call"),l(!0);let s=await (0,y.qI)(t,e);a(e=>e?[...e,s]:[s]),z.ZP.success("Budget Updated"),i.resetFields(),n()}catch(e){console.error("Error creating the key:",e),z.ZP.error("Error creating the key: ".concat(e),20)}};return(0,h.jsx)(q.Z,{title:"Edit Budget",visible:s,width:800,footer:null,onOk:()=>{l(!1),i.resetFields()},onCancel:()=>{l(!1),i.resetFields()},children:(0,h.jsxs)(R.Z,{form:i,onFinish:o,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",initialValues:r,children:[(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{label:"Budget ID",name:"budget_id",rules:[{required:!0,message:"Please input a human-friendly name for the budget"}],help:"A human-friendly name for the budget",children:(0,h.jsx)(A.Z,{placeholder:""})}),(0,h.jsx)(R.Z.Item,{label:"Max Tokens per minute",name:"tpm_limit",help:"Default is model limit.",children:(0,h.jsx)(W.Z,{step:1,precision:2,width:200})}),(0,h.jsx)(R.Z.Item,{label:"Max Requests per minute",name:"rpm_limit",help:"Default is model limit.",children:(0,h.jsx)(W.Z,{step:1,precision:2,width:200})}),(0,h.jsxs)(T.Z,{className:"mt-20 mb-8",children:[(0,h.jsx)(L.Z,{children:(0,h.jsx)("b",{children:"Optional Settings"})}),(0,h.jsxs)(E.Z,{children:[(0,h.jsx)(R.Z.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,h.jsx)(W.Z,{step:.01,precision:2,width:200})}),(0,h.jsx)(R.Z.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",children:(0,h.jsxs)(F.default,{defaultValue:null,placeholder:"n/a",children:[(0,h.jsx)(F.default.Option,{value:"24h",children:"daily"}),(0,h.jsx)(F.default.Option,{value:"7d",children:"weekly"}),(0,h.jsx)(F.default.Option,{value:"30d",children:"monthly"})]})})]})]})]}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(V.ZP,{htmlType:"submit",children:"Save"})})]})})},lQ=t(17906),l0=e=>{let{accessToken:s}=e,[t,l]=(0,x.useState)(!1),[a,r]=(0,x.useState)(!1),[n,i]=(0,x.useState)(null),[o,c]=(0,x.useState)([]);(0,x.useEffect)(()=>{s&&(0,y.O3)(s).then(e=>{c(e)})},[s]);let d=async(e,t)=>{console.log("budget_id",e),null!=s&&(i(o.find(s=>s.budget_id===e)||null),r(!0))},m=async(e,t)=>{if(null==s)return;z.ZP.info("Request made"),await (0,y.NV)(s,e);let l=[...o];l.splice(t,1),c(l),z.ZP.success("Budget Deleted.")},u=async()=>{null!=s&&(0,y.O3)(s).then(e=>{c(e)})};return(0,h.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[(0,h.jsx)(P.Z,{size:"sm",variant:"primary",className:"mb-2",onClick:()=>l(!0),children:"+ Create Budget"}),(0,h.jsx)(l$,{accessToken:s,isModalVisible:t,setIsModalVisible:l,setBudgetList:c}),n&&(0,h.jsx)(lX,{accessToken:s,isModalVisible:a,setIsModalVisible:r,setBudgetList:c,existingBudget:n,handleUpdateCall:u}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Create a budget to assign to customers."}),(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Budget ID"}),(0,h.jsx)(sS.Z,{children:"Max Budget"}),(0,h.jsx)(sS.Z,{children:"TPM"}),(0,h.jsx)(sS.Z,{children:"RPM"})]})}),(0,h.jsx)(sZ.Z,{children:o.slice().sort((e,s)=>new Date(s.updated_at).getTime()-new Date(e.updated_at).getTime()).map((e,s)=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:e.budget_id}),(0,h.jsx)(sw.Z,{children:e.max_budget?e.max_budget:"n/a"}),(0,h.jsx)(sw.Z,{children:e.tpm_limit?e.tpm_limit:"n/a"}),(0,h.jsx)(sw.Z,{children:e.rpm_limit?e.rpm_limit:"n/a"}),(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>d(e.budget_id,s)}),(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>m(e.budget_id,s)})]},s))})]})]}),(0,h.jsxs)("div",{className:"mt-5",children:[(0,h.jsx)(O.Z,{className:"text-base",children:"How to use budget id"}),(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{children:[(0,h.jsx)(e2.Z,{children:"Assign Budget to Customer"}),(0,h.jsx)(e2.Z,{children:"Test it (Curl)"}),(0,h.jsx)(e2.Z,{children:"Test it (OpenAI SDK)"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lQ.Z,{language:"bash",children:"\ncurl -X POST --location '<your_proxy_base_url>/end_user/new' \n-H 'Authorization: Bearer <your-master-key>' \n-H 'Content-Type: application/json' \n-d '{\"user_id\": \"my-customer-id', \"budget_id\": \"<BUDGET_ID>\"}' # \uD83D\uDC48 KEY CHANGE\n\n            "})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lQ.Z,{language:"bash",children:'\ncurl -X POST --location \'<your_proxy_base_url>/chat/completions\' \n-H \'Authorization: Bearer <your-master-key>\' \n-H \'Content-Type: application/json\' \n-d \'{\n  "model": "gpt-3.5-turbo\', \n  "messages":[{"role": "user", "content": "Hey, how\'s it going?"}],\n  "user": "my-customer-id"\n}\' # \uD83D\uDC48 KEY CHANGE\n\n            '})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lQ.Z,{language:"python",children:'from openai import OpenAI\nclient = OpenAI(\n  base_url="<your_proxy_base_url>",\n  api_key="<your_proxy_key>"\n)\n\ncompletion = client.chat.completions.create(\n  model="gpt-3.5-turbo",\n  messages=[\n    {"role": "system", "content": "You are a helpful assistant."},\n    {"role": "user", "content": "Hello!"}\n  ],\n  user="my-customer-id"\n)\n\nprint(completion.choices[0].message)'})})]})]})]})]})},l1=t(77398),l2=t.n(l1);let l4=e=>{try{return new Date(e).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).replace(",","")}catch(e){return"Error converting time"}},l5=e=>{let{utcTime:s}=e;return(0,h.jsx)("span",{style:{fontFamily:"monospace",width:"180px",display:"inline-block"},children:l4(s)})},l6=(e,s)=>{var t,l;return(null===(l=e.metadata)||void 0===l?void 0:null===(t=l.mcp_tool_call_metadata)||void 0===t?void 0:t.mcp_server_logo_url)?e.metadata.mcp_tool_call_metadata.mcp_server_logo_url:s?sq(s).logo:""},l3=[{id:"expander",header:()=>null,cell:e=>{let{row:s}=e;return(0,h.jsx)(()=>{let[e,t]=x.useState(s.getIsExpanded()),l=x.useCallback(()=>{t(e=>!e),s.getToggleExpandedHandler()()},[s]);return s.getCanExpand()?(0,h.jsx)("button",{onClick:l,style:{cursor:"pointer"},"aria-label":e?"Collapse row":"Expand row",className:"w-6 h-6 flex items-center justify-center focus:outline-none",children:(0,h.jsx)("svg",{className:"w-4 h-4 transform transition-transform duration-75 ".concat(e?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):(0,h.jsx)("span",{className:"w-6 h-6 flex items-center justify-center",children:"●"})},{})}},{header:"Time",accessorKey:"startTime",cell:e=>(0,h.jsx)(l5,{utcTime:e.getValue()})},{header:"Status",accessorKey:"metadata.status",cell:e=>{let s="failure"!==(e.getValue()||"Success").toLowerCase();return(0,h.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat(s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s?"Success":"Failure"})}},{header:"Session ID",accessorKey:"session_id",cell:e=>{let s=String(e.getValue()||""),t=e.row.original.onSessionClick;return(0,h.jsx)(X.Z,{title:String(e.getValue()||""),children:(0,h.jsx)(P.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal text-xs max-w-[15ch] truncate block",onClick:()=>null==t?void 0:t(s),children:String(e.getValue()||"")})})}},{header:"Request ID",accessorKey:"request_id",cell:e=>(0,h.jsx)(X.Z,{title:String(e.getValue()||""),children:(0,h.jsx)("span",{className:"font-mono text-xs max-w-[15ch] truncate block",children:String(e.getValue()||"")})})},{header:"Cost",accessorKey:"spend",cell:e=>(0,h.jsxs)("span",{children:["$",eH(e.getValue()||0,4)]})},{header:"Duration",accessorKey:"duration",cell:e=>(0,h.jsx)(X.Z,{title:String(e.getValue()||"-"),children:(0,h.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Team Name",accessorKey:"metadata.user_api_key_team_alias",cell:e=>(0,h.jsx)(X.Z,{title:String(e.getValue()||"-"),children:(0,h.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Key Hash",accessorKey:"metadata.user_api_key",cell:e=>{let s=String(e.getValue()||"-"),t=e.row.original.onKeyHashClick;return(0,h.jsx)(X.Z,{title:s,children:(0,h.jsx)("span",{className:"font-mono max-w-[15ch] truncate block cursor-pointer hover:text-blue-600",onClick:()=>null==t?void 0:t(s),children:s})})}},{header:"Key Name",accessorKey:"metadata.user_api_key_alias",cell:e=>(0,h.jsx)(X.Z,{title:String(e.getValue()||"-"),children:(0,h.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Model",accessorKey:"model",cell:e=>{let s=e.row.original,t=s.custom_llm_provider,l=String(e.getValue()||"");return(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,h.jsx)("img",{src:l6(s,t),alt:"",className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,h.jsx)(X.Z,{title:l,children:(0,h.jsx)("span",{className:"max-w-[15ch] truncate block",children:l})})]})}},{header:"Tokens",accessorKey:"total_tokens",cell:e=>{let s=e.row.original;return(0,h.jsxs)("span",{className:"text-sm",children:[String(s.total_tokens||"0"),(0,h.jsxs)("span",{className:"text-gray-400 text-xs ml-1",children:["(",String(s.prompt_tokens||"0"),"+",String(s.completion_tokens||"0"),")"]})]})}},{header:"Internal User",accessorKey:"user",cell:e=>(0,h.jsx)(X.Z,{title:String(e.getValue()||"-"),children:(0,h.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"End User",accessorKey:"end_user",cell:e=>(0,h.jsx)(X.Z,{title:String(e.getValue()||"-"),children:(0,h.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Tags",accessorKey:"request_tags",cell:e=>{let s=e.getValue();if(!s||0===Object.keys(s).length)return"-";let t=Object.entries(s),l=t[0],a=t.slice(1);return(0,h.jsx)("div",{className:"flex flex-wrap gap-1",children:(0,h.jsx)(X.Z,{title:(0,h.jsx)("div",{className:"flex flex-col gap-1",children:t.map(e=>{let[s,t]=e;return(0,h.jsxs)("span",{children:[s,": ",String(t)]},s)})}),children:(0,h.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[l[0],": ",String(l[1]),a.length>0&&" +".concat(a.length)]})})})}}],l8=e=>(0,h.jsx)(e1.Z,{color:"gray",className:"flex items-center gap-1",children:(0,h.jsx)("span",{className:"whitespace-nowrap text-xs",children:e})}),l7=[{id:"expander",header:()=>null,cell:e=>{let{row:s}=e;return(0,h.jsx)(()=>{let[e,t]=x.useState(s.getIsExpanded()),l=x.useCallback(()=>{t(e=>!e),s.getToggleExpandedHandler()()},[s]);return s.getCanExpand()?(0,h.jsx)("button",{onClick:l,style:{cursor:"pointer"},"aria-label":e?"Collapse row":"Expand row",className:"w-6 h-6 flex items-center justify-center focus:outline-none",children:(0,h.jsx)("svg",{className:"w-4 h-4 transform transition-transform ".concat(e?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):(0,h.jsx)("span",{className:"w-6 h-6 flex items-center justify-center",children:"●"})},{})}},{header:"Timestamp",accessorKey:"updated_at",cell:e=>(0,h.jsx)(l5,{utcTime:e.getValue()})},{header:"Table Name",accessorKey:"table_name",cell:e=>{let s=e.getValue(),t=s;switch(s){case"LiteLLM_VerificationToken":t="Keys";break;case"LiteLLM_TeamTable":t="Teams";break;case"LiteLLM_OrganizationTable":t="Organizations";break;case"LiteLLM_UserTable":t="Users";break;case"LiteLLM_ProxyModelTable":t="Models";break;default:t=s}return(0,h.jsx)("span",{children:t})}},{header:"Action",accessorKey:"action",cell:e=>(0,h.jsx)("span",{children:l8(e.getValue())})},{header:"Changed By",accessorKey:"changed_by",cell:e=>{let s=e.row.original.changed_by,t=e.row.original.changed_by_api_key;return(0,h.jsxs)("div",{className:"space-y-1",children:[(0,h.jsx)("div",{className:"font-medium",children:s}),t&&(0,h.jsx)(X.Z,{title:t,children:(0,h.jsxs)("div",{className:"text-xs text-muted-foreground max-w-[15ch] truncate",children:[" ",t]})})]})}},{header:"Affected Item ID",accessorKey:"object_id",cell:e=>(0,h.jsx)(()=>{let s=e.getValue(),[t,l]=(0,x.useState)(!1);if(!s)return(0,h.jsx)(h.Fragment,{children:"-"});let a=async()=>{try{await navigator.clipboard.writeText(String(s)),l(!0),setTimeout(()=>l(!1),1500)}catch(e){console.error("Failed to copy object ID: ",e)}};return(0,h.jsx)(X.Z,{title:t?"Copied!":String(s),children:(0,h.jsx)("span",{className:"max-w-[20ch] truncate block cursor-pointer hover:text-blue-600",onClick:a,children:String(s)})})},{})}],l9=async(e,s,t,l)=>{console.log("prefetchLogDetails called with",e.length,"logs");let a=e.map(e=>{if(e.request_id)return console.log("Prefetching details for request_id:",e.request_id),l.prefetchQuery({queryKey:["logDetails",e.request_id,s],queryFn:async()=>{console.log("Fetching details for",e.request_id);let l=await (0,y.qk)(t,e.request_id,s);return console.log("Received details for",e.request_id,":",l?"success":"failed"),l},staleTime:6e5,gcTime:6e5})});try{let e=await Promise.all(a);return console.log("All prefetch promises completed:",e.length),e}catch(e){throw console.error("Error in prefetchLogDetails:",e),e}};function ae(e){let{row:s,hasMessages:t,hasResponse:l,hasError:a,errorInfo:r,getRawRequest:n,formattedResponse:i}=e,o=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select();let t=document.execCommand("copy");if(document.body.removeChild(s),!t)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}},c=async()=>{await o(JSON.stringify(n(),null,2))?z.ZP.success("Request copied to clipboard"):z.ZP.error("Failed to copy request")},d=async()=>{await o(JSON.stringify(i(),null,2))?z.ZP.success("Response copied to clipboard"):z.ZP.error("Failed to copy response")};return(0,h.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,h.jsx)("h3",{className:"text-lg font-medium",children:"Request"}),(0,h.jsx)("button",{onClick:c,className:"p-1 hover:bg-gray-200 rounded",title:"Copy request",children:(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,h.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,h.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,h.jsx)("div",{className:"p-4 overflow-auto max-h-96",children:(0,h.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(n(),null,2)})})]}),(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,h.jsxs)("h3",{className:"text-lg font-medium",children:["Response",a&&(0,h.jsxs)("span",{className:"ml-2 text-sm text-red-600",children:["• HTTP code ",(null==r?void 0:r.error_code)||400]})]}),(0,h.jsx)("button",{onClick:d,className:"p-1 hover:bg-gray-200 rounded",title:"Copy response",disabled:!l,children:(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,h.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,h.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,h.jsx)("div",{className:"p-4 overflow-auto max-h-96 bg-gray-50",children:l?(0,h.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(i(),null,2)}):(0,h.jsx)("div",{className:"text-gray-500 text-sm italic text-center py-4",children:"Response data not available"})})]})]})}let as=e=>{var s;let{errorInfo:t}=e,[l,a]=x.useState({}),[r,n]=x.useState(!1),i=e=>{a(s=>({...s,[e]:!s[e]}))},o=t.traceback&&(s=t.traceback)?Array.from(s.matchAll(/File "([^"]+)", line (\d+)/g)).map(e=>{let t=e[1],l=e[2],a=t.split("/").pop()||t,r=e.index||0,n=s.indexOf('File "',r+1),i=n>-1?s.substring(r,n).trim():s.substring(r).trim(),o=i.split("\n"),c="";return o.length>1&&(c=o[o.length-1].trim()),{filePath:t,fileName:a,lineNumber:l,code:c,inFunction:i.includes(" in ")?i.split(" in ")[1].split("\n")[0]:""}}):[];return(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,h.jsx)("div",{className:"p-4 border-b",children:(0,h.jsxs)("h3",{className:"text-lg font-medium flex items-center text-red-600",children:[(0,h.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Error Details"]})}),(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsxs)("div",{className:"bg-red-50 rounded-md p-4 mb-4",children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"text-red-800 font-medium w-20",children:"Type:"}),(0,h.jsx)("span",{className:"text-red-700",children:t.error_class||"Unknown Error"})]}),(0,h.jsxs)("div",{className:"flex mt-2",children:[(0,h.jsx)("span",{className:"text-red-800 font-medium w-20 flex-shrink-0",children:"Message:"}),(0,h.jsx)("span",{className:"text-red-700 break-words whitespace-pre-wrap",children:t.error_message||"Unknown error occurred"})]})]}),t.traceback&&(0,h.jsxs)("div",{className:"mt-4",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,h.jsx)("h4",{className:"font-medium",children:"Traceback"}),(0,h.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,h.jsx)("button",{onClick:()=>{let e=!r;if(n(e),o.length>0){let s={};o.forEach((t,l)=>{s[l]=e}),a(s)}},className:"text-gray-500 hover:text-gray-700 flex items-center text-sm",children:r?"Collapse All":"Expand All"}),(0,h.jsxs)("button",{onClick:()=>navigator.clipboard.writeText(t.traceback||""),className:"text-gray-500 hover:text-gray-700 flex items-center",title:"Copy traceback",children:[(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,h.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,h.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),(0,h.jsx)("span",{className:"ml-1",children:"Copy"})]})]})]}),(0,h.jsx)("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden shadow-sm",children:o.map((e,s)=>(0,h.jsxs)("div",{className:"border-b border-gray-200 last:border-b-0",children:[(0,h.jsxs)("div",{className:"px-4 py-2 flex items-center justify-between cursor-pointer hover:bg-gray-50",onClick:()=>i(s),children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("span",{className:"text-gray-400 mr-2 w-12 text-right",children:e.lineNumber}),(0,h.jsx)("span",{className:"text-gray-600 font-medium",children:e.fileName}),(0,h.jsx)("span",{className:"text-gray-500 mx-1",children:"in"}),(0,h.jsx)("span",{className:"text-indigo-600 font-medium",children:e.inFunction||e.fileName})]}),(0,h.jsx)("svg",{className:"w-5 h-5 text-gray-500 transition-transform ".concat(l[s]?"transform rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(l[s]||!1)&&e.code&&(0,h.jsx)("div",{className:"px-12 py-2 font-mono text-sm text-gray-800 bg-gray-50 overflow-x-auto border-t border-gray-100",children:e.code})]},s))})]})]})]})},at=e=>{let{show:s}=e;return s?(0,h.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start",children:[(0,h.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,h.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,h.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,h.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,h.jsxs)("div",{children:[(0,h.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Request/Response Data Not Available"}),(0,h.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["To view request and response details, enable prompt storage in your LiteLLM configuration by adding the following to your ",(0,h.jsx)("code",{className:"bg-blue-100 px-1 py-0.5 rounded",children:"proxy_config.yaml"})," file:"]}),(0,h.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"general_settings:\n  store_model_in_db: true\n  store_prompts_in_spend_logs: true"}),(0,h.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change."})]})]}):null};var al=t(35829);let aa=e=>{let{sessionId:s,logs:t,onBack:l}=e,[a,r]=(0,x.useState)(null),n=t.reduce((e,s)=>e+(s.spend||0),0),i=t.reduce((e,s)=>e+(s.total_tokens||0),0),o=t.length>0?new Date(t[0].startTime):new Date;return(((t.length>0?new Date(t[t.length-1].endTime):new Date).getTime()-o.getTime())/1e3).toFixed(2),t.map(e=>({time:new Date(e.startTime).toISOString(),tokens:e.total_tokens||0,cost:e.spend||0})),(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{className:"mb-8",children:[(0,h.jsx)("div",{className:"flex items-center space-x-4",children:(0,h.jsxs)("button",{onClick:l,className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[(0,h.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to All Logs"]})}),(0,h.jsxs)("div",{className:"mt-4",children:[(0,h.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Session Details"}),(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsx)("p",{className:"text-sm text-gray-500 font-mono",children:s}),(0,h.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/ui_logs_sessions",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:["Get started with session management here",(0,h.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Requests"}),(0,h.jsx)(al.Z,{children:t.length})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Cost"}),(0,h.jsxs)(al.Z,{children:["$",eH(n,4)]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Tokens"}),(0,h.jsx)(al.Z,{children:i})]})]}),(0,h.jsx)(M.Z,{children:"Session Logs"}),(0,h.jsx)("div",{className:"mt-4",children:(0,h.jsx)(t5,{columns:l3,data:t,renderSubComponent:am,getRowCanExpand:()=>!0,loadingMessage:"Loading logs...",noDataMessage:"No logs found"})})]})};function ar(e){let{data:s}=e,[t,l]=(0,x.useState)(!0),[a,r]=(0,x.useState)({});if(!s||0===s.length)return null;let n=e=>new Date(1e3*e).toLocaleString(),i=(e,s)=>"".concat(((s-e)*1e3).toFixed(2),"ms"),o=(e,s)=>{let t="".concat(e,"-").concat(s);r(e=>({...e,[t]:!e[t]}))};return(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center p-4 border-b cursor-pointer hover:bg-gray-50",onClick:()=>l(!t),children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("svg",{className:"w-5 h-5 mr-2 text-gray-600 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,h.jsx)("h3",{className:"text-lg font-medium",children:"Vector Store Requests"})]}),(0,h.jsx)("span",{className:"text-sm text-gray-500",children:t?"Click to collapse":"Click to expand"})]}),t&&(0,h.jsx)("div",{className:"p-4",children:s.map((e,s)=>(0,h.jsxs)("div",{className:"mb-6 last:mb-0",children:[(0,h.jsx)("div",{className:"bg-white rounded-lg border p-4 mb-4",children:(0,h.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Query:"}),(0,h.jsx)("span",{className:"font-mono",children:e.query})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Vector Store ID:"}),(0,h.jsx)("span",{className:"font-mono",children:e.vector_store_id})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,h.jsx)("span",{className:"flex items-center",children:(()=>{let{logo:s,displayName:t}=sq(e.custom_llm_provider);return(0,h.jsxs)(h.Fragment,{children:[s&&(0,h.jsx)("img",{src:s,alt:"".concat(t," logo"),className:"h-5 w-5 mr-2"}),t]})})()})]})]}),(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,h.jsx)("span",{children:n(e.start_time)})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,h.jsx)("span",{children:n(e.end_time)})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,h.jsx)("span",{children:i(e.start_time,e.end_time)})]})]})]})}),(0,h.jsx)("h4",{className:"font-medium mb-2",children:"Search Results"}),(0,h.jsx)("div",{className:"space-y-2",children:e.vector_store_search_response.data.map((e,t)=>{let l=a["".concat(s,"-").concat(t)]||!1;return(0,h.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,h.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 cursor-pointer",onClick:()=>o(s,t),children:[(0,h.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(l?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsxs)("span",{className:"font-medium mr-2",children:["Result ",t+1]}),(0,h.jsxs)("span",{className:"text-gray-500 text-sm",children:["Score: ",(0,h.jsx)("span",{className:"font-mono",children:e.score.toFixed(4)})]})]})]}),l&&(0,h.jsx)("div",{className:"p-3 border-t bg-white",children:e.content.map((e,s)=>(0,h.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,h.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:e.type}),(0,h.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all bg-gray-50 p-2 rounded",children:e.text})]},s))})]},t)})})]},s))})]})}function an(e){let{data:s}=e,[t,l]=(0,x.useState)(!0),[a,r]=(0,x.useState)(!0),[n,i]=(0,x.useState)({});if(!s)return null;let o=s.masked_entity_count?Object.values(s.masked_entity_count).reduce((e,s)=>e+s,0):0,c=e=>new Date(1e3*e).toLocaleString(),d=e=>{i(s=>({...s,[e]:!s[e]}))},m=e=>e>=.8?"text-green-600":"text-yellow-600";return(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center p-4 border-b cursor-pointer hover:bg-gray-50",onClick:()=>l(!t),children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("svg",{className:"w-5 h-5 mr-2 text-gray-600 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,h.jsx)("h3",{className:"text-lg font-medium",children:"Guardrail Information"}),(0,h.jsx)("span",{className:"ml-3 px-2 py-1 rounded-md text-xs font-medium inline-block ".concat("success"===s.guardrail_status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.guardrail_status}),o>0&&(0,h.jsxs)("span",{className:"ml-3 px-2 py-1 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[o," masked ",1===o?"entity":"entities"]})]}),(0,h.jsx)("span",{className:"text-sm text-gray-500",children:t?"Click to collapse":"Click to expand"})]}),t&&(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsxs)("div",{className:"bg-white rounded-lg border p-4 mb-4",children:[(0,h.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail Name:"}),(0,h.jsx)("span",{className:"font-mono",children:s.guardrail_name})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Mode:"}),(0,h.jsx)("span",{className:"font-mono",children:s.guardrail_mode})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,h.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat("success"===s.guardrail_status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.guardrail_status})]})]}),(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,h.jsx)("span",{children:c(s.start_time)})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,h.jsx)("span",{children:c(s.end_time)})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,h.jsxs)("span",{children:[s.duration.toFixed(4),"s"]})]})]})]}),s.masked_entity_count&&Object.keys(s.masked_entity_count).length>0&&(0,h.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,h.jsx)("h4",{className:"font-medium mb-2",children:"Masked Entity Summary"}),(0,h.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(s.masked_entity_count).map(e=>{let[s,t]=e;return(0,h.jsxs)("span",{className:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[s,": ",t]},s)})})]})]}),s.guardrail_response&&s.guardrail_response.length>0&&(0,h.jsxs)("div",{className:"mt-4",children:[(0,h.jsxs)("div",{className:"flex items-center mb-2 cursor-pointer",onClick:()=>r(!a),children:[(0,h.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(a?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,h.jsxs)("h4",{className:"font-medium",children:["Detected Entities (",s.guardrail_response.length,")"]})]}),a&&(0,h.jsx)("div",{className:"space-y-2",children:s.guardrail_response.map((e,s)=>{let t=n[s]||!1;return(0,h.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>d(s),children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,h.jsx)("span",{className:"font-medium mr-2",children:e.entity_type}),(0,h.jsxs)("span",{className:"font-mono ".concat(m(e.score)),children:["Score: ",e.score.toFixed(2)]})]}),(0,h.jsxs)("span",{className:"text-xs text-gray-500",children:["Position: ",e.start,"-",e.end]})]}),t&&(0,h.jsx)("div",{className:"p-3 border-t bg-white",children:(0,h.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Entity Type:"}),(0,h.jsx)("span",{children:e.entity_type})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Position:"}),(0,h.jsxs)("span",{children:["Characters ",e.start,"-",e.end]})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Confidence:"}),(0,h.jsx)("span",{className:m(e.score),children:e.score.toFixed(2)})]})]}),(0,h.jsxs)("div",{className:"space-y-2",children:[e.recognition_metadata&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Recognizer:"}),(0,h.jsx)("span",{children:e.recognition_metadata.recognizer_name})]}),(0,h.jsxs)("div",{className:"flex overflow-hidden",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Identifier:"}),(0,h.jsx)("span",{className:"truncate text-xs font-mono",children:e.recognition_metadata.recognizer_identifier})]})]}),e.analysis_explanation&&(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Explanation:"}),(0,h.jsx)("span",{children:e.analysis_explanation})]})]})]})})]},s)})})]})]})]})}let ai={TEAM_ID:"Team ID",KEY_HASH:"Key Hash",REQUEST_ID:"Request ID",MODEL:"Model",USER_ID:"User ID",STATUS:"Status",KEY_ALIAS:"Key Alias"};function ao(e){let{userID:s,userRole:t,token:l,accessToken:a,isActive:r,premiumUser:n,allTeams:i}=e,[o,c]=(0,x.useState)(l2()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),d=(0,x.useRef)(null),m=(0,x.useRef)(null),[u,p]=(0,x.useState)(1),[g]=(0,x.useState)(50),[j,f]=(0,x.useState)({}),[v,_]=(0,x.useState)(""),[b,N]=(0,x.useState)(""),[Z,w]=(0,x.useState)(""),[k,S]=(0,x.useState)("all"),[C,I]=(0,x.useState)("all"),[P,A]=(0,x.useState)(!1),[T,E]=(0,x.useState)(!1),L=(0,sp.a)({queryKey:["all_audit_logs",a,l,t,s,o],queryFn:async()=>{if(!a||!l||!t||!s)return[];let e=l2()(o).utc().format("YYYY-MM-DD HH:mm:ss"),r=l2()().utc().format("YYYY-MM-DD HH:mm:ss"),n=[],i=1,c=1;do{let s=await (0,y.nJ)(a,e,r,i,50);n=n.concat(s.audit_logs),c=s.total_pages,i++}while(i<=c);return n},enabled:!!a&&!!l&&!!t&&!!s&&r,refetchInterval:5e3,refetchIntervalInBackground:!0}),M=(0,x.useCallback)(async e=>{if(a)try{let s=(await (0,y.OD)(a,null,null,e,null,null,1,10)).keys.find(s=>s.key_alias===e);s?N(s.token):N("")}catch(e){console.error("Error fetching key hash for alias:",e),N("")}},[a]);(0,x.useEffect)(()=>{if(!a)return;let e=!1,s=!1;j["Team ID"]?v!==j["Team ID"]&&(_(j["Team ID"]),e=!0):""!==v&&(_(""),e=!0),j["Key Hash"]?b!==j["Key Hash"]&&(N(j["Key Hash"]),s=!0):j["Key Alias"]?M(j["Key Alias"]):""!==b&&(N(""),s=!0),(e||s)&&p(1)},[j,a,M,v,b]),(0,x.useEffect)(()=>{p(1)},[v,b,o,Z,k,C]),(0,x.useEffect)(()=>{function e(e){d.current&&!d.current.contains(e.target)&&A(!1),m.current&&!m.current.contains(e.target)&&E(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let D=(0,x.useMemo)(()=>L.data?L.data.filter(e=>{var s,t,l,a,r,n,i;let o=!0,c=!0,d=!0,m=!0,u=!0;if(v){let r="string"==typeof e.before_value?null===(s=JSON.parse(e.before_value))||void 0===s?void 0:s.team_id:null===(t=e.before_value)||void 0===t?void 0:t.team_id,n="string"==typeof e.updated_values?null===(l=JSON.parse(e.updated_values))||void 0===l?void 0:l.team_id:null===(a=e.updated_values)||void 0===a?void 0:a.team_id;o=r===v||n===v}if(b)try{let s="string"==typeof e.before_value?JSON.parse(e.before_value):e.before_value,t="string"==typeof e.updated_values?JSON.parse(e.updated_values):e.updated_values,l=null==s?void 0:s.token,a=null==t?void 0:t.token;c="string"==typeof l&&l.includes(b)||"string"==typeof a&&a.includes(b)}catch(e){c=!1}if(Z&&(d=null===(r=e.object_id)||void 0===r?void 0:r.toLowerCase().includes(Z.toLowerCase())),"all"!==k&&(m=(null===(n=e.action)||void 0===n?void 0:n.toLowerCase())===k.toLowerCase()),"all"!==C){let s="";switch(C){case"keys":s="litellm_verificationtoken";break;case"teams":s="litellm_teamtable";break;case"users":s="litellm_usertable";break;default:s=C}u=(null===(i=e.table_name)||void 0===i?void 0:i.toLowerCase())===s}return o&&c&&d&&m&&u}):[],[L.data,v,b,Z,k,C]),F=D.length,R=Math.ceil(F/g)||1,z=(0,x.useMemo)(()=>{let e=(u-1)*g,s=e+g;return D.slice(e,s)},[D,u,g]),q=!L.data||0===L.data.length,U=(0,x.useCallback)(e=>{let{row:s}=e;return(0,h.jsx)(e=>{let{rowData:s}=e,{before_value:t,updated_values:l,table_name:a,action:r}=s,n=(e,s)=>{if(!e||0===Object.keys(e).length)return(0,h.jsx)(O.Z,{children:"N/A"});if(s){let s=Object.keys(e),t=["token","spend","max_budget"];if(s.every(e=>t.includes(e))&&s.length>0)return(0,h.jsxs)("div",{children:[s.includes("token")&&(0,h.jsxs)("p",{children:[(0,h.jsx)("strong",{children:"Token:"})," ",e.token||"N/A"]}),s.includes("spend")&&(0,h.jsxs)("p",{children:[(0,h.jsx)("strong",{children:"Spend:"})," ",void 0!==e.spend?"$".concat(eH(e.spend,6)):"N/A"]}),s.includes("max_budget")&&(0,h.jsxs)("p",{children:[(0,h.jsx)("strong",{children:"Max Budget:"})," ",void 0!==e.max_budget?"$".concat(eH(e.max_budget,6)):"N/A"]})]});if(e["No differing fields detected in 'before' state"]||e["No differing fields detected in 'updated' state"]||e["No fields changed"])return(0,h.jsx)(O.Z,{children:e[Object.keys(e)[0]]})}return(0,h.jsx)("pre",{className:"p-2 bg-gray-50 border rounded text-xs overflow-auto max-h-60",children:JSON.stringify(e,null,2)})},i=t,o=l;if(("updated"===r||"rotated"===r)&&t&&l&&("LiteLLM_TeamTable"===a||"LiteLLM_UserTable"===a||"LiteLLM_VerificationToken"===a)){let e={},s={};new Set([...Object.keys(t),...Object.keys(l)]).forEach(a=>{JSON.stringify(t[a])!==JSON.stringify(l[a])&&(t.hasOwnProperty(a)&&(e[a]=t[a]),l.hasOwnProperty(a)&&(s[a]=l[a]))}),Object.keys(t).forEach(a=>{l.hasOwnProperty(a)||e.hasOwnProperty(a)||(e[a]=t[a],s[a]=void 0)}),Object.keys(l).forEach(a=>{t.hasOwnProperty(a)||s.hasOwnProperty(a)||(s[a]=l[a],e[a]=void 0)}),i=Object.keys(e).length>0?e:{"No differing fields detected in 'before' state":"N/A"},o=Object.keys(s).length>0?s:{"No differing fields detected in 'updated' state":"N/A"},0===Object.keys(e).length&&0===Object.keys(s).length&&(i={"No fields changed":"N/A"},o={"No fields changed":"N/A"})}return(0,h.jsxs)("div",{className:"-mx-4 p-4 bg-slate-100 border-y border-slate-300 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Before Value:"}),n(i,"LiteLLM_VerificationToken"===a)]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Updated Value:"}),n(o,"LiteLLM_VerificationToken"===a)]})]})},{rowData:s.original})},[]);if(!n)return(0,h.jsxs)("div",{style:{textAlign:"center",marginTop:"20px"},children:[(0,h.jsx)("h1",{style:{display:"block",marginBottom:"10px"},children:"✨ Enterprise Feature."}),(0,h.jsx)(O.Z,{style:{display:"block",marginBottom:"10px"},children:"This is a LiteLLM Enterprise feature, and requires a valid key to use."}),(0,h.jsx)(O.Z,{style:{display:"block",marginBottom:"20px",fontStyle:"italic"},children:"Here's a preview of what Audit Logs offer:"}),(0,h.jsx)("img",{src:"/audit-logs-preview.png",alt:"Audit Logs Preview",style:{maxWidth:"100%",maxHeight:"700px",border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",margin:"0 auto"}})]});let V=F>0?(u-1)*g+1:0,K=Math.min(u*g,F);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"flex items-center justify-between mb-4"}),(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,h.jsxs)("div",{className:"border-b px-6 py-4",children:[(0,h.jsx)("h1",{className:"text-xl font-semibold py-4",children:"Audit Logs"}),(0,h.jsx)(e=>{let{show:s}=e;return s?(0,h.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start mb-6",children:[(0,h.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,h.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,h.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,h.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,h.jsxs)("div",{children:[(0,h.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Audit Logs Not Available"}),(0,h.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"To enable audit logging, add the following configuration to your LiteLLM proxy configuration file:"}),(0,h.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"litellm_settings:\n  store_audit_logs: true"}),(0,h.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change and proxy restart."})]})]}):null},{show:q}),(0,h.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:[(0,h.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{className:"flex items-center",children:(0,h.jsx)("input",{type:"text",placeholder:"Search by Object ID...",value:Z,onChange:e=>w(e.target.value),className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,h.jsxs)("button",{onClick:()=>{L.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,h.jsx)("svg",{className:"w-4 h-4 ".concat(L.isFetching?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,h.jsx)("span",{children:"Refresh"})]})]})}),(0,h.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,h.jsxs)("div",{className:"relative",ref:d,children:[(0,h.jsx)("label",{htmlFor:"actionFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Action:"}),(0,h.jsxs)("button",{id:"actionFilterDisplay",onClick:()=>A(!P),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,h.jsxs)("span",{children:["all"===k&&"All Actions","created"===k&&"Created","updated"===k&&"Updated","deleted"===k&&"Deleted","rotated"===k&&"Rotated"]}),(0,h.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),P&&(0,h.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,h.jsx)("div",{className:"space-y-1",children:[{label:"All Actions",value:"all"},{label:"Created",value:"created"},{label:"Updated",value:"updated"},{label:"Deleted",value:"deleted"},{label:"Rotated",value:"rotated"}].map(e=>(0,h.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(k===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"),onClick:()=>{S(e.value),A(!1)},children:e.label},e.value))})})]}),(0,h.jsxs)("div",{className:"relative",ref:m,children:[(0,h.jsx)("label",{htmlFor:"tableFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Table:"}),(0,h.jsxs)("button",{id:"tableFilterDisplay",onClick:()=>E(!T),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,h.jsxs)("span",{children:["all"===C&&"All Tables","keys"===C&&"Keys","teams"===C&&"Teams","users"===C&&"Users"]}),(0,h.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),T&&(0,h.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,h.jsx)("div",{className:"space-y-1",children:[{label:"All Tables",value:"all"},{label:"Keys",value:"keys"},{label:"Teams",value:"teams"},{label:"Users",value:"users"}].map(e=>(0,h.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(C===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"),onClick:()=>{I(e.value),E(!1)},children:e.label},e.value))})})]}),(0,h.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing"," ",L.isLoading?"...":V," ","-"," ",L.isLoading?"...":K," ","of"," ",L.isLoading?"...":F," ","results"]}),(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",L.isLoading?"...":u," of"," ",L.isLoading?"...":R]}),(0,h.jsx)("button",{onClick:()=>p(e=>Math.max(1,e-1)),disabled:L.isLoading||1===u,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,h.jsx)("button",{onClick:()=>p(e=>Math.min(R,e+1)),disabled:L.isLoading||u===R,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]}),(0,h.jsx)(t5,{columns:l7,data:z,renderSubComponent:U,getRowCanExpand:()=>!0})]})]})}let ac=(e,s,t)=>{if(e)return"".concat(l2()(s).format("MMM D, h:mm A")," - ").concat(l2()(t).format("MMM D, h:mm A"));let l=l2()(),a=l2()(s),r=l.diff(a,"minutes");if(r>=0&&r<2)return"Last 1 Minute";if(r>=2&&r<16)return"Last 15 Minutes";if(r>=16&&r<61)return"Last Hour";let n=l.diff(a,"hours");return n>=1&&n<5?"Last 4 Hours":n>=5&&n<25?"Last 24 Hours":n>=25&&n<169?"Last 7 Days":"".concat(a.format("MMM D")," - ").concat(l.format("MMM D"))};function ad(e){var s,t,l;let{accessToken:a,token:r,userRole:n,userID:i,allTeams:o,premiumUser:c}=e,[d,m]=(0,x.useState)(""),[u,p]=(0,x.useState)(!1),[g,j]=(0,x.useState)(!1),[v,_]=(0,x.useState)(1),[b]=(0,x.useState)(50),N=(0,x.useRef)(null),Z=(0,x.useRef)(null),w=(0,x.useRef)(null),[k,S]=(0,x.useState)(l2()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),[C,I]=(0,x.useState)(l2()().format("YYYY-MM-DDTHH:mm")),[P,A]=(0,x.useState)(!1),[T,E]=(0,x.useState)(!1),[L,O]=(0,x.useState)(""),[M,D]=(0,x.useState)(""),[F,R]=(0,x.useState)(""),[z,q]=(0,x.useState)(""),[U,V]=(0,x.useState)(""),[K,B]=(0,x.useState)(null),[H,G]=(0,x.useState)(null),[J,Y]=(0,x.useState)(""),[W,$]=(0,x.useState)(n&&eR.includes(n)),[X,Q]=(0,x.useState)("request logs"),[ee,es]=(0,x.useState)(null),[et,el]=(0,x.useState)(null),ea=(0,f.NL)(),[er,en]=(0,x.useState)(!0),[ei,eo]=(0,x.useState)({value:24,unit:"hours"});(0,x.useEffect)(()=>{(async()=>{H&&a&&B({...(await (0,y.t0)(a,H)).info,token:H,api_key:H})})()},[H,a]),(0,x.useEffect)(()=>{function e(e){N.current&&!N.current.contains(e.target)&&j(!1),Z.current&&!Z.current.contains(e.target)&&p(!1),w.current&&!w.current.contains(e.target)&&E(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,x.useEffect)(()=>{n&&eR.includes(n)&&$(!0)},[n]);let ec=(0,sp.a)({queryKey:["logs","table",v,b,k,C,F,z,W?i:null,J,U],queryFn:async()=>{if(!a||!r||!n||!i)return{data:[],total:0,page:1,page_size:b,total_pages:0};let e=l2()(k).utc().format("YYYY-MM-DD HH:mm:ss"),s=P?l2()(C).utc().format("YYYY-MM-DD HH:mm:ss"):l2()().utc().format("YYYY-MM-DD HH:mm:ss"),t=await (0,y.h3)(a,z||void 0,F||void 0,void 0,e,s,v,b,W?i:void 0,J,U);return await l9(t.data,e,a,ea),t.data=t.data.map(s=>{let t=ea.getQueryData(["logDetails",s.request_id,e]);return(null==t?void 0:t.messages)&&(null==t?void 0:t.response)&&(s.messages=t.messages,s.response=t.response),s}),t},enabled:!!a&&!!r&&!!n&&!!i&&"request logs"===X,refetchInterval:!!er&&15e3,refetchIntervalInBackground:!0}),{filters:ed,filteredLogs:em,allTeams:eu,allKeyAliases:eh,handleFilterChange:ex,handleFilterReset:ep}=function(e){let{logs:s,accessToken:t,startTime:l,endTime:a,pageSize:r=25,isCustomDate:n,setCurrentPage:i,userID:o,userRole:c}=e,d=(0,x.useMemo)(()=>({[ai.TEAM_ID]:"",[ai.KEY_HASH]:"",[ai.REQUEST_ID]:"",[ai.MODEL]:"",[ai.USER_ID]:"",[ai.STATUS]:"",[ai.KEY_ALIAS]:""}),[]),[m,u]=(0,x.useState)(d),[h,p]=(0,x.useState)(s),g=(0,x.useRef)(0),j=(0,x.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!t)return;let i=Date.now();g.current=i;let o=l2()(l).utc().format("YYYY-MM-DD HH:mm:ss"),c=n?l2()(a).utc().format("YYYY-MM-DD HH:mm:ss"):l2()().utc().format("YYYY-MM-DD HH:mm:ss");try{let l=await (0,y.h3)(t,e[ai.KEY_HASH]||void 0,e[ai.TEAM_ID]||void 0,e[ai.REQUEST_ID]||void 0,o,c,s,r,e[ai.USER_ID]||void 0,e[ai.STATUS]||void 0,e[ai.MODEL]||void 0);i===g.current&&l.data&&p(l)}catch(e){console.error("Error searching users:",e)}},[t,l,a,n,r]),f=(0,x.useMemo)(()=>eD()((e,s)=>j(e,s),300),[j]);(0,x.useEffect)(()=>()=>f.cancel(),[f]);let v=(0,sp.a)({queryKey:["allKeys"],queryFn:async()=>{if(!t)throw Error("Access token required");return await sg(t)},enabled:!!t}).data||[];(0,x.useEffect)(()=>{if(!s||!s.data){p({data:[],total:0,page:1,page_size:50,total_pages:0});return}let e=[...s.data];if(m[ai.TEAM_ID]&&(e=e.filter(e=>e.team_id===m[ai.TEAM_ID])),m[ai.STATUS]&&(e=e.filter(e=>"success"===m[ai.STATUS]?!e.status||"success"===e.status:e.status===m[ai.STATUS])),m[ai.MODEL]&&(e=e.filter(e=>e.model===m[ai.MODEL])),m[ai.KEY_HASH]&&(e=e.filter(e=>e.api_key===m[ai.KEY_HASH])),m[ai.KEY_ALIAS])try{let s=m[ai.KEY_ALIAS];s&&(e=e.filter(e=>{var t;return(null===(t=e.metadata)||void 0===t?void 0:t.user_api_key_alias)===s}))}catch(e){console.error("Error fetching key info for alias:",e)}let t={data:e,total:s.total,page:s.page,page_size:s.page_size,total_pages:s.total_pages};JSON.stringify(t)!==JSON.stringify(h)&&p(t)},[s,m,h,t]);let{data:_}=(0,sp.a)({queryKey:["allTeamsForLogFilters",t],queryFn:async()=>t&&await sj(t)||[],enabled:!!t});return{filters:m,filteredLogs:h,allKeyAliases:v,allTeams:_,handleFilterChange:e=>{u(s=>{let t={...s,...e};for(let e of Object.keys(d))e in t||(t[e]=d[e]);return JSON.stringify(t)!==JSON.stringify(s)&&(i(1),f(t,1)),t})},handleFilterReset:()=>{u(d),f(d,1)}}}({logs:ec.data||{data:[],total:0,page:1,page_size:b||10,total_pages:1},accessToken:a,startTime:k,endTime:C,pageSize:b,isCustomDate:P,setCurrentPage:_,userID:i,userRole:n}),eg=(0,x.useCallback)(async e=>{if(a)try{let s=(await (0,y.OD)(a,null,null,e,null,null,v,b)).keys.find(s=>s.key_alias===e);s&&q(s.token)}catch(e){console.error("Error fetching key hash for alias:",e)}},[a,v,b]);(0,x.useEffect)(()=>{a&&(ed["Team ID"]?R(ed["Team ID"]):R(""),Y(ed.Status||""),V(ed.Model||""),ed["Key Hash"]?q(ed["Key Hash"]):ed["Key Alias"]?eg(ed["Key Alias"]):q(""))},[ed,a,eg]);let ej=(0,sp.a)({queryKey:["sessionLogs",et],queryFn:async()=>{if(!a||!et)return{data:[],total:0,page:1,page_size:50,total_pages:1};let e=await (0,y.XB)(a,et);return{data:e.data||e||[],total:(e.data||e||[]).length,page:1,page_size:1e3,total_pages:1}},enabled:!!a&&!!et});if((0,x.useEffect)(()=>{var e;(null===(e=ec.data)||void 0===e?void 0:e.data)&&ee&&!ec.data.data.some(e=>e.request_id===ee)&&es(null)},[null===(s=ec.data)||void 0===s?void 0:s.data,ee]),!a||!r||!n||!i)return null;let ef=em.data.filter(e=>!d||e.request_id.includes(d)||e.model.includes(d)||e.user&&e.user.includes(d)).map(e=>({...e,duration:(Date.parse(e.endTime)-Date.parse(e.startTime))/1e3,onKeyHashClick:e=>G(e),onSessionClick:e=>{e&&el(e)}}))||[],ev=(null===(l=ej.data)||void 0===l?void 0:null===(t=l.data)||void 0===t?void 0:t.map(e=>({...e,onKeyHashClick:e=>G(e),onSessionClick:e=>{}})))||[],e_=[{name:"Team ID",label:"Team ID",isSearchable:!0,searchFn:async e=>o&&0!==o.length?o.filter(s=>s.team_id.toLowerCase().includes(e.toLowerCase())||s.team_alias&&s.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:"".concat(e.team_alias||e.team_id," (").concat(e.team_id,")"),value:e.team_id})):[]},{name:"Status",label:"Status",isSearchable:!1,options:[{label:"Success",value:"success"},{label:"Failure",value:"failure"}]},{name:"Model",label:"Model",isSearchable:!1},{name:"Key Alias",label:"Key Alias",isSearchable:!0,searchFn:async e=>a?(await sg(a)).filter(s=>s.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e})):[]},{name:"Key Hash",label:"Key Hash",isSearchable:!1}];if(et&&ej.data)return(0,h.jsx)("div",{className:"w-full p-6",children:(0,h.jsx)(aa,{sessionId:et,logs:ej.data.data,onBack:()=>el(null)})});let ey=[{label:"Last 15 Minutes",value:15,unit:"minutes"},{label:"Last Hour",value:1,unit:"hours"},{label:"Last 4 Hours",value:4,unit:"hours"},{label:"Last 24 Hours",value:24,unit:"hours"},{label:"Last 7 Days",value:7,unit:"days"}],eb=ey.find(e=>e.value===ei.value&&e.unit===ei.unit),eN=P?ac(P,k,C):null==eb?void 0:eb.label;return(0,h.jsx)("div",{className:"w-full p-6",children:(0,h.jsxs)(e4.Z,{defaultIndex:0,onIndexChange:e=>Q(0===e?"request logs":"audit logs"),children:[(0,h.jsxs)(e5.Z,{children:[(0,h.jsx)(e2.Z,{children:"Request Logs"}),(0,h.jsx)(e2.Z,{children:"Audit Logs"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsxs)(e6.Z,{children:[(0,h.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,h.jsx)("h1",{className:"text-xl font-semibold",children:et?(0,h.jsxs)(h.Fragment,{children:["Session: ",(0,h.jsx)("span",{className:"font-mono",children:et}),(0,h.jsx)("button",{className:"ml-4 px-3 py-1 text-sm border rounded hover:bg-gray-50",onClick:()=>el(null),children:"← Back to All Logs"})]}):"Request Logs"})}),K&&H&&K.api_key===H?(0,h.jsx)(su,{keyId:H,keyData:K,accessToken:a,userID:i,userRole:n,teams:o,onClose:()=>G(null),premiumUser:c}):et?(0,h.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,h.jsx)(t5,{columns:l3,data:ev,renderSubComponent:am,getRowCanExpand:()=>!0})}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(sx,{options:e_,onApplyFilters:ex,onResetFilters:ep}),(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,h.jsx)("div",{className:"border-b px-6 py-4",children:(0,h.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:[(0,h.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,h.jsxs)("div",{className:"relative w-64",children:[(0,h.jsx)("input",{type:"text",placeholder:"Search by Request ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:d,onChange:e=>m(e.target.value)}),(0,h.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsxs)("div",{className:"relative",ref:w,children:[(0,h.jsxs)("button",{onClick:()=>E(!T),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",children:[(0,h.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),eN]}),T&&(0,h.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border p-2 z-50",children:(0,h.jsxs)("div",{className:"space-y-1",children:[ey.map(e=>(0,h.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(eN===e.label?"bg-blue-50 text-blue-600":""),onClick:()=>{I(l2()().format("YYYY-MM-DDTHH:mm")),S(l2()().subtract(e.value,e.unit).format("YYYY-MM-DDTHH:mm")),eo({value:e.value,unit:e.unit}),A(!1),E(!1)},children:e.label},e.label)),(0,h.jsx)("div",{className:"border-t my-2"}),(0,h.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(P?"bg-blue-50 text-blue-600":""),onClick:()=>A(!P),children:"Custom Range"})]})})]}),(0,h.jsx)(()=>(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Live Tail"}),(0,h.jsx)(tB.Z,{color:"green",checked:er,defaultChecked:!0,onChange:en})]}),{}),(0,h.jsxs)("button",{onClick:()=>{ec.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,h.jsx)("svg",{className:"w-4 h-4 ".concat(ec.isFetching?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,h.jsx)("span",{children:"Refresh"})]})]}),P&&(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{children:(0,h.jsx)("input",{type:"datetime-local",value:k,onChange:e=>{S(e.target.value),_(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,h.jsx)("span",{className:"text-gray-500",children:"to"}),(0,h.jsx)("div",{children:(0,h.jsx)("input",{type:"datetime-local",value:C,onChange:e=>{I(e.target.value),_(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})})]})]}),(0,h.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,h.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing"," ",ec.isLoading?"...":em?(v-1)*b+1:0," ","-"," ",ec.isLoading?"...":em?Math.min(v*b,em.total):0," ","of"," ",ec.isLoading?"...":em?em.total:0," ","results"]}),(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",ec.isLoading?"...":v," of"," ",ec.isLoading?"...":em?em.total_pages:1]}),(0,h.jsx)("button",{onClick:()=>_(e=>Math.max(1,e-1)),disabled:ec.isLoading||1===v,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,h.jsx)("button",{onClick:()=>_(e=>Math.min(em.total_pages||1,e+1)),disabled:ec.isLoading||v===(em.total_pages||1),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}),er&&(0,h.jsxs)("div",{className:"mb-4 px-4 py-2 bg-green-50 border border-greem-200 rounded-md flex items-center justify-between",children:[(0,h.jsx)("div",{className:"flex items-center gap-2",children:(0,h.jsx)("span",{className:"text-sm text-green-700",children:"Auto-refreshing every 15 seconds"})}),(0,h.jsx)("button",{onClick:()=>en(!1),className:"text-sm text-green-600 hover:text-green-800",children:"Stop"})]}),(0,h.jsx)(t5,{columns:l3,data:ef,renderSubComponent:am,getRowCanExpand:()=>!0})]})]})]}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(ao,{userID:i,userRole:n,token:r,accessToken:a,isActive:"audit logs"===X,premiumUser:c,allTeams:o})})]})]})})}function am(e){var s,t,l,a,r;let{row:n}=e,i=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},o=n.original.metadata||{},c="failure"===o.status,d=c?o.error_information:null,m=n.original.messages&&(Array.isArray(n.original.messages)?n.original.messages.length>0:Object.keys(n.original.messages).length>0),u=n.original.response&&Object.keys(i(n.original.response)).length>0,x=o.vector_store_request_metadata&&Array.isArray(o.vector_store_request_metadata)&&o.vector_store_request_metadata.length>0,p=n.original.metadata&&n.original.metadata.guardrail_information,g=p&&(null===(r=n.original.metadata)||void 0===r?void 0:r.guardrail_information.masked_entity_count)?Object.values(n.original.metadata.guardrail_information.masked_entity_count).reduce((e,s)=>e+("number"==typeof s?s:0),0):0;return(0,h.jsxs)("div",{className:"p-6 bg-gray-50 space-y-6",children:[(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,h.jsx)("div",{className:"p-4 border-b",children:(0,h.jsx)("h3",{className:"text-lg font-medium",children:"Request Details"})}),(0,h.jsxs)("div",{className:"grid grid-cols-2 gap-4 p-4",children:[(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Request ID:"}),(0,h.jsx)("span",{className:"font-mono text-sm",children:n.original.request_id})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Model:"}),(0,h.jsx)("span",{children:n.original.model})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Model ID:"}),(0,h.jsx)("span",{children:n.original.model_id})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Call Type:"}),(0,h.jsx)("span",{children:n.original.call_type})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,h.jsx)("span",{children:n.original.custom_llm_provider||"-"})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"API Base:"}),(0,h.jsx)(X.Z,{title:n.original.api_base||"-",children:(0,h.jsx)("span",{className:"max-w-[15ch] truncate block",children:n.original.api_base||"-"})})]}),(null==n?void 0:null===(s=n.original)||void 0===s?void 0:s.requester_ip_address)&&(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"IP Address:"}),(0,h.jsx)("span",{children:null==n?void 0:null===(t=n.original)||void 0===t?void 0:t.requester_ip_address})]}),p&&(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail:"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{className:"font-mono",children:n.original.metadata.guardrail_information.guardrail_name}),g>0&&(0,h.jsxs)("span",{className:"ml-2 px-2 py-0.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[g," masked"]})]})]})]}),(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Tokens:"}),(0,h.jsxs)("span",{children:[n.original.total_tokens," (",n.original.prompt_tokens,"+",n.original.completion_tokens,")"]})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Cost:"}),(0,h.jsxs)("span",{children:["$",eH(n.original.spend||0,4)]})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Cache Hit:"}),(0,h.jsx)("span",{children:n.original.cache_hit})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,h.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat("failure"!==((null===(l=n.original.metadata)||void 0===l?void 0:l.status)||"Success").toLowerCase()?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"failure"!==((null===(a=n.original.metadata)||void 0===a?void 0:a.status)||"Success").toLowerCase()?"Success":"Failure"})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,h.jsx)("span",{children:n.original.startTime})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,h.jsx)("span",{children:n.original.endTime})]}),(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,h.jsxs)("span",{children:[n.original.duration," s."]})]})]})]})]}),(0,h.jsx)(at,{show:!m&&!u}),(0,h.jsx)(ae,{row:n,hasMessages:m,hasResponse:u,hasError:c,errorInfo:d,getRawRequest:()=>{var e;return(null===(e=n.original)||void 0===e?void 0:e.proxy_server_request)?i(n.original.proxy_server_request):i(n.original.messages)},formattedResponse:()=>c&&d?{error:{message:d.error_message||"An error occurred",type:d.error_class||"error",code:d.error_code||"unknown",param:null}}:i(n.original.response)}),p&&(0,h.jsx)(an,{data:n.original.metadata.guardrail_information}),x&&(0,h.jsx)(ar,{data:o.vector_store_request_metadata}),c&&d&&(0,h.jsx)(as,{errorInfo:d}),n.original.request_tags&&Object.keys(n.original.request_tags).length>0&&(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,h.jsx)("div",{className:"flex justify-between items-center p-4 border-b",children:(0,h.jsx)("h3",{className:"text-lg font-medium",children:"Request Tags"})}),(0,h.jsx)("div",{className:"p-4",children:(0,h.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(n.original.request_tags).map(e=>{let[s,t]=e;return(0,h.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[s,": ",String(t)]},s)})})})]}),n.original.metadata&&Object.keys(n.original.metadata).length>0&&(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,h.jsx)("h3",{className:"text-lg font-medium",children:"Metadata"}),(0,h.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(n.original.metadata,null,2))},className:"p-1 hover:bg-gray-200 rounded",title:"Copy metadata",children:(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,h.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,h.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,h.jsx)("div",{className:"p-4 overflow-auto max-h-64",children:(0,h.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(n.original.metadata,null,2)})})]})]})}var au=t(92699),ah=t(14042),ax=e=>{let{userID:s,userRole:t,accessToken:l,userSpend:a,userMaxBudget:r,selectedTeam:n}=e;console.log("userSpend: ".concat(a));let[i,o]=(0,x.useState)(null!==a?a:0),[c,d]=(0,x.useState)(n?Number(eH(n.max_budget,4)):null);(0,x.useEffect)(()=>{if(n){if("Default Team"===n.team_alias)d(r);else{let e=!1;if(n.team_memberships)for(let t of n.team_memberships)t.user_id===s&&"max_budget"in t.litellm_budget_table&&null!==t.litellm_budget_table.max_budget&&(d(t.litellm_budget_table.max_budget),e=!0);e||d(n.max_budget)}}},[n,r]);let[m,u]=(0,x.useState)([]);(0,x.useEffect)(()=>{let e=async()=>{if(!l||!s||!t)return};(async()=>{try{if(null===s||null===t)return;if(null!==l){let e=(await (0,y.So)(l,s,t)).data.map(e=>e.id);console.log("available_model_names:",e),u(e)}}catch(e){console.error("Error fetching user models:",e)}})(),e()},[t,l,s]),(0,x.useEffect)(()=>{null!==a&&o(a)},[a]);let p=[];n&&n.models&&(p=n.models),p&&p.includes("all-proxy-models")?(console.log("user models:",m),p=m):p&&p.includes("all-team-models")?p=n.models:p&&0===p.length&&(p=m);let g=null!==c?"$".concat(eH(Number(c),4)," limit"):"No limit",j=void 0!==i?eH(i,4):null;return console.log("spend in view user spend: ".concat(i)),(0,h.jsx)("div",{className:"flex items-center",children:(0,h.jsxs)("div",{className:"flex justify-between gap-x-6",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content",children:"Total Spend"}),(0,h.jsxs)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:["$",j]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content",children:"Max Budget"}),(0,h.jsx)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:g})]})]})})};let ap=e=>{let{key:s,info:t}=e;return{token:s,...t}};var ag=e=>{let{topKeys:s,accessToken:t,userID:l,userRole:a,teams:r,premiumUser:n}=e,[i,o]=(0,x.useState)(!1),[c,d]=(0,x.useState)(null),[m,u]=(0,x.useState)(void 0),[p,g]=(0,x.useState)("table"),j=async e=>{if(t)try{let s=await (0,y.t0)(t,e.api_key),l=ap(s);u(l),d(e.api_key),o(!0)}catch(e){console.error("Error fetching key info:",e)}},f=()=>{o(!1),d(null),u(void 0)};return x.useEffect(()=>{let e=e=>{"Escape"===e.key&&i&&f()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[i]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"mb-4 flex justify-end items-center",children:(0,h.jsxs)("div",{className:"flex space-x-2",children:[(0,h.jsx)("button",{onClick:()=>g("table"),className:"px-3 py-1 text-sm rounded-md ".concat("table"===p?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"Table View"}),(0,h.jsx)("button",{onClick:()=>g("chart"),className:"px-3 py-1 text-sm rounded-md ".concat("chart"===p?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"Chart View"})]})}),"chart"===p?(0,h.jsx)("div",{className:"relative",children:(0,h.jsx)(s3.Z,{className:"mt-4 h-40 cursor-pointer hover:opacity-90",data:s,index:"key_alias",categories:["spend"],colors:["cyan"],yAxisWidth:80,tickGap:5,layout:"vertical",showXAxis:!1,showLegend:!1,valueFormatter:e=>e?"$".concat(eH(e,2)):"No Key Alias",onValueChange:e=>j(e),showTooltip:!0,customTooltip:e=>{var s,t,l;let a=null===(t=e.payload)||void 0===t?void 0:null===(s=t[0])||void 0===s?void 0:s.payload;return(0,h.jsx)("div",{className:"p-3 bg-black/90 shadow-lg rounded-lg text-white",children:(0,h.jsxs)("div",{className:"space-y-1.5",children:[(0,h.jsxs)("div",{className:"text-sm",children:[(0,h.jsx)("span",{className:"text-gray-300",children:"Key: "}),(0,h.jsxs)("span",{className:"font-mono text-gray-100",children:[null==a?void 0:null===(l=a.api_key)||void 0===l?void 0:l.slice(0,10),"..."]})]}),(0,h.jsxs)("div",{className:"text-sm",children:[(0,h.jsx)("span",{className:"text-gray-300",children:"Spend: "}),(0,h.jsxs)("span",{className:"text-white font-medium",children:["$",eH(null==a?void 0:a.spend,2)]})]})]})})}})}):(0,h.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,h.jsx)(t5,{columns:[{header:"Key ID",accessorKey:"api_key",cell:e=>(0,h.jsx)("div",{className:"overflow-hidden",children:(0,h.jsx)(X.Z,{title:e.getValue(),children:(0,h.jsx)(P.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>j(e.row.original),children:e.getValue()?"".concat(e.getValue().slice(0,7),"..."):"-"})})})},{header:"Key Alias",accessorKey:"key_alias",cell:e=>e.getValue()||"-"},{header:"Spend (USD)",accessorKey:"spend",cell:e=>"$".concat(eH(e.getValue(),2))}],data:s,renderSubComponent:()=>(0,h.jsx)(h.Fragment,{}),getRowCanExpand:()=>!1,isLoading:!1})}),i&&c&&m&&(console.log("Rendering modal with:",{isModalOpen:i,selectedKey:c,keyData:m}),(0,h.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&f()},children:(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow-xl relative w-11/12 max-w-6xl max-h-[90vh] overflow-y-auto min-h-[750px]",children:[(0,h.jsx)("button",{onClick:f,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:(0,h.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,h.jsx)("div",{className:"p-6 h-full",children:(0,h.jsx)(su,{keyId:c,onClose:f,keyData:m,accessToken:t,userID:l,userRole:a,teams:r,premiumUser:n})})]})}))]})},aj=t(44851);let af=e=>{var s,t;let{modelName:l,metrics:a}=e;return(0,h.jsxs)("div",{className:"space-y-2",children:[(0,h.jsxs)(I.Z,{numItems:4,className:"gap-4",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Requests"}),(0,h.jsx)(M.Z,{children:a.total_requests.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Successful Requests"}),(0,h.jsx)(M.Z,{children:a.total_successful_requests.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Tokens"}),(0,h.jsx)(M.Z,{children:a.total_tokens.toLocaleString()}),(0,h.jsxs)(O.Z,{children:[Math.round(a.total_tokens/a.total_successful_requests)," avg per successful request"]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Spend"}),(0,h.jsxs)(M.Z,{children:["$",eH(a.total_spend,2)]}),(0,h.jsxs)(O.Z,{children:["$",eH(a.total_spend/a.total_successful_requests,3)," per successful request"]})]})]}),(0,h.jsxs)(I.Z,{numItems:2,className:"gap-4",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Total Tokens"}),(0,h.jsx)(s6.Z,{data:a.daily_data,index:"date",categories:["metrics.prompt_tokens","metrics.completion_tokens","metrics.total_tokens"],colors:["blue","cyan","indigo"],valueFormatter:e=>e.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Requests per day"}),(0,h.jsx)(s3.Z,{data:a.daily_data,index:"date",categories:["metrics.api_requests"],colors:["blue"],valueFormatter:e=>e.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Spend per day"}),(0,h.jsx)(s3.Z,{data:a.daily_data,index:"date",categories:["metrics.spend"],colors:["green"],valueFormatter:e=>"$".concat(eH(e,2))})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Success vs Failed Requests"}),(0,h.jsx)(s6.Z,{data:a.daily_data,index:"date",categories:["metrics.successful_requests","metrics.failed_requests"],colors:["emerald","red"],valueFormatter:e=>e.toLocaleString(),stack:!0})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Prompt Caching Metrics"}),(0,h.jsxs)("div",{className:"mb-2",children:[(0,h.jsxs)(O.Z,{children:["Cache Read: ",(null===(s=a.total_cache_read_input_tokens)||void 0===s?void 0:s.toLocaleString())||0," tokens"]}),(0,h.jsxs)(O.Z,{children:["Cache Creation: ",(null===(t=a.total_cache_creation_input_tokens)||void 0===t?void 0:t.toLocaleString())||0," tokens"]})]}),(0,h.jsx)(s6.Z,{data:a.daily_data,index:"date",categories:["metrics.cache_read_input_tokens","metrics.cache_creation_input_tokens"],colors:["cyan","purple"],valueFormatter:e=>e.toLocaleString()})]})]})]})},av=e=>{let{modelMetrics:s}=e,t=Object.keys(s).sort((e,t)=>""===e?1:""===t?-1:s[t].total_spend-s[e].total_spend),l={total_requests:0,total_successful_requests:0,total_tokens:0,total_spend:0,total_cache_read_input_tokens:0,total_cache_creation_input_tokens:0,daily_data:{}};Object.values(s).forEach(e=>{l.total_requests+=e.total_requests,l.total_successful_requests+=e.total_successful_requests,l.total_tokens+=e.total_tokens,l.total_spend+=e.total_spend,l.total_cache_read_input_tokens+=e.total_cache_read_input_tokens||0,l.total_cache_creation_input_tokens+=e.total_cache_creation_input_tokens||0,e.daily_data.forEach(e=>{l.daily_data[e.date]||(l.daily_data[e.date]={prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,spend:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0}),l.daily_data[e.date].prompt_tokens+=e.metrics.prompt_tokens,l.daily_data[e.date].completion_tokens+=e.metrics.completion_tokens,l.daily_data[e.date].total_tokens+=e.metrics.total_tokens,l.daily_data[e.date].api_requests+=e.metrics.api_requests,l.daily_data[e.date].spend+=e.metrics.spend,l.daily_data[e.date].successful_requests+=e.metrics.successful_requests,l.daily_data[e.date].failed_requests+=e.metrics.failed_requests,l.daily_data[e.date].cache_read_input_tokens+=e.metrics.cache_read_input_tokens||0,l.daily_data[e.date].cache_creation_input_tokens+=e.metrics.cache_creation_input_tokens||0})});let a=Object.entries(l.daily_data).map(e=>{let[s,t]=e;return{date:s,metrics:t}}).sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime());return(0,h.jsxs)("div",{className:"space-y-8",children:[(0,h.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,h.jsx)(M.Z,{children:"Overall Usage"}),(0,h.jsxs)(I.Z,{numItems:4,className:"gap-4 mb-4",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Requests"}),(0,h.jsx)(M.Z,{children:l.total_requests.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Successful Requests"}),(0,h.jsx)(M.Z,{children:l.total_successful_requests.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Tokens"}),(0,h.jsx)(M.Z,{children:l.total_tokens.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Total Spend"}),(0,h.jsxs)(M.Z,{children:["$",eH(l.total_spend,2)]})]})]}),(0,h.jsxs)(I.Z,{numItems:2,className:"gap-4",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Total Tokens Over Time"}),(0,h.jsx)(s6.Z,{data:a,index:"date",categories:["metrics.prompt_tokens","metrics.completion_tokens","metrics.total_tokens"],colors:["blue","cyan","indigo"],valueFormatter:e=>e.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Total Requests Over Time"}),(0,h.jsx)(s6.Z,{data:a,index:"date",categories:["metrics.successful_requests","metrics.failed_requests"],colors:["emerald","red"],valueFormatter:e=>e.toLocaleString(),stack:!0})]})]})]}),(0,h.jsx)(aj.default,{defaultActiveKey:t[0],children:t.map(e=>(0,h.jsx)(aj.default.Panel,{header:(0,h.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,h.jsx)(M.Z,{children:s[e].label||"Unknown Item"}),(0,h.jsxs)("div",{className:"flex space-x-4 text-sm text-gray-500",children:[(0,h.jsxs)("span",{children:["$",eH(s[e].total_spend,2)]}),(0,h.jsxs)("span",{children:[s[e].total_requests.toLocaleString()," requests"]})]})]}),children:(0,h.jsx)(af,{modelName:e||"Unknown Model",metrics:s[e]})},e))})]})},a_=(e,s)=>{let t=e.metadata.key_alias||"key-hash-".concat(s),l=e.metadata.team_id;return l?"".concat(t," (team_id: ").concat(l,")"):t},ay=(e,s)=>{let t={};return e.results.forEach(e=>{Object.entries(e.breakdown[s]||{}).forEach(l=>{let[a,r]=l;t[a]||(t[a]={label:"api_keys"===s?a_(r,a):a,total_requests:0,total_successful_requests:0,total_failed_requests:0,total_tokens:0,prompt_tokens:0,completion_tokens:0,total_spend:0,total_cache_read_input_tokens:0,total_cache_creation_input_tokens:0,daily_data:[]}),t[a].total_requests+=r.metrics.api_requests,t[a].prompt_tokens+=r.metrics.prompt_tokens,t[a].completion_tokens+=r.metrics.completion_tokens,t[a].total_tokens+=r.metrics.total_tokens,t[a].total_spend+=r.metrics.spend,t[a].total_successful_requests+=r.metrics.successful_requests,t[a].total_failed_requests+=r.metrics.failed_requests,t[a].total_cache_read_input_tokens+=r.metrics.cache_read_input_tokens||0,t[a].total_cache_creation_input_tokens+=r.metrics.cache_creation_input_tokens||0,t[a].daily_data.push({date:e.date,metrics:{prompt_tokens:r.metrics.prompt_tokens,completion_tokens:r.metrics.completion_tokens,total_tokens:r.metrics.total_tokens,api_requests:r.metrics.api_requests,spend:r.metrics.spend,successful_requests:r.metrics.successful_requests,failed_requests:r.metrics.failed_requests,cache_read_input_tokens:r.metrics.cache_read_input_tokens||0,cache_creation_input_tokens:r.metrics.cache_creation_input_tokens||0}})})}),Object.values(t).forEach(e=>{e.daily_data.sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime())}),t};var ab=e=>{let{accessToken:s,entityType:t,entityId:l,userID:a,userRole:r,entityList:n,premiumUser:i}=e,[o,c]=(0,x.useState)({results:[],metadata:{total_spend:0,total_api_requests:0,total_successful_requests:0,total_failed_requests:0,total_tokens:0}}),d=ay(o,"models"),m=ay(o,"api_keys"),[u,p]=(0,x.useState)([]),[g,j]=(0,x.useState)({from:new Date(Date.now()-24192e5),to:new Date}),f=async()=>{if(!s||!g.from||!g.to)return;let e=new Date(g.from),l=new Date(g.to);if("tag"===t)c(await (0,y.Z9)(s,e,l,1,u.length>0?u:null));else if("team"===t)c(await (0,y.ol)(s,e,l,1,u.length>0?u:null));else throw Error("Invalid entity type")};(0,x.useEffect)(()=>{f()},[s,g,l,u]);let v=()=>{let e={};return o.results.forEach(s=>{Object.entries(s.breakdown.providers||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={provider:t,spend:0,requests:0,successful_requests:0,failed_requests:0,tokens:0});try{e[t].spend+=l.metrics.spend,e[t].requests+=l.metrics.api_requests,e[t].successful_requests+=l.metrics.successful_requests,e[t].failed_requests+=l.metrics.failed_requests,e[t].tokens+=l.metrics.total_tokens}catch(e){console.log("Error processing provider ".concat(t,": ").concat(e))}})}),Object.values(e).filter(e=>e.spend>0).sort((e,s)=>s.spend-e.spend)},_=e=>0===u.length?e:e.filter(e=>u.includes(e.metadata.id)),b=()=>{let e={};return o.results.forEach(s=>{Object.entries(s.breakdown.entities||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{alias:l.metadata.team_alias||t,id:t}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests,e[t].metrics.failed_requests+=l.metrics.failed_requests,e[t].metrics.total_tokens+=l.metrics.total_tokens})}),_(Object.values(e).sort((e,s)=>s.metrics.spend-e.metrics.spend))};return(0,h.jsxs)("div",{style:{width:"100%"},children:[(0,h.jsxs)(I.Z,{numItems:2,className:"gap-2 w-full mb-4",children:[(0,h.jsx)(C.Z,{children:(0,h.jsx)(s5,{value:g,onValueChange:j})}),n&&n.length>0&&(0,h.jsxs)(C.Z,{children:[(0,h.jsxs)(O.Z,{children:["Filter by ","tag"===t?"Tags":"Teams"]}),(0,h.jsx)(F.default,{mode:"multiple",style:{width:"100%"},placeholder:"Select ".concat("tag"===t?"tags":"teams"," to filter..."),value:u,onChange:p,options:(()=>{if(n)return n})(),className:"mt-2",allowClear:!0})]})]}),(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{variant:"solid",className:"mt-1",children:[(0,h.jsx)(e2.Z,{children:"Cost"}),(0,h.jsx)(e2.Z,{children:"Model Activity"}),(0,h.jsx)(e2.Z,{children:"Key Activity"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:2,className:"gap-2 w-full",children:[(0,h.jsx)(C.Z,{numColSpan:2,children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)(M.Z,{children:["tag"===t?"Tag":"Team"," Spend Overview"]}),(0,h.jsxs)(I.Z,{numItems:5,className:"gap-4 mt-4",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Total Spend"}),(0,h.jsxs)(O.Z,{className:"text-2xl font-bold mt-2",children:["$",eH(o.metadata.total_spend,2)]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Total Requests"}),(0,h.jsx)(O.Z,{className:"text-2xl font-bold mt-2",children:o.metadata.total_api_requests.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Successful Requests"}),(0,h.jsx)(O.Z,{className:"text-2xl font-bold mt-2 text-green-600",children:o.metadata.total_successful_requests.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Failed Requests"}),(0,h.jsx)(O.Z,{className:"text-2xl font-bold mt-2 text-red-600",children:o.metadata.total_failed_requests.toLocaleString()})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Total Tokens"}),(0,h.jsx)(O.Z,{className:"text-2xl font-bold mt-2",children:o.metadata.total_tokens.toLocaleString()})]})]})]})}),(0,h.jsx)(C.Z,{numColSpan:2,children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Daily Spend"}),(0,h.jsx)(s3.Z,{data:[...o.results].sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()),index:"date",categories:["metrics.spend"],colors:["cyan"],valueFormatter:e=>"$".concat(eH(e,2)),yAxisWidth:100,showLegend:!1,customTooltip:e=>{let{payload:s,active:l}=e;if(!l||!(null==s?void 0:s[0]))return null;let a=s[0].payload;return(0,h.jsxs)("div",{className:"bg-white p-4 shadow-lg rounded-lg border",children:[(0,h.jsx)("p",{className:"font-bold",children:a.date}),(0,h.jsxs)("p",{className:"text-cyan-500",children:["Total Spend: $",eH(a.metrics.spend,2)]}),(0,h.jsxs)("p",{className:"text-gray-600",children:["Total Requests: ",a.metrics.api_requests]}),(0,h.jsxs)("p",{className:"text-gray-600",children:["Successful: ",a.metrics.successful_requests]}),(0,h.jsxs)("p",{className:"text-gray-600",children:["Failed: ",a.metrics.failed_requests]}),(0,h.jsxs)("p",{className:"text-gray-600",children:["Total Tokens: ",a.metrics.total_tokens]}),(0,h.jsxs)("div",{className:"mt-2 border-t pt-2",children:[(0,h.jsxs)("p",{className:"font-semibold",children:["Spend by ","tag"===t?"Tag":"Team",":"]}),Object.entries(a.breakdown.entities||{}).map(e=>{let[s,t]=e;return(0,h.jsxs)("p",{className:"text-sm text-gray-600",children:[t.metadata.team_alias||s,": $",eH(t.metrics.spend,2)]},s)})]})]})}})]})}),(0,h.jsx)(C.Z,{numColSpan:2,children:(0,h.jsx)(eo.Z,{children:(0,h.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,h.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,h.jsxs)(M.Z,{children:["Spend Per ","tag"===t?"Tag":"Team"]}),(0,h.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,h.jsxs)("span",{children:["Get Started Tracking cost per ",t," "]}),(0,h.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/enterprise#spend-tracking",className:"text-blue-500 hover:text-blue-700 ml-1",children:"here"})]})]}),(0,h.jsxs)(I.Z,{numItems:2,children:[(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)(s3.Z,{className:"mt-4 h-52",data:b(),index:"metadata.alias",categories:["metrics.spend"],colors:["cyan"],valueFormatter:e=>"$".concat(eH(e,4)),layout:"vertical",showLegend:!1,yAxisWidth:100})}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"tag"===t?"Tag":"Team"}),(0,h.jsx)(sS.Z,{children:"Spend"}),(0,h.jsx)(sS.Z,{className:"text-green-600",children:"Successful"}),(0,h.jsx)(sS.Z,{className:"text-red-600",children:"Failed"}),(0,h.jsx)(sS.Z,{children:"Tokens"})]})}),(0,h.jsx)(sZ.Z,{children:b().filter(e=>e.metrics.spend>0).map(e=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:e.metadata.alias}),(0,h.jsxs)(sw.Z,{children:["$",eH(e.metrics.spend,4)]}),(0,h.jsx)(sw.Z,{className:"text-green-600",children:e.metrics.successful_requests.toLocaleString()}),(0,h.jsx)(sw.Z,{className:"text-red-600",children:e.metrics.failed_requests.toLocaleString()}),(0,h.jsx)(sw.Z,{children:e.metrics.total_tokens.toLocaleString()})]},e.metadata.id))})]})})]})]})})}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Top API Keys"}),(0,h.jsx)(ag,{topKeys:(()=>{let e={};return o.results.forEach(s=>{Object.entries(s.breakdown.api_keys||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{key_alias:l.metadata.key_alias}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.prompt_tokens+=l.metrics.prompt_tokens,e[t].metrics.completion_tokens+=l.metrics.completion_tokens,e[t].metrics.total_tokens+=l.metrics.total_tokens,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests,e[t].metrics.failed_requests+=l.metrics.failed_requests,e[t].metrics.cache_read_input_tokens+=l.metrics.cache_read_input_tokens||0,e[t].metrics.cache_creation_input_tokens+=l.metrics.cache_creation_input_tokens||0})}),Object.entries(e).map(e=>{let[s,t]=e;return{api_key:s,key_alias:t.metadata.key_alias||"-",spend:t.metrics.spend}}).sort((e,s)=>s.spend-e.spend).slice(0,5)})(),accessToken:s,userID:a,userRole:r,teams:null,premiumUser:i})]})}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Top Models"}),(0,h.jsx)(s3.Z,{className:"mt-4 h-40",data:(()=>{let e={};return o.results.forEach(s=>{Object.entries(s.breakdown.models||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={spend:0,requests:0,successful_requests:0,failed_requests:0,tokens:0});try{e[t].spend+=l.metrics.spend}catch(e){console.log("Error adding spend for ".concat(t,": ").concat(e,", got metrics: ").concat(JSON.stringify(l)))}e[t].requests+=l.metrics.api_requests,e[t].successful_requests+=l.metrics.successful_requests,e[t].failed_requests+=l.metrics.failed_requests,e[t].tokens+=l.metrics.total_tokens})}),Object.entries(e).map(e=>{let[s,t]=e;return{key:s,...t}}).sort((e,s)=>s.spend-e.spend).slice(0,5)})(),index:"key",categories:["spend"],colors:["cyan"],valueFormatter:e=>"$".concat(eH(e,2)),layout:"vertical",yAxisWidth:200,showLegend:!1})]})}),(0,h.jsx)(C.Z,{numColSpan:2,children:(0,h.jsx)(eo.Z,{children:(0,h.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,h.jsx)(M.Z,{children:"Provider Usage"}),(0,h.jsxs)(I.Z,{numItems:2,children:[(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)(ah.Z,{className:"mt-4 h-40",data:v(),index:"provider",category:"spend",valueFormatter:e=>"$".concat(eH(e,2)),colors:["cyan","blue","indigo","violet","purple"]})}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Provider"}),(0,h.jsx)(sS.Z,{children:"Spend"}),(0,h.jsx)(sS.Z,{className:"text-green-600",children:"Successful"}),(0,h.jsx)(sS.Z,{className:"text-red-600",children:"Failed"}),(0,h.jsx)(sS.Z,{children:"Tokens"})]})}),(0,h.jsx)(sZ.Z,{children:v().map(e=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:e.provider}),(0,h.jsxs)(sw.Z,{children:["$",eH(e.spend,2)]}),(0,h.jsx)(sw.Z,{className:"text-green-600",children:e.successful_requests.toLocaleString()}),(0,h.jsx)(sw.Z,{className:"text-red-600",children:e.failed_requests.toLocaleString()}),(0,h.jsx)(sw.Z,{children:e.tokens.toLocaleString()})]},e.provider))})]})})]})]})})})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(av,{modelMetrics:d})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(av,{modelMetrics:m})})]})]})]})},aN=e=>{var s,t,l,a,r,n,i,o,c,d;let{accessToken:m,userRole:u,userID:p,teams:g,premiumUser:j}=e,[f,v]=(0,x.useState)({results:[],metadata:{}}),[_,b]=(0,x.useState)({from:new Date(Date.now()-24192e5),to:new Date}),[N,Z]=(0,x.useState)([]),w=async()=>{m&&Z(Object.values(await (0,y.UM)(m)).map(e=>({label:e.name,value:e.name})))};(0,x.useEffect)(()=>{w()},[m]);let k=(null===(s=f.metadata)||void 0===s?void 0:s.total_spend)||0,S=()=>{let e={};return f.results.forEach(s=>{Object.entries(s.breakdown.providers||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.prompt_tokens+=l.metrics.prompt_tokens,e[t].metrics.completion_tokens+=l.metrics.completion_tokens,e[t].metrics.total_tokens+=l.metrics.total_tokens,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests||0,e[t].metrics.failed_requests+=l.metrics.failed_requests||0,e[t].metrics.cache_read_input_tokens+=l.metrics.cache_read_input_tokens||0,e[t].metrics.cache_creation_input_tokens+=l.metrics.cache_creation_input_tokens||0})}),Object.entries(e).map(e=>{let[s,t]=e;return{provider:s,spend:t.metrics.spend,requests:t.metrics.api_requests,successful_requests:t.metrics.successful_requests,failed_requests:t.metrics.failed_requests,tokens:t.metrics.total_tokens}})},P=async()=>{if(!m||!_.from||!_.to)return;let e=new Date(_.from),s=new Date(_.to);try{let t=await (0,y.xX)(m,e,s);if(t.metadata.total_pages>10)throw Error("Too many pages of data (>10). Please select a smaller date range.");if(t.metadata.total_pages<=1){v(t);return}let l=[...t.results],a={...t.metadata};for(let r=2;r<=t.metadata.total_pages;r++){let t=await (0,y.xX)(m,e,s,r);l.push(...t.results),t.metadata&&(a.total_spend+=t.metadata.total_spend||0,a.total_api_requests+=t.metadata.total_api_requests||0,a.total_successful_requests+=t.metadata.total_successful_requests||0,a.total_failed_requests+=t.metadata.total_failed_requests||0,a.total_tokens+=t.metadata.total_tokens||0)}v({results:l,metadata:a})}catch(e){throw console.error("Error fetching user spend data:",e),e}};(0,x.useEffect)(()=>{P()},[m,_]);let A=ay(f,"models"),T=ay(f,"api_keys");return(0,h.jsxs)("div",{style:{width:"100%"},className:"p-8",children:[eF.includes(u||"")?(0,h.jsxs)(O.Z,{className:"text-sm text-gray-500 mb-4",children:["Note: If you see key/model-level inconsistencies between Global View and Team Usage, it's because the Global View was missing spend when user_id = null, prior to v1.71.2. ",(0,h.jsx)("a",{href:"https://github.com/BerriAI/litellm/issues/10876",className:"text-blue-500 hover:text-blue-700 ml-1",children:"Learn more here"}),"."]}):null,(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{variant:"solid",className:"mt-1",children:[eF.includes(u||"")?(0,h.jsx)(e2.Z,{children:"Global Usage"}):(0,h.jsx)(e2.Z,{children:"Your Usage"}),(0,h.jsx)(e2.Z,{children:"Team Usage"}),eF.includes(u||"")?(0,h.jsx)(e2.Z,{children:"Tag Usage"}):(0,h.jsx)(h.Fragment,{})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsxs)(e6.Z,{children:[(0,h.jsx)(I.Z,{numItems:2,className:"gap-2 w-full mb-4",children:(0,h.jsx)(C.Z,{children:(0,h.jsx)(s5,{value:_,onValueChange:e=>{b(e)}})})}),(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{variant:"solid",className:"mt-1",children:[(0,h.jsx)(e2.Z,{children:"Cost"}),(0,h.jsx)(e2.Z,{children:"Model Activity"}),(0,h.jsx)(e2.Z,{children:"Key Activity"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:2,className:"gap-2 w-full",children:[(0,h.jsxs)(C.Z,{numColSpan:2,children:[(0,h.jsxs)(O.Z,{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content mb-2 mt-2 text-lg",children:["Project Spend ",new Date().toLocaleString("default",{month:"long"})," 1 - ",new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate()]}),(0,h.jsx)(ax,{userID:p,userRole:u,accessToken:m,userSpend:k,selectedTeam:null,userMaxBudget:null})]}),(0,h.jsx)(C.Z,{numColSpan:2,children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Usage Metrics"}),(0,h.jsxs)(I.Z,{numItems:5,className:"gap-4 mt-4",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Total Requests"}),(0,h.jsx)(O.Z,{className:"text-2xl font-bold mt-2",children:(null===(l=f.metadata)||void 0===l?void 0:null===(t=l.total_api_requests)||void 0===t?void 0:t.toLocaleString())||0})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Successful Requests"}),(0,h.jsx)(O.Z,{className:"text-2xl font-bold mt-2 text-green-600",children:(null===(r=f.metadata)||void 0===r?void 0:null===(a=r.total_successful_requests)||void 0===a?void 0:a.toLocaleString())||0})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Failed Requests"}),(0,h.jsx)(O.Z,{className:"text-2xl font-bold mt-2 text-red-600",children:(null===(i=f.metadata)||void 0===i?void 0:null===(n=i.total_failed_requests)||void 0===n?void 0:n.toLocaleString())||0})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Total Tokens"}),(0,h.jsx)(O.Z,{className:"text-2xl font-bold mt-2",children:(null===(c=f.metadata)||void 0===c?void 0:null===(o=c.total_tokens)||void 0===o?void 0:o.toLocaleString())||0})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Average Cost per Request"}),(0,h.jsxs)(O.Z,{className:"text-2xl font-bold mt-2",children:["$",eH((k||0)/((null===(d=f.metadata)||void 0===d?void 0:d.total_api_requests)||1),4)]})]})]})]})}),(0,h.jsx)(C.Z,{numColSpan:2,children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Daily Spend"}),(0,h.jsx)(s3.Z,{data:[...f.results].sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()),index:"date",categories:["metrics.spend"],colors:["cyan"],valueFormatter:e=>"$".concat(eH(e,2)),yAxisWidth:100,showLegend:!1,customTooltip:e=>{let{payload:s,active:t}=e;if(!t||!(null==s?void 0:s[0]))return null;let l=s[0].payload;return(0,h.jsxs)("div",{className:"bg-white p-4 shadow-lg rounded-lg border",children:[(0,h.jsx)("p",{className:"font-bold",children:l.date}),(0,h.jsxs)("p",{className:"text-cyan-500",children:["Spend: $",eH(l.metrics.spend,2)]}),(0,h.jsxs)("p",{className:"text-gray-600",children:["Requests: ",l.metrics.api_requests]}),(0,h.jsxs)("p",{className:"text-gray-600",children:["Successful: ",l.metrics.successful_requests]}),(0,h.jsxs)("p",{className:"text-gray-600",children:["Failed: ",l.metrics.failed_requests]}),(0,h.jsxs)("p",{className:"text-gray-600",children:["Tokens: ",l.metrics.total_tokens]})]})}})]})}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(eo.Z,{className:"h-full",children:[(0,h.jsx)(M.Z,{children:"Top API Keys"}),(0,h.jsx)(ag,{topKeys:(()=>{let e={};return f.results.forEach(s=>{Object.entries(s.breakdown.api_keys||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{key_alias:l.metadata.key_alias}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.prompt_tokens+=l.metrics.prompt_tokens,e[t].metrics.completion_tokens+=l.metrics.completion_tokens,e[t].metrics.total_tokens+=l.metrics.total_tokens,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests,e[t].metrics.failed_requests+=l.metrics.failed_requests,e[t].metrics.cache_read_input_tokens+=l.metrics.cache_read_input_tokens||0,e[t].metrics.cache_creation_input_tokens+=l.metrics.cache_creation_input_tokens||0})}),Object.entries(e).map(e=>{let[s,t]=e;return{api_key:s,key_alias:t.metadata.key_alias||"-",spend:t.metrics.spend}}).sort((e,s)=>s.spend-e.spend).slice(0,5)})(),accessToken:m,userID:p,userRole:u,teams:null,premiumUser:j})]})}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(eo.Z,{className:"h-full",children:[(0,h.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,h.jsx)(M.Z,{children:"Top Models"})}),(0,h.jsx)(s3.Z,{className:"mt-4 h-40",data:(()=>{let e={};return f.results.forEach(s=>{Object.entries(s.breakdown.models||{}).forEach(s=>{let[t,l]=s;e[t]||(e[t]={metrics:{spend:0,prompt_tokens:0,completion_tokens:0,total_tokens:0,api_requests:0,successful_requests:0,failed_requests:0,cache_read_input_tokens:0,cache_creation_input_tokens:0},metadata:{}}),e[t].metrics.spend+=l.metrics.spend,e[t].metrics.prompt_tokens+=l.metrics.prompt_tokens,e[t].metrics.completion_tokens+=l.metrics.completion_tokens,e[t].metrics.total_tokens+=l.metrics.total_tokens,e[t].metrics.api_requests+=l.metrics.api_requests,e[t].metrics.successful_requests+=l.metrics.successful_requests||0,e[t].metrics.failed_requests+=l.metrics.failed_requests||0,e[t].metrics.cache_read_input_tokens+=l.metrics.cache_read_input_tokens||0,e[t].metrics.cache_creation_input_tokens+=l.metrics.cache_creation_input_tokens||0})}),Object.entries(e).map(e=>{let[s,t]=e;return{key:s,spend:t.metrics.spend,requests:t.metrics.api_requests,successful_requests:t.metrics.successful_requests,failed_requests:t.metrics.failed_requests,tokens:t.metrics.total_tokens}}).sort((e,s)=>s.spend-e.spend).slice(0,5)})(),index:"key",categories:["spend"],colors:["cyan"],valueFormatter:e=>"$".concat(eH(e,2)),layout:"vertical",yAxisWidth:200,showLegend:!1,customTooltip:e=>{let{payload:s,active:t}=e;if(!t||!(null==s?void 0:s[0]))return null;let l=s[0].payload;return(0,h.jsxs)("div",{className:"bg-white p-4 shadow-lg rounded-lg border",children:[(0,h.jsx)("p",{className:"font-bold",children:l.key}),(0,h.jsxs)("p",{className:"text-cyan-500",children:["Spend: $",eH(l.spend,2)]}),(0,h.jsxs)("p",{className:"text-gray-600",children:["Total Requests: ",l.requests.toLocaleString()]}),(0,h.jsxs)("p",{className:"text-green-600",children:["Successful: ",l.successful_requests.toLocaleString()]}),(0,h.jsxs)("p",{className:"text-red-600",children:["Failed: ",l.failed_requests.toLocaleString()]}),(0,h.jsxs)("p",{className:"text-gray-600",children:["Tokens: ",l.tokens.toLocaleString()]})]})}})]})}),(0,h.jsx)(C.Z,{numColSpan:2,children:(0,h.jsxs)(eo.Z,{className:"h-full",children:[(0,h.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,h.jsx)(M.Z,{children:"Spend by Provider"})}),(0,h.jsxs)(I.Z,{numItems:2,children:[(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)(ah.Z,{className:"mt-4 h-40",data:S(),index:"provider",category:"spend",valueFormatter:e=>"$".concat(eH(e,2)),colors:["cyan"]})}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Provider"}),(0,h.jsx)(sS.Z,{children:"Spend"}),(0,h.jsx)(sS.Z,{className:"text-green-600",children:"Successful"}),(0,h.jsx)(sS.Z,{className:"text-red-600",children:"Failed"}),(0,h.jsx)(sS.Z,{children:"Tokens"})]})}),(0,h.jsx)(sZ.Z,{children:S().filter(e=>e.spend>0).map(e=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:e.provider}),(0,h.jsxs)(sw.Z,{children:["$",eH(e.spend,2)]}),(0,h.jsx)(sw.Z,{className:"text-green-600",children:e.successful_requests.toLocaleString()}),(0,h.jsx)(sw.Z,{className:"text-red-600",children:e.failed_requests.toLocaleString()}),(0,h.jsx)(sw.Z,{children:e.tokens.toLocaleString()})]},e.provider))})]})})]})]})})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(av,{modelMetrics:A})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(av,{modelMetrics:T})})]})]})]}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(ab,{accessToken:m,entityType:"team",userID:p,userRole:u,entityList:(null==g?void 0:g.map(e=>({label:e.team_alias,value:e.team_id})))||null,premiumUser:j})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(ab,{accessToken:m,entityType:"tag",userID:p,userRole:u,entityList:N,premiumUser:j})})]})]})]})},aZ=e=>{let{proxySettings:s}=e,t="<your_proxy_base_url>";return s&&s.PROXY_BASE_URL&&void 0!==s.PROXY_BASE_URL&&(t=s.PROXY_BASE_URL),(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(I.Z,{className:"gap-2 p-8 h-[80vh] w-full mt-2",children:(0,h.jsxs)("div",{className:"mb-5",children:[(0,h.jsx)("p",{className:"text-2xl text-tremor-content-strong dark:text-dark-tremor-content-strong font-semibold",children:"OpenAI Compatible Proxy: API Reference"}),(0,h.jsx)(O.Z,{className:"mt-2 mb-2",children:"LiteLLM is OpenAI Compatible. This means your API Key works with the OpenAI SDK. Just replace the base_url to point to your litellm proxy. Example Below "}),(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{children:[(0,h.jsx)(e2.Z,{children:"OpenAI Python SDK"}),(0,h.jsx)(e2.Z,{children:"LlamaIndex"}),(0,h.jsx)(e2.Z,{children:"Langchain Py"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lQ.Z,{language:"python",children:'\nimport openai\nclient = openai.OpenAI(\n    api_key="your_api_key",\n    base_url="'.concat(t,'" # LiteLLM Proxy is OpenAI compatible, Read More: https://docs.litellm.ai/docs/proxy/user_keys\n)\n\nresponse = client.chat.completions.create(\n    model="gpt-3.5-turbo", # model to send to the proxy\n    messages = [\n        {\n            "role": "user",\n            "content": "this is a test request, write a short poem"\n        }\n    ]\n)\n\nprint(response)\n            ')})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lQ.Z,{language:"python",children:'\nimport os, dotenv\n\nfrom llama_index.llms import AzureOpenAI\nfrom llama_index.embeddings import AzureOpenAIEmbedding\nfrom llama_index import VectorStoreIndex, SimpleDirectoryReader, ServiceContext\n\nllm = AzureOpenAI(\n    engine="azure-gpt-3.5",               # model_name on litellm proxy\n    temperature=0.0,\n    azure_endpoint="'.concat(t,'", # litellm proxy endpoint\n    api_key="sk-1234",                    # litellm proxy API Key\n    api_version="2023-07-01-preview",\n)\n\nembed_model = AzureOpenAIEmbedding(\n    deployment_name="azure-embedding-model",\n    azure_endpoint="').concat(t,'",\n    api_key="sk-1234",\n    api_version="2023-07-01-preview",\n)\n\n\ndocuments = SimpleDirectoryReader("llama_index_data").load_data()\nservice_context = ServiceContext.from_defaults(llm=llm, embed_model=embed_model)\nindex = VectorStoreIndex.from_documents(documents, service_context=service_context)\n\nquery_engine = index.as_query_engine()\nresponse = query_engine.query("What did the author do growing up?")\nprint(response)\n\n            ')})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(lQ.Z,{language:"python",children:'\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.prompts.chat import (\n    ChatPromptTemplate,\n    HumanMessagePromptTemplate,\n    SystemMessagePromptTemplate,\n)\nfrom langchain.schema import HumanMessage, SystemMessage\n\nchat = ChatOpenAI(\n    openai_api_base="'.concat(t,'",\n    model = "gpt-3.5-turbo",\n    temperature=0.1\n)\n\nmessages = [\n    SystemMessage(\n        content="You are a helpful assistant that im using to make a test request to."\n    ),\n    HumanMessage(\n        content="test from litellm. tell me why it\'s amazing in 1 sentence"\n    ),\n]\nresponse = chat(messages)\n\nprint(response)\n\n            ')})})]})]})]})})})},aw=t(243),ak=t(93837);async function aS(e,s,t,l,a,r,n,i,o,c,d,m){console.log=function(){},console.log("isLocal:",!1);let u=(0,y.zX)(),h={};a&&a.length>0&&(h["x-litellm-tags"]=a.join(","));let x=new lH.ZP.OpenAI({apiKey:l,baseURL:u,dangerouslyAllowBrowser:!0,defaultHeaders:h});try{let l;let a=Date.now(),u=!1;for await(let h of(await x.chat.completions.create({model:t,stream:!0,stream_options:{include_usage:!0},litellm_trace_id:c,messages:e,...d?{vector_store_ids:d}:{},...m?{guardrails:m}:{}},{signal:r}))){var p,g,j,f,v,_,b,N;console.log("Stream chunk:",h);let e=null===(p=h.choices[0])||void 0===p?void 0:p.delta;if(console.log("Delta content:",null===(j=h.choices[0])||void 0===j?void 0:null===(g=j.delta)||void 0===g?void 0:g.content),console.log("Delta reasoning content:",null==e?void 0:e.reasoning_content),!u&&((null===(v=h.choices[0])||void 0===v?void 0:null===(f=v.delta)||void 0===f?void 0:f.content)||e&&e.reasoning_content)&&(u=!0,l=Date.now()-a,console.log("First token received! Time:",l,"ms"),i?(console.log("Calling onTimingData with:",l),i(l)):console.log("onTimingData callback is not defined!")),null===(b=h.choices[0])||void 0===b?void 0:null===(_=b.delta)||void 0===_?void 0:_.content){let e=h.choices[0].delta.content;s(e,h.model)}if(e&&e.reasoning_content){let s=e.reasoning_content;n&&n(s)}if(h.usage&&o){console.log("Usage data found:",h.usage);let e={completionTokens:h.usage.completion_tokens,promptTokens:h.usage.prompt_tokens,totalTokens:h.usage.total_tokens};(null===(N=h.usage.completion_tokens_details)||void 0===N?void 0:N.reasoning_tokens)&&(e.reasoningTokens=h.usage.completion_tokens_details.reasoning_tokens),o(e)}}}catch(e){throw(null==r?void 0:r.aborted)&&console.log("Chat completion request was cancelled"),e}}async function aC(e,s,t,l,a,r){console.log=function(){},console.log("isLocal:",!1);let n=(0,y.zX)(),i=new lH.ZP.OpenAI({apiKey:l,baseURL:n,dangerouslyAllowBrowser:!0,defaultHeaders:a&&a.length>0?{"x-litellm-tags":a.join(",")}:void 0});try{let l=await i.images.generate({model:t,prompt:e},{signal:r});if(console.log(l.data),l.data&&l.data[0]){if(l.data[0].url)s(l.data[0].url,t);else if(l.data[0].b64_json){let e=l.data[0].b64_json;s("data:image/png;base64,".concat(e),t)}else throw Error("No image data found in response")}else throw Error("Invalid response format")}catch(e){throw(null==r?void 0:r.aborted)?console.log("Image generation request was cancelled"):z.ZP.error("Error occurred while generating image. Please try again. Error: ".concat(e),20),e}}async function aI(e,s,t,l,a,r,n){console.log=function(){},console.log("isLocal:",!1);let i=(0,y.zX)(),o=new lH.ZP.OpenAI({apiKey:a,baseURL:i,dangerouslyAllowBrowser:!0,defaultHeaders:r&&r.length>0?{"x-litellm-tags":r.join(",")}:void 0});try{let a=await o.images.edit({model:l,image:e,prompt:s},{signal:n});if(console.log(a.data),a.data&&a.data[0]){if(a.data[0].url)t(a.data[0].url,l);else if(a.data[0].b64_json){let e=a.data[0].b64_json;t("data:image/png;base64,".concat(e),l)}else throw Error("No image data found in response")}else throw Error("Invalid response format")}catch(e){throw(null==n?void 0:n.aborted)?console.log("Image edits request was cancelled"):z.ZP.error("Error occurred while editing image. Please try again. Error: ".concat(e),20),e}}async function aP(e,s,t,l){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=arguments.length>5?arguments[5]:void 0,n=arguments.length>6?arguments[6]:void 0,i=arguments.length>7?arguments[7]:void 0,o=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,d=arguments.length>10?arguments[10]:void 0,m=arguments.length>11?arguments[11]:void 0;if(!l)throw Error("API key is required");console.log=function(){};let u=(0,y.zX)(),h={};a&&a.length>0&&(h["x-litellm-tags"]=a.join(","));let x=new lH.ZP.OpenAI({apiKey:l,baseURL:u,dangerouslyAllowBrowser:!0,defaultHeaders:h});try{let l=Date.now(),a=!1,u=e.map(e=>({role:e.role,content:e.content,type:"message"}));for await(let e of(await x.responses.create({model:t,input:u,stream:!0,litellm_trace_id:c,...d?{vector_store_ids:d}:{},...m?{guardrails:m}:{}},{signal:r})))if(console.log("Response event:",e),"object"==typeof e&&null!==e){if("response.role.delta"===e.type)continue;if("response.output_text.delta"===e.type&&"string"==typeof e.delta){let r=e.delta;if(console.log("Text delta",r),r.trim().length>0&&(s("assistant",r,t),!a)){a=!0;let e=Date.now()-l;console.log("First token received! Time:",e,"ms"),i&&i(e)}}if("response.reasoning.delta"===e.type&&"delta"in e){let s=e.delta;"string"==typeof s&&n&&n(s)}if("response.completed"===e.type&&"response"in e){let s=e.response.usage;if(console.log("Usage data:",s),s&&o){var p;console.log("Usage data:",s);let e={completionTokens:s.output_tokens,promptTokens:s.input_tokens,totalTokens:s.total_tokens};(null===(p=s.completion_tokens_details)||void 0===p?void 0:p.reasoning_tokens)&&(e.reasoningTokens=s.completion_tokens_details.reasoning_tokens),o(e)}}}}catch(e){throw(null==r?void 0:r.aborted)?console.log("Responses API request was cancelled"):z.ZP.error("Error occurred while generating model response. Please try again. Error: ".concat(e),20),e}}var aA=t(85498);async function aT(e,s,t,l){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=arguments.length>5?arguments[5]:void 0,n=arguments.length>6?arguments[6]:void 0,i=arguments.length>7?arguments[7]:void 0,o=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,d=arguments.length>10?arguments[10]:void 0,m=arguments.length>11?arguments[11]:void 0;if(!l)throw Error("API key is required");console.log=function(){};let u=(0,y.zX)(),h={};a&&a.length>0&&(h["x-litellm-tags"]=a.join(","));let x=new aA.ZP({apiKey:l,baseURL:u,dangerouslyAllowBrowser:!0,defaultHeaders:h});try{let l=Date.now(),a=!1,u={model:t,messages:e.map(e=>({role:e.role,content:e.content})),stream:!0,max_tokens:1024,litellm_trace_id:c};for await(let e of(d&&(u.vector_store_ids=d),m&&(u.guardrails=m),x.messages.stream(u,{signal:r}))){if(console.log("Stream event:",e),"content_block_delta"===e.type){let r=e.delta;if(!a){a=!0;let e=Date.now()-l;console.log("First token received! Time:",e,"ms"),i&&i(e)}"text_delta"===r.type?s("assistant",r.text,t):"reasoning_delta"===r.type&&n&&n(r.text)}if("message_delta"===e.type&&e.usage&&o){let s=e.usage;console.log("Usage data found:",s);let t={completionTokens:s.output_tokens,promptTokens:s.input_tokens,totalTokens:s.input_tokens+s.output_tokens};o(t)}}}catch(e){throw(null==r?void 0:r.aborted)?console.log("Anthropic messages request was cancelled"):z.ZP.error("Error occurred while generating model response. Please try again. Error: ".concat(e),20),e}}let aE=async e=>{try{let s=await (0,y.kn)(e);if(console.log("model_info:",s),(null==s?void 0:s.data.length)>0){let e=s.data.map(e=>({model_group:e.model_group,mode:null==e?void 0:e.mode}));return e.sort((e,s)=>e.model_group.localeCompare(s.model_group)),e}return[]}catch(e){throw console.error("Error fetching model info:",e),e}};(r=d||(d={})).IMAGE_GENERATION="image_generation",r.CHAT="chat",r.RESPONSES="responses",r.IMAGE_EDITS="image_edits",r.ANTHROPIC_MESSAGES="anthropic_messages",(n=m||(m={})).IMAGE="image",n.CHAT="chat",n.RESPONSES="responses",n.IMAGE_EDITS="image_edits",n.ANTHROPIC_MESSAGES="anthropic_messages";var aL=t(94263),aO=e=>{let{endpointType:s,onEndpointChange:t,className:l}=e,a=[{value:m.CHAT,label:"/v1/chat/completions"},{value:m.RESPONSES,label:"/v1/responses"},{value:m.ANTHROPIC_MESSAGES,label:"/v1/messages"},{value:m.IMAGE,label:"/v1/images/generations"},{value:m.IMAGE_EDITS,label:"/v1/images/edits"}];return(0,h.jsxs)("div",{className:l,children:[(0,h.jsx)(O.Z,{children:"Endpoint Type:"}),(0,h.jsx)(F.default,{showSearch:!0,value:s,style:{width:"100%"},onChange:t,options:a,className:"rounded-md"})]})},aM=e=>{let{onChange:s,value:t,className:l,accessToken:a}=e,[r,n]=(0,x.useState)([]),[i,o]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{(async()=>{if(a)try{let e=await (0,y.UM)(a);console.log("List tags response:",e),n(Object.values(e))}catch(e){console.error("Error fetching tags:",e)}})()},[]),(0,h.jsx)(F.default,{mode:"multiple",placeholder:"Select tags",onChange:s,value:t,loading:i,className:l,options:r.map(e=>({label:e.name,value:e.name,title:e.description||e.name})),optionFilterProp:"label",showSearch:!0,style:{width:"100%"}})},aD=e=>{let{onChange:s,value:t,className:l,accessToken:a}=e,[r,n]=(0,x.useState)([]),[i,o]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{(async()=>{if(a){o(!0);try{let e=await (0,y.t3)(a);console.log("Guardrails response:",e),e.guardrails&&(console.log("Guardrails data:",e.guardrails),n(e.guardrails))}catch(e){console.error("Error fetching guardrails:",e)}finally{o(!1)}}})()},[a]),(0,h.jsx)("div",{children:(0,h.jsx)(F.default,{mode:"multiple",placeholder:"Select guardrails",onChange:e=>{console.log("Selected guardrails:",e),s(e)},value:t,loading:i,className:l,options:r.map(e=>(console.log("Mapping guardrail:",e),{label:"".concat(e.guardrail_name),value:e.guardrail_name})),optionFilterProp:"label",showSearch:!0,style:{width:"100%"}})})};let aF=e=>{let s;let{apiKeySource:t,accessToken:l,apiKey:a,inputMessage:r,chatHistory:n,selectedTags:i,selectedVectorStores:o,selectedGuardrails:c,endpointType:d,selectedModel:u,selectedSdk:h}=e,x="session"===t?l:a,p=window.location.origin,g=(r||"Your prompt here").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n"),j=n.filter(e=>!e.isImage).map(e=>{let{role:s,content:t}=e;return{role:s,content:t}}),f={};i.length>0&&(f.tags=i),o.length>0&&(f.vector_stores=o),c.length>0&&(f.guardrails=c);let v=u||"your-model-name",_="azure"===h?'import openai\n\nclient = openai.AzureOpenAI(\n	api_key="'.concat(x||"YOUR_LITELLM_API_KEY",'",\n	azure_endpoint="').concat(p,'",\n	api_version="2024-02-01"\n)'):'import openai\n\nclient = openai.OpenAI(\n	api_key="'.concat(x||"YOUR_LITELLM_API_KEY",'",\n	base_url="').concat(p,'"\n)');switch(d){case m.CHAT:{let e=Object.keys(f).length>0,t="";if(e){let e=JSON.stringify({metadata:f},null,2).split("\n").map(e=>" ".repeat(4)+e).join("\n").trim();t=",\n    extra_body=".concat(e)}s='\n# request sent to model set on litellm proxy, `litellm --model`\nresponse = client.chat.completions.create(\n	model="'.concat(v,'",\n	messages = ').concat(JSON.stringify(j,null,4)).concat(t,"\n)\n\nprint(response)\n");break}case m.RESPONSES:{let e=Object.keys(f).length>0,t="";if(e){let e=JSON.stringify({metadata:f},null,2).split("\n").map(e=>" ".repeat(4)+e).join("\n").trim();t=",\n    extra_body=".concat(e)}s='\n# request sent to model set on litellm proxy, `litellm --model`\nresponse = client.responses.create(\n	model="'.concat(v,'",\n	messages = ').concat(JSON.stringify(j,null,4)).concat(t,"\n)\n\nprint(response)\n");break}case m.IMAGE:s="azure"===h?"\n# NOTE: The Azure SDK does not have a direct equivalent to the multi-modal 'responses.create' method shown for OpenAI.\n# This snippet uses 'client.images.generate' and will create a new image based on your prompt.\n# It does not use the uploaded image, as 'client.images.generate' does not support image inputs in this context.\nimport os\nimport requests\nimport json\nimport time\nfrom PIL import Image\n\nresult = client.images.generate(\n	model=\"".concat(v,'",\n	prompt="').concat(r,'",\n	n=1\n)\n\njson_response = json.loads(result.model_dump_json())\n\n# Set the directory for the stored image\nimage_dir = os.path.join(os.curdir, \'images\')\n\n# If the directory doesn\'t exist, create it\nif not os.path.isdir(image_dir):\n	os.mkdir(image_dir)\n\n# Initialize the image path\nimage_filename = f"generated_image_{int(time.time())}.png"\nimage_path = os.path.join(image_dir, image_filename)\n\ntry:\n	# Retrieve the generated image\n	if json_response.get("data") && len(json_response["data"]) > 0 && json_response["data"][0].get("url"):\n			image_url = json_response["data"][0]["url"]\n			generated_image = requests.get(image_url).content\n			with open(image_path, "wb") as image_file:\n					image_file.write(generated_image)\n\n			print(f"Image saved to {image_path}")\n			# Display the image\n			image = Image.open(image_path)\n			image.show()\n	else:\n			print("Could not find image URL in response.")\n			print("Full response:", json_response)\nexcept Exception as e:\n	print(f"An error occurred: {e}")\n	print("Full response:", json_response)\n'):"\nimport base64\nimport os\nimport time\nimport json\nfrom PIL import Image\nimport requests\n\n# Helper function to encode images to base64\ndef encode_image(image_path):\n	with open(image_path, \"rb\") as image_file:\n			return base64.b64encode(image_file.read()).decode('utf-8')\n\n# Helper function to create a file (simplified for this example)\ndef create_file(image_path):\n	# In a real implementation, this would upload the file to OpenAI\n	# For this example, we'll just return a placeholder ID\n	return f\"file_{os.path.basename(image_path).replace('.', '_')}\"\n\n# The prompt entered by the user\nprompt = \"".concat(g,'"\n\n# Encode images to base64\nbase64_image1 = encode_image("body-lotion.png")\nbase64_image2 = encode_image("soap.png")\n\n# Create file IDs\nfile_id1 = create_file("body-lotion.png")\nfile_id2 = create_file("incense-kit.png")\n\nresponse = client.responses.create(\n	model="').concat(v,'",\n	input=[\n			{\n					"role": "user",\n					"content": [\n							{"type": "input_text", "text": prompt},\n							{\n									"type": "input_image",\n									"image_url": f"data:image/jpeg;base64,{base64_image1}",\n							},\n							{\n									"type": "input_image",\n									"image_url": f"data:image/jpeg;base64,{base64_image2}",\n							},\n							{\n									"type": "input_image",\n									"file_id": file_id1,\n							},\n							{\n									"type": "input_image",\n									"file_id": file_id2,\n							}\n					],\n			}\n	],\n	tools=[{"type": "image_generation"}],\n)\n\n# Process the response\nimage_generation_calls = [\n	output\n	for output in response.output\n	if output.type == "image_generation_call"\n]\n\nimage_data = [output.result for output in image_generation_calls]\n\nif image_data:\n	image_base64 = image_data[0]\n	image_filename = f"edited_image_{int(time.time())}.png"\n	with open(image_filename, "wb") as f:\n			f.write(base64.b64decode(image_base64))\n	print(f"Image saved to {image_filename}")\nelse:\n	# If no image is generated, there might be a text response with an explanation\n	text_response = [output.text for output in response.output if hasattr(output, \'text\')]\n	if text_response:\n			print("No image generated. Model response:")\n			print("\\n".join(text_response))\n	else:\n			print("No image data found in response.")\n	print("Full response for debugging:")\n	print(response)\n');break;case m.IMAGE_EDITS:s="azure"===h?'\nimport base64\nimport os\nimport time\nimport json\nfrom PIL import Image\nimport requests\n\n# Helper function to encode images to base64\ndef encode_image(image_path):\n	with open(image_path, "rb") as image_file:\n			return base64.b64encode(image_file.read()).decode(\'utf-8\')\n\n# The prompt entered by the user\nprompt = "'.concat(g,'"\n\n# Encode images to base64\nbase64_image1 = encode_image("body-lotion.png")\nbase64_image2 = encode_image("soap.png")\n\n# Create file IDs\nfile_id1 = create_file("body-lotion.png")\nfile_id2 = create_file("incense-kit.png")\n\nresponse = client.responses.create(\n	model="').concat(v,'",\n	input=[\n			{\n					"role": "user",\n					"content": [\n							{"type": "input_text", "text": prompt},\n							{\n									"type": "input_image",\n									"image_url": f"data:image/jpeg;base64,{base64_image1}",\n							},\n							{\n									"type": "input_image",\n									"image_url": f"data:image/jpeg;base64,{base64_image2}",\n							},\n							{\n									"type": "input_image",\n									"file_id": file_id1,\n							},\n							{\n									"type": "input_image",\n									"file_id": file_id2,\n							}\n					],\n			}\n	],\n	tools=[{"type": "image_generation"}],\n)\n\n# Process the response\nimage_generation_calls = [\n	output\n	for output in response.output\n	if output.type == "image_generation_call"\n]\n\nimage_data = [output.result for output in image_generation_calls]\n\nif image_data:\n	image_base64 = image_data[0]\n	image_filename = f"edited_image_{int(time.time())}.png"\n	with open(image_filename, "wb") as f:\n			f.write(base64.b64decode(image_base64))\n	print(f"Image saved to {image_filename}")\nelse:\n	# If no image is generated, there might be a text response with an explanation\n	text_response = [output.text for output in response.output if hasattr(output, \'text\')]\n	if text_response:\n			print("No image generated. Model response:")\n			print("\\n".join(text_response))\n	else:\n			print("No image data found in response.")\n	print("Full response for debugging:")\n	print(response)\n'):"\nimport base64\nimport os\nimport time\n\n# Helper function to encode images to base64\ndef encode_image(image_path):\n	with open(image_path, \"rb\") as image_file:\n			return base64.b64encode(image_file.read()).decode('utf-8')\n\n# Helper function to create a file (simplified for this example)\ndef create_file(image_path):\n	# In a real implementation, this would upload the file to OpenAI\n	# For this example, we'll just return a placeholder ID\n	return f\"file_{os.path.basename(image_path).replace('.', '_')}\"\n\n# The prompt entered by the user\nprompt = \"".concat(g,'"\n\n# Encode images to base64\nbase64_image1 = encode_image("body-lotion.png")\nbase64_image2 = encode_image("soap.png")\n\n# Create file IDs\nfile_id1 = create_file("body-lotion.png")\nfile_id2 = create_file("incense-kit.png")\n\nresponse = client.responses.create(\n	model="').concat(v,'",\n	input=[\n			{\n					"role": "user",\n					"content": [\n							{"type": "input_text", "text": prompt},\n							{\n									"type": "input_image",\n									"image_url": f"data:image/jpeg;base64,{base64_image1}",\n							},\n							{\n									"type": "input_image",\n									"image_url": f"data:image/jpeg;base64,{base64_image2}",\n							},\n							{\n									"type": "input_image",\n									"file_id": file_id1,\n							},\n							{\n									"type": "input_image",\n									"file_id": file_id2,\n							}\n					],\n			}\n	],\n	tools=[{"type": "image_generation"}],\n)\n\n# Process the response\nimage_generation_calls = [\n	output\n	for output in response.output\n	if output.type == "image_generation_call"\n]\n\nimage_data = [output.result for output in image_generation_calls]\n\nif image_data:\n	image_base64 = image_data[0]\n	image_filename = f"edited_image_{int(time.time())}.png"\n	with open(image_filename, "wb") as f:\n			f.write(base64.b64decode(image_base64))\n	print(f"Image saved to {image_filename}")\nelse:\n	# If no image is generated, there might be a text response with an explanation\n	text_response = [output.text for output in response.output if hasattr(output, \'text\')]\n	if text_response:\n			print("No image generated. Model response:")\n			print("\\n".join(text_response))\n	else:\n			print("No image data found in response.")\n	print("Full response for debugging:")\n	print(response)\n');break;default:s="\n# Code generation for this endpoint is not implemented yet."}return"".concat(_,"\n").concat(s)};var aR=t(83322),az=t(70464),aq=e=>{let{reasoningContent:s}=e,[t,l]=(0,x.useState)(!0);return s?(0,h.jsxs)("div",{className:"reasoning-content mt-1 mb-2",children:[(0,h.jsxs)(V.ZP,{type:"text",className:"flex items-center text-xs text-gray-500 hover:text-gray-700",onClick:()=>l(!t),icon:(0,h.jsx)(aR.Z,{}),children:[t?"Hide reasoning":"Show reasoning",t?(0,h.jsx)(az.Z,{className:"ml-1"}):(0,h.jsx)(tW.Z,{className:"ml-1"})]}),t&&(0,h.jsx)("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md text-sm text-gray-700",children:(0,h.jsx)(aw.U,{components:{code(e){let{node:s,inline:t,className:l,children:a,...r}=e,n=/language-(\w+)/.exec(l||"");return!t&&n?(0,h.jsx)(lQ.Z,{style:aL.Z,language:n[1],PreTag:"div",className:"rounded-md my-2",...r,children:String(a).replace(/\n$/,"")}):(0,h.jsx)("code",{className:"".concat(l," px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono"),...r,children:a})}},children:s})})]}):null},aU=t(5540),aV=t(71282),aK=t(11741),aB=t(16601),aH=e=>{let{timeToFirstToken:s,usage:t}=e;return s||t?(0,h.jsxs)("div",{className:"response-metrics mt-2 pt-2 border-t border-gray-100 text-xs text-gray-500 flex flex-wrap gap-3",children:[void 0!==s&&(0,h.jsx)(X.Z,{title:"Time to first token",children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(aU.Z,{className:"mr-1"}),(0,h.jsxs)("span",{children:[(s/1e3).toFixed(2),"s"]})]})}),(null==t?void 0:t.promptTokens)!==void 0&&(0,h.jsx)(X.Z,{title:"Prompt tokens",children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(aV.Z,{className:"mr-1"}),(0,h.jsxs)("span",{children:["In: ",t.promptTokens]})]})}),(null==t?void 0:t.completionTokens)!==void 0&&(0,h.jsx)(X.Z,{title:"Completion tokens",children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(aK.Z,{className:"mr-1"}),(0,h.jsxs)("span",{children:["Out: ",t.completionTokens]})]})}),(null==t?void 0:t.reasoningTokens)!==void 0&&(0,h.jsx)(X.Z,{title:"Reasoning tokens",children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(aR.Z,{className:"mr-1"}),(0,h.jsxs)("span",{children:["Reasoning: ",t.reasoningTokens]})]})}),(null==t?void 0:t.totalTokens)!==void 0&&(0,h.jsx)(X.Z,{title:"Total tokens",children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(aB.Z,{className:"mr-1"}),(0,h.jsxs)("span",{children:["Total: ",t.totalTokens]})]})})]}):null},aG=t(61935),aJ=t(69993),aY=t(71891),aW=t(44625),a$=t(57400),aX=t(26430),aQ=t(11894),a0=t(99890),a1=t(23907);let{TextArea:a2}=K.default,{Dragger:a4}=e_.default;var a5=e=>{let{accessToken:s,token:t,userRole:l,userID:a,disabledPersonalKeyCreation:r}=e,[n,i]=(0,x.useState)(r?"custom":"session"),[o,c]=(0,x.useState)(""),[d,u]=(0,x.useState)(""),[p,g]=(0,x.useState)([]),[j,f]=(0,x.useState)(void 0),[v,_]=(0,x.useState)(!1),[y,N]=(0,x.useState)([]),Z=(0,x.useRef)(null),[w,k]=(0,x.useState)(m.CHAT),[S,C]=(0,x.useState)(!1),I=(0,x.useRef)(null),[T,E]=(0,x.useState)([]),[L,D]=(0,x.useState)([]),[R,U]=(0,x.useState)([]),[K,B]=(0,x.useState)(null),[H,G]=(0,x.useState)(null),[J,Y]=(0,x.useState)(null),[W,Q]=(0,x.useState)(!1),[ee,es]=(0,x.useState)(""),[et,ea]=(0,x.useState)("openai"),er=(0,x.useRef)(null);(0,x.useEffect)(()=>{W&&es(aF({apiKeySource:n,accessToken:s,apiKey:o,inputMessage:d,chatHistory:p,selectedTags:T,selectedVectorStores:L,selectedGuardrails:R,endpointType:w,selectedModel:j,selectedSdk:et}))},[W,et,n,s,o,d,p,T,L,R,w,j]),(0,x.useEffect)(()=>{let e="session"===n?s:o;if(!e||!t||!l||!a){console.log("userApiKey or token or userRole or userID is missing = ",e,t,l,a);return}(async()=>{try{if(!e){console.log("userApiKey is missing");return}let s=await aE(e);console.log("Fetched models:",s),s.length>0&&(N(s),f(s[0].model_group))}catch(e){console.error("Error fetching model info:",e)}})()},[s,a,l,n,o]),(0,x.useEffect)(()=>{er.current&&setTimeout(()=>{var e;null===(e=er.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},100)},[p]);let en=(e,s,t)=>{console.log("updateTextUI called with:",e,s,t),g(l=>{let a=l[l.length-1];if(!a||a.role!==e||a.isImage)return[...l,{role:e,content:s,model:t}];{var r;let e={...a,content:a.content+s,model:null!==(r=a.model)&&void 0!==r?r:t};return[...l.slice(0,-1),e]}})},ei=e=>{g(s=>{let t=s[s.length-1];return t&&"assistant"===t.role&&!t.isImage?[...s.slice(0,s.length-1),{...t,reasoningContent:(t.reasoningContent||"")+e}]:s.length>0&&"user"===s[s.length-1].role?[...s,{role:"assistant",content:"",reasoningContent:e}]:s})},ec=e=>{console.log("updateTimingData called with:",e),g(s=>{let t=s[s.length-1];if(console.log("Current last message:",t),t&&"assistant"===t.role){console.log("Updating assistant message with timeToFirstToken:",e);let l=[...s.slice(0,s.length-1),{...t,timeToFirstToken:e}];return console.log("Updated chat history:",l),l}return t&&"user"===t.role?(console.log("Creating new assistant message with timeToFirstToken:",e),[...s,{role:"assistant",content:"",timeToFirstToken:e}]):(console.log("No appropriate message found to update timing"),s)})},ed=e=>{console.log("Received usage data:",e),g(s=>{let t=s[s.length-1];if(t&&"assistant"===t.role){console.log("Updating message with usage data:",e);let l={...t,usage:e};return console.log("Updated message:",l),[...s.slice(0,s.length-1),l]}return s})},em=(e,s)=>{g(t=>[...t,{role:"assistant",content:e,model:s,isImage:!0}])},eu=()=>{J&&URL.revokeObjectURL(J),G(null),Y(null)},eh=async()=>{if(""===d.trim())return;if(w===m.IMAGE_EDITS&&!H){z.ZP.error("Please upload an image for editing");return}if(!t||!l||!a)return;let e="session"===n?s:o;if(!e){z.ZP.error("Please provide an API key or select Current UI Session");return}I.current=new AbortController;let r=I.current.signal,i={role:"user",content:d},c=K||(0,ak.Z)();K||B(c),g([...p,i]),C(!0);try{if(j){if(w===m.CHAT){let s=[...p.filter(e=>!e.isImage).map(e=>{let{role:s,content:t}=e;return{role:s,content:t}}),i];await aS(s,(e,s)=>en("assistant",e,s),j,e,T,r,ei,ec,ed,c,L.length>0?L:void 0,R.length>0?R:void 0)}else if(w===m.IMAGE)await aC(d,(e,s)=>em(e,s),j,e,T,r);else if(w===m.IMAGE_EDITS)H&&await aI(H,d,(e,s)=>em(e,s),j,e,T,r);else if(w===m.RESPONSES){let s=[...p.filter(e=>!e.isImage).map(e=>{let{role:s,content:t}=e;return{role:s,content:t}}),i];await aP(s,(e,s,t)=>en(e,s,t),j,e,T,r,ei,ec,ed,c,L.length>0?L:void 0,R.length>0?R:void 0)}else if(w===m.ANTHROPIC_MESSAGES){let s=[...p.filter(e=>!e.isImage).map(e=>{let{role:s,content:t}=e;return{role:s,content:t}}),i];await aT(s,(e,s,t)=>en(e,s,t),j,e,T,r,ei,ec,ed,c,L.length>0?L:void 0,R.length>0?R:void 0)}}}catch(e){r.aborted?console.log("Request was cancelled"):(console.error("Error fetching response",e),en("assistant","Error fetching response:"+e))}finally{C(!1),I.current=null,w===m.IMAGE_EDITS&&eu()}u("")};if(l&&"Admin Viewer"===l){let{Title:e,Paragraph:s}=ef.default;return(0,h.jsxs)("div",{children:[(0,h.jsx)(e,{level:1,children:"Access Denied"}),(0,h.jsx)(s,{children:"Ask your proxy admin for access to test models"})]})}let ex=(0,h.jsx)(aG.Z,{style:{fontSize:24},spin:!0});return(0,h.jsxs)("div",{className:"w-full h-screen p-4 bg-white",children:[(0,h.jsx)(eo.Z,{className:"w-full rounded-xl shadow-md overflow-hidden",children:(0,h.jsxs)("div",{className:"flex h-[80vh] w-full gap-4",children:[(0,h.jsxs)("div",{className:"w-1/4 p-4 bg-gray-50",children:[(0,h.jsx)(M.Z,{className:"text-xl font-semibold mb-6 mt-2",children:"Configurations"}),(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)(O.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,h.jsx)(lw.Z,{className:"mr-2"})," API Key Source"]}),(0,h.jsx)(F.default,{disabled:r,defaultValue:"session",style:{width:"100%"},onChange:e=>i(e),options:[{value:"session",label:"Current UI Session"},{value:"custom",label:"Virtual Key"}],className:"rounded-md"}),"custom"===n&&(0,h.jsx)(A.Z,{className:"mt-2",placeholder:"Enter custom API key",type:"password",onValueChange:c,value:o,icon:lw.Z})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)(O.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,h.jsx)(aJ.Z,{className:"mr-2"})," Select Model"]}),(0,h.jsx)(F.default,{placeholder:"Select a Model",onChange:e=>{console.log("selected ".concat(e)),f(e),_("custom"===e)},options:[...Array.from(new Set(y.map(e=>e.model_group))).map((e,s)=>({value:e,label:e,key:s})),{value:"custom",label:"Enter custom model",key:"custom"}],style:{width:"100%"},showSearch:!0,className:"rounded-md"}),v&&(0,h.jsx)(A.Z,{className:"mt-2",placeholder:"Enter custom model name",onValueChange:e=>{Z.current&&clearTimeout(Z.current),Z.current=setTimeout(()=>{f(e)},500)}})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)(O.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,h.jsx)(tG.Z,{className:"mr-2"})," Endpoint Type"]}),(0,h.jsx)(aO,{endpointType:w,onEndpointChange:k,className:"mb-4"})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)(O.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,h.jsx)(aY.Z,{className:"mr-2"})," Tags"]}),(0,h.jsx)(aM,{value:T,onChange:E,className:"mb-4",accessToken:s||""})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)(O.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,h.jsx)(aW.Z,{className:"mr-2"})," Vector Store",(0,h.jsx)(X.Z,{className:"ml-1",title:(0,h.jsxs)("span",{children:["Select vector store(s) to use for this LLM API call. You can set up your vector store ",(0,h.jsx)("a",{href:"?page=vector-stores",style:{color:"#1890ff"},children:"here"}),"."]}),children:(0,h.jsx)($.Z,{})})]}),(0,h.jsx)(el,{value:L,onChange:D,className:"mb-4",accessToken:s||""})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)(O.Z,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,h.jsx)(a$.Z,{className:"mr-2"})," Guardrails",(0,h.jsx)(X.Z,{className:"ml-1",title:(0,h.jsxs)("span",{children:["Select guardrail(s) to use for this LLM API call. You can set up your guardrails ",(0,h.jsx)("a",{href:"?page=guardrails",style:{color:"#1890ff"},children:"here"}),"."]}),children:(0,h.jsx)($.Z,{})})]}),(0,h.jsx)(aD,{value:R,onChange:U,className:"mb-4",accessToken:s||""})]}),(0,h.jsx)("div",{className:"space-y-2 mt-6",children:(0,h.jsx)(P.Z,{onClick:()=>{g([]),B(null),eu(),z.ZP.success("Chat history cleared.")},className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",icon:aX.Z,children:"Clear Chat"})})]})]}),(0,h.jsxs)("div",{className:"w-3/4 flex flex-col bg-white",children:[(0,h.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,h.jsx)(M.Z,{className:"text-xl font-semibold mb-0",children:"Test Key"}),(0,h.jsx)(P.Z,{onClick:()=>Q(!0),className:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",icon:aQ.Z,children:"Get Code"})]}),(0,h.jsxs)("div",{className:"flex-1 overflow-auto p-4 pb-0",children:[0===p.length&&(0,h.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,h.jsx)(aJ.Z,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,h.jsx)(O.Z,{children:"Start a conversation or generate an image"})]}),p.map((e,s)=>(0,h.jsx)("div",{className:"mb-4 ".concat("user"===e.role?"text-right":"text-left"),children:(0,h.jsxs)("div",{className:"inline-block max-w-[80%] rounded-lg shadow-sm p-3.5 px-4",style:{backgroundColor:"user"===e.role?"#f0f8ff":"#ffffff",border:"user"===e.role?"1px solid #e6f0fa":"1px solid #f0f0f0",textAlign:"left"},children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,h.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full mr-1",style:{backgroundColor:"user"===e.role?"#e6f0fa":"#f5f5f5"},children:"user"===e.role?(0,h.jsx)(b.Z,{style:{fontSize:"12px",color:"#2563eb"}}):(0,h.jsx)(aJ.Z,{style:{fontSize:"12px",color:"#4b5563"}})}),(0,h.jsx)("strong",{className:"text-sm capitalize",children:e.role}),"assistant"===e.role&&e.model&&(0,h.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-600 font-normal",children:e.model})]}),e.reasoningContent&&(0,h.jsx)(aq,{reasoningContent:e.reasoningContent}),(0,h.jsxs)("div",{className:"whitespace-pre-wrap break-words max-w-full message-content",style:{wordWrap:"break-word",overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},children:[e.isImage?(0,h.jsx)("img",{src:e.content,alt:"Generated image",className:"max-w-full rounded-md border border-gray-200 shadow-sm",style:{maxHeight:"500px"}}):(0,h.jsx)(aw.U,{components:{code(e){let{node:s,inline:t,className:l,children:a,...r}=e,n=/language-(\w+)/.exec(l||"");return!t&&n?(0,h.jsx)(lQ.Z,{style:aL.Z,language:n[1],PreTag:"div",className:"rounded-md my-2",wrapLines:!0,wrapLongLines:!0,...r,children:String(a).replace(/\n$/,"")}):(0,h.jsx)("code",{className:"".concat(l," px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono"),style:{wordBreak:"break-word"},...r,children:a})},pre:e=>{let{node:s,...t}=e;return(0,h.jsx)("pre",{style:{overflowX:"auto",maxWidth:"100%"},...t})}},children:e.content}),"assistant"===e.role&&(e.timeToFirstToken||e.usage)&&(0,h.jsx)(aH,{timeToFirstToken:e.timeToFirstToken,usage:e.usage})]})]})},s)),S&&(0,h.jsx)("div",{className:"flex justify-center items-center my-4",children:(0,h.jsx)(lo.Z,{indicator:ex})}),(0,h.jsx)("div",{ref:er,style:{height:"1px"}})]}),(0,h.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-white",children:[w===m.IMAGE_EDITS&&(0,h.jsx)("div",{className:"mb-4",children:H?(0,h.jsxs)("div",{className:"relative inline-block",children:[(0,h.jsx)("img",{src:J||"",alt:"Upload preview",className:"max-w-32 max-h-32 rounded-md border border-gray-200 object-cover"}),(0,h.jsx)("button",{className:"absolute top-1 right-1 bg-white shadow-sm border border-gray-200 rounded px-1 py-1 text-red-500 hover:bg-red-50 text-xs",onClick:eu,children:(0,h.jsx)(ew.Z,{})})]}):(0,h.jsxs)(a4,{beforeUpload:e=>(G(e),Y(URL.createObjectURL(e)),!1),accept:"image/*",showUploadList:!1,className:"border-dashed border-2 border-gray-300 rounded-lg p-4",children:[(0,h.jsx)("p",{className:"ant-upload-drag-icon",children:(0,h.jsx)(a0.Z,{style:{fontSize:"24px",color:"#666"}})}),(0,h.jsx)("p",{className:"ant-upload-text text-sm",children:"Click or drag image to upload"}),(0,h.jsx)("p",{className:"ant-upload-hint text-xs text-gray-500",children:"Support for PNG, JPG, JPEG formats"})]})}),(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(a2,{value:d,onChange:e=>u(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),eh())},placeholder:w===m.CHAT||w===m.RESPONSES||w===m.ANTHROPIC_MESSAGES?"Type your message... (Shift+Enter for new line)":w===m.IMAGE_EDITS?"Describe how you want to edit the image...":"Describe the image you want to generate...",disabled:S,className:"flex-1",autoSize:{minRows:1,maxRows:6},style:{resize:"none",paddingRight:"10px",paddingLeft:"10px"}}),S?(0,h.jsx)(P.Z,{onClick:()=>{I.current&&(I.current.abort(),I.current=null,C(!1),z.ZP.info("Request cancelled"))},className:"ml-2 bg-red-50 hover:bg-red-100 text-red-600 border-red-200",icon:ew.Z,children:"Cancel"}):(0,h.jsx)(P.Z,{onClick:eh,className:"ml-2 text-white",icon:w===m.CHAT||w===m.RESPONSES||w===m.ANTHROPIC_MESSAGES?a1.Z:aJ.Z,children:w===m.CHAT||w===m.RESPONSES||w===m.ANTHROPIC_MESSAGES?"Send":w===m.IMAGE_EDITS?"Edit":"Generate"})]})]})]})]})}),(0,h.jsxs)(q.Z,{title:"Generated Code",visible:W,onCancel:()=>Q(!1),footer:null,width:800,children:[(0,h.jsxs)("div",{className:"flex justify-between items-end my-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium block mb-1 text-gray-700",children:"SDK Type"}),(0,h.jsx)(F.default,{value:et,onChange:e=>ea(e),style:{width:150},options:[{value:"openai",label:"OpenAI SDK"},{value:"azure",label:"Azure SDK"}]})]}),(0,h.jsx)(V.ZP,{onClick:()=>{navigator.clipboard.writeText(ee),z.ZP.success("Copied to clipboard!")},children:"Copy to Clipboard"})]}),(0,h.jsx)(lQ.Z,{language:"python",style:aL.Z,wrapLines:!0,wrapLongLines:!0,className:"rounded-md",customStyle:{maxHeight:"60vh",overflowY:"auto"},children:ee})]})]})},a6=t(19226),a3=t(45937),a8=t(28595),a7=t(68208),a9=t(9775),re=t(41361),rs=t(37527),rt=t(88009),rl=t(48231),ra=t(58630),rr=t(41169),rn=t(55322),ri=t(76865),ro=t(70525),rc=t(95805),rd=t(51817),rm=t(21047);t(22135),t(40875);var ru=t(49663);let rh=function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")};function rx(e){let{accessToken:s,width:t=220}=e,[l,a]=(0,x.useState)(!1),[r,n]=(0,x.useState)(!1),[i,o]=(0,x.useState)(null),[c,d]=(0,x.useState)(!1),[m,u]=(0,x.useState)(null);(0,x.useEffect)(()=>{(async()=>{if(s){d(!0),u(null);try{let e=await (0,y.Bw)(s);o(e)}catch(e){console.error("Failed to fetch usage data:",e),u("Failed to load usage data")}finally{d(!1)}}})()},[s]);let{isOverLimit:p,isNearLimit:g,usagePercentage:j,userMetrics:f,teamMetrics:v}=(e=>{if(!e)return{isOverLimit:!1,isNearLimit:!1,usagePercentage:0,userMetrics:{isOverLimit:!1,isNearLimit:!1,usagePercentage:0},teamMetrics:{isOverLimit:!1,isNearLimit:!1,usagePercentage:0}};let s=!!e.total_users_remaining&&e.total_users_remaining<=0,t=!!e.total_users_remaining&&e.total_users_remaining<=5&&e.total_users_remaining>0,l=e.total_users?e.total_users_used/e.total_users*100:0,a=!!e.total_teams_remaining&&e.total_teams_remaining<=0,r=!!e.total_teams_remaining&&e.total_teams_remaining<=5&&e.total_teams_remaining>0,n=e.total_teams?e.total_teams_used/e.total_teams*100:0,i=s||a;return{isOverLimit:i,isNearLimit:(t||r)&&!i,usagePercentage:Math.max(l,n),userMetrics:{isOverLimit:s,isNearLimit:t,usagePercentage:l},teamMetrics:{isOverLimit:a,isNearLimit:r,usagePercentage:n}}})(i),_=()=>p?"red":g?"yellow":"green",b=()=>p?"Over Limit":g?"Near Limit":"Active",N=()=>p?(0,h.jsx)(ri.Z,{className:"h-3 w-3"}):g?(0,h.jsx)(ro.Z,{className:"h-3 w-3"}):null;return s&&((null==i?void 0:i.total_users)!==null||(null==i?void 0:i.total_teams)!==null)?(0,h.jsx)("div",{className:"fixed bottom-4 left-4 z-50",style:{width:"".concat(Math.min(t,220),"px")},children:(0,h.jsx)(()=>{if(r){let e=p||g;return(0,h.jsx)("button",{onClick:()=>n(!1),className:rh("bg-white border border-gray-200 rounded-lg shadow-sm p-3 hover:shadow-md transition-all w-full",e&&p&&"border-red-200 bg-red-50",e&&g&&"border-yellow-200 bg-yellow-50"),title:"Show usage details",children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)(rc.Z,{className:"h-4 w-4 flex-shrink-0"}),e&&(0,h.jsx)("span",{className:"flex-shrink-0",children:N()}),(0,h.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium truncate",children:[i&&null!==i.total_users&&(0,h.jsxs)("span",{className:"flex-shrink-0",children:["U: ",i.total_users_used,"/",i.total_users]}),i&&null!==i.total_teams&&(0,h.jsxs)("span",{className:"flex-shrink-0",children:["T: ",i.total_teams_used,"/",i.total_teams]}),!i||null===i.total_users&&null===i.total_teams&&(0,h.jsx)("span",{className:"truncate",children:"Usage"})]})]})})}return c?(0,h.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 w-full",children:(0,h.jsxs)("div",{className:"flex items-center justify-center gap-2 py-2",children:[(0,h.jsx)(rd.Z,{className:"h-4 w-4 animate-spin"}),(0,h.jsx)("span",{className:"text-sm text-gray-500 truncate",children:"Loading..."})]})}):m||!i?(0,h.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 group w-full",children:(0,h.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,h.jsx)("div",{className:"flex-1 min-w-0",children:(0,h.jsx)("span",{className:"text-sm text-gray-500 truncate block",children:m||"No data"})}),(0,h.jsx)("button",{onClick:()=>n(!0),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-100 rounded transition-all flex-shrink-0",title:"Minimize",children:(0,h.jsx)(rm.Z,{className:"h-3 w-3 text-gray-400"})})]})}):(0,h.jsxs)("div",{className:rh("bg-white border rounded-lg shadow-sm p-3 transition-all duration-200 group w-full",p&&"border-red-200 bg-red-50",g&&"border-yellow-200 bg-yellow-50"),children:[(0,h.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-3",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[(0,h.jsx)(rc.Z,{className:"h-4 w-4 flex-shrink-0"}),(0,h.jsx)("span",{className:"font-medium text-sm truncate",children:"Usage"}),(p||g)&&(0,h.jsx)(e1.Z,{color:_(),className:"text-xs px-1.5 py-0.5 flex-shrink-0",children:b()})]}),(0,h.jsx)("button",{onClick:()=>n(!0),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-100 rounded transition-all flex-shrink-0",title:"Minimize",children:(0,h.jsx)(rm.Z,{className:"h-3 w-3 text-gray-400"})})]}),(0,h.jsxs)("div",{className:"space-y-3 text-sm",children:[null!==i.total_users&&(0,h.jsxs)("div",{className:"space-y-1",children:[(0,h.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-600 mb-1",children:[(0,h.jsx)(rc.Z,{className:"h-3 w-3"}),(0,h.jsx)("span",{className:"font-medium",children:"Users"})]}),(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)("span",{className:"text-gray-600 text-xs",children:"Used:"}),(0,h.jsxs)("span",{className:"font-medium text-right",children:[i.total_users_used,"/",i.total_users]})]}),(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)("span",{className:"text-gray-600 text-xs",children:"Remaining:"}),(0,h.jsx)("span",{className:rh("font-medium text-right",f.isOverLimit&&"text-red-600",f.isNearLimit&&"text-yellow-600"),children:i.total_users_remaining})]}),(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)("span",{className:"text-gray-600 text-xs",children:"Usage:"}),(0,h.jsxs)("span",{className:"font-medium text-right",children:[Math.round(f.usagePercentage),"%"]})]}),(0,h.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,h.jsx)("div",{className:rh("h-2 rounded-full transition-all duration-300",f.isOverLimit&&"bg-red-500",f.isNearLimit&&"bg-yellow-500",!f.isOverLimit&&!f.isNearLimit&&"bg-green-500"),style:{width:"".concat(Math.min(f.usagePercentage,100),"%")}})})]}),null!==i.total_teams&&(0,h.jsxs)("div",{className:"space-y-1",children:[(0,h.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-600 mb-1",children:[(0,h.jsx)(ru.Z,{className:"h-3 w-3"}),(0,h.jsx)("span",{className:"font-medium",children:"Teams"})]}),(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)("span",{className:"text-gray-600 text-xs",children:"Used:"}),(0,h.jsxs)("span",{className:"font-medium text-right",children:[i.total_teams_used,"/",i.total_teams]})]}),(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)("span",{className:"text-gray-600 text-xs",children:"Remaining:"}),(0,h.jsx)("span",{className:rh("font-medium text-right",v.isOverLimit&&"text-red-600",v.isNearLimit&&"text-yellow-600"),children:i.total_teams_remaining})]}),(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)("span",{className:"text-gray-600 text-xs",children:"Usage:"}),(0,h.jsxs)("span",{className:"font-medium text-right",children:[Math.round(v.usagePercentage),"%"]})]}),(0,h.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,h.jsx)("div",{className:rh("h-2 rounded-full transition-all duration-300",v.isOverLimit&&"bg-red-500",v.isNearLimit&&"bg-yellow-500",!v.isOverLimit&&!v.isNearLimit&&"bg-green-500"),style:{width:"".concat(Math.min(v.usagePercentage,100),"%")}})})]})]})]})},{})}):null}let{Sider:rp}=a6.default;var rg=e=>{let{accessToken:s,setPage:t,userRole:l,defaultSelectedKey:a}=e,r=[{key:"1",page:"api-keys",label:"Virtual Keys",icon:(0,h.jsx)(lw.Z,{})},{key:"3",page:"llm-playground",label:"Test Key",icon:(0,h.jsx)(a8.Z,{}),roles:ez},{key:"2",page:"models",label:"Models + Endpoints",icon:(0,h.jsx)(a7.Z,{}),roles:ez},{key:"12",page:"new_usage",label:"Usage",icon:(0,h.jsx)(a9.Z,{}),roles:[...eF,...eR]},{key:"6",page:"teams",label:"Teams",icon:(0,h.jsx)(re.Z,{})},{key:"17",page:"organizations",label:"Organizations",icon:(0,h.jsx)(rs.Z,{}),roles:eF},{key:"5",page:"users",label:"Internal Users",icon:(0,h.jsx)(b.Z,{}),roles:eF},{key:"14",page:"api_ref",label:"API Reference",icon:(0,h.jsx)(tG.Z,{})},{key:"16",page:"model-hub",label:"Model Hub",icon:(0,h.jsx)(rt.Z,{})},{key:"15",page:"logs",label:"Logs",icon:(0,h.jsx)(rl.Z,{})},{key:"11",page:"guardrails",label:"Guardrails",icon:(0,h.jsx)(a$.Z,{}),roles:eF},{key:"18",page:"mcp-servers",label:"MCP Servers",icon:(0,h.jsx)(ra.Z,{}),roles:eF},{key:"experimental",page:"experimental",label:"Experimental",icon:(0,h.jsx)(rr.Z,{}),children:[{key:"9",page:"caching",label:"Caching",icon:(0,h.jsx)(aW.Z,{}),roles:eF},{key:"10",page:"budgets",label:"Budgets",icon:(0,h.jsx)(rs.Z,{}),roles:eF},{key:"20",page:"transform-request",label:"API Playground",icon:(0,h.jsx)(tG.Z,{}),roles:[...eF,...eR]},{key:"19",page:"tag-management",label:"Tag Management",icon:(0,h.jsx)(aY.Z,{}),roles:eF},{key:"21",page:"vector-stores",label:"Vector Stores",icon:(0,h.jsx)(aW.Z,{}),roles:eF},{key:"4",page:"usage",label:"Old Usage",icon:(0,h.jsx)(a9.Z,{})}]},{key:"settings",page:"settings",label:"Settings",icon:(0,h.jsx)(rn.Z,{}),roles:eF,children:[{key:"11",page:"general-settings",label:"Router Settings",icon:(0,h.jsx)(rn.Z,{}),roles:eF},{key:"8",page:"settings",label:"Logging & Alerts",icon:(0,h.jsx)(rn.Z,{}),roles:eF},{key:"13",page:"admin-panel",label:"Admin Settings",icon:(0,h.jsx)(rn.Z,{}),roles:eF}]}],n=(e=>{let s=r.find(s=>s.page===e);if(s)return s.key;for(let s of r)if(s.children){let t=s.children.find(s=>s.page===e);if(t)return t.key}return"1"})(a),i=r.filter(e=>!!(!e.roles||e.roles.includes(l))&&(e.children&&(e.children=e.children.filter(e=>!e.roles||e.roles.includes(l))),!0));return(0,h.jsx)(a6.default,{style:{minHeight:"100vh"},children:(0,h.jsxs)(rp,{theme:"light",width:220,children:[(0,h.jsx)(a3.Z,{mode:"inline",selectedKeys:[n],defaultOpenKeys:["llm-tools"],style:{borderRight:0,backgroundColor:"transparent",fontSize:"14px"},items:i.map(e=>{var s;return{key:e.key,icon:e.icon,label:e.label,children:null===(s=e.children)||void 0===s?void 0:s.map(e=>({key:e.key,icon:e.icon,label:e.label,onClick:()=>{let s=new URLSearchParams(window.location.search);s.set("page",e.page),window.history.pushState(null,"","?".concat(s.toString())),t(e.page)}})),onClick:e.children?void 0:()=>{let s=new URLSearchParams(window.location.search);s.set("page",e.page),window.history.pushState(null,"","?".concat(s.toString())),t(e.page)}}})}),eq(l)&&(0,h.jsx)(rx,{accessToken:s,width:220})]})})},rj=t(96889);console.log("process.env.NODE_ENV","production");let rf=e=>null!==e&&("Admin"===e||"Admin Viewer"===e);var rv=e=>{let{accessToken:s,token:t,userRole:l,userID:a,keys:r,premiumUser:n}=e,i=new Date,[o,c]=(0,x.useState)([]),[d,m]=(0,x.useState)([]),[u,p]=(0,x.useState)([]),[g,j]=(0,x.useState)([]),[f,v]=(0,x.useState)([]),[_,b]=(0,x.useState)([]),[N,Z]=(0,x.useState)([]),[w,k]=(0,x.useState)([]),[S,A]=(0,x.useState)([]),[T,E]=(0,x.useState)([]),[L,D]=(0,x.useState)({}),[F,R]=(0,x.useState)([]),[z,q]=(0,x.useState)(""),[U,V]=(0,x.useState)(["all-tags"]),[K,B]=(0,x.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[H,G]=(0,x.useState)(null),[J,Y]=(0,x.useState)(0),W=new Date(i.getFullYear(),i.getMonth(),1),$=new Date(i.getFullYear(),i.getMonth()+1,0),X=ea(W),Q=ea($);function ee(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0,notation:"compact",compactDisplay:"short"}).format(e)}console.log("keys in usage",r),console.log("premium user in usage",n);let es=async()=>{if(s)try{let e=await (0,y.g)(s);return console.log("usage tab: proxy_settings",e),e}catch(e){console.error("Error fetching proxy settings:",e)}};(0,x.useEffect)(()=>{el(K.from,K.to)},[K,U]);let et=async(e,t,l)=>{if(!e||!t||!s)return;console.log("uiSelectedKey",l);let a=await (0,y.b1)(s,l,e.toISOString(),t.toISOString());console.log("End user data updated successfully",a),j(a)},el=async(e,t)=>{if(!e||!t||!s)return;let l=await es();null!=l&&l.DISABLE_EXPENSIVE_DB_QUERIES||(b((await (0,y.J$)(s,e.toISOString(),t.toISOString(),0===U.length?void 0:U)).spend_per_tag),console.log("Tag spend data updated successfully"))};function ea(e){let s=e.getFullYear(),t=e.getMonth()+1,l=e.getDate();return"".concat(s,"-").concat(t<10?"0"+t:t,"-").concat(l<10?"0"+l:l)}console.log("Start date is ".concat(X)),console.log("End date is ".concat(Q));let er=async(e,s,t)=>{try{let t=await e();s(t)}catch(e){console.error(t,e)}},en=(e,s,t,l)=>{let a=[],r=new Date(s),n=e=>{if(e.includes("-"))return e;{let[s,t]=e.split(" ");return new Date(new Date().getFullYear(),new Date("".concat(s," 01 2024")).getMonth(),parseInt(t)).toISOString().split("T")[0]}},i=new Map(e.map(e=>{let s=n(e.date);return[s,{...e,date:s}]}));for(;r<=t;){let e=r.toISOString().split("T")[0];if(i.has(e))a.push(i.get(e));else{let s={date:e,api_requests:0,total_tokens:0};l.forEach(e=>{s[e]||(s[e]=0)}),a.push(s)}r.setDate(r.getDate()+1)}return a},ei=async()=>{if(s)try{let e=await (0,y.FC)(s),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0),r=en(e,l,a,[]),n=Number(r.reduce((e,s)=>e+(s.spend||0),0).toFixed(2));Y(n),c(r)}catch(e){console.error("Error fetching overall spend:",e)}},ec=()=>er(()=>s&&t?(0,y.OU)(s,t,X,Q):Promise.reject("No access token or token"),E,"Error fetching provider spend"),ed=async()=>{s&&await er(async()=>(await (0,y.tN)(s)).map(e=>({key:e.api_key.substring(0,10),api_key:e.api_key,key_alias:e.key_alias,spend:Number(e.total_spend.toFixed(2))})),m,"Error fetching top keys")},em=async()=>{s&&await er(async()=>(await (0,y.Au)(s)).map(e=>({key:e.model,spend:eH(e.total_spend,2)})),p,"Error fetching top models")},eu=async()=>{s&&await er(async()=>{let e=await (0,y.mR)(s),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);return v(en(e.daily_spend,l,a,e.teams)),k(e.teams),e.total_spend_per_team.map(e=>({name:e.team_id||"",value:eH(e.total_spend||0,2)}))},A,"Error fetching team spend")},eh=()=>{s&&er(async()=>(await (0,y.X)(s)).tag_names,Z,"Error fetching tag names")},ex=()=>{s&&er(()=>{var e,t;return(0,y.J$)(s,null===(e=K.from)||void 0===e?void 0:e.toISOString(),null===(t=K.to)||void 0===t?void 0:t.toISOString(),void 0)},e=>b(e.spend_per_tag),"Error fetching top tags")},ep=()=>{s&&er(()=>(0,y.b1)(s,null,void 0,void 0),j,"Error fetching top end users")},eg=async()=>{if(s)try{let e=await (0,y.wd)(s,X,Q),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0),r=en(e.daily_data||[],l,a,["api_requests","total_tokens"]);D({...e,daily_data:r})}catch(e){console.error("Error fetching global activity:",e)}},ef=async()=>{if(s)try{let e=await (0,y.xA)(s,X,Q),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0),r=e.map(e=>({...e,daily_data:en(e.daily_data||[],l,a,["api_requests","total_tokens"])}));R(r)}catch(e){console.error("Error fetching global activity per model:",e)}};return((0,x.useEffect)(()=>{(async()=>{if(s&&t&&l&&a){let e=await es();e&&(G(e),null!=e&&e.DISABLE_EXPENSIVE_DB_QUERIES)||(console.log("fetching data - valiue of proxySettings",H),ei(),ec(),ed(),em(),eg(),ef(),rf(l)&&(eu(),eh(),ex(),ep()))}})()},[s,t,l,a,X,Q]),null==H?void 0:H.DISABLE_EXPENSIVE_DB_QUERIES)?(0,h.jsx)("div",{style:{width:"100%"},className:"p-8",children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Database Query Limit Reached"}),(0,h.jsxs)(O.Z,{className:"mt-4",children:["SpendLogs in DB has ",H.NUM_SPEND_LOGS_ROWS," rows.",(0,h.jsx)("br",{}),"Please follow our guide to view usage when SpendLogs has more than 1M rows."]}),(0,h.jsx)(P.Z,{className:"mt-4",children:(0,h.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/spending_monitoring",target:"_blank",children:"View Usage Guide"})})]})}):(0,h.jsx)("div",{style:{width:"100%"},className:"p-8",children:(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{className:"mt-2",children:[(0,h.jsx)(e2.Z,{children:"All Up"}),rf(l)?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(e2.Z,{children:"Team Based Usage"}),(0,h.jsx)(e2.Z,{children:"Customer Usage"}),(0,h.jsx)(e2.Z,{children:"Tag Based Usage"})]}):(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{})})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{variant:"solid",className:"mt-1",children:[(0,h.jsx)(e2.Z,{children:"Cost"}),(0,h.jsx)(e2.Z,{children:"Activity"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:2,className:"gap-2 h-[100vh] w-full",children:[(0,h.jsxs)(C.Z,{numColSpan:2,children:[(0,h.jsxs)(O.Z,{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content mb-2 mt-2 text-lg",children:["Project Spend ",new Date().toLocaleString("default",{month:"long"})," 1 - ",new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate()]}),(0,h.jsx)(ax,{userID:a,userRole:l,accessToken:s,userSpend:J,selectedTeam:null,userMaxBudget:null})]}),(0,h.jsx)(C.Z,{numColSpan:2,children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Monthly Spend"}),(0,h.jsx)(s3.Z,{data:o,index:"date",categories:["spend"],colors:["cyan"],valueFormatter:e=>"$ ".concat(eH(e,2)),yAxisWidth:100,tickGap:5})]})}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(eo.Z,{className:"h-full",children:[(0,h.jsx)(M.Z,{children:"Top API Keys"}),(0,h.jsx)(ag,{topKeys:d,accessToken:s,userID:a,userRole:l,teams:null,premiumUser:n})]})}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(eo.Z,{className:"h-full",children:[(0,h.jsx)(M.Z,{children:"Top Models"}),(0,h.jsx)(s3.Z,{className:"mt-4 h-40",data:u,index:"key",categories:["spend"],colors:["cyan"],yAxisWidth:200,layout:"vertical",showXAxis:!1,showLegend:!1,valueFormatter:e=>"$".concat(eH(e,2))})]})}),(0,h.jsx)(C.Z,{numColSpan:1}),(0,h.jsx)(C.Z,{numColSpan:2,children:(0,h.jsxs)(eo.Z,{className:"mb-2",children:[(0,h.jsx)(M.Z,{children:"Spend by Provider"}),(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(I.Z,{numItems:2,children:[(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)(ah.Z,{className:"mt-4 h-40",variant:"pie",data:T,index:"provider",category:"spend",colors:["cyan"],valueFormatter:e=>"$".concat(eH(e,2))})}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsxs)(sN.Z,{children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Provider"}),(0,h.jsx)(sS.Z,{children:"Spend"})]})}),(0,h.jsx)(sZ.Z,{children:T.map(e=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:e.provider}),(0,h.jsx)(sw.Z,{children:1e-5>parseFloat(e.spend.toFixed(2))?"less than 0.00":eH(e.spend,2)})]},e.provider))})]})})]})})]})})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:1,className:"gap-2 h-[75vh] w-full",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"All Up"}),(0,h.jsxs)(I.Z,{numItems:2,children:[(0,h.jsxs)(C.Z,{children:[(0,h.jsxs)(sD.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["API Requests ",ee(L.sum_api_requests)]}),(0,h.jsx)(s6.Z,{className:"h-40",data:L.daily_data,valueFormatter:ee,index:"date",colors:["cyan"],categories:["api_requests"],onValueChange:e=>console.log(e)})]}),(0,h.jsxs)(C.Z,{children:[(0,h.jsxs)(sD.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Tokens ",ee(L.sum_total_tokens)]}),(0,h.jsx)(s3.Z,{className:"h-40",data:L.daily_data,valueFormatter:ee,index:"date",colors:["cyan"],categories:["total_tokens"],onValueChange:e=>console.log(e)})]})]})]}),(0,h.jsx)(h.Fragment,{children:F.map((e,s)=>(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:e.model}),(0,h.jsxs)(I.Z,{numItems:2,children:[(0,h.jsxs)(C.Z,{children:[(0,h.jsxs)(sD.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["API Requests ",ee(e.sum_api_requests)]}),(0,h.jsx)(s6.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["cyan"],categories:["api_requests"],valueFormatter:ee,onValueChange:e=>console.log(e)})]}),(0,h.jsxs)(C.Z,{children:[(0,h.jsxs)(sD.Z,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Tokens ",ee(e.sum_total_tokens)]}),(0,h.jsx)(s3.Z,{className:"h-40",data:e.daily_data,index:"date",colors:["cyan"],categories:["total_tokens"],valueFormatter:ee,onValueChange:e=>console.log(e)})]})]})]},s))})]})})]})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:2,className:"gap-2 h-[75vh] w-full",children:[(0,h.jsxs)(C.Z,{numColSpan:2,children:[(0,h.jsxs)(eo.Z,{className:"mb-2",children:[(0,h.jsx)(M.Z,{children:"Total Spend Per Team"}),(0,h.jsx)(rj.Z,{data:S})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Daily Spend Per Team"}),(0,h.jsx)(s3.Z,{className:"h-72",data:f,showLegend:!0,index:"date",categories:w,yAxisWidth:80,stack:!0})]})]}),(0,h.jsx)(C.Z,{numColSpan:2})]})}),(0,h.jsxs)(e6.Z,{children:[(0,h.jsxs)("p",{className:"mb-2 text-gray-500 italic text-[12px]",children:["Customers of your LLM API calls. Tracked when a `user` param is passed in your LLM calls ",(0,h.jsx)("a",{className:"text-blue-500",href:"https://docs.litellm.ai/docs/proxy/users",target:"_blank",children:"docs here"})]}),(0,h.jsxs)(I.Z,{numItems:2,children:[(0,h.jsx)(C.Z,{children:(0,h.jsx)(s5,{value:K,onValueChange:e=>{B(e),et(e.from,e.to,null)}})}),(0,h.jsxs)(C.Z,{children:[(0,h.jsx)(O.Z,{children:"Select Key"}),(0,h.jsxs)(e0.Z,{defaultValue:"all-keys",children:[(0,h.jsx)(ej.Z,{value:"all-keys",onClick:()=>{et(K.from,K.to,null)},children:"All Keys"},"all-keys"),null==r?void 0:r.map((e,s)=>e&&null!==e.key_alias&&e.key_alias.length>0?(0,h.jsx)(ej.Z,{value:String(s),onClick:()=>{et(K.from,K.to,e.token)},children:e.key_alias},s):null)]})]})]}),(0,h.jsx)(eo.Z,{className:"mt-4",children:(0,h.jsxs)(sN.Z,{className:"max-h-[70vh] min-h-[500px]",children:[(0,h.jsx)(sk.Z,{children:(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sS.Z,{children:"Customer"}),(0,h.jsx)(sS.Z,{children:"Spend"}),(0,h.jsx)(sS.Z,{children:"Total Events"})]})}),(0,h.jsx)(sZ.Z,{children:null==g?void 0:g.map((e,s)=>(0,h.jsxs)(sC.Z,{children:[(0,h.jsx)(sw.Z,{children:e.end_user}),(0,h.jsx)(sw.Z,{children:eH(e.total_spend,2)}),(0,h.jsx)(sw.Z,{children:e.total_count})]},s))})]})})]}),(0,h.jsxs)(e6.Z,{children:[(0,h.jsxs)(I.Z,{numItems:2,children:[(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)(s5,{className:"mb-4",value:K,onValueChange:e=>{B(e),el(e.from,e.to)}})}),(0,h.jsx)(C.Z,{children:n?(0,h.jsx)("div",{children:(0,h.jsxs)(lU.Z,{value:U,onValueChange:e=>V(e),children:[(0,h.jsx)(lV.Z,{value:"all-tags",onClick:()=>V(["all-tags"]),children:"All Tags"},"all-tags"),N&&N.filter(e=>"all-tags"!==e).map((e,s)=>(0,h.jsx)(lV.Z,{value:String(e),children:e},e))]})}):(0,h.jsx)("div",{children:(0,h.jsxs)(lU.Z,{value:U,onValueChange:e=>V(e),children:[(0,h.jsx)(lV.Z,{value:"all-tags",onClick:()=>V(["all-tags"]),children:"All Tags"},"all-tags"),N&&N.filter(e=>"all-tags"!==e).map((e,s)=>(0,h.jsxs)(ej.Z,{value:String(e),disabled:!0,children:["✨ ",e," (Enterprise only Feature)"]},e))]})})})]}),(0,h.jsxs)(I.Z,{numItems:2,className:"gap-2 h-[75vh] w-full mb-4",children:[(0,h.jsx)(C.Z,{numColSpan:2,children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Spend Per Tag"}),(0,h.jsxs)(O.Z,{children:["Get Started Tracking cost per tag ",(0,h.jsx)("a",{className:"text-blue-500",href:"https://docs.litellm.ai/docs/proxy/cost_tracking",target:"_blank",children:"here"})]}),(0,h.jsx)(s3.Z,{className:"h-72",data:_,index:"name",categories:["spend"],colors:["cyan"]})]})}),(0,h.jsx)(C.Z,{numColSpan:2})]})]})]})]})})},r_=t(51853);let ry=e=>{let{responseTimeMs:s}=e;return null==s?null:(0,h.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-500 font-mono",children:[(0,h.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{d:"M12 6V12L16 14M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,h.jsxs)("span",{children:[s.toFixed(0),"ms"]})]})},rb=e=>{let s=e;if("string"==typeof s)try{s=JSON.parse(s)}catch(e){}return s},rN=e=>{let{label:s,value:t}=e,[l,a]=x.useState(!1),[r,n]=x.useState(!1),i=(null==t?void 0:t.toString())||"N/A",o=i.length>50?i.substring(0,50)+"...":i;return(0,h.jsx)("tr",{className:"hover:bg-gray-50",children:(0,h.jsx)("td",{className:"px-4 py-2 align-top",colSpan:2,children:(0,h.jsxs)("div",{className:"flex items-center justify-between group",children:[(0,h.jsxs)("div",{className:"flex items-center flex-1",children:[(0,h.jsx)("button",{onClick:()=>a(!l),className:"text-gray-400 hover:text-gray-600 mr-2",children:l?"▼":"▶"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:"text-sm text-gray-600",children:s}),(0,h.jsx)("pre",{className:"mt-1 text-sm font-mono text-gray-800 whitespace-pre-wrap",children:l?i:o})]})]}),(0,h.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(i),n(!0),setTimeout(()=>n(!1),2e3)},className:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600",children:(0,h.jsx)(r_.Z,{className:"h-4 w-4"})})]})})})},rZ=e=>{var s,t,l,a,r,n,i,o,c,d,m,u,x,p;let{response:g}=e,j=null,f={},v={};try{if(null==g?void 0:g.error)try{let e="string"==typeof g.error.message?JSON.parse(g.error.message):g.error.message;j={message:(null==e?void 0:e.message)||"Unknown error",traceback:(null==e?void 0:e.traceback)||"No traceback available",litellm_params:(null==e?void 0:e.litellm_cache_params)||{},health_check_cache_params:(null==e?void 0:e.health_check_cache_params)||{}},f=rb(j.litellm_params)||{},v=rb(j.health_check_cache_params)||{}}catch(e){console.warn("Error parsing error details:",e),j={message:String(g.error.message||"Unknown error"),traceback:"Error parsing details",litellm_params:{},health_check_cache_params:{}}}else f=rb(null==g?void 0:g.litellm_cache_params)||{},v=rb(null==g?void 0:g.health_check_cache_params)||{}}catch(e){console.warn("Error in response parsing:",e),f={},v={}}let _={redis_host:(null==v?void 0:null===(l=v.redis_client)||void 0===l?void 0:null===(t=l.connection_pool)||void 0===t?void 0:null===(s=t.connection_kwargs)||void 0===s?void 0:s.host)||(null==v?void 0:null===(n=v.redis_async_client)||void 0===n?void 0:null===(r=n.connection_pool)||void 0===r?void 0:null===(a=r.connection_kwargs)||void 0===a?void 0:a.host)||(null==v?void 0:null===(i=v.connection_kwargs)||void 0===i?void 0:i.host)||(null==v?void 0:v.host)||"N/A",redis_port:(null==v?void 0:null===(d=v.redis_client)||void 0===d?void 0:null===(c=d.connection_pool)||void 0===c?void 0:null===(o=c.connection_kwargs)||void 0===o?void 0:o.port)||(null==v?void 0:null===(x=v.redis_async_client)||void 0===x?void 0:null===(u=x.connection_pool)||void 0===u?void 0:null===(m=u.connection_kwargs)||void 0===m?void 0:m.port)||(null==v?void 0:null===(p=v.connection_kwargs)||void 0===p?void 0:p.port)||(null==v?void 0:v.port)||"N/A",redis_version:(null==v?void 0:v.redis_version)||"N/A",startup_nodes:(()=>{try{var e,s,t,l,a,r,n,i,o,c,d,m,u;if(null==v?void 0:null===(e=v.redis_kwargs)||void 0===e?void 0:e.startup_nodes)return JSON.stringify(v.redis_kwargs.startup_nodes);let h=(null==v?void 0:null===(l=v.redis_client)||void 0===l?void 0:null===(t=l.connection_pool)||void 0===t?void 0:null===(s=t.connection_kwargs)||void 0===s?void 0:s.host)||(null==v?void 0:null===(n=v.redis_async_client)||void 0===n?void 0:null===(r=n.connection_pool)||void 0===r?void 0:null===(a=r.connection_kwargs)||void 0===a?void 0:a.host),x=(null==v?void 0:null===(c=v.redis_client)||void 0===c?void 0:null===(o=c.connection_pool)||void 0===o?void 0:null===(i=o.connection_kwargs)||void 0===i?void 0:i.port)||(null==v?void 0:null===(u=v.redis_async_client)||void 0===u?void 0:null===(m=u.connection_pool)||void 0===m?void 0:null===(d=m.connection_kwargs)||void 0===d?void 0:d.port);return h&&x?JSON.stringify([{host:h,port:x}]):"N/A"}catch(e){return"N/A"}})(),namespace:(null==v?void 0:v.namespace)||"N/A"};return(0,h.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{className:"border-b border-gray-200 px-4",children:[(0,h.jsx)(e2.Z,{className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800",children:"Summary"}),(0,h.jsx)(e2.Z,{className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800",children:"Raw Response"})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{className:"p-4",children:(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center mb-6",children:[(null==g?void 0:g.status)==="healthy"?(0,h.jsx)(eA.Z,{className:"h-5 w-5 text-green-500 mr-2"}):(0,h.jsx)(eP.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,h.jsxs)(O.Z,{className:"text-sm font-medium ".concat((null==g?void 0:g.status)==="healthy"?"text-green-500":"text-red-500"),children:["Cache Status: ",(null==g?void 0:g.status)||"unhealthy"]})]}),(0,h.jsx)("table",{className:"w-full border-collapse",children:(0,h.jsxs)("tbody",{children:[j&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold text-red-600",children:"Error Details"})}),(0,h.jsx)(rN,{label:"Error Message",value:j.message}),(0,h.jsx)(rN,{label:"Traceback",value:j.traceback})]}),(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold",children:"Cache Details"})}),(0,h.jsx)(rN,{label:"Cache Configuration",value:String(null==f?void 0:f.type)}),(0,h.jsx)(rN,{label:"Ping Response",value:String(g.ping_response)}),(0,h.jsx)(rN,{label:"Set Cache Response",value:g.set_cache_response||"N/A"}),(0,h.jsx)(rN,{label:"litellm_settings.cache_params",value:JSON.stringify(f,null,2)}),(null==f?void 0:f.type)==="redis"&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold",children:"Redis Details"})}),(0,h.jsx)(rN,{label:"Redis Host",value:_.redis_host||"N/A"}),(0,h.jsx)(rN,{label:"Redis Port",value:_.redis_port||"N/A"}),(0,h.jsx)(rN,{label:"Redis Version",value:_.redis_version||"N/A"}),(0,h.jsx)(rN,{label:"Startup Nodes",value:_.startup_nodes||"N/A"}),(0,h.jsx)(rN,{label:"Namespace",value:_.namespace||"N/A"})]})]})})]})}),(0,h.jsx)(e6.Z,{className:"p-4",children:(0,h.jsx)("div",{className:"bg-gray-50 rounded-md p-4 font-mono text-sm",children:(0,h.jsx)("pre",{className:"whitespace-pre-wrap break-words overflow-auto max-h-[500px]",children:(()=>{try{let e={...g,litellm_cache_params:f,health_check_cache_params:v},s=JSON.parse(JSON.stringify(e,(e,s)=>{if("string"==typeof s)try{return JSON.parse(s)}catch(e){}return s}));return JSON.stringify(s,null,2)}catch(e){return"Error formatting JSON: "+e.message}})()})})})]})]})})},rw=e=>{let{accessToken:s,healthCheckResponse:t,runCachingHealthCheck:l,responseTimeMs:a}=e,[r,n]=x.useState(null),[i,o]=x.useState(!1),c=async()=>{o(!0);let e=performance.now();await l(),n(performance.now()-e),o(!1)};return(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsx)(P.Z,{onClick:c,disabled:i,className:"bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white text-sm px-4 py-2 rounded-md",children:i?"Running Health Check...":"Run Health Check"}),(0,h.jsx)(ry,{responseTimeMs:r})]}),t&&(0,h.jsx)(rZ,{response:t})]})},rk=e=>{if(e)return e.toISOString().split("T")[0]};function rS(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0,notation:"compact",compactDisplay:"short"}).format(e)}var rC=e=>{let{accessToken:s,token:t,userRole:l,userID:a,premiumUser:r}=e,[n,i]=(0,x.useState)([]),[o,c]=(0,x.useState)([]),[d,m]=(0,x.useState)([]),[u,p]=(0,x.useState)([]),[g,j]=(0,x.useState)("0"),[f,v]=(0,x.useState)("0"),[_,b]=(0,x.useState)("0"),[N,Z]=(0,x.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[w,k]=(0,x.useState)(""),[S,P]=(0,x.useState)("");(0,x.useEffect)(()=>{s&&N&&((async()=>{p(await (0,y.zg)(s,rk(N.from),rk(N.to)))})(),k(new Date().toLocaleString()))},[s]);let A=Array.from(new Set(u.map(e=>{var s;return null!==(s=null==e?void 0:e.api_key)&&void 0!==s?s:""}))),T=Array.from(new Set(u.map(e=>{var s;return null!==(s=null==e?void 0:e.model)&&void 0!==s?s:""})));Array.from(new Set(u.map(e=>{var s;return null!==(s=null==e?void 0:e.call_type)&&void 0!==s?s:""})));let E=async(e,t)=>{e&&t&&s&&p(await (0,y.zg)(s,rk(e),rk(t)))};(0,x.useEffect)(()=>{console.log("DATA IN CACHE DASHBOARD",u);let e=u;o.length>0&&(e=e.filter(e=>o.includes(e.api_key))),d.length>0&&(e=e.filter(e=>d.includes(e.model))),console.log("before processed data in cache dashboard",e);let s=0,t=0,l=0,a=e.reduce((e,a)=>{console.log("Processing item:",a),a.call_type||(console.log("Item has no call_type:",a),a.call_type="Unknown"),s+=(a.total_rows||0)-(a.cache_hit_true_rows||0),t+=a.cache_hit_true_rows||0,l+=a.cached_completion_tokens||0;let r=e.find(e=>e.name===a.call_type);return r?(r["LLM API requests"]+=(a.total_rows||0)-(a.cache_hit_true_rows||0),r["Cache hit"]+=a.cache_hit_true_rows||0,r["Cached Completion Tokens"]+=a.cached_completion_tokens||0,r["Generated Completion Tokens"]+=a.generated_completion_tokens||0):e.push({name:a.call_type,"LLM API requests":(a.total_rows||0)-(a.cache_hit_true_rows||0),"Cache hit":a.cache_hit_true_rows||0,"Cached Completion Tokens":a.cached_completion_tokens||0,"Generated Completion Tokens":a.generated_completion_tokens||0}),e},[]);j(rS(t)),v(rS(l));let r=t+s;r>0?b((t/r*100).toFixed(2)):b("0"),i(a),console.log("PROCESSED DATA IN CACHE DASHBOARD",a)},[o,d,N,u]);let L=async()=>{try{z.ZP.info("Running cache health check..."),P("");let e=await (0,y.Tj)(null!==s?s:"");console.log("CACHING HEALTH CHECK RESPONSE",e),P(e)}catch(s){let e;if(console.error("Error running health check:",s),s&&s.message)try{let t=JSON.parse(s.message);t.error&&(t=t.error),e=t}catch(t){e={message:s.message}}else e={message:"Unknown error occurred"};P({error:e})}};return(0,h.jsxs)(e4.Z,{className:"gap-2 p-8 h-full w-full mt-2 mb-8",children:[(0,h.jsxs)(e5.Z,{className:"flex justify-between mt-2 w-full items-center",children:[(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)(e2.Z,{children:"Cache Analytics"}),(0,h.jsx)(e2.Z,{children:(0,h.jsx)("pre",{children:"Cache Health"})})]}),(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[w&&(0,h.jsxs)(O.Z,{children:["Last Refreshed: ",w]}),(0,h.jsx)(sb.Z,{icon:e7.Z,variant:"shadow",size:"xs",className:"self-center",onClick:()=>{k(new Date().toLocaleString())}})]})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)(I.Z,{numItems:3,className:"gap-4 mt-4",children:[(0,h.jsx)(C.Z,{children:(0,h.jsx)(lU.Z,{placeholder:"Select API Keys",value:o,onValueChange:c,children:A.map(e=>(0,h.jsx)(lV.Z,{value:e,children:e},e))})}),(0,h.jsx)(C.Z,{children:(0,h.jsx)(lU.Z,{placeholder:"Select Models",value:d,onValueChange:m,children:T.map(e=>(0,h.jsx)(lV.Z,{value:e,children:e},e))})}),(0,h.jsx)(C.Z,{children:(0,h.jsx)(s5,{value:N,onValueChange:e=>{Z(e),E(e.from,e.to)}})})]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 mt-4",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cache Hit Ratio"}),(0,h.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,h.jsxs)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:[_,"%"]})})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cache Hits"}),(0,h.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,h.jsx)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:g})})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cached Tokens"}),(0,h.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,h.jsx)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:f})})]})]}),(0,h.jsx)(sD.Z,{className:"mt-4",children:"Cache Hits vs API Requests"}),(0,h.jsx)(s3.Z,{title:"Cache Hits vs API Requests",data:n,stack:!0,index:"name",valueFormatter:rS,categories:["LLM API requests","Cache hit"],colors:["sky","teal"],yAxisWidth:48}),(0,h.jsx)(sD.Z,{className:"mt-4",children:"Cached Completion Tokens vs Generated Completion Tokens"}),(0,h.jsx)(s3.Z,{className:"mt-6",data:n,stack:!0,index:"name",valueFormatter:rS,categories:["Generated Completion Tokens","Cached Completion Tokens"],colors:["sky","teal"],yAxisWidth:48})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(rw,{accessToken:s,healthCheckResponse:S,runCachingHealthCheck:L})})]})]})},rI=t(91810),rP=t(3810);(i=u||(u={})).PresidioPII="Presidio PII",i.Bedrock="Bedrock Guardrail",i.Lakera="Lakera",i.AzureContentSafetyPromptShield="Azure Content Safety Prompt Shield",i.AzureContentSafetyTextModeration="Azure Content Safety Text Moderation";let rA={PresidioPII:"presidio",Bedrock:"bedrock",Lakera:"lakera_v2",AzureContentSafetyPromptShield:"azure/prompt_shield",AzureContentSafetyTextModeration:"azure/text_moderations"},rT=e=>!!e&&"Presidio PII"===u[e],rE="../ui/assets/logos/",rL={"Presidio PII":"".concat(rE,"presidio.png"),"Bedrock Guardrail":"".concat(rE,"bedrock.svg"),Lakera:"".concat(rE,"lakeraai.jpeg"),"Azure Content Safety Prompt Shield":"".concat(rE,"presidio.png"),"Azure Content Safety Text Moderation":"".concat(rE,"presidio.png")},rO=e=>{if(!e)return{logo:"",displayName:"-"};let s=Object.keys(rA).find(s=>rA[s].toLowerCase()===e.toLowerCase());if(!s)return{logo:"",displayName:e};let t=u[s];return{logo:rL[t],displayName:t}};var rM=t(33866),rD=t(97416),rF=t(8881),rR=t(10798),rz=t(49638);let{Text:rq}=ef.default,{Option:rU}=F.default,rV=e=>e.replace(/_/g," "),rK=e=>{switch(e){case"MASK":return(0,h.jsx)(rD.Z,{style:{marginRight:4}});case"BLOCK":return(0,h.jsx)(rF.Z,{style:{marginRight:4}});default:return null}},rB=e=>{let{categories:s,selectedCategories:t,onChange:l}=e;return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center mb-2",children:[(0,h.jsx)(rR.Z,{className:"text-gray-500 mr-1"}),(0,h.jsx)(rq,{className:"text-gray-500 font-medium",children:"Filter by category"})]}),(0,h.jsx)(F.default,{mode:"multiple",placeholder:"Select categories to filter by",style:{width:"100%"},onChange:l,value:t,allowClear:!0,showSearch:!0,optionFilterProp:"children",className:"mb-4",tagRender:e=>(0,h.jsx)(rP.Z,{color:"blue",closable:e.closable,onClose:e.onClose,className:"mr-2 mb-2",children:e.label}),children:s.map(e=>(0,h.jsx)(rU,{value:e.category,children:e.category},e.category))})]})},rH=e=>{let{onSelectAll:s,onUnselectAll:t,hasSelectedEntities:l}=e;return(0,h.jsxs)("div",{className:"bg-gray-50 p-5 rounded-lg mb-6 border border-gray-200 shadow-sm",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(rq,{strong:!0,className:"text-gray-700 text-base",children:"Quick Actions"}),(0,h.jsx)(X.Z,{title:"Apply action to all PII types at once",children:(0,h.jsx)("div",{className:"ml-2 text-gray-400 cursor-help text-xs",children:"ⓘ"})})]}),(0,h.jsx)(V.ZP,{type:"default",onClick:t,disabled:!l,icon:(0,h.jsx)(rz.Z,{}),className:"border-gray-300 hover:text-red-600 hover:border-red-300",children:"Unselect All"})]}),(0,h.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,h.jsx)(V.ZP,{type:"default",onClick:()=>s("MASK"),className:"flex items-center justify-center h-10 border-blue-200 hover:border-blue-300 hover:text-blue-700 bg-blue-50 hover:bg-blue-100 text-blue-600",block:!0,icon:(0,h.jsx)(rD.Z,{}),children:"Select All & Mask"}),(0,h.jsx)(V.ZP,{type:"default",onClick:()=>s("BLOCK"),className:"flex items-center justify-center h-10 border-red-200 hover:border-red-300 hover:text-red-700 bg-red-50 hover:bg-red-100 text-red-600",block:!0,icon:(0,h.jsx)(rF.Z,{}),children:"Select All & Block"})]})]})},rG=e=>{let{entities:s,selectedEntities:t,selectedActions:l,actions:a,onEntitySelect:r,onActionSelect:n,entityToCategoryMap:i}=e;return(0,h.jsxs)("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[(0,h.jsxs)("div",{className:"bg-gray-50 px-5 py-3 border-b flex",children:[(0,h.jsx)(rq,{strong:!0,className:"flex-1 text-gray-700",children:"PII Type"}),(0,h.jsx)(rq,{strong:!0,className:"w-32 text-right text-gray-700",children:"Action"})]}),(0,h.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:0===s.length?(0,h.jsx)("div",{className:"py-10 text-center text-gray-500",children:"No PII types match your filter criteria"}):s.map(e=>(0,h.jsxs)("div",{className:"px-5 py-3 flex items-center justify-between hover:bg-gray-50 border-b ".concat(t.includes(e)?"bg-blue-50":""),children:[(0,h.jsxs)("div",{className:"flex items-center flex-1",children:[(0,h.jsx)(ts.Z,{checked:t.includes(e),onChange:()=>r(e),className:"mr-3"}),(0,h.jsx)(rq,{className:t.includes(e)?"font-medium text-gray-900":"text-gray-700",children:rV(e)}),i.get(e)&&(0,h.jsx)(rP.Z,{className:"ml-2 text-xs",color:"blue",children:i.get(e)})]}),(0,h.jsx)("div",{className:"w-32",children:(0,h.jsx)(F.default,{value:t.includes(e)&&l[e]||"MASK",onChange:s=>n(e,s),style:{width:120},disabled:!t.includes(e),className:"".concat(t.includes(e)?"":"opacity-50"),dropdownMatchSelectWidth:!1,children:a.map(e=>(0,h.jsx)(rU,{value:e,children:(0,h.jsxs)("div",{className:"flex items-center",children:[rK(e),e]})},e))})})]},e))})]})},{Title:rJ,Text:rY}=ef.default;var rW=e=>{let{entities:s,actions:t,selectedEntities:l,selectedActions:a,onEntitySelect:r,onActionSelect:n,entityCategories:i=[]}=e,[o,c]=(0,x.useState)([]),d=new Map;i.forEach(e=>{e.entities.forEach(s=>{d.set(s,e.category)})});let m=s.filter(e=>0===o.length||o.includes(d.get(e)||""));return(0,h.jsxs)("div",{className:"pii-configuration",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,h.jsx)("div",{className:"flex items-center",children:(0,h.jsx)(rJ,{level:4,className:"mb-0 font-semibold text-gray-800",children:"Configure PII Protection"})}),(0,h.jsx)(rM.Z,{count:l.length,showZero:!0,style:{backgroundColor:l.length>0?"#4f46e5":"#d9d9d9"},overflowCount:999,children:(0,h.jsxs)(rY,{className:"text-gray-500",children:[l.length," items selected"]})})]}),(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsx)(rB,{categories:i,selectedCategories:o,onChange:c}),(0,h.jsx)(rH,{onSelectAll:e=>{s.forEach(s=>{l.includes(s)||r(s),n(s,e)})},onUnselectAll:()=>{l.forEach(e=>{r(e)})},hasSelectedEntities:l.length>0})]}),(0,h.jsx)(rG,{entities:m,selectedEntities:l,selectedActions:a,actions:t,onEntitySelect:r,onActionSelect:n,entityToCategoryMap:d})]})},r$=e=>{var s;let{selectedProvider:t,accessToken:l,providerParams:a=null}=e,[r,n]=(0,x.useState)(!1),[i,o]=(0,x.useState)(a),[c,d]=(0,x.useState)(null);if((0,x.useEffect)(()=>{if(a){o(a);return}let e=async()=>{if(l){n(!0),d(null);try{let e=await (0,y.eW)(l);console.log("Provider params API response:",e),o(e)}catch(e){console.error("Error fetching provider params:",e),d("Failed to load provider parameters")}finally{n(!1)}}};a||e()},[l,a]),!t)return null;if(r)return(0,h.jsx)(lo.Z,{tip:"Loading provider parameters..."});if(c)return(0,h.jsx)("div",{className:"text-red-500",children:c});let m=null===(s=rA[t])||void 0===s?void 0:s.toLowerCase(),u=i&&i[m];return(console.log("Provider key:",m),console.log("Provider fields:",u),u&&0!==u.length)?(0,h.jsx)(h.Fragment,{children:u.map(e=>(0,h.jsx)(R.Z.Item,{name:e.param,label:e.param,tooltip:e.description,rules:e.required?[{required:!0,message:"".concat(e.param," is required")}]:void 0,children:"select"===e.type&&e.options?(0,h.jsx)(F.default,{placeholder:e.description,defaultValue:e.default_value,children:e.options.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:e},e))}):"bool"===e.type?(0,h.jsxs)(F.default,{placeholder:e.description,defaultValue:e.default_value,children:[(0,h.jsx)(F.default.Option,{value:"True",children:"True"}),(0,h.jsx)(F.default.Option,{value:"False",children:"False"})]}):e.param.includes("password")||e.param.includes("secret")?(0,h.jsx)(A.Z,{placeholder:e.description,type:"password"}):(0,h.jsx)(A.Z,{placeholder:e.description,type:"text"})},e.param))}):(0,h.jsx)("div",{children:"No configuration fields available for this provider."})};let{Title:rX,Text:rQ,Link:r0}=ef.default,{Option:r1}=F.default,{Step:r2}=rI.default,r4={pre_call:"Before LLM Call - Runs before the LLM call and checks the input (Recommended)",during_call:"During LLM Call - Runs in parallel with the LLM call, with response held until check completes",post_call:"After LLM Call - Runs after the LLM call and checks only the output",logging_only:"Logging Only - Only runs on logging callbacks without affecting the LLM call"};var r5=e=>{let{visible:s,onClose:t,accessToken:l,onSuccess:a}=e,[r]=R.Z.useForm(),[n,i]=(0,x.useState)(!1),[o,c]=(0,x.useState)(null),[d,m]=(0,x.useState)(null),[p,g]=(0,x.useState)([]),[j,f]=(0,x.useState)({}),[v,_]=(0,x.useState)(0),[b,N]=(0,x.useState)(null);(0,x.useEffect)(()=>{l&&(async()=>{try{let[e,s]=await Promise.all([(0,y.qd)(l),(0,y.eW)(l)]);m(e),N(s)}catch(e){console.error("Error fetching guardrail data:",e),z.ZP.error("Failed to load guardrail configuration")}})()},[l]);let Z=e=>{c(e),r.setFieldsValue({config:void 0,presidio_analyzer_api_base:void 0,presidio_anonymizer_api_base:void 0}),g([]),f({})},w=e=>{g(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},k=(e,s)=>{f(t=>({...t,[e]:s}))},S=async()=>{try{if(0===v&&(await r.validateFields(["guardrail_name","provider","mode","default_on"]),o)){let e=["guardrail_name","provider","mode","default_on"];"PresidioPII"===o&&e.push("presidio_analyzer_api_base","presidio_anonymizer_api_base"),await r.validateFields(e)}_(v+1)}catch(e){console.error("Form validation failed:",e)}},C=()=>{r.resetFields(),c(null),g([]),f({}),_(0)},I=()=>{C(),t()},T=async()=>{try{i(!0),await r.validateFields();let s=r.getFieldsValue(!0),n=rA[s.provider],c={guardrail_name:s.guardrail_name,litellm_params:{guardrail:n,mode:s.mode,default_on:s.default_on},guardrail_info:{}};if("PresidioPII"===s.provider&&p.length>0){let e={};p.forEach(s=>{e[s]=j[s]||"MASK"}),c.litellm_params.pii_entities_config=e,s.presidio_analyzer_api_base&&(c.litellm_params.presidio_analyzer_api_base=s.presidio_analyzer_api_base),s.presidio_anonymizer_api_base&&(c.litellm_params.presidio_anonymizer_api_base=s.presidio_anonymizer_api_base)}else if(s.config)try{let e=JSON.parse(s.config);c.guardrail_info=e}catch(e){z.ZP.error("Invalid JSON in configuration"),i(!1);return}if(b&&o){var e;let t=b[null===(e=rA[o])||void 0===e?void 0:e.toLowerCase()]||[];new Set(t.map(e=>e.param)).forEach(e=>{let t=s[e];null!=t&&""!==t&&(c.litellm_params[e]=t)})}if(!l)throw Error("No access token available");console.log("Sending guardrail data:",JSON.stringify(c)),await (0,y.PC)(l,c),z.ZP.success("Guardrail created successfully"),C(),a(),t()}catch(e){console.error("Failed to create guardrail:",e),z.ZP.error("Failed to create guardrail: "+(e instanceof Error?e.message:String(e)))}finally{i(!1)}},E=()=>{var e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,h.jsx)(A.Z,{placeholder:"Enter a name for this guardrail"})}),(0,h.jsx)(R.Z.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,h.jsx)(F.default,{placeholder:"Select a guardrail provider",onChange:Z,labelInValue:!1,optionLabelProp:"label",dropdownRender:e=>e,showSearch:!0,children:Object.entries(u).map(e=>{let[s,t]=e;return(0,h.jsx)(r1,{value:s,label:(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[rL[t]&&(0,h.jsx)("img",{src:rL[t],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,h.jsx)("span",{children:t})]}),children:(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[rL[t]&&(0,h.jsx)("img",{src:rL[t],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,h.jsx)("span",{children:t})]})},s)})})}),(0,h.jsx)(R.Z.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,h.jsx)(F.default,{optionLabelProp:"label",mode:"multiple",children:(null==d?void 0:null===(e=d.supported_modes)||void 0===e?void 0:e.map(e=>(0,h.jsx)(r1,{value:e,label:e,children:(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:e}),"pre_call"===e&&(0,h.jsx)(rP.Z,{color:"green",style:{marginLeft:"8px"},children:"Recommended"})]}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:r4[e]})]})},e)))||(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r1,{value:"pre_call",label:"pre_call",children:(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"pre_call"})," ",(0,h.jsx)(rP.Z,{color:"green",children:"Recommended"})]}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:r4.pre_call})]})}),(0,h.jsx)(r1,{value:"during_call",label:"during_call",children:(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{children:(0,h.jsx)("strong",{children:"during_call"})}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:r4.during_call})]})}),(0,h.jsx)(r1,{value:"post_call",label:"post_call",children:(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{children:(0,h.jsx)("strong",{children:"post_call"})}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:r4.post_call})]})}),(0,h.jsx)(r1,{value:"logging_only",label:"logging_only",children:(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{children:(0,h.jsx)("strong",{children:"logging_only"})}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:r4.logging_only})]})})]})})}),(0,h.jsx)(R.Z.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default.",children:(0,h.jsxs)(F.default,{children:[(0,h.jsx)(F.default.Option,{value:!0,children:"Yes"}),(0,h.jsx)(F.default.Option,{value:!1,children:"No"})]})}),(0,h.jsx)(r$,{selectedProvider:o,accessToken:l,providerParams:b})]})},L=()=>d&&"PresidioPII"===o?(0,h.jsx)(rW,{entities:d.supported_entities,actions:d.supported_actions,selectedEntities:p,selectedActions:j,onEntitySelect:w,onActionSelect:k,entityCategories:d.pii_entity_categories}):null;return(0,h.jsx)(q.Z,{title:"Add Guardrail",open:s,onCancel:I,footer:null,width:700,children:(0,h.jsxs)(R.Z,{form:r,layout:"vertical",initialValues:{mode:"pre_call",default_on:!1},children:[(0,h.jsxs)(rI.default,{current:v,className:"mb-6",children:[(0,h.jsx)(r2,{title:"Basic Info"}),(0,h.jsx)(r2,{title:"PresidioPII"===o?"PII Configuration":"Provider Configuration"})]}),(()=>{switch(v){case 0:return E();case 1:if(rT(o))return L();default:return null}})(),(0,h.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[v>0&&(0,h.jsx)(P.Z,{variant:"secondary",onClick:()=>{_(v-1)},children:"Previous"}),v<1&&(0,h.jsx)(P.Z,{onClick:S,children:"Next"}),1===v&&(0,h.jsx)(P.Z,{onClick:T,loading:n,children:"Create Guardrail"}),(0,h.jsx)(P.Z,{variant:"secondary",onClick:I,children:"Cancel"})]})]})})};let{Title:r6,Text:r3}=ef.default,{Option:r8}=F.default;var r7=e=>{var s;let{visible:t,onClose:l,accessToken:a,onSuccess:r,guardrailId:n,initialValues:i}=e,[o]=R.Z.useForm(),[c,d]=(0,x.useState)(!1),[m,p]=(0,x.useState)((null==i?void 0:i.provider)||null),[g,j]=(0,x.useState)(null),[f,v]=(0,x.useState)([]),[_,b]=(0,x.useState)({});(0,x.useEffect)(()=>{(async()=>{try{if(!a)return;let e=await (0,y.qd)(a);j(e)}catch(e){console.error("Error fetching guardrail settings:",e),z.ZP.error("Failed to load guardrail settings")}})()},[a]),(0,x.useEffect)(()=>{(null==i?void 0:i.pii_entities_config)&&Object.keys(i.pii_entities_config).length>0&&(v(Object.keys(i.pii_entities_config)),b(i.pii_entities_config))},[i]);let N=e=>{v(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},Z=(e,s)=>{b(t=>({...t,[e]:s}))},w=async()=>{try{d(!0);let e=await o.validateFields(),s=rA[e.provider],t={guardrail_id:n,guardrail:{guardrail_name:e.guardrail_name,litellm_params:{guardrail:s,mode:e.mode,default_on:e.default_on},guardrail_info:{}}};if("PresidioPII"===e.provider&&f.length>0){let e={};f.forEach(s=>{e[s]=_[s]||"MASK"}),t.guardrail.litellm_params.pii_entities_config=e}else if(e.config)try{let s=JSON.parse(e.config);"Bedrock"===e.provider&&s?(s.guardrail_id&&(t.guardrail.litellm_params.guardrailIdentifier=s.guardrail_id),s.guardrail_version&&(t.guardrail.litellm_params.guardrailVersion=s.guardrail_version)):t.guardrail.guardrail_info=s}catch(e){z.ZP.error("Invalid JSON in configuration"),d(!1);return}if(!a)throw Error("No access token available");console.log("Sending guardrail update data:",JSON.stringify(t));let i=await fetch("/guardrails/".concat(n),{method:"PUT",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok){let e=await i.text();throw Error(e||"Failed to update guardrail")}z.ZP.success("Guardrail updated successfully"),r(),l()}catch(e){console.error("Failed to update guardrail:",e),z.ZP.error("Failed to update guardrail: "+(e instanceof Error?e.message:String(e)))}finally{d(!1)}},k=()=>g&&m&&"PresidioPII"===m?(0,h.jsx)(rW,{entities:g.supported_entities,actions:g.supported_actions,selectedEntities:f,selectedActions:_,onEntitySelect:N,onActionSelect:Z,entityCategories:g.pii_entity_categories}):null;return(0,h.jsx)(q.Z,{title:"Edit Guardrail",open:t,onCancel:l,footer:null,width:700,children:(0,h.jsxs)(R.Z,{form:o,layout:"vertical",initialValues:i,children:[(0,h.jsx)(R.Z.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,h.jsx)(A.Z,{placeholder:"Enter a name for this guardrail"})}),(0,h.jsx)(R.Z.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,h.jsx)(F.default,{placeholder:"Select a guardrail provider",onChange:e=>{p(e),o.setFieldsValue({config:void 0}),v([]),b({})},disabled:!0,optionLabelProp:"label",children:Object.entries(u).map(e=>{let[s,t]=e;return(0,h.jsx)(r8,{value:s,label:t,children:(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[rL[t]&&(0,h.jsx)("img",{src:rL[t],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,h.jsx)("span",{children:t})]})},s)})})}),(0,h.jsx)(R.Z.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,h.jsx)(F.default,{children:(null==g?void 0:null===(s=g.supported_modes)||void 0===s?void 0:s.map(e=>(0,h.jsx)(r8,{value:e,children:e},e)))||(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r8,{value:"pre_call",children:"pre_call"}),(0,h.jsx)(r8,{value:"post_call",children:"post_call"})]})})}),(0,h.jsx)(R.Z.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default",valuePropName:"checked",children:(0,h.jsx)(tg.Z,{})}),(()=>{if(!m)return null;if("PresidioPII"===m)return k();switch(m){case"Aporia":return(0,h.jsx)(R.Z.Item,{label:"Aporia Configuration",name:"config",tooltip:"JSON configuration for Aporia",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_aporia_api_key",\n  "project_name": "your_project_name"\n}'})});case"AimSecurity":return(0,h.jsx)(R.Z.Item,{label:"Aim Security Configuration",name:"config",tooltip:"JSON configuration for Aim Security",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_aim_api_key"\n}'})});case"Bedrock":return(0,h.jsx)(R.Z.Item,{label:"Amazon Bedrock Configuration",name:"config",tooltip:"JSON configuration for Amazon Bedrock guardrails",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:'{\n  "guardrail_id": "your_guardrail_id",\n  "guardrail_version": "your_guardrail_version"\n}'})});case"GuardrailsAI":return(0,h.jsx)(R.Z.Item,{label:"Guardrails.ai Configuration",name:"config",tooltip:"JSON configuration for Guardrails.ai",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_guardrails_api_key",\n  "guardrail_id": "your_guardrail_id"\n}'})});case"LakeraAI":return(0,h.jsx)(R.Z.Item,{label:"Lakera AI Configuration",name:"config",tooltip:"JSON configuration for Lakera AI",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_lakera_api_key"\n}'})});case"PromptInjection":return(0,h.jsx)(R.Z.Item,{label:"Prompt Injection Configuration",name:"config",tooltip:"JSON configuration for prompt injection detection",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:'{\n  "threshold": 0.8\n}'})});default:return(0,h.jsx)(R.Z.Item,{label:"Custom Configuration",name:"config",tooltip:"JSON configuration for your custom guardrail",children:(0,h.jsx)(K.default.TextArea,{rows:4,placeholder:'{\n  "key1": "value1",\n  "key2": "value2"\n}'})})}})(),(0,h.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,h.jsx)(P.Z,{variant:"secondary",onClick:l,children:"Cancel"}),(0,h.jsx)(P.Z,{onClick:w,loading:c,children:"Update Guardrail"})]})]})})},r9=e=>{var s,t,l,a,r,n,i,o,c;let{guardrailId:d,onClose:m,accessToken:u,isAdmin:p}=e,[g,j]=(0,x.useState)(null),[f,v]=(0,x.useState)(!0),[_,b]=(0,x.useState)(!1),[N]=R.Z.useForm(),[Z,w]=(0,x.useState)([]),[k,S]=(0,x.useState)({}),[C,T]=(0,x.useState)(null),E=async()=>{try{var e;if(v(!0),!u)return;let s=await (0,y.fk)(u,d);if(j(s),null===(e=s.litellm_params)||void 0===e?void 0:e.pii_entities_config){let e=s.litellm_params.pii_entities_config;if(w([]),S({}),Object.keys(e).length>0){let s=[],t={};Object.entries(e).forEach(e=>{let[l,a]=e;s.push(l),t[l]="string"==typeof a?a:"MASK"}),w(s),S(t)}}else w([]),S({})}catch(e){z.ZP.error("Failed to load guardrail information"),console.error("Error fetching guardrail info:",e)}finally{v(!1)}},L=async()=>{try{if(!u)return;let e=await (0,y.qd)(u);T(e)}catch(e){console.error("Error fetching guardrail UI settings:",e)}};(0,x.useEffect)(()=>{E(),L()},[d,u]);let D=async e=>{try{if(!u)return;let s={guardrail_name:e.guardrail_name,litellm_params:{default_on:e.default_on},guardrail_info:e.guardrail_info?JSON.parse(e.guardrail_info):void 0};if(Z.length>0){let e={};Z.forEach(s=>{e[s]=k[s]||"MASK"}),s.litellm_params.pii_entities_config=e}else s.litellm_params.pii_entities_config={};await (0,y.Ko)(u,d,s),z.ZP.success("Guardrail updated successfully"),E(),b(!1)}catch(e){console.error("Error updating guardrail:",e),z.ZP.error("Failed to update guardrail")}};if(f)return(0,h.jsx)("div",{className:"p-4",children:"Loading..."});if(!g)return(0,h.jsx)("div",{className:"p-4",children:"Guardrail not found"});let q=e=>e?new Date(e).toLocaleString():"-",{logo:U,displayName:B}=rO((null===(s=g.litellm_params)||void 0===s?void 0:s.guardrail)||"");return(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,h.jsxs)("div",{children:[(0,h.jsx)(V.ZP,{onClick:m,className:"mb-4",children:"← Back"}),(0,h.jsx)(M.Z,{children:g.guardrail_name||"Unnamed Guardrail"}),(0,h.jsx)(O.Z,{className:"text-gray-500 font-mono",children:g.guardrail_id})]})}),(0,h.jsxs)(e4.Z,{children:[(0,h.jsxs)(e5.Z,{className:"mb-4",children:[(0,h.jsx)(e2.Z,{children:"Overview"},"overview"),p?(0,h.jsx)(e2.Z,{children:"Settings"},"settings"):(0,h.jsx)(h.Fragment,{})]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsxs)(e6.Z,{children:[(0,h.jsxs)(I.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Provider"}),(0,h.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[U&&(0,h.jsx)("img",{src:U,alt:"".concat(B," logo"),className:"w-6 h-6",onError:e=>{e.target.style.display="none"}}),(0,h.jsx)(M.Z,{children:B})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Mode"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsx)(M.Z,{children:(null===(t=g.litellm_params)||void 0===t?void 0:t.mode)||"-"}),(0,h.jsx)(e1.Z,{color:(null===(l=g.litellm_params)||void 0===l?void 0:l.default_on)?"green":"gray",children:(null===(a=g.litellm_params)||void 0===a?void 0:a.default_on)?"Default On":"Default Off"})]})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Created At"}),(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsx)(M.Z,{children:q(g.created_at)}),(0,h.jsxs)(O.Z,{children:["Last Updated: ",q(g.updated_at)]})]})]})]}),(null===(r=g.litellm_params)||void 0===r?void 0:r.pii_entities_config)&&Object.keys(g.litellm_params.pii_entities_config).length>0&&(0,h.jsx)(eo.Z,{className:"mt-6",children:(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"PII Protection"}),(0,h.jsxs)(e1.Z,{color:"blue",children:[Object.keys(g.litellm_params.pii_entities_config).length," PII entities configured"]})]})}),g.guardrail_info&&Object.keys(g.guardrail_info).length>0&&(0,h.jsxs)(eo.Z,{className:"mt-6",children:[(0,h.jsx)(O.Z,{children:"Guardrail Info"}),(0,h.jsx)("div",{className:"mt-2 space-y-2",children:Object.entries(g.guardrail_info).map(e=>{let[s,t]=e;return(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)(O.Z,{className:"font-medium w-1/3",children:s}),(0,h.jsx)(O.Z,{className:"w-2/3",children:"object"==typeof t?JSON.stringify(t,null,2):String(t)})]},s)})})]})]}),p&&(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(M.Z,{children:"Guardrail Settings"}),!_&&(0,h.jsx)(P.Z,{onClick:()=>b(!0),children:"Edit Settings"})]}),_?(0,h.jsxs)(R.Z,{form:N,onFinish:D,initialValues:{guardrail_name:g.guardrail_name,...g.litellm_params,guardrail_info:g.guardrail_info?JSON.stringify(g.guardrail_info,null,2):""},layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{label:"Guardrail Name",name:"guardrail_name",rules:[{required:!0,message:"Please input a guardrail name"}],children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"Default On",name:"default_on",children:(0,h.jsxs)(F.default,{children:[(0,h.jsx)(F.default.Option,{value:!0,children:"Yes"}),(0,h.jsx)(F.default.Option,{value:!1,children:"No"})]})}),(0,h.jsx)(tP.Z,{orientation:"left",children:"PII Protection"}),(0,h.jsx)("div",{className:"mb-6",children:C&&(0,h.jsx)(rW,{entities:C.supported_entities,actions:C.supported_actions,selectedEntities:Z,selectedActions:k,onEntitySelect:e=>{w(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},onActionSelect:(e,s)=>{S(t=>({...t,[e]:s}))},entityCategories:C.pii_entity_categories})}),(0,h.jsx)(tP.Z,{orientation:"left",children:"Advanced Settings"}),(0,h.jsx)(R.Z.Item,{label:"Guardrail Information",name:"guardrail_info",children:(0,h.jsx)(K.default.TextArea,{rows:5})}),(0,h.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,h.jsx)(V.ZP,{onClick:()=>b(!1),children:"Cancel"}),(0,h.jsx)(P.Z,{children:"Save Changes"})]})]}):(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Guardrail ID"}),(0,h.jsx)("div",{className:"font-mono",children:g.guardrail_id})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Guardrail Name"}),(0,h.jsx)("div",{children:g.guardrail_name||"Unnamed Guardrail"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Provider"}),(0,h.jsx)("div",{children:B})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Mode"}),(0,h.jsx)("div",{children:(null===(n=g.litellm_params)||void 0===n?void 0:n.mode)||"-"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Default On"}),(0,h.jsx)(e1.Z,{color:(null===(i=g.litellm_params)||void 0===i?void 0:i.default_on)?"green":"gray",children:(null===(o=g.litellm_params)||void 0===o?void 0:o.default_on)?"Yes":"No"})]}),(null===(c=g.litellm_params)||void 0===c?void 0:c.pii_entities_config)&&Object.keys(g.litellm_params.pii_entities_config).length>0&&(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"PII Protection"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsxs)(e1.Z,{color:"blue",children:[Object.keys(g.litellm_params.pii_entities_config).length," PII entities configured"]})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Created At"}),(0,h.jsx)("div",{children:q(g.created_at)})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Last Updated"}),(0,h.jsx)("div",{children:q(g.updated_at)})]})]})]})})]})]})]})},ne=e=>{let{guardrailsList:s,isLoading:t,onDeleteClick:l,accessToken:a,onGuardrailUpdated:r,isAdmin:n=!1,onShowGuardrailInfo:i}=e,[o,c]=(0,x.useState)([{id:"created_at",desc:!0}]),[d,m]=(0,x.useState)(!1),[u,p]=(0,x.useState)(null),[g,j]=(0,x.useState)(!1),[f,v]=(0,x.useState)(null),_=e=>e?new Date(e).toLocaleString():"-",y=e=>{v(e),j(!0),null==i||i(!0)},b=[{header:"Guardrail ID",accessorKey:"guardrail_id",cell:e=>(0,h.jsx)(X.Z,{title:String(e.getValue()||""),children:(0,h.jsx)(P.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>e.getValue()&&y(e.getValue()),children:e.getValue()?"".concat(String(e.getValue()).slice(0,7),"..."):""})})},{header:"Name",accessorKey:"guardrail_name",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)(X.Z,{title:t.guardrail_name,children:(0,h.jsx)("span",{className:"text-xs font-medium",children:t.guardrail_name||"-"})})}},{header:"Provider",accessorKey:"litellm_params.guardrail",cell:e=>{let{row:s}=e,{logo:t,displayName:l}=rO(s.original.litellm_params.guardrail);return(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,h.jsx)("img",{src:t,alt:"".concat(l," logo"),className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,h.jsx)("span",{className:"text-xs",children:l})]})}},{header:"Mode",accessorKey:"litellm_params.mode",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("span",{className:"text-xs",children:t.litellm_params.mode})}},{header:"Created At",accessorKey:"created_at",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)(X.Z,{title:t.created_at,children:(0,h.jsx)("span",{className:"text-xs",children:_(t.created_at)})})}},{header:"Updated At",accessorKey:"updated_at",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)(X.Z,{title:t.updated_at,children:(0,h.jsx)("span",{className:"text-xs",children:_(t.updated_at)})})}},{id:"actions",header:"",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("div",{className:"flex space-x-2",children:(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>t.guardrail_id&&l(t.guardrail_id,t.guardrail_name||"Unnamed Guardrail"),className:"cursor-pointer hover:text-red-500",tooltip:"Delete guardrail"})})}}],N=(0,s_.b7)({data:s,columns:b,state:{sorting:o},onSortingChange:c,getCoreRowModel:(0,sy.sC)(),getSortedRowModel:(0,sy.tj)(),enableSorting:!0});return g&&f?(0,h.jsx)(r9,{guardrailId:f,onClose:()=>{j(!1),v(null),null==i||i(!1)},accessToken:a,isAdmin:n}):(0,h.jsxs)("div",{className:"rounded-lg custom-border relative",children:[(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsxs)(sN.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,h.jsx)(sk.Z,{children:N.getHeaderGroups().map(e=>(0,h.jsx)(sC.Z,{children:e.headers.map(e=>(0,h.jsx)(sS.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,h.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,h.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,s_.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,h.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,h.jsx)(sA.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,h.jsx)(sI.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,h.jsx)(sT.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,h.jsx)(sZ.Z,{children:t?(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:b.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:"Loading..."})})})}):s.length>0?N.getRowModel().rows.map(e=>(0,h.jsx)(sC.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,h.jsx)(sw.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,s_.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:b.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:"No guardrails found"})})})})})]})}),u&&(0,h.jsx)(r7,{visible:d,onClose:()=>m(!1),accessToken:a,onSuccess:()=>{m(!1),p(null),r()},guardrailId:u.guardrail_id||"",initialValues:{guardrail_name:u.guardrail_name||"",provider:Object.keys(rA).find(e=>rA[e]===(null==u?void 0:u.litellm_params.guardrail))||"",mode:u.litellm_params.mode,default_on:u.litellm_params.default_on,pii_entities_config:u.litellm_params.pii_entities_config,...u.guardrail_info}})]})},ns=e=>{let{accessToken:s,userRole:t}=e,[l,a]=(0,x.useState)([]),[r,n]=(0,x.useState)(!1),[i,o]=(0,x.useState)(!1),[c,d]=(0,x.useState)(!1),[m,u]=(0,x.useState)(null),[p,g]=(0,x.useState)(!1),j=!!t&&eq(t),f=async()=>{if(s){o(!0);try{let e=await (0,y.t3)(s);console.log("guardrails: ".concat(JSON.stringify(e))),a(e.guardrails)}catch(e){console.error("Error fetching guardrails:",e)}finally{o(!1)}}};(0,x.useEffect)(()=>{f()},[s]);let v=async()=>{if(m&&s){d(!0);try{await (0,y.Yi)(s,m.id),z.ZP.success('Guardrail "'.concat(m.name,'" deleted successfully')),f()}catch(e){console.error("Error deleting guardrail:",e),z.ZP.error("Failed to delete guardrail")}finally{d(!1),u(null)}}};return(0,h.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[!p&&(0,h.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,h.jsx)(P.Z,{icon:ed.Z,onClick:()=>{n(!0)},disabled:!s,children:"Add Guardrail"})}),(0,h.jsx)(ne,{guardrailsList:l,isLoading:i,onDeleteClick:(e,s)=>{u({id:e,name:s})},accessToken:s,onGuardrailUpdated:f,isAdmin:j,onShowGuardrailInfo:g}),(0,h.jsx)(r5,{visible:r,onClose:()=>{n(!1)},accessToken:s,onSuccess:()=>{f()}}),m&&(0,h.jsxs)(q.Z,{title:"Delete Guardrail",open:null!==m,onOk:v,onCancel:()=>{u(null)},confirmLoading:c,okText:"Delete",okButtonProps:{danger:!0},children:[(0,h.jsxs)("p",{children:["Are you sure you want to delete guardrail: ",m.name," ?"]}),(0,h.jsx)("p",{children:"This action cannot be undone."})]})]})},nt=e=>{let{accessToken:s}=e,[t,l]=(0,x.useState)('{\n  "model": "openai/gpt-4o",\n  "messages": [\n    {\n      "role": "system",\n      "content": "You are a helpful assistant."\n    },\n    {\n      "role": "user",\n      "content": "Explain quantum computing in simple terms"\n    }\n  ],\n  "temperature": 0.7,\n  "max_tokens": 500,\n  "stream": true\n}'),[a,r]=(0,x.useState)(""),[n,i]=(0,x.useState)(!1),o=(e,s,t)=>{let l=JSON.stringify(s,null,2).split("\n").map(e=>"  ".concat(e)).join("\n"),a=Object.entries(t).map(e=>{let[s,t]=e;return"-H '".concat(s,": ").concat(t,"'")}).join(" \\\n  ");return"curl -X POST \\\n  ".concat(e," \\\n  ").concat(a?"".concat(a," \\\n  "):"","-H 'Content-Type: application/json' \\\n  -d '{\n").concat(l,"\n  }'")},c=async()=>{i(!0);try{let e;try{e=JSON.parse(t)}catch(e){z.ZP.error("Invalid JSON in request body"),i(!1);return}let l={call_type:"completion",request_body:e};if(!s){z.ZP.error("No access token found"),i(!1);return}let a=await (0,y.Yo)(s,l);if(a.raw_request_api_base&&a.raw_request_body){let e=o(a.raw_request_api_base,a.raw_request_body,a.raw_request_headers||{});r(e),z.ZP.success("Request transformed successfully")}else{let e="string"==typeof a?a:JSON.stringify(a);r(e),z.ZP.info("Transformed request received in unexpected format")}}catch(e){console.error("Error transforming request:",e),z.ZP.error("Failed to transform request")}finally{i(!1)}};return(0,h.jsxs)("div",{className:"w-full m-2",style:{overflow:"hidden"},children:[(0,h.jsx)(M.Z,{children:"Playground"}),(0,h.jsx)("p",{className:"text-sm text-gray-500",children:"See how LiteLLM transforms your request for the specified provider."}),(0,h.jsxs)("div",{style:{display:"flex",gap:"16px",width:"100%",minWidth:0,overflow:"hidden"},className:"mt-4",children:[(0,h.jsxs)("div",{style:{flex:"1 1 50%",display:"flex",flexDirection:"column",border:"1px solid #e8e8e8",borderRadius:"8px",padding:"24px",overflow:"hidden",maxHeight:"600px",minWidth:0},children:[(0,h.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,h.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",margin:"0 0 4px 0"},children:"Original Request"}),(0,h.jsx)("p",{style:{color:"#666",margin:0},children:"The request you would send to LiteLLM /chat/completions endpoint."})]}),(0,h.jsx)("textarea",{style:{flex:"1 1 auto",width:"100%",minHeight:"240px",padding:"16px",border:"1px solid #e8e8e8",borderRadius:"6px",fontFamily:"monospace",fontSize:"14px",resize:"none",marginBottom:"24px",overflow:"auto"},value:t,onChange:e=>l(e.target.value),onKeyDown:e=>{(e.metaKey||e.ctrlKey)&&"Enter"===e.key&&(e.preventDefault(),c())},placeholder:"Press Cmd/Ctrl + Enter to transform"}),(0,h.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"auto"},children:(0,h.jsxs)(V.ZP,{type:"primary",style:{backgroundColor:"#000",display:"flex",alignItems:"center",gap:"8px"},onClick:c,loading:n,children:[(0,h.jsx)("span",{children:"Transform"}),(0,h.jsx)("span",{children:"→"})]})})]}),(0,h.jsxs)("div",{style:{flex:"1 1 50%",display:"flex",flexDirection:"column",border:"1px solid #e8e8e8",borderRadius:"8px",padding:"24px",overflow:"hidden",maxHeight:"800px",minWidth:0},children:[(0,h.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,h.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",margin:"0 0 4px 0"},children:"Transformed Request"}),(0,h.jsx)("p",{style:{color:"#666",margin:0},children:"How LiteLLM transforms your request for the specified provider."}),(0,h.jsx)("br",{}),(0,h.jsx)("p",{style:{color:"#666",margin:0},className:"text-xs",children:"Note: Sensitive headers are not shown."})]}),(0,h.jsxs)("div",{style:{position:"relative",backgroundColor:"#f5f5f5",borderRadius:"6px",flex:"1 1 auto",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,h.jsx)("pre",{style:{padding:"16px",fontFamily:"monospace",fontSize:"14px",margin:0,overflow:"auto",flex:"1 1 auto"},children:a||'curl -X POST \\\n  https://api.openai.com/v1/chat/completions \\\n  -H \'Authorization: Bearer sk-xxx\' \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n  "model": "gpt-4",\n  "messages": [\n    {\n      "role": "system",\n      "content": "You are a helpful assistant."\n    }\n  ],\n  "temperature": 0.7\n  }\''}),(0,h.jsx)(V.ZP,{type:"text",icon:(0,h.jsx)(tA.Z,{}),style:{position:"absolute",right:"8px",top:"8px"},size:"small",onClick:()=>{navigator.clipboard.writeText(a||""),z.ZP.success("Copied to clipboard")}})]})]})]}),(0,h.jsx)("div",{className:"mt-4 text-right w-full",children:(0,h.jsxs)("p",{className:"text-sm text-gray-500",children:["Found an error? File an issue ",(0,h.jsx)("a",{href:"https://github.com/BerriAI/litellm/issues",target:"_blank",rel:"noopener noreferrer",children:"here"}),"."]})})]})},nl=t(98335);let na={NONE:"none",API_KEY:"api_key",BEARER_TOKEN:"bearer_token",BASIC:"basic"},nr={SSE:"sse"},nn=e=>(console.log(e),null==e)?nr.SSE:e,ni=e=>null==e?na.NONE:e,no=e=>ni(e)!==na.NONE,nc=e=>{try{let s=e.indexOf("/mcp/");if(-1===s)return{token:null,baseUrl:e};let t=e.split("/mcp/");if(2!==t.length)return{token:null,baseUrl:e};let l=t[0]+"/mcp/",a=t[1];if(!a)return{token:null,baseUrl:e};return{token:a,baseUrl:l}}catch(s){return console.error("Error parsing MCP URL:",s),{token:null,baseUrl:e}}},nd=e=>{let{token:s,baseUrl:t}=nc(e);return s?t+"...":e},nm=e=>{let{token:s}=nc(e);return{maskedUrl:nd(e),hasToken:!!s}},nu=e=>"".concat(e.slice(0,7),"..."),nh=(e,s,t,l)=>[{accessorKey:"server_id",header:"ID",cell:e=>{let{getValue:t,row:l}=e;return(0,h.jsx)("button",{onClick:()=>s(l.original.server_id),className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",children:nu(t())})}},{accessorKey:"alias",header:"Name"},{accessorKey:"url",header:"URL",cell:e=>{let{getValue:s}=e;return(0,h.jsx)(X.Z,{title:s(),children:(0,h.jsx)("span",{className:"font-mono text-gray-600 text-xs",children:nd(s())})})}},{accessorKey:"transport",header:"Transport",cell:e=>{let{row:s}=e;return nn(s.original.transport)}},{accessorKey:"auth_type",header:"Auth Type",cell:e=>{let{row:s}=e;return ni(s.original.auth_type)}},{id:"actions",header:"Info",cell:s=>{let{row:a}=s;return eq(e||"")?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>t(a.original.server_id)}),(0,h.jsx)(sb.Z,{onClick:()=>l(a.original.server_id),icon:em.Z,size:"sm"})]}):null}}];var nx=t(82376),np=t(71437),ng=e=>{let{mcpServer:s,accessToken:t,onCancel:l,onSuccess:a}=e,[r]=R.Z.useForm(),n=async e=>{if(t)try{let l=await (0,y.gl)(t,{...e,server_id:s.server_id});z.ZP.success("MCP Server updated successfully"),a(l)}catch(e){z.ZP.error("Failed to update MCP Server"+((null==e?void 0:e.message)?": ".concat(e.message):""))}};return(0,h.jsxs)(R.Z,{form:r,onFinish:n,initialValues:s,layout:"vertical",children:[(0,h.jsx)(R.Z.Item,{label:"MCP Server Name",name:"alias",children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"Description",name:"description",children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"MCP Server URL",name:"url",rules:[{required:!0,message:"Please enter a server URL"}],children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"Transport Type",name:"transport",rules:[{required:!0}],children:(0,h.jsxs)(F.default,{children:[(0,h.jsx)(F.default.Option,{value:"sse",children:"Server-Sent Events (SSE)"}),(0,h.jsx)(F.default.Option,{value:"http",children:"HTTP"})]})}),(0,h.jsx)(R.Z.Item,{label:"Authentication",name:"auth_type",rules:[{required:!0}],children:(0,h.jsxs)(F.default,{children:[(0,h.jsx)(F.default.Option,{value:"none",children:"None"}),(0,h.jsx)(F.default.Option,{value:"api_key",children:"API Key"}),(0,h.jsx)(F.default.Option,{value:"bearer_token",children:"Bearer Token"}),(0,h.jsx)(F.default.Option,{value:"basic",children:"Basic Auth"})]})}),(0,h.jsx)(R.Z.Item,{label:"MCP Version",name:"spec_version",rules:[{required:!0}],children:(0,h.jsxs)(F.default,{children:[(0,h.jsx)(F.default.Option,{value:"2025-03-26",children:"2025-03-26 (Latest)"}),(0,h.jsx)(F.default.Option,{value:"2024-11-05",children:"2024-11-05"})]})}),(0,h.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,h.jsx)(V.ZP,{onClick:l,children:"Cancel"}),(0,h.jsx)(P.Z,{type:"submit",children:"Save Changes"})]})]})};let nj=e=>{var s,t;let{mcpServer:l,onBack:a,isEditing:r,isProxyAdmin:n,accessToken:i,userRole:o,userID:c}=e,[d,m]=(0,x.useState)(r),[u,p]=(0,x.useState)(!1),{maskedUrl:g,hasToken:j}=nm(l.url),f=(e,s)=>j?s?e:g:e;return(0,h.jsxs)("div",{className:"p-4 max-w-full",children:[(0,h.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,h.jsxs)("div",{children:[(0,h.jsx)(P.Z,{onClick:a,className:"mb-4",children:"← Back"}),(0,h.jsx)(M.Z,{children:l.alias}),(0,h.jsx)(O.Z,{className:"text-gray-500 font-mono",children:l.server_id})]})}),(0,h.jsxs)(e4.Z,{defaultIndex:d?2:0,children:[(0,h.jsx)(e5.Z,{className:"mb-4",children:[(0,h.jsx)(e2.Z,{children:"Overview"},"overview"),(0,h.jsx)(e2.Z,{children:"MCP Tools"},"tools"),...n?[(0,h.jsx)(e2.Z,{children:"Settings"},"settings")]:[]]}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(I.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Transport"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)(M.Z,{children:nn(null!==(s=l.transport)&&void 0!==s?s:void 0)})})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Auth Type"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)(O.Z,{children:ni(null!==(t=l.auth_type)&&void 0!==t?t:void 0)})})]}),(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(O.Z,{children:"Host Url"}),(0,h.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,h.jsx)(O.Z,{className:"break-all overflow-wrap-anywhere",children:f(l.url,u)}),j&&(0,h.jsx)("button",{onClick:()=>p(!u),className:"p-1 hover:bg-gray-100 rounded",children:(0,h.jsx)(sb.Z,{icon:u?nx.Z:np.Z,size:"sm",className:"text-gray-500"})})]})]})]})}),(0,h.jsx)(e6.Z,{children:(0,h.jsx)(nV,{serverId:l.server_id,accessToken:i,auth_type:l.auth_type,userRole:o,userID:c})}),(0,h.jsx)(e6.Z,{children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)(M.Z,{children:"MCP Server Settings"}),d?null:(0,h.jsx)(P.Z,{variant:"light",onClick:()=>m(!0),children:"Edit Settings"})]}),d?(0,h.jsx)(ng,{mcpServer:l,accessToken:i,onCancel:()=>m(!1),onSuccess:e=>{m(!1),a()}}):(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Server Name"}),(0,h.jsx)("div",{children:l.alias})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Description"}),(0,h.jsx)("div",{children:l.description})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"URL"}),(0,h.jsxs)("div",{className:"font-mono break-all overflow-wrap-anywhere max-w-full flex items-center gap-2",children:[f(l.url,u),j&&(0,h.jsx)("button",{onClick:()=>p(!u),className:"p-1 hover:bg-gray-100 rounded",children:(0,h.jsx)(sb.Z,{icon:u?nx.Z:np.Z,size:"sm",className:"text-gray-500"})})]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Transport"}),(0,h.jsx)("div",{children:nn(l.transport)})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Auth Type"}),(0,h.jsx)("div",{children:ni(l.auth_type)})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Spec Version"}),(0,h.jsx)("div",{children:l.spec_version})]})]})]})})]})]})]})},nf="".concat("../ui/assets/logos/","mcp_logo.png");var nv=e=>{let{userRole:s,accessToken:t,onCreateSuccess:l}=e,[a]=R.Z.useForm(),[r,n]=(0,x.useState)(!1),i=async e=>{n(!0);try{if(console.log("formValues: ".concat(JSON.stringify(e))),null!=t){let s=await (0,y.Pj)(t,e);z.ZP.success("MCP Server created successfully"),a.resetFields(),c(!1),l(s)}}catch(e){z.ZP.error("Error creating MCP Server: "+e,20)}finally{n(!1)}},[o,c]=(0,x.useState)(!1),d=()=>{a.resetFields(),c(!1)};return eq(s)?(0,h.jsxs)("div",{children:[(0,h.jsx)(P.Z,{className:"mx-auto mb-4",onClick:()=>c(!0),children:"+ Add New MCP Server"}),(0,h.jsx)(q.Z,{title:(0,h.jsxs)("div",{className:"flex items-center space-x-3 pb-4 border-b border-gray-100",children:[(0,h.jsx)("img",{src:nf,alt:"MCP Logo",className:"w-8 h-8 object-contain",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"}}),(0,h.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New MCP Server"})]}),open:o,width:1e3,onCancel:d,footer:null,className:"top-8",styles:{body:{padding:"24px"},header:{padding:"24px 24px 0 24px",border:"none"}},children:(0,h.jsx)("div",{className:"mt-6",children:(0,h.jsxs)(R.Z,{form:a,onFinish:i,layout:"vertical",className:"space-y-6",children:[(0,h.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["MCP Server Name",(0,h.jsx)(X.Z,{title:"Best practice: Use a descriptive name that indicates the server's purpose (e.g., 'GitHub Integration', 'Email Service')",children:(0,h.jsx)($.Z,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"alias",rules:[{required:!1,message:"Please enter a server name"}],children:(0,h.jsx)(A.Z,{placeholder:"e.g., GitHub MCP, Zapier MCP, etc.",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Description"}),name:"description",rules:[{required:!1,message:"Please enter a server description"}],children:(0,h.jsx)(A.Z,{placeholder:"Brief description of what this server does",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["MCP Server URL ",(0,h.jsx)("span",{className:"text-red-500",children:"*"})]}),name:"url",rules:[{required:!0,message:"Please enter a server URL"},{type:"url",message:"Please enter a valid URL"}],children:(0,h.jsx)(A.Z,{placeholder:"https://your-mcp-server.com",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,h.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Transport Type ",(0,h.jsx)("span",{className:"text-red-500",children:"*"})]}),name:"transport",rules:[{required:!0,message:"Please select a transport type"}],children:(0,h.jsxs)(F.default,{placeholder:"Select transport",className:"rounded-lg",size:"large",children:[(0,h.jsx)(F.default.Option,{value:"sse",children:"Server-Sent Events (SSE)"}),(0,h.jsx)(F.default.Option,{value:"http",children:"HTTP"})]})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Authentication ",(0,h.jsx)("span",{className:"text-red-500",children:"*"})]}),name:"auth_type",rules:[{required:!0,message:"Please select an auth type"}],children:(0,h.jsxs)(F.default,{placeholder:"Select auth type",className:"rounded-lg",size:"large",children:[(0,h.jsx)(F.default.Option,{value:"none",children:"None"}),(0,h.jsx)(F.default.Option,{value:"api_key",children:"API Key"}),(0,h.jsx)(F.default.Option,{value:"bearer_token",children:"Bearer Token"}),(0,h.jsx)(F.default.Option,{value:"basic",children:"Basic Auth"})]})})]}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["MCP Version ",(0,h.jsx)("span",{className:"text-red-500 ml-1",children:"*"}),(0,h.jsx)(X.Z,{title:"Select the MCP specification version your server supports",children:(0,h.jsx)($.Z,{className:"ml-2 text-gray-400 hover:text-gray-600"})})]}),name:"spec_version",rules:[{required:!0,message:"Please select a spec version"}],children:(0,h.jsxs)(F.default,{placeholder:"Select MCP version",className:"rounded-lg",size:"large",children:[(0,h.jsx)(F.default.Option,{value:"2025-03-26",children:"2025-03-26 (Latest)"}),(0,h.jsx)(F.default.Option,{value:"2024-11-05",children:"2024-11-05"})]})})]}),(0,h.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-100",children:[(0,h.jsx)(P.Z,{variant:"secondary",onClick:d,children:"Cancel"}),(0,h.jsx)(P.Z,{variant:"primary",loading:r,children:r?"Creating...":"Add MCP Server"})]})]})})})]}):null},n_=t(64935),ny=t(30401),nb=t(78867),nN=t(11239),nZ=t(54001),nw=t(96137),nk=t(96362),nS=t(80221),nC=t(29202);let{Title:nI,Text:nP}=ef.default,{Panel:nA}=aj.default,nT=e=>{let{icon:s,title:t,description:l,children:a,serverName:r}=e,[n,i]=(0,x.useState)(!1),o=()=>{let e={"x-litellm-api-key":"Bearer YOUR_LITELLM_API_KEY"};if(n&&r){let s=r.replace(/\s+/g,"_");e["x-mcp-servers"]='["'.concat(s,'"]')}return e};return(0,h.jsxs)(tb.Z,{className:"border border-gray-200",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,h.jsx)("span",{className:"p-2 rounded-lg bg-gray-50",children:s}),(0,h.jsxs)("div",{children:[(0,h.jsx)(nI,{level:5,className:"mb-0",children:t}),(0,h.jsx)(nP,{className:"text-gray-600",children:l})]})]}),r&&("Implementation Example"===t||"Configuration"===t)&&(0,h.jsx)(R.Z.Item,{className:"mb-4",children:(0,h.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,h.jsx)(tg.Z,{size:"small",checked:n,onChange:i}),(0,h.jsxs)(nP,{className:"text-sm",children:["Segregate tools to just use ",r," tools"]})]})}),x.Children.map(a,e=>{if(x.isValidElement(e)&&e.props.hasOwnProperty("code")&&e.props.hasOwnProperty("copyKey")){let s=e.props.code;if(s&&s.includes('"headers":'))return x.cloneElement(e,{code:s.replace(/"headers":\s*{[^}]*}/,'"headers": '.concat(JSON.stringify(o(),null,8)))})}return e})]})};var nE=()=>{let e=(0,y.zX)(),[s,t]=(0,x.useState)({}),[l,a]=(0,x.useState)({openai:[],litellm:[],cursor:[],http:[]}),[r]=(0,x.useState)("Zapier Gmail"),n=async(e,s)=>{try{await navigator.clipboard.writeText(e),t(e=>({...e,[s]:!0})),z.ZP.success("Copied to clipboard"),setTimeout(()=>{t(e=>({...e,[s]:!1}))},2e3)}catch(e){z.ZP.error("Failed to copy to clipboard")}},i=e=>{let{code:t,copyKey:l,title:a,className:r=""}=e;return(0,h.jsxs)("div",{className:"relative group",children:[a&&(0,h.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,h.jsx)(n_.Z,{size:16,className:"text-blue-600"}),(0,h.jsx)(nP,{strong:!0,className:"text-gray-700",children:a})]}),(0,h.jsxs)(tb.Z,{className:"bg-gray-50 border border-gray-200 relative ".concat(r),children:[(0,h.jsx)(V.ZP,{type:"text",size:"small",icon:s[l]?(0,h.jsx)(ny.Z,{size:14}):(0,h.jsx)(nb.Z,{size:14}),onClick:()=>n(t,l),className:"absolute top-2 right-2 z-10 transition-all duration-200 ".concat(s[l]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")}),(0,h.jsx)("pre",{className:"text-sm overflow-x-auto pr-10 text-gray-800 font-mono leading-relaxed",children:t})]})]})},o=e=>{let{step:s,title:t,children:l}=e;return(0,h.jsxs)("div",{className:"flex gap-4",children:[(0,h.jsx)("div",{className:"flex-shrink-0",children:(0,h.jsx)("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:s})}),(0,h.jsxs)("div",{className:"flex-1",children:[(0,h.jsx)(nP,{strong:!0,className:"text-gray-800 block mb-2",children:t}),l]})]})};return(0,h.jsx)("div",{children:(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(M.Z,{className:"text-3xl font-bold text-gray-900 mb-3",children:"Connect to your MCP client"}),(0,h.jsx)(O.Z,{className:"text-lg text-gray-600",children:"Use tools directly from any MCP client with LiteLLM MCP. Enable your AI assistant to perform real-world tasks through a simple, secure connection."})]}),(0,h.jsxs)(e4.Z,{className:"w-full",children:[(0,h.jsx)(e5.Z,{className:"flex justify-start mt-8 mb-6",children:(0,h.jsxs)("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[(0,h.jsx)(e2.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,h.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,h.jsx)(n_.Z,{size:18}),"OpenAI API"]})}),(0,h.jsx)(e2.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,h.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,h.jsx)(nN.Z,{size:18}),"LiteLLM Proxy"]})}),(0,h.jsx)(e2.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,h.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,h.jsx)(nS.Z,{size:18}),"Cursor"]})}),(0,h.jsx)(e2.Z,{className:"px-6 py-3 rounded-md transition-all duration-200",children:(0,h.jsxs)("span",{className:"flex items-center gap-2 font-medium",children:[(0,h.jsx)(nC.Z,{size:18}),"Streamable HTTP"]})})]})}),(0,h.jsxs)(e3.Z,{children:[(0,h.jsx)(e6.Z,{className:"mt-6",children:(0,h.jsx)(()=>(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,h.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-100",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,h.jsx)(n_.Z,{className:"text-blue-600",size:24}),(0,h.jsx)(nI,{level:4,className:"mb-0 text-blue-900",children:"OpenAI Responses API Integration"})]}),(0,h.jsx)(nP,{className:"text-blue-700",children:"Connect OpenAI Responses API to your LiteLLM MCP server for seamless tool integration"})]}),(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,h.jsx)(nT,{icon:(0,h.jsx)(nZ.Z,{className:"text-blue-600",size:16}),title:"API Key Setup",description:"Configure your OpenAI API key for authentication",children:(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"middle",className:"w-full",children:[(0,h.jsx)("div",{children:(0,h.jsxs)(nP,{children:["Get your API key from the"," ",(0,h.jsxs)("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["OpenAI platform ",(0,h.jsx)(nk.Z,{size:12})]})]})}),(0,h.jsx)(i,{title:"Environment Variable",code:'export OPENAI_API_KEY="sk-..."',copyKey:"openai-env"})]})}),(0,h.jsx)(nT,{icon:(0,h.jsx)(nw.Z,{className:"text-blue-600",size:16}),title:"MCP Server Information",description:"Connection details for your LiteLLM MCP server",children:(0,h.jsx)(i,{title:"Server URL",code:"".concat(e,"/mcp"),copyKey:"openai-server-url"})}),(0,h.jsx)(nT,{icon:(0,h.jsx)(n_.Z,{className:"text-blue-600",size:16}),title:"Implementation Example",description:"Complete cURL example for using the Responses API",serverName:"Zapier Gmail",children:(0,h.jsx)(i,{code:'curl --location \'https://api.openai.com/v1/responses\' \\\n--header \'Content-Type: application/json\' \\\n--header "Authorization: Bearer $OPENAI_API_KEY" \\\n--data \'{\n    "model": "gpt-4.1",\n    "tools": [\n        {\n            "type": "mcp",\n            "server_label": "litellm",\n            "server_url": "'.concat(e,'/mcp",\n            "require_approval": "never",\n            "headers": {\n                "x-litellm-api-key": "Bearer YOUR_LITELLM_API_KEY"\n            }\n        }\n    ],\n    "input": "Run available tools",\n    "tool_choice": "required"\n}\''),copyKey:"openai-curl",className:"text-xs"})})]})]}),{})}),(0,h.jsx)(e6.Z,{className:"mt-6",children:(0,h.jsx)(()=>(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,h.jsxs)("div",{className:"bg-gradient-to-r from-emerald-50 to-green-50 p-6 rounded-lg border border-emerald-100",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,h.jsx)(nN.Z,{className:"text-emerald-600",size:24}),(0,h.jsx)(nI,{level:4,className:"mb-0 text-emerald-900",children:"LiteLLM Proxy API Integration"})]}),(0,h.jsx)(nP,{className:"text-emerald-700",children:"Connect to LiteLLM Proxy Responses API for seamless tool integration with multiple model providers"})]}),(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,h.jsx)(nT,{icon:(0,h.jsx)(nZ.Z,{className:"text-emerald-600",size:16}),title:"API Key Setup",description:"Configure your LiteLLM Proxy API key for authentication",children:(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"middle",className:"w-full",children:[(0,h.jsx)("div",{children:(0,h.jsx)(nP,{children:"Get your API key from your LiteLLM Proxy dashboard or contact your administrator"})}),(0,h.jsx)(i,{title:"Environment Variable",code:'export LITELLM_API_KEY="sk-..."',copyKey:"litellm-env"})]})}),(0,h.jsx)(nT,{icon:(0,h.jsx)(nw.Z,{className:"text-emerald-600",size:16}),title:"MCP Server Information",description:"Connection details for your LiteLLM MCP server",children:(0,h.jsx)(i,{title:"Server URL",code:"".concat(e,"/mcp"),copyKey:"litellm-server-url"})}),(0,h.jsx)(nT,{icon:(0,h.jsx)(n_.Z,{className:"text-emerald-600",size:16}),title:"Implementation Example",description:"Complete cURL example for using the LiteLLM Proxy Responses API",serverName:r,children:(0,h.jsx)(i,{code:"curl --location '".concat(e,'/v1/responses\' \\\n--header \'Content-Type: application/json\' \\\n--header "Authorization: Bearer $LITELLM_API_KEY" \\\n--data \'{\n    "model": "gpt-4",\n    "tools": [\n        {\n            "type": "mcp",\n            "server_label": "litellm",\n            "server_url": "').concat(e,'/mcp",\n            "require_approval": "never",\n            "headers": {\n                "x-litellm-api-key": "Bearer YOUR_LITELLM_API_KEY"\n            }\n        }\n    ],\n    "input": "Run available tools",\n    "tool_choice": "required"\n}\''),copyKey:"litellm-curl",className:"text-xs"})})]})]}),{})}),(0,h.jsx)(e6.Z,{className:"mt-6",children:(0,h.jsx)(()=>(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,h.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-lg border border-purple-100",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,h.jsx)(nS.Z,{className:"text-purple-600",size:24}),(0,h.jsx)(nI,{level:4,className:"mb-0 text-purple-900",children:"Cursor IDE Integration"})]}),(0,h.jsx)(nP,{className:"text-purple-700",children:"Use tools directly from Cursor IDE with LiteLLM MCP. Enable your AI assistant to perform real-world tasks without leaving your coding environment."})]}),(0,h.jsxs)(tb.Z,{className:"border border-gray-200",children:[(0,h.jsx)(nI,{level:5,className:"mb-4 text-gray-800",children:"Setup Instructions"}),(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,h.jsx)(o,{step:1,title:"Open Cursor Settings",children:(0,h.jsxs)(nP,{className:"text-gray-600",children:["Use the keyboard shortcut ",(0,h.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"⇧+⌘+J"})," (Mac) or ",(0,h.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Ctrl+Shift+J"})," (Windows/Linux)"]})}),(0,h.jsx)(o,{step:2,title:"Navigate to MCP Tools",children:(0,h.jsx)(nP,{className:"text-gray-600",children:'Go to the "MCP Tools" tab and click "New MCP Server"'})}),(0,h.jsxs)(o,{step:3,title:"Add Configuration",children:[(0,h.jsxs)(nP,{className:"text-gray-600 mb-3",children:["Copy the JSON configuration below and paste it into Cursor, then save with ",(0,h.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Cmd+S"})," or ",(0,h.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Ctrl+S"})]}),(0,h.jsx)(nT,{icon:(0,h.jsx)(n_.Z,{className:"text-purple-600",size:16}),title:"Configuration",description:"Cursor MCP configuration",serverName:"Zapier Gmail",children:(0,h.jsx)(i,{code:'{\n  "mcpServers": {\n    "LiteLLM": {\n      "url": "'.concat(e,'/mcp",\n      "headers": {\n        "x-litellm-api-key": "Bearer YOUR_LITELLM_API_KEY"\n      }\n    }\n  }\n}'),copyKey:"cursor-config"})})]})]})]})]}),{})}),(0,h.jsx)(e6.Z,{className:"mt-6",children:(0,h.jsx)(()=>(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"large",className:"w-full",children:[(0,h.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-teal-50 p-6 rounded-lg border border-green-100",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,h.jsx)(nC.Z,{className:"text-green-600",size:24}),(0,h.jsx)(nI,{level:4,className:"mb-0 text-green-900",children:"Streamable HTTP Transport"})]}),(0,h.jsx)(nP,{className:"text-green-700",children:"Connect to LiteLLM MCP using HTTP transport. Compatible with any MCP client that supports HTTP streaming."})]}),(0,h.jsx)(nT,{icon:(0,h.jsx)(nC.Z,{className:"text-green-600",size:16}),title:"Universal MCP Connection",description:"Use this URL with any MCP client that supports HTTP transport",children:(0,h.jsxs)(tJ.Z,{direction:"vertical",size:"middle",className:"w-full",children:[(0,h.jsx)("div",{children:(0,h.jsx)(nP,{children:"Each MCP client supports different transports. Refer to your client documentation to determine the appropriate transport method."})}),(0,h.jsx)(i,{title:"Server URL",code:"".concat(e,"/mcp"),copyKey:"http-server-url"}),(0,h.jsx)(i,{title:"Headers Configuration",code:JSON.stringify({"x-litellm-api-key":"Bearer YOUR_LITELLM_API_KEY"},null,2),copyKey:"http-headers"}),(0,h.jsx)("div",{className:"mt-4",children:(0,h.jsx)(V.ZP,{type:"link",className:"p-0 h-auto text-blue-600 hover:text-blue-700",href:"https://modelcontextprotocol.io/docs/concepts/transports",icon:(0,h.jsx)(nk.Z,{size:14}),children:"Learn more about MCP transports"})})]})})]}),{})})]})]})]})})};let nL=e=>{let{isModalOpen:s,title:t,confirmDelete:l,cancelDelete:a}=e;return s?(0,h.jsx)(q.Z,{open:s,onOk:l,okType:"danger",onCancel:a,children:(0,h.jsxs)(I.Z,{numItems:1,className:"gap-2 w-full",children:[(0,h.jsx)(M.Z,{children:t}),(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)("p",{children:"Are you sure you want to delete this MCP Server?"})})]})}):null};var nO=e=>{let{accessToken:s,userRole:t,userID:l}=e,{data:a,isLoading:r,refetch:n}=(0,sp.a)({queryKey:["mcpServers"],queryFn:()=>{if(!s)throw Error("Access Token required");return(0,y.U8)(s)},enabled:!!s}),i=e=>{n()},[o,c]=(0,x.useState)(null),[d,m]=(0,x.useState)(!1),[u,p]=(0,x.useState)(null),[g,j]=(0,x.useState)(!1),f=x.useMemo(()=>nh(t,e=>p(e),e=>{p(e),j(!0)},v),[t,v]);function v(e){c(e),m(!0)}let _=async()=>{if(null!=o&&null!=s){try{await (0,y.xZ)(s,o),z.ZP.success("Deleted MCP Server successfully"),n()}catch(e){console.error("Error deleting the mcp server:",e)}m(!1),c(null)}},b=()=>{m(!1),c(null)};return s&&t&&l?(0,h.jsx)("div",{className:"w-full h-[75vh] mt-8 p-6",children:(0,h.jsxs)(e4.Z,{className:"h-full",children:[(0,h.jsx)(e5.Z,{children:(0,h.jsxs)("div",{className:"flex",children:[(0,h.jsx)(e2.Z,{children:"Servers"}),(0,h.jsx)(e2.Z,{children:(0,h.jsxs)("span",{className:"flex items-center gap-2",children:[(0,h.jsx)(nl.Z,{size:16}),"Connect"]})})]})}),(0,h.jsxs)(e3.Z,{className:"h-full",children:[(0,h.jsx)(e6.Z,{className:"h-full",children:(0,h.jsx)(()=>u?(0,h.jsx)(nj,{mcpServer:a.find(e=>e.server_id===u)||{},onBack:()=>{j(!1),p(null),n()},isProxyAdmin:eq(t),isEditing:g,accessToken:s,userID:l,userRole:t}):(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:"mb-2 mt-4",children:(0,h.jsxs)("div",{children:[(0,h.jsx)(M.Z,{children:"MCP Servers"}),(0,h.jsx)(O.Z,{className:"text-tremor-content",children:"Configure and manage your MCP servers"})]})}),(0,h.jsx)(nv,{userRole:t,accessToken:s,onCreateSuccess:i}),(0,h.jsx)(t5,{columns:f,data:a||[],renderSubComponent:()=>(0,h.jsx)(h.Fragment,{}),getRowCanExpand:()=>!1,isLoading:r,noDataMessage:"No MCP Servers found"}),(0,h.jsx)(nL,{isModalOpen:d,title:"Delete MCP Server",confirmDelete:_,cancelDelete:b})]}),{})}),(0,h.jsx)(e6.Z,{className:"h-full",children:(0,h.jsx)(nE,{})})]})]})}):(0,h.jsx)("div",{className:"p-6 text-center text-gray-500",children:"Missing required authentication parameters."})},nM=t(21770);let nD=e=>{let{needsAuth:s,authValue:t}=e;return!s||s&&t?(0,h.jsx)(l_.Z,{title:"Authentication",color:"green",className:"mb-4",children:"This tool does not require authentication or has authentication added."}):s&&!t?(0,h.jsx)(l_.Z,{title:"Authentication required",color:"yellow",className:"mb-4",children:"Please provide authentication details if this tool call requires auth."}):null},nF=[{accessorKey:"mcp_info.server_name",header:"Provider",cell:e=>{let{row:s}=e,t=s.original.mcp_info.server_name,l=s.original.mcp_info.logo_url;return(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[l&&(0,h.jsx)("img",{src:l,alt:"".concat(t," logo"),className:"h-5 w-5 object-contain"}),(0,h.jsx)("span",{className:"font-medium",children:t})]})}},{accessorKey:"name",header:"Tool Name",cell:e=>{let{row:s}=e,t=s.getValue("name");return(0,h.jsx)("div",{children:(0,h.jsx)("span",{className:"font-mono text-sm",children:t})})}},{accessorKey:"description",header:"Description",cell:e=>{let{row:s}=e,t=s.getValue("description");return(0,h.jsx)("div",{className:"max-w-md",children:(0,h.jsx)("span",{className:"text-sm text-gray-700",children:t})})}},{id:"actions",header:"Actions",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("div",{className:"flex items-center space-x-2",children:(0,h.jsx)(P.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>{"function"==typeof s.original.onToolSelect&&s.original.onToolSelect(t)},children:"Test Tool"})})}}];function nR(e){let{tool:s,needsAuth:t,authValue:l,onSubmit:a,isLoading:r,result:n,error:i,onClose:o}=e,[c,d]=x.useState({}),m=x.useMemo(()=>"string"==typeof s.inputSchema?{type:"object",properties:{input:{type:"string",description:"Input for this tool"}},required:["input"]}:s.inputSchema,[s.inputSchema]),u=(e,s)=>{d(t=>({...t,[e]:s}))};return(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow-lg border p-6 max-w-4xl w-full",children:[(0,h.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("h2",{className:"text-xl font-bold",children:["Test Tool: ",(0,h.jsx)("span",{className:"font-mono",children:s.name})]}),(0,h.jsx)("p",{className:"text-gray-600",children:s.description}),(0,h.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Provider: ",s.mcp_info.server_name]})]}),(0,h.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8},children:(0,h.jsx)(nD,{needsAuth:t,authValue:l})}),(0,h.jsx)("button",{onClick:o,className:"p-1 rounded-full hover:bg-gray-200",children:(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,h.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,h.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,h.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,h.jsx)("h3",{className:"font-medium mb-4",children:"Input Parameters"}),(0,h.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a(c)},children:["string"==typeof s.inputSchema?(0,h.jsxs)("div",{className:"mb-4",children:[(0,h.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"This tool uses a dynamic input schema."}),(0,h.jsxs)("div",{className:"mb-4",children:[(0,h.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Input ",(0,h.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,h.jsx)("input",{type:"text",value:c.input||"",onChange:e=>u("input",e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}):void 0===m.properties?(0,h.jsx)("p",{className:"text-xs",children:"None"}):Object.entries(m.properties).map(e=>{var s,t,l;let[a,r]=e;return(0,h.jsxs)("div",{className:"mb-4",children:[(0,h.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a," ",(null===(s=m.required)||void 0===s?void 0:s.includes(a))&&(0,h.jsx)("span",{className:"text-red-500",children:"*"})]}),r.description&&(0,h.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:r.description}),"string"===r.type&&(0,h.jsx)("input",{type:"text",value:c[a]||"",onChange:e=>u(a,e.target.value),required:null===(t=m.required)||void 0===t?void 0:t.includes(a),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),"number"===r.type&&(0,h.jsx)("input",{type:"number",value:c[a]||"",onChange:e=>u(a,parseFloat(e.target.value)),required:null===(l=m.required)||void 0===l?void 0:l.includes(a),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),"boolean"===r.type&&(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("input",{type:"checkbox",checked:c[a]||!1,onChange:e=>u(a,e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,h.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Enable"})]})]},a)}),(0,h.jsx)("div",{className:"mt-6",children:(0,h.jsx)(P.Z,{type:"submit",disabled:r,className:"w-full px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white",children:r?"Calling...":"Call Tool"})})]})]}),(0,h.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg overflow-auto max-h-[500px]",children:[(0,h.jsx)("h3",{className:"font-medium mb-4",children:"Result"}),r&&(0,h.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,h.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-700"})}),i&&(0,h.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-md",children:[(0,h.jsx)("p",{className:"font-medium",children:"Error"}),(0,h.jsx)("pre",{className:"mt-2 text-xs overflow-auto whitespace-pre-wrap",children:i.message})]}),n&&!r&&!i&&(0,h.jsxs)("div",{children:[n.map((e,s)=>(0,h.jsxs)("div",{className:"mb-4",children:["text"===e.type&&(0,h.jsx)("div",{className:"bg-white border p-3 rounded-md",children:(0,h.jsx)("p",{className:"whitespace-pre-wrap text-sm",children:e.text})}),"image"===e.type&&e.url&&(0,h.jsx)("div",{className:"bg-white border p-3 rounded-md",children:(0,h.jsx)("img",{src:e.url,alt:"Tool result",className:"max-w-full h-auto rounded"})}),"embedded_resource"===e.type&&(0,h.jsxs)("div",{className:"bg-white border p-3 rounded-md",children:[(0,h.jsx)("p",{className:"text-sm font-medium",children:"Embedded Resource"}),(0,h.jsxs)("p",{className:"text-xs text-gray-500",children:["Type: ",e.resource_type]}),e.url&&(0,h.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"View Resource"})]})]},s)),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsxs)("details",{className:"text-xs",children:[(0,h.jsx)("summary",{className:"cursor-pointer text-gray-500 hover:text-gray-700",children:"Raw JSON Response"}),(0,h.jsx)("pre",{className:"mt-2 bg-gray-100 p-2 rounded-md overflow-auto max-h-[300px]",children:JSON.stringify(n,null,2)})]})})]}),!n&&!r&&!i&&(0,h.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,h.jsx)("p",{children:"The result will appear here after you call the tool."})})]})]})]})}let nz=e=>{let s,{visible:t,onOk:l,onCancel:a,authType:r}=e,[n]=R.Z.useForm();if(r===na.API_KEY||r===na.BEARER_TOKEN){let e=r===na.API_KEY?"API Key":"Bearer Token";s=(0,h.jsx)(R.Z.Item,{name:"authValue",label:e,rules:[{required:!0,message:"Please input your ".concat(e)}],children:(0,h.jsx)(K.default.Password,{})})}else r===na.BASIC&&(s=(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.Z.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please input your username"}],children:(0,h.jsx)(K.default,{})}),(0,h.jsx)(R.Z.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please input your password"}],children:(0,h.jsx)(K.default.Password,{})})]}));return(0,h.jsx)(q.Z,{open:t,title:"Authentication",onOk:()=>{n.validateFields().then(e=>{r===na.BASIC?l("".concat(e.username.trim(),":").concat(e.password.trim())):l(e.authValue.trim())})},onCancel:a,destroyOnClose:!0,children:(0,h.jsx)(R.Z,{form:n,layout:"vertical",children:s})})},nq=e=>{let{authType:s,onAuthSubmit:t}=e,[l,a]=(0,x.useState)(!1);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(P.Z,{onClick:()=>a(!0),children:"Add Auth"}),(0,h.jsx)(nz,{visible:l,onOk:e=>{t(e),a(!1)},onCancel:()=>a(!1),authType:s})]})};function nU(e){let{columns:s,data:t,isLoading:l}=e;return(0,h.jsx)(t5,{columns:s,data:t,isLoading:l,renderSubComponent:()=>(0,h.jsx)("div",{}),getRowCanExpand:()=>!1,loadingMessage:"\uD83D\uDE85 Loading tools...",noDataMessage:"No tools found"})}var nV=e=>{let{serverId:s,accessToken:t,auth_type:l,userRole:a,userID:r}=e,[n,i]=(0,x.useState)(""),[o,c]=(0,x.useState)(""),[d,m]=(0,x.useState)(null),[u,p]=(0,x.useState)(null),[g,j]=(0,x.useState)(null),{data:f,isLoading:v,error:_}=(0,sp.a)({queryKey:["mcpTools"],queryFn:()=>{if(!t)throw Error("Access Token required");return(0,y.lU)(t,s)},enabled:!!t}),{mutate:b,isPending:N}=(0,nM.D)({mutationFn:e=>{if(!t)throw Error("Access Token required");return(0,y.tB)(t,e.tool.name,e.arguments,e.authValue)},onSuccess:e=>{p(e),j(null)},onError:e=>{j(e),p(null)}}),Z=x.useMemo(()=>f?(f.tools||[]).map(e=>({...e,onToolSelect:e=>{m(e),p(null),j(null)}})):[],[f]),w=(null==f?void 0:f.error)?(0,h.jsxs)("div",{className:"p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50",children:[(0,h.jsxs)("p",{className:"font-medium",children:["Error: ",f.message]}),"server_not_found"===f.error&&(0,h.jsx)("p",{className:"mt-2",children:"The specified server could not be found. Please check the server ID and try again."}),"server_error"===f.error&&(0,h.jsx)("p",{className:"mt-2",children:"There was an error connecting to the server. Please try again later or contact support if the issue persists."}),"unexpected_error"===f.error&&(0,h.jsx)("p",{className:"mt-2",children:"An unexpected error occurred. Please try again later or contact support if the issue persists."})]}):null,k=v||(null==f?void 0:f.error)||Z&&0!==Z.length?null:(0,h.jsxs)("div",{className:"p-4 mb-4 text-sm text-gray-800 rounded-lg bg-gray-50",children:[(0,h.jsx)("p",{className:"font-medium",children:"No tools available"}),(0,h.jsx)("p",{className:"mt-2",children:"No tools were found for this server. This could be because:"}),(0,h.jsxs)("ul",{className:"list-disc list-inside mt-2",children:[(0,h.jsx)("li",{children:"The server has not registered any tools"}),(0,h.jsx)("li",{children:"There was an error connecting to the server"}),(0,h.jsx)("li",{children:"The server is still initializing"})]})]});return(0,h.jsxs)("div",{className:"space-y-4",children:[w,k,(0,h.jsx)(nU,{columns:nF,data:Z,isLoading:v}),d&&(0,h.jsx)(nR,{tool:d,needsAuth:no(l),authValue:o,onSubmit:e=>{b({tool:d,arguments:e,authValue:o})},result:u,error:g,isLoading:N,onClose:()=>m(null)}),no(l)&&(0,h.jsx)(nq,{authType:l,onAuthSubmit:e=>c(e)})]})},nK=e=>{let{tagId:s,onClose:t,accessToken:l,is_admin:a,editTag:r}=e,[n]=R.Z.useForm(),[i,o]=(0,x.useState)(null),[c,d]=(0,x.useState)(r),[m,u]=(0,x.useState)([]),p=async()=>{if(l)try{let e=(await (0,y.mC)(l,[s]))[s];e&&(o(e),r&&n.setFieldsValue({name:e.name,description:e.description,models:e.models}))}catch(e){console.error("Error fetching tag details:",e),z.ZP.error("Error fetching tag details: "+e)}};(0,x.useEffect)(()=>{p()},[s,l]),(0,x.useEffect)(()=>{l&&eW("dummy-user","Admin",l,u)},[l]);let g=async e=>{if(l)try{await (0,y.n9)(l,{name:e.name,description:e.description,models:e.models}),z.ZP.success("Tag updated successfully"),d(!1),p()}catch(e){console.error("Error updating tag:",e),z.ZP.error("Error updating tag: "+e)}};return i?(0,h.jsxs)("div",{className:"p-4",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(P.Z,{onClick:t,className:"mb-4",children:"← Back to Tags"}),(0,h.jsxs)(M.Z,{children:["Tag Name: ",i.name]}),(0,h.jsx)(O.Z,{className:"text-gray-500",children:i.description||"No description"})]}),a&&!c&&(0,h.jsx)(P.Z,{onClick:()=>d(!0),children:"Edit Tag"})]}),c?(0,h.jsx)(eo.Z,{children:(0,h.jsxs)(R.Z,{form:n,onFinish:g,layout:"vertical",initialValues:i,children:[(0,h.jsx)(R.Z.Item,{label:"Tag Name",name:"name",rules:[{required:!0,message:"Please input a tag name"}],children:(0,h.jsx)(K.default,{})}),(0,h.jsx)(R.Z.Item,{label:"Description",name:"description",children:(0,h.jsx)(K.default.TextArea,{rows:4})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Allowed LLMs"," ",(0,h.jsx)(X.Z,{title:"Select which LLMs are allowed to process this type of data",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"models",children:(0,h.jsx)(F.default,{mode:"multiple",placeholder:"Select LLMs",children:m.map(e=>(0,h.jsx)(F.default.Option,{value:e,children:J(e)},e))})}),(0,h.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,h.jsx)(P.Z,{onClick:()=>d(!1),children:"Cancel"}),(0,h.jsx)(P.Z,{type:"submit",children:"Save Changes"})]})]})}):(0,h.jsx)("div",{className:"space-y-6",children:(0,h.jsxs)(eo.Z,{children:[(0,h.jsx)(M.Z,{children:"Tag Details"}),(0,h.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Name"}),(0,h.jsx)(O.Z,{children:i.name})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Description"}),(0,h.jsx)(O.Z,{children:i.description||"-"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Allowed LLMs"}),(0,h.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:0===i.models.length?(0,h.jsx)(e1.Z,{color:"red",children:"All Models"}):i.models.map(e=>{var s;return(0,h.jsx)(e1.Z,{color:"blue",children:(0,h.jsx)(X.Z,{title:"ID: ".concat(e),children:(null===(s=i.model_info)||void 0===s?void 0:s[e])||e})},e)})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Created"}),(0,h.jsx)(O.Z,{children:i.created_at?new Date(i.created_at).toLocaleString():"-"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)(O.Z,{className:"font-medium",children:"Last Updated"}),(0,h.jsx)(O.Z,{children:i.updated_at?new Date(i.updated_at).toLocaleString():"-"})]})]})]})})]}):(0,h.jsx)("div",{children:"Loading..."})},nB=e=>{let{data:s,onEdit:t,onDelete:l,onSelectTag:a}=e,[r,n]=x.useState([{id:"created_at",desc:!0}]),i=[{header:"Tag Name",accessorKey:"name",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("div",{className:"overflow-hidden",children:(0,h.jsx)(X.Z,{title:t.name,children:(0,h.jsx)(P.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5",onClick:()=>a(t.name),children:t.name})})})}},{header:"Description",accessorKey:"description",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)(X.Z,{title:t.description,children:(0,h.jsx)("span",{className:"text-xs",children:t.description||"-"})})}},{header:"Allowed LLMs",accessorKey:"models",cell:e=>{var s,t;let{row:l}=e,a=l.original;return(0,h.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(null==a?void 0:null===(s=a.models)||void 0===s?void 0:s.length)===0?(0,h.jsx)(e1.Z,{size:"xs",className:"mb-1",color:"red",children:"All Models"}):null==a?void 0:null===(t=a.models)||void 0===t?void 0:t.map(e=>{var s;return(0,h.jsx)(e1.Z,{size:"xs",className:"mb-1",color:"blue",children:(0,h.jsx)(X.Z,{title:"ID: ".concat(e),children:(0,h.jsx)(O.Z,{children:(null===(s=a.model_info)||void 0===s?void 0:s[e])||e})})},e)})})}},{header:"Created",accessorKey:"created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("span",{className:"text-xs",children:new Date(t.created_at).toLocaleDateString()})}},{id:"actions",header:"",cell:e=>{let{row:s}=e,a=s.original;return(0,h.jsxs)("div",{className:"flex space-x-2",children:[(0,h.jsx)(sb.Z,{icon:sH.Z,size:"sm",onClick:()=>t(a),className:"cursor-pointer"}),(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>l(a.name),className:"cursor-pointer"})]})}}],o=(0,s_.b7)({data:s,columns:i,state:{sorting:r},onSortingChange:n,getCoreRowModel:(0,sy.sC)(),getSortedRowModel:(0,sy.tj)(),enableSorting:!0});return(0,h.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsxs)(sN.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,h.jsx)(sk.Z,{children:o.getHeaderGroups().map(e=>(0,h.jsx)(sC.Z,{children:e.headers.map(e=>(0,h.jsx)(sS.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,h.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,h.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,s_.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,h.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,h.jsx)(sA.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,h.jsx)(sI.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,h.jsx)(sT.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,h.jsx)(sZ.Z,{children:o.getRowModel().rows.length>0?o.getRowModel().rows.map(e=>(0,h.jsx)(sC.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,h.jsx)(sw.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,s_.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:i.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:"No tags found"})})})})})]})})})},nH=e=>{let{accessToken:s,userID:t,userRole:l}=e,[a,r]=(0,x.useState)([]),[n,i]=(0,x.useState)(!1),[o,c]=(0,x.useState)(null),[d,m]=(0,x.useState)(!1),[u,p]=(0,x.useState)(!1),[g,j]=(0,x.useState)(null),[f,v]=(0,x.useState)(""),[_]=R.Z.useForm(),[b,N]=(0,x.useState)([]),Z=async()=>{if(s)try{let e=await (0,y.UM)(s);console.log("List tags response:",e),r(Object.values(e))}catch(e){console.error("Error fetching tags:",e),z.ZP.error("Error fetching tags: "+e)}},w=async e=>{if(s)try{await (0,y.mY)(s,{name:e.tag_name,description:e.description,models:e.allowed_llms}),z.ZP.success("Tag created successfully"),i(!1),_.resetFields(),Z()}catch(e){console.error("Error creating tag:",e),z.ZP.error("Error creating tag: "+e)}},k=async e=>{j(e),p(!0)},S=async()=>{if(s&&g){try{await (0,y.fE)(s,g),z.ZP.success("Tag deleted successfully"),Z()}catch(e){console.error("Error deleting tag:",e),z.ZP.error("Error deleting tag: "+e)}p(!1),j(null)}};return(0,x.useEffect)(()=>{t&&l&&s&&(async()=>{try{let e=await (0,y.AZ)(s,t,l);e&&e.data&&N(e.data)}catch(e){console.error("Error fetching models:",e),z.ZP.error("Error fetching models: "+e)}})()},[s,t,l]),(0,x.useEffect)(()=>{Z()},[s]),(0,h.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:o?(0,h.jsx)(nK,{tagId:o,onClose:()=>{c(null),m(!1)},accessToken:s,is_admin:"Admin"===l,editTag:d}):(0,h.jsxs)("div",{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,h.jsxs)("div",{className:"flex justify-between mt-2 w-full items-center mb-4",children:[(0,h.jsx)("h1",{children:"Tag Management"}),(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[f&&(0,h.jsxs)(O.Z,{children:["Last Refreshed: ",f]}),(0,h.jsx)(sb.Z,{icon:e7.Z,variant:"shadow",size:"xs",className:"self-center cursor-pointer",onClick:()=>{Z(),v(new Date().toLocaleString())}})]})]}),(0,h.jsxs)(O.Z,{className:"mb-4",children:["Click on a tag name to view and edit its details.",(0,h.jsxs)("p",{children:["You can use tags to restrict the usage of certain LLMs based on tags passed in the request. Read more about tag routing ",(0,h.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/tag_routing",target:"_blank",rel:"noopener noreferrer",children:"here"}),"."]})]}),(0,h.jsx)(P.Z,{className:"mb-4",onClick:()=>i(!0),children:"+ Create New Tag"}),(0,h.jsx)(I.Z,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)(nB,{data:a,onEdit:e=>{c(e.name),m(!0)},onDelete:k,onSelectTag:c})})}),(0,h.jsx)(q.Z,{title:"Create New Tag",visible:n,width:800,footer:null,onCancel:()=>{i(!1),_.resetFields()},children:(0,h.jsxs)(R.Z,{form:_,onFinish:w,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsx)(R.Z.Item,{label:"Tag Name",name:"tag_name",rules:[{required:!0,message:"Please input a tag name"}],children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"Description",name:"description",children:(0,h.jsx)(K.default.TextArea,{rows:4})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Allowed Models"," ",(0,h.jsx)(X.Z,{title:"Select which LLMs are allowed to process requests from this tag",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_llms",children:(0,h.jsx)(F.default,{mode:"multiple",placeholder:"Select LLMs",children:b.map(e=>(0,h.jsx)(F.default.Option,{value:e.model_info.id,children:(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{children:e.model_name}),(0,h.jsxs)("span",{className:"text-gray-400 ml-2",children:["(",e.model_info.id,")"]})]})},e.model_info.id))})}),(0,h.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,h.jsx)(P.Z,{type:"submit",children:"Create Tag"})})]})}),u&&(0,h.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,h.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,h.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,h.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,h.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,h.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,h.jsx)("div",{className:"sm:flex sm:items-start",children:(0,h.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,h.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Tag"}),(0,h.jsx)("div",{className:"mt-2",children:(0,h.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this tag?"})})]})})}),(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)(P.Z,{onClick:S,color:"red",className:"ml-2",children:"Delete"}),(0,h.jsx)(P.Z,{onClick:()=>{p(!1),j(null)},children:"Cancel"})]})]})]})})]})})},nG=e=>{let{data:s,onDelete:t}=e,[l,a]=x.useState([{id:"created_at",desc:!0}]),r=[{header:"Vector Store ID",accessorKey:"vector_store_id",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("div",{className:"overflow-hidden",children:(0,h.jsx)(X.Z,{title:t.vector_store_id,children:(0,h.jsx)("span",{className:"font-mono text-blue-500 text-xs font-normal",children:t.vector_store_id})})})}},{header:"Name",accessorKey:"vector_store_name",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)(X.Z,{title:t.vector_store_name,children:(0,h.jsx)("span",{className:"text-xs",children:t.vector_store_name||"-"})})}},{header:"Description",accessorKey:"vector_store_description",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)(X.Z,{title:t.vector_store_description,children:(0,h.jsx)("span",{className:"text-xs",children:t.vector_store_description||"-"})})}},{header:"Provider",accessorKey:"custom_llm_provider",cell:e=>{let{row:s}=e,{displayName:t,logo:l}=sq(s.original.custom_llm_provider);return(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[l&&(0,h.jsx)("img",{src:l,alt:t,className:"h-4 w-4"}),(0,h.jsx)("span",{className:"text-xs",children:t})]})}},{header:"Created",accessorKey:"created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,h.jsx)("span",{className:"text-xs",children:new Date(t.created_at).toLocaleDateString()})}},{id:"actions",header:"",cell:e=>{let{row:s}=e,l=s.original;return(0,h.jsx)("div",{className:"flex space-x-2",children:(0,h.jsx)(sb.Z,{icon:em.Z,size:"sm",onClick:()=>t(l.vector_store_id),className:"cursor-pointer"})})}}],n=(0,s_.b7)({data:s,columns:r,state:{sorting:l},onSortingChange:a,getCoreRowModel:(0,sy.sC)(),getSortedRowModel:(0,sy.tj)(),enableSorting:!0});return(0,h.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsxs)(sN.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,h.jsx)(sk.Z,{children:n.getHeaderGroups().map(e=>(0,h.jsx)(sC.Z,{children:e.headers.map(e=>(0,h.jsx)(sS.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,h.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,h.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,s_.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,h.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,h.jsx)(sA.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,h.jsx)(sI.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,h.jsx)(sT.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,h.jsx)(sZ.Z,{children:n.getRowModel().rows.length>0?n.getRowModel().rows.map(e=>(0,h.jsx)(sC.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,h.jsx)(sw.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,s_.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,h.jsx)(sC.Z,{children:(0,h.jsx)(sw.Z,{colSpan:r.length,className:"h-8 text-center",children:(0,h.jsx)("div",{className:"text-center text-gray-500",children:(0,h.jsx)("p",{children:"No vector stores found"})})})})})]})})})},nJ=e=>{let{isVisible:s,onCancel:t,onSuccess:l,accessToken:a,credentials:r}=e,[n]=R.Z.useForm(),[i,o]=(0,x.useState)("{}"),d=async e=>{if(a)try{let s={};try{s=i.trim()?JSON.parse(i):{}}catch(e){z.ZP.error("Invalid JSON in metadata field");return}await (0,y.Mx)(a,{vector_store_id:e.vector_store_id,custom_llm_provider:e.custom_llm_provider,vector_store_name:e.vector_store_name,vector_store_description:e.vector_store_description,vector_store_metadata:s,litellm_credential_name:e.litellm_credential_name}),z.ZP.success("Vector store created successfully"),n.resetFields(),o("{}"),l()}catch(e){console.error("Error creating vector store:",e),z.ZP.error("Error creating vector store: "+e)}},m=()=>{n.resetFields(),o("{}"),t()};return(0,h.jsx)(q.Z,{title:"Create New Vector Store",visible:s,width:800,footer:null,onCancel:m,children:(0,h.jsxs)(R.Z,{form:n,onFinish:d,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Provider"," ",(0,h.jsx)(X.Z,{title:"Select the provider for this vector store",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"custom_llm_provider",rules:[{required:!0,message:"Please select a provider"}],initialValue:"bedrock",children:(0,h.jsx)(F.default,{children:Object.entries(c).map(e=>{let[s,t]=e;return"Bedrock"===s?(0,h.jsx)(F.default.Option,{value:sF[s],children:(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)("img",{src:sz[t],alt:"".concat(s," logo"),className:"w-5 h-5",onError:e=>{let s=e.target,l=s.parentElement;if(l){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=t.charAt(0),l.replaceChild(e,s)}}}),(0,h.jsx)("span",{children:t})]})},s):null})})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Vector Store ID"," ",(0,h.jsx)(X.Z,{title:"Enter the vector store ID from your api provider",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"vector_store_id",rules:[{required:!0,message:"Please input the vector store ID from your api provider"}],children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Vector Store Name"," ",(0,h.jsx)(X.Z,{title:"Custom name you want to give to the vector store, this name will be rendered on the LiteLLM UI",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"vector_store_name",children:(0,h.jsx)(A.Z,{})}),(0,h.jsx)(R.Z.Item,{label:"Description",name:"vector_store_description",children:(0,h.jsx)(K.default.TextArea,{rows:4})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Existing Credentials"," ",(0,h.jsx)(X.Z,{title:"Optionally select API provider credentials for this vector store eg. Bedrock API KEY",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),name:"litellm_credential_name",children:(0,h.jsx)(F.default,{showSearch:!0,placeholder:"Select or search for existing credentials",optionFilterProp:"children",filterOption:(e,s)=>{var t;return(null!==(t=null==s?void 0:s.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},options:[{value:null,label:"None"},...r.map(e=>({value:e.credential_name,label:e.credential_name}))],allowClear:!0})}),(0,h.jsx)(R.Z.Item,{label:(0,h.jsxs)("span",{children:["Metadata"," ",(0,h.jsx)(X.Z,{title:"JSON metadata for the vector store (optional)",children:(0,h.jsx)($.Z,{style:{marginLeft:"4px"}})})]}),children:(0,h.jsx)(K.default.TextArea,{rows:4,value:i,onChange:e=>o(e.target.value),placeholder:'{"key": "value"}'})}),(0,h.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,h.jsx)(P.Z,{onClick:m,variant:"secondary",children:"Cancel"}),(0,h.jsx)(P.Z,{variant:"primary",type:"submit",children:"Create"})]})]})})},nY=e=>{let{isVisible:s,onCancel:t,onConfirm:l}=e;return(0,h.jsxs)(q.Z,{title:"Delete Vector Store",visible:s,footer:null,onCancel:t,children:[(0,h.jsx)("p",{children:"Are you sure you want to delete this vector store? This action cannot be undone."}),(0,h.jsxs)("div",{className:"px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)(P.Z,{onClick:l,color:"red",className:"ml-2",children:"Delete"}),(0,h.jsx)(P.Z,{onClick:t,variant:"primary",children:"Cancel"})]})]})},nW=e=>{let{accessToken:s,userID:t,userRole:l}=e,[a,r]=(0,x.useState)([]),[n,i]=(0,x.useState)(!1),[o,c]=(0,x.useState)(!1),[d,m]=(0,x.useState)(null),[u,p]=(0,x.useState)(""),[g,j]=(0,x.useState)([]),f=async()=>{if(s)try{let e=await (0,y.Ou)(s);console.log("List vector stores response:",e),r(e.data||[])}catch(e){console.error("Error fetching vector stores:",e),z.ZP.error("Error fetching vector stores: "+e)}},v=async()=>{if(s)try{let e=await (0,y.N3)(s);console.log("List credentials response:",e),j(e.credentials||[])}catch(e){console.error("Error fetching credentials:",e),z.ZP.error("Error fetching credentials: "+e)}},_=async e=>{m(e),c(!0)},b=async()=>{if(s&&d){try{await (0,y.Pv)(s,d),z.ZP.success("Vector store deleted successfully"),f()}catch(e){console.error("Error deleting vector store:",e),z.ZP.error("Error deleting vector store: "+e)}c(!1),m(null)}};return(0,x.useEffect)(()=>{f(),v()},[s]),(0,h.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,h.jsxs)("div",{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,h.jsxs)("div",{className:"flex justify-between mt-2 w-full items-center mb-4",children:[(0,h.jsx)("h1",{children:"Vector Store Management"}),(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[u&&(0,h.jsxs)(O.Z,{children:["Last Refreshed: ",u]}),(0,h.jsx)(sb.Z,{icon:e7.Z,variant:"shadow",size:"xs",className:"self-center cursor-pointer",onClick:()=>{f(),v(),p(new Date().toLocaleString())}})]})]}),(0,h.jsx)(O.Z,{className:"mb-4",children:(0,h.jsx)("p",{children:"You can use vector stores to store and retrieve LLM embeddings. Currently, we support Amazon Bedrock vector stores."})}),(0,h.jsx)(P.Z,{className:"mb-4",onClick:()=>i(!0),children:"+ Create Vector Store"}),(0,h.jsx)(I.Z,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:(0,h.jsx)(C.Z,{numColSpan:1,children:(0,h.jsx)(nG,{data:a,onDelete:_})})}),(0,h.jsx)(nJ,{isVisible:n,onCancel:()=>i(!1),onSuccess:()=>{i(!1),f()},accessToken:s,credentials:g}),(0,h.jsx)(nY,{isVisible:o,onCancel:()=>c(!1),onConfirm:b})]})})},n$=t(49096),nX=t(53335);let{cva:nQ,cx:n0,compose:n1}=(0,n$.ZD)({hooks:{onComplete:e=>(0,nX.m6)(e)}});function n2(e){var s,t;let{className:l="",...a}=e,r=(0,x.useId)();return s=()=>{let e=document.getAnimations().filter(e=>e instanceof CSSAnimation&&"spin"===e.animationName),s=e.find(e=>{var s;return(null===(s=e.effect.target)||void 0===s?void 0:s.getAttribute("data-spinner-id"))===r}),t=e.find(e=>{var s;return e.effect instanceof KeyframeEffect&&(null===(s=e.effect.target)||void 0===s?void 0:s.getAttribute("data-spinner-id"))!==r});s&&t&&(s.currentTime=t.currentTime)},t=[r],(0,x.useLayoutEffect)(s,t),(0,h.jsxs)("svg",{"data-spinner-id":r,className:n0("pointer-events-none size-12 animate-spin text-current",l),fill:"none",viewBox:"0 0 24 24",...a,children:[(0,h.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,h.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}let n4=new j.S;function n5(){return(0,h.jsxs)("div",{className:n0("h-screen","flex items-center justify-center gap-4"),children:[(0,h.jsx)("div",{className:"text-lg font-medium py-2 pr-4 border-r border-r-gray-200",children:"\uD83D\uDE85 LiteLLM"}),(0,h.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,h.jsx)(n2,{className:"size-4"}),(0,h.jsx)("span",{className:"text-gray-600 text-sm",children:"Loading..."})]})]})}function n6(){let[e,s]=(0,x.useState)(""),[t,l]=(0,x.useState)(!1),[a,r]=(0,x.useState)(!1),[n,i]=(0,x.useState)(null),[o,c]=(0,x.useState)(null),[d,m]=(0,x.useState)([]),[u,j]=(0,x.useState)([]),[v,_]=(0,x.useState)([]),[b,N]=(0,x.useState)({PROXY_BASE_URL:"",PROXY_LOGOUT_URL:""}),[Z,w]=(0,x.useState)(!0),C=(0,p.useSearchParams)(),[I,P]=(0,x.useState)({data:[]}),[A,T]=(0,x.useState)(null),[E,L]=(0,x.useState)(!1),[O,M]=(0,x.useState)(!0),[D,F]=(0,x.useState)(null),R=C.get("invitation_id"),[z,q]=(0,x.useState)(()=>C.get("page")||"api-keys"),[U,V]=(0,x.useState)(null),K=e=>{m(s=>s?[...s,e]:[e]),L(()=>!E)},B=!1===O&&null===A&&null===R;return((0,x.useEffect)(()=>{let e=function(e){let s=document.cookie.split("; ").find(s=>s.startsWith(e+"="));return s?s.split("=")[1]:null}("token");(0,y.MO)().then(s=>{T(e),M(!1)})},[]),(0,x.useEffect)(()=>{B&&(window.location.href=(y.H2||"")+"/sso/key/generate")},[B]),(0,x.useEffect)(()=>{if(!A)return;let e=(0,g.o)(A);if(e){if(V(e.key),r(e.disabled_non_admin_personal_key_creation),e.user_role){let t=function(e){if(!e)return"Undefined Role";switch(e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"org_admin":return"Org Admin";case"internal_user":return"Internal User";case"internal_user_viewer":case"internal_viewer":return"Internal Viewer";case"app_user":return"App User";default:return"Unknown Role"}}(e.user_role);s(t),"Admin Viewer"==t&&q("usage")}e.user_email&&i(e.user_email),e.login_method&&w("username_password"==e.login_method),e.premium_user&&l(e.premium_user),e.auth_header_name&&(0,y.K8)(e.auth_header_name),e.user_id&&F(e.user_id)}},[A]),(0,x.useEffect)(()=>{U&&D&&e&&eW(D,e,U,_),U&&D&&e&&S(U,D,e,null,c),U&&lf(U,j)},[U,D,e]),O||B)?(0,h.jsx)(n5,{}):(0,h.jsx)(x.Suspense,{fallback:(0,h.jsx)(n5,{}),children:(0,h.jsx)(f.aH,{client:n4,children:R?(0,h.jsx)(sM,{userID:D,userRole:e,premiumUser:t,teams:o,keys:d,setUserRole:s,userEmail:n,setUserEmail:i,setTeams:c,setKeys:m,organizations:u,addKey:K,createClicked:E}):(0,h.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,h.jsx)(k,{userID:D,userRole:e,premiumUser:t,userEmail:n,setProxySettings:N,proxySettings:b,accessToken:U}),(0,h.jsxs)("div",{className:"flex flex-1 overflow-auto",children:[(0,h.jsx)("div",{className:"mt-8",children:(0,h.jsx)(rg,{accessToken:U,setPage:e=>{let s=new URLSearchParams(C);s.set("page",e),window.history.pushState(null,"","?".concat(s.toString())),q(e)},userRole:e,defaultSelectedKey:z})}),"api-keys"==z?(0,h.jsx)(sM,{userID:D,userRole:e,premiumUser:t,teams:o,keys:d,setUserRole:s,userEmail:n,setUserEmail:i,setTeams:c,setKeys:m,organizations:u,addKey:K,createClicked:E}):"models"==z?(0,h.jsx)(le,{userID:D,userRole:e,token:A,keys:d,accessToken:U,modelData:I,setModelData:P,premiumUser:t,teams:o}):"llm-playground"==z?(0,h.jsx)(a5,{userID:D,userRole:e,token:A,accessToken:U,disabledPersonalKeyCreation:a}):"users"==z?(0,h.jsx)(lu,{userID:D,userRole:e,token:A,keys:d,teams:o,accessToken:U,setKeys:m}):"teams"==z?(0,h.jsx)(lg,{teams:o,setTeams:c,searchParams:C,accessToken:U,userID:D,userRole:e,organizations:u,premiumUser:t}):"organizations"==z?(0,h.jsx)(lv,{organizations:u,setOrganizations:j,userModels:v,accessToken:U,userRole:e,premiumUser:t}):"admin-panel"==z?(0,h.jsx)(lA,{setTeams:c,searchParams:C,accessToken:U,userID:D,showSSOBanner:Z,premiumUser:t,proxySettings:b}):"api_ref"==z?(0,h.jsx)(aZ,{proxySettings:b}):"settings"==z?(0,h.jsx)(lq,{userID:D,userRole:e,accessToken:U,premiumUser:t}):"budgets"==z?(0,h.jsx)(l0,{accessToken:U}):"guardrails"==z?(0,h.jsx)(ns,{accessToken:U,userRole:e}):"transform-request"==z?(0,h.jsx)(nt,{accessToken:U}):"general-settings"==z?(0,h.jsx)(lW,{userID:D,userRole:e,accessToken:U,modelData:I}):"model-hub"==z?(0,h.jsx)(au.Z,{accessToken:U,publicPage:!1,premiumUser:t}):"caching"==z?(0,h.jsx)(rC,{userID:D,userRole:e,token:A,accessToken:U,premiumUser:t}):"pass-through-settings"==z?(0,h.jsx)(t3,{userID:D,userRole:e,accessToken:U,modelData:I}):"logs"==z?(0,h.jsx)(ad,{userID:D,userRole:e,token:A,accessToken:U,allTeams:null!=o?o:[],premiumUser:t}):"mcp-servers"==z?(0,h.jsx)(nO,{accessToken:U,userRole:e,userID:D}):"tag-management"==z?(0,h.jsx)(nH,{accessToken:U,userRole:e,userID:D}):"vector-stores"==z?(0,h.jsx)(nW,{accessToken:U,userRole:e,userID:D}):"new_usage"==z?(0,h.jsx)(aN,{userID:D,userRole:e,accessToken:U,teams:null!=o?o:[],premiumUser:t}):(0,h.jsx)(rv,{userID:D,userRole:e,token:A,accessToken:U,keys:d,premiumUser:t})]})]})})})}},3914:function(e,s,t){"use strict";function l(){let e=window.location.hostname,s=["Lax","Strict","None"];["/","/ui"].forEach(t=>{document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=".concat(t,";"),document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=".concat(t,"; domain=").concat(e,";"),s.forEach(s=>{let l="None"===s?" Secure;":"";document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=".concat(t,"; SameSite=").concat(s,";").concat(l),document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=".concat(t,"; domain=").concat(e,"; SameSite=").concat(s,";").concat(l)})}),console.log("After clearing cookies:",document.cookie)}function a(e){let s=document.cookie.split("; ").find(s=>s.startsWith(e+"="));return s?s.split("=")[1]:null}t.d(s,{b:function(){return l},e:function(){return a}})}},function(e){e.O(0,[665,990,402,313,899,403,250,699,971,117,744],function(){return e(e.s=1900)}),_N_E=e.O()}]);