(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,952683,e=>{"use strict";var t=e.i(843476),s=e.i(794357),a=e.i(111672),l=e.i(764205),r=e.i(135214),i=e.i(271645);let n=({setPage:e,defaultSelectedKey:s,sidebarCollapsed:n})=>{let{accessToken:o}=(0,r.default)(),[d,c]=(0,i.useState)(null),[m,u]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{(async()=>{if(!o)return console.log("[SidebarProvider] No access token, skipping UI settings fetch");try{console.log("[SidebarProvider] Fetching UI settings from /get/ui_settings");let e=await (0,l.getUISettings)(o);console.log("[SidebarProvider] UI settings response:",e),e?.values?.enabled_ui_pages_internal_users!==void 0?(console.log("[SidebarProvider] Setting enabled pages:",e.values.enabled_ui_pages_internal_users),c(e.values.enabled_ui_pages_internal_users)):console.log("[SidebarProvider] No enabled_ui_pages_internal_users in response (all pages visible by default)"),e?.values?.enable_projects_ui!==void 0&&u(!!e.values.enable_projects_ui)}catch(e){console.error("[SidebarProvider] Failed to fetch UI settings:",e)}})()},[o]),(0,t.jsx)(a.default,{setPage:e,defaultSelectedKey:s,collapsed:n,enabledPagesInternalUsers:d,enableProjectsUI:m})};var o=e.i(161059),d=e.i(213970),c=e.i(105278),m=e.i(994388),u=e.i(212931),x=e.i(560445),p=e.i(808613),h=e.i(998573),g=e.i(199133),j=e.i(311451),y=e.i(280898),f=e.i(91739),b=e.i(262218),_=e.i(312361),v=e.i(826910),N=e.i(438957),w=e.i(983561),k=e.i(477189),C=e.i(827252),S=e.i(364769),T=e.i(355619),I=e.i(790848),F=e.i(362024),A=e.i(464571),P=e.i(646563),L=e.i(564897);let M={basic:{key:"basic",title:"Basic Information",defaultExpanded:!0,fields:[{name:"name",label:"Display Name",type:"text",required:!0,placeholder:"e.g., Customer Support Agent"},{name:"description",label:"Description",type:"textarea",required:!0,placeholder:"Describe what this agent does...",rows:3},{name:"url",label:"URL",type:"url",required:!1,placeholder:"http://localhost:9999/",tooltip:"Base URL where the agent is hosted (optional)"},{name:"version",label:"Version",type:"text",placeholder:"1.0.0",defaultValue:"1.0.0"},{name:"protocolVersion",label:"Protocol Version",type:"text",placeholder:"1.0",defaultValue:"1.0"}]},skills:{key:"skills",title:"Skills",fields:[{name:"skills",label:"Skills",type:"list",defaultValue:[]}]},capabilities:{key:"capabilities",title:"Capabilities",fields:[{name:"streaming",label:"Streaming",type:"switch",defaultValue:!1},{name:"pushNotifications",label:"Push Notifications",type:"switch"},{name:"stateTransitionHistory",label:"State Transition History",type:"switch"}]},optional:{key:"optional",title:"Optional Settings",fields:[{name:"iconUrl",label:"Icon URL",type:"url",placeholder:"https://example.com/icon.png"},{name:"documentationUrl",label:"Documentation URL",type:"url",placeholder:"https://docs.example.com"},{name:"supportsAuthenticatedExtendedCard",label:"Supports Authenticated Extended Card",type:"switch"}]},litellm:{key:"litellm",title:"LiteLLM Parameters",fields:[{name:"model",label:"Model (Optional)",type:"text"},{name:"make_public",label:"Make Public",type:"switch"}]},cost:{key:"cost",title:"Cost Configuration",fields:[{name:"cost_per_query",label:"Cost Per Query ($)",type:"text",placeholder:"0.0",tooltip:"Fixed cost per query"},{name:"input_cost_per_token",label:"Input Cost Per Token ($)",type:"text",placeholder:"0.000001",tooltip:"Cost per input token"},{name:"output_cost_per_token",label:"Output Cost Per Token ($)",type:"text",placeholder:"0.000002",tooltip:"Cost per output token"}]}},D="Skill ID",E=!0,O="e.g., hello_world",z="Skill Name",R=!0,B="e.g., Returns hello world",q="Description",$=!0,U="What this skill does",V=2,G="Tags (comma-separated)",H=!0,K="e.g., hello world, greeting",W="Examples (comma-separated)",Q="e.g., hi, hello world",Y=(e,t)=>{let s={agent_name:e.agent_name,agent_card_params:{protocolVersion:e.protocolVersion||"1.0",name:e.name||e.agent_name,description:e.description||"",url:e.url||"",version:e.version||"1.0.0",defaultInputModes:t?.agent_card_params?.defaultInputModes||["text"],defaultOutputModes:t?.agent_card_params?.defaultOutputModes||["text"],capabilities:{streaming:!0===e.streaming,...void 0!==e.pushNotifications&&{pushNotifications:e.pushNotifications},...void 0!==e.stateTransitionHistory&&{stateTransitionHistory:e.stateTransitionHistory}},skills:e.skills||[],...e.iconUrl&&{iconUrl:e.iconUrl},...e.documentationUrl&&{documentationUrl:e.documentationUrl},...void 0!==e.supportsAuthenticatedExtendedCard&&{supportsAuthenticatedExtendedCard:e.supportsAuthenticatedExtendedCard}}},a={};return e.model&&(a.model=e.model),void 0!==e.make_public&&(a.make_public=e.make_public),e.cost_per_query&&(a.cost_per_query=parseFloat(e.cost_per_query)),e.input_cost_per_token&&(a.input_cost_per_token=parseFloat(e.input_cost_per_token)),e.output_cost_per_token&&(a.output_cost_per_token=parseFloat(e.output_cost_per_token)),Object.keys(a).length>0&&(s.litellm_params=a),s},J=e=>{let t=e.agent_card_params?.skills?.map(e=>({...e,tags:e.tags,examples:e.examples||[]}))||[];return{agent_name:e.agent_name,name:e.agent_card_params?.name,description:e.agent_card_params?.description,url:e.agent_card_params?.url,version:e.agent_card_params?.version,protocolVersion:e.agent_card_params?.protocolVersion,streaming:e.agent_card_params?.capabilities?.streaming,pushNotifications:e.agent_card_params?.capabilities?.pushNotifications,stateTransitionHistory:e.agent_card_params?.capabilities?.stateTransitionHistory,skills:t,iconUrl:e.agent_card_params?.iconUrl,documentationUrl:e.agent_card_params?.documentationUrl,supportsAuthenticatedExtendedCard:e.agent_card_params?.supportsAuthenticatedExtendedCard,model:e.litellm_params?.model,make_public:e.litellm_params?.make_public,cost_per_query:e.litellm_params?.cost_per_query,input_cost_per_token:e.litellm_params?.input_cost_per_token,output_cost_per_token:e.litellm_params?.output_cost_per_token}},X=()=>(0,t.jsx)(t.Fragment,{children:M.cost.fields.map(e=>(0,t.jsx)(p.Form.Item,{label:e.label,name:e.name,tooltip:e.tooltip,children:(0,t.jsx)(j.Input,{placeholder:e.placeholder,type:"number",step:"0.000001"})},e.name))}),{Panel:Z}=F.Collapse,ee=({showAgentName:e=!0,visiblePanels:s})=>{let a=e=>!s||s.includes(e);return(0,t.jsxs)(t.Fragment,{children:[e&&(0,t.jsx)(p.Form.Item,{label:"Agent Name",name:"agent_name",rules:[{required:!0,message:"Please enter a unique agent name"}],tooltip:"Unique identifier for the agent",children:(0,t.jsx)(j.Input,{placeholder:"e.g., customer-support-agent"})}),(0,t.jsxs)(F.Collapse,{defaultActiveKey:["basic"],style:{marginBottom:16},children:[a(M.basic.key)&&(0,t.jsx)(Z,{header:`${M.basic.title} (Required)`,children:M.basic.fields.map(e=>(0,t.jsx)(p.Form.Item,{label:e.label,name:e.name,rules:e.required?[{required:!0,message:`Please enter ${e.label.toLowerCase()}`}]:void 0,tooltip:e.tooltip,children:"textarea"===e.type?(0,t.jsx)(j.Input.TextArea,{rows:e.rows,placeholder:e.placeholder}):(0,t.jsx)(j.Input,{placeholder:e.placeholder})},e.name))},M.basic.key),a(M.skills.key)&&(0,t.jsx)(Z,{header:`${M.skills.title} (Required)`,children:(0,t.jsx)(p.Form.List,{name:"skills",children:(e,{add:s,remove:a})=>(0,t.jsxs)(t.Fragment,{children:[e.map(e=>(0,t.jsxs)("div",{style:{marginBottom:16,padding:16,border:"1px solid #d9d9d9",borderRadius:4},children:[(0,t.jsx)(p.Form.Item,{...e,label:D,name:[e.name,"id"],rules:[{required:E,message:"Required"}],children:(0,t.jsx)(j.Input,{placeholder:O})}),(0,t.jsx)(p.Form.Item,{...e,label:z,name:[e.name,"name"],rules:[{required:R,message:"Required"}],children:(0,t.jsx)(j.Input,{placeholder:B})}),(0,t.jsx)(p.Form.Item,{...e,label:q,name:[e.name,"description"],rules:[{required:$,message:"Required"}],children:(0,t.jsx)(j.Input.TextArea,{rows:V,placeholder:U})}),(0,t.jsx)(p.Form.Item,{...e,label:G,name:[e.name,"tags"],rules:[{required:H,message:"Required"}],getValueFromEvent:e=>e.target.value.split(",").map(e=>e.trim()),getValueProps:e=>({value:Array.isArray(e)?e.join(", "):e}),children:(0,t.jsx)(j.Input,{placeholder:K})}),(0,t.jsx)(p.Form.Item,{...e,label:W,name:[e.name,"examples"],getValueFromEvent:e=>e.target.value.split(",").map(e=>e.trim()).filter(e=>e),getValueProps:e=>({value:Array.isArray(e)?e.join(", "):""}),children:(0,t.jsx)(j.Input,{placeholder:Q})}),(0,t.jsx)(A.Button,{type:"link",danger:!0,onClick:()=>a(e.name),icon:(0,t.jsx)(L.MinusCircleOutlined,{}),children:"Remove Skill"})]},e.key)),(0,t.jsx)(A.Button,{type:"dashed",onClick:()=>s(),icon:(0,t.jsx)(P.PlusOutlined,{}),style:{width:"100%"},children:"Add Skill"})]})})},M.skills.key),a(M.capabilities.key)&&(0,t.jsx)(Z,{header:M.capabilities.title,children:M.capabilities.fields.map(e=>(0,t.jsx)(p.Form.Item,{label:e.label,name:e.name,valuePropName:"checked",children:(0,t.jsx)(I.Switch,{})},e.name))},M.capabilities.key),a(M.optional.key)&&(0,t.jsx)(Z,{header:M.optional.title,children:M.optional.fields.map(e=>(0,t.jsx)(p.Form.Item,{label:e.label,name:e.name,valuePropName:"switch"===e.type?"checked":void 0,children:"switch"===e.type?(0,t.jsx)(I.Switch,{}):(0,t.jsx)(j.Input,{placeholder:e.placeholder})},e.name))},M.optional.key),a(M.cost.key)&&(0,t.jsx)(Z,{header:M.cost.title,children:(0,t.jsx)(X,{})},M.cost.key),a(M.litellm.key)&&(0,t.jsx)(Z,{header:M.litellm.title,children:M.litellm.fields.map(e=>(0,t.jsx)(p.Form.Item,{label:e.label,name:e.name,valuePropName:"switch"===e.type?"checked":void 0,children:"switch"===e.type?(0,t.jsx)(I.Switch,{}):(0,t.jsx)(j.Input,{placeholder:e.placeholder})},e.name))},M.litellm.key)]})]})},{Panel:et}=F.Collapse,es=(e,t)=>{let s={...t.litellm_params_template||{}};for(let a of t.credential_fields){let t=e[a.key];t&&!1!==a.include_in_litellm_params&&(s[a.key]=t)}if(e.cost_per_query&&(s.cost_per_query=parseFloat(e.cost_per_query)),e.input_cost_per_token&&(s.input_cost_per_token=parseFloat(e.input_cost_per_token)),e.output_cost_per_token&&(s.output_cost_per_token=parseFloat(e.output_cost_per_token)),t.model_template){let a=t.model_template;for(let s of t.credential_fields){let t=`{${s.key}}`;a.includes(t)&&e[s.key]&&(a=a.replace(t,e[s.key]))}s.model=a}return{agent_name:e.agent_name,agent_card_params:{protocolVersion:"1.0",name:e.display_name||e.agent_name,description:e.description||`${t.agent_type_display_name} agent`,url:e.api_base||"",version:"1.0.0",defaultInputModes:["text"],defaultOutputModes:["text"],capabilities:{streaming:!0},skills:[{id:"chat",name:"Chat",description:"General chat capability",tags:["chat","conversation"]}]},litellm_params:s}},ea=({agentTypeInfo:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Form.Item,{label:"Agent Name",name:"agent_name",rules:[{required:!0,message:"Please enter a unique agent name"}],tooltip:"Unique identifier for the agent",children:(0,t.jsx)(j.Input,{placeholder:"e.g., my-langgraph-agent"})}),(0,t.jsx)(p.Form.Item,{label:"Description",name:"description",tooltip:"Brief description of what this agent does",children:(0,t.jsx)(j.Input.TextArea,{rows:2,placeholder:"Describe what this agent does..."})}),e.credential_fields.map(e=>(0,t.jsx)(p.Form.Item,{label:e.label,name:e.key,rules:e.required?[{required:!0,message:`Please enter ${e.label}`}]:void 0,tooltip:e.tooltip,initialValue:e.default_value,children:"password"===e.field_type?(0,t.jsx)(j.Input.Password,{placeholder:e.placeholder||""}):"textarea"===e.field_type?(0,t.jsx)(j.Input.TextArea,{rows:3,placeholder:e.placeholder||""}):"select"===e.field_type&&e.options?(0,t.jsx)(g.Select,{placeholder:e.placeholder||"",children:e.options.map(e=>(0,t.jsx)(g.Select.Option,{value:e,children:e},e))}):(0,t.jsx)(j.Input,{placeholder:e.placeholder||""})},e.key)),(0,t.jsx)(F.Collapse,{style:{marginBottom:16},children:(0,t.jsx)(et,{header:M.cost.title,children:(0,t.jsx)(X,{})},M.cost.key)})]});var el=e.i(75921),er=e.i(390605);let{Step:ei}=y.Steps,en="custom",eo=({visible:e,onClose:s,accessToken:a,onSuccess:n})=>{let o,d,{userId:c,userRole:x}=(0,r.default)(),[I]=p.Form.useForm(),[F,A]=(0,i.useState)(0),[P,L]=(0,i.useState)(!1),[D,E]=(0,i.useState)("a2a"),[O,z]=(0,i.useState)([]),[R,B]=(0,i.useState)(!1),[q,$]=(0,i.useState)("create_new"),[U,V]=(0,i.useState)(""),[G,H]=(0,i.useState)([]),[K,W]=(0,i.useState)([]),[Q,J]=(0,i.useState)(null),[X,Z]=(0,i.useState)(!1),[et,eo]=(0,i.useState)([]),[ed,ec]=(0,i.useState)(!1),[em,eu]=(0,i.useState)(""),[ex,ep]=(0,i.useState)(null),[eh,eg]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{B(!0);try{let e=await (0,l.getAgentCreateMetadata)();z(e)}catch(e){console.error("Error fetching agent metadata:",e)}finally{B(!1)}})()},[]),(0,i.useEffect)(()=>{2===F&&a&&0===K.length&&(async()=>{Z(!0);try{let e=await (0,l.keyListCall)(a,null,null,null,null,null,1,100);W(e?.keys||[])}catch(e){console.error("Error fetching keys:",e)}finally{Z(!1)}})()},[F,a]),(0,i.useEffect)(()=>{if(2!==F||!a||!c||!x)return;let e=!1;return ec(!0),(0,l.modelAvailableCall)(a,c,x).then(t=>{e||eo((t?.data??(Array.isArray(t)?t:[])).map(e=>e.id??e.model_name).filter(Boolean))}).catch(t=>{e||console.error("Error fetching models:",t)}).finally(()=>{e||ec(!1)}),()=>{e=!0}},[F,a,c,x]);let ej=O.find(e=>e.agent_type===D),ey=async()=>{try{if(0===F){await I.validateFields(["agent_name"]);let e=I.getFieldValue("agent_name");e&&!U&&V(`${e}-key`)}A(e=>e+1)}catch{}},ef=async()=>{if(!a)return void h.message.error("No access token available");L(!0);try{await I.validateFields();let e={...I.getFieldsValue(!0)},t=(e=>{if(D===en)return{agent_name:e.agent_name,agent_card_params:{protocolVersion:"1.0",name:e.agent_name,description:e.description||"",url:"",version:"1.0.0",defaultInputModes:["text"],defaultOutputModes:["text"],capabilities:{streaming:!1},skills:[]}};if("a2a"===D)return Y(e);if(ej?.use_a2a_form_fields){let t=Y(e);for(let s of(ej.litellm_params_template&&(t.litellm_params={...t.litellm_params,...ej.litellm_params_template}),ej.credential_fields)){let a=e[s.key];a&&!1!==s.include_in_litellm_params&&(t.litellm_params[s.key]=a)}return t}return ej?es(e,ej):null})(e);if(!t){h.message.error("Failed to build agent data"),L(!1);return}let s=e.allowed_mcp_servers_and_groups,r=e.mcp_tool_permissions||{};(s&&(s.servers?.length>0||s.accessGroups?.length>0)||Object.keys(r).length>0)&&(t.object_permission={},s?.servers?.length>0&&(t.object_permission.mcp_servers=s.servers),s?.accessGroups?.length>0&&(t.object_permission.mcp_access_groups=s.accessGroups),Object.keys(r).length>0&&(t.object_permission.mcp_tool_permissions=r));let i=await (0,l.createAgentCall)(a,t),o=i.agent_id,d=i.agent_name||e.agent_name||o;if(eu(d),"create_new"===q&&U){let e=await (0,l.keyCreateForAgentCall)(a,o,U,G);ep(e.key||null)}else if("existing_key"===q){if(!Q){h.message.error("Please select an existing key to assign"),L(!1);return}await (0,l.keyUpdateCall)(a,{key:Q,agent_id:o});let e=K.find(e=>e.token===Q);eg(e?.key_alias||Q.slice(0,12)+"…")}A(3),n()}catch(t){console.error("Error creating agent:",t);let e=t instanceof Error?t.message:String(t);h.message.error(e?`Failed to create agent: ${e}`:"Failed to create agent")}finally{L(!1)}},eb=()=>{I.resetFields(),E("a2a"),A(0),$("create_new"),V(""),H([]),J(null),eu(""),ep(null),eg(null),s()},e_=e=>{E(e),I.resetFields()},ev=D===en?null:ej?.logo_url||O.find(e=>"a2a"===e.agent_type)?.logo_url;return(0,t.jsx)(u.Modal,{title:(0,t.jsxs)("div",{className:"flex items-center space-x-3 pb-4 border-b border-gray-100",children:[ev&&F<1&&(0,t.jsx)("img",{src:ev,alt:"Agent",className:"w-6 h-6 object-contain"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New Agent"})]}),open:e,onCancel:eb,footer:null,width:900,className:"top-8",styles:{body:{padding:"24px"},header:{padding:"24px 24px 0 24px",border:"none"}},children:(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)(y.Steps,{current:F,size:"small",className:"mb-8",children:[(0,t.jsx)(ei,{title:"Configure"}),(0,t.jsx)(ei,{title:"MCP Tools"}),(0,t.jsx)(ei,{title:"Assign Key"}),(0,t.jsx)(ei,{title:"Ready"})]}),(0,t.jsxs)(p.Form,{form:I,layout:"vertical",initialValues:"a2a"===D?{...(o={defaultInputModes:["text"],defaultOutputModes:["text"]},Object.values(M).forEach(e=>{e.fields.forEach(e=>{void 0!==e.defaultValue&&(o[e.name]=e.defaultValue)})}),o),allowed_mcp_servers_and_groups:{servers:[],accessGroups:[]},mcp_tool_permissions:{}}:{allowed_mcp_servers_and_groups:{servers:[],accessGroups:[]},mcp_tool_permissions:{}},className:"space-y-4",children:[0===F&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Form.Item,{label:(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Agent Type"}),required:!0,tooltip:"Select the type of agent you want to create",children:(0,t.jsx)(g.Select,{value:D,onChange:e_,size:"large",style:{width:"100%"},optionLabelProp:"label",dropdownRender:e=>(0,t.jsxs)(t.Fragment,{children:[e,(0,t.jsx)(_.Divider,{style:{margin:"4px 0"}}),(0,t.jsxs)("div",{className:"px-2 py-1",children:[(0,t.jsx)("div",{className:"text-xs text-gray-400 font-medium mb-1 uppercase tracking-wide px-2",children:"Not listed?"}),(0,t.jsxs)("div",{className:`flex items-center gap-3 px-2 py-2 rounded cursor-pointer transition-colors ${D===en?"bg-amber-50":"hover:bg-amber-50"}`,onClick:()=>e_(en),children:[(0,t.jsx)(k.AppstoreOutlined,{className:"text-amber-600 text-lg"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium text-amber-700",children:"Custom / Other"}),(0,t.jsx)(b.Tag,{color:"orange",style:{fontSize:10,padding:"0 4px"},children:"GENERIC"})]}),(0,t.jsx)("div",{className:"text-xs text-amber-600",children:"For agents that don't follow a standard protocol — just needs a virtual key"})]})]})]})]}),children:O.map(e=>(0,t.jsx)(g.Select.Option,{value:e.agent_type,label:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("img",{src:e.logo_url||"",alt:"",className:"w-4 h-4 object-contain"}),(0,t.jsx)("span",{children:e.agent_type_display_name})]}),children:(0,t.jsxs)("div",{className:"flex items-center gap-3 py-1",children:[(0,t.jsx)("img",{src:e.logo_url||"",alt:e.agent_type_display_name,className:"w-5 h-5 object-contain"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.agent_type_display_name}),e.description&&(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]})]})},e.agent_type))})}),(0,t.jsx)("div",{className:"mt-4",children:D===en?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(p.Form.Item,{label:"Agent Name",name:"agent_name",rules:[{required:!0,message:"Please enter an agent name"}],children:(0,t.jsx)(j.Input,{placeholder:"e.g. my-custom-agent"})}),(0,t.jsx)(p.Form.Item,{label:"Description",name:"description",children:(0,t.jsx)(j.Input.TextArea,{placeholder:"Describe what this agent does…",rows:3})})]}):"a2a"===D?(0,t.jsx)(ee,{showAgentName:!0}):ej?.use_a2a_form_fields?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ee,{showAgentName:!0}),ej.credential_fields.length>0&&(0,t.jsxs)("div",{className:"mt-4 p-4 border border-gray-200 rounded-lg",children:[(0,t.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:[ej.agent_type_display_name," Settings"]}),ej.credential_fields.map(e=>(0,t.jsx)(p.Form.Item,{label:e.label,name:e.key,rules:e.required?[{required:!0,message:`Please enter ${e.label}`}]:void 0,tooltip:e.tooltip,initialValue:e.default_value,children:"password"===e.field_type?(0,t.jsx)(j.Input.Password,{placeholder:e.placeholder||""}):(0,t.jsx)(j.Input,{placeholder:e.placeholder||""})},e.key))]})]}):ej?(0,t.jsx)(ea,{agentTypeInfo:ej}):null})]}),1===F&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Optionally restrict which MCP servers and tools this agent can use. Leave empty to allow all (subject to key/team permissions)."}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,t.jsx)(C.InfoCircleOutlined,{title:"Select which MCP servers or access groups this agent can access",style:{marginLeft:"4px"}})]}),name:"allowed_mcp_servers_and_groups",initialValue:{servers:[],accessGroups:[]},children:(0,t.jsx)(el.default,{onChange:e=>I.setFieldValue("allowed_mcp_servers_and_groups",e),value:I.getFieldValue("allowed_mcp_servers_and_groups")||{servers:[],accessGroups:[]},accessToken:a??"",placeholder:"Select MCP servers or access groups (optional)"})}),(0,t.jsx)(p.Form.Item,{name:"mcp_tool_permissions",initialValue:{},hidden:!0,children:(0,t.jsx)(j.Input,{type:"hidden"})}),(0,t.jsx)(p.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.allowed_mcp_servers_and_groups!==t.allowed_mcp_servers_and_groups||e.mcp_tool_permissions!==t.mcp_tool_permissions,children:()=>(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(er.default,{accessToken:a??"",selectedServers:I.getFieldValue("allowed_mcp_servers_and_groups")?.servers??[],toolPermissions:I.getFieldValue("mcp_tool_permissions")??{},onChange:e=>I.setFieldsValue({mcp_tool_permissions:e})})})})]}),2===F&&(d=I.getFieldValue("agent_name")||"your-agent",(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex justify-center mb-6",children:(0,t.jsx)(b.Tag,{icon:(0,t.jsx)(w.RobotOutlined,{}),color:"purple",className:"px-3 py-1 text-sm",children:d})}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-colors ${"create_new"===q?"border-indigo-600 bg-indigo-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>$("create_new"),children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,t.jsx)(f.Radio,{value:"create_new",checked:"create_new"===q,onChange:()=>$("create_new")}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.KeyOutlined,{className:"text-indigo-600"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"Create a new key for this agent"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"A dedicated key scoped to this agent."}),"create_new"===q&&(0,t.jsxs)("div",{className:"mt-3 space-y-3",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600 block mb-1",children:"Key Name"}),(0,t.jsx)(j.Input,{value:U,onChange:e=>V(e.target.value),placeholder:"e.g. my-agent-key"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm text-gray-600 block mb-1",children:["Allowed Models ",(0,t.jsx)("span",{className:"text-gray-400",children:"(optional — leave empty for all models)"})]}),(0,t.jsx)(g.Select,{mode:"tags",style:{width:"100%"},placeholder:ed?"Loading models...":"e.g. gpt-4o, claude-3-5-sonnet",value:G,onChange:H,tokenSeparators:[","],loading:ed,showSearch:!0,options:et.map(e=>({label:(0,T.getModelDisplayName)(e),value:e}))})]})]})]})]}),(0,t.jsx)(b.Tag,{color:"green",children:"Recommended"})]})}),(0,t.jsx)("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-colors ${"existing_key"===q?"border-indigo-600 bg-indigo-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>$("existing_key"),children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(f.Radio,{value:"existing_key",checked:"existing_key"===q,onChange:()=>$("existing_key")}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.KeyOutlined,{className:"text-gray-500"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"Assign an existing key"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Re-assign a key you already have to this agent."}),"existing_key"===q&&(0,t.jsx)("div",{className:"mt-3",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(g.Select,{showSearch:!0,style:{width:"100%"},placeholder:"Search by key name…",loading:X,value:Q,onChange:e=>J(e),filterOption:(e,t)=>(t?.label??"").toLowerCase().includes(e.toLowerCase()),options:K.map(e=>({label:e.key_alias||e.token?.slice(0,12)+"…",value:e.token}))})})]})]})})]}),(0,t.jsx)("div",{className:"text-center mt-4",children:(0,t.jsx)("button",{type:"button",className:"text-sm text-gray-500 underline hover:text-gray-700",onClick:()=>$("skip"),children:"Skip for now — I'll assign a key later"})})]})),3===F&&(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)(v.CheckCircleFilled,{className:"text-5xl text-green-500 mb-4",style:{fontSize:48}}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Agent Created!"}),(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)(b.Tag,{icon:(0,t.jsx)(w.RobotOutlined,{}),color:"purple",className:"px-3 py-1 text-sm",children:em})}),ex&&(0,t.jsx)("div",{className:"mt-4 text-left max-w-md mx-auto",children:(0,t.jsx)(S.default,{apiKey:ex})}),eh&&(0,t.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Key ",(0,t.jsx)("span",{className:"font-medium",children:eh})," has been assigned to this agent."]}),!ex&&!eh&&"skip"===q&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"No key assigned. You can create one from the Virtual Keys page."})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-gray-100 mt-6",children:[(0,t.jsx)("div",{children:F>0&&F<3&&(0,t.jsx)("button",{type:"button",onClick:()=>{A(e=>Math.max(0,e-1))},className:"text-sm text-gray-600 border border-gray-300 rounded px-4 py-2 hover:bg-gray-50",children:"← Back"})}),(0,t.jsxs)("div",{className:"flex gap-3",children:[F<3&&(0,t.jsx)(m.Button,{variant:"secondary",onClick:eb,children:"Cancel"}),0===F&&(0,t.jsx)(m.Button,{variant:"primary",onClick:ey,children:"Next →"}),1===F&&(0,t.jsx)(m.Button,{variant:"primary",onClick:ey,children:"Next →"}),2===F&&(0,t.jsx)(m.Button,{variant:"primary",loading:P,onClick:ef,children:P?"Creating...":"Create Agent →"}),3===F&&(0,t.jsx)(m.Button,{variant:"primary",onClick:eb,children:"Done"})]})]})]})})};var ed=e.i(981339),ec=e.i(175712),em=e.i(906579),eu=e.i(592968),ex=e.i(166406),ep=e.i(285027),eh=e.i(955135);let eg=({agent:e,keyInfo:s,onAgentClick:a,onDeleteClick:l,isAdmin:r})=>{let i=e.agent_card_params?.description||"No description",n=e.agent_card_params?.url,o=s?.has_key??!1,d=o?(0,t.jsx)(em.Badge,{status:"success",text:"Active"}):(0,t.jsx)(em.Badge,{status:"warning",text:"Needs Setup"});return(0,t.jsxs)(ec.Card,{hoverable:!0,className:"h-full flex flex-col",styles:{body:{flex:1,display:"flex",flexDirection:"column"}},onClick:()=>a(e.agent_id),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900 truncate",children:e.agent_name}),(0,t.jsx)(eu.Tooltip,{title:"Copy Agent ID",children:(0,t.jsx)(ex.CopyOutlined,{onClick:t=>{var s;return s=e.agent_id,void(t.stopPropagation(),navigator.clipboard.writeText(s))},className:"cursor-pointer text-gray-400 hover:text-blue-500 text-xs shrink-0"})})]}),(0,t.jsx)("div",{className:"mt-1",children:d})]}),r&&l&&(0,t.jsx)(eu.Tooltip,{title:"Delete agent",children:(0,t.jsx)(A.Button,{type:"text",size:"small",danger:!0,icon:(0,t.jsx)(eh.DeleteOutlined,{}),onClick:t=>{t.stopPropagation(),l(e.agent_id,e.agent_name)},className:"shrink-0 -mr-1"})})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2 flex-1 mb-3",children:i}),n&&(0,t.jsx)("p",{className:"text-xs text-gray-500 truncate mb-2",title:n,children:n}),(0,t.jsx)("div",{className:"mt-auto pt-3 border-t border-gray-100 text-xs",children:o?(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-gray-600",children:[(0,t.jsx)(N.KeyOutlined,{}),(0,t.jsx)("span",{children:s?.key_alias||s?.token_prefix||"Key assigned"})]}):(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-amber-600",children:[(0,t.jsx)(ep.WarningOutlined,{}),(0,t.jsx)("span",{children:"No key assigned"})]})})]})},ej=({agentsList:e,keyInfoMap:s,isLoading:a,onDeleteClick:l,accessToken:r,onAgentUpdated:i,isAdmin:n,onAgentClick:o})=>a?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(e=>(0,t.jsx)(ed.Skeleton,{active:!0,paragraph:{rows:3}},e))}):e&&0!==e.length?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,t.jsx)(eg,{agent:e,keyInfo:s[e.agent_id],onAgentClick:o,onDeleteClick:n?l:void 0,accessToken:r,isAdmin:n,onAgentUpdated:i},e.agent_id))}):(0,t.jsx)("div",{className:"rounded-lg border border-gray-200 bg-gray-50/50 py-12 text-center",children:(0,t.jsx)("p",{className:"text-gray-500",children:n?"No agents found. Create one to get started.":"No agents found. Contact an admin to create agents."})});var ey=e.i(708347),ef=e.i(304967),eb=e.i(629569),e_=e.i(599724),ev=e.i(197647),eN=e.i(653824),ew=e.i(881073),ek=e.i(404206),eC=e.i(723731),eS=e.i(482725),eT=e.i(869216),eI=e.i(530212);let eF=({agent:e})=>{let s=e.litellm_params;return s?.cost_per_query===void 0&&s?.input_cost_per_token===void 0&&s?.output_cost_per_token===void 0?null:(0,t.jsxs)("div",{style:{marginTop:24},children:[(0,t.jsx)(eb.Title,{children:"Cost Configuration"}),(0,t.jsxs)(eT.Descriptions,{bordered:!0,column:1,style:{marginTop:16},children:[void 0!==s.cost_per_query&&(0,t.jsxs)(eT.Descriptions.Item,{label:"Cost Per Query",children:["$",s.cost_per_query]}),void 0!==s.input_cost_per_token&&(0,t.jsxs)(eT.Descriptions.Item,{label:"Input Cost Per Token",children:["$",s.input_cost_per_token]}),void 0!==s.output_cost_per_token&&(0,t.jsxs)(eT.Descriptions.Item,{label:"Output Cost Per Token",children:["$",s.output_cost_per_token]})]})]})},eA=e=>{let t=e.litellm_params?.model||"",s=e.litellm_params?.custom_llm_provider;return"langgraph"===s?"langgraph":"azure_ai"===s?"azure_ai_foundry":"bedrock"===s?"bedrock_agentcore":t.startsWith("langgraph/")?"langgraph":t.startsWith("azure_ai/agents/")?"azure_ai_foundry":t.startsWith("bedrock/agentcore/")?"bedrock_agentcore":"a2a"},eP=(e,t)=>{let s={agent_name:e.agent_name,description:e.agent_card_params?.description||""};for(let a of t.credential_fields)if(!1!==a.include_in_litellm_params)s[a.key]=e.litellm_params?.[a.key]||a.default_value||"";else if(t.model_template&&e.litellm_params?.model){let l=e.litellm_params.model,r=t.model_template.split("/"),i=l.split("/");r.forEach((e,t)=>{e===`{${a.key}}`&&i[t]&&(s[a.key]=i[t])})}return s.cost_per_query=e.litellm_params?.cost_per_query,s.input_cost_per_token=e.litellm_params?.input_cost_per_token,s.output_cost_per_token=e.litellm_params?.output_cost_per_token,s},eL=({agentId:e,onClose:s,accessToken:a,isAdmin:r})=>{let[n,o]=(0,i.useState)(null),[d,c]=(0,i.useState)(!0),[u,x]=(0,i.useState)(!1),[g,y]=(0,i.useState)(!1),[f]=p.Form.useForm(),[b,_]=(0,i.useState)([]),[v,N]=(0,i.useState)("a2a");(0,i.useEffect)(()=>{(async()=>{try{let e=await (0,l.getAgentCreateMetadata)();_(e)}catch(e){console.error("Error fetching agent metadata:",e)}})()},[]),(0,i.useEffect)(()=>{w()},[e,a]);let w=async()=>{if(a){c(!0);try{let t=await (0,l.getAgentInfo)(a,e);o(t);let s=eA(t);if(N(s),"a2a"===s)f.setFieldsValue(J(t));else{let e=b.find(e=>e.agent_type===s);e?f.setFieldsValue(eP(t,e)):f.setFieldsValue(J(t))}}catch(e){console.error("Error fetching agent info:",e),h.message.error("Failed to load agent information")}finally{c(!1)}}};(0,i.useEffect)(()=>{if(n&&b.length>0){let e=eA(n);if("a2a"!==e){let t=b.find(t=>t.agent_type===e);t&&f.setFieldsValue(eP(n,t))}}},[b,n]);let k=b.find(e=>e.agent_type===v),C=async t=>{if(a&&n){y(!0);try{let s;"a2a"===v?s=Y(t,n):k?(s=es(t,k)).agent_name=t.agent_name:s=Y(t,n),await (0,l.patchAgentCall)(a,e,s),h.message.success("Agent updated successfully"),x(!1),w()}catch(e){console.error("Error updating agent:",e),h.message.error("Failed to update agent")}finally{y(!1)}}};if(d)return(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)(eS.Spin,{size:"large"})})});if(!n)return(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("div",{className:"text-center",children:"Agent not found"}),(0,t.jsx)(m.Button,{onClick:s,className:"mt-4",children:"Back to Agents List"})]});let S=e=>e?new Date(e).toLocaleString():"-";return(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Button,{icon:eI.ArrowLeftIcon,variant:"light",onClick:s,className:"mb-4",children:"Back to Agents"}),(0,t.jsx)(eb.Title,{children:n.agent_name||"Unnamed Agent"}),(0,t.jsx)(e_.Text,{className:"text-gray-500 font-mono",children:n.agent_id})]}),(0,t.jsxs)(eN.TabGroup,{children:[(0,t.jsxs)(ew.TabList,{className:"mb-4",children:[(0,t.jsx)(ev.Tab,{children:"Overview"},"overview"),r?(0,t.jsx)(ev.Tab,{children:"Settings"},"settings"):(0,t.jsx)(t.Fragment,{})]}),(0,t.jsxs)(eC.TabPanels,{children:[(0,t.jsxs)(ek.TabPanel,{children:[(0,t.jsxs)(eT.Descriptions,{bordered:!0,column:1,children:[(0,t.jsx)(eT.Descriptions.Item,{label:"Agent ID",children:n.agent_id}),(0,t.jsx)(eT.Descriptions.Item,{label:"Agent Name",children:n.agent_name}),(0,t.jsx)(eT.Descriptions.Item,{label:"Display Name",children:n.agent_card_params?.name||"-"}),(0,t.jsx)(eT.Descriptions.Item,{label:"Description",children:n.agent_card_params?.description||"-"}),(0,t.jsx)(eT.Descriptions.Item,{label:"URL",children:n.agent_card_params?.url||"-"}),(0,t.jsx)(eT.Descriptions.Item,{label:"Version",children:n.agent_card_params?.version||"-"}),(0,t.jsx)(eT.Descriptions.Item,{label:"Protocol Version",children:n.agent_card_params?.protocolVersion||"-"}),(0,t.jsx)(eT.Descriptions.Item,{label:"Streaming",children:n.agent_card_params?.capabilities?.streaming?"Yes":"No"}),n.agent_card_params?.capabilities?.pushNotifications&&(0,t.jsx)(eT.Descriptions.Item,{label:"Push Notifications",children:"Yes"}),n.agent_card_params?.capabilities?.stateTransitionHistory&&(0,t.jsx)(eT.Descriptions.Item,{label:"State Transition History",children:"Yes"}),(0,t.jsxs)(eT.Descriptions.Item,{label:"Skills",children:[n.agent_card_params?.skills?.length||0," configured"]}),n.litellm_params?.model&&(0,t.jsx)(eT.Descriptions.Item,{label:"Model",children:n.litellm_params.model}),n.litellm_params?.make_public!==void 0&&(0,t.jsx)(eT.Descriptions.Item,{label:"Make Public",children:n.litellm_params.make_public?"Yes":"No"}),n.agent_card_params?.iconUrl&&(0,t.jsx)(eT.Descriptions.Item,{label:"Icon URL",children:n.agent_card_params.iconUrl}),n.agent_card_params?.documentationUrl&&(0,t.jsx)(eT.Descriptions.Item,{label:"Documentation URL",children:n.agent_card_params.documentationUrl}),(0,t.jsx)(eT.Descriptions.Item,{label:"Created At",children:S(n.created_at)}),(0,t.jsx)(eT.Descriptions.Item,{label:"Updated At",children:S(n.updated_at)})]}),n.object_permission&&(n.object_permission.mcp_servers?.length||n.object_permission.mcp_access_groups?.length||n.object_permission.mcp_tool_permissions&&Object.keys(n.object_permission.mcp_tool_permissions).length>0)&&(0,t.jsxs)("div",{style:{marginTop:24},children:[(0,t.jsx)(eb.Title,{children:"MCP Tool Permissions"}),(0,t.jsxs)(eT.Descriptions,{bordered:!0,column:1,style:{marginTop:16},children:[n.object_permission.mcp_servers&&n.object_permission.mcp_servers.length>0&&(0,t.jsx)(eT.Descriptions.Item,{label:"MCP Servers",children:n.object_permission.mcp_servers.join(", ")}),n.object_permission.mcp_access_groups&&n.object_permission.mcp_access_groups.length>0&&(0,t.jsx)(eT.Descriptions.Item,{label:"MCP Access Groups",children:n.object_permission.mcp_access_groups.join(", ")}),n.object_permission.mcp_tool_permissions&&Object.keys(n.object_permission.mcp_tool_permissions).length>0&&(0,t.jsx)(eT.Descriptions.Item,{label:"Tool permissions per server",children:(0,t.jsx)("div",{className:"space-y-1",children:Object.entries(n.object_permission.mcp_tool_permissions).map(([e,s])=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"font-medium",children:[e,":"]})," ",Array.isArray(s)?s.join(", "):String(s)]},e))})})]})]}),(0,t.jsx)(eF,{agent:n}),n.agent_card_params?.skills&&n.agent_card_params.skills.length>0&&(0,t.jsxs)("div",{style:{marginTop:24},children:[(0,t.jsx)(eb.Title,{children:"Skills"}),(0,t.jsx)(eT.Descriptions,{bordered:!0,column:1,style:{marginTop:16},children:n.agent_card_params.skills.map((e,s)=>(0,t.jsx)(eT.Descriptions.Item,{label:e.name||`Skill ${s+1}`,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"ID:"})," ",e.id]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Description:"})," ",e.description]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Tags:"})," ",Array.isArray(e.tags)?e.tags.join(", "):e.tags]}),e.examples&&e.examples.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Examples:"})," ",Array.isArray(e.examples)?e.examples.join(", "):e.examples]})]})},s))})]})]}),r&&(0,t.jsx)(ek.TabPanel,{children:(0,t.jsxs)(ef.Card,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)(eb.Title,{children:"Agent Settings"}),!u&&(0,t.jsx)(m.Button,{onClick:()=>x(!0),children:"Edit Settings"})]}),u?(0,t.jsxs)(p.Form,{form:f,layout:"vertical",onFinish:C,children:[(0,t.jsx)(p.Form.Item,{label:"Agent ID",children:(0,t.jsx)(j.Input,{value:n.agent_id,disabled:!0})}),"a2a"===v?(0,t.jsx)(ee,{showAgentName:!0}):k?(0,t.jsx)(ea,{agentTypeInfo:k}):(0,t.jsx)(ee,{showAgentName:!0}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,t.jsx)(A.Button,{onClick:()=>{x(!1),w()},children:"Cancel"}),(0,t.jsx)(m.Button,{loading:g,children:"Save Changes"})]})]}):(0,t.jsx)(e_.Text,{children:'Click "Edit Settings" to modify agent configuration.'})]})})]})]})]})};var eM=e.i(727749);let eD=({accessToken:e,userRole:s})=>{let[a,r]=(0,i.useState)([]),[n,o]=(0,i.useState)({}),[d,c]=(0,i.useState)(!1),[p,h]=(0,i.useState)(!1),[g,j]=(0,i.useState)(!1),[y,f]=(0,i.useState)(null),[b,_]=(0,i.useState)(null),v=!!s&&(0,ey.isAdminRole)(s),N=async()=>{if(e){h(!0);try{let t=await (0,l.getAgentsList)(e);r(t.agents||[])}catch(e){console.error("Error fetching agents:",e)}finally{h(!1)}}},w=async()=>{if(e)try{let{keys:t=[]}=await (0,l.keyListCall)(e,null,null,null,null,null,1,500),s={};for(let e of t){let t=e.agent_id;t&&!s[t]&&(s[t]={has_key:!0,key_alias:e.key_alias,token_prefix:e.token?`${e.token.slice(0,8)}…`:void 0})}o(s)}catch(e){console.error("Error fetching keys for agents:",e)}};(0,i.useEffect)(()=>{N()},[e]),(0,i.useEffect)(()=>{e&&a.length>0?w():0===a.length&&o({})},[e,a.length]);let k=async()=>{if(y&&e){j(!0);try{await (0,l.deleteAgentCall)(e,y.id),eM.default.success(`Agent "${y.name}" deleted successfully`),N()}catch(e){console.error("Error deleting agent:",e),eM.default.fromBackend("Failed to delete agent")}finally{j(!1),f(null)}}};return(0,t.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2 mb-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Agents"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"List of A2A-spec agents that are available to be used in your organization. Go to AI Hub, to make agents public."}),(0,t.jsx)(x.Alert,{message:"Why do agents need keys?",description:"Keys scope access to an agent and allow it to call MCP tools. Assign a key when creating an agent or from the Virtual Keys page.",type:"info",showIcon:!0,className:"mb-3"}),v&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(m.Button,{onClick:()=>{b&&_(null),c(!0)},disabled:!e,children:"+ Add New Agent"})})]}),b?(0,t.jsx)(eL,{agentId:b,onClose:()=>_(null),accessToken:e,isAdmin:v}):(0,t.jsx)(ej,{agentsList:a,keyInfoMap:n,isLoading:p,onDeleteClick:(e,t)=>{f({id:e,name:t})},accessToken:e,onAgentUpdated:N,isAdmin:v,onAgentClick:e=>_(e)}),(0,t.jsx)(eo,{visible:d,onClose:()=>{c(!1)},accessToken:e,onSuccess:()=>{N()}}),y&&(0,t.jsxs)(u.Modal,{title:"Delete Agent",open:null!==y,onOk:k,onCancel:()=>{f(null)},confirmLoading:g,okText:"Delete",okButtonProps:{danger:!0},children:[(0,t.jsxs)("p",{children:["Are you sure you want to delete agent: ",y.name,"?"]}),(0,t.jsx)("p",{children:"This action cannot be undone."})]})]})};var eE=e.i(646050),eO=e.i(559061),ez=e.i(704308),eR=e.i(584578),eB=e.i(936578),eq=e.i(677667),e$=e.i(898667),eU=e.i(130643),eV=e.i(779241),eG=e.i(752978),eH=e.i(68155),eK=e.i(591935);let eW=i.forwardRef(function(e,t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"}))});var eQ=e.i(836991),eY=e.i(269200),eJ=e.i(427612),eX=e.i(496020),eZ=e.i(64848),e0=e.i(942232),e1=e.i(977572);function e2({data:e,columns:s,isLoading:a=!1,loadingMessage:l="Loading...",emptyMessage:r="No data",getRowKey:i}){return(0,t.jsxs)(eY.Table,{children:[(0,t.jsx)(eJ.TableHead,{children:(0,t.jsx)(eX.TableRow,{children:s.map((e,s)=>(0,t.jsx)(eZ.TableHeaderCell,{style:{width:e.width},children:e.header},s))})}),(0,t.jsx)(e0.TableBody,{children:a?(0,t.jsx)(eX.TableRow,{children:(0,t.jsx)(e1.TableCell,{colSpan:s.length,className:"text-center",children:(0,t.jsx)(e_.Text,{className:"text-gray-500",children:l})})}):e.length>0?e.map((e,a)=>(0,t.jsx)(eX.TableRow,{children:s.map((s,a)=>(0,t.jsx)(e1.TableCell,{children:s.cell?s.cell(e):String(e[s.accessor]??"")},a))},i?i(e,a):a)):(0,t.jsx)(eX.TableRow,{children:(0,t.jsx)(e1.TableCell,{colSpan:s.length,className:"text-center",children:(0,t.jsx)(e_.Text,{className:"text-gray-500",children:r})})})})]})}var e4=e.i(916925);let e5=e=>{let t=Object.keys(e4.provider_map).find(t=>e4.provider_map[t]===e);if(t){let e=e4.Providers[t],s=e4.providerLogoMap[e];return{displayName:e,logo:s,enumKey:t}}return{displayName:e,logo:"",enumKey:null}},e6=e=>e4.provider_map[e]||null,e3=(e,t)=>{let s=e.target,a=s.parentElement;if(a){let e=document.createElement("div");e.className="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=t.charAt(0),a.replaceChild(e,s)}},e8=({discountConfig:e,onDiscountChange:s,onRemoveProvider:a})=>{let[l,r]=(0,i.useState)(null),[n,o]=(0,i.useState)(""),d=e=>{let t=parseFloat(n);!isNaN(t)&&t>=0&&t<=100&&s(e,(t/100).toString()),r(null),o("")},c=()=>{r(null),o("")},m=Object.entries(e).map(([e,t])=>({provider:e,discount:t})).sort((e,t)=>{let s=e5(e.provider).displayName,a=e5(t.provider).displayName;return s.localeCompare(a)});return(0,t.jsx)(e2,{data:m,columns:[{header:"Provider",cell:e=>{let{displayName:s,logo:a}=e5(e.provider);return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[a&&(0,t.jsx)("img",{src:a,alt:`${s} logo`,className:"w-5 h-5",onError:e=>e3(e,s)}),(0,t.jsx)("span",{className:"font-medium",children:s})]})}},{header:"Discount Percentage",cell:e=>(0,t.jsx)("div",{className:"flex items-center gap-2",children:l===e.provider?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eV.TextInput,{value:n,onValueChange:o,onKeyDown:t=>{var s;return s=e.provider,void("Enter"===t.key?d(s):"Escape"===t.key&&c())},placeholder:"5",className:"w-20",autoFocus:!0}),(0,t.jsx)("span",{className:"text-gray-600",children:"%"}),(0,t.jsx)(eG.Icon,{icon:eW,size:"sm",onClick:()=>d(e.provider),className:"cursor-pointer text-green-600 hover:text-green-700"}),(0,t.jsx)(eG.Icon,{icon:eQ.XIcon,size:"sm",onClick:c,className:"cursor-pointer text-gray-600 hover:text-gray-700"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e_.Text,{className:"font-medium",children:[(100*e.discount).toFixed(1),"%"]}),(0,t.jsx)(eG.Icon,{icon:eK.PencilAltIcon,size:"sm",onClick:()=>{var t,s;return t=e.provider,s=e.discount,void(r(t),o((100*s).toString()))},className:"cursor-pointer text-blue-600 hover:text-blue-700"})]})}),width:"250px"},{header:"Actions",cell:e=>{let{displayName:s}=e5(e.provider);return(0,t.jsx)(eG.Icon,{icon:eH.TrashIcon,size:"sm",onClick:()=>a(e.provider,s),className:"cursor-pointer hover:text-red-600"})},width:"80px"}],getRowKey:e=>e.provider,emptyMessage:"No provider discounts configured"})},e7=({discountConfig:e,selectedProvider:s,newDiscount:a,onProviderChange:l,onDiscountChange:r,onAddProvider:i})=>(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Provider",(0,t.jsx)(eu.Tooltip,{title:"Select the LLM provider you want to configure a discount for",children:(0,t.jsx)(C.InfoCircleOutlined,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),rules:[{required:!0,message:"Please select a provider"}],children:(0,t.jsx)(g.Select,{showSearch:!0,placeholder:"Select provider",value:s,onChange:l,style:{width:"100%"},size:"large",optionFilterProp:"children",filterOption:(e,t)=>String(t?.label??"").toLowerCase().includes(e.toLowerCase()),children:Object.entries(e4.Providers).map(([s,a])=>{let l=e4.provider_map[s];return l&&e[l]?null:(0,t.jsx)(g.Select.Option,{value:s,label:a,children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("img",{src:e4.providerLogoMap[a],alt:`${s} logo`,className:"w-5 h-5",onError:e=>e3(e,a)}),(0,t.jsx)("span",{children:a})]})},s)})})}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Discount Percentage",(0,t.jsx)(eu.Tooltip,{title:"Enter a percentage value (e.g., 5 for 5% discount)",children:(0,t.jsx)(C.InfoCircleOutlined,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),rules:[{required:!0,message:"Please enter a discount percentage"}],children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eV.TextInput,{placeholder:"5",value:a,onValueChange:r,className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500 flex-1"}),(0,t.jsx)("span",{className:"text-gray-600",children:"%"})]})}),(0,t.jsx)("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-100",children:(0,t.jsx)(m.Button,{variant:"primary",onClick:i,disabled:!s||!a,children:"Add Provider Discount"})})]}),e9=({marginConfig:e,onMarginChange:s,onRemoveProvider:a})=>{let[l,r]=(0,i.useState)(null),[n,o]=(0,i.useState)(""),[d,c]=(0,i.useState)(""),m=()=>{r(null),o(""),c("")},u=Object.entries(e).map(([e,t])=>({provider:e,margin:t})).sort((e,t)=>{if("global"===e.provider)return -1;if("global"===t.provider)return 1;let s=e5(e.provider).displayName,a=e5(t.provider).displayName;return s.localeCompare(a)});return(0,t.jsx)(e2,{data:u,columns:[{header:"Provider",cell:e=>{if("global"===e.provider)return(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsx)("span",{className:"font-medium",children:"Global (All Providers)"})});let{displayName:s,logo:a}=e5(e.provider);return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[a&&(0,t.jsx)("img",{src:a,alt:`${s} logo`,className:"w-5 h-5",onError:e=>e3(e,s)}),(0,t.jsx)("span",{className:"font-medium",children:s})]})}},{header:"Margin",cell:e=>(0,t.jsx)("div",{className:"flex items-center gap-2",children:l===e.provider?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eV.TextInput,{value:n,onValueChange:o,placeholder:"10",className:"w-20",autoFocus:!0}),(0,t.jsx)("span",{className:"text-gray-600",children:"%"}),(0,t.jsx)("span",{className:"text-gray-400",children:"+"}),(0,t.jsx)("span",{className:"text-gray-600",children:"$"}),(0,t.jsx)(eV.TextInput,{value:d,onValueChange:c,placeholder:"0.001",className:"w-24"})]}),(0,t.jsx)(eG.Icon,{icon:eW,size:"sm",onClick:()=>{var t;let a,l;return t=e.provider,a=n?parseFloat(n):void 0,l=d?parseFloat(d):void 0,void(void 0!==a&&!isNaN(a)&&a>=0&&a<=1e3?void 0!==l&&!isNaN(l)&&l>=0?s(t,{percentage:a/100,fixed_amount:l}):s(t,a/100):void 0!==l&&!isNaN(l)&&l>=0&&s(t,{fixed_amount:l}),r(null),o(""),c(""))},className:"cursor-pointer text-green-600 hover:text-green-700"}),(0,t.jsx)(eG.Icon,{icon:eQ.XIcon,size:"sm",onClick:m,className:"cursor-pointer text-gray-600 hover:text-gray-700"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e_.Text,{className:"font-medium",children:(e=>{if("number"==typeof e)return`${(100*e).toFixed(1)}%`;let t=[];return void 0!==e.percentage&&t.push(`${(100*e.percentage).toFixed(1)}%`),void 0!==e.fixed_amount&&t.push(`$${e.fixed_amount.toFixed(6)}`),t.join(" + ")||"0%"})(e.margin)}),(0,t.jsx)(eG.Icon,{icon:eK.PencilAltIcon,size:"sm",onClick:()=>{var t,s;return t=e.provider,s=e.margin,void(r(t),"number"==typeof s?(o((100*s).toString()),c("")):(o(s.percentage?(100*s.percentage).toString():""),c(s.fixed_amount?s.fixed_amount.toString():"")))},className:"cursor-pointer text-blue-600 hover:text-blue-700"})]})}),width:"350px"},{header:"Actions",cell:e=>{let s="global"===e.provider?"Global":e5(e.provider).displayName;return(0,t.jsx)(eG.Icon,{icon:eH.TrashIcon,size:"sm",onClick:()=>a(e.provider,s),className:"cursor-pointer hover:text-red-600"})},width:"80px"}],getRowKey:e=>e.provider,emptyMessage:"No provider margins configured"})},te=({marginConfig:e,selectedProvider:s,marginType:a,percentageValue:l,fixedAmountValue:r,onProviderChange:i,onMarginTypeChange:n,onPercentageChange:o,onFixedAmountChange:d,onAddProvider:c})=>(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Provider",(0,t.jsx)(eu.Tooltip,{title:"Select 'Global' to apply margin to all providers, or select a specific provider",children:(0,t.jsx)(C.InfoCircleOutlined,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),rules:[{required:!0,message:"Please select a provider"}],children:(0,t.jsxs)(g.Select,{showSearch:!0,placeholder:"Select provider or 'Global'",value:s,onChange:i,style:{width:"100%"},size:"large",optionFilterProp:"children",filterOption:(e,t)=>String(t?.label??"").toLowerCase().includes(e.toLowerCase()),children:[(0,t.jsx)(g.Select.Option,{value:"global",label:"Global (All Providers)",children:(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsx)("span",{className:"font-medium",children:"Global (All Providers)"})})},"global"),Object.entries(e4.Providers).map(([s,a])=>{let l=e4.provider_map[s];return l&&e[l]?null:(0,t.jsx)(g.Select.Option,{value:s,label:a,children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("img",{src:e4.providerLogoMap[a],alt:`${s} logo`,className:"w-5 h-5",onError:e=>e3(e,a)}),(0,t.jsx)("span",{children:a})]})},s)})]})}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Margin Type",(0,t.jsx)(eu.Tooltip,{title:"Choose how to apply the margin: percentage-based or fixed amount",children:(0,t.jsx)(C.InfoCircleOutlined,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),rules:[{required:!0,message:"Please select a margin type"}],children:(0,t.jsxs)(f.Radio.Group,{value:a,onChange:e=>n(e.target.value),className:"w-full",children:[(0,t.jsx)(f.Radio,{value:"percentage",children:"Percentage-based"}),(0,t.jsx)(f.Radio,{value:"fixed",children:"Fixed Amount"})]})}),"percentage"===a&&(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Margin Percentage",(0,t.jsx)(eu.Tooltip,{title:"Enter a percentage value (e.g., 10 for 10% margin)",children:(0,t.jsx)(C.InfoCircleOutlined,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),rules:[{required:!0,message:"Please enter a margin percentage"},{validator:(e,t)=>{if(!t)return Promise.reject(Error("Please enter a margin percentage"));let s=parseFloat(t);return isNaN(s)||s<0||s>1e3?Promise.reject(Error("Percentage must be between 0 and 1000")):Promise.resolve()}}],children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eV.TextInput,{placeholder:"10",value:l,onValueChange:o,className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500 flex-1"}),(0,t.jsx)("span",{className:"text-gray-600",children:"%"})]})}),"fixed"===a&&(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Fixed Margin Amount",(0,t.jsx)(eu.Tooltip,{title:"Enter a fixed amount in USD (e.g., 0.001 for $0.001 per request)",children:(0,t.jsx)(C.InfoCircleOutlined,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),rules:[{required:!0,message:"Please enter a fixed amount"},{validator:(e,t)=>{if(!t)return Promise.reject(Error("Please enter a fixed amount"));let s=parseFloat(t);return isNaN(s)||s<0?Promise.reject(Error("Fixed amount must be non-negative")):Promise.resolve()}}],children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"$"}),(0,t.jsx)(eV.TextInput,{placeholder:"0.001",value:r,onValueChange:d,className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500 flex-1"})]})}),(0,t.jsx)("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-gray-100",children:(0,t.jsx)(m.Button,{variant:"primary",onClick:c,disabled:!s||"percentage"===a&&!l||"fixed"===a&&!r,children:"Add Provider Margin"})})]});var tt=e.i(291542),ts=e.i(28651);e.i(247167),e.i(62664);var ta=e.i(697539),tl=e.i(963188),tr=e.i(763731),ti=e.i(343794),tn=e.i(244009),to=e.i(242064),td=e.i(185793);let tc=e=>{let t,{value:s,formatter:a,precision:l,decimalSeparator:r,groupSeparator:n="",prefixCls:o}=e;if("function"==typeof a)t=a(s);else{let e=String(s),a=e.match(/^(-?)(\d*)(\.(\d+))?$/);if(a&&"-"!==e){let e=a[1],s=a[2]||"0",d=a[4]||"";s=s.replace(/\B(?=(\d{3})+(?!\d))/g,n),"number"==typeof l&&(d=d.padEnd(l,"0").slice(0,l>0?l:0)),d&&(d=`${r}${d}`),t=[i.createElement("span",{key:"int",className:`${o}-content-value-int`},e,s),d&&i.createElement("span",{key:"decimal",className:`${o}-content-value-decimal`},d)]}else t=e}return i.createElement("span",{className:`${o}-content-value`},t)};var tm=e.i(183293),tu=e.i(246422),tx=e.i(838378);let tp=(0,tu.genStyleHooks)("Statistic",e=>(e=>{let{componentCls:t,marginXXS:s,padding:a,colorTextDescription:l,titleFontSize:r,colorTextHeading:i,contentFontSize:n,fontFamily:o}=e;return{[t]:Object.assign(Object.assign({},(0,tm.resetComponent)(e)),{[`${t}-title`]:{marginBottom:s,color:l,fontSize:r},[`${t}-skeleton`]:{paddingTop:a},[`${t}-content`]:{color:i,fontSize:n,fontFamily:o,[`${t}-content-value`]:{display:"inline-block",direction:"ltr"},[`${t}-content-prefix, ${t}-content-suffix`]:{display:"inline-block"},[`${t}-content-prefix`]:{marginInlineEnd:s},[`${t}-content-suffix`]:{marginInlineStart:s}}})}})((0,tx.mergeToken)(e,{})),e=>{let{fontSizeHeading3:t,fontSize:s}=e;return{titleFontSize:s,contentFontSize:t}});var th=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var l=0,a=Object.getOwnPropertySymbols(e);l<a.length;l++)0>t.indexOf(a[l])&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(s[a[l]]=e[a[l]]);return s};let tg=i.forwardRef((e,t)=>{let{prefixCls:s,className:a,rootClassName:l,style:r,valueStyle:n,value:o=0,title:d,valueRender:c,prefix:m,suffix:u,loading:x=!1,formatter:p,precision:h,decimalSeparator:g=".",groupSeparator:j=",",onMouseEnter:y,onMouseLeave:f}=e,b=th(e,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:_,direction:v,className:N,style:w}=(0,to.useComponentConfig)("statistic"),k=_("statistic",s),[C,S,T]=tp(k),I=i.createElement(tc,{decimalSeparator:g,groupSeparator:j,prefixCls:k,formatter:p,precision:h,value:o}),F=(0,ti.default)(k,{[`${k}-rtl`]:"rtl"===v},N,a,l,S,T),A=i.useRef(null);i.useImperativeHandle(t,()=>({nativeElement:A.current}));let P=(0,tn.default)(b,{aria:!0,data:!0});return C(i.createElement("div",Object.assign({},P,{ref:A,className:F,style:Object.assign(Object.assign({},w),r),onMouseEnter:y,onMouseLeave:f}),d&&i.createElement("div",{className:`${k}-title`},d),i.createElement(td.default,{paragraph:!1,loading:x,className:`${k}-skeleton`,active:!0},i.createElement("div",{style:n,className:`${k}-content`},m&&i.createElement("span",{className:`${k}-content-prefix`},m),c?c(I):I,u&&i.createElement("span",{className:`${k}-content-suffix`},u)))))}),tj=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];var ty=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var l=0,a=Object.getOwnPropertySymbols(e);l<a.length;l++)0>t.indexOf(a[l])&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(s[a[l]]=e[a[l]]);return s};let tf=e=>{let{value:t,format:s="HH:mm:ss",onChange:a,onFinish:l,type:r}=e,n=ty(e,["value","format","onChange","onFinish","type"]),o="countdown"===r,[d,c]=i.useState(null),m=(0,ta.useEvent)(()=>{let e=Date.now(),s=new Date(t).getTime();return c({}),null==a||a(o?s-e:e-s),!o||!(s<e)||(null==l||l(),!1)});return i.useEffect(()=>{let e,t=()=>{e=(0,tl.default)(()=>{m()&&t()})};return t(),()=>tl.default.cancel(e)},[t,o]),i.useEffect(()=>{c({})},[]),i.createElement(tg,Object.assign({},n,{value:t,valueRender:e=>(0,tr.cloneElement)(e,{title:void 0}),formatter:(e,t)=>d?function(e,t,s){let a,l,r,i,n,o,{format:d=""}=t,c=new Date(e).getTime(),m=Date.now();return a=s?Math.max(c-m,0):Math.max(m-c,0),l=/\[[^\]]*]/g,r=(d.match(l)||[]).map(e=>e.slice(1,-1)),i=d.replace(l,"[]"),n=tj.reduce((e,[t,s])=>{if(e.includes(t)){let l=Math.floor(a/s);return a-=l*s,e.replace(RegExp(`${t}+`,"g"),e=>{let t=e.length;return l.toString().padStart(t,"0")})}return e},i),o=0,n.replace(l,()=>{let e=r[o];return o+=1,e})}(e,Object.assign(Object.assign({},t),{format:s}),o):"-"}))},tb=i.memo(e=>i.createElement(tf,Object.assign({},e,{type:"countdown"})));tg.Timer=tf,tg.Countdown=tb;var t_=e.i(621192),tv=e.i(178654),tN=e.i(56456),tw=e.i(755151),tk=e.i(240647),tC=e.i(500330),tS=e.i(737434),tT=e.i(91500),tI=e.i(931067);let tF={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"};var tA=e.i(9583),tP=i.forwardRef(function(e,t){return i.createElement(tA.default,(0,tI.default)({},e,{ref:t,icon:tF}))});let tL=e=>null==e?"-":0===e?"$0.00":e<.01?`$${e.toFixed(6)}`:e<1?`$${e.toFixed(4)}`:`$${(0,tC.formatNumberWithCommas)(e,2)}`,tM=e=>null==e?"-":(0,tC.formatNumberWithCommas)(e,0),tD=({multiResult:e})=>{let[s,a]=(0,i.useState)(!1),l=(0,i.useRef)(null),r=e.entries.some(e=>null!==e.result);return((0,i.useEffect)(()=>{let e=e=>{l.current&&!l.current.contains(e.target)&&a(!1)};return s&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s]),r)?(0,t.jsxs)("div",{className:"relative inline-block",ref:l,children:[(0,t.jsx)(m.Button,{size:"xs",variant:"secondary",icon:tS.DownloadOutlined,onClick:()=>a(!s),children:"Export"}),s&&(0,t.jsxs)("div",{className:"absolute right-0 mt-1 w-44 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[(0,t.jsxs)("button",{className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>{(e=>{let t=window.open("","_blank");if(!t)return alert("Please allow popups to export PDF");let s=e.entries.filter(e=>null!==e.result),a=s.length,l=`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Multi-Model Cost Estimate Report</title>
      <style>
        body {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          padding: 40px;
          max-width: 900px;
          margin: 0 auto;
          color: #333;
        }
        h1 {
          color: #1a1a1a;
          border-bottom: 2px solid #1890ff;
          padding-bottom: 10px;
          margin-bottom: 30px;
        }
        h2 {
          color: #444;
          margin-top: 30px;
          margin-bottom: 15px;
        }
        h3 {
          color: #555;
          margin-top: 25px;
          margin-bottom: 10px;
          padding-bottom: 5px;
          border-bottom: 1px solid #eee;
        }
        .provider {
          font-weight: normal;
          color: #1890ff;
          font-size: 14px;
        }
        .meta {
          background: #f5f5f5;
          padding: 12px 15px;
          border-radius: 8px;
          margin-bottom: 15px;
          font-size: 13px;
        }
        .meta p {
          margin: 4px 0;
        }
        table {
          width: 100%;
          border-collapse: collapse;
          margin-bottom: 20px;
        }
        th, td {
          padding: 10px 12px;
          text-align: left;
          border-bottom: 1px solid #ddd;
        }
        th {
          background: #f8f9fa;
          font-weight: 600;
          font-size: 13px;
        }
        .cost-value {
          font-family: monospace;
          font-size: 13px;
        }
        .total-row {
          font-weight: bold;
          background: #e6f7ff;
        }
        .summary-box {
          background: linear-gradient(135deg, #e6f7ff 0%, #f9f0ff 100%);
          border: 1px solid #91d5ff;
          border-radius: 8px;
          padding: 20px;
          margin-bottom: 30px;
        }
        .summary-box h2 {
          margin-top: 0;
          color: #1890ff;
        }
        .summary-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 20px;
          margin-top: 15px;
        }
        .summary-item {
          text-align: center;
        }
        .summary-item .label {
          font-size: 12px;
          color: #666;
          margin-bottom: 5px;
        }
        .summary-item .value {
          font-size: 20px;
          font-weight: bold;
          font-family: monospace;
        }
        .summary-item .value.blue { color: #1890ff; }
        .summary-item .value.green { color: #52c41a; }
        .summary-item .value.purple { color: #722ed1; }
        .model-section {
          margin-bottom: 30px;
          page-break-inside: avoid;
        }
        .footer {
          margin-top: 40px;
          padding-top: 20px;
          border-top: 1px solid #ddd;
          font-size: 12px;
          color: #666;
        }
        @media print {
          body { padding: 20px; }
          .model-section { page-break-inside: avoid; }
        }
      </style>
    </head>
    <body>
      <h1>LLM Cost Estimate Report</h1>
      <p style="color: #666; margin-top: -20px; margin-bottom: 30px;">${a} model${1!==a?"s":""} configured</p>
      
      <div class="summary-box">
        <h2>Combined Totals</h2>
        <div class="summary-grid">
          <div class="summary-item">
            <div class="label">Total Per Request</div>
            <div class="value blue">${tL(e.totals.cost_per_request)}</div>
          </div>
          <div class="summary-item">
            <div class="label">Total Daily</div>
            <div class="value green">${tL(e.totals.daily_cost)}</div>
          </div>
          <div class="summary-item">
            <div class="label">Total Monthly</div>
            <div class="value purple">${tL(e.totals.monthly_cost)}</div>
          </div>
        </div>
        ${e.totals.margin_per_request>0?`
        <div class="summary-grid" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #ddd;">
          <div class="summary-item">
            <div class="label">Margin/Request</div>
            <div class="value" style="color: #faad14;">${tL(e.totals.margin_per_request)}</div>
          </div>
          <div class="summary-item">
            <div class="label">Daily Margin</div>
            <div class="value" style="color: #faad14;">${tL(e.totals.daily_margin)}</div>
          </div>
          <div class="summary-item">
            <div class="label">Monthly Margin</div>
            <div class="value" style="color: #faad14;">${tL(e.totals.monthly_margin)}</div>
          </div>
        </div>
        `:""}
      </div>

      <h2>Model Breakdown</h2>
      ${s.map(e=>{let t;return t=e.result,`
    <div class="model-section">
      <h3>${t.model} ${t.provider?`<span class="provider">(${t.provider})</span>`:""}</h3>
      
      <div class="meta">
        <p><strong>Input Tokens per Request:</strong> ${tM(t.input_tokens)}</p>
        <p><strong>Output Tokens per Request:</strong> ${tM(t.output_tokens)}</p>
        ${t.num_requests_per_day?`<p><strong>Requests per Day:</strong> ${tM(t.num_requests_per_day)}</p>`:""}
        ${t.num_requests_per_month?`<p><strong>Requests per Month:</strong> ${tM(t.num_requests_per_month)}</p>`:""}
      </div>

      <table>
        <tr>
          <th>Cost Type</th>
          <th>Per Request</th>
          ${null!==t.daily_cost?"<th>Daily</th>":""}
          ${null!==t.monthly_cost?"<th>Monthly</th>":""}
        </tr>
        <tr>
          <td>Input Cost</td>
          <td class="cost-value">${tL(t.input_cost_per_request)}</td>
          ${null!==t.daily_cost?`<td class="cost-value">${tL(t.daily_input_cost)}</td>`:""}
          ${null!==t.monthly_cost?`<td class="cost-value">${tL(t.monthly_input_cost)}</td>`:""}
        </tr>
        <tr>
          <td>Output Cost</td>
          <td class="cost-value">${tL(t.output_cost_per_request)}</td>
          ${null!==t.daily_cost?`<td class="cost-value">${tL(t.daily_output_cost)}</td>`:""}
          ${null!==t.monthly_cost?`<td class="cost-value">${tL(t.monthly_output_cost)}</td>`:""}
        </tr>
        <tr>
          <td>Margin/Fee</td>
          <td class="cost-value">${tL(t.margin_cost_per_request)}</td>
          ${null!==t.daily_cost?`<td class="cost-value">${tL(t.daily_margin_cost)}</td>`:""}
          ${null!==t.monthly_cost?`<td class="cost-value">${tL(t.monthly_margin_cost)}</td>`:""}
        </tr>
        <tr class="total-row">
          <td>Total</td>
          <td class="cost-value">${tL(t.cost_per_request)}</td>
          ${null!==t.daily_cost?`<td class="cost-value">${tL(t.daily_cost)}</td>`:""}
          ${null!==t.monthly_cost?`<td class="cost-value">${tL(t.monthly_cost)}</td>`:""}
        </tr>
      </table>
    </div>
  `}).join("")}

      <div class="footer">
        <p>Generated by LiteLLM Pricing Calculator on ${new Date().toLocaleString()}</p>
      </div>
    </body>
    </html>
  `;t.document.write(l),t.document.close(),t.onload=()=>{t.print()}})(e),a(!1)},children:[(0,t.jsx)(tT.FilePdfOutlined,{className:"mr-3 text-red-500"}),"Export as PDF"]}),(0,t.jsxs)("button",{className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>{(e=>{let t=e.entries.filter(e=>null!==e.result),s=[["LLM Multi-Model Cost Estimate Report"],["Generated",new Date().toLocaleString()],[""]];for(let a of(s.push(["COMBINED TOTALS"],["Total Per Request",e.totals.cost_per_request.toString()],["Total Daily",e.totals.daily_cost?.toString()||"-"],["Total Monthly",e.totals.monthly_cost?.toString()||"-"],["Margin Per Request",e.totals.margin_per_request.toString()],["Daily Margin",e.totals.daily_margin?.toString()||"-"],["Monthly Margin",e.totals.monthly_margin?.toString()||"-"],[""]),s.push(["Model","Provider","Input Tokens","Output Tokens","Requests/Day","Requests/Month","Cost/Request","Daily Cost","Monthly Cost","Input Cost/Req","Output Cost/Req","Margin/Req"]),t)){let e=a.result;s.push([e.model,e.provider||"-",e.input_tokens.toString(),e.output_tokens.toString(),e.num_requests_per_day?.toString()||"-",e.num_requests_per_month?.toString()||"-",e.cost_per_request.toString(),e.daily_cost?.toString()||"-",e.monthly_cost?.toString()||"-",e.input_cost_per_request.toString(),e.output_cost_per_request.toString(),e.margin_cost_per_request.toString()])}let a=new Blob([s.map(e=>e.map(e=>`"${e}"`).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),l=window.URL.createObjectURL(a),r=document.createElement("a");r.href=l,r.download=`cost_estimate_multi_model_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(l)})(e),a(!1)},children:[(0,t.jsx)(tP,{className:"mr-3 text-green-600"}),"Export as CSV"]})]})]}):null},tE=e=>null==e?"-":0===e?"$0":e<1e-4?`$${e.toExponential(2)}`:e<1?`$${e.toFixed(4)}`:`$${(0,tC.formatNumberWithCommas)(e,2,!0)}`,tO=({result:e,loading:s,timePeriod:a})=>{let l="day"===a?"Daily":"Monthly",r="day"===a?e.daily_cost:e.monthly_cost,i="day"===a?e.daily_input_cost:e.monthly_input_cost,n="day"===a?e.daily_output_cost:e.monthly_output_cost,o="day"===a?e.daily_margin_cost:e.monthly_margin_cost,d="day"===a?e.num_requests_per_day:e.num_requests_per_month;return(0,t.jsxs)("div",{className:"space-y-3 bg-gray-50 p-4 rounded-lg",children:[s&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-500 text-sm",children:[(0,t.jsx)(eS.Spin,{indicator:(0,t.jsx)(tN.LoadingOutlined,{spin:!0}),size:"small"}),(0,t.jsx)("span",{children:"Updating..."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e_.Text,{className:"text-xs text-gray-500 block",children:"Total/Request"}),(0,t.jsx)(e_.Text,{className:"text-base font-semibold text-blue-600",children:tE(e.cost_per_request)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e_.Text,{className:"text-xs text-gray-500 block",children:"Input Cost"}),(0,t.jsx)(e_.Text,{className:"text-sm",children:tE(e.input_cost_per_request)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e_.Text,{className:"text-xs text-gray-500 block",children:"Output Cost"}),(0,t.jsx)(e_.Text,{className:"text-sm",children:tE(e.output_cost_per_request)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e_.Text,{className:"text-xs text-gray-500 block",children:"Margin Fee"}),(0,t.jsx)(e_.Text,{className:`text-sm ${e.margin_cost_per_request>0?"text-amber-600":""}`,children:tE(e.margin_cost_per_request)})]})]}),null!==r&&(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-4 pt-2 border-t border-gray-200",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(e_.Text,{className:"text-xs text-gray-500 block",children:[l," Total (",null==d?"-":(0,tC.formatNumberWithCommas)(d,0,!0)," req)"]}),(0,t.jsx)(e_.Text,{className:`text-base font-semibold ${"day"===a?"text-green-600":"text-purple-600"}`,children:tE(r)})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(e_.Text,{className:"text-xs text-gray-500 block",children:[l," Input"]}),(0,t.jsx)(e_.Text,{className:"text-sm",children:tE(i)})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(e_.Text,{className:"text-xs text-gray-500 block",children:[l," Output"]}),(0,t.jsx)(e_.Text,{className:"text-sm",children:tE(n)})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(e_.Text,{className:"text-xs text-gray-500 block",children:[l," Margin Fee"]}),(0,t.jsx)(e_.Text,{className:`text-sm ${(o??0)>0?"text-amber-600":""}`,children:tE(o)})]})]}),(e.input_cost_per_token||e.output_cost_per_token)&&(0,t.jsxs)("div",{className:"text-xs text-gray-400 pt-2 border-t border-gray-200",children:["Token Pricing: "," ",e.input_cost_per_token&&(0,t.jsxs)("span",{children:["Input $",(0,tC.formatNumberWithCommas)(1e6*e.input_cost_per_token,2),"/1M"]}),e.input_cost_per_token&&e.output_cost_per_token&&" | ",e.output_cost_per_token&&(0,t.jsxs)("span",{children:["Output $",(0,tC.formatNumberWithCommas)(1e6*e.output_cost_per_token,2),"/1M"]})]})]})},tz=({multiResult:e,timePeriod:s})=>{let[a,l]=(0,i.useState)(new Set),r=e.entries.filter(e=>null!==e.result),n=e.entries.filter(e=>e.loading),o=e.entries.filter(e=>null!==e.error),d=r.length>0,c=n.length>0,u=o.length>0;if(!d&&!c&&!u)return(0,t.jsx)("div",{className:"py-6 text-center border border-dashed border-gray-300 rounded-lg bg-gray-50",children:(0,t.jsx)(e_.Text,{className:"text-gray-500",children:"Select models above to see cost estimates"})});if(!d&&c&&!u)return(0,t.jsxs)("div",{className:"py-6 text-center",children:[(0,t.jsx)(eS.Spin,{indicator:(0,t.jsx)(tN.LoadingOutlined,{spin:!0})}),(0,t.jsx)(e_.Text,{className:"text-gray-500 block mt-2",children:"Calculating costs..."})]});if(!d&&u)return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(_.Divider,{className:"my-4"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(e_.Text,{className:"text-base font-semibold text-gray-900",children:"Cost Estimates"}),c&&(0,t.jsx)(eS.Spin,{indicator:(0,t.jsx)(tN.LoadingOutlined,{spin:!0}),size:"small"})]}),o.map(e=>(0,t.jsxs)("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:[(0,t.jsxs)("span",{className:"font-medium",children:[e.entry.model||"Unknown model",": "]}),e.error]},e.entry.id))]});let x=e.totals.margin_per_request>0,p="day"===s?"Daily":"Monthly",h=[{title:"Model",dataIndex:"model",key:"model",render:(e,s)=>(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium text-sm",children:e}),s.provider&&(0,t.jsx)(b.Tag,{color:"blue",className:"text-xs",children:s.provider}),s.loading&&(0,t.jsx)(eS.Spin,{indicator:(0,t.jsx)(tN.LoadingOutlined,{spin:!0}),size:"small"})]}),s.error&&(0,t.jsxs)("div",{className:"text-xs text-red-600 bg-red-50 px-2 py-1 rounded",children:["⚠️ ",s.error]}),s.hasZeroCost&&!s.error&&(0,t.jsx)("div",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded",children:"⚠️ No pricing data found for this model. Set base_model in config."})]})},{title:"Per Request",dataIndex:"cost_per_request",key:"cost_per_request",align:"right",render:(e,s)=>s.error?(0,t.jsx)("span",{className:"text-gray-400",children:"-"}):(0,t.jsx)("span",{className:"font-mono text-sm",children:tE(e)})},{title:"Margin Fee",dataIndex:"margin_cost_per_request",key:"margin_cost_per_request",align:"right",render:(e,s)=>s.error?(0,t.jsx)("span",{className:"text-gray-400",children:"-"}):(0,t.jsx)("span",{className:`font-mono text-sm ${(e??0)>0?"text-amber-600":"text-gray-400"}`,children:tE(e)})},{title:p,dataIndex:"day"===s?"daily_cost":"monthly_cost",key:"period_cost",align:"right",render:(e,s)=>s.error?(0,t.jsx)("span",{className:"text-gray-400",children:"-"}):(0,t.jsx)("span",{className:"font-mono text-sm",children:tE(e)})},{title:"",key:"expand",width:40,render:(e,s)=>s.error?null:(0,t.jsx)(m.Button,{size:"xs",variant:"light",onClick:()=>{var e;return e=s.id,void l(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},className:"text-gray-400 hover:text-gray-600",children:a.has(s.id)?(0,t.jsx)(tw.DownOutlined,{}):(0,t.jsx)(tk.RightOutlined,{})})}],g=e.entries.filter(e=>e.entry.model).map(e=>({key:e.entry.id,id:e.entry.id,model:e.result?.model||e.entry.model,provider:e.result?.provider,cost_per_request:e.result?.cost_per_request??null,margin_cost_per_request:e.result?.margin_cost_per_request??null,daily_cost:e.result?.daily_cost??null,monthly_cost:e.result?.monthly_cost??null,error:e.error,loading:e.loading,hasZeroCost:e.result&&0===e.result.cost_per_request}));return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(_.Divider,{className:"my-4"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(e_.Text,{className:"text-base font-semibold text-gray-900",children:"Cost Estimates"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[c&&(0,t.jsx)(eS.Spin,{indicator:(0,t.jsx)(tN.LoadingOutlined,{spin:!0}),size:"small"}),(0,t.jsx)(tD,{multiResult:e})]})]}),(0,t.jsxs)(ec.Card,{size:"small",className:"bg-gradient-to-r from-slate-50 to-blue-50 border-slate-200",children:[(0,t.jsxs)(t_.Row,{gutter:[16,8],children:[(0,t.jsx)(tv.Col,{xs:24,sm:12,children:(0,t.jsx)(tg,{title:(0,t.jsx)("span",{className:"text-xs",children:"Total Per Request"}),value:tE(e.totals.cost_per_request),valueStyle:{color:"#1890ff",fontSize:"18px",fontFamily:"monospace"}})}),(0,t.jsx)(tv.Col,{xs:24,sm:12,children:(0,t.jsx)(tg,{title:(0,t.jsxs)("span",{className:"text-xs",children:["Total ",p]}),value:tE("day"===s?e.totals.daily_cost:e.totals.monthly_cost),valueStyle:{color:"day"===s?"#52c41a":"#722ed1",fontSize:"18px",fontFamily:"monospace"}})})]}),x&&(0,t.jsxs)(t_.Row,{gutter:[16,8],className:"mt-3 pt-3 border-t border-slate-200",children:[(0,t.jsxs)(tv.Col,{xs:24,sm:12,children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Margin Fee/Request"}),(0,t.jsx)("div",{className:"text-sm font-mono text-amber-600",children:tE(e.totals.margin_per_request)})]}),(0,t.jsxs)(tv.Col,{xs:24,sm:12,children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[p," Margin Fee"]}),(0,t.jsx)("div",{className:"text-sm font-mono text-amber-600",children:tE("day"===s?e.totals.daily_margin:e.totals.monthly_margin)})]})]})]}),g.length>0&&(0,t.jsx)(tt.Table,{columns:h,dataSource:g,pagination:!1,size:"small",className:"border border-gray-200 rounded-lg",expandable:{expandedRowKeys:Array.from(a),expandedRowRender:e=>{let a=r.find(t=>t.entry.id===e.id);return a?.result?(0,t.jsx)("div",{className:"py-2",children:(0,t.jsx)(tO,{result:a.result,loading:a.loading,timePeriod:s})}):null},showExpandColumn:!1}})]})},tR=()=>({id:`entry-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,model:"",input_tokens:1e3,output_tokens:500,num_requests_per_day:void 0,num_requests_per_month:void 0}),tB=({accessToken:e,models:s})=>{let[a,r]=(0,i.useState)([tR()]),[n,o]=(0,i.useState)("month"),{debouncedFetchForEntry:d,removeEntry:c,getMultiModelResult:m}=function(e){let[t,s]=(0,i.useState)(new Map),a=(0,i.useRef)(new Map),r=(0,i.useCallback)(async t=>{if(!e||!t.model)return void s(e=>{let s=new Map(e);return s.set(t.id,{entry:t,result:null,loading:!1,error:null}),s});s(e=>{let s=new Map(e),a=s.get(t.id);return s.set(t.id,{entry:t,result:a?.result??null,loading:!0,error:null}),s});try{let a=(0,l.getProxyBaseUrl)(),r=a?`${a}/cost/estimate`:"/cost/estimate",i={model:t.model,input_tokens:t.input_tokens||0,output_tokens:t.output_tokens||0,num_requests_per_day:t.num_requests_per_day||null,num_requests_per_month:t.num_requests_per_month||null},n=await fetch(r,{method:"POST",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(n.ok){let e=await n.json();s(s=>{let a=new Map(s);return a.set(t.id,{entry:t,result:e,loading:!1,error:null}),a})}else{let e=await n.json(),a=e.detail?.error||e.detail||"Failed to estimate cost";s(e=>{let s=new Map(e);return s.set(t.id,{entry:t,result:null,loading:!1,error:a}),s})}}catch(e){console.error("Error estimating cost:",e),s(e=>{let s=new Map(e);return s.set(t.id,{entry:t,result:null,loading:!1,error:"Network error"}),s})}},[e]),n=(0,i.useCallback)(e=>{let t=a.current.get(e.id);t&&clearTimeout(t);let s=setTimeout(()=>{r(e)},500);a.current.set(e.id,s)},[r]),o=(0,i.useCallback)(e=>{let t=a.current.get(e);t&&(clearTimeout(t),a.current.delete(e)),s(t=>{let s=new Map(t);return s.delete(e),s})},[]);return(0,i.useEffect)(()=>{let e=a.current;return()=>{e.forEach(e=>clearTimeout(e)),e.clear()}},[]),{debouncedFetchForEntry:n,removeEntry:o,getMultiModelResult:(0,i.useCallback)(e=>{let s=e.map(e=>{let s=t.get(e.id);return{entry:e,result:s?.result??null,loading:s?.loading??!1,error:s?.error??null}}),a=0,l=null,r=null,i=0,n=null,o=null;for(let e of s)e.result&&(a+=e.result.cost_per_request,i+=e.result.margin_cost_per_request,null!==e.result.daily_cost&&(l=(l??0)+e.result.daily_cost),null!==e.result.daily_margin_cost&&(n=(n??0)+e.result.daily_margin_cost),null!==e.result.monthly_cost&&(r=(r??0)+e.result.monthly_cost),null!==e.result.monthly_margin_cost&&(o=(o??0)+e.result.monthly_margin_cost));return{entries:s,totals:{cost_per_request:a,daily_cost:l,monthly_cost:r,margin_per_request:i,daily_margin:n,monthly_margin:o}}},[t])}}(e),u=(0,i.useCallback)((e,t,s)=>{r(a=>{let l=a.map(a=>a.id===e?{...a,[t]:s}:a),r=l.find(t=>t.id===e);return r&&r.model&&d(r),l})},[d]),x=(0,i.useCallback)(e=>{o(e),r(t=>t.map(t=>({...t,num_requests_per_day:"day"===e?t.num_requests_per_day:void 0,num_requests_per_month:"month"===e?t.num_requests_per_month:void 0})))},[]),p=(0,i.useCallback)(()=>{r(e=>[...e,tR()])},[]),h=(0,i.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e)),c(e)},[c]),j=m(a),y=[{title:"Model",dataIndex:"model",key:"model",width:"35%",render:(e,a)=>(0,t.jsx)(g.Select,{showSearch:!0,placeholder:"Select a model",value:a.model||void 0,onChange:e=>u(a.id,"model",e),optionFilterProp:"label",filterOption:(e,t)=>String(t?.label??"").toLowerCase().includes(e.toLowerCase()),options:s.map(e=>({value:e,label:e})),style:{width:"100%"},size:"small"})},{title:"Input Tokens",dataIndex:"input_tokens",key:"input_tokens",width:"18%",render:(e,s)=>(0,t.jsx)(ts.InputNumber,{min:0,value:s.input_tokens,onChange:e=>u(s.id,"input_tokens",e??0),style:{width:"100%"},size:"small",formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")})},{title:"Output Tokens",dataIndex:"output_tokens",key:"output_tokens",width:"18%",render:(e,s)=>(0,t.jsx)(ts.InputNumber,{min:0,value:s.output_tokens,onChange:e=>u(s.id,"output_tokens",e??0),style:{width:"100%"},size:"small",formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")})},{title:`Requests/${"day"===n?"Day":"Month"}`,dataIndex:"day"===n?"num_requests_per_day":"num_requests_per_month",key:"num_requests",width:"20%",render:(e,s)=>(0,t.jsx)(ts.InputNumber,{min:0,value:"day"===n?s.num_requests_per_day:s.num_requests_per_month,onChange:e=>u(s.id,"day"===n?"num_requests_per_day":"num_requests_per_month",e??void 0),style:{width:"100%"},size:"small",placeholder:"-",formatter:e=>e?`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","):""})},{title:"",key:"actions",width:50,render:(e,s)=>(0,t.jsx)(A.Button,{type:"text",icon:(0,t.jsx)(eh.DeleteOutlined,{}),onClick:()=>h(s.id),disabled:1===a.length,danger:!0,size:"small"})}];return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"flex items-center justify-end mb-2",children:(0,t.jsxs)(f.Radio.Group,{value:n,onChange:e=>x(e.target.value),size:"small",optionType:"button",buttonStyle:"solid",children:[(0,t.jsx)(f.Radio.Button,{value:"day",children:"Per Day"}),(0,t.jsx)(f.Radio.Button,{value:"month",children:"Per Month"})]})}),(0,t.jsx)(tt.Table,{columns:y,dataSource:a,rowKey:"id",pagination:!1,size:"small",footer:()=>(0,t.jsx)(A.Button,{type:"dashed",onClick:p,icon:(0,t.jsx)(P.PlusOutlined,{}),className:"w-full",children:"Add Another Model"})}),(0,t.jsx)(tz,{multiResult:j,timePeriod:n})]})};var tq=e.i(270377),t$=e.i(778917),tU=e.i(664659);let tV=({items:e,children:s="Docs",className:a=""})=>{let[l,r]=(0,i.useState)(!1),n=(0,i.useRef)(null);return(0,i.useEffect)(()=>{let e=e=>{n.current&&!n.current.contains(e.target)&&r(!1)};return l&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[l]),(0,t.jsxs)("div",{className:`relative inline-block ${a}`,ref:n,children:[(0,t.jsxs)("button",{type:"button",onClick:()=>r(!l),className:"inline-flex items-center gap-1 text-gray-500 hover:text-gray-700 text-xs transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded px-2 py-1","aria-expanded":l,"aria-haspopup":"true",children:[(0,t.jsx)("span",{children:s}),(0,t.jsx)(tU.ChevronDown,{className:`h-3 w-3 transition-transform ${l?"rotate-180":""}`,"aria-hidden":"true"})]}),l&&(0,t.jsx)("div",{className:"absolute right-0 mt-1 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:e.map((e,s)=>(0,t.jsxs)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>r(!1),children:[(0,t.jsx)("span",{children:e.label}),(0,t.jsx)(t$.ExternalLink,{className:"h-3.5 w-3.5 text-gray-400 flex-shrink-0 ml-2","aria-hidden":"true"})]},s))})]})};var tG=e.i(673709);let tH=()=>{let[e,s]=(0,i.useState)(""),[a,l]=(0,i.useState)(""),r=(0,i.useMemo)(()=>{let t=parseFloat(e),s=parseFloat(a);if(isNaN(t)||isNaN(s)||0===t||0===s)return null;let l=t+s,r=s/l*100;return{originalCost:l.toFixed(10),finalCost:t.toFixed(10),discountAmount:s.toFixed(10),discountPercentage:r.toFixed(2)}},[e,a]);return(0,t.jsxs)("div",{className:"space-y-4 pt-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e_.Text,{className:"font-medium text-gray-900 text-sm mb-1",children:"Cost Calculation"}),(0,t.jsxs)(e_.Text,{className:"text-xs text-gray-600",children:["Discounts are applied to provider costs: ",(0,t.jsx)("code",{className:"bg-gray-100 px-1.5 py-0.5 rounded text-xs",children:"final_cost = base_cost × (1 - discount%/100)"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e_.Text,{className:"font-medium text-gray-900 text-sm mb-1",children:"Example"}),(0,t.jsx)(e_.Text,{className:"text-xs text-gray-600",children:"A 5% discount on a $10.00 request results in: $10.00 × (1 - 0.05) = $9.50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e_.Text,{className:"font-medium text-gray-900 text-sm mb-1",children:"Valid Range"}),(0,t.jsx)(e_.Text,{className:"text-xs text-gray-600",children:"Discount percentages must be between 0% and 100%"})]}),(0,t.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,t.jsx)(e_.Text,{className:"font-medium text-gray-900 text-sm mb-2",children:"Validating Discounts"}),(0,t.jsx)(e_.Text,{className:"text-xs text-gray-600 mb-3",children:"Make a test request and check the response headers to verify discounts are applied:"}),(0,t.jsx)(tG.default,{language:"bash",code:`curl -X POST -i http://your-proxy:4000/chat/completions \\
  -H "Content-Type: application/json" \\
  -H "Authorization: Bearer sk-1234" \\
  -d '{
    "model": "gemini/gemini-2.5-pro",
    "messages": [{"role": "user", "content": "Hello"}]
  }'`}),(0,t.jsx)(e_.Text,{className:"text-xs text-gray-600 mt-3 mb-2",children:"Look for these headers in the response:"}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs font-mono text-gray-800 whitespace-nowrap",children:"x-litellm-response-cost"}),(0,t.jsx)(e_.Text,{className:"text-xs text-gray-600",children:"Final cost after discount"})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs font-mono text-gray-800 whitespace-nowrap",children:"x-litellm-response-cost-original"}),(0,t.jsx)(e_.Text,{className:"text-xs text-gray-600",children:"Original cost before discount"})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs font-mono text-gray-800 whitespace-nowrap",children:"x-litellm-response-cost-discount-amount"}),(0,t.jsx)(e_.Text,{className:"text-xs text-gray-600",children:"Amount discounted"})]})]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,t.jsx)(e_.Text,{className:"font-medium text-gray-900 text-sm mb-3",children:"Discount Calculator"}),(0,t.jsx)(e_.Text,{className:"text-xs text-gray-600 mb-3",children:"Enter values from your response headers to verify the discount:"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Response Cost (x-litellm-response-cost)"}),(0,t.jsx)(eV.TextInput,{placeholder:"0.0171938125",value:e,onValueChange:s,className:"text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Discount Amount (x-litellm-response-cost-discount-amount)"}),(0,t.jsx)(eV.TextInput,{placeholder:"0.0009049375",value:a,onValueChange:l,className:"text-sm"})]})]}),r&&(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,t.jsx)(e_.Text,{className:"text-sm font-medium text-blue-900 mb-2",children:"Calculated Results"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(e_.Text,{className:"text-xs text-blue-800",children:"Original Cost:"}),(0,t.jsxs)("code",{className:"text-xs font-mono text-blue-900",children:["$",r.originalCost]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(e_.Text,{className:"text-xs text-blue-800",children:"Final Cost:"}),(0,t.jsxs)("code",{className:"text-xs font-mono text-blue-900",children:["$",r.finalCost]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(e_.Text,{className:"text-xs text-blue-800",children:"Discount Amount:"}),(0,t.jsxs)("code",{className:"text-xs font-mono text-blue-900",children:["$",r.discountAmount]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-blue-300",children:[(0,t.jsx)(e_.Text,{className:"text-xs font-semibold text-blue-900",children:"Discount Applied:"}),(0,t.jsxs)(e_.Text,{className:"text-sm font-bold text-blue-900",children:[r.discountPercentage,"%"]})]})]})]})]})]})};var tK=e.i(689020);let tW=[{label:"Custom pricing for models",href:"https://docs.litellm.ai/docs/proxy/custom_pricing"},{label:"Spend tracking",href:"https://docs.litellm.ai/docs/proxy/cost_tracking"}],tQ=({userID:e,userRole:s,accessToken:a})=>{let[r,n]=(0,i.useState)(void 0),[o,d]=(0,i.useState)(""),[c,x]=(0,i.useState)(!0),[h,g]=(0,i.useState)(!1),[j,y]=(0,i.useState)(!1),[f,b]=(0,i.useState)(void 0),[_,v]=(0,i.useState)("percentage"),[N,w]=(0,i.useState)(""),[k,C]=(0,i.useState)(""),[S,T]=(0,i.useState)([]),[I]=p.Form.useForm(),[F]=p.Form.useForm(),[A,P]=u.Modal.useModal(),L="proxy_admin"===s||"Admin"===s,{discountConfig:M,fetchDiscountConfig:D,handleAddProvider:E,handleRemoveProvider:O,handleDiscountChange:z}=function({accessToken:e}){let[t,s]=(0,i.useState)({}),a=(0,i.useCallback)(async()=>{try{let t=(0,l.getProxyBaseUrl)(),a=t?`${t}/config/cost_discount_config`:"/config/cost_discount_config",r=await fetch(a,{method:"GET",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"}});if(r.ok){let e=await r.json();s(e.values||{})}else console.error("Failed to fetch discount config")}catch(e){console.error("Error fetching discount config:",e),eM.default.fromBackend("Failed to fetch discount configuration")}},[e]),r=(0,i.useCallback)(async t=>{try{let s=(0,l.getProxyBaseUrl)(),r=s?`${s}/config/cost_discount_config`:"/config/cost_discount_config",i=await fetch(r,{method:"PATCH",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(i.ok)eM.default.success("Discount configuration updated successfully"),await a();else{let e=await i.json(),t=e.detail?.error||e.detail||"Failed to update settings";eM.default.fromBackend(t)}}catch(e){console.error("Error updating discount config:",e),eM.default.fromBackend("Failed to update discount configuration")}},[e,a]),n=(0,i.useCallback)(async(e,a)=>{if(!e||!a)return eM.default.fromBackend("Please select a provider and enter discount percentage"),!1;let l=parseFloat(a);if(isNaN(l)||l<0||l>100)return eM.default.fromBackend("Discount must be between 0% and 100%"),!1;let i=e6(e);if(!i)return eM.default.fromBackend("Invalid provider selected"),!1;if(t[i])return eM.default.fromBackend(`Discount for ${e4.Providers[e]} already exists. Edit it in the table above.`),!1;let n={...t,[i]:l/100};return s(n),await r(n),!0},[t,r]),o=(0,i.useCallback)(async e=>{let a={...t};delete a[e],s(a),await r(a)},[t,r]),d=(0,i.useCallback)(async(e,a)=>{let l=parseFloat(a);if(!isNaN(l)&&l>=0&&l<=1){let a={...t,[e]:l};s(a),await r(a)}},[t,r]);return{discountConfig:t,setDiscountConfig:s,fetchDiscountConfig:a,saveDiscountConfig:r,handleAddProvider:n,handleRemoveProvider:o,handleDiscountChange:d}}({accessToken:a}),{marginConfig:R,fetchMarginConfig:B,handleAddMargin:q,handleRemoveMargin:$,handleMarginChange:U}=function({accessToken:e}){let[t,s]=(0,i.useState)({}),a=(0,i.useCallback)(async()=>{try{let t=(0,l.getProxyBaseUrl)(),a=t?`${t}/config/cost_margin_config`:"/config/cost_margin_config",r=await fetch(a,{method:"GET",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"}});if(r.ok){let e=await r.json();s(e.values||{})}else console.error("Failed to fetch margin config")}catch(e){console.error("Error fetching margin config:",e),eM.default.fromBackend("Failed to fetch margin configuration")}},[e]),r=(0,i.useCallback)(async t=>{try{let s=(0,l.getProxyBaseUrl)(),r=s?`${s}/config/cost_margin_config`:"/config/cost_margin_config",i=await fetch(r,{method:"PATCH",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(i.ok)eM.default.success("Margin configuration updated successfully"),await a();else{let e=await i.json(),t=e.detail?.error||e.detail||"Failed to update settings";eM.default.fromBackend(t)}}catch(e){console.error("Error updating margin config:",e),eM.default.fromBackend("Failed to update margin configuration")}},[e,a]),n=(0,i.useCallback)(async e=>{let a,l,{selectedProvider:i,marginType:n,percentageValue:o,fixedAmountValue:d}=e;if(!i)return eM.default.fromBackend("Please select a provider"),!1;if("global"===i)a="global";else{let e=e6(i);if(!e)return eM.default.fromBackend("Invalid provider selected"),!1;a=e}if(t[a]){let e="global"===a?"Global":e4.Providers[i];return eM.default.fromBackend(`Margin for ${e} already exists. Edit it in the table above.`),!1}if("percentage"===n){let e=parseFloat(o);if(isNaN(e)||e<0||e>1e3)return eM.default.fromBackend("Percentage must be between 0% and 1000%"),!1;l=e/100}else{let e=parseFloat(d);if(isNaN(e)||e<0)return eM.default.fromBackend("Fixed amount must be non-negative"),!1;l={fixed_amount:e}}let c={...t,[a]:l};return s(c),await r(c),!0},[t,r]),o=(0,i.useCallback)(async e=>{let a={...t};delete a[e],s(a),await r(a)},[t,r]),d=(0,i.useCallback)(async(e,a)=>{let l={...t,[e]:a};s(l),await r(l)},[t,r]);return{marginConfig:t,setMarginConfig:s,fetchMarginConfig:a,saveMarginConfig:r,handleAddMargin:n,handleRemoveMargin:o,handleMarginChange:d}}({accessToken:a});(0,i.useEffect)(()=>{a&&(Promise.all([D(),B()]).finally(()=>{x(!1)}),(async()=>{try{let e=await (0,tK.fetchAvailableModels)(a);T(e.map(e=>e.model_group))}catch(e){console.error("Error fetching models:",e)}})())},[a,D,B]);let V=async()=>{await E(r,o)&&(n(void 0),d(""),g(!1))},G=async(e,s)=>{A.confirm({title:"Remove Provider Discount",icon:(0,t.jsx)(tq.ExclamationCircleOutlined,{}),content:`Are you sure you want to remove the discount for ${s}?`,okText:"Remove",okType:"danger",cancelText:"Cancel",onOk:()=>O(e)})},H=async()=>{await q({selectedProvider:f,marginType:_,percentageValue:N,fixedAmountValue:k})&&(b(void 0),w(""),C(""),v("percentage"),y(!1))},K=async(e,s)=>{A.confirm({title:"Remove Provider Margin",icon:(0,t.jsx)(tq.ExclamationCircleOutlined,{}),content:`Are you sure you want to remove the margin for ${s}?`,okText:"Remove",okType:"danger",cancelText:"Cancel",onOk:()=>$(e)})};return a?(0,t.jsxs)("div",{className:"w-full p-8",children:[P,(0,t.jsx)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-6",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eb.Title,{children:"Cost Tracking Settings"}),(0,t.jsx)(tV,{items:tW})]}),(0,t.jsx)(e_.Text,{className:"text-gray-500 mt-1",children:"Configure cost discounts and margins for different LLM providers. Changes are saved automatically."})]})}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full space-y-4",children:[L&&(0,t.jsxs)(eq.Accordion,{children:[(0,t.jsx)(e$.AccordionHeader,{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex flex-col items-start w-full",children:[(0,t.jsx)(e_.Text,{className:"text-lg font-semibold text-gray-900",children:"Provider Discounts"}),(0,t.jsx)(e_.Text,{className:"text-sm text-gray-500 mt-1",children:"Apply percentage-based discounts to reduce costs for specific providers"})]})}),(0,t.jsx)(eU.AccordionBody,{className:"px-0",children:(0,t.jsxs)(eN.TabGroup,{children:[(0,t.jsxs)(ew.TabList,{className:"px-6 pt-4",children:[(0,t.jsx)(ev.Tab,{children:"Discounts"}),(0,t.jsx)(ev.Tab,{children:"Test It"})]}),(0,t.jsxs)(eC.TabPanels,{children:[(0,t.jsx)(ek.TabPanel,{children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("div",{className:"flex justify-end mb-4",children:(0,t.jsx)(m.Button,{onClick:()=>g(!0),children:"+ Add Provider Discount"})}),c?(0,t.jsx)("div",{className:"py-12 text-center",children:(0,t.jsx)(e_.Text,{className:"text-gray-500",children:"Loading configuration..."})}):Object.keys(M).length>0?(0,t.jsx)(e8,{discountConfig:M,onDiscountChange:z,onRemoveProvider:G}):(0,t.jsxs)("div",{className:"py-16 px-6 text-center",children:[(0,t.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsx)(e_.Text,{className:"text-gray-700 font-medium mb-2",children:"No provider discounts configured"}),(0,t.jsx)(e_.Text,{className:"text-gray-500 text-sm",children:'Click "Add Provider Discount" to get started'})]})]})}),(0,t.jsx)(ek.TabPanel,{children:(0,t.jsx)("div",{className:"px-6 pb-4",children:(0,t.jsx)(tH,{})})})]})]})})]}),L&&(0,t.jsxs)(eq.Accordion,{children:[(0,t.jsx)(e$.AccordionHeader,{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex flex-col items-start w-full",children:[(0,t.jsx)(e_.Text,{className:"text-lg font-semibold text-gray-900",children:"Fee/Price Margin"}),(0,t.jsx)(e_.Text,{className:"text-sm text-gray-500 mt-1",children:"Add fees or margins to LLM costs for internal billing and cost recovery"})]})}),(0,t.jsx)(eU.AccordionBody,{className:"px-0",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("div",{className:"flex justify-end mb-4",children:(0,t.jsx)(m.Button,{onClick:()=>y(!0),children:"+ Add Provider Margin"})}),c?(0,t.jsx)("div",{className:"py-12 text-center",children:(0,t.jsx)(e_.Text,{className:"text-gray-500",children:"Loading configuration..."})}):Object.keys(R).length>0?(0,t.jsx)(e9,{marginConfig:R,onMarginChange:U,onRemoveProvider:K}):(0,t.jsxs)("div",{className:"py-16 px-6 text-center",children:[(0,t.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsx)(e_.Text,{className:"text-gray-700 font-medium mb-2",children:"No provider margins configured"}),(0,t.jsx)(e_.Text,{className:"text-gray-500 text-sm",children:'Click "Add Provider Margin" to get started'})]})]})})]}),(0,t.jsxs)(eq.Accordion,{defaultOpen:!0,children:[(0,t.jsx)(e$.AccordionHeader,{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex flex-col items-start w-full",children:[(0,t.jsx)(e_.Text,{className:"text-lg font-semibold text-gray-900",children:"Pricing Calculator"}),(0,t.jsx)(e_.Text,{className:"text-sm text-gray-500 mt-1",children:"Estimate LLM costs based on expected token usage and request volume"})]})}),(0,t.jsx)(eU.AccordionBody,{className:"px-0",children:(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)(tB,{accessToken:a,models:S})})})]})]}),(0,t.jsx)(u.Modal,{title:(0,t.jsx)("div",{className:"flex items-center space-x-3 pb-4 border-b border-gray-100",children:(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add Provider Discount"})}),open:h,width:1e3,onCancel:()=>{g(!1),I.resetFields(),n(void 0),d("")},footer:null,className:"top-8",styles:{body:{padding:"24px"},header:{padding:"24px 24px 0 24px",border:"none"}},children:(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)(e_.Text,{className:"text-sm text-gray-600 mb-6",children:"Select a provider and set its discount percentage. Enter a value between 0% and 100% (e.g., 5 for a 5% discount)."}),(0,t.jsx)(p.Form,{form:I,onFinish:()=>{V()},layout:"vertical",className:"space-y-6",children:(0,t.jsx)(e7,{discountConfig:M,selectedProvider:r,newDiscount:o,onProviderChange:n,onDiscountChange:d,onAddProvider:V})})]})}),(0,t.jsx)(u.Modal,{title:(0,t.jsx)("div",{className:"flex items-center space-x-3 pb-4 border-b border-gray-100",children:(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add Provider Margin"})}),open:j,width:1e3,onCancel:()=>{y(!1),F.resetFields(),b(void 0),w(""),C(""),v("percentage")},footer:null,className:"top-8",styles:{body:{padding:"24px"},header:{padding:"24px 24px 0 24px",border:"none"}},children:(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)(e_.Text,{className:"text-sm text-gray-600 mb-6",children:'Select a provider (or "Global" for all providers) and configure the margin. You can use percentage-based or fixed amount.'}),(0,t.jsx)(p.Form,{form:F,layout:"vertical",className:"space-y-6",children:(0,t.jsx)(te,{marginConfig:R,selectedProvider:f,marginType:_,percentageValue:N,fixedAmountValue:k,onProviderChange:b,onMarginTypeChange:v,onPercentageChange:w,onFixedAmountChange:C,onAddProvider:H})})]})})]}):null};var tY=e.i(226898),tJ=e.i(973706),tX=e.i(447566),tZ=e.i(602073),t0=e.i(313603),t1=e.i(266027),t2=e.i(309426),t4=e.i(350967),t5=e.i(653496),t6=e.i(149192),t3=e.i(788191);let t8=`Evaluate whether this guardrail's decision was correct.
Analyze the user input, the guardrail action taken, and determine if it was appropriate.

Consider:
— Was the user's intent genuinely harmful or policy-violating?
— Was the guardrail's action (block / flag / pass) appropriate?
— Could this be a false positive or false negative?

Return a structured verdict with confidence and justification.`,t7=`{
  "verdict": "correct" | "false_positive" | "false_negative",
  "confidence": 0.0,
  "justification": "string",
  "risk_category": "string",
  "suggested_action": "keep" | "adjust threshold" | "add allowlist"
}
`;function t9({open:e,onClose:s,guardrailName:a,accessToken:l,onRunEvaluation:r}){let[n,o]=(0,i.useState)(t8),[d,c]=(0,i.useState)(t7),[m,x]=(0,i.useState)(null),[p,h]=(0,i.useState)([]),[y,f]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(!e||!l)return void h([]);let t=!1;return f(!0),(0,tK.fetchAvailableModels)(l).then(e=>{t||h(e)}).catch(()=>{t||h([])}).finally(()=>{t||f(!1)}),()=>{t=!0}},[e,l]);let b=p.map(e=>({value:e.model_group,label:e.model_group}));return(0,t.jsxs)(u.Modal,{title:"Evaluation Settings",open:e,onCancel:s,width:640,footer:null,closeIcon:(0,t.jsx)(t6.CloseOutlined,{}),destroyOnClose:!0,children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:a?`Configure AI evaluation for ${a}`:"Configure AI evaluation for re-running on logs"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1.5",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Evaluation Prompt"}),(0,t.jsx)("button",{type:"button",onClick:()=>o(t8),className:"text-xs text-indigo-600 hover:text-indigo-700",children:"Reset to default"})]}),(0,t.jsx)(j.Input.TextArea,{value:n,onChange:e=>o(e.target.value),rows:6,className:"font-mono text-sm"}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"System prompt sent to the evaluation model. Output is structured via response_format."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Response Schema"}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"response_format: json_schema"}),(0,t.jsx)(j.Input.TextArea,{value:d,onChange:e=>c(e.target.value),rows:6,className:"font-mono text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Model"}),(0,t.jsx)(g.Select,{placeholder:y?"Loading models…":"Select a model",value:m??void 0,onChange:x,options:b,style:{width:"100%"},showSearch:!0,optionFilterProp:"label",loading:y,notFoundContent:l?"No models available":"Sign in to see models"})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2 mt-6 pt-4 border-t border-gray-100",children:[(0,t.jsx)(A.Button,{onClick:s,children:"Cancel"}),(0,t.jsx)(A.Button,{type:"primary",icon:(0,t.jsx)(t3.PlayCircleOutlined,{}),onClick:()=>{m&&(r?.({prompt:n,schema:d,model:m}),s())},disabled:!m,children:"Run Evaluation"})]})]})}var se=e.i(245704),st=e.i(166540);e.i(3565);var ss=e.i(502626);let sa={blocked:{icon:t6.CloseOutlined,color:"text-red-600",bg:"bg-red-50",border:"border-red-200",label:"Blocked"},passed:{icon:se.CheckCircleOutlined,color:"text-green-600",bg:"bg-green-50",border:"border-green-200",label:"Passed"},flagged:{icon:ep.WarningOutlined,color:"text-amber-600",bg:"bg-amber-50",border:"border-amber-200",label:"Flagged"}};function sl({guardrailName:e,filterAction:s="all",logs:a=[],logsLoading:r=!1,totalLogs:n,accessToken:o=null,startDate:d="",endDate:c=""}){let[m,u]=(0,i.useState)(10),[x,p]=(0,i.useState)(s),[h,g]=(0,i.useState)(null),[j,y]=(0,i.useState)(!1),f=a.filter(e=>"all"===x||e.action===x).slice(0,m),b=n??a.length,_=d?(0,st.default)(d).utc().format("YYYY-MM-DD HH:mm:ss"):(0,st.default)().subtract(24,"hours").utc().format("YYYY-MM-DD HH:mm:ss"),v=c?(0,st.default)(c).utc().endOf("day").format("YYYY-MM-DD HH:mm:ss"):(0,st.default)().utc().format("YYYY-MM-DD HH:mm:ss"),{data:N}=(0,t1.useQuery)({queryKey:["spend-log-by-request",h,_,v],queryFn:async()=>o&&h?await (0,l.uiSpendLogsCall)({accessToken:o,start_date:_,end_date:v,page:1,page_size:10,params:{request_id:h}}):null,enabled:!!(o&&h&&j)}),w=N?.data?.[0]??null;return(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:e?`Logs — ${e}`:"Request Logs"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:r?"Loading…":a.length>0?`Showing ${f.length} of ${b} entries`:"No logs for this period. Select a guardrail and date range."})]}),a.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"flex items-center gap-1",children:["all","blocked","flagged","passed"].map(e=>(0,t.jsx)(A.Button,{type:x===e?"primary":"default",size:"small",onClick:()=>p(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,t.jsx)("div",{className:"h-4 w-px bg-gray-200"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500 mr-1",children:"Sample:"}),[10,50,100].map(e=>(0,t.jsx)(A.Button,{type:m===e?"primary":"default",size:"small",onClick:()=>u(e),children:e},e))]})]})]})}),r&&(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(eS.Spin,{})}),!r&&0===f.length&&(0,t.jsx)("div",{className:"py-12 text-center text-sm text-gray-500",children:"No logs to display. Adjust filters or date range."}),!r&&f.length>0&&(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:f.map(e=>{let s=sa[e.action],a=s.icon;return(0,t.jsxs)("button",{type:"button",onClick:()=>{g(e.id),y(!0)},className:"w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors flex items-start gap-3",children:[(0,t.jsx)(a,{className:`w-4 h-4 mt-0.5 flex-shrink-0 ${s.color}`}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[(0,t.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 text-xs font-medium rounded border ${s.bg} ${s.color} ${s.border}`,children:s.label}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:e.timestamp}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:"·"}),e.model&&(0,t.jsx)("span",{className:"text-xs text-gray-500",children:e.model})]}),(0,t.jsx)("p",{className:"text-sm text-gray-800 truncate",children:e.input_snippet??e.input??"—"})]}),(0,t.jsx)(tw.DownOutlined,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-1"})]},e.id)})}),(0,t.jsx)(ss.LogDetailsDrawer,{open:j,onClose:()=>{y(!1),g(null)},logEntry:w,accessToken:o,allLogs:w?[w]:[],startTime:_})]})}function sr({label:e,value:s,valueColor:a="text-gray-900",icon:l,subtitle:r}){return(0,t.jsxs)("div",{className:"h-full bg-white border border-gray-200 rounded-lg p-5 flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-600",children:e}),l&&(0,t.jsx)("span",{className:"text-gray-400",children:l})]}),(0,t.jsx)("div",{className:`text-3xl font-semibold ${a} tracking-tight`,children:s}),r&&(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:r})]})}let si={healthy:{bg:"bg-green-50",text:"text-green-700",dot:"bg-green-500"},warning:{bg:"bg-amber-50",text:"text-amber-700",dot:"bg-amber-500"},critical:{bg:"bg-red-50",text:"text-red-700",dot:"bg-red-500"}};function sn({guardrailId:e,onBack:s,accessToken:a=null,startDate:r,endDate:n}){let[o,d]=(0,i.useState)("overview"),[c,m]=(0,i.useState)(!1),[u,x]=(0,i.useState)(1),{data:p,isLoading:h,error:g}=(0,t1.useQuery)({queryKey:["guardrails-usage-detail",e,r,n],queryFn:()=>(0,l.getGuardrailsUsageDetail)(a,e,r,n),enabled:!!a&&!!e}),{data:j,isLoading:y}=(0,t1.useQuery)({queryKey:["guardrails-usage-logs",e,u,50],queryFn:()=>(0,l.getGuardrailsUsageLogs)(a,{guardrailId:e,page:u,pageSize:50,startDate:r,endDate:n}),enabled:!!a&&!!e}),f=(0,i.useMemo)(()=>(j?.logs??[]).map(e=>({id:e.id,timestamp:e.timestamp,action:e.action,score:e.score,model:e.model,input_snippet:e.input_snippet,output_snippet:e.output_snippet,reason:e.reason})),[j?.logs]),b=p?{name:p.guardrail_name,description:p.description??"",status:p.status,provider:p.provider,type:p.type,requestsEvaluated:p.requestsEvaluated,failRate:p.failRate,avgScore:p.avgScore,avgLatency:p.avgLatency}:{name:e,description:"",status:"healthy",provider:"—",type:"—",requestsEvaluated:0,failRate:0,avgScore:void 0,avgLatency:void 0},_=si[b.status]??si.healthy;return h&&!p?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(eS.Spin,{size:"large"})}):g&&!p?(0,t.jsxs)("div",{children:[(0,t.jsx)(A.Button,{type:"link",icon:(0,t.jsx)(tX.ArrowLeftOutlined,{}),onClick:s,className:"pl-0 mb-4",children:"Back to Overview"}),(0,t.jsx)("p",{className:"text-red-600",children:"Failed to load guardrail details."})]}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)(A.Button,{type:"link",icon:(0,t.jsx)(tX.ArrowLeftOutlined,{}),onClick:s,className:"pl-0 mb-4",children:"Back to Overview"}),(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,t.jsx)(tZ.SafetyOutlined,{className:"text-xl text-gray-400"}),(0,t.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:b.name}),(0,t.jsxs)("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-0.5 text-xs font-medium rounded-full ${_.bg} ${_.text}`,children:[(0,t.jsx)("span",{className:`w-1.5 h-1.5 rounded-full ${_.dot}`}),b.status.charAt(0).toUpperCase()+b.status.slice(1)]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 ml-8",children:b.description})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-1 text-xs font-medium rounded-md bg-indigo-50 text-indigo-700 border border-indigo-200",children:b.provider}),(0,t.jsx)(A.Button,{type:"default",icon:(0,t.jsx)(t0.SettingOutlined,{}),onClick:()=>m(!0),title:"Evaluation settings"})]})]})]}),(0,t.jsx)(t5.Tabs,{activeKey:o,onChange:d,items:[{key:"overview",label:"Overview"},{key:"logs",label:"Logs"}]}),"overview"===o&&(0,t.jsxs)("div",{className:"space-y-6 mt-4",children:[(0,t.jsxs)(t4.Grid,{numItems:2,numItemsMd:5,className:"gap-4",children:[(0,t.jsx)(t2.Col,{children:(0,t.jsx)(sr,{label:"Requests Evaluated",value:b.requestsEvaluated.toLocaleString()})}),(0,t.jsx)(t2.Col,{children:(0,t.jsx)(sr,{label:"Fail Rate",value:`${b.failRate}%`,valueColor:b.failRate>15?"text-red-600":b.failRate>5?"text-amber-600":"text-green-600",subtitle:`${Math.round(b.requestsEvaluated*b.failRate/100).toLocaleString()} blocked`,icon:b.failRate>15?(0,t.jsx)(ep.WarningOutlined,{className:"text-red-400"}):void 0})}),(0,t.jsx)(t2.Col,{children:(0,t.jsx)(sr,{label:"Avg. latency added",value:null!=b.avgLatency?`${Math.round(b.avgLatency)}ms`:"—",valueColor:null!=b.avgLatency?b.avgLatency>150?"text-red-600":b.avgLatency>50?"text-amber-600":"text-green-600":"text-gray-500",subtitle:null!=b.avgLatency?"Per request (avg)":"No data"})})]}),(0,t.jsx)(sl,{guardrailName:b.name,filterAction:"all",logs:f,logsLoading:y,totalLogs:j?.total??0,accessToken:a,startDate:r,endDate:n})]}),"logs"===o&&(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(sl,{guardrailName:b.name,logs:f,logsLoading:y,totalLogs:j?.total??0,accessToken:a,startDate:r,endDate:n})}),(0,t.jsx)(t9,{open:c,onClose:()=>m(!1),guardrailName:b.name,accessToken:a})]})}let so={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917 211.1l-199.2 24c-6.6.8-9.4 8.9-4.7 13.6l59.3 59.3-226 226-101.8-101.7c-6.3-6.3-16.4-6.2-22.6 0L100.3 754.1a8.03 8.03 0 000 11.3l45 45.2c3.1 3.1 8.2 3.1 11.3 0L433.3 534 535 635.7c6.3 6.2 16.4 6.2 22.6 0L829 364.5l59.3 59.3a8.01 8.01 0 0013.6-4.7l24-199.2c.7-5.1-3.7-9.5-8.9-8.8z"}}]},name:"rise",theme:"outlined"};var sd=i.forwardRef(function(e,t){return i.createElement(tA.default,(0,tI.default)({},e,{ref:t,icon:so}))}),sc=e.i(584935);function sm({data:e}){let s=e&&e.length>0?e:[];return(0,t.jsxs)(ef.Card,{className:"bg-white border border-gray-200",children:[(0,t.jsx)(eb.Title,{className:"text-base font-semibold text-gray-900 mb-4",children:"Request Outcomes Over Time"}),(0,t.jsx)("div",{className:"h-80 min-h-[280px]",children:s.length>0?(0,t.jsx)(sc.BarChart,{data:s,index:"date",categories:["passed","blocked"],colors:["green","red"],valueFormatter:e=>e.toLocaleString(),yAxisWidth:48,showLegend:!0,stack:!0}):(0,t.jsx)("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"No chart data for this period"})})]})}let su={Bedrock:"bg-orange-100 text-orange-700 border-orange-200","Google Cloud":"bg-sky-100 text-sky-700 border-sky-200",LiteLLM:"bg-indigo-100 text-indigo-700 border-indigo-200",Custom:"bg-gray-100 text-gray-600 border-gray-200"};function sx({accessToken:e=null,startDate:s,endDate:a,onSelectGuardrail:r}){let[n,o]=(0,i.useState)("failRate"),[d,c]=(0,i.useState)("desc"),[m,u]=(0,i.useState)(!1),{data:x,isLoading:p,error:h}=(0,t1.useQuery)({queryKey:["guardrails-usage-overview",s,a],queryFn:()=>(0,l.getGuardrailsUsageOverview)(e,s,a),enabled:!!e}),g=x?.rows??[],j=(0,i.useMemo)(()=>{let e,t,s,a;return x?{totalRequests:x.totalRequests??0,totalBlocked:x.totalBlocked??0,passRate:String(x.passRate??0),avgLatency:g.length?Math.round(g.reduce((e,t)=>e+(t.avgLatency??0),0)/g.length):0,count:g.length}:(e=g.reduce((e,t)=>e+t.requestsEvaluated,0),t=g.reduce((e,t)=>e+Math.round(t.requestsEvaluated*t.failRate/100),0),s=e>0?((1-t/e)*100).toFixed(1):"0",{totalRequests:e,totalBlocked:t,passRate:s,avgLatency:(a=g.filter(e=>null!=e.avgLatency)).length>0?Math.round(a.reduce((e,t)=>e+(t.avgLatency??0),0)/a.length):0,count:g.length})},[x,g]),y=x?.chart,f=(0,i.useMemo)(()=>[...g].sort((e,t)=>{let s="desc"===d?-1:1,a=e[n]??0,l=t[n]??0;return(Number(a)-Number(l))*s}),[g,n,d]),b=[{title:"Guardrail",dataIndex:"name",key:"name",render:(e,s)=>(0,t.jsx)("button",{type:"button",className:"text-sm font-medium text-gray-900 hover:text-indigo-600 text-left",onClick:()=>r(s.id),children:e})},{title:"Provider",dataIndex:"provider",key:"provider",render:e=>(0,t.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 text-xs font-medium rounded border ${su[e]??su.Custom}`,children:e})},{title:"Requests",dataIndex:"requestsEvaluated",key:"requestsEvaluated",align:"right",sorter:!0,sortOrder:"requestsEvaluated"===n?"desc"===d?"descend":"ascend":null,render:e=>e.toLocaleString()},{title:"Fail Rate",dataIndex:"failRate",key:"failRate",align:"right",sorter:!0,sortOrder:"failRate"===n?"desc"===d?"descend":"ascend":null,render:(e,s)=>(0,t.jsxs)("span",{className:e>15?"text-red-600":e>5?"text-amber-600":"text-green-600",children:[e,"%","up"===s.trend&&(0,t.jsx)("span",{className:"ml-1 text-xs text-red-400",children:"↑"}),"down"===s.trend&&(0,t.jsx)("span",{className:"ml-1 text-xs text-green-400",children:"↓"})]})},{title:"Avg. latency added",dataIndex:"avgLatency",key:"avgLatency",align:"right",sorter:!0,sortOrder:"avgLatency"===n?"desc"===d?"descend":"ascend":null,render:e=>(0,t.jsx)("span",{className:null==e?"text-gray-400":e>150?"text-red-600":e>50?"text-amber-600":"text-green-600",children:null!=e?`${e}ms`:"—"})},{title:"Status",dataIndex:"status",key:"status",align:"center",render:e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:`w-2 h-2 rounded-full ${"healthy"===e?"bg-green-500":"warning"===e?"bg-amber-500":"bg-red-500"}`}),(0,t.jsx)("span",{className:"text-xs text-gray-600 capitalize",children:e})]})}],_=["failRate","requestsEvaluated","avgLatency"];return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)(tZ.SafetyOutlined,{className:"text-lg text-indigo-500"}),(0,t.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Guardrails Monitor"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Monitor guardrail performance across all requests"})]}),(0,t.jsx)("div",{className:"flex items-center gap-3",children:(0,t.jsx)(A.Button,{type:"default",icon:(0,t.jsx)(tS.DownloadOutlined,{}),title:"Coming soon",children:"Export Data"})})]}),(0,t.jsxs)(t4.Grid,{numItems:2,numItemsLg:5,className:"gap-4 mb-6 items-stretch",children:[(0,t.jsx)(t2.Col,{className:"flex flex-col",children:(0,t.jsx)(sr,{label:"Total Evaluations",value:j.totalRequests.toLocaleString()})}),(0,t.jsx)(t2.Col,{className:"flex flex-col",children:(0,t.jsx)(sr,{label:"Blocked Requests",value:j.totalBlocked.toLocaleString(),valueColor:"text-red-600",icon:(0,t.jsx)(ep.WarningOutlined,{className:"text-red-400"})})}),(0,t.jsx)(t2.Col,{className:"flex flex-col",children:(0,t.jsx)(sr,{label:"Pass Rate",value:`${j.passRate}%`,valueColor:"text-green-600",icon:(0,t.jsx)(sd,{className:"text-green-400"})})}),(0,t.jsx)(t2.Col,{className:"flex flex-col",children:(0,t.jsx)(sr,{label:"Avg. latency added",value:`${j.avgLatency}ms`,valueColor:j.avgLatency>150?"text-red-600":j.avgLatency>50?"text-amber-600":"text-green-600"})}),(0,t.jsx)(t2.Col,{className:"flex flex-col",children:(0,t.jsx)(sr,{label:"Active Guardrails",value:j.count})})]}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)(sm,{data:y})}),(0,t.jsxs)(ef.Card,{className:"bg-white border border-gray-200 rounded-lg",children:[(p||h)&&(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center gap-2",children:[p&&(0,t.jsx)(eS.Spin,{size:"small"}),h&&(0,t.jsx)("span",{className:"text-sm text-red-600",children:"Failed to load data. Try again."})]}),(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(eb.Title,{className:"text-base font-semibold text-gray-900",children:"Guardrail Performance"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Click a guardrail to view details, logs, and configuration"})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(A.Button,{type:"default",icon:(0,t.jsx)(t0.SettingOutlined,{}),onClick:()=>u(!0),title:"Evaluation settings"})})]}),(0,t.jsx)(tt.Table,{columns:b,dataSource:f,rowKey:"id",pagination:!1,loading:p,onChange:(e,t,s)=>{s?.field&&_.includes(s.field)&&(o(s.field),c("ascend"===s.order?"asc":"desc"))},locale:0!==g.length||p?void 0:{emptyText:"No data for this period"},onRow:e=>({onClick:()=>r(e.id),style:{cursor:"pointer"}})})]}),(0,t.jsx)(t9,{open:m,onClose:()=>u(!1),accessToken:e})]})}let sp=new Date,sh=new Date;function sg({accessToken:e=null}){let[s,a]=(0,i.useState)({type:"overview"}),r=(0,i.useMemo)(()=>new Date(sh),[]),n=(0,i.useMemo)(()=>new Date(sp),[]),[o,d]=(0,i.useState)({from:r,to:n}),c=o.from?(0,l.formatDate)(o.from):"",m=o.to?(0,l.formatDate)(o.to):"",u=(0,i.useCallback)(e=>{d(e)},[]);return(0,t.jsxs)("div",{className:"p-6 w-full min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"flex items-center justify-end mb-4",children:(0,t.jsx)(tJ.default,{value:o,onValueChange:u,label:"",showTimeRange:!1})}),"overview"===s.type?(0,t.jsx)(sx,{accessToken:e,startDate:c,endDate:m,onSelectGuardrail:e=>{a({type:"detail",guardrailId:e})}}):(0,t.jsx)(sn,{guardrailId:s.guardrailId,onBack:()=>{a({type:"overview"})},accessToken:e,startDate:c,endDate:m})]})}sh.setDate(sh.getDate()-7);var sj=e.i(487304),sy=e.i(760221);e.i(111790);var sf=e.i(280881),sb=e.i(934879),s_=e.i(402874),sv=e.i(797305),sN=e.i(109799),sw=e.i(747871),sk=e.i(56567),sC=e.i(468133),sS=e.i(871943),sT=e.i(502547),sI=e.i(278587),sF=e.i(655913),sA=e.i(38419),sP=e.i(78334),sL=e.i(555436),sM=e.i(284614),sD=e.i(389083),sE=e.i(206929),sO=e.i(35983),sz=e.i(898586),sR=e.i(9314),sB=e.i(552130),sq=e.i(533882),s$=e.i(651904),sU=e.i(460285),sV=e.i(435451),sG=e.i(916940),sH=e.i(127952),sK=e.i(902555),sW=e.i(162386);let sQ=(e,t,s)=>"Admin"===e||!!s&&!!t&&s.some(e=>e.members?.some(e=>e.user_id===t&&"org_admin"===e.user_role)),sY=(e,t,s)=>"Admin"===e?s||[]:s&&t?s.filter(e=>e.members?.some(e=>e.user_id===t&&"org_admin"===e.user_role)):[],sJ=({teams:e,searchParams:s,accessToken:a,setTeams:r,userID:n,userRole:o,organizations:d,premiumUser:c=!1})=>{let x,h,y,f;console.log(`organizations: ${JSON.stringify(d)}`);let{data:b}=(0,sN.useOrganizations)(),[_,v]=(0,i.useState)(""),[N,w]=(0,i.useState)(null),[k,S]=(0,i.useState)(null),[F,P]=(0,i.useState)(!1),[L,M]=(0,i.useState)({team_id:"",team_alias:"",organization_id:"",sort_by:"created_at",sort_order:"desc"});(0,i.useEffect)(()=>{console.log(`inside useeffect - ${_}`),a&&(0,eR.fetchTeams)(a,n,o,N,r),e6()},[_]);let[D]=p.Form.useForm(),[E]=p.Form.useForm(),{Title:O,Paragraph:z}=sz.Typography,[R,B]=(0,i.useState)(""),[q,$]=(0,i.useState)(!1),[U,V]=(0,i.useState)(null),[G,H]=(0,i.useState)(null),[K,W]=(0,i.useState)(!1),[Q,Y]=(0,i.useState)(!1),[J,X]=(0,i.useState)(!1),[Z,ee]=(0,i.useState)(!1),[et,es]=(0,i.useState)([]),[ea,ei]=(0,i.useState)(!1),[en,eo]=(0,i.useState)(null),[ed,ec]=(0,i.useState)([]),[em,ex]=(0,i.useState)({}),[ep,eh]=(0,i.useState)(!1),[eg,ej]=(0,i.useState)([]),[eb,eS]=(0,i.useState)([]),[eT,eI]=(0,i.useState)({}),[eF,eA]=(0,i.useState)([]),[eP,eL]=(0,i.useState)([]),[eD,eE]=(0,i.useState)(!1),[eO,ez]=(0,i.useState)({}),[eB,eH]=(0,i.useState)(null),[eK,eW]=(0,i.useState)(0);(0,i.useEffect)(()=>{let e;console.log(`currentOrgForCreateTeam: ${k}`);let t=(e=[],k&&k.models.length>0?(console.log(`organization.models: ${k.models}`),e=k.models):e=et,(0,T.unfurlWildcardModelsInList)(e,et));console.log(`models: ${t}`),ec(t),D.setFieldValue("models",[])},[k,et]),(0,i.useEffect)(()=>{if(Q){let e=sY(o,n,d);if(1===e.length){let t=e[0];D.setFieldValue("organization_id",t.organization_id),S(t)}else D.setFieldValue("organization_id",N?.organization_id||null),S(N)}},[Q,o,n,d,N]),(0,i.useEffect)(()=>{let e=async()=>{try{if(null==a)return;let e=(await (0,l.getPoliciesList)(a)).policies.map(e=>e.policy_name);eS(e)}catch(e){console.error("Failed to fetch policies:",e)}};(async()=>{try{if(null==a)return;let e=(await (0,l.getGuardrailsList)(a)).guardrails.map(e=>e.guardrail_name);ej(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})(),e()},[a]);let eQ=async()=>{try{if(null==a)return;let e=await (0,l.fetchMCPAccessGroups)(a);eL(e)}catch(e){console.error("Failed to fetch MCP access groups:",e)}};(0,i.useEffect)(()=>{eQ()},[a]),(0,i.useEffect)(()=>{e&&ex(e.reduce((e,t)=>(e[t.team_id]={keys:t.keys||[],team_info:{members_with_roles:t.members_with_roles||[]}},e),{}))},[e]);let e2=async e=>{eo(e),ei(!0)},e4=async()=>{if(null!=en&&null!=e&&null!=a)try{eh(!0),await (0,l.teamDeleteCall)(a,en.team_id),await (0,eR.fetchTeams)(a,n,o,N,r),eM.default.success("Team deleted successfully")}catch(e){eM.default.fromBackend("Error deleting the team: "+e)}finally{eh(!1),ei(!1),eo(null)}};(0,i.useEffect)(()=>{(async()=>{try{if(null===n||null===o||null===a)return;let e=await (0,T.fetchAvailableModelsForTeamOrKey)(n,o,a);e&&es(e)}catch(e){console.error("Error fetching user models:",e)}})()},[a,n,o,e]);let e5=async t=>{try{if(console.log(`formValues: ${JSON.stringify(t)}`),null!=a){let s=t?.team_alias,i=e?.map(e=>e.team_alias)??[],n=t?.organization_id||N?.organization_id;if(""===n||"string"!=typeof n?t.organization_id=null:t.organization_id=n.trim(),i.includes(s))throw Error(`Team alias ${s} already exists, please pick another alias`);if(eM.default.info("Creating Team"),eF.length>0){let e={};if(t.metadata)try{e=JSON.parse(t.metadata)}catch(e){console.warn("Invalid JSON in metadata field, starting with empty object")}e={...e,logging:eF.filter(e=>e.callback_name)},t.metadata=JSON.stringify(e)}if(t.secret_manager_settings&&"string"==typeof t.secret_manager_settings)if(""===t.secret_manager_settings.trim())delete t.secret_manager_settings;else try{t.secret_manager_settings=JSON.parse(t.secret_manager_settings)}catch(e){throw Error("Failed to parse secret manager settings: "+e)}if(t.allowed_vector_store_ids&&t.allowed_vector_store_ids.length>0||t.allowed_mcp_servers_and_groups&&(t.allowed_mcp_servers_and_groups.servers?.length>0||t.allowed_mcp_servers_and_groups.accessGroups?.length>0||t.allowed_mcp_servers_and_groups.toolPermissions)){if(t.object_permission={},t.allowed_vector_store_ids&&t.allowed_vector_store_ids.length>0&&(t.object_permission.vector_stores=t.allowed_vector_store_ids,delete t.allowed_vector_store_ids),t.allowed_mcp_servers_and_groups){let{servers:e,accessGroups:s}=t.allowed_mcp_servers_and_groups;e&&e.length>0&&(t.object_permission.mcp_servers=e),s&&s.length>0&&(t.object_permission.mcp_access_groups=s),delete t.allowed_mcp_servers_and_groups}t.mcp_tool_permissions&&Object.keys(t.mcp_tool_permissions).length>0&&(t.object_permission||(t.object_permission={}),t.object_permission.mcp_tool_permissions=t.mcp_tool_permissions,delete t.mcp_tool_permissions)}if(t.allowed_mcp_access_groups&&t.allowed_mcp_access_groups.length>0&&(t.object_permission||(t.object_permission={}),t.object_permission.mcp_access_groups=t.allowed_mcp_access_groups,delete t.allowed_mcp_access_groups),t.allowed_agents_and_groups){let{agents:e,accessGroups:s}=t.allowed_agents_and_groups;t.object_permission||(t.object_permission={}),e&&e.length>0&&(t.object_permission.agents=e),s&&s.length>0&&(t.object_permission.agent_access_groups=s),delete t.allowed_agents_and_groups}Object.keys(eO).length>0&&(t.model_aliases=eO),eB?.router_settings&&Object.values(eB.router_settings).some(e=>null!=e&&""!==e)&&(t.router_settings=eB.router_settings);let o=await (0,l.teamCreateCall)(a,t);null!==e?r([...e,o]):r([o]),console.log(`response for team create call: ${o}`),eM.default.success("Team created"),D.resetFields(),eA([]),ez({}),eH(null),eW(e=>e+1),Y(!1)}}catch(e){console.error("Error creating the team:",e),eM.default.fromBackend("Error creating the team: "+e)}},e6=()=>{v(new Date().toLocaleString())},e3=(e,t)=>{let s={...L,[e]:t};M(s),a&&(0,l.v2TeamListCall)(a,s.organization_id||null,null,s.team_id||null,s.team_alias||null).then(e=>{e&&e.teams&&r(e.teams)}).catch(e=>{console.error("Error fetching teams:",e)})};return(0,t.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,t.jsx)(t4.Grid,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,t.jsxs)(t2.Col,{numColSpan:1,className:"flex flex-col gap-2",children:[sQ(o,n,d)&&(0,t.jsx)(m.Button,{className:"w-fit",onClick:()=>Y(!0),children:"+ Create New Team"}),G?(0,t.jsx)(sk.default,{teamId:G,onUpdate:e=>{r(t=>{if(null==t)return t;let s=t.map(t=>e.team_id===t.team_id?(0,tC.updateExistingKeys)(t,e):t);return a&&(0,eR.fetchTeams)(a,n,o,N,r),s})},onClose:()=>{H(null),W(!1)},accessToken:a,is_team_admin:(e=>{if(null==e||null==e.members_with_roles)return!1;for(let t=0;t<e.members_with_roles.length;t++){let s=e.members_with_roles[t];if(s.user_id==n&&"admin"==s.role)return!0}return!1})(e?.find(e=>e.team_id===G)),is_proxy_admin:"Admin"==o,userModels:et,editTeam:K,premiumUser:c}):(0,t.jsxs)(eN.TabGroup,{className:"gap-2 h-[75vh] w-full",children:[(0,t.jsxs)(ew.TabList,{className:"flex justify-between mt-2 w-full items-center",children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)(ev.Tab,{children:"Your Teams"}),(0,t.jsx)(ev.Tab,{children:"Available Teams"}),(0,ey.isProxyAdminRole)(o||"")&&(0,t.jsx)(ev.Tab,{children:"Default Team Settings"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[_&&(0,t.jsxs)(e_.Text,{children:["Last Refreshed: ",_]}),(0,t.jsx)(eG.Icon,{icon:sI.RefreshIcon,variant:"shadow",size:"xs",className:"self-center",onClick:e6})]})]}),(0,t.jsxs)(eC.TabPanels,{children:[(0,t.jsxs)(ek.TabPanel,{children:[(0,t.jsxs)(e_.Text,{children:["Click on “Team ID” to view team details ",(0,t.jsx)("b",{children:"and"})," manage team members."]}),(0,t.jsx)(t4.Grid,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:(0,t.jsx)(t2.Col,{numColSpan:1,children:(0,t.jsxs)(ef.Card,{className:"w-full mx-auto flex-auto overflow-hidden overflow-y-auto max-h-[50vh]",children:[(0,t.jsx)("div",{className:"border-b px-6 py-4",children:(0,t.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,t.jsx)(sF.FilterInput,{placeholder:"Search by Team Name...",value:L.team_alias,onChange:e=>e3("team_alias",e),icon:sL.Search}),(0,t.jsx)(sA.FiltersButton,{onClick:()=>P(!F),active:F,hasActiveFilters:!!(L.team_id||L.team_alias||L.organization_id)}),(0,t.jsx)(sP.ResetFiltersButton,{onClick:()=>{M({team_id:"",team_alias:"",organization_id:"",sort_by:"created_at",sort_order:"desc"}),a&&(0,l.v2TeamListCall)(a,null,n||null,null,null).then(e=>{e&&e.teams&&r(e.teams)}).catch(e=>{console.error("Error fetching teams:",e)})}})]}),F&&(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mt-3",children:[(0,t.jsx)(sF.FilterInput,{placeholder:"Enter Team ID",value:L.team_id,onChange:e=>e3("team_id",e),icon:sM.User}),(0,t.jsx)("div",{className:"w-64",children:(0,t.jsx)(sE.Select,{value:L.organization_id||"",onValueChange:e=>e3("organization_id",e),placeholder:"Select Organization",children:d?.map(e=>(0,t.jsx)(sO.SelectItem,{value:e.organization_id||"",children:e.organization_alias||e.organization_id},e.organization_id))})})]})]})}),(0,t.jsxs)(eY.Table,{children:[(0,t.jsx)(eJ.TableHead,{children:(0,t.jsxs)(eX.TableRow,{children:[(0,t.jsx)(eZ.TableHeaderCell,{children:"Team Name"}),(0,t.jsx)(eZ.TableHeaderCell,{children:"Team ID"}),(0,t.jsx)(eZ.TableHeaderCell,{children:"Created"}),(0,t.jsx)(eZ.TableHeaderCell,{children:"Spend (USD)"}),(0,t.jsx)(eZ.TableHeaderCell,{children:"Budget (USD)"}),(0,t.jsx)(eZ.TableHeaderCell,{children:"Models"}),(0,t.jsx)(eZ.TableHeaderCell,{children:"Organization"}),(0,t.jsx)(eZ.TableHeaderCell,{children:"Info"}),(0,t.jsx)(eZ.TableHeaderCell,{children:"Actions"})]})}),(0,t.jsx)(e0.TableBody,{children:e&&e.length>0?e.filter(e=>!N||e.organization_id===N.organization_id).sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>(0,t.jsxs)(eX.TableRow,{children:[(0,t.jsx)(e1.TableCell,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.team_alias}),(0,t.jsx)(e1.TableCell,{children:(0,t.jsx)("div",{className:"overflow-hidden",children:(0,t.jsx)(eu.Tooltip,{title:e.team_id,children:(0,t.jsxs)(m.Button,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>{H(e.team_id)},children:[e.team_id.slice(0,7),"..."]})})})}),(0,t.jsx)(e1.TableCell,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"}),(0,t.jsx)(e1.TableCell,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:(0,tC.formatNumberWithCommas)(e.spend,4)}),(0,t.jsx)(e1.TableCell,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:null!==e.max_budget&&void 0!==e.max_budget?e.max_budget:"No limit"}),(0,t.jsx)(e1.TableCell,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:e.models.length>3?"px-0":"",children:(0,t.jsx)("div",{className:"flex flex-col",children:Array.isArray(e.models)?(0,t.jsx)("div",{className:"flex flex-col",children:0===e.models.length?(0,t.jsx)(sD.Badge,{size:"xs",className:"mb-1",color:"red",children:(0,t.jsx)(e_.Text,{children:"All Proxy Models"})}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex items-start",children:[e.models.length>3&&(0,t.jsx)("div",{children:(0,t.jsx)(eG.Icon,{icon:eT[e.team_id]?sS.ChevronDownIcon:sT.ChevronRightIcon,className:"cursor-pointer",size:"xs",onClick:()=>{eI(t=>({...t,[e.team_id]:!t[e.team_id]}))}})}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.models.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,t.jsx)(sD.Badge,{size:"xs",color:"red",children:(0,t.jsx)(e_.Text,{children:"All Proxy Models"})},s):(0,t.jsx)(sD.Badge,{size:"xs",color:"blue",children:(0,t.jsx)(e_.Text,{children:e.length>30?`${(0,T.getModelDisplayName)(e).slice(0,30)}...`:(0,T.getModelDisplayName)(e)})},s)),e.models.length>3&&!eT[e.team_id]&&(0,t.jsx)(sD.Badge,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,t.jsxs)(e_.Text,{children:["+",e.models.length-3," ",e.models.length-3==1?"more model":"more models"]})}),eT[e.team_id]&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.models.slice(3).map((e,s)=>"all-proxy-models"===e?(0,t.jsx)(sD.Badge,{size:"xs",color:"red",children:(0,t.jsx)(e_.Text,{children:"All Proxy Models"})},s+3):(0,t.jsx)(sD.Badge,{size:"xs",color:"blue",children:(0,t.jsx)(e_.Text,{children:e.length>30?`${(0,T.getModelDisplayName)(e).slice(0,30)}...`:(0,T.getModelDisplayName)(e)})},s+3))})]})]})})}):null})}),(0,t.jsx)(e1.TableCell,{children:((e,t)=>{if(!e||!t)return e||"N/A";let s=t.find(t=>t.organization_id===e);return s?.organization_alias||e})(e.organization_id,b||d)}),(0,t.jsxs)(e1.TableCell,{children:[(0,t.jsxs)(e_.Text,{children:[em&&e.team_id&&em[e.team_id]&&em[e.team_id].keys&&em[e.team_id].keys.length," ","Keys"]}),(0,t.jsxs)(e_.Text,{children:[em&&e.team_id&&em[e.team_id]&&em[e.team_id].team_info&&em[e.team_id].team_info.members_with_roles&&em[e.team_id].team_info.members_with_roles.length," ","Members"]})]}),(0,t.jsx)(e1.TableCell,{children:"Admin"==o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(sK.default,{variant:"Edit",onClick:()=>{H(e.team_id),W(!0)},dataTestId:"edit-team-button",tooltipText:"Edit team"}),(0,t.jsx)(sK.default,{variant:"Delete",onClick:()=>e2(e),dataTestId:"delete-team-button",tooltipText:"Delete team"})]}):null})]},e.team_id)):(0,t.jsx)(eX.TableRow,{children:(0,t.jsx)(e1.TableCell,{colSpan:9,className:"text-center",children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-4",children:[(0,t.jsx)(e_.Text,{className:"text-lg font-medium mb-2",children:"No teams found"}),(0,t.jsx)(e_.Text,{className:"text-sm",children:"Adjust your filters or create a new team"})]})})})})]}),(0,t.jsx)(sH.default,{isOpen:ea,title:"Delete Team?",alertMessage:en?.keys?.length===0?void 0:`Warning: This team has ${en?.keys?.length} keys associated with it. Deleting the team will also delete all associated keys. This action is irreversible.`,message:"Are you sure you want to delete this team and all its keys? This action cannot be undone.",resourceInformationTitle:"Team Information",resourceInformation:[{label:"Team ID",value:en?.team_id,code:!0},{label:"Team Name",value:en?.team_alias},{label:"Keys",value:en?.keys?.length},{label:"Members",value:en?.members_with_roles?.length}],requiredConfirmation:en?.team_alias,onCancel:()=>{ei(!1),eo(null)},onOk:e4,confirmLoading:ep})]})})})]}),(0,t.jsx)(ek.TabPanel,{children:(0,t.jsx)(sw.default,{accessToken:a,userID:n})}),(0,ey.isProxyAdminRole)(o||"")&&(0,t.jsx)(ek.TabPanel,{children:(0,t.jsx)(sC.default,{accessToken:a,userID:n||"",userRole:o||""})})]})]}),sQ(o,n,d)&&(0,t.jsx)(u.Modal,{title:"Create Team",open:Q,width:1e3,footer:null,onOk:()=>{Y(!1),D.resetFields(),eA([]),ez({}),eH(null),eW(e=>e+1)},onCancel:()=>{Y(!1),D.resetFields(),eA([]),ez({}),eH(null),eW(e=>e+1)},children:(0,t.jsxs)(p.Form,{form:D,onFinish:e5,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Form.Item,{label:"Team Name",name:"team_alias",rules:[{required:!0,message:"Please input a team name"}],children:(0,t.jsx)(eV.TextInput,{placeholder:""})}),(x=sY(o,n,d),h="Admin"!==o,y=1===x.length,f=0===x.length,(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{children:["Organization"," ",(0,t.jsx)(eu.Tooltip,{title:(0,t.jsxs)("span",{children:["Organizations can have multiple teams. Learn more about"," ",(0,t.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/user_management_heirarchy",target:"_blank",rel:"noopener noreferrer",style:{color:"#1890ff",textDecoration:"underline"},onClick:e=>e.stopPropagation(),children:"user management hierarchy"})]}),children:(0,t.jsx)(C.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"organization_id",initialValue:N?N.organization_id:null,className:"mt-8",rules:h?[{required:!0,message:"Please select an organization"}]:[],help:y?"You can only create teams within this organization":h?"required":"",children:(0,t.jsx)(g.Select,{showSearch:!0,allowClear:!h,disabled:y,placeholder:f?"No organizations available":"Search or select an Organization",onChange:e=>{D.setFieldValue("organization_id",e),S(x?.find(t=>t.organization_id===e)||null)},filterOption:(e,t)=>!!t&&(t.children?.toString()||"").toLowerCase().includes(e.toLowerCase()),optionFilterProp:"children",children:x?.map(e=>(0,t.jsxs)(g.Select.Option,{value:e.organization_id,children:[(0,t.jsx)("span",{className:"font-medium",children:e.organization_alias})," ",(0,t.jsxs)("span",{className:"text-gray-500",children:["(",e.organization_id,")"]})]},e.organization_id))})}),h&&!y&&x.length>1&&(0,t.jsx)("div",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,t.jsx)(e_.Text,{className:"text-blue-800 text-sm",children:"Please select an organization to create a team for. You can only create teams within organizations where you are an admin."})})]})),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{children:["Models"," ",(0,t.jsx)(eu.Tooltip,{title:"These are the models that your selected team has access to",children:(0,t.jsx)(C.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),rules:[{required:!0,message:"Please select at least one model"}],name:"models",children:(0,t.jsx)(sW.ModelSelect,{value:D.getFieldValue("models")||[],onChange:e=>D.setFieldValue("models",e),organizationID:D.getFieldValue("organization_id"),options:{includeSpecialOptions:!0,showAllProxyModelsOverride:!D.getFieldValue("organization_id")},context:"team",dataTestId:"create-team-models-select"})}),(0,t.jsx)(p.Form.Item,{label:"Max Budget (USD)",name:"max_budget",children:(0,t.jsx)(sV.default,{step:.01,precision:2,width:200})}),(0,t.jsx)(p.Form.Item,{className:"mt-8",label:"Reset Budget",name:"budget_duration",children:(0,t.jsxs)(g.Select,{defaultValue:null,placeholder:"n/a",children:[(0,t.jsx)(g.Select.Option,{value:"24h",children:"daily"}),(0,t.jsx)(g.Select.Option,{value:"7d",children:"weekly"}),(0,t.jsx)(g.Select.Option,{value:"30d",children:"monthly"})]})}),(0,t.jsx)(p.Form.Item,{label:"Tokens per minute Limit (TPM)",name:"tpm_limit",children:(0,t.jsx)(sV.default,{step:1,width:400})}),(0,t.jsx)(p.Form.Item,{label:"Requests per minute Limit (RPM)",name:"rpm_limit",children:(0,t.jsx)(sV.default,{step:1,width:400})}),(0,t.jsxs)(eq.Accordion,{className:"mt-20 mb-8",onClick:()=>{eD||(eQ(),eE(!0))},children:[(0,t.jsx)(e$.AccordionHeader,{children:(0,t.jsx)("b",{children:"Additional Settings"})}),(0,t.jsxs)(eU.AccordionBody,{children:[(0,t.jsx)(p.Form.Item,{label:"Team ID",name:"team_id",help:"ID of the team you want to create. If not provided, it will be generated automatically.",children:(0,t.jsx)(eV.TextInput,{onChange:e=>{e.target.value=e.target.value.trim()}})}),(0,t.jsx)(p.Form.Item,{label:"Team Member Budget (USD)",name:"team_member_budget",normalize:e=>e?Number(e):void 0,tooltip:"This is the individual budget for a user in the team.",children:(0,t.jsx)(sV.default,{step:.01,precision:2,width:200})}),(0,t.jsx)(p.Form.Item,{label:"Team Member Key Duration (eg: 1d, 1mo)",name:"team_member_key_duration",tooltip:"Set a limit to the duration of a team member's key. Format: 30s (seconds), 30m (minutes), 30h (hours), 30d (days), 1mo (month)",children:(0,t.jsx)(eV.TextInput,{placeholder:"e.g., 30d"})}),(0,t.jsx)(p.Form.Item,{label:"Team Member RPM Limit",name:"team_member_rpm_limit",tooltip:"The RPM (Requests Per Minute) limit for individual team members",children:(0,t.jsx)(sV.default,{step:1,width:400})}),(0,t.jsx)(p.Form.Item,{label:"Team Member TPM Limit",name:"team_member_tpm_limit",tooltip:"The TPM (Tokens Per Minute) limit for individual team members",children:(0,t.jsx)(sV.default,{step:1,width:400})}),(0,t.jsx)(p.Form.Item,{label:"Metadata",name:"metadata",help:"Additional team metadata. Enter metadata as JSON object.",children:(0,t.jsx)(j.Input.TextArea,{rows:4})}),(0,t.jsx)(p.Form.Item,{label:"Secret Manager Settings",name:"secret_manager_settings",help:c?"Enter secret manager configuration as a JSON object.":"Premium feature - Upgrade to manage secret manager settings.",rules:[{validator:async(e,t)=>{if(!t)return Promise.resolve();try{return JSON.parse(t),Promise.resolve()}catch(e){return Promise.reject(Error("Please enter valid JSON"))}}}],children:(0,t.jsx)(j.Input.TextArea,{rows:4,placeholder:'{"namespace": "admin", "mount": "secret", "path_prefix": "litellm"}',disabled:!c})}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{children:["Guardrails"," ",(0,t.jsx)(eu.Tooltip,{title:"Setup your first guardrail",children:(0,t.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(C.InfoCircleOutlined,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",className:"mt-8",help:"Select existing guardrails or enter new ones",children:(0,t.jsx)(g.Select,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter guardrails",options:eg.map(e=>({value:e,label:e}))})}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{children:["Disable Global Guardrails"," ",(0,t.jsx)(eu.Tooltip,{title:"When enabled, this team will bypass any guardrails configured to run on every request (global guardrails)",children:(0,t.jsx)(C.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"disable_global_guardrails",className:"mt-4",valuePropName:"checked",help:"Bypass global guardrails for this team",children:(0,t.jsx)(I.Switch,{disabled:!c,checkedChildren:c?"Yes":"Premium feature - Upgrade to disable global guardrails by team",unCheckedChildren:c?"No":"Premium feature - Upgrade to disable global guardrails by team"})}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{children:["Policies"," ",(0,t.jsx)(eu.Tooltip,{title:"Apply policies to this team to control guardrails and other settings",children:(0,t.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/guardrail_policies",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(C.InfoCircleOutlined,{style:{marginLeft:"4px"}})})})]}),name:"policies",className:"mt-8",help:"Select existing policies or enter new ones",children:(0,t.jsx)(g.Select,{mode:"tags",style:{width:"100%"},placeholder:"Select or enter policies",options:eb.map(e=>({value:e,label:e}))})}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{children:["Access Groups"," ",(0,t.jsx)(eu.Tooltip,{title:"Assign access groups to this team. Access groups control which models, MCP servers, and agents this team can use",children:(0,t.jsx)(C.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"access_group_ids",className:"mt-8",help:"Select access groups to assign to this team",children:(0,t.jsx)(sR.default,{placeholder:"Select access groups (optional)"})}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{children:["Allowed Vector Stores"," ",(0,t.jsx)(eu.Tooltip,{title:"Select which vector stores this team can access by default. Leave empty for access to all vector stores",children:(0,t.jsx)(C.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-8",help:"Select vector stores this team can access. Leave empty for access to all vector stores",children:(0,t.jsx)(sG.default,{onChange:e=>D.setFieldValue("allowed_vector_store_ids",e),value:D.getFieldValue("allowed_vector_store_ids"),accessToken:a||"",placeholder:"Select vector stores (optional)"})})]})]}),(0,t.jsxs)(eq.Accordion,{className:"mt-8 mb-8",children:[(0,t.jsx)(e$.AccordionHeader,{children:(0,t.jsx)("b",{children:"MCP Settings"})}),(0,t.jsxs)(eU.AccordionBody,{children:[(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,t.jsx)(eu.Tooltip,{title:"Select which MCP servers or access groups this team can access",children:(0,t.jsx)(C.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_servers_and_groups",className:"mt-4",help:"Select MCP servers or access groups this team can access",children:(0,t.jsx)(el.default,{onChange:e=>D.setFieldValue("allowed_mcp_servers_and_groups",e),value:D.getFieldValue("allowed_mcp_servers_and_groups"),accessToken:a||"",placeholder:"Select MCP servers or access groups (optional)"})}),(0,t.jsx)(p.Form.Item,{name:"mcp_tool_permissions",initialValue:{},hidden:!0,children:(0,t.jsx)(j.Input,{type:"hidden"})}),(0,t.jsx)(p.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.allowed_mcp_servers_and_groups!==t.allowed_mcp_servers_and_groups||e.mcp_tool_permissions!==t.mcp_tool_permissions,children:()=>(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)(er.default,{accessToken:a||"",selectedServers:D.getFieldValue("allowed_mcp_servers_and_groups")?.servers||[],toolPermissions:D.getFieldValue("mcp_tool_permissions")||{},onChange:e=>D.setFieldsValue({mcp_tool_permissions:e})})})})]})]}),(0,t.jsxs)(eq.Accordion,{className:"mt-8 mb-8",children:[(0,t.jsx)(e$.AccordionHeader,{children:(0,t.jsx)("b",{children:"Agent Settings"})}),(0,t.jsx)(eU.AccordionBody,{children:(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{children:["Allowed Agents"," ",(0,t.jsx)(eu.Tooltip,{title:"Select which agents or access groups this team can access",children:(0,t.jsx)(C.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"allowed_agents_and_groups",className:"mt-4",help:"Select agents or access groups this team can access",children:(0,t.jsx)(sB.default,{onChange:e=>D.setFieldValue("allowed_agents_and_groups",e),value:D.getFieldValue("allowed_agents_and_groups"),accessToken:a||"",placeholder:"Select agents or access groups (optional)"})})})]}),(0,t.jsxs)(eq.Accordion,{className:"mt-8 mb-8",children:[(0,t.jsx)(e$.AccordionHeader,{children:(0,t.jsx)("b",{children:"Logging Settings"})}),(0,t.jsx)(eU.AccordionBody,{children:(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(s$.default,{value:eF,onChange:eA,premiumUser:c})})})]}),(0,t.jsxs)(eq.Accordion,{className:"mt-8 mb-8",children:[(0,t.jsx)(e$.AccordionHeader,{children:(0,t.jsx)("b",{children:"Router Settings"})}),(0,t.jsx)(eU.AccordionBody,{children:(0,t.jsx)("div",{className:"mt-4 w-full",children:(0,t.jsx)(sU.default,{accessToken:a||"",value:eB||void 0,onChange:eH,modelData:et.length>0?{data:et.map(e=>({model_name:e}))}:void 0},eK)})})]},`router-settings-accordion-${eK}`),(0,t.jsxs)(eq.Accordion,{className:"mt-8 mb-8",children:[(0,t.jsx)(e$.AccordionHeader,{children:(0,t.jsx)("b",{children:"Model Aliases"})}),(0,t.jsx)(eU.AccordionBody,{children:(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)(e_.Text,{className:"text-sm text-gray-600 mb-4",children:"Create custom aliases for models that can be used by team members in API calls. This allows you to create shortcuts for specific models."}),(0,t.jsx)(sq.default,{accessToken:a||"",initialModelAliases:eO,onAliasUpdate:ez,showExampleConfig:!1})]})})]})]}),(0,t.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,t.jsx)(A.Button,{htmlType:"submit",children:"Create Team"})})]})})]})})})};var sX=e.i(702597),sZ=e.i(846835),s0=e.i(147612),s1=e.i(191403),s2=e.i(976883),s4=e.i(657688),s5=e.i(437902);let{Text:s6}=sz.Typography,s3=({litellmParams:e,accessToken:s,onTestComplete:a})=>{let[r,n]=(0,i.useState)(!0),[o,d]=(0,i.useState)(null),[c,m]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{n(!0);try{let t=await (0,l.testSearchToolConnection)(s,e);d(t),"success"===t.status&&eM.default.success("Connection test successful!")}catch(e){d({status:"error",message:e instanceof Error?e.message:"Unknown error occurred",error_type:"NetworkError"})}finally{n(!1),a&&a()}})()},[s,e,a]);let u=o?.message?(e=>{if(!e)return"Unknown error";let t=e.split("stack trace:")[0].trim().replace(/^litellm\.(.*?)Error:\s*/,"").replace(/^AuthenticationError:\s*/,"");if(t.includes("<html>")||t.includes("<!DOCTYPE")){let e=t.match(/<title>(.*?)<\/title>/);return e?e[1]:t.includes("401")||t.includes("Authorization Required")?"Authentication failed: Invalid API key or credentials":"Authentication error - please check your API key"}return t.length>200?t.substring(0,200)+"...":t})(o.message):"Unknown error";return r?(0,t.jsx)("div",{style:{padding:"24px",borderRadius:"8px",backgroundColor:"#fff"},children:(0,t.jsxs)("div",{style:{textAlign:"center",padding:"32px 20px"},className:"jsx-dc9a0e2d897fe63b",children:[(0,t.jsx)("div",{style:{marginBottom:"16px"},className:"jsx-dc9a0e2d897fe63b loading-spinner",children:(0,t.jsx)("div",{style:{border:"3px solid #f3f3f3",borderTop:"3px solid #1890ff",borderRadius:"50%",width:"30px",height:"30px",animation:"spin 1s linear infinite",margin:"0 auto"},className:"jsx-dc9a0e2d897fe63b"})}),(0,t.jsxs)(s6,{style:{fontSize:"16px"},children:["Testing connection to ",e.search_provider||"search provider","..."]}),(0,t.jsx)(s5.default,{id:"dc9a0e2d897fe63b",children:"@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"})]})}):o?(0,t.jsxs)("div",{style:{padding:"24px",borderRadius:"8px",backgroundColor:"#fff"},children:["success"===o.status?(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"32px 20px"},children:[(0,t.jsx)("div",{style:{color:"#52c41a",fontSize:"24px",display:"flex",alignItems:"center"},children:(0,t.jsx)("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"check-circle",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"})})}),(0,t.jsxs)("div",{style:{marginLeft:"12px"},children:[(0,t.jsxs)(s6,{type:"success",style:{fontSize:"18px",fontWeight:500,display:"block"},children:["Connection to ",e.search_provider," successful!"]}),o.test_query&&(0,t.jsxs)(s6,{style:{fontSize:"14px",color:"#666",marginTop:"8px",display:"block"},children:["Test query: ",(0,t.jsx)("code",{style:{backgroundColor:"#f0f0f0",padding:"2px 6px",borderRadius:"4px"},children:o.test_query})]}),void 0!==o.results_count&&(0,t.jsxs)(s6,{style:{fontSize:"14px",color:"#666",display:"block"},children:["Results retrieved: ",o.results_count]})]})]}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px"},children:[(0,t.jsx)(ep.WarningOutlined,{style:{color:"#ff4d4f",fontSize:"24px",marginRight:"12px"}}),(0,t.jsxs)(s6,{type:"danger",style:{fontSize:"18px",fontWeight:500},children:["Connection to ",e.search_provider||"search provider"," failed"]})]}),(0,t.jsxs)("div",{style:{backgroundColor:"#fff2f0",border:"1px solid #ffccc7",borderRadius:"8px",padding:"16px",marginBottom:"20px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.03)"},children:[(0,t.jsxs)(s6,{strong:!0,style:{display:"block",marginBottom:"8px"},children:["Error:"," "]}),(0,t.jsx)(s6,{type:"danger",style:{fontSize:"14px",lineHeight:"1.5"},children:u}),o.error_type&&(0,t.jsx)("div",{style:{marginTop:"8px"},children:(0,t.jsxs)(s6,{style:{fontSize:"13px",color:"#666"},children:["Error type:"," ",(0,t.jsx)("code",{style:{backgroundColor:"#ffebee",padding:"2px 6px",borderRadius:"4px",color:"#d32f2f"},children:o.error_type})]})}),o.message&&(0,t.jsx)("div",{style:{marginTop:"12px"},children:(0,t.jsx)(A.Button,{type:"link",onClick:()=>m(!c),style:{paddingLeft:0,height:"auto"},children:c?"Hide Details":"Show Details"})})]}),c&&(0,t.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,t.jsx)(s6,{strong:!0,style:{display:"block",marginBottom:"8px",fontSize:"15px"},children:"Full Error Details"}),(0,t.jsx)("pre",{style:{backgroundColor:"#f5f5f5",padding:"16px",borderRadius:"8px",fontSize:"13px",maxHeight:"200px",overflow:"auto",border:"1px solid #e8e8e8",lineHeight:"1.5",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:o.message})]}),(0,t.jsxs)("div",{style:{backgroundColor:"#fffbf0",border:"1px solid #ffe58f",borderLeft:"4px solid #faad14",borderRadius:"8px",padding:"16px"},children:[(0,t.jsx)(s6,{strong:!0,style:{display:"block",marginBottom:"8px",color:"#d48806"},children:"Troubleshooting tips:"}),(0,t.jsxs)("ul",{style:{margin:"8px 0",paddingLeft:"20px",color:"#ad6800"},children:[(0,t.jsx)("li",{style:{marginBottom:"6px"},children:"Verify your API key is correct and active"}),(0,t.jsx)("li",{style:{marginBottom:"6px"},children:"Check if the search provider service is operational"}),(0,t.jsx)("li",{style:{marginBottom:"6px"},children:"Ensure you have sufficient credits/quota with the provider"}),(0,t.jsx)("li",{style:{marginBottom:"6px"},children:"Review the provider's documentation for any additional requirements"})]})]})]})}),(0,t.jsx)(_.Divider,{style:{margin:"24px 0 16px"}}),(0,t.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,t.jsx)(A.Button,{type:"link",href:"https://docs.litellm.ai/docs/search",target:"_blank",icon:(0,t.jsx)(C.InfoCircleOutlined,{}),children:"View Search Documentation"})})]}):null},{TextArea:s8}=j.Input,s7=({providerName:e,displayName:s})=>(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,t.jsx)(s4.default,{src:`../ui/assets/logos/${e}.png`,alt:"",width:20,height:20,style:{marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,t.jsx)("span",{children:s})]}),s9=({userRole:e,accessToken:s,onCreateSuccess:a,isModalVisible:r,setModalVisible:n})=>{let[o]=p.Form.useForm(),[d,c]=(0,i.useState)(!1),[x,h]=(0,i.useState)({}),[j,y]=(0,i.useState)(!1),[f,b]=(0,i.useState)(!1),[_,v]=(0,i.useState)(""),{data:N,isLoading:w}=(0,t1.useQuery)({queryKey:["searchProviders"],queryFn:()=>{if(!s)throw Error("Access Token required");return(0,l.fetchAvailableSearchProviders)(s)},enabled:!!s&&r}),k=N?.providers||[],S=async e=>{c(!0);try{let t={search_tool_name:e.search_tool_name,litellm_params:{search_provider:e.search_provider,api_key:e.api_key,api_base:e.api_base,timeout:e.timeout?parseFloat(e.timeout):void 0,max_retries:e.max_retries?parseInt(e.max_retries):void 0},search_tool_info:e.description?{description:e.description}:void 0};if(console.log("Creating search tool with payload:",t),null!=s){let e=await (0,l.createSearchTool)(s,t);eM.default.success("Search tool created successfully"),o.resetFields(),h({}),n(!1),a(e)}}catch(e){eM.default.error("Error creating search tool: "+e)}finally{c(!1)}},T=async()=>{try{await o.validateFields(["search_provider","api_key"]),b(!0),v(`test-${Date.now()}`),y(!0)}catch(e){eM.default.error("Please fill in Search Provider and API Key before testing")}};return(i.default.useEffect(()=>{r||h({})},[r]),(0,ey.isAdminRole)(e))?(0,t.jsxs)(u.Modal,{title:(0,t.jsxs)("div",{className:"flex items-center space-x-3 pb-4 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-2xl",children:"🔍"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New Search Tool"})]}),open:r,width:800,onCancel:()=>{o.resetFields(),h({}),n(!1)},footer:null,className:"top-8",styles:{body:{padding:"24px"},header:{padding:"24px 24px 0 24px",border:"none"}},children:[(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsxs)(p.Form,{form:o,onFinish:S,onValuesChange:(e,t)=>h(t),layout:"vertical",className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Search Tool Name",(0,t.jsx)(eu.Tooltip,{title:"A unique name to identify this search tool configuration (e.g., 'perplexity-search', 'tavily-news-search').",children:(0,t.jsx)(C.InfoCircleOutlined,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"search_tool_name",rules:[{required:!0,message:"Please enter a search tool name"},{pattern:/^[a-zA-Z0-9_-]+$/,message:"Name can only contain letters, numbers, hyphens, and underscores"}],children:(0,t.jsx)(eV.TextInput,{placeholder:"e.g., perplexity-search, my-tavily-tool",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Search Provider",(0,t.jsx)(eu.Tooltip,{title:"Select the search provider you want to use. Each provider has different capabilities and pricing.",children:(0,t.jsx)(C.InfoCircleOutlined,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"search_provider",rules:[{required:!0,message:"Please select a search provider"}],children:(0,t.jsx)(g.Select,{placeholder:"Select a search provider",className:"rounded-lg",size:"large",loading:w,showSearch:!0,optionFilterProp:"children",optionLabelProp:"label",children:k.map(e=>(0,t.jsx)(g.Select.Option,{value:e.provider_name,label:(0,t.jsx)(s7,{providerName:e.provider_name,displayName:e.ui_friendly_name}),children:(0,t.jsx)(s7,{providerName:e.provider_name,displayName:e.ui_friendly_name})},e.provider_name))})}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center",children:["API Key",(0,t.jsx)(eu.Tooltip,{title:"The API key for authenticating with the search provider. This will be securely stored.",children:(0,t.jsx)(C.InfoCircleOutlined,{className:"ml-2 text-blue-400 hover:text-blue-600 cursor-help"})})]}),name:"api_key",rules:[{required:!1,message:"Please enter an API key"}],children:(0,t.jsx)(eV.TextInput,{type:"password",placeholder:"Enter your API key",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),(0,t.jsx)(p.Form.Item,{label:(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Description (Optional)"}),name:"description",children:(0,t.jsx)(s8,{rows:3,placeholder:"Brief description of this search tool's purpose",className:"rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"})})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center pt-6 border-t border-gray-100",children:[(0,t.jsx)(eu.Tooltip,{title:"Get help on our github",children:(0,t.jsx)(sz.Typography.Link,{href:"https://github.com/BerriAI/litellm/issues",target:"_blank",children:"Need Help?"})}),(0,t.jsxs)("div",{className:"space-x-2",children:[(0,t.jsx)(m.Button,{onClick:T,loading:f,children:"Test Connection"}),(0,t.jsx)(m.Button,{loading:d,type:"submit",children:"Add Search Tool"})]})]})]})}),(0,t.jsx)(u.Modal,{title:"Connection Test Results",open:j,onCancel:()=>{y(!1),b(!1)},footer:[(0,t.jsx)(m.Button,{onClick:()=>{y(!1),b(!1)},children:"Close"},"close")],width:700,children:j&&s&&(0,t.jsx)(s3,{litellmParams:{search_provider:x.search_provider,api_key:x.api_key,api_base:x.api_base},accessToken:s,onTestComplete:()=>b(!1)},_)})]}):null};var ae=e.i(678784),at=e.i(118366),as=e.i(928685);let{Text:aa}=sz.Typography,al=({searchToolName:e,accessToken:s,className:a=""})=>{let[r,n]=(0,i.useState)(""),[o,d]=(0,i.useState)(!1),[c,m]=(0,i.useState)([]),[u,x]=(0,i.useState)({}),[p,g]=(0,i.useState)(!1),y=async()=>{if(!r.trim())return void h.message.warning("Please enter a search query");d(!0);let t=performance.now();try{let a=await (0,l.searchToolQueryCall)(s,e,r),i=performance.now(),n=Math.round(i-t),o={query:r,response:a,timestamp:Date.now(),latency:n};m(e=>[o,...e])}catch(e){console.error("Error querying search tool:",e),eM.default.fromBackend("Failed to query search tool")}finally{d(!1)}},f=e=>new Date(e).toLocaleString(),b=(0,t.jsx)(tN.LoadingOutlined,{style:{fontSize:24},spin:!0}),_=c.length>0?c[0]:null;return(0,t.jsxs)(ef.Card,{className:"mt-6",children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)(eb.Title,{children:"Test Search Tool"})}),(0,t.jsxs)("div",{className:"flex flex-col",style:{minHeight:"600px"},children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("div",{className:"flex items-stretch gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center flex-1 bg-white rounded-lg px-4 transition-all duration-200",style:{border:p?"2px solid #3b82f6":"2px solid #e5e7eb",boxShadow:p?"0 0 0 3px rgba(59, 130, 246, 0.1)":"0 1px 2px 0 rgba(0, 0, 0, 0.05)",height:"48px"},children:[(0,t.jsx)(as.SearchOutlined,{className:"text-gray-400 mr-3",style:{fontSize:"18px"}}),(0,t.jsx)(j.Input,{value:r,onChange:e=>n(e.target.value),onFocus:()=>g(!0),onBlur:()=>g(!1),onPressEnter:e=>{e.shiftKey||(e.preventDefault(),y())},placeholder:"Enter your search query...",disabled:o,bordered:!1,style:{fontSize:"15px",padding:0,height:"100%",boxShadow:"none"}})]}),(0,t.jsx)(A.Button,{type:"primary",onClick:y,disabled:o||!r.trim(),icon:(0,t.jsx)(as.SearchOutlined,{}),loading:o,style:{height:"48px",paddingLeft:"24px",paddingRight:"24px",borderRadius:"8px",fontWeight:500,fontSize:"15px",backgroundColor:o||!r.trim()?void 0:"#1890ff",borderColor:o||!r.trim()?void 0:"#1890ff",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"},children:"Search"})]})}),(0,t.jsx)("div",{className:"flex-1",children:_||o?(0,t.jsxs)("div",{children:[o&&(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center py-16",children:[(0,t.jsx)(eS.Spin,{indicator:b}),(0,t.jsx)(aa,{className:"mt-4 text-gray-600 font-medium",children:"Searching..."})]}),_&&!o&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",style:{boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"},children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(aa,{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Search Query"}),(0,t.jsx)("div",{className:"text-base font-semibold text-gray-900 mt-1.5",children:_.query})]}),(0,t.jsxs)("div",{className:"text-right ml-4",children:[(0,t.jsx)(aa,{className:"text-xs text-gray-500",children:f(_.timestamp)}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,t.jsxs)("div",{className:"text-sm font-semibold text-blue-600",children:[_.response?.results?.length||0," ",_.response?.results?.length===1?"result":"results"]}),void 0!==_.latency&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"•"}),(0,t.jsxs)("div",{className:"text-sm font-semibold text-green-600",children:[_.latency,"ms"]})]})]})]})]})}),_.response&&_.response.results&&_.response.results.length>0?(0,t.jsx)("div",{className:"space-y-3",children:_.response.results.map((e,s)=>{let a=u[`0-${s}`]||!1;return(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden transition-all duration-200",style:{boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"},onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",e.currentTarget.style.borderColor="#e0e7ff"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="0 1px 2px 0 rgba(0, 0, 0, 0.05)",e.currentTarget.style.borderColor="#e5e7eb"},children:(0,t.jsxs)("div",{className:"p-5",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-2",children:[(0,t.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-lg font-semibold text-blue-600 hover:text-blue-700 flex-1 leading-snug",style:{textDecoration:"none"},onMouseEnter:e=>e.currentTarget.style.textDecoration="underline",onMouseLeave:e=>e.currentTarget.style.textDecoration="none",children:e.title}),(0,t.jsx)(A.Button,{type:"text",size:"small",className:"flex-shrink-0",icon:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),onClick:()=>window.open(e.url,"_blank"),style:{color:"#6b7280"}})]}),(0,t.jsx)("div",{className:"text-sm text-green-700 mb-3 truncate font-medium",children:e.url}),(0,t.jsx)("div",{className:"text-sm text-gray-700 leading-relaxed",children:a?e.snippet:`${e.snippet.substring(0,200)}${e.snippet.length>200?"...":""}`}),e.snippet.length>200&&(0,t.jsx)(A.Button,{type:"link",size:"small",className:"mt-3 p-0 h-auto",onClick:()=>{let e;return e=`0-${s}`,void x(t=>({...t,[e]:!t[e]}))},style:{fontSize:"13px",fontWeight:500,color:"#3b82f6"},children:a?"Show less":"Show more"})]})},s)})}):(0,t.jsxs)("div",{className:"text-center py-12 bg-gray-50 border border-gray-200 rounded-lg",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 mx-auto mb-4",children:(0,t.jsx)(as.SearchOutlined,{style:{fontSize:"24px",color:"#9ca3af"}})}),(0,t.jsx)(aa,{className:"text-gray-600 font-medium",children:"No results found"}),(0,t.jsx)(aa,{className:"text-sm text-gray-500 mt-1",children:"Try a different search query"})]})]}),c.length>1&&(0,t.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)(aa,{className:"text-sm font-semibold text-gray-700",children:"Previous Searches"}),(0,t.jsx)(A.Button,{onClick:()=>{m([]),x({}),eM.default.success("Search history cleared")},size:"small",type:"link",style:{fontSize:"13px",fontWeight:500},children:"Clear All"})]}),(0,t.jsx)("div",{className:"space-y-2",children:c.slice(1,6).map((e,s)=>(0,t.jsxs)("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg cursor-pointer transition-all duration-200 hover:bg-gray-100 hover:border-gray-300",onClick:()=>{n(e.query)},children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-800 truncate",children:e.query}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1.5 flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"font-medium text-blue-600",children:[e.response?.results?.length||0," ",e.response?.results?.length===1?"result":"results"]}),void 0!==e.latency&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{className:"font-medium text-green-600",children:[e.latency,"ms"]})]}),(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("span",{children:f(e.timestamp)})]})]},s+1))})]})]}):(0,t.jsxs)("div",{className:"h-full flex flex-col items-center justify-center p-8",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-24 h-24 rounded-full bg-gray-100 mb-6",children:(0,t.jsx)(as.SearchOutlined,{style:{fontSize:"48px",color:"#9ca3af"}})}),(0,t.jsx)(aa,{className:"text-lg text-gray-600 font-medium",children:"Test your search tool"}),(0,t.jsx)(aa,{className:"text-sm text-gray-500 mt-2",children:"Enter a query above to see search results"})]})})]})]})},ar=({searchTool:e,onBack:s,isEditing:a,accessToken:l,availableProviders:r})=>{var n;let o,[d,c]=(0,i.useState)({}),u=async(e,t)=>{await (0,tC.copyToClipboard)(e)&&(c(e=>({...e,[t]:!0})),setTimeout(()=>{c(e=>({...e,[t]:!1}))},2e3))};return(0,t.jsxs)("div",{className:"p-4 max-w-full",children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Button,{icon:eI.ArrowLeftIcon,variant:"light",className:"mb-4",onClick:s,children:"Back to All Search Tools"}),(0,t.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,t.jsx)(eb.Title,{children:e.search_tool_name}),(0,t.jsx)(A.Button,{type:"text",size:"small",icon:d["search-tool-name"]?(0,t.jsx)(ae.CheckIcon,{size:12}):(0,t.jsx)(at.CopyIcon,{size:12}),onClick:()=>u(e.search_tool_name,"search-tool-name"),className:`left-2 z-10 transition-all duration-200 ${d["search-tool-name"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`})]}),(0,t.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,t.jsx)(e_.Text,{className:"text-gray-500 font-mono",children:e.search_tool_id}),(0,t.jsx)(A.Button,{type:"text",size:"small",icon:d["search-tool-id"]?(0,t.jsx)(ae.CheckIcon,{size:12}):(0,t.jsx)(at.CopyIcon,{size:12}),onClick:()=>u(e.search_tool_id,"search-tool-id"),className:`left-2 z-10 transition-all duration-200 ${d["search-tool-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`})]})]})}),(0,t.jsxs)(t4.Grid,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,t.jsxs)(ef.Card,{children:[(0,t.jsx)(e_.Text,{children:"Provider"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(eb.Title,{children:(n=e.litellm_params.search_provider,o=r.find(e=>e.provider_name===n),o?.ui_friendly_name||n)})})]}),(0,t.jsxs)(ef.Card,{children:[(0,t.jsx)(e_.Text,{children:"API Key"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(e_.Text,{children:e.litellm_params.api_key?"****":"Not set"})})]}),(0,t.jsxs)(ef.Card,{children:[(0,t.jsx)(e_.Text,{children:"Created At"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(e_.Text,{children:e.created_at?new Date(e.created_at).toLocaleString():"Unknown"})})]})]}),e.search_tool_info?.description&&(0,t.jsxs)(ef.Card,{className:"mt-6",children:[(0,t.jsx)(e_.Text,{children:"Description"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(e_.Text,{children:e.search_tool_info.description})})]}),(0,t.jsx)("div",{className:"mt-6",children:l&&(0,t.jsx)(al,{searchToolName:e.search_tool_name,accessToken:l})})]})},ai=({accessToken:e,userRole:s,userID:a})=>{let{data:r,isLoading:n,refetch:o}=(0,t1.useQuery)({queryKey:["searchTools"],queryFn:()=>{if(!e)throw Error("Access Token required");return(0,l.fetchSearchTools)(e).then(e=>e.search_tools||[])},enabled:!!e}),{data:d,isLoading:c}=(0,t1.useQuery)({queryKey:["searchProviders"],queryFn:()=>{if(!e)throw Error("Access Token required");return(0,l.fetchAvailableSearchProviders)(e)},enabled:!!e}),x=d?.providers||[],[h,y]=(0,i.useState)(null),[f,_]=(0,i.useState)(!1),[v,N]=(0,i.useState)(!1),[w,k]=(0,i.useState)(null),[C,S]=(0,i.useState)(!1),[T,I]=(0,i.useState)(!1),[F,A]=(0,i.useState)(!1),[P]=p.Form.useForm(),L=i.default.useMemo(()=>{let e,s,a;return e=e=>{k(e),S(!1)},s=e=>{let t=r?.find(t=>t.search_tool_id===e);t&&(P.setFieldsValue({search_tool_name:t.search_tool_name,search_provider:t.litellm_params.search_provider,api_key:t.litellm_params.api_key,api_base:t.litellm_params.api_base,timeout:t.litellm_params.timeout,max_retries:t.litellm_params.max_retries,description:t.search_tool_info?.description}),k(e),A(!0))},a=M,[{title:"Search Tool ID",dataIndex:"search_tool_id",key:"search_tool_id",render:(s,a)=>a.is_from_config?(0,t.jsx)("span",{className:"text-xs",children:"-"}):(0,t.jsx)("button",{onClick:()=>e(a.search_tool_id),className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left cursor-pointer max-w-40",children:(0,t.jsx)("span",{className:"truncate block",children:a.search_tool_id})})},{title:"Name",dataIndex:"search_tool_name",key:"search_tool_name",render:e=>(0,t.jsx)("span",{className:"font-medium",children:e})},{title:"Provider",key:"provider",render:(e,s)=>{let a=s.litellm_params.search_provider,l=x.find(e=>e.provider_name===a),r=l?.ui_friendly_name||a;return(0,t.jsx)("span",{className:"text-sm",children:r})}},{title:"Created At",dataIndex:"created_at",key:"created_at",render:(e,s)=>(0,t.jsx)("span",{className:"text-xs",children:s.created_at?new Date(s.created_at).toLocaleDateString():"-"})},{title:"Updated At",dataIndex:"updated_at",key:"updated_at",render:(e,s)=>(0,t.jsx)("span",{className:"text-xs",children:s.updated_at?new Date(s.updated_at).toLocaleDateString():"-"})},{title:"Source",key:"source",render:(e,s)=>{let a=s.is_from_config??!1;return(0,t.jsx)(b.Tag,{color:a?"default":"blue",children:a?"Config":"DB"})}},{title:"Actions",key:"actions",render:(e,l)=>{let r=l.search_tool_id,i=l.is_from_config??!1;return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(sK.default,{variant:"Edit",tooltipText:"Edit search tool",disabled:i,disabledTooltipText:"Config search tool cannot be edited on the dashboard. Please edit it from the config file.",onClick:()=>{r&&!i&&s(r)}}),(0,t.jsx)(sK.default,{variant:"Delete",tooltipText:"Delete search tool",disabled:i,disabledTooltipText:"Config search tool cannot be deleted on the dashboard. Please delete it from the config file.",onClick:()=>{r&&!i&&a(r)}})]})}}]},[x,r,P]);function M(e){y(e),_(!0)}let D=async()=>{if(null!=h&&null!=e){N(!0);try{await (0,l.deleteSearchTool)(e,h),eM.default.success("Deleted search tool successfully"),_(!1),y(null),o()}catch(e){console.error("Error deleting the search tool:",e),eM.default.error("Failed to delete search tool")}finally{N(!1)}}},E=r?.find(e=>e.search_tool_id===h),O=E?x.find(e=>e.provider_name===E.litellm_params.search_provider):null,z=async()=>{if(e&&w)try{let t=await P.validateFields(),s={search_tool_name:t.search_tool_name,litellm_params:{search_provider:t.search_provider,api_key:t.api_key,api_base:t.api_base,timeout:t.timeout?parseFloat(t.timeout):void 0,max_retries:t.max_retries?parseInt(t.max_retries):void 0},search_tool_info:t.description?{description:t.description}:void 0};await (0,l.updateSearchTool)(e,w,s),eM.default.success("Search tool updated successfully"),A(!1),P.resetFields(),k(null),o()}catch(e){console.error("Failed to update search tool:",e),eM.default.error("Failed to update search tool")}};return e&&s&&a?(0,t.jsxs)("div",{className:"w-full h-full p-6",children:[(0,t.jsx)(sH.default,{isOpen:f,title:"Delete Search Tool",message:"Are you sure you want to delete this search tool? This action cannot be undone.",resourceInformationTitle:"Search Tool Information",resourceInformation:E?[{label:"Name",value:E.search_tool_name},{label:"ID",value:E.search_tool_id,code:!0},{label:"Provider",value:O?.ui_friendly_name||E.litellm_params.search_provider},{label:"Description",value:E.search_tool_info?.description||"-"}]:[],onCancel:()=>{_(!1),y(null)},onOk:D,confirmLoading:v}),(0,t.jsx)(s9,{userRole:s,accessToken:e,onCreateSuccess:e=>{I(!1),o()},isModalVisible:T,setModalVisible:I}),(0,t.jsx)(u.Modal,{title:"Edit Search Tool",open:F,onOk:z,onCancel:()=>{A(!1),P.resetFields(),k(null)},width:600,children:(0,t.jsxs)(p.Form,{form:P,layout:"vertical",children:[(0,t.jsx)(p.Form.Item,{name:"search_tool_name",label:"Search Tool Name",rules:[{required:!0,message:"Please enter a search tool name"}],children:(0,t.jsx)(j.Input,{placeholder:"e.g., my-perplexity-search"})}),(0,t.jsx)(p.Form.Item,{name:"search_provider",label:"Search Provider",rules:[{required:!0,message:"Please select a search provider"}],children:(0,t.jsx)(g.Select,{placeholder:"Select a search provider",loading:c,children:x.map(e=>(0,t.jsx)(g.Select.Option,{value:e.provider_name,children:e.ui_friendly_name},e.provider_name))})}),(0,t.jsx)(p.Form.Item,{name:"api_key",label:"API Key",extra:"API key for the search provider",children:(0,t.jsx)(j.Input.Password,{placeholder:"Enter API key"})}),(0,t.jsx)(p.Form.Item,{name:"description",label:"Description",children:(0,t.jsx)(j.Input.TextArea,{rows:3,placeholder:"Description of this search tool"})})]})}),(0,t.jsx)(eb.Title,{children:"Search Tools"}),(0,t.jsx)(e_.Text,{className:"text-tremor-content mt-2",children:"Configure and manage your search providers"}),(0,ey.isAdminRole)(s)&&(0,t.jsx)(m.Button,{className:"mt-4 mb-4",onClick:()=>I(!0),children:"+ Add New Search Tool"}),(0,t.jsx)(()=>w?(0,t.jsx)(ar,{searchTool:r?.find(e=>e.search_tool_id===w)||{search_tool_id:"",search_tool_name:"",litellm_params:{search_provider:""}},onBack:()=>{S(!1),k(null),o()},isEditing:C,accessToken:e,availableProviders:x}):(0,t.jsx)("div",{className:"w-full h-full",children:(0,t.jsx)(eS.Spin,{spinning:n,indicator:(0,t.jsx)(tN.LoadingOutlined,{spin:!0}),size:"large",children:(0,t.jsx)(tt.Table,{bordered:!0,dataSource:r||[],columns:L,rowKey:e=>e.search_tool_id||e.search_tool_name,pagination:!1,locale:{emptyText:"No search tools configured"},size:"small"})})}),{})]}):(console.log("Missing required authentication parameters",{accessToken:e,userRole:s,userID:a}),(0,t.jsx)("div",{className:"p-6 text-center text-gray-500",children:"Missing required authentication parameters."}))};var an=e.i(700904),ao=e.i(686311),ad=e.i(37727),ac=e.i(643531),am=e.i(636772),au=e.i(115571);function ax({onOpen:e,onDismiss:s,isVisible:a,title:l,description:r,buttonText:n,icon:o,accentColor:d,buttonStyle:c}){let m=(0,am.useDisableShowPrompts)(),[u,x]=(0,i.useState)(100),[p,h]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{if(!a){x(100),h(!1);return}let e=Date.now(),t=setInterval(()=>{let s=Math.max(0,100-(Date.now()-e)/15e3*100);x(s),s<=0&&clearInterval(t)},50);return()=>clearInterval(t)},[a]),(0,i.useEffect)(()=>{if(p){let e=setTimeout(()=>{h(!1),s()},5e3);return()=>clearTimeout(e)}},[p,s]),p)?(0,t.jsx)("div",{className:`fixed bottom-6 right-6 z-40 w-80 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden transform transition-all duration-300 ease-out ${a?"translate-y-0 opacity-100 scale-100":"translate-y-4 opacity-0 scale-95"}`,children:(0,t.jsx)("div",{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:(0,t.jsx)(ac.Check,{className:"h-5 w-5 text-green-600"})}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("p",{className:"text-sm text-gray-700 font-medium",children:"Got it, we will not ask again. Reactivate this at any time in the User Menu."})})]})})}):!a||m?null:(0,t.jsxs)("div",{className:`fixed bottom-6 right-6 z-40 w-80 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden transform transition-all duration-300 ease-out ${a?"translate-y-0 opacity-100 scale-100":"translate-y-4 opacity-0 scale-95"}`,children:[(0,t.jsx)("div",{className:"h-1 bg-gray-100 w-full",children:(0,t.jsx)("div",{className:"h-full transition-all duration-100 ease-linear",style:{width:`${u}%`,backgroundColor:d}})}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",style:{color:d},children:[(0,t.jsx)(o,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-semibold text-sm",children:l})]}),(0,t.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors p-0.5 rounded hover:bg-gray-100",children:(0,t.jsx)(ad.X,{className:"h-4 w-4"})})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:r}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(A.Button,{type:"primary",block:!0,onClick:e,style:c,children:n}),(0,t.jsx)(A.Button,{variant:"outlined",danger:!0,block:!0,onClick:()=>{(0,au.setLocalStorageItem)("disableShowPrompts","true"),(0,au.emitLocalStorageChange)("disableShowPrompts"),h(!0)},className:"text-xs",children:"Don't ask me again"})]})]})]})}function ap({onOpen:e,onDismiss:s,isVisible:a}){return(0,t.jsx)(ax,{onOpen:e,onDismiss:s,isVisible:a,title:"Quick feedback",description:"Help us improve LiteLLM! Share your experience in 5 quick questions.",buttonText:"Share feedback",icon:ao.MessageSquare,accentColor:"#3b82f6"})}var ah=e.i(972520),ag=e.i(180127),ag=ag,aj=e.i(770914),ay=e.i(497650),af=e.i(536916);let ab=[{id:"oss_adoption",label:"OSS Adoption",description:"Stars, contributors, forks, community support"},{id:"ai_integration",label:"AI Integration",description:"LiteLLM had the logging/guardrail integration we needed - Langfuse, OTEL, S3 logging, Azure Content Safety guardrails"},{id:"unified_api",label:"Unified API",description:"LiteLLM had the best OpenAI-compatible API across providers - OpenAI, Anthropic, Gemini, etc."},{id:"breadth_of_models",label:"Breadth of Models/Providers",description:"LiteLLM had the provider + endpoint combinations we needed - /ocr endpoint with Mistral OCR, /batches endppint with Bedrock API, etc."},{id:"other",label:"Other",description:"Something else not listed above"}];function a_({isOpen:e,onClose:s,onComplete:a}){let[l,r]=(0,i.useState)(1),[n,o]=(0,i.useState)({usingAtCompany:null,companyName:"",startDate:"",reasons:[],otherReason:"",email:""}),[d,c]=(0,i.useState)(!1),m=!0===n.usingAtCompany?5:4;if(!e)return null;let u=async()=>{c(!0);try{let e={oss_adoption:"OSS Adoption (stars, contributors, forks)",ai_integration:"AI Integration (Langfuse, OTEL, S3, Azure Content Safety)",unified_api:"Unified API (OpenAI-compatible)",breadth_of_models:"Breadth of Models/Providers (/ocr, /batches, Bedrock, Azure OCR)"},t=n.reasons.map(t=>"other"===t&&n.otherReason?`Other: ${n.otherReason}`:e[t]||t),s=new URLSearchParams({"entry.2015264290":n.usingAtCompany?"Yes":"No","entry.1876243786":n.companyName||"","entry.1282591459":n.startDate,"entry.393456108":t.join(", "),"entry.928142208":n.email||""});await fetch("https://feedback.litellm.ai/survey",{method:"POST",mode:"no-cors",body:s})}catch(e){console.error("Failed to submit survey:",e)}c(!1),a()},x=(e,t)=>{o(s=>({...s,[e]:t}))},p=e=>{o(t=>({...t,reasons:t.reasons.includes(e)?t.reasons.filter(t=>t!==e):[...t.reasons,e]}))},h=()=>{if(!1===n.usingAtCompany){if(1===l)return 1;if(3===l)return 2;if(4===l)return 3;if(5===l)return 4}return l},g=5===l;return(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm",onClick:s}),(0,t.jsxs)("div",{className:"relative w-full max-w-lg bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] transform transition-all duration-300 ease-out",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-gray-50/50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[(0,t.jsx)(ao.MessageSquare,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-semibold text-sm tracking-wide uppercase",children:"Quick Feedback"})]}),(0,t.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100",children:(0,t.jsx)(ad.X,{className:"h-5 w-5"})})]}),(0,t.jsx)(ay.Progress,{percent:h()/m*100,showInfo:!1,strokeColor:"#2563eb",className:"m-0"}),(0,t.jsx)("div",{className:"p-8 flex-1 overflow-y-auto",children:1===l?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Are you using LiteLLM at your company?"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Help us understand how our product is being used in professional environments."}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4",children:[(0,t.jsxs)("button",{onClick:()=>x("usingAtCompany",!0),className:`p-6 rounded-lg border-2 text-left transition-all ${!0===n.usingAtCompany?"border-blue-600 bg-blue-50 ring-1 ring-blue-600":"border-gray-200 hover:border-blue-300 hover:bg-gray-50"}`,children:[(0,t.jsx)("span",{className:"block text-lg font-semibold text-gray-900 mb-1",children:"Yes"}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"We use it for work"})]}),(0,t.jsxs)("button",{onClick:()=>x("usingAtCompany",!1),className:`p-6 rounded-lg border-2 text-left transition-all ${!1===n.usingAtCompany?"border-blue-600 bg-blue-50 ring-1 ring-blue-600":"border-gray-200 hover:border-blue-300 hover:bg-gray-50"}`,children:[(0,t.jsx)("span",{className:"block text-lg font-semibold text-gray-900 mb-1",children:"No"}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Personal project / Hobby"})]})]})]}):2===l&&!0===n.usingAtCompany?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"What company are you using LiteLLM at?"}),(0,t.jsx)("p",{className:"text-gray-500",children:"This helps us understand our user base better."}),(0,t.jsx)(j.Input,{size:"large",placeholder:"Enter your company name",value:n.companyName,onChange:e=>x("companyName",e.target.value),autoFocus:!0})]}):3===l?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"When did you start using LiteLLM?"}),(0,t.jsx)(f.Radio.Group,{value:n.startDate,onChange:e=>x("startDate",e.target.value),className:"w-full",children:(0,t.jsx)(aj.Space,{direction:"vertical",className:"w-full",children:["Less than a month ago","1-3 months ago","3-6 months ago","More than 6 months ago"].map(e=>(0,t.jsx)("label",{className:`flex items-center p-4 rounded-lg border cursor-pointer transition-all w-full ${n.startDate===e?"border-blue-600 bg-blue-50 ring-1 ring-blue-600":"border-gray-200 hover:bg-gray-50"}`,children:(0,t.jsx)(f.Radio,{value:e,children:e})},e))})})]}):4===l?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Why did you pick LiteLLM over other AI Gateways?"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Select all that apply."}),(0,t.jsx)("div",{className:"space-y-3",children:ab.map(e=>{let s=n.reasons.includes(e.id);return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{role:"button",tabIndex:0,onClick:()=>p(e.id),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),p(e.id))},className:`flex items-start p-4 rounded-lg border cursor-pointer transition-all ${s?"border-blue-600 bg-blue-50 ring-1 ring-blue-600":"border-gray-200 hover:bg-gray-50"}`,children:[(0,t.jsx)(af.Checkbox,{checked:s,className:"mt-0.5 pointer-events-none"}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("span",{className:"block font-medium text-gray-900",children:e.label}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:e.description})]})]}),"other"===e.id&&s&&(0,t.jsx)(j.Input,{className:"mt-2 ml-7",placeholder:"Please specify...",value:n.otherReason,onChange:e=>x("otherReason",e.target.value),onClick:e=>e.stopPropagation(),autoFocus:!0})]},e.id)})})]}):5===l?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Want to share more?"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Leave your email and we may reach out to learn more about your experience. This is completely optional."}),(0,t.jsx)(j.Input,{size:"large",type:"email",placeholder:"your@email.com (optional)",value:n.email,onChange:e=>x("email",e.target.value),autoFocus:!0}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:"We will only use this to follow up on your feedback. No spam, ever."})]}):null}),(0,t.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-500 font-medium",children:["Step ",h()," of ",m]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[l>1&&(0,t.jsx)(A.Button,{onClick:()=>{3===l&&!1===n.usingAtCompany?r(1):r(l-1)},disabled:d,icon:(0,t.jsx)(ag.default,{className:"h-4 w-4"}),children:"Back"}),(0,t.jsxs)(A.Button,{type:"primary",onClick:()=>{1===l&&!1===n.usingAtCompany?r(3):l<5?r(l+1):u()},disabled:!(1===l?null!==n.usingAtCompany:2===l?n.companyName.trim().length>0:3===l?""!==n.startDate:4===l?n.reasons.includes("other")?n.reasons.length>0&&n.otherReason.trim().length>0:n.reasons.length>0:5===l)||d,loading:d,className:"min-w-[100px]",children:[g?"Submit":"Next",!g&&(0,t.jsx)(ah.ArrowRight,{className:"ml-2 h-4 w-4"})]})]})]})]})]})}var av=e.i(758472);function aN({onOpen:e,onDismiss:s,isVisible:a}){return(0,t.jsx)(ax,{onOpen:e,onDismiss:s,isVisible:a,title:"Claude Code Feedback",description:"Help us improve your Claude Code experience with LiteLLM! Share your feedback in 4 quick questions.",buttonText:"Share feedback",icon:av.Code,accentColor:"#7c3aed",buttonStyle:{backgroundColor:"#7c3aed",borderColor:"#7c3aed"}})}function aw({isOpen:e,onClose:s,onComplete:a}){return e?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm",onClick:s}),(0,t.jsxs)("div",{className:"relative w-full max-w-md bg-white rounded-xl shadow-2xl overflow-hidden transform transition-all duration-300 ease-out",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-gray-50/50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-purple-600",children:[(0,t.jsx)(av.Code,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-semibold text-sm tracking-wide uppercase",children:"Claude Code Feedback"})]}),(0,t.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100",children:(0,t.jsx)(ad.X,{className:"h-5 w-5"})})]}),(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Help us improve your experience"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"We'd love to hear about your experience using LiteLLM with Claude Code. Your feedback helps us improve the product for everyone."}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"This brief survey takes about 2-3 minutes to complete."}),(0,t.jsx)(A.Button,{type:"primary",size:"large",block:!0,onClick:()=>{window.open("https://forms.gle/LZeJQ3XytBakckYa9","_blank","noopener,noreferrer"),a()},icon:(0,t.jsx)(t$.ExternalLink,{className:"h-4 w-4"}),style:{backgroundColor:"#7c3aed",borderColor:"#7c3aed"},children:"Open Feedback Form"})]})]})]}):null}var ak=e.i(345244),aC=e.i(662316),aS=e.i(208075),aT=e.i(735042),aI=e.i(693569),aF=e.i(263147),aA=e.i(954616),aP=e.i(912598);let aL=async(e,t)=>{let s=(0,l.getProxyBaseUrl)(),a=`${s}/v1/access_group/${encodeURIComponent(t)}`,r=await fetch(a,{method:"DELETE",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"}});if(!r.ok){let e=await r.json(),t=(0,l.deriveErrorMessage)(e);throw(0,l.handleError)(t),Error(t)}};var aM=e.i(152990),aD=e.i(682830),aE=e.i(525720),aO=e.i(372943),az=e.i(165370),az=az,aR=e.i(368869),aB=e.i(657150),aB=aB,aq=e.i(475254);let a$=(0,aq.default)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);var aU=e.i(54943),aU=aU,aV=e.i(302202),aG=e.i(446891);let aH=async(e,t)=>{let s=(0,l.getProxyBaseUrl)(),a=`${s}/v1/access_group/${encodeURIComponent(t)}`,r=await fetch(a,{method:"GET",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"}});if(!r.ok){let e=await r.json(),t=(0,l.deriveErrorMessage)(e);throw(0,l.handleError)(t),Error(t)}return r.json()};var aK=e.i(21548),aW=e.i(573421),aQ=e.i(516430),aB=aB,aY=e.i(823429),aY=aY,aJ=e.i(438100),aX=e.i(98740),aX=aX,aZ=e.i(304911),a0=e.i(289793),a1=e.i(500727),aB=aB,a2=e.i(879664),a2=a2;let{TextArea:a4}=j.Input;function a5({form:e,isNameDisabled:s=!1}){let{data:a}=(0,a0.useAgents)(),{data:l}=(0,a1.useMCPServers)(),r=a?.agents??[],i=[{key:"1",label:(0,t.jsxs)(aj.Space,{align:"center",size:4,children:[(0,t.jsx)(a2.default,{size:16}),"General Info"]}),children:(0,t.jsxs)("div",{style:{paddingTop:16},children:[(0,t.jsx)(p.Form.Item,{name:"name",label:"Group Name",rules:[{required:!0,message:"Please enter the access group name"}],children:(0,t.jsx)(j.Input,{placeholder:"e.g. Engineering Team",disabled:s})}),(0,t.jsx)(p.Form.Item,{name:"description",label:"Description",children:(0,t.jsx)(a4,{rows:4,placeholder:"Describe the purpose of this access group..."})})]})},{key:"2",label:(0,t.jsxs)(aj.Space,{align:"center",size:4,children:[(0,t.jsx)(a$,{size:16}),"Models"]}),children:(0,t.jsx)("div",{style:{paddingTop:16},children:(0,t.jsx)(p.Form.Item,{name:"modelIds",label:"Allowed Models",children:(0,t.jsx)(sW.ModelSelect,{context:"global",value:e.getFieldValue("modelIds")??[],onChange:t=>e.setFieldsValue({modelIds:t}),style:{width:"100%"}})})})},{key:"3",label:(0,t.jsxs)(aj.Space,{align:"center",size:4,children:[(0,t.jsx)(aV.ServerIcon,{size:16}),"MCP Servers"]}),children:(0,t.jsx)("div",{style:{paddingTop:16},children:(0,t.jsx)(p.Form.Item,{name:"mcpServerIds",label:"Allowed MCP Servers",children:(0,t.jsx)(g.Select,{mode:"multiple",placeholder:"Select MCP servers",style:{width:"100%"},optionFilterProp:"label",allowClear:!0,options:(l??[]).map(e=>({label:e.server_name??e.server_id,value:e.server_id}))})})})},{key:"4",label:(0,t.jsxs)(aj.Space,{align:"center",size:4,children:[(0,t.jsx)(aB.default,{size:16}),"Agents"]}),children:(0,t.jsx)("div",{style:{paddingTop:16},children:(0,t.jsx)(p.Form.Item,{name:"agentIds",label:"Allowed Agents",children:(0,t.jsx)(g.Select,{mode:"multiple",placeholder:"Select agents",style:{width:"100%"},optionFilterProp:"label",allowClear:!0,options:r.map(e=>({label:e.agent_name,value:e.agent_id}))})})})}];return(0,t.jsx)(p.Form,{form:e,layout:"vertical",name:"access_group_form",initialValues:{modelIds:[],mcpServerIds:[],agentIds:[]},children:(0,t.jsx)(t5.Tabs,{defaultActiveKey:"1",items:i})})}let a6=async(e,t,s)=>{let a=(0,l.getProxyBaseUrl)(),r=`${a}/v1/access_group/${encodeURIComponent(t)}`,i=await fetch(r,{method:"PUT",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok){let e=await i.json(),t=(0,l.deriveErrorMessage)(e);throw(0,l.handleError)(t),Error(t)}return i.json()};function a3({visible:e,accessGroup:s,onCancel:a,onSuccess:l}){let[n]=p.Form.useForm(),o=(()=>{let{accessToken:e}=(0,r.default)(),t=(0,aP.useQueryClient)();return(0,aA.useMutation)({mutationFn:async({accessGroupId:t,params:s})=>{if(!e)throw Error("Access token is required");return a6(e,t,s)},onSuccess:(e,{accessGroupId:s})=>{t.invalidateQueries({queryKey:aF.accessGroupKeys.all}),t.invalidateQueries({queryKey:aF.accessGroupKeys.detail(s)})}})})();return(0,i.useEffect)(()=>{e&&s&&n.setFieldsValue({name:s.access_group_name,description:s.description??"",modelIds:s.access_model_names??[],mcpServerIds:s.access_mcp_server_ids??[],agentIds:s.access_agent_ids??[]})},[e,s,n]),(0,t.jsx)(u.Modal,{title:"Edit Access Group",open:e,onOk:()=>{n.validateFields().then(e=>{let t={access_group_name:e.name,description:e.description,access_model_names:e.modelIds,access_mcp_server_ids:e.mcpServerIds,access_agent_ids:e.agentIds};o.mutate({accessGroupId:s.access_group_id,params:t},{onSuccess:()=>{h.message.success("Access group updated successfully"),l?.(),a()}})}).catch(e=>{console.log("Validate Failed:",e)})},onCancel:a,width:700,okText:"Save Changes",cancelText:"Cancel",confirmLoading:o.isPending,destroyOnHidden:!0,children:(0,t.jsx)(a5,{form:n})})}let{Title:a8,Text:a7}=sz.Typography,{Content:a9}=aO.Layout;function le({accessGroupId:e,onBack:s}){let{data:a,isLoading:l}=(e=>{let{accessToken:t,userRole:s}=(0,r.default)(),a=(0,aP.useQueryClient)();return(0,t1.useQuery)({queryKey:aF.accessGroupKeys.detail(e),queryFn:async()=>aH(t,e),enabled:!!(t&&e)&&ey.all_admin_roles.includes(s||""),initialData:()=>{if(!e)return;let t=a.getQueryData(aF.accessGroupKeys.list({}));return t?.find(t=>t.access_group_id===e)}})})(e),{token:n}=aR.theme.useToken(),[o,d]=(0,i.useState)(!1),[c,m]=(0,i.useState)(!1),[u,x]=(0,i.useState)(!1);if(l)return(0,t.jsx)(a9,{style:{padding:n.paddingLG,paddingInline:2*n.paddingLG},children:(0,t.jsx)(aE.Flex,{justify:"center",align:"center",style:{minHeight:300},children:(0,t.jsx)(eS.Spin,{size:"large"})})});if(!a)return(0,t.jsxs)(a9,{style:{padding:n.paddingLG,paddingInline:2*n.paddingLG},children:[(0,t.jsx)(A.Button,{icon:(0,t.jsx)(aQ.ArrowLeftIcon,{size:16}),onClick:s,type:"text",style:{marginBottom:16}}),(0,t.jsx)(aK.Empty,{description:"Access group not found"})]});let p=a.access_model_names??[],h=a.access_mcp_server_ids??[],g=a.access_agent_ids??[],j=a.assigned_key_ids??[],y=a.assigned_team_ids??[],f=c?j:j.slice(0,5),_=u?y:y.slice(0,5),v=[{key:"models",label:(0,t.jsxs)(aE.Flex,{align:"center",gap:8,children:[(0,t.jsx)(a$,{size:16}),"Models",(0,t.jsx)(b.Tag,{style:{marginInlineEnd:0},children:p?.length})]}),children:p?.length>0?(0,t.jsx)(aW.List,{grid:{gutter:16,xs:1,sm:2,md:3,lg:4},dataSource:p,renderItem:e=>(0,t.jsx)(aW.List.Item,{children:(0,t.jsx)(ec.Card,{size:"small",children:(0,t.jsx)(a7,{code:!0,children:e})})})}):(0,t.jsx)(aK.Empty,{description:"No models assigned to this group"})},{key:"mcp",label:(0,t.jsxs)(aE.Flex,{align:"center",gap:8,children:[(0,t.jsx)(aV.ServerIcon,{size:16}),"MCP Servers",(0,t.jsx)(b.Tag,{children:h?.length})]}),children:h?.length>0?(0,t.jsx)(aW.List,{grid:{gutter:16,xs:1,sm:2,md:3,lg:4},dataSource:h,renderItem:e=>(0,t.jsx)(aW.List.Item,{children:(0,t.jsx)(ec.Card,{size:"small",children:(0,t.jsx)(a7,{code:!0,children:e})})})}):(0,t.jsx)(aK.Empty,{description:"No MCP servers assigned to this group"})},{key:"agents",label:(0,t.jsxs)(aE.Flex,{align:"center",gap:8,children:[(0,t.jsx)(aB.default,{size:16}),"Agents",(0,t.jsx)(b.Tag,{children:g?.length})]}),children:g?.length>0?(0,t.jsx)(aW.List,{grid:{gutter:16,xs:1,sm:2,md:3,lg:4},dataSource:g,renderItem:e=>(0,t.jsx)(aW.List.Item,{children:(0,t.jsx)(ec.Card,{size:"small",children:(0,t.jsx)(a7,{code:!0,children:e})})})}):(0,t.jsx)(aK.Empty,{description:"No agents assigned to this group"})}];return(0,t.jsxs)(a9,{style:{padding:n.paddingLG,paddingInline:2*n.paddingLG},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,t.jsx)(A.Button,{icon:(0,t.jsx)(aQ.ArrowLeftIcon,{size:16}),onClick:s,type:"text"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(a8,{level:2,style:{margin:0},children:a.access_group_name}),(0,t.jsxs)(a7,{type:"secondary",children:["ID: ",(0,t.jsx)(a7,{copyable:!0,children:a.access_group_id})]})]})]}),(0,t.jsx)(A.Button,{type:"primary",icon:(0,t.jsx)(aY.default,{size:16}),onClick:()=>{d(!0)},children:"Edit Access Group"})]}),(0,t.jsx)(t_.Row,{style:{marginBottom:24},children:(0,t.jsx)(ec.Card,{children:(0,t.jsxs)(eT.Descriptions,{title:"Group Details",column:1,children:[(0,t.jsx)(eT.Descriptions.Item,{label:"Description",children:a.description||"—"}),(0,t.jsxs)(eT.Descriptions.Item,{label:"Created",children:[new Date(a.created_at).toLocaleString(),a.created_by&&(0,t.jsxs)(a7,{children:[" ","by"," ",(0,t.jsx)(aZ.default,{userId:a.created_by})]})]}),(0,t.jsxs)(eT.Descriptions.Item,{label:"Last Updated",children:[new Date(a.updated_at).toLocaleString(),a.updated_by&&(0,t.jsxs)(a7,{children:[" ","by"," ",(0,t.jsx)(aZ.default,{userId:a.updated_by})]})]})]})})}),(0,t.jsxs)(t_.Row,{gutter:[16,16],style:{marginBottom:24},children:[(0,t.jsx)(tv.Col,{xs:24,lg:12,children:(0,t.jsx)(ec.Card,{title:(0,t.jsxs)(aE.Flex,{align:"center",gap:8,children:[(0,t.jsx)(aJ.KeyIcon,{size:16}),"Attached Keys",(0,t.jsx)(b.Tag,{children:j?.length})]}),extra:j?.length>5?(0,t.jsx)(A.Button,{type:"link",onClick:()=>m(!c),children:c?"Show Less":`View All (${j?.length})`}):null,children:j?.length>0?(0,t.jsx)(aE.Flex,{wrap:"wrap",gap:8,children:f.map(e=>(0,t.jsx)(b.Tag,{children:(0,t.jsx)(a7,{code:!0,style:{fontSize:12},children:e.length>20?`${e.slice(0,10)}...${e.slice(-6)}`:e})},e))}):(0,t.jsx)(aK.Empty,{description:"No keys attached",image:aK.Empty.PRESENTED_IMAGE_SIMPLE})})}),(0,t.jsx)(tv.Col,{xs:24,lg:12,children:(0,t.jsx)(ec.Card,{title:(0,t.jsxs)(aE.Flex,{align:"center",gap:8,children:[(0,t.jsx)(aX.default,{size:16}),"Attached Teams",(0,t.jsx)(b.Tag,{children:y?.length})]}),extra:y?.length>5?(0,t.jsx)(A.Button,{type:"link",onClick:()=>x(!u),children:u?"Show Less":`View All (${y?.length})`}):null,children:y?.length>0?(0,t.jsx)(aE.Flex,{wrap:"wrap",gap:8,children:_.map(e=>(0,t.jsx)(b.Tag,{children:(0,t.jsx)(a7,{code:!0,style:{fontSize:12},children:e})},e))}):(0,t.jsx)(aK.Empty,{description:"No teams attached",image:aK.Empty.PRESENTED_IMAGE_SIMPLE})})})]}),(0,t.jsx)(ec.Card,{children:(0,t.jsx)(t5.Tabs,{defaultActiveKey:"models",items:v})}),(0,t.jsx)(a3,{visible:o,accessGroup:a,onCancel:()=>d(!1)})]})}let lt=async(e,t)=>{let s=(0,l.getProxyBaseUrl)(),a=`${s}/v1/access_group`,r=await fetch(a,{method:"POST",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){let e=await r.json(),t=(0,l.deriveErrorMessage)(e);throw(0,l.handleError)(t),Error(t)}return r.json()};function ls({visible:e,onCancel:s,onSuccess:a}){let[l]=p.Form.useForm(),i=(()=>{let{accessToken:e}=(0,r.default)(),t=(0,aP.useQueryClient)();return(0,aA.useMutation)({mutationFn:async t=>{if(!e)throw Error("Access token is required");return lt(e,t)},onSuccess:()=>{t.invalidateQueries({queryKey:aF.accessGroupKeys.all})}})})();return(0,t.jsx)(u.Modal,{title:"Create Access Group",open:e,onOk:()=>{l.validateFields().then(e=>{let t={access_group_name:e.name,description:e.description,access_model_names:e.modelIds,access_mcp_server_ids:e.mcpServerIds,access_agent_ids:e.agentIds};i.mutate(t,{onSuccess:()=>{h.message.success("Access group created successfully"),l.resetFields(),a?.(),s()}})}).catch(e=>{console.log("Validate Failed:",e)})},onCancel:s,width:700,okText:"Create Group",cancelText:"Cancel",confirmLoading:i.isPending,destroyOnClose:!0,children:(0,t.jsx)(a5,{form:l})})}let{Title:la,Text:ll}=sz.Typography,{Content:lr}=aO.Layout;function li(e){return{id:e.access_group_id,name:e.access_group_name,description:e.description??"",modelIds:e.access_model_names,mcpServerIds:e.access_mcp_server_ids,agentIds:e.access_agent_ids,keyIds:e.assigned_key_ids,teamIds:e.assigned_team_ids,createdAt:e.created_at,createdBy:e.created_by??"",updatedAt:e.updated_at,updatedBy:e.updated_by??""}}function ln(){let{token:e}=aR.theme.useToken(),{data:s,isLoading:a}=(0,aF.useAccessGroups)(),l=(0,i.useMemo)(()=>(s??[]).map(li),[s]),[n,o]=(0,i.useState)(null),[d,c]=(0,i.useState)(!1),[m,u]=(0,i.useState)(""),[x,p]=(0,i.useState)(1),[h,g]=(0,i.useState)([]),[y,f]=(0,i.useState)(null),_=(()=>{let{accessToken:e}=(0,r.default)(),t=(0,aP.useQueryClient)();return(0,aA.useMutation)({mutationFn:async t=>{if(!e)throw Error("Access token is required");return aL(e,t)},onSuccess:()=>{t.invalidateQueries({queryKey:aF.accessGroupKeys.all})}})})();(0,i.useEffect)(()=>{p(1)},[m]);let v=(0,i.useMemo)(()=>l.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.id.toLowerCase().includes(m.toLowerCase())||e.description.toLowerCase().includes(m.toLowerCase())),[l,m]),N=(0,i.useMemo)(()=>[{id:"id",accessorKey:"id",header:()=>(0,t.jsx)("span",{children:"ID"}),enableSorting:!1,size:170,cell:({row:e})=>{let s=e.original;return(0,t.jsx)(eu.Tooltip,{title:s.id,children:(0,t.jsx)(ll,{ellipsis:!0,className:"text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs cursor-pointer",style:{fontSize:14,padding:"1px 8px"},onClick:()=>o(s.id),children:s.id})})}},{id:"name",accessorKey:"name",header:()=>(0,t.jsx)("span",{children:"Name"}),enableSorting:!0,cell:({getValue:e})=>e()},{id:"resources",header:()=>(0,t.jsx)("span",{children:"Resources"}),enableSorting:!1,cell:({row:e})=>{let s=e.original,a=s.modelIds??[],l=s.mcpServerIds??[],r=s.agentIds??[];return(0,t.jsxs)(aE.Flex,{gap:12,align:"center",children:[(0,t.jsx)(eu.Tooltip,{title:`${a?.length} Models`,children:(0,t.jsx)(b.Tag,{color:"blue",style:{fontSize:14,padding:"2px 8px",margin:0},children:(0,t.jsxs)(aE.Flex,{align:"center",gap:6,children:[(0,t.jsx)(a$,{size:14}),a?.length]})})}),(0,t.jsx)(eu.Tooltip,{title:`${l?.length} MCP Servers`,children:(0,t.jsx)(b.Tag,{color:"cyan",style:{fontSize:14,padding:"2px 8px",margin:0},children:(0,t.jsxs)(aE.Flex,{align:"center",gap:6,children:[(0,t.jsx)(aV.ServerIcon,{size:14}),l?.length]})})}),(0,t.jsx)(eu.Tooltip,{title:`${r?.length} Agents`,children:(0,t.jsx)(b.Tag,{color:"purple",style:{fontSize:14,padding:"2px 8px",margin:0},children:(0,t.jsxs)(aE.Flex,{align:"center",gap:6,children:[(0,t.jsx)(aB.default,{size:14}),r?.length]})})})]})}},{id:"createdAt",accessorKey:"createdAt",header:()=>(0,t.jsx)("span",{children:"Created"}),enableSorting:!0,sortingFn:"datetime",cell:({getValue:e})=>new Date(e()).toLocaleDateString(),meta:{responsive:["lg"]}},{id:"updatedAt",accessorKey:"updatedAt",header:()=>(0,t.jsx)("span",{children:"Updated"}),enableSorting:!1,cell:({getValue:e})=>new Date(e()).toLocaleDateString(),meta:{responsive:["xl"]}},{id:"actions",header:()=>(0,t.jsx)("span",{children:"Actions"}),enableSorting:!1,cell:({row:e})=>(0,t.jsx)(aj.Space,{children:(0,t.jsx)(sK.default,{variant:"Delete",tooltipText:"Delete access group",onClick:()=>f(e.original)})})}],[]),w=(0,aM.useReactTable)({data:v,columns:N,state:{sorting:h},onSortingChange:g,getCoreRowModel:(0,aD.getCoreRowModel)(),getSortedRowModel:(0,aD.getSortedRowModel)(),getRowId:e=>e.id}),k=w.getRowModel().rows,C=k.slice((x-1)*10,10*x),S=(0,i.useMemo)(()=>new Map(C.map(e=>[e.original.id,e])),[C]),T=(w.getHeaderGroups()[0]?.headers??[]).map(e=>{let s=e.column.getCanSort(),a=e.column.getIsSorted(),l=e.column.columnDef.meta,r={title:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.isPlaceholder?null:(0,aM.flexRender)(e.column.columnDef.header,e.getContext()),s&&(0,t.jsx)(aG.TableHeaderSortDropdown,{sortState:!1!==a&&a,onSortChange:t=>{g(!1===t?[]:[{id:e.column.id,desc:"desc"===t}])},columnId:e.column.id})]}),key:e.id,width:e.column.columnDef.size,render:(t,s)=>{let a=S.get(s.id);if(!a)return null;let l=a.getVisibleCells().find(t=>t.column.id===e.id);return l?(0,aM.flexRender)(l.column.columnDef.cell,l.getContext()):null}};return l?.responsive&&(r.responsive=l.responsive),r}),I=C.map(e=>e.original);return n?(0,t.jsx)(le,{accessGroupId:n,onBack:()=>o(null)}):(0,t.jsxs)(lr,{style:{padding:e.paddingLG,paddingInline:2*e.paddingLG},children:[(0,t.jsxs)(aE.Flex,{justify:"space-between",align:"center",style:{marginBottom:16},children:[(0,t.jsxs)(aj.Space,{direction:"vertical",size:0,children:[(0,t.jsx)(la,{level:2,style:{margin:0},children:"Access Groups"}),(0,t.jsx)(ll,{type:"secondary",children:"Manage resource permissions for your organization"})]}),(0,t.jsx)(A.Button,{type:"primary",icon:(0,t.jsx)(P.PlusOutlined,{}),onClick:()=>c(!0),children:"Create Access Group"})]}),(0,t.jsxs)(ec.Card,{styles:{body:{padding:0}},children:[(0,t.jsxs)(aE.Flex,{justify:"space-between",align:"center",style:{padding:"12px 16px"},children:[(0,t.jsx)(j.Input,{prefix:(0,t.jsx)(aU.default,{size:16}),placeholder:"Search groups by name, ID, or description...",style:{maxWidth:400},value:m,onChange:e=>u(e.target.value),allowClear:!0}),(0,t.jsx)(az.default,{current:x,total:k?.length,pageSize:10,onChange:e=>p(e),size:"small",showTotal:e=>`${e} groups`,showSizeChanger:!1})]}),(0,t.jsx)(tt.Table,{columns:T,dataSource:I,rowKey:"id",loading:a,pagination:!1})]}),(0,t.jsx)(ls,{visible:d,onCancel:()=>c(!1)}),(0,t.jsx)(sH.default,{isOpen:!!y,title:"Delete Access Group",message:"Are you sure you want to delete this access group? This action cannot be undone.",resourceInformationTitle:"Access Group Information",resourceInformation:[{label:"ID",value:y?.id,code:!0},{label:"Name",value:y?.name},{label:"Description",value:y?.description||"—"}],onCancel:()=>f(null),onOk:()=>{y&&_.mutate(y.id,{onSuccess:()=>{f(null)}})},confirmLoading:_.isPending})]})}var lo=e.i(510674);let ld=async(e,t)=>{let s=(0,l.getProxyBaseUrl)(),a=`${s}/project/delete`,r=await fetch(a,{method:"DELETE",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({project_ids:t})});if(!r.ok){let e=await r.json(),t=(0,l.deriveErrorMessage)(e);throw(0,l.handleError)(t),Error(t)}};var lc=e.i(785242),az=az,aU=aU;let lm={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M484 443.1V528h-84.5c-4.1 0-7.5 3.1-7.5 7v42c0 3.8 3.4 7 7.5 7H484v84.9c0 3.9 3.2 7.1 7 7.1h42c3.9 0 7-3.2 7-7.1V584h84.5c4.1 0 7.5-3.2 7.5-7v-42c0-3.9-3.4-7-7.5-7H540v-84.9c0-3.9-3.1-7.1-7-7.1h-42c-3.8 0-7 3.2-7 7.1zm396-144.7H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder-add",theme:"outlined"};var lu=i.forwardRef(function(e,t){return i.createElement(tA.default,(0,tI.default)({},e,{ref:t,icon:lm}))});let lx=async(e,t)=>{let s=(0,l.getProxyBaseUrl)(),a=`${s}/project/new`,r=await fetch(a,{method:"POST",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){let e=await r.json(),t=(0,l.deriveErrorMessage)(e);throw(0,l.handleError)(t),Error(t)}return r.json()};function lp({form:e}){let{accessToken:s,userId:a,userRole:l}=(0,r.default)(),{data:n}=(0,lc.useTeams)(),[o,d]=(0,i.useState)(null),[c,m]=(0,i.useState)([]),u=p.Form.useWatch("team_id",e);return(0,i.useEffect)(()=>{if(u&&n){let e=n.find(e=>e.team_id===u)??null;e&&e.team_id!==o?.team_id&&d(e)}},[u,n,o?.team_id]),(0,i.useEffect)(()=>{a&&l&&s&&o?(0,sX.fetchTeamModels)(a,l,s,o.team_id).then(e=>{m(Array.from(new Set([...o.models??[],...e])))}):m([])},[o,s,a,l]),(0,t.jsxs)(p.Form,{form:e,layout:"vertical",name:"project_form",initialValues:{isBlocked:!1},style:{marginTop:24},children:[(0,t.jsx)(sz.Typography.Text,{strong:!0,style:{fontSize:13,color:"#374151",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Basic Information"}),(0,t.jsx)(_.Divider,{style:{marginTop:8,marginBottom:16}}),(0,t.jsxs)(t_.Row,{gutter:24,children:[(0,t.jsx)(tv.Col,{span:12,children:(0,t.jsx)(p.Form.Item,{name:"project_alias",label:"Project Name",rules:[{required:!0,message:"Please enter a project name"}],children:(0,t.jsx)(j.Input,{placeholder:"e.g. Customer Support Bot"})})}),(0,t.jsx)(tv.Col,{span:12,children:(0,t.jsx)(p.Form.Item,{name:"team_id",label:"Team",rules:[{required:!0,message:"Please select a team"}],children:(0,t.jsx)(g.Select,{showSearch:!0,placeholder:"Search or select a team",onChange:t=>{d(n?.find(e=>e.team_id===t)??null),e.setFieldValue("models",[])},allowClear:!0,optionLabelProp:"label",filterOption:(e,t)=>{let s=n?.find(e=>e.team_id===t?.value);if(!s)return!1;let a=e.toLowerCase().trim();return(s.team_alias||"").toLowerCase().includes(a)||s.team_id.toLowerCase().includes(a)},children:n?.map(e=>(0,t.jsxs)(g.Select.Option,{value:e.team_id,label:e.team_alias||e.team_id,children:[(0,t.jsx)("span",{style:{fontWeight:500},children:e.team_alias})," ",(0,t.jsxs)("span",{style:{color:"#9ca3af"},children:["(",e.team_id,")"]})]},e.team_id))})})})]}),(0,t.jsx)(t_.Row,{children:(0,t.jsx)(tv.Col,{span:24,children:(0,t.jsx)(p.Form.Item,{name:"description",label:"Description",children:(0,t.jsx)(j.Input.TextArea,{placeholder:"Describe the purpose of this project",rows:3})})})}),(0,t.jsx)(t_.Row,{children:(0,t.jsx)(tv.Col,{span:24,children:(0,t.jsx)(p.Form.Item,{name:"models",label:"Allowed Models (scoped to selected team's models)",help:o?void 0:"Select a team first to see available models",children:(0,t.jsxs)(g.Select,{mode:"multiple",placeholder:o?"Select models":"Select a team first",disabled:!o,allowClear:!0,maxTagCount:"responsive",onChange:t=>{t.includes("all-team-models")&&e.setFieldsValue({models:["all-team-models"]})},children:[(0,t.jsx)(g.Select.Option,{value:"all-team-models",children:"All Team Models"},"all-team-models"),c.map(e=>(0,t.jsx)(g.Select.Option,{value:e,children:(0,T.getModelDisplayName)(e)},e))]})})})}),(0,t.jsx)(t_.Row,{gutter:24,children:(0,t.jsx)(tv.Col,{span:12,children:(0,t.jsx)(p.Form.Item,{name:"max_budget",label:"Max Budget (USD)",children:(0,t.jsx)(ts.InputNumber,{prefix:"$",style:{width:"100%"},placeholder:"0.00",min:0,precision:2})})})}),(0,t.jsx)(t_.Row,{children:(0,t.jsx)(tv.Col,{span:24,children:(0,t.jsx)(F.Collapse,{ghost:!0,style:{background:"#f9fafb",borderRadius:8,border:"1px solid #e5e7eb"},items:[{key:"1",label:(0,t.jsx)(sz.Typography.Text,{strong:!0,style:{color:"#374151"},children:"Advanced Settings"}),children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(aE.Flex,{align:"center",gap:12,children:[(0,t.jsx)(sz.Typography.Text,{strong:!0,children:"Block Project"}),(0,t.jsx)(p.Form.Item,{name:"isBlocked",valuePropName:"checked",noStyle:!0,children:(0,t.jsx)(I.Switch,{})})]}),(0,t.jsx)(p.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.isBlocked!==t.isBlocked,children:({getFieldValue:e})=>e("isBlocked")?(0,t.jsx)(x.Alert,{banner:!0,type:"warning",showIcon:!0,message:"All API requests using keys under this project will be rejected.",style:{marginTop:12}}):null}),(0,t.jsx)(_.Divider,{}),(0,t.jsx)(sz.Typography.Text,{strong:!0,style:{display:"block",marginBottom:12},children:"Model-Specific Limits"}),(0,t.jsx)(p.Form.List,{name:"modelLimits",children:(s,{add:a,remove:l})=>(0,t.jsxs)(t.Fragment,{children:[s.map(({key:s,name:a,...r})=>(0,t.jsxs)(aj.Space,{style:{display:"flex",marginBottom:8},align:"baseline",children:[(0,t.jsx)(p.Form.Item,{...r,name:[a,"model"],rules:[{required:!0,message:"Missing model"},{validator:(t,s)=>s&&(e.getFieldValue("modelLimits")??[]).filter(e=>e?.model===s).length>1?Promise.reject(Error("Duplicate model")):Promise.resolve()}],children:(0,t.jsx)(j.Input,{placeholder:"Model name (e.g. gpt-4)"})}),(0,t.jsx)(p.Form.Item,{...r,name:[a,"tpm"],children:(0,t.jsx)(ts.InputNumber,{placeholder:"TPM Limit",min:0})}),(0,t.jsx)(p.Form.Item,{...r,name:[a,"rpm"],children:(0,t.jsx)(ts.InputNumber,{placeholder:"RPM Limit",min:0})}),(0,t.jsx)(L.MinusCircleOutlined,{onClick:()=>l(a),style:{color:"#ef4444"}})]},s)),(0,t.jsx)(p.Form.Item,{children:(0,t.jsx)(A.Button,{type:"dashed",onClick:()=>a(),block:!0,icon:(0,t.jsx)(P.PlusOutlined,{}),children:"Add Model Limit"})})]})}),(0,t.jsx)(_.Divider,{}),(0,t.jsx)(sz.Typography.Text,{strong:!0,style:{display:"block",marginBottom:12},children:"Metadata"}),(0,t.jsx)(p.Form.List,{name:"metadata",children:(s,{add:a,remove:l})=>(0,t.jsxs)(t.Fragment,{children:[s.map(({key:s,name:a,...r})=>(0,t.jsxs)(aj.Space,{style:{display:"flex",marginBottom:8},align:"baseline",children:[(0,t.jsx)(p.Form.Item,{...r,name:[a,"key"],rules:[{required:!0,message:"Missing key"},{validator:(t,s)=>s&&(e.getFieldValue("metadata")??[]).filter(e=>e?.key===s).length>1?Promise.reject(Error("Duplicate key")):Promise.resolve()}],children:(0,t.jsx)(j.Input,{placeholder:"Key"})}),(0,t.jsx)(p.Form.Item,{...r,name:[a,"value"],rules:[{required:!0,message:"Missing value"}],children:(0,t.jsx)(j.Input,{placeholder:"Value"})}),(0,t.jsx)(L.MinusCircleOutlined,{onClick:()=>l(a),style:{color:"#ef4444"}})]},s)),(0,t.jsx)(p.Form.Item,{children:(0,t.jsx)(A.Button,{type:"dashed",onClick:()=>a(),block:!0,icon:(0,t.jsx)(P.PlusOutlined,{}),children:"Add Key-Value Pair"})})]})})]})}]})})})]})}function lh(e){let t={},s={};for(let a of e.modelLimits??[])a.model&&(null!=a.rpm&&(t[a.model]=a.rpm),null!=a.tpm&&(s[a.model]=a.tpm));let a={};for(let t of e.metadata??[])t.key&&(a[t.key]=t.value);return{project_alias:e.project_alias,description:e.description,models:e.models??[],max_budget:e.max_budget,blocked:e.isBlocked??!1,...Object.keys(t).length>0&&{model_rpm_limit:t},...Object.keys(s).length>0&&{model_tpm_limit:s},...Object.keys(a).length>0&&{metadata:a}}}function lg({isOpen:e,onClose:s}){let[a]=p.Form.useForm(),l=(()=>{let{accessToken:e}=(0,r.default)(),t=(0,aP.useQueryClient)();return(0,aA.useMutation)({mutationFn:async t=>{if(!e)throw Error("Access token is required");return lx(e,t)},onSuccess:()=>{t.invalidateQueries({queryKey:lo.projectKeys.all})}})})(),i=async()=>{try{let e=await a.validateFields(),t={...lh(e),team_id:e.team_id};l.mutate(t,{onSuccess:()=>{h.message.success("Project created successfully"),a.resetFields(),s()},onError:e=>{h.message.error(e.message||"Failed to create project")}})}catch(e){console.error("Validation failed:",e)}},n=()=>{a.resetFields(),s()};return(0,t.jsx)(u.Modal,{title:(0,t.jsx)(sz.Typography.Text,{strong:!0,style:{fontSize:18},children:"Create New Project"}),open:e,onCancel:n,width:720,destroyOnHidden:!0,footer:[(0,t.jsx)(A.Button,{onClick:n,children:"Cancel"},"cancel"),(0,t.jsx)(A.Button,{type:"primary",icon:(0,t.jsx)(lu,{}),loading:l.isPending,onClick:i,children:"Create Project"},"submit")],children:(0,t.jsx)(lp,{form:a})})}let lj=async(e,t)=>{let s=(0,l.getProxyBaseUrl)(),a=`${s}/project/info?project_id=${encodeURIComponent(t)}`,r=await fetch(a,{method:"GET",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"}});if(!r.ok){let e=await r.json(),t=(0,l.deriveErrorMessage)(e);throw(0,l.handleError)(t),Error(t)}return r.json()},ly=(0,aq.default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var aY=aY,aX=aX,lf=e.i(987432);let lb=async(e,t,s)=>{let a=(0,l.getProxyBaseUrl)(),r=`${a}/project/update`,i=await fetch(r,{method:"POST",headers:{[(0,l.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({project_id:t,...s})});if(!i.ok){let e=await i.json(),t=(0,l.deriveErrorMessage)(e);throw(0,l.handleError)(t),Error(t)}return i.json()};function l_({isOpen:e,project:s,onClose:a,onSuccess:l}){let[n]=p.Form.useForm(),o=(()=>{let{accessToken:e}=(0,r.default)(),t=(0,aP.useQueryClient)();return(0,aA.useMutation)({mutationFn:async({projectId:t,params:s})=>{if(!e)throw Error("Access token is required");return lb(e,t,s)},onSuccess:()=>{t.invalidateQueries({queryKey:lo.projectKeys.all})}})})();(0,i.useEffect)(()=>{if(e&&s){let e=s.metadata??{},t=e.model_rpm_limit??{},a=e.model_tpm_limit??{},l=[];for(let e of new Set([...Object.keys(t),...Object.keys(a)]))l.push({model:e,rpm:t[e],tpm:a[e]});let r=new Set(["model_rpm_limit","model_tpm_limit"]),i=[];for(let[t,s]of Object.entries(e))r.has(t)||i.push({key:t,value:String(s)});n.setFieldsValue({project_alias:s.project_alias??"",team_id:s.team_id??"",description:s.description??"",models:s.models??[],max_budget:s.litellm_budget_table?.max_budget??void 0,isBlocked:s.blocked,modelLimits:l.length>0?l:void 0,metadata:i.length>0?i:void 0})}},[e,s,n]);let d=async()=>{try{let e=await n.validateFields(),t={...lh(e),team_id:e.team_id};o.mutate({projectId:s.project_id,params:t},{onSuccess:()=>{h.message.success("Project updated successfully"),l?.(),a()},onError:e=>{h.message.error(e.message||"Failed to update project")}})}catch(e){console.error("Validation failed:",e)}};return(0,t.jsx)(u.Modal,{title:(0,t.jsx)(sz.Typography.Text,{strong:!0,style:{fontSize:18},children:"Edit Project"}),open:e,onCancel:a,width:720,destroyOnHidden:!0,footer:[(0,t.jsx)(A.Button,{onClick:a,children:"Cancel"},"cancel"),(0,t.jsx)(A.Button,{type:"primary",icon:(0,t.jsx)(lf.SaveOutlined,{}),loading:o.isPending,onClick:d,children:"Save Changes"},"submit")],children:(0,t.jsx)(lp,{form:n})})}var lv=e.i(207082),az=az,aU=aU;let lN=[{title:"Key Name",dataIndex:"key_alias",key:"key_alias",render:e=>e||"—"},{title:"Owner",key:"owner",render:(e,s)=>{let a=s.user?.user_email??s.user_id??null;return a?(0,t.jsx)(eu.Tooltip,{title:a,children:(0,t.jsx)(aZ.default,{userId:a})}):"—"}},{title:"Created",dataIndex:"created_at",key:"created_at",render:e=>e?new Date(e).toLocaleDateString():"—"},{title:"Last Active",dataIndex:"last_active",key:"last_active",render:e=>e?new Date(e).toLocaleDateString():"Never"}];function lw({keys:e,loading:s}){return(0,t.jsx)(tt.Table,{columns:lN,dataSource:e,rowKey:"token",loading:s,pagination:!1,size:"small",locale:{emptyText:(0,t.jsx)(aK.Empty,{description:"No keys found",image:aK.Empty.PRESENTED_IMAGE_SIMPLE})}})}function lk({projectId:e}){let[s,a]=(0,i.useState)(1),[l,r]=(0,i.useState)(""),{data:n,isLoading:o}=(0,lv.useKeys)(s,5,{projectID:e,selectedKeyAlias:l||null});(0,i.useEffect)(()=>{a(1)},[l]);let d=n?.keys??[],c=n?.total_count??0;return(0,t.jsxs)(ec.Card,{title:(0,t.jsxs)(aE.Flex,{align:"center",gap:8,children:[(0,t.jsx)(aJ.KeyIcon,{size:16}),"Keys"]}),style:{height:"100%"},children:[(0,t.jsxs)(aE.Flex,{justify:"space-between",align:"center",style:{marginBottom:12},children:[(0,t.jsx)(j.Input,{prefix:(0,t.jsx)(aU.default,{size:14}),placeholder:"Filter by key name...",style:{maxWidth:220},value:l,onChange:e=>r(e.target.value),allowClear:!0,size:"small"}),(0,t.jsx)(az.default,{current:s,total:c,pageSize:5,onChange:a,size:"small",showSizeChanger:!1,showTotal:e=>`${e} keys`})]}),(0,t.jsx)(lw,{keys:d,loading:!!o&&{indicator:(0,t.jsx)(eS.Spin,{indicator:(0,t.jsx)(tN.LoadingOutlined,{spin:!0})})}})]})}let{Title:lC,Text:lS}=sz.Typography,{Content:lT}=aO.Layout;function lI({projectId:e,onBack:s}){let a,l,n,o,{data:d,isLoading:c}=(e=>{let{accessToken:t,userRole:s}=(0,r.default)(),a=(0,aP.useQueryClient)();return(0,t1.useQuery)({queryKey:lo.projectKeys.detail(e),queryFn:async()=>lj(t,e),enabled:!!(t&&e)&&ey.all_admin_roles.includes(s||""),initialData:()=>{if(!e)return;let t=a.getQueryData(lo.projectKeys.list({}));return t?.find(t=>t.project_id===e)}})})(e),{data:m}=(0,lc.useTeam)(d?.team_id??void 0),u=m?.team_info??m,{token:x}=aR.theme.useToken(),[p,h]=(0,i.useState)(!1),g=d?.spend??0,j=d?.litellm_budget_table?.max_budget??null,y=null!=j&&j>0,f=y?Math.min(g/j*100,100):0,_=(0,i.useMemo)(()=>Object.entries(d?.model_spend??{}).map(([e,t])=>({model:e,spend:t})).sort((e,t)=>t.spend-e.spend),[d?.model_spend]);return c?(0,t.jsx)(lT,{style:{padding:x.paddingLG,paddingInline:2*x.paddingLG},children:(0,t.jsx)(aE.Flex,{justify:"center",align:"center",style:{minHeight:300},children:(0,t.jsx)(eS.Spin,{indicator:(0,t.jsx)(tN.LoadingOutlined,{spin:!0}),size:"large"})})}):d?(0,t.jsxs)(lT,{style:{padding:x.paddingLG,paddingInline:2*x.paddingLG},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,t.jsx)(A.Button,{icon:(0,t.jsx)(aQ.ArrowLeftIcon,{size:16}),onClick:s,type:"text"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(aE.Flex,{align:"center",gap:8,children:[(0,t.jsx)(lC,{level:2,style:{margin:0},children:d.project_alias??d.project_id}),(0,t.jsx)(b.Tag,{color:d.blocked?"red":"green",children:d.blocked?"Blocked":"Active"})]}),(0,t.jsxs)(lS,{type:"secondary",children:["ID: ",(0,t.jsx)(lS,{copyable:!0,children:d.project_id})]})]})]}),(0,t.jsx)(A.Button,{type:"primary",icon:(0,t.jsx)(aY.default,{size:16}),onClick:()=>h(!0),children:"Edit Project"})]}),(0,t.jsx)(t_.Row,{style:{marginBottom:24},children:(0,t.jsx)(ec.Card,{children:(0,t.jsxs)(eT.Descriptions,{title:"Project Details",column:1,children:[(0,t.jsx)(eT.Descriptions.Item,{label:"Description",children:d.description||"—"}),(0,t.jsxs)(eT.Descriptions.Item,{label:"Created",children:[new Date(d.created_at).toLocaleString(),d.created_by&&(0,t.jsxs)(lS,{children:[" ","by"," ",(0,t.jsx)(aZ.default,{userId:d.created_by})]})]}),(0,t.jsxs)(eT.Descriptions.Item,{label:"Last Updated",children:[new Date(d.updated_at).toLocaleString(),d.updated_by&&(0,t.jsxs)(lS,{children:[" ","by"," ",(0,t.jsx)(aZ.default,{userId:d.updated_by})]})]})]})})}),(0,t.jsxs)(t_.Row,{gutter:[16,16],style:{marginBottom:24},children:[(0,t.jsx)(tv.Col,{xs:24,lg:8,children:(0,t.jsx)(ec.Card,{title:(0,t.jsxs)(aE.Flex,{align:"center",gap:8,children:[(0,t.jsx)(ly,{size:16}),"Budget"]}),style:{height:"100%"},children:(0,t.jsxs)(aE.Flex,{vertical:!0,gap:16,children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(lS,{strong:!0,style:{fontSize:28,lineHeight:1},children:["$",g.toFixed(2)]}),(0,t.jsx)("br",{}),(0,t.jsx)(lS,{type:"secondary",children:y?`of $${j.toFixed(2)} budget`:"No budget limit"})]}),y&&(0,t.jsxs)("div",{children:[(0,t.jsx)(ay.Progress,{percent:Math.round(10*f)/10,strokeColor:f>=90?"#f5222d":f>=70?"#faad14":"#52c41a",showInfo:!1}),(0,t.jsxs)(lS,{type:"secondary",style:{fontSize:12},children:[(Math.round(10*f)/10).toFixed(1),"% utilized"]})]})]})})}),(0,t.jsx)(tv.Col,{xs:24,lg:16,children:(0,t.jsx)(ec.Card,{title:"Spend by Model",style:{height:"100%"},children:_.length>0?(0,t.jsx)(sc.BarChart,{data:_,index:"model",categories:["spend"],colors:["cyan"],layout:"vertical",valueFormatter:e=>`$${e.toFixed(4)}`,yAxisWidth:140,showLegend:!1,style:{height:Math.max(40*_.length,120)}}):(0,t.jsx)(aK.Empty,{description:"No model spend recorded yet",image:aK.Empty.PRESENTED_IMAGE_SIMPLE})})})]}),(0,t.jsxs)(t_.Row,{gutter:[16,16],style:{marginBottom:24},children:[(0,t.jsx)(tv.Col,{xs:24,lg:12,children:(0,t.jsx)(lk,{projectId:d.project_id})}),(0,t.jsx)(tv.Col,{xs:24,lg:12,children:(0,t.jsx)(ec.Card,{title:(0,t.jsxs)(aE.Flex,{align:"center",gap:8,children:[(0,t.jsx)(aX.default,{size:16}),"Team"]}),style:{height:"100%"},children:u?(a=u.max_budget??null,l=u.spend??0,o=(n=null!=a&&a>0)?Math.min(l/a*100,100):0,(0,t.jsxs)(aE.Flex,{vertical:!0,gap:12,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(lS,{strong:!0,style:{fontSize:16},children:u.team_alias||u.team_id}),(0,t.jsx)("br",{}),(0,t.jsxs)(lS,{type:"secondary",style:{fontSize:12},children:["ID:"," ",(0,t.jsx)(lS,{copyable:!0,style:{fontSize:12},children:u.team_id})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(lS,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:"Models"}),(u.models?.length??0)>0?(0,t.jsx)(aE.Flex,{wrap:"wrap",gap:4,style:{maxHeight:60,overflow:"hidden"},children:u.models?.map(e=>(0,t.jsx)(b.Tag,{style:{margin:0},children:e},e))}):(0,t.jsx)(lS,{type:"secondary",children:"All models"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(aE.Flex,{justify:"space-between",align:"center",style:{marginBottom:2},children:[(0,t.jsx)(lS,{type:"secondary",style:{fontSize:12},children:"Spend"}),(0,t.jsxs)(lS,{style:{fontSize:12},children:["$",l.toFixed(2),n?(0,t.jsxs)(lS,{type:"secondary",style:{fontSize:12},children:[" ","/ $",a.toFixed(2)]}):(0,t.jsxs)(lS,{type:"secondary",style:{fontSize:12},children:[" ","(Unlimited)"]})]})]}),n&&(0,t.jsx)(ay.Progress,{percent:Math.round(10*o)/10,strokeColor:o>=90?"#f5222d":o>=70?"#faad14":"#52c41a",size:"small",showInfo:!1})]}),(0,t.jsxs)(aE.Flex,{justify:"space-between",children:[(0,t.jsx)(lS,{type:"secondary",style:{fontSize:12},children:"Members"}),(0,t.jsx)(lS,{style:{fontSize:12},children:u.members_with_roles?.length??0})]})]})):d.team_id?(0,t.jsx)(aE.Flex,{justify:"center",align:"center",style:{padding:16},children:(0,t.jsx)(eS.Spin,{indicator:(0,t.jsx)(tN.LoadingOutlined,{spin:!0}),size:"small"})}):(0,t.jsx)(aK.Empty,{description:"No team assigned",image:aK.Empty.PRESENTED_IMAGE_SIMPLE})})})]}),(0,t.jsx)(l_,{isOpen:p,project:d,onClose:()=>h(!1)})]}):(0,t.jsxs)(lT,{style:{padding:x.paddingLG,paddingInline:2*x.paddingLG},children:[(0,t.jsx)(A.Button,{icon:(0,t.jsx)(aQ.ArrowLeftIcon,{size:16}),onClick:s,type:"text",style:{marginBottom:16}}),(0,t.jsx)(aK.Empty,{description:"Project not found"})]})}let{Title:lF,Text:lA}=sz.Typography,{Content:lP}=aO.Layout;function lL(){let{token:e}=aR.theme.useToken(),{data:s,isLoading:a}=(0,lo.useProjects)(),{data:l,isLoading:n}=(0,lc.useTeams)(),o=(()=>{let{accessToken:e}=(0,r.default)(),t=(0,aP.useQueryClient)();return(0,aA.useMutation)({mutationFn:async t=>{if(!e)throw Error("Access token is required");return ld(e,t)},onSuccess:()=>{t.invalidateQueries({queryKey:lo.projectKeys.all})}})})(),[d,c]=(0,i.useState)(null),[m,u]=(0,i.useState)(!1),[p,g]=(0,i.useState)(null),[y,f]=(0,i.useState)(""),[_,v]=(0,i.useState)(1);(0,i.useEffect)(()=>{v(1)},[y]);let N=(0,i.useMemo)(()=>{let e=new Map;for(let t of l??[])e.set(t.team_id,t.team_alias??t.team_id);return e},[l]),w=(0,i.useMemo)(()=>{let e=s??[];if(!y)return e;let t=y.toLowerCase();return e.filter(e=>{let s=N.get(e.team_id??"")??"";return(e.project_alias??"").toLowerCase().includes(t)||e.project_id.toLowerCase().includes(t)||(e.description??"").toLowerCase().includes(t)||s.toLowerCase().includes(t)})},[s,y,N]),k=[{title:"ID",dataIndex:"project_id",key:"project_id",width:170,render:e=>(0,t.jsx)(eu.Tooltip,{title:e,children:(0,t.jsx)(lA,{ellipsis:!0,className:"text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs cursor-pointer",style:{fontSize:14,padding:"1px 8px"},onClick:()=>c(e),children:e})})},{title:"Name",dataIndex:"project_alias",key:"project_alias",sorter:(e,t)=>(e.project_alias??"").localeCompare(t.project_alias??""),render:e=>e??"—"},{title:"Team",key:"team",sorter:(e,t)=>{let s=N.get(e.team_id??"")??"",a=N.get(t.team_id??"")??"";return s.localeCompare(a)},render:(e,s)=>{if(!s.team_id)return"—";let a=N.get(s.team_id);return a||(n?(0,t.jsx)(eS.Spin,{indicator:(0,t.jsx)(tN.LoadingOutlined,{spin:!0}),size:"small"}):s.team_id)}},{title:"Models",key:"models",render:(e,s)=>{let a=s.models??[];return(0,t.jsx)(eu.Tooltip,{title:a.length>0?a.join(", "):"No models",children:(0,t.jsx)(b.Tag,{color:"blue",style:{fontSize:14,padding:"2px 8px",margin:0},children:(0,t.jsxs)(aE.Flex,{align:"center",gap:6,children:[(0,t.jsx)(a$,{size:14}),a.length]})})})}},{title:"Status",dataIndex:"blocked",key:"status",render:e=>(0,t.jsx)(b.Tag,{color:e?"red":"green",children:e?"Blocked":"Active"})},{title:"Created",dataIndex:"created_at",key:"created_at",sorter:(e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime(),responsive:["lg"],render:e=>new Date(e).toLocaleDateString()},{title:"Updated",dataIndex:"updated_at",key:"updated_at",responsive:["xl"],render:e=>new Date(e).toLocaleDateString()},{title:"Actions",key:"actions",width:80,render:(e,s)=>(0,t.jsx)(sK.default,{variant:"Delete",tooltipText:"Delete project",onClick:()=>g(s)})}];return d?(0,t.jsx)(lI,{projectId:d,onBack:()=>c(null)}):(0,t.jsxs)(lP,{style:{padding:e.paddingLG,paddingInline:2*e.paddingLG},children:[(0,t.jsx)(x.Alert,{message:"Projects is currently in beta. Features and behavior may change without notice.",type:"warning",showIcon:!0,style:{marginBottom:16}}),(0,t.jsxs)(aE.Flex,{justify:"space-between",align:"center",style:{marginBottom:16},children:[(0,t.jsxs)(aj.Space,{direction:"vertical",size:0,children:[(0,t.jsx)(lF,{level:2,style:{margin:0},children:"[BETA] Projects"}),(0,t.jsx)(lA,{type:"secondary",children:"Manage projects within your teams"})]}),(0,t.jsx)(A.Button,{type:"primary",icon:(0,t.jsx)(P.PlusOutlined,{}),onClick:()=>u(!0),children:"Create Project"})]}),(0,t.jsxs)(ec.Card,{styles:{body:{padding:0}},children:[(0,t.jsxs)(aE.Flex,{justify:"space-between",align:"center",style:{padding:"12px 16px"},children:[(0,t.jsx)(j.Input,{prefix:(0,t.jsx)(aU.default,{size:16}),placeholder:"Search projects by name, ID, description, or team...",style:{maxWidth:400},value:y,onChange:e=>f(e.target.value),allowClear:!0}),(0,t.jsx)(az.default,{current:_,total:w.length,pageSize:10,onChange:e=>v(e),size:"small",showTotal:e=>`${e} projects`,showSizeChanger:!1})]}),(0,t.jsx)(tt.Table,{columns:k,dataSource:w.slice((_-1)*10,10*_),rowKey:"project_id",loading:a,pagination:!1})]}),(0,t.jsx)(lg,{isOpen:m,onClose:()=>u(!1)}),(0,t.jsx)(sH.default,{isOpen:null!==p,title:"Delete Project",alertMessage:"This action is irreversible. All keys must be unlinked from this project before it can be deleted.",message:"Are you sure you want to delete this project?",resourceInformationTitle:"Project Information",resourceInformation:[{label:"Name",value:p?.project_alias||"—"},{label:"Project ID",value:p?.project_id,code:!0},{label:"Team",value:N.get(p?.team_id??"")||p?.team_id||"—"}],onCancel:()=>g(null),onOk:()=>{p&&o.mutate([p.project_id],{onSuccess:()=>{h.message.success("Project deleted successfully"),g(null)},onError:e=>{h.message.error(e.message||"Failed to delete project")}})},confirmLoading:o.isPending,requiredConfirmation:p?.project_alias??void 0})]})}var lM=e.i(241902),lD=e.i(969550),lE=e.i(307582);let lO=[{value:"trusted",label:"trusted",color:"#065f46",bg:"#d1fae5",border:"#6ee7b7"},{value:"blocked",label:"blocked",color:"#991b1b",bg:"#fee2e2",border:"#fca5a5"}],lz=({value:e,toolName:s,saving:a,onChange:l})=>(lO.find(t=>t.value===e)??lO[1],(0,t.jsx)(g.Select,{size:"small",value:e,disabled:a,loading:a,onChange:e=>l(s,e),onClick:e=>e.stopPropagation(),style:{minWidth:110,fontWeight:500},popupMatchSelectWidth:!1,options:lO.map(e=>({value:e.value,label:(0,t.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,fontWeight:500,color:e.color},children:[(0,t.jsx)("span",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:e.color,display:"inline-block",flexShrink:0}}),e.label]})}))})),lR=({accessToken:e})=>{let[s,a]=(0,i.useState)([]),[r,n]=(0,i.useState)(!0),[o,d]=(0,i.useState)(!1),[c,m]=(0,i.useState)(null),[u,x]=(0,i.useState)(null),[p,h]=(0,i.useState)(""),[g,j]=(0,i.useState)("created_at"),[y,f]=(0,i.useState)("desc"),[b,_]=(0,i.useState)(1),[v,N]=(0,i.useState)(!0),[w,k]=(0,i.useState)({}),C=(0,i.useDeferredValue)(o),S=o||C,T=(0,i.useCallback)(async()=>{if(e){d(!0),m(null);try{let t=await (0,l.fetchToolsList)(e);a(t)}catch(e){m(e.message??"Failed to load tools")}finally{d(!1),n(!1)}}},[e]);(0,i.useEffect)(()=>{T()},[T]),(0,i.useEffect)(()=>{if(!v)return;let e=setInterval(T,15e3);return()=>clearInterval(e)},[v,T]);let F=async(t,s)=>{if(e){x(t);try{await (0,l.updateToolPolicy)(e,t,s),a(e=>e.map(e=>e.tool_name===t?{...e,call_policy:s}:e))}catch(e){alert(`Failed to update policy: ${e.message}`)}finally{x(null)}}},A=Array.from(new Set(s.map(e=>e.team_id).filter(Boolean))).map(e=>({label:e,value:e})),P=Array.from(new Set(s.map(e=>e.key_alias).filter(Boolean))).map(e=>({label:e,value:e})),L=[{name:"Policy",label:"Policy",options:lO.map(e=>({label:e.label,value:e.value}))},{name:"Team Name",label:"Team Name",options:A},{name:"Key Name",label:"Key Name",options:P}],M=({label:e,field:s})=>(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{children:e}),(0,t.jsx)(aG.TableHeaderSortDropdown,{sortState:g===s&&y,onSortChange:e=>{!1===e?(j("created_at"),f("desc")):(j(s),f(e)),_(1)}})]}),D=s.filter(e=>{if(p){let t=p.toLowerCase();if(!(e.tool_name.toLowerCase().includes(t)||(e.team_id??"").toLowerCase().includes(t)||(e.key_alias??"").toLowerCase().includes(t)||(e.key_hash??"").toLowerCase().includes(t)||e.call_policy.toLowerCase().includes(t)))return!1}return(!w.Policy||e.call_policy===w.Policy)&&(!w["Team Name"]||e.team_id===w["Team Name"])&&(!w["Key Name"]||e.key_alias===w["Key Name"])}),E=[...D].sort((e,t)=>{let s=e[g]??"",a=t[g]??"";return s<a?"desc"===y?1:-1:s>a?"desc"===y?-1:1:0}),O=Math.max(1,Math.ceil(E.length/50)),z=E.slice((b-1)*50,50*b);return(0,t.jsxs)("div",{className:"p-6 w-full",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Tool Policies"}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full box-border",children:[(0,t.jsxs)("div",{className:"border-b px-6 py-4 w-full max-w-full box-border",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0 w-full max-w-full box-border",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,t.jsxs)("div",{className:"relative w-64",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search by Tool Name",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:p,onChange:e=>{h(e.target.value),_(1)}}),(0,t.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Live Tail"}),(0,t.jsx)(I.Switch,{checked:v,onChange:N})]}),(0,t.jsxs)("button",{onClick:T,disabled:S,className:"flex items-center gap-1.5 px-3 py-2 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-60",children:[(0,t.jsx)("svg",{className:`w-4 h-4 ${S?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),S?"Fetching":"Fetch"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 whitespace-nowrap",children:[(0,t.jsxs)("span",{children:["Showing ",0===D.length?0:(b-1)*50+1," -"," ",Math.min(50*b,D.length)," of ",D.length," results"]}),(0,t.jsxs)("span",{children:["Page ",b," of ",O]}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:()=>_(e=>Math.max(1,e-1)),disabled:1===b,className:"px-3 py-1.5 border rounded-md text-sm hover:bg-gray-50 disabled:opacity-40",children:"Previous"}),(0,t.jsx)("button",{onClick:()=>_(e=>Math.min(O,e+1)),disabled:b===O,className:"px-3 py-1.5 border rounded-md text-sm hover:bg-gray-50 disabled:opacity-40",children:"Next"})]})]})]}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)(lD.default,{options:L,onApplyFilters:e=>{k(e),_(1)},onResetFilters:()=>{k({}),_(1)},buttonLabel:"Filters"})})]}),v&&(0,t.jsxs)("div",{className:"bg-green-50 border-b border-green-100 px-6 py-2 flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-green-700",children:"Auto-refreshing every 15 seconds"}),(0,t.jsx)("button",{onClick:()=>N(!1),className:"text-xs text-green-600 underline",children:"Stop"})]}),c&&(0,t.jsx)("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded text-sm text-red-700",children:c}),(0,t.jsxs)(eY.Table,{className:"[&_td]:py-0.5 [&_th]:py-1 w-full",children:[(0,t.jsx)(eJ.TableHead,{children:(0,t.jsxs)(eX.TableRow,{children:[(0,t.jsx)(eZ.TableHeaderCell,{className:"py-1 h-8",children:(0,t.jsx)(M,{label:"Discovered",field:"created_at"})}),(0,t.jsx)(eZ.TableHeaderCell,{className:"py-1 h-8",children:(0,t.jsx)(M,{label:"Tool Name",field:"tool_name"})}),(0,t.jsx)(eZ.TableHeaderCell,{className:"py-1 h-8",children:(0,t.jsx)(M,{label:"Policy",field:"call_policy"})}),(0,t.jsx)(eZ.TableHeaderCell,{className:"py-1 h-8",children:(0,t.jsx)(M,{label:"# Calls",field:"call_count"})}),(0,t.jsx)(eZ.TableHeaderCell,{className:"py-1 h-8",children:(0,t.jsx)(M,{label:"Team Name",field:"team_id"})}),(0,t.jsx)(eZ.TableHeaderCell,{className:"py-1 h-8",children:"Key Hash"}),(0,t.jsx)(eZ.TableHeaderCell,{className:"py-1 h-8",children:(0,t.jsx)(M,{label:"Key Name",field:"key_alias"})}),(0,t.jsx)(eZ.TableHeaderCell,{className:"py-1 h-8",children:"Origin"})]})}),(0,t.jsx)(e0.TableBody,{children:r?(0,t.jsx)(eX.TableRow,{children:(0,t.jsx)(e1.TableCell,{colSpan:8,className:"h-8 text-center text-gray-500",children:"Loading tools…"})}):0===z.length?(0,t.jsx)(eX.TableRow,{children:(0,t.jsx)(e1.TableCell,{colSpan:8,className:"h-8 text-center text-gray-500",children:"No tools discovered yet. Make a chat completion that returns tool_calls to start auto-discovery."})}):z.map(e=>(0,t.jsxs)(eX.TableRow,{className:"h-8 hover:bg-gray-50",children:[(0,t.jsx)(e1.TableCell,{className:"py-0.5 max-h-8 overflow-hidden whitespace-nowrap",children:(0,t.jsx)(lE.TimeCell,{utcTime:e.created_at??""})}),(0,t.jsx)(e1.TableCell,{className:"py-0.5 max-h-8 overflow-hidden",children:(0,t.jsx)(eu.Tooltip,{title:e.tool_name,children:(0,t.jsx)("span",{className:"font-mono text-xs max-w-[20ch] truncate block font-medium",children:e.tool_name})})}),(0,t.jsx)(e1.TableCell,{className:"py-0.5 max-h-8",children:(0,t.jsx)(lz,{value:e.call_policy,toolName:e.tool_name,saving:u===e.tool_name,onChange:F})}),(0,t.jsx)(e1.TableCell,{className:"py-0.5 max-h-8 text-right tabular-nums text-sm font-mono text-gray-700",children:(e.call_count??0).toLocaleString()}),(0,t.jsx)(e1.TableCell,{className:"py-0.5 max-h-8 overflow-hidden whitespace-nowrap",children:(0,t.jsx)(eu.Tooltip,{title:e.team_id??"-",children:(0,t.jsx)("span",{className:"max-w-[15ch] truncate block",children:e.team_id??"-"})})}),(0,t.jsx)(e1.TableCell,{className:"py-0.5 max-h-8 overflow-hidden whitespace-nowrap",children:(0,t.jsx)(eu.Tooltip,{title:e.key_hash??"-",children:(0,t.jsx)("span",{className:"font-mono max-w-[15ch] truncate block text-blue-600",children:e.key_hash??"-"})})}),(0,t.jsx)(e1.TableCell,{className:"py-0.5 max-h-8 overflow-hidden whitespace-nowrap",children:(0,t.jsx)(eu.Tooltip,{title:e.key_alias??"-",children:(0,t.jsx)("span",{className:"max-w-[15ch] truncate block",children:e.key_alias??"-"})})}),(0,t.jsx)(e1.TableCell,{className:"py-0.5 max-h-8 overflow-hidden whitespace-nowrap",children:(0,t.jsx)(eu.Tooltip,{title:e.origin??"-",children:(0,t.jsx)("span",{className:"max-w-[15ch] truncate block",children:e.origin??"-"})})})]},e.tool_id))})]}),O>1&&(0,t.jsxs)("div",{className:"border-t px-6 py-3 flex items-center justify-between text-sm text-gray-600",children:[(0,t.jsxs)("span",{children:["Showing ",(b-1)*50+1," - ",Math.min(50*b,E.length)," of"," ",E.length]}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:()=>_(e=>Math.max(1,e-1)),disabled:1===b,className:"px-3 py-1.5 border rounded-md hover:bg-gray-50 disabled:opacity-40",children:"Previous"}),(0,t.jsx)("button",{onClick:()=>_(e=>Math.min(O,e+1)),disabled:b===O,className:"px-3 py-1.5 border rounded-md hover:bg-gray-50 disabled:opacity-40",children:"Next"})]})]})]})]})};var lB=e.i(936190),lq=e.i(910119),l$=e.i(275144),lU=e.i(161281),lV=e.i(317751),lG=e.i(947293),lH=e.i(618566),lK=e.i(592143);function lW(e,t="/"){document.cookie=`${e}=; Max-Age=0; Path=${t}`}let lQ=new lV.QueryClient;function lY(){let[e,a]=(0,i.useState)(""),[r,m]=(0,i.useState)(!1),[u,x]=(0,i.useState)(!1),[p,h]=(0,i.useState)(null),[g,j]=(0,i.useState)(null),[y,f]=(0,i.useState)([]),[b,_]=(0,i.useState)([]),[v,N]=(0,i.useState)([]),[w,k]=(0,i.useState)({PROXY_BASE_URL:"",PROXY_LOGOUT_URL:""}),[C,S]=(0,i.useState)(!0),T=(0,lH.useSearchParams)(),[I,F]=(0,i.useState)({data:[]}),[A,P]=(0,i.useState)(null),[L,M]=(0,i.useState)(!1),[D,E]=(0,i.useState)(!0),[O,z]=(0,i.useState)(null),[R,B]=(0,i.useState)(!0),[q,$]=(0,i.useState)(!1),[U,V]=(0,i.useState)(!1),[G,H]=(0,i.useState)(!1),[K,W]=(0,i.useState)(!1),[Q,Y]=(0,i.useState)(!1),J=T.get("invitation_id"),[X,Z]=(0,i.useState)(()=>T.get("page")||"api-keys"),[ee,et]=(0,i.useState)(null),[es,ea]=(0,i.useState)(!1),el=e=>{f(t=>t?[...t,e]:[e]),M(()=>!L)},er=!1===D&&null===A&&null===J;return((0,i.useEffect)(()=>{let e=!1;return(async()=>{try{await (0,l.getUiConfig)()}catch{}if(e)return;let t=function(e){let t=document.cookie.split("; ").find(t=>t.startsWith(e+"="));if(!t)return null;let s=t.slice(e.length+1);try{return decodeURIComponent(s)}catch{return s}}("token"),s=t&&!(0,lU.isJwtExpired)(t)?t:null;t&&!s&&lW("token","/"),e||(P(s),E(!1))})(),()=>{e=!0}},[]),(0,i.useEffect)(()=>{if(er){let e=(l.proxyBaseUrl||"")+"/ui/login";window.location.replace(e)}},[er]),(0,i.useEffect)(()=>{if(!A)return;if((0,lU.isJwtExpired)(A)){lW("token","/"),P(null);return}let e=null;try{e=(0,lG.jwtDecode)(A)}catch{lW("token","/"),P(null);return}if(e){if(et(e.key),x(e.disabled_non_admin_personal_key_creation),e.user_role){let t=function(e){if(!e)return"Undefined Role";switch(e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"org_admin":return"Org Admin";case"internal_user":return"Internal User";case"internal_user_viewer":case"internal_viewer":return"Internal Viewer";case"app_user":return"App User";default:return"Unknown Role"}}(e.user_role);a(t),"Admin Viewer"==t&&Z("usage")}e.user_email&&h(e.user_email),e.login_method&&S("username_password"==e.login_method),e.premium_user&&m(e.premium_user),e.auth_header_name&&(0,l.setGlobalLitellmHeaderName)(e.auth_header_name),e.user_id&&z(e.user_id)}},[A]),(0,i.useEffect)(()=>{ee&&O&&e&&(0,sX.fetchUserModels)(O,e,ee,N),ee&&O&&e&&(0,eR.fetchTeams)(ee,O,e,null,j),ee&&(0,sZ.fetchOrganizations)(ee,_)},[ee,O,e]),(0,i.useEffect)(()=>{ee&&A&&(async()=>{try{let e=await (0,l.getInProductNudgesCall)(ee),t=e?.is_claude_code_enabled||!1;V(t),t&&(H(!0),B(!1))}catch(e){console.error("Failed to fetch in-product nudges:",e)}})()},[ee,A]),(0,i.useEffect)(()=>{if(R&&!q){let e=setTimeout(()=>{B(!1)},15e3);return()=>clearTimeout(e)}},[R,q]),(0,i.useEffect)(()=>{if(G&&!K){let e=setTimeout(()=>{H(!1)},15e3);return()=>clearTimeout(e)}},[G,K]),D||er)?(0,t.jsx)(eB.default,{}):(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)(eB.default,{}),children:(0,t.jsx)(aP.QueryClientProvider,{client:lQ,children:(0,t.jsx)(lK.ConfigProvider,{theme:{algorithm:Q?aR.theme.darkAlgorithm:aR.theme.defaultAlgorithm},children:(0,t.jsx)(l$.ThemeProvider,{accessToken:ee,children:J?(0,t.jsx)(aI.default,{userID:O,userRole:e,premiumUser:r,teams:g,keys:y,setUserRole:a,userEmail:p,setUserEmail:h,setTeams:j,setKeys:f,organizations:b,addKey:el,createClicked:L}):(0,t.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,t.jsx)(s_.default,{userID:O,userRole:e,premiumUser:r,userEmail:p,setProxySettings:k,proxySettings:w,accessToken:ee,isPublicPage:!1,sidebarCollapsed:es,onToggleSidebar:()=>{ea(!es)},isDarkMode:Q,toggleDarkMode:()=>{Y(!Q)}}),(0,t.jsxs)("div",{className:"flex flex-1",children:[(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(n,{setPage:e=>{let t=new URLSearchParams(T);t.set("page",e),window.history.pushState(null,"",`?${t.toString()}`),Z(e)},defaultSelectedKey:X,sidebarCollapsed:es})}),"api-keys"==X?(0,t.jsx)(aI.default,{userID:O,userRole:e,premiumUser:r,teams:g,keys:y,setUserRole:a,userEmail:p,setUserEmail:h,setTeams:j,setKeys:f,organizations:b,addKey:el,createClicked:L}):"models"==X?(0,t.jsx)(o.default,{token:A,keys:y,modelData:I,setModelData:F,premiumUser:r,teams:g}):"llm-playground"==X?(0,t.jsx)(d.default,{}):"users"==X?(0,t.jsx)(lq.default,{userID:O,userRole:e,token:A,keys:y,teams:g,accessToken:ee,setKeys:f}):"teams"==X?(0,t.jsx)(sJ,{teams:g,setTeams:j,accessToken:ee,userID:O,userRole:e,organizations:b,premiumUser:r,searchParams:T}):"organizations"==X?(0,t.jsx)(sZ.default,{organizations:b,setOrganizations:_,userModels:v,accessToken:ee,userRole:e,premiumUser:r}):"admin-panel"==X?(0,t.jsx)(c.default,{proxySettings:w}):"api_ref"==X?(0,t.jsx)(s.default,{proxySettings:w}):"logging-and-alerts"==X?(0,t.jsx)(an.default,{userID:O,userRole:e,accessToken:ee,premiumUser:r}):"budgets"==X?(0,t.jsx)(eE.default,{accessToken:ee}):"guardrails"==X?(0,t.jsx)(sj.default,{accessToken:ee,userRole:e}):"policies"==X?(0,t.jsx)(sy.default,{accessToken:ee,userRole:e}):"agents"==X?(0,t.jsx)(eD,{accessToken:ee,userRole:e}):"prompts"==X?(0,t.jsx)(s1.default,{accessToken:ee,userRole:e}):"transform-request"==X?(0,t.jsx)(aC.default,{accessToken:ee}):"router-settings"==X?(0,t.jsx)(tY.default,{userID:O,userRole:e,accessToken:ee,modelData:I}):"ui-theme"==X?(0,t.jsx)(aS.default,{userID:O,userRole:e,accessToken:ee}):"cost-tracking"==X?(0,t.jsx)(tQ,{userID:O,userRole:e,accessToken:ee}):"model-hub-table"==X?(0,ey.isAdminRole)(e)?(0,t.jsx)(sb.default,{accessToken:ee,publicPage:!1,premiumUser:r,userRole:e}):(0,t.jsx)(s2.default,{accessToken:ee,isEmbedded:!0}):"caching"==X?(0,t.jsx)(eO.default,{userID:O,userRole:e,token:A,accessToken:ee,premiumUser:r}):"pass-through-settings"==X?(0,t.jsx)(s0.default,{userID:O,userRole:e,accessToken:ee,modelData:I,premiumUser:r}):"logs"==X?(0,t.jsx)(lB.default,{userID:O,userRole:e,token:A,accessToken:ee,allTeams:g??[],premiumUser:r}):"mcp-servers"==X?(0,t.jsx)(sf.MCPServers,{accessToken:ee,userRole:e,userID:O}):"search-tools"==X?(0,t.jsx)(ai,{accessToken:ee,userRole:e,userID:O}):"tag-management"==X?(0,t.jsx)(ak.default,{accessToken:ee,userRole:e,userID:O}):"claude-code-plugins"==X?(0,t.jsx)(ez.default,{accessToken:ee,userRole:e}):"access-groups"==X?(0,t.jsx)(ln,{}):"projects"==X?(0,t.jsx)(lL,{}):"vector-stores"==X?(0,t.jsx)(lM.default,{accessToken:ee,userRole:e,userID:O}):"tool-policies"==X?(0,t.jsx)(lR,{accessToken:ee,userRole:e}):"guardrails-monitor"==X?(0,t.jsx)(sg,{accessToken:ee}):"new_usage"==X?(0,t.jsx)(sv.default,{teams:g??[],organizations:b??[]}):(0,t.jsx)(aT.default,{userID:O,userRole:e,token:A,accessToken:ee,keys:y,premiumUser:r})]}),(0,t.jsx)(ap,{isVisible:R,onOpen:()=>{B(!1),$(!0)},onDismiss:()=>{B(!1)}}),(0,t.jsx)(a_,{isOpen:q,onClose:()=>{$(!1),B(!0)},onComplete:()=>{$(!1)}}),(0,t.jsx)(aN,{isVisible:G,onOpen:()=>{H(!1),W(!0)},onDismiss:()=>{H(!1)}}),(0,t.jsx)(aw,{isOpen:K,onClose:()=>{W(!1),H(!0)},onComplete:()=>{W(!1)}})]})})})})})}function lJ(){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)(eB.default,{}),children:(0,t.jsx)(lY,{})})}e.s(["default",()=>lJ],952683)}]);