"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7794],{91027:function(e,s,t){t.d(s,{Z:function(){return d}});var a=t(57437),l=t(33866),n=t(2265),r=t(9245);function i(e){let s=s=>{"disableShowNewBadge"===s.key&&e()},t=s=>{let{key:t}=s.detail;"disableShowNewBadge"===t&&e()};return window.addEventListener("storage",s),window.addEventListener(r.Qg,t),()=>{window.removeEventListener("storage",s),window.removeEventListener(r.Qg,t)}}function o(){return"true"===(0,r.le)("disableShowNewBadge")}function d(e){let{children:s,dot:t=!1}=e;return(0,n.useSyncExternalStore)(i,o)?s?(0,a.jsx)(a.Fragment,{children:s}):null:s?(0,a.jsx)(l.Z,{color:"blue",count:t?void 0:"New",dot:t,children:s}):(0,a.jsx)(l.Z,{color:"blue",count:t?void 0:"New",dot:t})}},12363:function(e,s,t){t.d(s,{d:function(){return n},n:function(){return l}});var a=t(2265);let l=()=>{let[e,s]=(0,a.useState)("http://localhost:4000");return(0,a.useEffect)(()=>{{let{protocol:e,host:t}=window.location;s("".concat(e,"//").concat(t))}},[]),e},n=25},30841:function(e,s,t){t.d(s,{IE:function(){return n},LO:function(){return l},cT:function(){return r}});var a=t(19250);let l=async e=>{if(!e)return[];try{let{aliases:s}=await (0,a.keyAliasesCall)(e);return Array.from(new Set((s||[]).filter(Boolean)))}catch(e){return console.error("Error fetching all key aliases:",e),[]}},n=async(e,s)=>{if(!e)return[];try{let t=[],l=1,n=!0;for(;n;){let r=await (0,a.teamListCall)(e,s||null,null);t=[...t,...r],l<r.total_pages?l++:n=!1}return t}catch(e){return console.error("Error fetching all teams:",e),[]}},r=async e=>{if(!e)return[];try{let s=[],t=1,l=!0;for(;l;){let n=await (0,a.organizationListCall)(e);s=[...s,...n],t<n.total_pages?t++:l=!1}return s}catch(e){return console.error("Error fetching all organizations:",e),[]}}},23048:function(e,s,t){var a=t(57437),l=t(2265),n=t(5545),r=t(37592),i=t(4260),o=t(2356),d=t(7310),c=t.n(d);s.Z=e=>{let{options:s,onApplyFilters:t,onResetFilters:d,initialValues:m={},buttonLabel:u="Filters"}=e,[x,h]=(0,l.useState)(!1),[p,g]=(0,l.useState)(m),[f,j]=(0,l.useState)({}),[v,y]=(0,l.useState)({}),[b,N]=(0,l.useState)({}),[w,_]=(0,l.useState)({}),k=(0,l.useCallback)(c()(async(e,s)=>{if(s.isSearchable&&s.searchFn){y(e=>({...e,[s.name]:!0}));try{let t=await s.searchFn(e);j(e=>({...e,[s.name]:t}))}catch(e){console.error("Error searching:",e),j(e=>({...e,[s.name]:[]}))}finally{y(e=>({...e,[s.name]:!1}))}}},300),[]),S=(0,l.useCallback)(async e=>{if(e.isSearchable&&e.searchFn&&!w[e.name]){y(s=>({...s,[e.name]:!0})),_(s=>({...s,[e.name]:!0}));try{let s=await e.searchFn("");j(t=>({...t,[e.name]:s}))}catch(s){console.error("Error loading initial options:",s),j(s=>({...s,[e.name]:[]}))}finally{y(s=>({...s,[e.name]:!1}))}}},[w]);(0,l.useEffect)(()=>{x&&s.forEach(e=>{e.isSearchable&&!w[e.name]&&S(e)})},[x,s,S,w]);let C=(e,s)=>{let a={...p,[e]:s};g(a),t(a)},L=(e,s)=>{e&&s.isSearchable&&!w[s.name]&&S(s)};return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,a.jsx)(n.ZP,{icon:(0,a.jsx)(o.Z,{className:"h-4 w-4"}),onClick:()=>h(!x),className:"flex items-center gap-2",children:u}),(0,a.jsx)(n.ZP,{onClick:()=>{let e={};s.forEach(s=>{e[s.name]=""}),g(e),d()},children:"Reset Filters"})]}),x&&(0,a.jsx)("div",{className:"grid grid-cols-3 gap-x-6 gap-y-4 mb-6",children:["Team ID","Status","Organization ID","Key Alias","User ID","End User","Error Code","Error Message","Key Hash","Model"].map(e=>{let t=s.find(s=>s.label===e||s.name===e);return t?(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:t.label||t.name}),t.isSearchable?(0,a.jsx)(r.default,{showSearch:!0,className:"w-full",placeholder:"Search ".concat(t.label||t.name,"..."),value:p[t.name]||void 0,onChange:e=>C(t.name,e),onDropdownVisibleChange:e=>L(e,t),onSearch:e=>{N(s=>({...s,[t.name]:e})),t.searchFn&&k(e,t)},filterOption:!1,loading:v[t.name],options:f[t.name]||[],allowClear:!0,notFoundContent:v[t.name]?"Loading...":"No results found"}):t.options?(0,a.jsx)(r.default,{className:"w-full",placeholder:"Select ".concat(t.label||t.name,"..."),value:p[t.name]||void 0,onChange:e=>C(t.name,e),allowClear:!0,children:t.options.map(e=>(0,a.jsx)(r.default.Option,{value:e.value,children:e.label},e.value))}):(0,a.jsx)(i.default,{className:"w-full",placeholder:"Enter ".concat(t.label||t.name,"..."),value:p[t.name]||"",onChange:e=>C(t.name,e.target.value),allowClear:!0})]},t.name):null})})]})}},57049:function(e,s,t){t.d(s,{I:function(){return tc},Z:function(){return td}});var a,l,n=t(57437),r=t(29827),i=t(11713),o=t(77398),d=t.n(o),c=t(2265),m=t(99981),u=t(44851);let x=e=>e>=.8?"text-green-600":"text-yellow-600";var h=e=>{let{entities:s}=e,[t,a]=(0,c.useState)(!0),[l,r]=(0,c.useState)({}),i=e=>{r(s=>({...s,[e]:!s[e]}))};return s&&0!==s.length?(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsxs)("div",{className:"flex items-center mb-2 cursor-pointer",onClick:()=>a(!t),children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsxs)("h4",{className:"font-medium",children:["Detected Entities (",s.length,")"]})]}),t&&(0,n.jsx)("div",{className:"space-y-2",children:s.map((e,s)=>{let t=l[s]||!1;return(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>i(s),children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsx)("span",{className:"font-medium mr-2",children:e.entity_type}),(0,n.jsxs)("span",{className:"font-mono ".concat(x(e.score)),children:["Score: ",e.score.toFixed(2)]})]}),(0,n.jsxs)("span",{className:"text-xs text-gray-500",children:["Position: ",e.start,"-",e.end]})]}),t&&(0,n.jsx)("div",{className:"p-3 border-t bg-white",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Entity Type:"}),(0,n.jsx)("span",{children:e.entity_type})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Position:"}),(0,n.jsxs)("span",{children:["Characters ",e.start,"-",e.end]})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Confidence:"}),(0,n.jsx)("span",{className:x(e.score),children:e.score.toFixed(2)})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[e.recognition_metadata&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Recognizer:"}),(0,n.jsx)("span",{children:e.recognition_metadata.recognizer_name})]}),(0,n.jsxs)("div",{className:"flex overflow-hidden",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Identifier:"}),(0,n.jsx)("span",{className:"truncate text-xs font-mono",children:e.recognition_metadata.recognizer_identifier})]})]}),e.analysis_explanation&&(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Explanation:"}),(0,n.jsx)("span",{children:e.analysis_explanation})]})]})]})})]},s)})})]}):null};let p=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"slate";return(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat({green:"bg-green-100 text-green-800",red:"bg-red-100 text-red-800",blue:"bg-blue-50 text-blue-700",slate:"bg-slate-100 text-slate-800",amber:"bg-amber-100 text-amber-800"}[s]),children:e})},g=e=>e?p("detected","red"):p("not detected","slate"),f=e=>{let{title:s,count:t,defaultOpen:a=!0,right:l,children:r}=e,[i,o]=(0,c.useState)(a);return(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>o(e=>!e),children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(i?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsxs)("h5",{className:"font-medium",children:[s," ","number"==typeof t&&(0,n.jsxs)("span",{className:"text-gray-500 font-normal",children:["(",t,")"]})]})]}),(0,n.jsx)("div",{children:l})]}),i&&(0,n.jsx)("div",{className:"p-3 border-t bg-white",children:r})]})},j=e=>{let{label:s,children:t,mono:a}=e;return(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:s}),(0,n.jsx)("span",{className:a?"font-mono text-sm break-all":"",children:t})]})},v=()=>(0,n.jsx)("div",{className:"my-3 border-t"});var y=e=>{var s,t,a,l,r,i,o,d,c,m;let{response:u}=e;if(!u)return null;let x=null!==(r=null!==(l=u.outputs)&&void 0!==l?l:u.output)&&void 0!==r?r:[],h="GUARDRAIL_INTERVENED"===u.action?"red":"green",y=(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(null===(s=u.guardrailCoverage)||void 0===s?void 0:s.textCharacters)&&p("text guarded ".concat(null!==(i=u.guardrailCoverage.textCharacters.guarded)&&void 0!==i?i:0,"/").concat(null!==(o=u.guardrailCoverage.textCharacters.total)&&void 0!==o?o:0),"blue"),(null===(t=u.guardrailCoverage)||void 0===t?void 0:t.images)&&p("images guarded ".concat(null!==(d=u.guardrailCoverage.images.guarded)&&void 0!==d?d:0,"/").concat(null!==(c=u.guardrailCoverage.images.total)&&void 0!==c?c:0),"blue")]}),b=u.usage&&(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(u.usage).map(e=>{let[s,t]=e;return"number"==typeof t?(0,n.jsxs)("span",{className:"px-2 py-1 bg-slate-100 text-slate-800 rounded-md text-xs font-medium",children:[s,": ",t]},s):null})});return(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(j,{label:"Action:",children:p(null!==(m=u.action)&&void 0!==m?m:"N/A",h)}),u.actionReason&&(0,n.jsx)(j,{label:"Action Reason:",children:u.actionReason}),u.blockedResponse&&(0,n.jsx)(j,{label:"Blocked Response:",children:(0,n.jsx)("span",{className:"italic",children:u.blockedResponse})})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(j,{label:"Coverage:",children:y}),(0,n.jsx)(j,{label:"Usage:",children:b})]})]}),x.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v,{}),(0,n.jsx)("h4",{className:"font-medium mb-2",children:"Outputs"}),(0,n.jsx)("div",{className:"space-y-2",children:x.map((e,s)=>{var t;return(0,n.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,n.jsx)("div",{className:"text-sm whitespace-pre-wrap",children:null!==(t=e.text)&&void 0!==t?t:(0,n.jsx)("em",{children:"(non-text output)"})})},s)})})]})]}),(null===(a=u.assessments)||void 0===a?void 0:a.length)?(0,n.jsx)("div",{className:"space-y-3",children:u.assessments.map((e,s)=>{var t,a,l,r,i,o,d,c,m,u,x,h,v,y,b,N,w,_,k,S,C,L,E,T;let M=(0,n.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.wordPolicy&&p("word","slate"),e.contentPolicy&&p("content","slate"),e.topicPolicy&&p("topic","slate"),e.sensitiveInformationPolicy&&p("sensitive-info","slate"),e.contextualGroundingPolicy&&p("contextual-grounding","slate"),e.automatedReasoningPolicy&&p("automated-reasoning","slate")]});return(0,n.jsxs)(f,{title:"Assessment #".concat(s+1),defaultOpen:!0,right:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(null===(t=e.invocationMetrics)||void 0===t?void 0:t.guardrailProcessingLatency)!=null&&p("".concat(e.invocationMetrics.guardrailProcessingLatency," ms"),"amber"),M]}),children:[e.wordPolicy&&(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h6",{className:"font-medium mb-2",children:"Word Policy"}),(null!==(N=null===(a=e.wordPolicy.customWords)||void 0===a?void 0:a.length)&&void 0!==N?N:0)>0&&(0,n.jsx)(f,{title:"Custom Words",defaultOpen:!0,children:(0,n.jsx)("div",{className:"space-y-2",children:e.wordPolicy.customWords.map((e,s)=>{var t;return(0,n.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[p(null!==(t=e.action)&&void 0!==t?t:"N/A",e.detected?"red":"slate"),(0,n.jsx)("span",{className:"font-mono text-sm break-all",children:e.match})]}),g(e.detected)]},s)})})}),(null!==(w=null===(l=e.wordPolicy.managedWordLists)||void 0===l?void 0:l.length)&&void 0!==w?w:0)>0&&(0,n.jsx)(f,{title:"Managed Word Lists",defaultOpen:!1,children:(0,n.jsx)("div",{className:"space-y-2",children:e.wordPolicy.managedWordLists.map((e,s)=>{var t;return(0,n.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[p(null!==(t=e.action)&&void 0!==t?t:"N/A",e.detected?"red":"slate"),(0,n.jsx)("span",{className:"font-mono text-sm break-all",children:e.match}),e.type&&p(e.type,"slate")]}),g(e.detected)]},s)})})})]}),(null===(i=e.contentPolicy)||void 0===i?void 0:null===(r=i.filters)||void 0===r?void 0:r.length)?(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h6",{className:"font-medium mb-2",children:"Content Policy"}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full text-sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"text-left text-gray-600",children:[(0,n.jsx)("th",{className:"py-1 pr-4",children:"Type"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Action"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Detected"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Strength"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Confidence"})]})}),(0,n.jsx)("tbody",{children:e.contentPolicy.filters.map((e,s)=>{var t,a,l,r;return(0,n.jsxs)("tr",{className:"border-t",children:[(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(t=e.type)&&void 0!==t?t:"—"}),(0,n.jsx)("td",{className:"py-1 pr-4",children:p(null!==(a=e.action)&&void 0!==a?a:"—",e.detected?"red":"slate")}),(0,n.jsx)("td",{className:"py-1 pr-4",children:g(e.detected)}),(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(l=e.filterStrength)&&void 0!==l?l:"—"}),(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(r=e.confidence)&&void 0!==r?r:"—"})]},s)})})]})})]}):null,(null===(d=e.contextualGroundingPolicy)||void 0===d?void 0:null===(o=d.filters)||void 0===o?void 0:o.length)?(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h6",{className:"font-medium mb-2",children:"Contextual Grounding"}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full text-sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"text-left text-gray-600",children:[(0,n.jsx)("th",{className:"py-1 pr-4",children:"Type"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Action"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Detected"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Score"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Threshold"})]})}),(0,n.jsx)("tbody",{children:e.contextualGroundingPolicy.filters.map((e,s)=>{var t,a,l,r;return(0,n.jsxs)("tr",{className:"border-t",children:[(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(t=e.type)&&void 0!==t?t:"—"}),(0,n.jsx)("td",{className:"py-1 pr-4",children:p(null!==(a=e.action)&&void 0!==a?a:"—",e.detected?"red":"slate")}),(0,n.jsx)("td",{className:"py-1 pr-4",children:g(e.detected)}),(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(l=e.score)&&void 0!==l?l:"—"}),(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(r=e.threshold)&&void 0!==r?r:"—"})]},s)})})]})})]}):null,e.sensitiveInformationPolicy&&(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h6",{className:"font-medium mb-2",children:"Sensitive Information"}),(null!==(_=null===(c=e.sensitiveInformationPolicy.piiEntities)||void 0===c?void 0:c.length)&&void 0!==_?_:0)>0&&(0,n.jsx)(f,{title:"PII Entities",defaultOpen:!0,children:(0,n.jsx)("div",{className:"space-y-2",children:e.sensitiveInformationPolicy.piiEntities.map((e,s)=>{var t;return(0,n.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[p(null!==(t=e.action)&&void 0!==t?t:"N/A",e.detected?"red":"slate"),e.type&&p(e.type,"slate"),(0,n.jsx)("span",{className:"font-mono text-xs break-all",children:e.match})]}),g(e.detected)]},s)})})}),(null!==(k=null===(m=e.sensitiveInformationPolicy.regexes)||void 0===m?void 0:m.length)&&void 0!==k?k:0)>0&&(0,n.jsx)(f,{title:"Custom Regexes",defaultOpen:!1,children:(0,n.jsx)("div",{className:"space-y-2",children:e.sensitiveInformationPolicy.regexes.map((e,s)=>{var t,a;return(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-2 bg-gray-50 rounded gap-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[p(null!==(t=e.action)&&void 0!==t?t:"N/A",e.detected?"red":"slate"),(0,n.jsx)("span",{className:"font-medium",children:null!==(a=e.name)&&void 0!==a?a:"regex"}),(0,n.jsx)("span",{className:"font-mono text-xs break-all",children:e.regex})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[g(e.detected),e.match&&(0,n.jsx)("span",{className:"font-mono text-xs break-all",children:e.match})]})]},s)})})})]}),(null===(x=e.topicPolicy)||void 0===x?void 0:null===(u=x.topics)||void 0===u?void 0:u.length)?(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h6",{className:"font-medium mb-2",children:"Topic Policy"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:e.topicPolicy.topics.map((e,s)=>{var t,a;return(0,n.jsx)("div",{className:"px-3 py-1.5 bg-gray-50 rounded-md text-xs",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[p(null!==(t=e.action)&&void 0!==t?t:"N/A",e.detected?"red":"slate"),(0,n.jsx)("span",{className:"font-medium",children:null!==(a=e.name)&&void 0!==a?a:"topic"}),e.type&&p(e.type,"slate"),g(e.detected)]})},s)})})]}):null,e.invocationMetrics&&(0,n.jsx)(f,{title:"Invocation Metrics",defaultOpen:!1,children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(j,{label:"Latency (ms)",children:null!==(S=e.invocationMetrics.guardrailProcessingLatency)&&void 0!==S?S:"—"}),(0,n.jsx)(j,{label:"Coverage:",children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(null===(h=e.invocationMetrics.guardrailCoverage)||void 0===h?void 0:h.textCharacters)&&p("text ".concat(null!==(C=e.invocationMetrics.guardrailCoverage.textCharacters.guarded)&&void 0!==C?C:0,"/").concat(null!==(L=e.invocationMetrics.guardrailCoverage.textCharacters.total)&&void 0!==L?L:0),"blue"),(null===(v=e.invocationMetrics.guardrailCoverage)||void 0===v?void 0:v.images)&&p("images ".concat(null!==(E=e.invocationMetrics.guardrailCoverage.images.guarded)&&void 0!==E?E:0,"/").concat(null!==(T=e.invocationMetrics.guardrailCoverage.images.total)&&void 0!==T?T:0),"blue")]})})]}),(0,n.jsx)("div",{className:"space-y-2",children:(0,n.jsx)(j,{label:"Usage:",children:(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:e.invocationMetrics.usage&&Object.entries(e.invocationMetrics.usage).map(e=>{let[s,t]=e;return"number"==typeof t?(0,n.jsxs)("span",{className:"px-2 py-1 bg-slate-100 text-slate-800 rounded-md text-xs font-medium",children:[s,": ",t]},s):null})})})})]})}),(null===(b=e.automatedReasoningPolicy)||void 0===b?void 0:null===(y=b.findings)||void 0===y?void 0:y.length)?(0,n.jsx)(f,{title:"Automated Reasoning Findings",defaultOpen:!1,children:(0,n.jsx)("div",{className:"space-y-2",children:e.automatedReasoningPolicy.findings.map((e,s)=>(0,n.jsx)("pre",{className:"bg-gray-50 rounded p-2 text-xs overflow-x-auto",children:JSON.stringify(e,null,2)},s))})}):null]},s)})}):null,(0,n.jsx)(f,{title:"Raw Bedrock Guardrail Response",defaultOpen:!1,children:(0,n.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(u,null,2)})})]})};let b=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"slate";return(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat({green:"bg-green-100 text-green-800",red:"bg-red-100 text-red-800",blue:"bg-blue-50 text-blue-700",slate:"bg-slate-100 text-slate-800",amber:"bg-amber-100 text-amber-800"}[s]),children:e})},N=e=>{let{title:s,count:t,defaultOpen:a=!0,children:l}=e,[r,i]=(0,c.useState)(a);return(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,n.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>i(e=>!e),children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(r?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsxs)("h5",{className:"font-medium",children:[s," ","number"==typeof t&&(0,n.jsxs)("span",{className:"text-gray-500 font-normal",children:["(",t,")"]})]})]})}),r&&(0,n.jsx)("div",{className:"p-3 border-t bg-white",children:l})]})},w=e=>{let{label:s,children:t,mono:a}=e;return(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:s}),(0,n.jsx)("span",{className:a?"font-mono text-sm break-all":"",children:t})]})};var _=e=>{let{response:s}=e;if(!s||"string"==typeof s)return"string"==typeof s&&s?(0,n.jsx)("div",{className:"bg-white rounded-lg border border-red-200 p-4",children:(0,n.jsxs)("div",{className:"text-red-800",children:[(0,n.jsx)("h5",{className:"font-medium mb-2",children:"Error"}),(0,n.jsx)("p",{className:"text-sm",children:s})]})}):null;let t=Array.isArray(s)?s:[];if(0===t.length)return(0,n.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,n.jsx)("div",{className:"text-gray-600 text-sm",children:"No detections found"})});let a=t.filter(e=>"pattern"===e.type),l=t.filter(e=>"blocked_word"===e.type),r=t.filter(e=>"category_keyword"===e.type),i=t.filter(e=>"BLOCK"===e.action).length,o=t.filter(e=>"MASK"===e.action).length,d=t.length;return(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(w,{label:"Total Detections:",children:(0,n.jsx)("span",{className:"font-semibold",children:d})}),(0,n.jsx)(w,{label:"Actions:",children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[i>0&&b("".concat(i," blocked"),"red"),o>0&&b("".concat(o," masked"),"blue"),0===i&&0===o&&b("passed","green")]})})]}),(0,n.jsx)("div",{className:"space-y-2",children:(0,n.jsx)(w,{label:"By Type:",children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.length>0&&b("".concat(a.length," patterns"),"slate"),l.length>0&&b("".concat(l.length," keywords"),"slate"),r.length>0&&b("".concat(r.length," categories"),"slate")]})})})]})}),a.length>0&&(0,n.jsx)(N,{title:"Patterns Matched",count:a.length,defaultOpen:!0,children:(0,n.jsx)("div",{className:"space-y-2",children:a.map((e,s)=>(0,n.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsx)("div",{className:"space-y-1",children:(0,n.jsx)(w,{label:"Pattern:",children:e.pattern_name||"unknown"})}),(0,n.jsx)("div",{className:"space-y-1",children:(0,n.jsx)(w,{label:"Action:",children:b(e.action,"BLOCK"===e.action?"red":"blue")})})]})},s))})}),l.length>0&&(0,n.jsx)(N,{title:"Blocked Words Detected",count:l.length,defaultOpen:!0,children:(0,n.jsx)("div",{className:"space-y-2",children:l.map((e,s)=>(0,n.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(w,{label:"Keyword:",mono:!0,children:e.keyword||"unknown"}),e.description&&(0,n.jsx)(w,{label:"Description:",children:e.description})]}),(0,n.jsx)("div",{className:"space-y-1",children:(0,n.jsx)(w,{label:"Action:",children:b(e.action,"BLOCK"===e.action?"red":"blue")})})]})},s))})}),r.length>0&&(0,n.jsx)(N,{title:"Category Keywords Detected",count:r.length,defaultOpen:!0,children:(0,n.jsx)("div",{className:"space-y-2",children:r.map((e,s)=>(0,n.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(w,{label:"Category:",children:e.category||"unknown"}),(0,n.jsx)(w,{label:"Keyword:",mono:!0,children:e.keyword||"unknown"}),e.severity&&(0,n.jsx)(w,{label:"Severity:",children:b(e.severity,"high"===e.severity?"red":"medium"===e.severity?"amber":"slate")})]}),(0,n.jsx)("div",{className:"space-y-1",children:(0,n.jsx)(w,{label:"Action:",children:b(e.action,"BLOCK"===e.action?"red":"blue")})})]})},s))})}),(0,n.jsx)(N,{title:"Raw Detection Data",defaultOpen:!1,children:(0,n.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(t,null,2)})})]})};let k=e=>new Date(1e3*e).toLocaleString(),S=new Set(["presidio","bedrock","litellm_content_filter"]),C=e=>{let{response:s}=e,[t,a]=(0,c.useState)(!1);return(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,n.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>a(!t),children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsx)("h5",{className:"font-medium",children:"Raw Guardrail Response"})]})}),t&&(0,n.jsx)("div",{className:"p-3 border-t bg-white",children:(0,n.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(s,null,2)})})]})})},L=e=>{var s,t;let{entry:a,index:l,total:r}=e,i=null!==(s=a.guardrail_provider)&&void 0!==s?s:"presidio",o=null!==(t=a.guardrail_status)&&void 0!==t?t:"unknown",d="success"===o.toLowerCase(),c=a.masked_entity_count||{},u=Object.values(c).reduce((e,s)=>e+("number"==typeof s?s:0),0),x=a.guardrail_response,p=Array.isArray(x)?x:[],g="bedrock"!==i||null===x||"object"!=typeof x||Array.isArray(x)?void 0:x;return(0,n.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[r>1&&(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsxs)("h4",{className:"text-base font-semibold",children:["Guardrail #",l+1,(0,n.jsx)("span",{className:"ml-2 font-mono text-sm text-gray-600",children:a.guardrail_name})]}),(0,n.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded-md text-xs capitalize",children:i})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail Name:"}),(0,n.jsx)("span",{className:"font-mono break-words",children:a.guardrail_name})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Mode:"}),(0,n.jsx)("span",{className:"font-mono break-words",children:a.guardrail_mode})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,n.jsx)(m.Z,{title:d?null:"Guardrail failed to run.",placement:"top",arrow:!0,destroyTooltipOnHide:!0,children:(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat(d?"bg-green-100 text-green-800":"bg-red-100 text-red-800 cursor-help"),children:o})})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,n.jsx)("span",{children:k(a.start_time)})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,n.jsx)("span",{children:k(a.end_time)})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,n.jsxs)("span",{children:[a.duration.toFixed(4),"s"]})]})]})]}),u>0&&(0,n.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,n.jsx)("h5",{className:"font-medium mb-2",children:"Masked Entity Summary"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(c).map(e=>{let[s,t]=e;return(0,n.jsxs)("span",{className:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[s,": ",t]},s)})})]}),"presidio"===i&&p.length>0&&(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(h,{entities:p})}),"bedrock"===i&&g&&(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(y,{response:g})}),"litellm_content_filter"===i&&x&&(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(_,{response:x})}),i&&!S.has(i)&&x&&(0,n.jsx)(C,{response:x})]})};var E=e=>{let{data:s}=e,t=Array.isArray(s)?s.filter(e=>!!e):s?[s]:[],a=1===t.length?t[0].guardrail_name:"".concat(t.length," guardrails"),l=Array.from(new Set(t.map(e=>e.guardrail_status))).every(e=>"success"===(null!=e?e:"").toLowerCase()),r=t.reduce((e,s)=>e+Object.values(s.masked_entity_count||{}).reduce((e,s)=>e+("number"==typeof s?s:0),0),0);return 0===t.length?null:(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(u.default,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Guardrail Information"}),(0,n.jsx)(m.Z,{title:l?null:"Guardrail failed to run.",placement:"top",arrow:!0,destroyTooltipOnHide:!0,children:(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat(l?"bg-green-100 text-green-800":"bg-red-100 text-red-800 cursor-help"),children:l?"success":"failure"})}),(0,n.jsx)("span",{className:"font-mono text-sm text-gray-600",children:a}),r>0&&(0,n.jsxs)("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[r," masked ",1===r?"entity":"entities"]})]}),children:(0,n.jsx)("div",{className:"p-4 space-y-6",children:t.map((e,s)=>{var a;return(0,n.jsx)(L,{entry:e,index:s,total:t.length},"".concat(null!==(a=e.guardrail_name)&&void 0!==a?a:"guardrail","-").concat(s))})})}]})})},T=t(59872),M=t(9309),D=t(55322),Z=t(59341),z=t(12485),A=t(18135),R=t(35242),I=t(29706),O=t(77991),P=t(5545),B=t(20347),H=t(30280),K=t(44633),q=t(86462),F=t(49084),Y=t(71594),U=t(24525),V=t(19130);function W(e){let{keys:s,totalCount:t,isLoading:a,isFetching:l,pageIndex:r,pageSize:i,onPageChange:o}=e,[d,u]=(0,c.useState)([{id:"deleted_at",desc:!0}]),[x,h]=(0,c.useState)({pageIndex:r,pageSize:i});c.useEffect(()=>{h({pageIndex:r,pageSize:i})},[r,i]);let p=[{id:"token",accessorKey:"token",header:"Key ID",size:150,maxSize:250,cell:e=>{let s=e.getValue();return(0,n.jsx)(m.Z,{title:s,children:(0,n.jsx)("span",{className:"font-mono text-blue-500 text-xs truncate block max-w-[250px]",children:s||"-"})})}},{id:"key_alias",accessorKey:"key_alias",header:"Key Alias",size:150,maxSize:200,cell:e=>{let s=e.getValue();return(0,n.jsx)(m.Z,{title:s,children:(0,n.jsx)("span",{className:"font-mono text-xs truncate block max-w-[200px]",children:null!=s?s:"-"})})}},{id:"team_alias",accessorKey:"team_alias",header:"Team Alias",size:120,maxSize:180,cell:e=>{let s=e.getValue();return(0,n.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",size:100,maxSize:140,cell:e=>(0,n.jsx)("span",{className:"block max-w-[140px]",children:(0,T.pw)(e.getValue(),4)})},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",size:110,maxSize:150,cell:e=>{let s=e.getValue();return(0,n.jsx)("span",{className:"block max-w-[150px]",children:null===s?"Unlimited":"$".concat((0,T.pw)(s))})}},{id:"user_email",accessorKey:"user_email",header:"User Email",size:160,maxSize:250,cell:e=>{let s=e.getValue();return(0,n.jsx)(m.Z,{title:s,children:(0,n.jsx)("span",{className:"font-mono text-xs truncate block max-w-[250px]",children:null!=s?s:"-"})})}},{id:"user_id",accessorKey:"user_id",header:"User ID",size:120,maxSize:200,cell:e=>{let s=e.getValue();return(0,n.jsx)(m.Z,{title:s||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[200px]",children:s||"-"})})}},{id:"created_at",accessorKey:"created_at",header:"Created At",size:120,maxSize:140,cell:e=>{let s=e.getValue();return(0,n.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"created_by",accessorKey:"created_by",header:"Created By",size:120,maxSize:180,cell:e=>{let s=e.row.original.created_by;return(0,n.jsx)(m.Z,{title:s||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})})}},{id:"deleted_at",accessorKey:"deleted_at",header:"Deleted At",size:120,maxSize:140,cell:e=>{let s=e.row.original.deleted_at;return(0,n.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"deleted_by",accessorKey:"deleted_by",header:"Deleted By",size:120,maxSize:180,cell:e=>{let s=e.row.original.deleted_by;return(0,n.jsx)(m.Z,{title:s||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})})}}],g=(0,Y.b7)({data:s,columns:p,columnResizeMode:"onChange",columnResizeDirection:"ltr",state:{sorting:d,pagination:x},onSortingChange:u,onPaginationChange:e=>{let s="function"==typeof e?e(x):e;h(s),o(s.pageIndex)},getCoreRowModel:(0,U.sC)(),getSortedRowModel:(0,U.tj)(),getPaginationRowModel:(0,U.G_)(),enableSorting:!0,manualSorting:!1,manualPagination:!0,pageCount:Math.ceil(t/i)}),{pageIndex:f}=g.getState().pagination,j=f*i+1,v="".concat(j," - ").concat(Math.min((f+1)*i,t));return(0,n.jsx)("div",{className:"w-full h-full overflow-hidden",children:(0,n.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between w-full mb-4",children:[a||l?(0,n.jsx)("span",{className:"inline-flex text-sm text-gray-700",children:"Loading..."}):(0,n.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",v," of ",t," results"]}),(0,n.jsxs)("div",{className:"inline-flex items-center gap-2",children:[a||l?(0,n.jsx)("span",{className:"text-sm text-gray-700",children:"Loading..."}):(0,n.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",f+1," of ",g.getPageCount()]}),(0,n.jsx)("button",{onClick:()=>g.previousPage(),disabled:a||l||!g.getCanPreviousPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,n.jsx)("button",{onClick:()=>g.nextPage(),disabled:a||l||!g.getCanNextPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),(0,n.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,n.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)(V.iA,{className:"[&_td]:py-0.5 [&_th]:py-1",style:{width:g.getCenterTotalSize()},children:[(0,n.jsx)(V.ss,{children:g.getHeaderGroups().map(e=>(0,n.jsx)(V.SC,{children:e.headers.map(e=>(0,n.jsx)(V.xs,{"data-header-id":e.id,className:"py-1 h-8 relative hover:bg-gray-50",style:{width:e.getSize(),maxWidth:e.column.columnDef.maxSize,position:"relative"},onMouseEnter:()=>{let s=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));s&&(s.style.opacity="0.5")},onMouseLeave:()=>{let s=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));s&&!e.column.getIsResizing()&&(s.style.opacity="0")},onClick:e.column.getToggleSortingHandler(),children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,Y.ie)(e.column.columnDef.header,e.getContext())}),(0,n.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,n.jsx)(K.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,n.jsx)(q.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,n.jsx)(F.Z,{className:"h-4 w-4 text-gray-400"})}),(0,n.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:"resizer ".concat(g.options.columnResizeDirection," ").concat(e.column.getIsResizing()?"isResizing":""),style:{position:"absolute",right:0,top:0,height:"100%",width:"5px",background:e.column.getIsResizing()?"#3b82f6":"transparent",cursor:"col-resize",userSelect:"none",touchAction:"none",opacity:e.column.getIsResizing()?1:0}})]})},e.id))},e.id))}),(0,n.jsx)(V.RM,{children:a||l?(0,n.jsx)(V.SC,{children:(0,n.jsx)(V.pj,{colSpan:p.length,className:"h-8 text-center",children:(0,n.jsx)("div",{className:"text-center text-gray-500",children:(0,n.jsx)("p",{children:"\uD83D\uDE85 Loading keys..."})})})}):s.length>0?g.getRowModel().rows.map(e=>(0,n.jsx)(V.SC,{className:"h-8",children:e.getVisibleCells().map(e=>(0,n.jsx)(V.pj,{style:{width:e.column.getSize(),maxWidth:e.column.columnDef.maxSize,whiteSpace:"pre-wrap",overflow:"hidden"},className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,Y.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,n.jsx)(V.SC,{children:(0,n.jsx)(V.pj,{colSpan:p.length,className:"h-8 text-center",children:(0,n.jsx)("div",{className:"text-center text-gray-500",children:(0,n.jsx)("p",{children:"No deleted keys found"})})})})})]})})})})]})})}function J(){let[e,s]=(0,c.useState)(0),[t]=(0,c.useState)(50),{data:a,isPending:l,isFetching:r}=(0,H.Tv)(e+1,t);return(0,n.jsx)(W,{keys:(null==a?void 0:a.keys)||[],totalCount:(null==a?void 0:a.total_count)||0,isLoading:l,isFetching:r,pageIndex:e,pageSize:t,onPageChange:s})}var G=t(47359),Q=t(41649),$=t(21626),X=t(97214),ee=t(28241),es=t(58834),et=t(69552),ea=t(71876),el=t(84264),en=t(46468);function er(e){let{teams:s,isLoading:t,isFetching:a}=e,[l,r]=(0,c.useState)([{id:"deleted_at",desc:!0}]),i=[{id:"team_alias",accessorKey:"team_alias",header:"Team Name",size:150,maxSize:200,cell:e=>{let s=e.getValue();return(0,n.jsx)(m.Z,{title:s||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[200px]",children:s||"-"})})}},{id:"team_id",accessorKey:"team_id",header:"Team ID",size:150,maxSize:250,cell:e=>{let s=e.getValue();return(0,n.jsx)(m.Z,{title:s,children:(0,n.jsx)("span",{className:"font-mono text-blue-500 text-xs truncate block max-w-[250px]",children:s||"-"})})}},{id:"created_at",accessorKey:"created_at",header:"Created",size:120,maxSize:140,cell:e=>{let s=e.getValue();return(0,n.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",size:100,maxSize:140,cell:e=>{let s=e.row.original.spend;return(0,n.jsx)("span",{className:"block max-w-[140px]",children:void 0!==s?(0,T.pw)(s,4):"-"})}},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",size:110,maxSize:150,cell:e=>{let s=e.getValue();return(0,n.jsx)("span",{className:"block max-w-[150px]",children:null==s?"No limit":"$".concat((0,T.pw)(s))})}},{id:"models",accessorKey:"models",header:"Models",size:200,maxSize:300,cell:e=>{let s=e.getValue();return Array.isArray(s)&&0!==s.length?(0,n.jsxs)("div",{className:"flex flex-wrap gap-1 max-w-[300px]",children:[s.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,n.jsx)(Q.Z,{size:"xs",color:"red",children:(0,n.jsx)(el.Z,{children:"All Proxy Models"})},s):(0,n.jsx)(Q.Z,{size:"xs",color:"blue",children:(0,n.jsx)(el.Z,{children:e.length>30?"".concat((0,en.W0)(e).slice(0,30),"..."):(0,en.W0)(e)})},s)),s.length>3&&(0,n.jsx)(Q.Z,{size:"xs",color:"gray",children:(0,n.jsxs)(el.Z,{children:["+",s.length-3," ",s.length-3==1?"more model":"more models"]})})]}):(0,n.jsx)(Q.Z,{size:"xs",color:"red",children:(0,n.jsx)(el.Z,{children:"All Proxy Models"})})}},{id:"organization_id",accessorKey:"organization_id",header:"Organization",size:150,maxSize:200,cell:e=>{let s=e.getValue();return(0,n.jsx)(m.Z,{title:s||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[200px]",children:s||"-"})})}},{id:"deleted_at",accessorKey:"deleted_at",header:"Deleted At",size:120,maxSize:140,cell:e=>{let s=e.row.original.deleted_at;return(0,n.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"deleted_by",accessorKey:"deleted_by",header:"Deleted By",size:120,maxSize:180,cell:e=>{let s=e.row.original.deleted_by;return(0,n.jsx)(m.Z,{title:s||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})})}}],o=(0,Y.b7)({data:s,columns:i,columnResizeMode:"onChange",columnResizeDirection:"ltr",state:{sorting:l},onSortingChange:r,getCoreRowModel:(0,U.sC)(),getSortedRowModel:(0,U.tj)(),enableSorting:!0,manualSorting:!1});return(0,n.jsx)("div",{className:"w-full h-full overflow-hidden",children:(0,n.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,n.jsx)("div",{className:"flex items-center justify-between w-full mb-4",children:t||a?(0,n.jsx)("span",{className:"inline-flex text-sm text-gray-700",children:"Loading..."}):(0,n.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",s.length," ",1===s.length?"team":"teams"]})}),(0,n.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,n.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)($.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",style:{width:o.getCenterTotalSize()},children:[(0,n.jsx)(es.Z,{children:o.getHeaderGroups().map(e=>(0,n.jsx)(ea.Z,{children:e.headers.map(e=>(0,n.jsx)(et.Z,{"data-header-id":e.id,className:"py-1 h-8 relative hover:bg-gray-50",style:{width:e.getSize(),maxWidth:e.column.columnDef.maxSize,position:"relative"},onMouseEnter:()=>{let s=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));s&&(s.style.opacity="0.5")},onMouseLeave:()=>{let s=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));s&&!e.column.getIsResizing()&&(s.style.opacity="0")},onClick:e.column.getToggleSortingHandler(),children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,Y.ie)(e.column.columnDef.header,e.getContext())}),(0,n.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,n.jsx)(K.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,n.jsx)(q.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,n.jsx)(F.Z,{className:"h-4 w-4 text-gray-400"})}),(0,n.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:"resizer ".concat(o.options.columnResizeDirection," ").concat(e.column.getIsResizing()?"isResizing":""),style:{position:"absolute",right:0,top:0,height:"100%",width:"5px",background:e.column.getIsResizing()?"#3b82f6":"transparent",cursor:"col-resize",userSelect:"none",touchAction:"none",opacity:e.column.getIsResizing()?1:0}})]})},e.id))},e.id))}),(0,n.jsx)(X.Z,{children:t||a?(0,n.jsx)(ea.Z,{children:(0,n.jsx)(ee.Z,{colSpan:i.length,className:"h-8 text-center",children:(0,n.jsx)("div",{className:"text-center text-gray-500",children:(0,n.jsx)("p",{children:"\uD83D\uDE85 Loading teams..."})})})}):s.length>0?o.getRowModel().rows.map(e=>(0,n.jsx)(ea.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,n.jsx)(ee.Z,{style:{width:e.column.getSize(),maxWidth:e.column.columnDef.maxSize,whiteSpace:"pre-wrap",overflow:"hidden"},className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,Y.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,n.jsx)(ea.Z,{children:(0,n.jsx)(ee.Z,{colSpan:i.length,className:"h-8 text-center",children:(0,n.jsx)("div",{className:"text-center text-gray-500",children:(0,n.jsx)("p",{children:"No deleted teams found"})})})})})]})})})})]})})}function ei(){let{data:e,isPending:s,isFetching:t}=(0,G.iN)(1,100);return(0,n.jsx)(er,{teams:e||[],isLoading:s,isFetching:t})}var eo=t(30841),ed=t(23048),ec=t(19250),em=t(50665),eu=t(12322),ex=t(78489),eh=t(42673);let ep=e=>{try{return new Date(e).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).replace(",","")}catch(e){return"Error converting time"}},eg=e=>{let{utcTime:s}=e;return(0,n.jsx)("span",{style:{fontFamily:"monospace",width:"180px",display:"inline-block"},children:ep(s)})},ef=(e,s)=>{var t,a;return(null===(a=e.metadata)||void 0===a?void 0:null===(t=a.mcp_tool_call_metadata)||void 0===t?void 0:t.mcp_server_logo_url)?e.metadata.mcp_tool_call_metadata.mcp_server_logo_url:s?(0,eh.dr)(s).logo:""},ej=[{header:"Time",accessorKey:"startTime",cell:e=>(0,n.jsx)(eg,{utcTime:e.getValue()})},{header:"Status",accessorKey:"metadata.status",cell:e=>{let s="failure"!==(e.getValue()||"Success").toLowerCase();return(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat(s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s?"Success":"Failure"})}},{header:"Session ID",accessorKey:"session_id",cell:e=>{let s=String(e.getValue()||""),t=e.row.original.onSessionClick;return(0,n.jsx)(m.Z,{title:String(e.getValue()||""),children:(0,n.jsx)(ex.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal text-xs max-w-[15ch] truncate block",onClick:()=>null==t?void 0:t(s),children:String(e.getValue()||"")})})}},{header:"Request ID",accessorKey:"request_id",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||""),children:(0,n.jsx)("span",{className:"font-mono text-xs max-w-[15ch] truncate block",children:String(e.getValue()||"")})})},{header:"Cost",accessorKey:"spend",cell:e=>(0,n.jsx)(m.Z,{title:"$".concat(String(e.getValue()||0)," "),children:(0,n.jsx)("span",{children:(0,T.GS)(e.getValue()||0)})})},{header:"Duration (s)",accessorKey:"duration",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Team Name",accessorKey:"metadata.user_api_key_team_alias",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Key Hash",accessorKey:"metadata.user_api_key",cell:e=>{let s=String(e.getValue()||"-"),t=e.row.original.onKeyHashClick;return(0,n.jsx)(m.Z,{title:s,children:(0,n.jsx)("span",{className:"font-mono max-w-[15ch] truncate block cursor-pointer hover:text-blue-600",onClick:()=>null==t?void 0:t(s),children:s})})}},{header:"Key Name",accessorKey:"metadata.user_api_key_alias",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Model",accessorKey:"model",cell:e=>{let s=e.row.original,t=s.custom_llm_provider,a=String(e.getValue()||"");return(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,n.jsx)("img",{src:ef(s,t),alt:"",className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,n.jsx)(m.Z,{title:a,children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:a})})]})}},{header:"Tokens",accessorKey:"total_tokens",cell:e=>{let s=e.row.original;return(0,n.jsxs)("span",{className:"text-sm",children:[String(s.total_tokens||"0"),(0,n.jsxs)("span",{className:"text-gray-400 text-xs ml-1",children:["(",String(s.prompt_tokens||"0"),"+",String(s.completion_tokens||"0"),")"]})]})}},{header:"Internal User",accessorKey:"user",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"End User",accessorKey:"end_user",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Tags",accessorKey:"request_tags",cell:e=>{let s=e.getValue();if(!s||0===Object.keys(s).length)return"-";let t=Object.entries(s),a=t[0],l=t.slice(1);return(0,n.jsx)("div",{className:"flex flex-wrap gap-1",children:(0,n.jsx)(m.Z,{title:(0,n.jsx)("div",{className:"flex flex-col gap-1",children:t.map(e=>{let[s,t]=e;return(0,n.jsxs)("span",{children:[s,": ",String(t)]},s)})}),children:(0,n.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[a[0],": ",String(a[1]),l.length>0&&" +".concat(l.length)]})})})}}],ev=e=>(0,n.jsx)(Q.Z,{color:"gray",className:"flex items-center gap-1",children:(0,n.jsx)("span",{className:"whitespace-nowrap text-xs",children:e})}),ey=[{id:"expander",header:()=>null,cell:e=>{let{row:s}=e;return(0,n.jsx)(()=>{let[e,t]=c.useState(s.getIsExpanded()),a=c.useCallback(()=>{t(e=>!e),s.getToggleExpandedHandler()()},[s]);return s.getCanExpand()?(0,n.jsx)("button",{onClick:a,style:{cursor:"pointer"},"aria-label":e?"Collapse row":"Expand row",className:"w-6 h-6 flex items-center justify-center focus:outline-none",children:(0,n.jsx)("svg",{className:"w-4 h-4 transform transition-transform ".concat(e?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):(0,n.jsx)("span",{className:"w-6 h-6 flex items-center justify-center",children:"●"})},{})}},{header:"Timestamp",accessorKey:"updated_at",cell:e=>(0,n.jsx)(eg,{utcTime:e.getValue()})},{header:"Table Name",accessorKey:"table_name",cell:e=>{let s=e.getValue(),t=s;switch(s){case"LiteLLM_VerificationToken":t="Keys";break;case"LiteLLM_TeamTable":t="Teams";break;case"LiteLLM_OrganizationTable":t="Organizations";break;case"LiteLLM_UserTable":t="Users";break;case"LiteLLM_ProxyModelTable":t="Models";break;default:t=s}return(0,n.jsx)("span",{children:t})}},{header:"Action",accessorKey:"action",cell:e=>(0,n.jsx)("span",{children:ev(e.getValue())})},{header:"Changed By",accessorKey:"changed_by",cell:e=>{let s=e.row.original.changed_by,t=e.row.original.changed_by_api_key;return(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("div",{className:"font-medium",children:s}),t&&(0,n.jsx)(m.Z,{title:t,children:(0,n.jsxs)("div",{className:"text-xs text-muted-foreground max-w-[15ch] truncate",children:[" ",t]})})]})}},{header:"Affected Item ID",accessorKey:"object_id",cell:e=>(0,n.jsx)(()=>{let s=e.getValue(),[t,a]=(0,c.useState)(!1);if(!s)return(0,n.jsx)(n.Fragment,{children:"-"});let l=async()=>{try{await navigator.clipboard.writeText(String(s)),a(!0),setTimeout(()=>a(!1),1500)}catch(e){console.error("Failed to copy object ID: ",e)}};return(0,n.jsx)(m.Z,{title:t?"Copied!":String(s),children:(0,n.jsx)("span",{className:"max-w-[20ch] truncate block cursor-pointer hover:text-blue-600",onClick:l,children:String(s)})})},{})}];var eb=t(92280);let eN="".concat("../ui/assets/","audit-logs-preview.png");function ew(e){let{userID:s,userRole:t,token:a,accessToken:l,isActive:r,premiumUser:o,allTeams:m}=e,[u,x]=(0,c.useState)(d()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),h=(0,c.useRef)(null),p=(0,c.useRef)(null),[g,f]=(0,c.useState)(1),[j]=(0,c.useState)(50),[v,y]=(0,c.useState)({}),[b,N]=(0,c.useState)(""),[w,_]=(0,c.useState)(""),[k,S]=(0,c.useState)(""),[C,L]=(0,c.useState)("all"),[E,M]=(0,c.useState)("all"),[D,Z]=(0,c.useState)(!1),[z,A]=(0,c.useState)(!1),R=(0,i.a)({queryKey:["all_audit_logs",l,a,t,s,u],queryFn:async()=>{if(!l||!a||!t||!s)return[];let e=d()(u).utc().format("YYYY-MM-DD HH:mm:ss"),n=d()().utc().format("YYYY-MM-DD HH:mm:ss"),r=[],i=1,o=1;do{let s=await (0,ec.uiAuditLogsCall)(l,e,n,i,50);r=r.concat(s.audit_logs),o=s.total_pages,i++}while(i<=o);return r},enabled:!!l&&!!a&&!!t&&!!s&&r,refetchInterval:5e3,refetchIntervalInBackground:!0}),I=(0,c.useCallback)(async e=>{if(l)try{let s=(await (0,ec.keyListCall)(l,null,null,e,null,null,1,10)).keys.find(s=>s.key_alias===e);s?_(s.token):_("")}catch(e){console.error("Error fetching key hash for alias:",e),_("")}},[l]);(0,c.useEffect)(()=>{if(!l)return;let e=!1,s=!1;v["Team ID"]?b!==v["Team ID"]&&(N(v["Team ID"]),e=!0):""!==b&&(N(""),e=!0),v["Key Hash"]?w!==v["Key Hash"]&&(_(v["Key Hash"]),s=!0):v["Key Alias"]?I(v["Key Alias"]):""!==w&&(_(""),s=!0),(e||s)&&f(1)},[v,l,I,b,w]),(0,c.useEffect)(()=>{f(1)},[b,w,u,k,C,E]),(0,c.useEffect)(()=>{function e(e){h.current&&!h.current.contains(e.target)&&Z(!1),p.current&&!p.current.contains(e.target)&&A(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let O=(0,c.useMemo)(()=>R.data?R.data.filter(e=>{var s,t,a,l,n,r,i;let o=!0,d=!0,c=!0,m=!0,u=!0;if(b){let n="string"==typeof e.before_value?null===(s=JSON.parse(e.before_value))||void 0===s?void 0:s.team_id:null===(t=e.before_value)||void 0===t?void 0:t.team_id,r="string"==typeof e.updated_values?null===(a=JSON.parse(e.updated_values))||void 0===a?void 0:a.team_id:null===(l=e.updated_values)||void 0===l?void 0:l.team_id;o=n===b||r===b}if(w)try{let s="string"==typeof e.before_value?JSON.parse(e.before_value):e.before_value,t="string"==typeof e.updated_values?JSON.parse(e.updated_values):e.updated_values,a=null==s?void 0:s.token,l=null==t?void 0:t.token;d="string"==typeof a&&a.includes(w)||"string"==typeof l&&l.includes(w)}catch(e){d=!1}if(k&&(c=null===(n=e.object_id)||void 0===n?void 0:n.toLowerCase().includes(k.toLowerCase())),"all"!==C&&(m=(null===(r=e.action)||void 0===r?void 0:r.toLowerCase())===C.toLowerCase()),"all"!==E){let s="";switch(E){case"keys":s="litellm_verificationtoken";break;case"teams":s="litellm_teamtable";break;case"users":s="litellm_usertable";break;default:s=E}u=(null===(i=e.table_name)||void 0===i?void 0:i.toLowerCase())===s}return o&&d&&c&&m&&u}):[],[R.data,b,w,k,C,E]),P=O.length,B=Math.ceil(P/j)||1,H=(0,c.useMemo)(()=>{let e=(g-1)*j,s=e+j;return O.slice(e,s)},[O,g,j]),K=!R.data||0===R.data.length,q=(0,c.useCallback)(e=>{let{row:s}=e;return(0,n.jsx)(e=>{let{rowData:s}=e,{before_value:t,updated_values:a,table_name:l,action:r}=s,i=(e,s)=>{if(!e||0===Object.keys(e).length)return(0,n.jsx)(eb.x,{children:"N/A"});if(s){let s=Object.keys(e),t=["token","spend","max_budget"];if(s.every(e=>t.includes(e))&&s.length>0)return(0,n.jsxs)("div",{children:[s.includes("token")&&(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Token:"})," ",e.token||"N/A"]}),s.includes("spend")&&(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Spend:"})," ",void 0!==e.spend?"$".concat((0,T.pw)(e.spend,6)):"N/A"]}),s.includes("max_budget")&&(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Max Budget:"})," ",void 0!==e.max_budget?"$".concat((0,T.pw)(e.max_budget,6)):"N/A"]})]});if(e["No differing fields detected in 'before' state"]||e["No differing fields detected in 'updated' state"]||e["No fields changed"])return(0,n.jsx)(eb.x,{children:e[Object.keys(e)[0]]})}return(0,n.jsx)("pre",{className:"p-2 bg-gray-50 border rounded text-xs overflow-auto max-h-60",children:JSON.stringify(e,null,2)})},o=t,d=a;if(("updated"===r||"rotated"===r)&&t&&a&&("LiteLLM_TeamTable"===l||"LiteLLM_UserTable"===l||"LiteLLM_VerificationToken"===l)){let e={},s={};new Set([...Object.keys(t),...Object.keys(a)]).forEach(l=>{JSON.stringify(t[l])!==JSON.stringify(a[l])&&(t.hasOwnProperty(l)&&(e[l]=t[l]),a.hasOwnProperty(l)&&(s[l]=a[l]))}),Object.keys(t).forEach(l=>{a.hasOwnProperty(l)||e.hasOwnProperty(l)||(e[l]=t[l],s[l]=void 0)}),Object.keys(a).forEach(l=>{t.hasOwnProperty(l)||s.hasOwnProperty(l)||(s[l]=a[l],e[l]=void 0)}),o=Object.keys(e).length>0?e:{"No differing fields detected in 'before' state":"N/A"},d=Object.keys(s).length>0?s:{"No differing fields detected in 'updated' state":"N/A"},0===Object.keys(e).length&&0===Object.keys(s).length&&(o={"No fields changed":"N/A"},d={"No fields changed":"N/A"})}return(0,n.jsxs)("div",{className:"-mx-4 p-4 bg-slate-100 border-y border-slate-300 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Before Value:"}),i(o,"LiteLLM_VerificationToken"===l)]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Updated Value:"}),i(d,"LiteLLM_VerificationToken"===l)]})]})},{rowData:s.original})},[]);if(!o)return(0,n.jsxs)("div",{style:{textAlign:"center",marginTop:"20px"},children:[(0,n.jsx)("h1",{style:{display:"block",marginBottom:"10px"},children:"✨ Enterprise Feature."}),(0,n.jsx)(eb.x,{style:{display:"block",marginBottom:"10px"},children:"This is a LiteLLM Enterprise feature, and requires a valid key to use."}),(0,n.jsx)(eb.x,{style:{display:"block",marginBottom:"20px",fontStyle:"italic"},children:"Here's a preview of what Audit Logs offer:"}),(0,n.jsx)("img",{src:eN,alt:"Audit Logs Preview",style:{maxWidth:"100%",maxHeight:"700px",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",margin:"0 auto"},onError:e=>{console.error("Failed to load audit logs preview image"),e.target.style.display="none"}})]});let F=P>0?(g-1)*j+1:0,Y=Math.min(g*j,P);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex items-center justify-between mb-4"}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,n.jsxs)("div",{className:"border-b px-6 py-4",children:[(0,n.jsx)("h1",{className:"text-xl font-semibold py-4",children:"Audit Logs"}),(0,n.jsx)(e=>{let{show:s}=e;return s?(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start mb-6",children:[(0,n.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,n.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Audit Logs Not Available"}),(0,n.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"To enable audit logging, add the following configuration to your LiteLLM proxy configuration file:"}),(0,n.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"litellm_settings:\n  store_audit_logs: true"}),(0,n.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change and proxy restart."})]})]}):null},{show:K}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:[(0,n.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("input",{type:"text",placeholder:"Search by Object ID...",value:k,onChange:e=>S(e.target.value),className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,n.jsxs)("button",{onClick:()=>{R.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,n.jsx)("svg",{className:"w-4 h-4 ".concat(R.isFetching?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,n.jsx)("span",{children:"Refresh"})]})]})}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("div",{className:"relative",ref:h,children:[(0,n.jsx)("label",{htmlFor:"actionFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Action:"}),(0,n.jsxs)("button",{id:"actionFilterDisplay",onClick:()=>Z(!D),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,n.jsxs)("span",{children:["all"===C&&"All Actions","created"===C&&"Created","updated"===C&&"Updated","deleted"===C&&"Deleted","rotated"===C&&"Rotated"]}),(0,n.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),D&&(0,n.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,n.jsx)("div",{className:"space-y-1",children:[{label:"All Actions",value:"all"},{label:"Created",value:"created"},{label:"Updated",value:"updated"},{label:"Deleted",value:"deleted"},{label:"Rotated",value:"rotated"}].map(e=>(0,n.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(C===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"),onClick:()=>{L(e.value),Z(!1)},children:e.label},e.value))})})]}),(0,n.jsxs)("div",{className:"relative",ref:p,children:[(0,n.jsx)("label",{htmlFor:"tableFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Table:"}),(0,n.jsxs)("button",{id:"tableFilterDisplay",onClick:()=>A(!z),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,n.jsxs)("span",{children:["all"===E&&"All Tables","keys"===E&&"Keys","teams"===E&&"Teams","users"===E&&"Users"]}),(0,n.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),z&&(0,n.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,n.jsx)("div",{className:"space-y-1",children:[{label:"All Tables",value:"all"},{label:"Keys",value:"keys"},{label:"Teams",value:"teams"},{label:"Users",value:"users"}].map(e=>(0,n.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(E===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"),onClick:()=>{M(e.value),A(!1)},children:e.label},e.value))})})]}),(0,n.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing ",R.isLoading?"...":F," -"," ",R.isLoading?"...":Y," of"," ",R.isLoading?"...":P," results"]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",R.isLoading?"...":g," of"," ",R.isLoading?"...":B]}),(0,n.jsx)("button",{onClick:()=>f(e=>Math.max(1,e-1)),disabled:R.isLoading||1===g,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,n.jsx)("button",{onClick:()=>f(e=>Math.min(B,e+1)),disabled:R.isLoading||g===B,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]}),(0,n.jsx)(eu.w,{columns:ey,data:H,renderSubComponent:q,getRowCanExpand:()=>!0})]})]})}let e_=e=>{let{show:s,onOpenSettings:t}=e;return s?(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start",children:[(0,n.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,n.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Request/Response Data Not Available"}),(0,n.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["To view request and response details, enable prompt storage in your LiteLLM configuration by adding the following to your ",(0,n.jsx)("code",{className:"bg-blue-100 px-1 py-0.5 rounded",children:"proxy_config.yaml"})," file",t&&(0,n.jsxs)(n.Fragment,{children:[" or"," ",(0,n.jsx)("button",{onClick:t,className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"open the settings"})," ","to configure this directly."]})]}),(0,n.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"general_settings:\n  store_model_in_db: true\n  store_prompts_in_spend_logs: true"}),(0,n.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change."})]})]}):null},ek=e=>null==e?"-":"$".concat((0,T.pw)(e,8)),eS=e=>null==e?"-":"".concat((100*e).toFixed(2),"%"),eC=e=>{var s;let{costBreakdown:t,totalSpend:a}=e;if(!t)return null;let l=void 0!==t.discount_percent&&0!==t.discount_percent||void 0!==t.discount_amount&&0!==t.discount_amount,r=void 0!==t.margin_percent&&0!==t.margin_percent||void 0!==t.margin_fixed_amount&&0!==t.margin_fixed_amount||void 0!==t.margin_total_amount&&0!==t.margin_total_amount;return void 0!==t.input_cost||void 0!==t.output_cost||l||r?(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(u.default,{expandIconPosition:"start",items:[{key:"1",label:(0,n.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Cost Breakdown"}),(0,n.jsxs)("div",{className:"flex items-center space-x-2 mr-4",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Total:"}),(0,n.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:ek(a)})]})]}),children:(0,n.jsxs)("div",{className:"p-6 space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2 max-w-2xl",children:[(0,n.jsxs)("div",{className:"flex text-sm",children:[(0,n.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Input Cost:"}),(0,n.jsx)("span",{className:"text-gray-900",children:ek(t.input_cost)})]}),(0,n.jsxs)("div",{className:"flex text-sm",children:[(0,n.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Output Cost:"}),(0,n.jsx)("span",{className:"text-gray-900",children:ek(t.output_cost)})]}),void 0!==t.tool_usage_cost&&t.tool_usage_cost>0&&(0,n.jsxs)("div",{className:"flex text-sm",children:[(0,n.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Tool Usage Cost:"}),(0,n.jsx)("span",{className:"text-gray-900",children:ek(t.tool_usage_cost)})]}),t.additional_costs&&Object.keys(t.additional_costs).length>0&&(0,n.jsx)(n.Fragment,{children:Object.entries(t.additional_costs).map(e=>{let[s,t]=e;return(0,n.jsxs)("div",{className:"flex text-sm",children:[(0,n.jsxs)("span",{className:"text-gray-600 font-medium w-1/3",children:[s,":"]}),(0,n.jsx)("span",{className:"text-gray-900",children:ek(t)})]},s)})})]}),(0,n.jsx)("div",{className:"pt-2 border-t border-gray-100 max-w-2xl",children:(0,n.jsxs)("div",{className:"flex text-sm font-semibold",children:[(0,n.jsx)("span",{className:"text-gray-900 w-1/3",children:"Original LLM Cost:"}),(0,n.jsx)("span",{className:"text-gray-900",children:ek(t.original_cost)})]})}),(l||r)&&(0,n.jsxs)("div",{className:"pt-2 space-y-2 max-w-2xl",children:[l&&(0,n.jsxs)("div",{className:"space-y-2",children:[void 0!==t.discount_percent&&0!==t.discount_percent&&(0,n.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,n.jsxs)("span",{className:"font-medium w-1/3",children:["Discount (",eS(t.discount_percent),"):"]}),(0,n.jsxs)("span",{className:"text-gray-900",children:["-",ek(t.discount_amount)]})]}),void 0!==t.discount_amount&&void 0===t.discount_percent&&(0,n.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Discount Amount:"}),(0,n.jsxs)("span",{className:"text-gray-900",children:["-",ek(t.discount_amount)]})]})]}),r&&(0,n.jsxs)("div",{className:"space-y-2",children:[void 0!==t.margin_percent&&0!==t.margin_percent&&(0,n.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,n.jsxs)("span",{className:"font-medium w-1/3",children:["Margin (",eS(t.margin_percent),"):"]}),(0,n.jsxs)("span",{className:"text-gray-900",children:["+",ek((t.margin_total_amount||0)-(t.margin_fixed_amount||0))]})]}),void 0!==t.margin_fixed_amount&&0!==t.margin_fixed_amount&&(0,n.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Margin:"}),(0,n.jsxs)("span",{className:"text-gray-900",children:["+",ek(t.margin_fixed_amount)]})]})]})]}),(0,n.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 max-w-2xl",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"font-bold text-sm text-gray-900 w-1/3",children:"Final Calculated Cost:"}),(0,n.jsx)("span",{className:"text-sm font-bold text-gray-900",children:ek(null!==(s=t.total_cost)&&void 0!==s?s:a)})]})})]})}]})}):null},eL=e=>{var s;let{errorInfo:t}=e,[a,l]=c.useState({}),[r,i]=c.useState(!1),o=e=>{l(s=>({...s,[e]:!s[e]}))},d=t.traceback&&(s=t.traceback)?Array.from(s.matchAll(/File "([^"]+)", line (\d+)/g)).map(e=>{let t=e[1],a=e[2],l=t.split("/").pop()||t,n=e.index||0,r=s.indexOf('File "',n+1),i=r>-1?s.substring(n,r).trim():s.substring(n).trim(),o=i.split("\n"),d="";return o.length>1&&(d=o[o.length-1].trim()),{filePath:t,fileName:l,lineNumber:a,code:d,inFunction:i.includes(" in ")?i.split(" in ")[1].split("\n")[0]:""}}):[];return(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,n.jsx)("div",{className:"p-4 border-b",children:(0,n.jsxs)("h3",{className:"text-lg font-medium flex items-center text-red-600",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Error Details"]})}),(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsxs)("div",{className:"bg-red-50 rounded-md p-4 mb-4",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"text-red-800 font-medium w-20",children:"Type:"}),(0,n.jsx)("span",{className:"text-red-700",children:t.error_class||"Unknown Error"})]}),(0,n.jsxs)("div",{className:"flex mt-2",children:[(0,n.jsx)("span",{className:"text-red-800 font-medium w-20 flex-shrink-0",children:"Message:"}),(0,n.jsx)("span",{className:"text-red-700 break-words whitespace-pre-wrap",children:t.error_message||"Unknown error occurred"})]})]}),t.traceback&&(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)("h4",{className:"font-medium",children:"Traceback"}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("button",{onClick:()=>{let e=!r;if(i(e),d.length>0){let s={};d.forEach((t,a)=>{s[a]=e}),l(s)}},className:"text-gray-500 hover:text-gray-700 flex items-center text-sm",children:r?"Collapse All":"Expand All"}),(0,n.jsxs)("button",{onClick:()=>navigator.clipboard.writeText(t.traceback||""),className:"text-gray-500 hover:text-gray-700 flex items-center",title:"Copy traceback",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,n.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),(0,n.jsx)("span",{className:"ml-1",children:"Copy"})]})]})]}),(0,n.jsx)("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden shadow-sm",children:d.map((e,s)=>(0,n.jsxs)("div",{className:"border-b border-gray-200 last:border-b-0",children:[(0,n.jsxs)("div",{className:"px-4 py-2 flex items-center justify-between cursor-pointer hover:bg-gray-50",onClick:()=>o(s),children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"text-gray-400 mr-2 w-12 text-right",children:e.lineNumber}),(0,n.jsx)("span",{className:"text-gray-600 font-medium",children:e.fileName}),(0,n.jsx)("span",{className:"text-gray-500 mx-1",children:"in"}),(0,n.jsx)("span",{className:"text-indigo-600 font-medium",children:e.inFunction||e.fileName})]}),(0,n.jsx)("svg",{className:"w-5 h-5 text-gray-500 transition-transform ".concat(a[s]?"transform rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(a[s]||!1)&&e.code&&(0,n.jsx)("div",{className:"px-12 py-2 font-mono text-sm text-gray-800 bg-gray-50 overflow-x-auto border-t border-gray-100",children:e.code})]},s))})]})]})]})};var eE=t(7310),eT=t.n(eE),eM=t(12363);let eD={TEAM_ID:"Team ID",KEY_HASH:"Key Hash",REQUEST_ID:"Request ID",MODEL:"Model",USER_ID:"User ID",END_USER:"End User",STATUS:"Status",KEY_ALIAS:"Key Alias",ERROR_CODE:"Error Code",ERROR_MESSAGE:"Error Message"},eZ=(e,s,t)=>{if(e)return"".concat(d()(s).format("MMM D, h:mm A")," - ").concat(d()(t).format("MMM D, h:mm A"));let a=d()(),l=d()(s),n=a.diff(l,"minutes");if(n>=0&&n<2)return"Last 1 Minute";if(n>=2&&n<16)return"Last 15 Minutes";if(n>=16&&n<61)return"Last Hour";let r=a.diff(l,"hours");return r>=1&&r<5?"Last 4 Hours":r>=5&&r<25?"Last 24 Hours":r>=25&&r<169?"Last 7 Days":"".concat(l.format("MMM D")," - ").concat(a.format("MMM D"))},ez=async(e,s,t,a)=>{console.log("prefetchLogDetails called with",e.length,"logs");let l=e.map(e=>{if(e.request_id)return console.log("Prefetching details for request_id:",e.request_id),a.prefetchQuery({queryKey:["logDetails",e.request_id,s],queryFn:async()=>{console.log("Fetching details for",e.request_id);let a=await (0,ec.uiSpendLogDetailsCall)(t,e.request_id,s);return console.log("Received details for",e.request_id,":",a?"success":"failed"),a},staleTime:6e5,gcTime:6e5})});try{let e=await Promise.all(l);return console.log("All prefetch promises completed:",e.length),e}catch(e){throw console.error("Error in prefetchLogDetails:",e),e}};var eA=t(9114),eR=t(86669);function eI(e){let{row:s,hasMessages:t,hasResponse:a,hasError:l,errorInfo:r,getRawRequest:i,formattedResponse:o}=e,d=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select();let t=document.execCommand("copy");if(document.body.removeChild(s),!t)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}},c=async()=>{await d(JSON.stringify(i(),null,2))?eA.Z.success("Request copied to clipboard"):eA.Z.fromBackend("Failed to copy request")},m=async()=>{await d(JSON.stringify(o(),null,2))?eA.Z.success("Response copied to clipboard"):eA.Z.fromBackend("Failed to copy response")};return(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 w-full max-w-full overflow-hidden box-border",children:[(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,n.jsx)("h3",{className:"text-lg font-medium",children:"Request"}),(0,n.jsx)("button",{onClick:c,className:"p-1 hover:bg-gray-200 rounded",title:"Copy request",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,n.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,n.jsx)("div",{className:"p-4 overflow-auto max-h-96 w-full max-w-full box-border",children:(0,n.jsx)("div",{className:"[&_[role='tree']]:bg-white [&_[role='tree']]:text-slate-900",children:(0,n.jsx)(eR.gc,{data:i(),style:eR.jF,clickToExpandNode:!0})})})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,n.jsxs)("h3",{className:"text-lg font-medium",children:["Response",l&&(0,n.jsxs)("span",{className:"ml-2 text-sm text-red-600",children:["• HTTP code ",(null==r?void 0:r.error_code)||400]})]}),(0,n.jsx)("button",{onClick:m,className:"p-1 hover:bg-gray-200 rounded",title:"Copy response",disabled:!a,children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,n.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,n.jsx)("div",{className:"p-4 overflow-auto max-h-96 w-full max-w-full box-border",children:a?(0,n.jsx)("div",{className:"[&_[role='tree']]:bg-white [&_[role='tree']]:text-slate-900",children:(0,n.jsx)(eR.gc,{data:o(),style:eR.jF,clickToExpandNode:!0})}):(0,n.jsx)("div",{className:"text-gray-500 text-sm italic text-center py-4",children:"Response data not available"})})]})]})}t(52621);var eO=t(12514),eP=t(35829),eB=t(96761),eH=t(10900),eK=t(30401),eq=t(78867);let eF=e=>{let{sessionId:s,logs:t,onBack:a}=e,[l,r]=(0,c.useState)(null),[i,o]=(0,c.useState)({}),d=t.reduce((e,s)=>e+(s.spend||0),0),u=t.reduce((e,s)=>e+(s.total_tokens||0),0),x=t.reduce((e,s)=>{var t,a;return e+((null===(a=s.metadata)||void 0===a?void 0:null===(t=a.additional_usage_values)||void 0===t?void 0:t.cache_read_input_tokens)||0)},0),h=t.reduce((e,s)=>{var t,a;return e+((null===(a=s.metadata)||void 0===a?void 0:null===(t=a.additional_usage_values)||void 0===t?void 0:t.cache_creation_input_tokens)||0)},0),p=u+x+h,g=t.length>0?new Date(t[0].startTime):new Date;(((t.length>0?new Date(t[t.length-1].endTime):new Date).getTime()-g.getTime())/1e3).toFixed(2),t.map(e=>({time:new Date(e.startTime).toISOString(),tokens:e.total_tokens||0,cost:e.spend||0}));let f=async(e,s)=>{await (0,T.vQ)(e)&&(o(e=>({...e,[s]:!0})),setTimeout(()=>{o(e=>({...e,[s]:!1}))},2e3))};return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)(ex.Z,{icon:eH.Z,variant:"light",onClick:a,className:"mb-4",children:"Back to All Logs"}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Session Details"}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,n.jsx)("p",{className:"text-sm text-gray-500 font-mono",children:s}),(0,n.jsx)(P.ZP,{type:"text",size:"small",icon:i["session-id"]?(0,n.jsx)(eK.Z,{size:12}):(0,n.jsx)(eq.Z,{size:12}),onClick:()=>f(s,"session-id"),className:"left-2 z-10 transition-all duration-200 ".concat(i["session-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]}),(0,n.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/ui_logs_sessions",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:["Get started with session management here",(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,n.jsxs)(eO.Z,{children:[(0,n.jsx)(el.Z,{children:"Total Requests"}),(0,n.jsx)(eP.Z,{children:t.length})]}),(0,n.jsxs)(eO.Z,{children:[(0,n.jsx)(el.Z,{children:"Total Cost"}),(0,n.jsxs)(eP.Z,{children:["$",(0,T.pw)(d,6)]})]}),(0,n.jsx)(m.Z,{title:(0,n.jsxs)("div",{className:"text-white min-w-[200px]",children:[(0,n.jsx)("div",{className:"text-lg font-medium mb-3",children:"Usage breakdown"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-base font-medium mb-2",children:"Input usage:"}),(0,n.jsxs)("div",{className:"space-y-2 text-sm text-gray-300",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"input:"}),(0,n.jsx)("span",{className:"ml-8",children:(0,T.pw)(t.reduce((e,s)=>e+(s.prompt_tokens||0),0))})]}),x>0&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"input_cached_tokens:"}),(0,n.jsx)("span",{className:"ml-8",children:(0,T.pw)(x)})]}),h>0&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"input_cache_creation_tokens:"}),(0,n.jsx)("span",{className:"ml-8",children:(0,T.pw)(h)})]})]})]}),(0,n.jsxs)("div",{className:"border-t border-gray-600 pt-3",children:[(0,n.jsx)("div",{className:"text-base font-medium mb-2",children:"Output usage:"}),(0,n.jsx)("div",{className:"space-y-2 text-sm text-gray-300",children:(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"output:"}),(0,n.jsx)("span",{className:"ml-8",children:(0,T.pw)(t.reduce((e,s)=>e+(s.completion_tokens||0),0))})]})})]}),(0,n.jsx)("div",{className:"border-t border-gray-600 pt-3",children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-base font-medium",children:"Total usage:"}),(0,n.jsx)("span",{className:"text-sm text-gray-300",children:(0,T.pw)(p)})]})})]})]}),placement:"top",overlayStyle:{minWidth:"300px"},children:(0,n.jsxs)(eO.Z,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(el.Z,{children:"Total Tokens"}),(0,n.jsx)("span",{className:"text-gray-400 text-sm",children:"ⓘ"})]}),(0,n.jsx)(eP.Z,{children:(0,T.pw)(p)})]})})]}),(0,n.jsx)(eB.Z,{children:"Session Logs"}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(eu.w,{columns:ej,data:t,renderSubComponent:tc,getRowCanExpand:()=>!0,loadingMessage:"Loading logs...",noDataMessage:"No logs found"})})]})};var eY=t(21770),eU=t(90246),eV=t(39760);(a||(a={})).GENERAL_SETTINGS="general_settings",(l||(l={})).MAXIMUM_SPEND_LOGS_RETENTION_PERIOD="maximum_spend_logs_retention_period";let eW=async(e,s)=>{try{let t=ec.proxyBaseUrl?"".concat(ec.proxyBaseUrl,"/config/list?config_type=").concat(s):"/config/list?config_type=".concat(s),a=await fetch(t,{method:"GET",headers:{[(0,ec.getGlobalLitellmHeaderName)()]:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok){let e=await a.json(),s=(0,ec.deriveErrorMessage)(e);throw(0,ec.handleError)(s),Error(s)}return await a.json()}catch(e){throw console.error("Failed to get proxy config for ".concat(s,":"),e),e}},eJ=(0,eU.n)("proxyConfig"),eG=async(e,s)=>{try{let t=ec.proxyBaseUrl?"".concat(ec.proxyBaseUrl,"/config/field/delete"):"/config/field/delete",a=await fetch(t,{method:"POST",headers:{[(0,ec.getGlobalLitellmHeaderName)()]:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){let e=await a.json(),s=(0,ec.deriveErrorMessage)(e);throw(0,ec.handleError)(s),Error(s)}return await a.json()}catch(e){throw console.error("Failed to delete proxy config field ".concat(s.field_name,":"),e),e}},eQ=e=>{let{accessToken:s}=(0,eV.Z)();return(0,i.a)({queryKey:eJ.list({filters:{configType:e}}),queryFn:async()=>await eW(s,e),enabled:!!s})},e$=()=>{let{accessToken:e}=(0,eV.Z)();return(0,eY.D)({mutationFn:async s=>{if(!e)throw Error("Access token is required");return await eG(e,s)}})},eX=async(e,s)=>{let t=(0,ec.getProxyBaseUrl)(),a=await fetch(t?"".concat(t,"/config/update"):"/config/update",{method:"POST",headers:{[(0,ec.getGlobalLitellmHeaderName)()]:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({general_settings:{store_prompts_in_spend_logs:s.store_prompts_in_spend_logs,...s.maximum_spend_logs_retention_period&&{maximum_spend_logs_retention_period:s.maximum_spend_logs_retention_period}}})});if(!a.ok){var l;let e=await a.json().catch(()=>({}));throw Error((null==e?void 0:null===(l=e.error)||void 0===l?void 0:l.message)||(null==e?void 0:e.message)||(null==e?void 0:e.detail)||"Failed to update spend logs settings")}return await a.json()},e0=()=>{let{accessToken:e}=(0,eV.Z)();return(0,eY.D)({mutationFn:async s=>{if(!e)throw Error("Access token is required");return await eX(e,s)}})};var e1=t(91027),e2=t(85968),e4=t(5540),e5=t(10032),e3=t(22116),e6=t(57840),e8=t(58760),e7=t(50337),e9=t(63709),se=t(4260),ss=e=>{var s,t;let{isVisible:r,onCancel:i,onSuccess:o}=e,[d]=e5.Z.useForm(),{mutateAsync:m,isPending:u}=e0(),{mutateAsync:x,isPending:h}=e$(),{data:p,isLoading:g,refetch:f}=eQ(a.GENERAL_SETTINGS),j=e5.Z.useWatch("store_prompts_in_spend_logs",d);(0,c.useEffect)(()=>{r&&f()},[r,f]);let v=(0,c.useMemo)(()=>{var e,s;if(!p)return{store_prompts_in_spend_logs:!1,maximum_spend_logs_retention_period:void 0};let t=p.find(e=>"store_prompts_in_spend_logs"===e.field_name),a=p.find(e=>"maximum_spend_logs_retention_period"===e.field_name);return{store_prompts_in_spend_logs:null!==(e=null==t?void 0:t.field_value)&&void 0!==e&&e,maximum_spend_logs_retention_period:null!==(s=null==a?void 0:a.field_value)&&void 0!==s?s:void 0}},[p]),y=async e=>{try{let s=e.maximum_spend_logs_retention_period;if(!s||"string"==typeof s&&""===s.trim())try{await x({config_type:a.GENERAL_SETTINGS,field_name:l.MAXIMUM_SPEND_LOGS_RETENTION_PERIOD})}catch(e){console.warn("Failed to delete retention period field (may not exist):",e)}let t={store_prompts_in_spend_logs:e.store_prompts_in_spend_logs,...s&&"string"==typeof s&&""!==s.trim()&&{maximum_spend_logs_retention_period:s}};await m(t,{onSuccess:()=>{eA.Z.success("Spend logs settings updated successfully"),f(),null==o||o()},onError:e=>{eA.Z.fromBackend("Failed to save spend logs settings: "+(0,e2.O)(e))}})}catch(e){eA.Z.fromBackend("Failed to save spend logs settings: "+(0,e2.O)(e))}},b=()=>{d.resetFields(),i()};return(0,n.jsx)(e3.Z,{title:(0,n.jsxs)("span",{className:"flex gap-2",children:[(0,n.jsx)(e6.default.Title,{level:5,children:"Spend Logs Settings"}),(0,n.jsx)(e1.Z,{})]}),open:r,footer:(0,n.jsxs)(e8.Z,{children:[(0,n.jsx)(P.ZP,{onClick:b,disabled:u||h||g,children:"Cancel"}),(0,n.jsx)(P.ZP,{type:"primary",loading:u||h,disabled:g,onClick:()=>d.submit(),children:u||h?"Saving...":"Save Settings"})]}),onCancel:b,children:(0,n.jsxs)(e5.Z,{form:d,layout:"horizontal",onFinish:y,initialValues:v,children:[(0,n.jsx)(e5.Z.Item,{label:"Store Prompts in Spend Logs",name:"store_prompts_in_spend_logs",tooltip:(null==p?void 0:null===(s=p.find(e=>"store_prompts_in_spend_logs"===e.field_name))||void 0===s?void 0:s.field_description)||"When enabled, prompts will be stored in spend logs for tracking and analysis purposes.",valuePropName:"checked",children:(0,n.jsx)("div",{children:g?(0,n.jsx)(e7.Z.Input,{active:!0,block:!0}):(0,n.jsx)(e9.Z,{checked:null!=j&&j,onChange:e=>d.setFieldValue("store_prompts_in_spend_logs",e)})})}),(0,n.jsx)(e5.Z.Item,{label:"Maximum Spend Logs Retention Period (Optional)",name:"maximum_spend_logs_retention_period",tooltip:(null==p?void 0:null===(t=p.find(e=>"maximum_spend_logs_retention_period"===e.field_name))||void 0===t?void 0:t.field_description)||"Set the maximum retention period for spend logs (e.g., '7d' for 7 days, '30d' for 30 days). Leave empty for no limit.",children:g?(0,n.jsx)(e7.Z.Input,{active:!0,block:!0}):(0,n.jsx)(se.default,{placeholder:"e.g., 7d, 30d",prefix:(0,n.jsx)(e4.Z,{})})})]},p?JSON.stringify(v):"loading")})};function st(e){let{data:s}=e,[t,a]=(0,c.useState)({});if(!s||0===s.length)return null;let l=e=>new Date(1e3*e).toLocaleString(),r=(e,s)=>"".concat(((s-e)*1e3).toFixed(2),"ms"),i=(e,s)=>{let t="".concat(e,"-").concat(s);a(e=>({...e,[t]:!e[t]}))};return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(u.default,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Vector Store Requests"}),children:(0,n.jsx)("div",{className:"p-4",children:s.map((e,s)=>(0,n.jsxs)("div",{className:"mb-6 last:mb-0",children:[(0,n.jsx)("div",{className:"bg-white rounded-lg border p-4 mb-4",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Query:"}),(0,n.jsx)("span",{className:"font-mono",children:e.query})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Vector Store ID:"}),(0,n.jsx)("span",{className:"font-mono",children:e.vector_store_id})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,n.jsx)("span",{className:"flex items-center",children:(()=>{let{logo:s,displayName:t}=(0,eh.dr)(e.custom_llm_provider);return(0,n.jsxs)(n.Fragment,{children:[s&&(0,n.jsx)("img",{src:s,alt:"".concat(t," logo"),className:"h-5 w-5 mr-2"}),t]})})()})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,n.jsx)("span",{children:l(e.start_time)})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,n.jsx)("span",{children:l(e.end_time)})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,n.jsx)("span",{children:r(e.start_time,e.end_time)})]})]})]})}),(0,n.jsx)("h4",{className:"font-medium mb-2",children:"Search Results"}),(0,n.jsx)("div",{className:"space-y-2",children:e.vector_store_search_response.data.map((e,a)=>{let l=t["".concat(s,"-").concat(a)]||!1;return(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 cursor-pointer",onClick:()=>i(s,a),children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(l?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("span",{className:"font-medium mr-2",children:["Result ",a+1]}),(0,n.jsxs)("span",{className:"text-gray-500 text-sm",children:["Score: ",(0,n.jsx)("span",{className:"font-mono",children:e.score.toFixed(4)})]})]})]}),l&&(0,n.jsx)("div",{className:"p-3 border-t bg-white",children:e.content.map((e,s)=>(0,n.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,n.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:e.type}),(0,n.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all bg-gray-50 p-2 rounded",children:e.text})]},s))})]},a)})})]},s))})}]})})}var sa=t(63134),sl=t(51653),sn=t(5945),sr=t(76188),si=t(3810),so=t(29967),sd=t(65869);let sc="24px",sm="request",su="response",sx="monospace",sh="#f0f0f0",{Text:sp}=e6.default;function sg(e){let{value:s,maxWidth:t=180}=e;return s?(0,n.jsx)(m.Z,{title:s,children:(0,n.jsx)(sp,{copyable:{text:s,tooltips:["Copy","Copied!"]},style:{maxWidth:t,display:"inline-block",verticalAlign:"bottom",fontFamily:sx,fontSize:12},ellipsis:!0,children:s})}):(0,n.jsx)(sp,{type:"secondary",children:"-"})}let{Text:sf}=e6.default;function sj(e){let{prompt:s=0,completion:t=0,total:a=0}=e;return(0,n.jsxs)(sf,{children:[a.toLocaleString()," (",s.toLocaleString()," prompt tokens + ",t.toLocaleString()," completion tokens)"]})}let{Text:sv}=e6.default;function sy(e){let{data:s}=e;return s?(0,n.jsx)("div",{style:{maxHeight:400,overflow:"auto",background:"#fafafa",padding:12,borderRadius:4},children:(0,n.jsx)("div",{className:"[&_[role='tree']]:bg-white [&_[role='tree']]:text-slate-900",children:(0,n.jsx)(eR.gc,{data:s,style:eR.jF,clickToExpandNode:!0})})}):(0,n.jsx)(sv,{type:"secondary",children:"No data"})}var sb=t(59352),sN=t(70464),sw=t(49638);let{Text:s_}=e6.default;function sk(e){let{log:s,onClose:t,onPrevious:a,onNext:l,statusLabel:r,statusColor:i,environment:o}=e,d=s.custom_llm_provider||"",c=d?(0,eh.dr)(d):null;return(0,n.jsxs)("div",{style:{padding:"16px 24px",borderBottom:"1px solid ".concat(sh),backgroundColor:"#fff",position:"sticky",top:0,zIndex:10},children:[(0,n.jsx)(sS,{model:s.model,providerLogo:null==c?void 0:c.logo,providerName:null==c?void 0:c.displayName}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,n.jsx)(sC,{requestId:s.request_id}),(0,n.jsx)(sL,{onPrevious:a,onNext:l,onClose:t})]}),(0,n.jsx)(sE,{log:s,statusLabel:r,statusColor:i,environment:o})]})}function sS(e){let{model:s,providerLogo:t,providerName:a}=e;return(0,n.jsxs)(e8.Z,{size:8,style:{marginBottom:8},children:[t&&(0,n.jsx)("img",{src:t,alt:a||"Provider",style:{width:24,height:24},onError:e=>{e.target.style.display="none"}}),(0,n.jsxs)(e8.Z,{size:8,direction:"horizontal",children:[(0,n.jsx)(s_,{strong:!0,style:{fontSize:14},children:s}),a&&(0,n.jsx)(s_,{type:"secondary",style:{fontSize:12},children:a})]})]})}function sC(e){let{requestId:s}=e;return(0,n.jsx)("div",{style:{flex:1,minWidth:0},children:(0,n.jsx)(m.Z,{title:s,children:(0,n.jsx)(s_,{strong:!0,copyable:{text:s,tooltips:["Copy Request ID","Copied!"]},style:{fontSize:16,fontFamily:sx,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:s})})})}function sL(e){let{onPrevious:s,onNext:t,onClose:a}=e,l={border:"1px solid #d9d9d9",borderRadius:4,padding:"0 4px",fontSize:12,fontFamily:"monospace",marginLeft:4,background:"#fafafa"};return(0,n.jsxs)(e8.Z,{size:4,split:(0,n.jsx)("div",{style:{width:1,height:20,background:sh}}),children:[(0,n.jsxs)(P.ZP,{type:"text",size:"small",onClick:s,children:[(0,n.jsx)(sb.Z,{}),(0,n.jsx)("span",{style:l,children:"K"})]}),(0,n.jsxs)(P.ZP,{type:"text",size:"small",onClick:t,children:[(0,n.jsx)(sN.Z,{}),(0,n.jsx)("span",{style:l,children:"J"})]}),(0,n.jsx)(m.Z,{title:"ESC to close",children:(0,n.jsx)(P.ZP,{type:"text",icon:(0,n.jsx)(sw.Z,{}),onClick:a})})]})}function sE(e){let{log:s,statusLabel:t,statusColor:a,environment:l}=e;return(0,n.jsxs)(e8.Z,{size:12,children:[(0,n.jsx)(si.Z,{color:a,children:t}),(0,n.jsxs)(si.Z,{children:["Env: ",l]}),(0,n.jsxs)(e8.Z,{size:8,children:[(0,n.jsx)(s_,{type:"secondary",style:{fontSize:13},children:d()(s.startTime).format("MMM D, YYYY h:mm:ss A")}),(0,n.jsxs)(s_,{type:"secondary",style:{fontSize:13},children:["(",d()(s.startTime).fromNow(),")"]})]})]})}function sT(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}function sM(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}var sD=t(58630),sZ=t(77565),sz=t(56609);let{Text:sA}=e6.default;function sR(e){var s;let{tool:t}=e,a=Object.entries((null===(s=t.parameters)||void 0===s?void 0:s.properties)||{}).map(e=>{var s,a;let[l,n]=e;return{key:l,name:l,type:n.type||"any",description:n.description||"-",required:(null===(a=t.parameters)||void 0===a?void 0:null===(s=a.required)||void 0===s?void 0:s.includes(l))||!1}}),l=[{title:"Parameter",dataIndex:"name",key:"name",render:(e,s)=>(0,n.jsxs)(sA,{code:!0,children:[e,s.required&&(0,n.jsx)(sA,{type:"danger",children:"*"})]})},{title:"Type",dataIndex:"type",key:"type",render:e=>(0,n.jsx)(sA,{code:!0,style:{color:"#1890ff"},children:e})},{title:"Description",dataIndex:"description",key:"description",render:e=>(0,n.jsx)(sA,{type:"secondary",children:e})}];return(0,n.jsxs)("div",{children:[t.description&&(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsx)(sA,{style:{lineHeight:1.6},children:t.description})}),a.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)(sA,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:8},children:"Parameters"}),(0,n.jsx)(sz.Z,{dataSource:a,columns:l,pagination:!1,size:"small",bordered:!0})]}),t.called&&t.callData&&(0,n.jsxs)("div",{style:{marginTop:16},children:[(0,n.jsx)(sA,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:8},children:"Called With"}),(0,n.jsx)("div",{style:{background:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:4,padding:12},children:(0,n.jsx)("pre",{style:{margin:0,fontSize:12,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(t.callData.arguments,null,2)})})]})]})}function sI(e){let{tool:s}=e,t={type:"function",function:{name:s.name,description:s.description,parameters:s.parameters}};return(0,n.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:12,background:"#fafafa",padding:12,borderRadius:4,maxHeight:300,overflow:"auto"},children:JSON.stringify(t,null,2)})}let{Text:sO}=e6.default;function sP(e){let{tool:s}=e,[t,a]=(0,c.useState)("formatted");return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[(0,n.jsx)(sO,{type:"secondary",style:{fontSize:12},children:"Description"}),(0,n.jsxs)(so.ZP.Group,{size:"small",value:t,onChange:e=>a(e.target.value),children:[(0,n.jsx)(so.ZP.Button,{value:"formatted",children:"Formatted"}),(0,n.jsx)(so.ZP.Button,{value:"json",children:"JSON"})]})]}),"formatted"===t?(0,n.jsx)(sR,{tool:s}):(0,n.jsx)(sI,{tool:s})]})}let{Text:sB}=e6.default;function sH(e){let{tool:s}=e,[t,a]=(0,c.useState)(!1);return(0,n.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:8,overflow:"hidden"},children:[(0,n.jsxs)("div",{onClick:()=>a(!t),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",cursor:"pointer",background:t?"#fafafa":"#fff",transition:"background 0.2s"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,n.jsx)(sD.Z,{style:{color:"#8c8c8c",fontSize:14}}),(0,n.jsxs)(sB,{style:{fontSize:14},children:[s.index,". ",s.name]})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,n.jsx)(si.Z,{color:s.called?"blue":"default",children:s.called?"called":"not called"}),t?(0,n.jsx)(sN.Z,{style:{fontSize:12,color:"#8c8c8c"}}):(0,n.jsx)(sZ.Z,{style:{fontSize:12,color:"#8c8c8c"}})]})]}),t&&(0,n.jsx)("div",{style:{padding:"16px",borderTop:"1px solid #f0f0f0",background:"#fff"},children:(0,n.jsx)(sP,{tool:s})})]})}let{Text:sK}=e6.default;function sq(e){let{log:s}=e,t=function(e){let s=function(e){let s=sM(e.proxy_server_request||e.messages);return!s||Array.isArray(s)?[]:"object"==typeof s&&s.tools&&Array.isArray(s.tools)?s.tools:[]}(e);if(0===s.length)return[];let t=function(e){let s=sM(e.response);if(!s||"object"!=typeof s)return[];let t=s.choices;if(Array.isArray(t)&&t.length>0){let e=t[0].message;if(e&&Array.isArray(e.tool_calls))return e.tool_calls}return[]}(e),a=new Set(t.map(e=>{var s;return null===(s=e.function)||void 0===s?void 0:s.name}).filter(Boolean)),l=new Map;return t.forEach(e=>{var s,t;let a=null===(s=e.function)||void 0===s?void 0:s.name;a&&l.set(a,{id:e.id,name:a,arguments:function(e){try{return JSON.parse(e)}catch(e){return{}}}((null===(t=e.function)||void 0===t?void 0:t.arguments)||"{}")})}),s.map((e,s)=>{let t=e.function||{name:"Tool ".concat(s+1)},n=t.name||"Tool ".concat(s+1);return{index:s+1,name:n,description:t.description||"",parameters:t.parameters||{},called:a.has(n),callData:l.get(n)}})}(s);if(0===t.length)return null;let a=t.length,l=t.filter(e=>e.called).length,r=t.slice(0,2).map(e=>e.name).join(", "),i=t.length>2;return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(u.default,{expandIconPosition:"start",items:[{key:"1",label:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Tools"}),(0,n.jsxs)(sK,{type:"secondary",style:{fontSize:14},children:[a," provided, ",l," called"]}),(0,n.jsxs)(sK,{type:"secondary",style:{fontSize:14},children:["• ",r,i&&"..."]})]}),children:(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:t.map(e=>(0,n.jsx)(sH,{tool:e},e.name))})}]})})}let sF=(e,s)=>{var t,a;let l=[];(null==e?void 0:e.messages)&&Array.isArray(e.messages)&&e.messages.forEach(e=>{l.push({role:e.role||"user",content:sY(e.content),toolCallId:e.tool_call_id})});let n=null,r=null==s?void 0:null===(a=s.choices)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:t.message;return r&&(n={role:r.role||"assistant",content:r.content||"",toolCalls:sU(r.tool_calls)}),{requestMessages:l,responseMessage:n}},sY=e=>"string"==typeof e?e:Array.isArray(e)?e.map(e=>"string"==typeof e?e:"text"===e.type?e.text:"image_url"===e.type?"[Image]":JSON.stringify(e)).join("\n"):JSON.stringify(e),sU=e=>{if(e&&Array.isArray(e))return e.map(e=>{var s,t;return{id:e.id||"",name:(null===(s=e.function)||void 0===s?void 0:s.name)||"unknown",arguments:sV(null===(t=e.function)||void 0===t?void 0:t.arguments)}})},sV=e=>{if(!e)return{};if("string"==typeof e)try{return JSON.parse(e)}catch(s){return{raw:e}}return e};var sW=t(42264),sJ=t(61340),sG=t(23639);let{Text:sQ}=e6.default;function s$(e){let{type:s,tokens:t,cost:a,onCopy:l,isCollapsed:r,onToggleCollapse:i}=e;return(0,n.jsxs)("div",{onClick:i,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 16px",borderBottom:r?"none":"1px solid #f0f0f0",background:"#fafafa",cursor:i?"pointer":"default",transition:"background 0.15s ease"},onMouseEnter:e=>{i&&(e.currentTarget.style.background="#f5f5f5")},onMouseLeave:e=>{e.currentTarget.style.background="#fafafa"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[i&&(0,n.jsx)("div",{style:{display:"flex",alignItems:"center"},children:r?(0,n.jsx)(sN.Z,{style:{fontSize:10,color:"#8c8c8c"}}):(0,n.jsx)(sb.Z,{style:{fontSize:10,color:"#8c8c8c"}})}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:["input"===s?(0,n.jsx)(sJ.Z,{style:{color:"#8c8c8c",fontSize:14}}):(0,n.jsx)("span",{style:{fontSize:14,filter:"grayscale(1)",opacity:.6},children:"✨"}),(0,n.jsx)(sQ,{style:{fontWeight:500,fontSize:14},children:"input"===s?"Input":"Output"})]}),void 0!==t&&(0,n.jsxs)(sQ,{type:"secondary",style:{fontSize:12},children:["Tokens: ",t.toLocaleString()]}),void 0!==a&&(0,n.jsxs)(sQ,{type:"secondary",style:{fontSize:12},children:["Cost: $",a.toFixed(6)]})]}),(0,n.jsx)(m.Z,{title:"Copy",children:(0,n.jsx)(P.ZP,{type:"text",size:"small",icon:(0,n.jsx)(sG.Z,{}),onClick:e=>{e.stopPropagation(),l()}})})]})}let{Text:sX}=e6.default;function s0(e){let{label:s,content:t,defaultExpanded:a=!1}=e,[l,r]=(0,c.useState)(a),[i,o]=(0,c.useState)(!1),d=(null==t?void 0:t.length)||0;return t&&0!==d?(0,n.jsxs)("div",{style:{marginBottom:8},children:[(0,n.jsxs)("div",{onClick:()=>r(!l),onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",padding:"4px 0",borderRadius:4,background:i?"#f5f5f5":"transparent",transition:"background 0.15s ease",marginBottom:l?4:0},children:[l?(0,n.jsx)(sN.Z,{style:{fontSize:10,color:"#8c8c8c"}}):(0,n.jsx)(sZ.Z,{style:{fontSize:10,color:"#8c8c8c"}}),(0,n.jsx)(sX,{type:"secondary",style:{fontSize:10,letterSpacing:"0.5px",textTransform:"uppercase"},children:s}),(0,n.jsxs)(sX,{type:"secondary",style:{fontSize:10},children:["(",d.toLocaleString()," chars)"]})]}),(0,n.jsx)("div",{style:{maxHeight:l?"2000px":"0px",overflow:"hidden",transition:"max-height 0.2s ease-out, opacity 0.2s ease-out",opacity:l?1:0},children:(0,n.jsx)("div",{style:{paddingLeft:16,fontSize:13,lineHeight:1.7,color:"#262626",borderLeft:"1px solid #f0f0f0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:t})})]}):null}let{Text:s1}=e6.default;function s2(e){let{tool:s,compact:t=!1}=e;return(0,n.jsxs)("div",{style:{background:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:6,padding:t?"6px 10px":"10px 14px",marginTop:8,fontFamily:"monospace",fontSize:12,position:"relative"},children:[(0,n.jsx)("div",{style:{position:"absolute",top:-8,left:12,background:"#fff",padding:"0 6px",fontSize:10,color:"#8c8c8c",border:"1px solid #e9ecef",borderRadius:3},children:"function"}),(0,n.jsx)(s1,{strong:!0,style:{fontSize:13,display:"block",marginBottom:6},children:s.name}),Object.keys(s.arguments).length>0&&(0,n.jsx)("div",{children:Object.entries(s.arguments).map(e=>{let[s,t]=e;return(0,n.jsxs)("div",{style:{marginBottom:2},children:[(0,n.jsxs)(s1,{type:"secondary",style:{fontSize:12},children:[s,":"," "]}),(0,n.jsx)(s1,{style:{fontSize:12},children:JSON.stringify(t)})]},s)})})]})}let{Text:s4}=e6.default;function s5(e){let{label:s,content:t,toolCalls:a,isCompact:l=!1}=e,r=t&&"null"!==t&&t.length>0?t:null,i=a&&a.length>0;return r||i?(0,n.jsxs)("div",{style:{marginBottom:l?8:0},children:[(0,n.jsx)(s4,{type:"secondary",style:{fontSize:10,letterSpacing:"0.5px",textTransform:"uppercase",display:"block",marginBottom:3},children:s}),r&&(0,n.jsx)("div",{style:{fontSize:13,lineHeight:1.7,color:"#262626",whiteSpace:"pre-wrap",wordBreak:"break-word",marginBottom:i?6:0},children:r}),i&&(0,n.jsx)("div",{children:a.map((e,s)=>(0,n.jsx)(s2,{tool:e,compact:l},e.id||s))})]}):null}let{Text:s3}=e6.default;function s6(e){let{messages:s}=e,[t,a]=(0,c.useState)(!1),[l,r]=(0,c.useState)(!1);return 0===s.length?null:(0,n.jsxs)("div",{style:{marginBottom:8},children:[(0,n.jsxs)("div",{onClick:()=>a(!t),onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",padding:"4px 0",borderRadius:4,background:l?"#f5f5f5":"transparent",transition:"background 0.15s ease",marginBottom:t?4:0},children:[t?(0,n.jsx)(sN.Z,{style:{fontSize:10,color:"#8c8c8c"}}):(0,n.jsx)(sZ.Z,{style:{fontSize:10,color:"#8c8c8c"}}),(0,n.jsxs)(s3,{type:"secondary",style:{fontSize:10,letterSpacing:"0.5px",textTransform:"uppercase"},children:["HISTORY (",s.length," message",1!==s.length?"s":"",")"]})]}),(0,n.jsx)("div",{style:{maxHeight:t?"2000px":"0px",overflow:"hidden",transition:"max-height 0.2s ease-out, opacity 0.2s ease-out",opacity:t?1:0},children:(0,n.jsx)("div",{style:{paddingLeft:16,borderLeft:"1px solid #f0f0f0"},children:s.map((e,s)=>(0,n.jsx)(s5,{label:e.role.toUpperCase(),content:e.content,toolCalls:e.toolCalls,isCompact:!0},s))})})]})}function s8(e){let{messages:s,promptTokens:t,inputCost:a}=e,[l,r]=(0,c.useState)(!1);if(0===s.length)return null;let i=s.find(e=>"system"===e.role),o=s.filter(e=>"system"!==e.role),d=o.length>0?o[o.length-1]:null,m=o.slice(0,-1);return(0,n.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:6,marginBottom:8,overflow:"hidden"},children:[(0,n.jsx)(s$,{type:"input",tokens:t,cost:a,onCopy:()=>{let e=JSON.stringify(s,null,2);navigator.clipboard.writeText(e),sW.ZP.success("Input copied")},isCollapsed:l,onToggleCollapse:()=>r(!l)}),(0,n.jsx)("div",{style:{maxHeight:l?"0px":"10000px",overflow:"hidden",transition:"max-height 0.3s ease-out, opacity 0.3s ease-out",opacity:l?0:1},children:(0,n.jsxs)("div",{style:{padding:"12px 16px"},children:[i&&(0,n.jsx)(s0,{label:"SYSTEM",content:i.content,defaultExpanded:!!(i.content&&i.content.length<200)}),m.length>0&&(0,n.jsx)(s6,{messages:m}),d&&(0,n.jsx)(s5,{label:d.role.toUpperCase(),content:d.content,toolCalls:d.toolCalls})]})})]})}let{Text:s7}=e6.default;function s9(e){let{message:s,completionTokens:t,outputCost:a}=e,[l,r]=(0,c.useState)(!1),i=()=>{if(!s)return;let e=JSON.stringify(s,null,2);navigator.clipboard.writeText(e),sW.ZP.success("Output copied")};return s?(0,n.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:6,overflow:"hidden"},children:[(0,n.jsx)(s$,{type:"output",tokens:t,cost:a,onCopy:i,isCollapsed:l,onToggleCollapse:()=>r(!l)}),(0,n.jsx)("div",{style:{maxHeight:l?"0px":"10000px",overflow:"hidden",transition:"max-height 0.3s ease-out, opacity 0.3s ease-out",opacity:l?0:1},children:(0,n.jsx)("div",{style:{padding:"12px 16px"},children:(0,n.jsx)(s5,{label:"ASSISTANT",content:s.content,toolCalls:s.toolCalls})})})]}):(0,n.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:6,overflow:"hidden"},children:[(0,n.jsx)(s$,{type:"output",tokens:t,cost:a,onCopy:i,isCollapsed:l,onToggleCollapse:()=>r(!l)}),(0,n.jsx)("div",{style:{maxHeight:l?"0px":"10000px",overflow:"hidden",transition:"max-height 0.3s ease-out, opacity 0.3s ease-out",opacity:l?0:1},children:(0,n.jsx)("div",{style:{padding:"12px 16px"},children:(0,n.jsx)(s7,{type:"secondary",style:{fontSize:13,fontStyle:"italic"},children:"No response data available"})})})]})}function te(e){let{request:s,response:t,metrics:a}=e,{requestMessages:l,responseMessage:r}=sF(s,t);return(0,n.jsxs)("div",{children:[(0,n.jsx)(s8,{messages:l,promptTokens:null==a?void 0:a.prompt_tokens,inputCost:null==a?void 0:a.input_cost}),(0,n.jsx)(s9,{message:r,completionTokens:null==a?void 0:a.completion_tokens,outputCost:null==a?void 0:a.output_cost})]})}let{Text:ts}=e6.default;function tt(e){var s,t,a,l;let{open:r,onClose:i,logEntry:o,onOpenSettings:d,allLogs:m=[],onSelectLog:u}=e,[x,h]=(0,c.useState)(sm),{selectNextLog:p,selectPreviousLog:g}=function(e){let{isOpen:s,currentLog:t,allLogs:a,onClose:l,onSelectLog:n}=e;(0,c.useEffect)(()=>{let e=e=>{var t;if(!((t=e.target)instanceof HTMLInputElement||t instanceof HTMLTextAreaElement)&&s)switch(e.key){case"Escape":l();break;case"j":case"J":i();break;case"k":case"K":r()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[s,t,a]);let r=()=>{if(!t||!a.length||!n)return;let e=a.findIndex(e=>e.request_id===t.request_id);e<a.length-1&&n(a[e+1])},i=()=>{if(!t||!a.length||!n)return;let e=a.findIndex(e=>e.request_id===t.request_id);e>0&&n(a[e-1])};return{selectNextLog:r,selectPreviousLog:i}}({isOpen:r,currentLog:o,allLogs:m,onClose:i,onSelectLog:u});if(!o)return null;let f=o.metadata||{},j="failure"===f.status,v=j?f.error_information:null,y=!!(s=o.messages)&&(Array.isArray(s)?s.length>0:"object"==typeof s&&Object.keys(s).length>0),b=!!(t=o.response)&&Object.keys(sT(t)).length>0,N=!y&&!b,w=null==f?void 0:f.guardrail_information,_=Array.isArray(w)?w:w?[w]:[],k=_.length>0,S=_.reduce((e,s)=>{let t=null==s?void 0:s.masked_entity_count;return t?e+Object.values(t).reduce((e,s)=>"number"==typeof s?e+s:e,0):e},0),C=0===_.length?"-":1===_.length?null!==(l=null===(a=_[0])||void 0===a?void 0:a.guardrail_name)&&void 0!==l?l:"-":"".concat(_.length," guardrails"),L=f.vector_store_request_metadata&&Array.isArray(f.vector_store_request_metadata)&&f.vector_store_request_metadata.length>0,T="failure"===f.status?"Failure":"Success",M="failure"===f.status?"error":"success",D=(null==f?void 0:f.user_api_key_team_alias)||"default";return(0,n.jsxs)(sa.Z,{title:null,placement:"right",onClose:i,open:r,width:"60%",closable:!1,mask:!0,maskClosable:!0,styles:{body:{padding:0,overflow:"hidden"},header:{display:"none"}},children:[(0,n.jsx)(sk,{log:o,onClose:i,onPrevious:g,onNext:p,statusLabel:T,statusColor:M,environment:D}),(0,n.jsxs)("div",{style:{height:"calc(100vh - 100px)",overflowY:"auto",padding:"".concat(sc," ").concat(sc," 0")},children:[j&&v&&(0,n.jsx)(sl.Z,{type:"error",showIcon:!0,message:"Request Failed",description:(0,n.jsx)(ta,{errorInfo:v}),className:"mb-6"}),o.request_tags&&Object.keys(o.request_tags).length>0&&(0,n.jsx)(tl,{tags:o.request_tags}),(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(sn.Z,{title:"Request Details",size:"small",bordered:!1,style:{marginBottom:0},children:(0,n.jsxs)(sr.Z,{column:2,size:"small",children:[(0,n.jsx)(sr.Z.Item,{label:"Model",children:o.model}),(0,n.jsx)(sr.Z.Item,{label:"Provider",children:o.custom_llm_provider||"-"}),(0,n.jsx)(sr.Z.Item,{label:"Call Type",children:o.call_type}),(0,n.jsx)(sr.Z.Item,{label:"Model ID",children:(0,n.jsx)(sg,{value:o.model_id})}),(0,n.jsx)(sr.Z.Item,{label:"API Base",children:(0,n.jsx)(sg,{value:o.api_base,maxWidth:200})}),o.requester_ip_address&&(0,n.jsx)(sr.Z.Item,{label:"IP Address",children:o.requester_ip_address}),k&&(0,n.jsx)(sr.Z.Item,{label:"Guardrail",children:(0,n.jsx)(tn,{label:C,maskedCount:S})})]})})}),(0,n.jsx)(tr,{logEntry:o,metadata:f}),(0,n.jsx)(eC,{costBreakdown:null==f?void 0:f.cost_breakdown,totalSpend:o.spend||0}),(0,n.jsx)(sq,{log:o}),N&&(0,n.jsx)("div",{className:"mb-6",children:(0,n.jsx)(e_,{show:N,onOpenSettings:d})}),(0,n.jsx)(ti,{hasResponse:b,getRawRequest:()=>sT(o.proxy_server_request||o.messages),getFormattedResponse:()=>j&&v?{error:{message:v.error_message||"An error occurred",type:v.error_class||"error",code:v.error_code||"unknown",param:null}}:sT(o.response),logEntry:o}),k&&(0,n.jsx)(E,{data:w}),L&&(0,n.jsx)(st,{data:f.vector_store_request_metadata}),o.metadata&&Object.keys(o.metadata).length>0&&(0,n.jsx)(to,{metadata:o.metadata}),(0,n.jsx)("div",{style:{height:sc}})]})]})}function ta(e){let{errorInfo:s}=e;return(0,n.jsxs)("div",{children:[s.error_code&&(0,n.jsxs)("div",{children:[(0,n.jsx)(ts,{strong:!0,children:"Error Code:"})," ",s.error_code]}),s.error_message&&(0,n.jsxs)("div",{children:[(0,n.jsx)(ts,{strong:!0,children:"Message:"})," ",s.error_message]})]})}function tl(e){let{tags:s}=e;return(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden p-4 mb-6",children:[(0,n.jsx)(ts,{strong:!0,style:{display:"block",marginBottom:8,fontSize:16},children:"Tags"}),(0,n.jsx)(e8.Z,{size:8,wrap:!0,children:Object.entries(s).map(e=>{let[s,t]=e;return(0,n.jsxs)(si.Z,{children:[s,": ",String(t)]},s)})})]})}function tn(e){let{label:s,maskedCount:t}=e;return(0,n.jsxs)(e8.Z,{size:8,children:[(0,n.jsx)("span",{children:s}),t>0&&(0,n.jsxs)(si.Z,{color:"blue",children:[t," masked"]})]})}function tr(e){var s,t,a,l;let{logEntry:r,metadata:i}=e,o=r.cache_hit||(null==i?void 0:null===(s=i.additional_usage_values)||void 0===s?void 0:s.cache_read_input_tokens)&&i.additional_usage_values.cache_read_input_tokens>0;return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(sn.Z,{title:"Metrics",size:"small",bordered:!1,style:{marginBottom:0},children:(0,n.jsxs)(sr.Z,{column:2,size:"small",children:[(0,n.jsx)(sr.Z.Item,{label:"Tokens",children:(0,n.jsx)(sj,{prompt:r.prompt_tokens,completion:r.completion_tokens,total:r.total_tokens})}),(0,n.jsxs)(sr.Z.Item,{label:"Cost",children:["$",(0,T.pw)(r.spend||0,8)]}),(0,n.jsxs)(sr.Z.Item,{label:"Duration",children:[null===(t=r.duration)||void 0===t?void 0:t.toFixed(3)," s"]}),o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(sr.Z.Item,{label:"Cache Hit",children:(0,n.jsx)(si.Z,{color:r.cache_hit?"green":"default",children:r.cache_hit||"None"})}),(null==i?void 0:null===(a=i.additional_usage_values)||void 0===a?void 0:a.cache_read_input_tokens)>0&&(0,n.jsx)(sr.Z.Item,{label:"Cache Read Tokens",children:(0,T.pw)(i.additional_usage_values.cache_read_input_tokens)}),(null==i?void 0:null===(l=i.additional_usage_values)||void 0===l?void 0:l.cache_creation_input_tokens)>0&&(0,n.jsx)(sr.Z.Item,{label:"Cache Creation Tokens",children:(0,T.pw)(i.additional_usage_values.cache_creation_input_tokens)})]}),(null==i?void 0:i.litellm_overhead_time_ms)!==void 0&&null!==i.litellm_overhead_time_ms&&(0,n.jsxs)(sr.Z.Item,{label:"LiteLLM Overhead",children:[i.litellm_overhead_time_ms.toFixed(2)," ms"]}),(0,n.jsx)(sr.Z.Item,{label:"Start Time",children:d()(r.startTime).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}),(0,n.jsx)(sr.Z.Item,{label:"End Time",children:d()(r.endTime).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")})]})})})}function ti(e){let{hasResponse:s,getRawRequest:t,getFormattedResponse:a,logEntry:l}=e,[r,i]=(0,c.useState)(sm),[o,d]=(0,c.useState)("pretty"),m=l.spend||0,x=l.prompt_tokens||0,h=l.completion_tokens||0,p=x+h;return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(u.default,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},onClick:e=>{e.target.closest(".ant-radio-group")&&e.stopPropagation()},children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",style:{margin:0},children:"Request & Response"}),(0,n.jsxs)(so.ZP.Group,{size:"small",value:o,onChange:e=>d(e.target.value),children:[(0,n.jsx)(so.ZP.Button,{value:"pretty",children:"Pretty"}),(0,n.jsx)(so.ZP.Button,{value:"json",children:"JSON"})]})]}),children:(0,n.jsx)("div",{children:"pretty"===o?(0,n.jsx)(te,{request:t(),response:a(),metrics:{prompt_tokens:x,completion_tokens:h,input_cost:p>0?m*x/p:0,output_cost:p>0?m*h/p:0}}):(0,n.jsx)(sd.default,{activeKey:r,onChange:e=>i(e),tabBarExtraContent:(0,n.jsx)(ts,{copyable:{text:JSON.stringify(r===sm?t():a(),null,2),tooltips:["Copy JSON","Copied!"]},disabled:r===su&&!s}),items:[{key:sm,label:"Request",children:(0,n.jsx)("div",{style:{paddingTop:16,paddingBottom:16},children:(0,n.jsx)(sy,{data:t(),mode:"formatted"})})},{key:su,label:"Response",children:(0,n.jsx)("div",{style:{paddingTop:16,paddingBottom:16},children:s?(0,n.jsx)(sy,{data:a(),mode:"formatted"}):(0,n.jsx)("div",{style:{textAlign:"center",padding:20,color:"#999",fontStyle:"italic"},children:"Response data not available"})})}]})})}]})})}function to(e){let{metadata:s}=e;return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(u.default,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Metadata"}),children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:8},children:(0,n.jsx)(ts,{copyable:{text:JSON.stringify(s,null,2),tooltips:["Copy Metadata","Copied!"]}})}),(0,n.jsx)("pre",{style:{maxHeight:300,overflowY:"auto",fontSize:12,fontFamily:sx,whiteSpace:"pre-wrap",wordBreak:"break-all",margin:0},children:JSON.stringify(s,null,2)})]})}]})})}function td(e){var s,t;let{accessToken:a,token:l,userRole:o,userID:m,allTeams:u,premiumUser:x}=e,[h,p]=(0,c.useState)(""),[g,f]=(0,c.useState)(!1),[j,v]=(0,c.useState)(!1),[y,b]=(0,c.useState)(1),[N]=(0,c.useState)(50),w=(0,c.useRef)(null),_=(0,c.useRef)(null),k=(0,c.useRef)(null),[S,C]=(0,c.useState)(d()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),[L,E]=(0,c.useState)(d()().format("YYYY-MM-DDTHH:mm")),[T,M]=(0,c.useState)(!1),[H,K]=(0,c.useState)(!1),[q,F]=(0,c.useState)(""),[Y,U]=(0,c.useState)(""),[V,W]=(0,c.useState)(""),[G,Q]=(0,c.useState)(""),[$,X]=(0,c.useState)(""),[ee,es]=(0,c.useState)(null),[et,ea]=(0,c.useState)(null),[el,en]=(0,c.useState)(""),[er,ex]=(0,c.useState)(""),[eh,ep]=(0,c.useState)(o&&B.lo.includes(o)),[eg,ef]=(0,c.useState)("request logs"),[ev,ey]=(0,c.useState)(null),[eb,eN]=(0,c.useState)(!1),[e_,ek]=(0,c.useState)(null),[eS,eC]=(0,c.useState)(!1),eL=(0,r.NL)(),[eE,eA]=(0,c.useState)(()=>{let e=sessionStorage.getItem("isLiveTail");return null===e||JSON.parse(e)});(0,c.useEffect)(()=>{sessionStorage.setItem("isLiveTail",JSON.stringify(eE))},[eE]);let[eR,eI]=(0,c.useState)({value:24,unit:"hours"});(0,c.useEffect)(()=>{(async()=>{et&&a&&es({...(await (0,ec.keyInfoV1Call)(a,et)).info,token:et,api_key:et})})()},[et,a]),(0,c.useEffect)(()=>{function e(e){w.current&&!w.current.contains(e.target)&&v(!1),_.current&&!_.current.contains(e.target)&&f(!1),k.current&&!k.current.contains(e.target)&&K(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,c.useEffect)(()=>{o&&B.lo.includes(o)&&ep(!0)},[o]);let eO=(0,i.a)({queryKey:["logs","table",y,N,S,L,V,G,eh?m:null,el,$],queryFn:async()=>{if(!a||!l||!o||!m)return{data:[],total:0,page:1,page_size:N,total_pages:0};let e=d()(S).utc().format("YYYY-MM-DD HH:mm:ss"),s=T?d()(L).utc().format("YYYY-MM-DD HH:mm:ss"):d()().utc().format("YYYY-MM-DD HH:mm:ss"),t=await (0,ec.uiSpendLogsCall)(a,G||void 0,V||void 0,void 0,e,s,y,N,eh?m:void 0,er,el,$);return await ez(t.data,e,a,eL),t.data=t.data.map(s=>{let t=eL.getQueryData(["logDetails",s.request_id,e]);return(null==t?void 0:t.messages)&&(null==t?void 0:t.response)&&(s.messages=t.messages,s.response=t.response),s}),t},enabled:!!a&&!!l&&!!o&&!!m&&"request logs"===eg,refetchInterval:!!eE&&1===y&&15e3,refetchIntervalInBackground:!0}),eP=eO.data||{data:[],total:0,page:1,page_size:N||10,total_pages:1},{filters:eB,filteredLogs:eH,allTeams:eK,allKeyAliases:eq,handleFilterChange:eY,handleFilterReset:eU}=function(e){let{logs:s,accessToken:t,startTime:a,endTime:l,pageSize:n=eM.d,isCustomDate:r,setCurrentPage:o,userID:m,userRole:u}=e,x=(0,c.useMemo)(()=>({[eD.TEAM_ID]:"",[eD.KEY_HASH]:"",[eD.REQUEST_ID]:"",[eD.MODEL]:"",[eD.USER_ID]:"",[eD.END_USER]:"",[eD.STATUS]:"",[eD.KEY_ALIAS]:"",[eD.ERROR_CODE]:"",[eD.ERROR_MESSAGE]:""}),[]),[h,p]=(0,c.useState)(x),[g,f]=(0,c.useState)({data:[],total:0,page:1,page_size:50,total_pages:0}),j=(0,c.useRef)(0),v=(0,c.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!t)return;console.log("Filters being sent to API:",e);let i=Date.now();j.current=i;let o=d()(a).utc().format("YYYY-MM-DD HH:mm:ss"),c=r?d()(l).utc().format("YYYY-MM-DD HH:mm:ss"):d()().utc().format("YYYY-MM-DD HH:mm:ss");try{let a=await (0,ec.uiSpendLogsCall)(t,e[eD.KEY_HASH]||void 0,e[eD.TEAM_ID]||void 0,e[eD.REQUEST_ID]||void 0,o,c,s,n,e[eD.USER_ID]||void 0,e[eD.END_USER]||void 0,e[eD.STATUS]||void 0,e[eD.MODEL]||void 0,e[eD.KEY_ALIAS]||void 0,e[eD.ERROR_CODE]||void 0,e[eD.ERROR_MESSAGE]||void 0);i===j.current&&a.data&&f(a)}catch(e){console.error("Error searching users:",e)}},[t,a,l,r,n]),y=(0,c.useMemo)(()=>eT()((e,s)=>v(e,s),300),[v]);(0,c.useEffect)(()=>()=>y.cancel(),[y]);let b=(0,i.a)({queryKey:["allKeys"],queryFn:async()=>{if(!t)throw Error("Access token required");return await (0,eo.LO)(t)},enabled:!!t}).data||[],N=(0,c.useMemo)(()=>!!(h[eD.KEY_ALIAS]||h[eD.KEY_HASH]||h[eD.REQUEST_ID]||h[eD.USER_ID]||h[eD.END_USER]||h[eD.ERROR_CODE]||h[eD.ERROR_MESSAGE]),[h]),w=(0,c.useMemo)(()=>{if(!s||!s.data)return{data:[],total:0,page:1,page_size:50,total_pages:0};if(N)return s;let e=[...s.data];return h[eD.TEAM_ID]&&(e=e.filter(e=>e.team_id===h[eD.TEAM_ID])),h[eD.STATUS]&&(e=e.filter(e=>"success"===h[eD.STATUS]?!e.status||"success"===e.status:e.status===h[eD.STATUS])),h[eD.MODEL]&&(e=e.filter(e=>e.model===h[eD.MODEL])),h[eD.KEY_HASH]&&(e=e.filter(e=>e.api_key===h[eD.KEY_HASH])),h[eD.END_USER]&&(e=e.filter(e=>e.end_user===h[eD.END_USER])),h[eD.ERROR_CODE]&&(e=e.filter(e=>{let s=(e.metadata||{}).error_information;return s&&s.error_code===h[eD.ERROR_CODE]})),{data:e,total:s.total,page:s.page,page_size:s.page_size,total_pages:s.total_pages}},[s,h,N]),_=(0,c.useMemo)(()=>N?g&&g.data&&g.data.length>0?g:s||{data:[],total:0,page:1,page_size:50,total_pages:0}:w,[N,g,w,s]),{data:k}=(0,i.a)({queryKey:["allTeamsForLogFilters",t],queryFn:async()=>t&&await (0,eo.IE)(t)||[],enabled:!!t});return{filters:h,filteredLogs:_,allKeyAliases:b,allTeams:k,handleFilterChange:e=>{p(s=>{let t={...s,...e};for(let e of Object.keys(x))e in t||(t[e]=x[e]);return JSON.stringify(t)!==JSON.stringify(s)&&(o(1),y(t,1)),t})},handleFilterReset:()=>{p(x),f({data:[],total:0,page:1,page_size:50,total_pages:0}),y(x,1)}}}({logs:eP,accessToken:a,startTime:S,endTime:L,pageSize:N,isCustomDate:T,setCurrentPage:b,userID:m,userRole:o}),eV=(0,c.useCallback)(async e=>{if(a)try{let s=(await (0,ec.keyListCall)(a,null,null,e,null,null,y,N)).keys.find(s=>s.key_alias===e);s&&Q(s.token)}catch(e){console.error("Error fetching key hash for alias:",e)}},[a,y,N]);(0,c.useEffect)(()=>{a&&(eB["Team ID"]?W(eB["Team ID"]):W(""),en(eB.Status||""),X(eB.Model||""),ex(eB["End User"]||""),eB["Key Hash"]?Q(eB["Key Hash"]):eB["Key Alias"]?eV(eB["Key Alias"]):Q(""))},[eB,a,eV]);let eW=(0,i.a)({queryKey:["sessionLogs",e_],queryFn:async()=>{if(!a||!e_)return{data:[],total:0,page:1,page_size:50,total_pages:1};let e=await (0,ec.sessionSpendLogsCall)(a,e_);return{data:e.data||e||[],total:(e.data||e||[]).length,page:1,page_size:1e3,total_pages:1}},enabled:!!a&&!!e_});if(!a||!l||!o||!m)return null;let eJ=eH.data.filter(e=>!h||e.request_id.includes(h)||e.model.includes(h)||e.user&&e.user.includes(h)).map(e=>({...e,duration:(Date.parse(e.endTime)-Date.parse(e.startTime))/1e3,onKeyHashClick:e=>ea(e),onSessionClick:e=>{e&&ek(e)}}))||[],eG=(null===(t=eW.data)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.map(e=>({...e,onKeyHashClick:e=>ea(e),onSessionClick:e=>{}})))||[],eQ=e=>{ey(e),eN(!0)},e$=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=new Set;return e.forEach(e=>{let a=e.metadata||{};if("failure"===a.status&&a.error_information){let e=a.error_information.error_code;e&&(!s||e.toLowerCase().includes(s.toLowerCase()))&&t.add(e)}}),Array.from(t).map(e=>({label:e,value:e}))},eX=[{name:"Team ID",label:"Team ID",isSearchable:!0,searchFn:async e=>u&&0!==u.length?u.filter(s=>s.team_id.toLowerCase().includes(e.toLowerCase())||s.team_alias&&s.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:"".concat(e.team_alias||e.team_id," (").concat(e.team_id,")"),value:e.team_id})):[]},{name:"Status",label:"Status",isSearchable:!1,options:[{label:"Success",value:"success"},{label:"Failure",value:"failure"}]},{name:"Model",label:"Model",isSearchable:!1},{name:"Key Alias",label:"Key Alias",isSearchable:!0,searchFn:async e=>a?(await (0,eo.LO)(a)).filter(s=>s.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e})):[]},{name:"End User",label:"End User",isSearchable:!0,searchFn:async e=>{if(!a)return[];let s=await (0,ec.allEndUsersCall)(a);return((null==s?void 0:s.map(e=>e.user_id))||[]).filter(s=>s.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e}))}},{name:"Error Code",label:"Error Code",isSearchable:!0,searchFn:async e=>e$(eP.data,e)},{name:"Key Hash",label:"Key Hash",isSearchable:!1},{name:"Error Message",label:"Error Message",isSearchable:!1}];if(e_&&eW.data)return(0,n.jsx)("div",{className:"w-full p-6",children:(0,n.jsx)(eF,{sessionId:e_,logs:eW.data.data,onBack:()=>ek(null)})});let e0=[{label:"Last 15 Minutes",value:15,unit:"minutes"},{label:"Last Hour",value:1,unit:"hours"},{label:"Last 4 Hours",value:4,unit:"hours"},{label:"Last 24 Hours",value:24,unit:"hours"},{label:"Last 7 Days",value:7,unit:"days"}],e2=e0.find(e=>e.value===eR.value&&e.unit===eR.unit),e4=T?eZ(T,S,L):null==e2?void 0:e2.label;return(0,n.jsxs)("div",{className:"w-full max-w-screen p-6 overflow-x-hidden box-border",children:[(0,n.jsxs)(A.Z,{defaultIndex:0,onIndexChange:e=>ef(0===e?"request logs":"audit logs"),children:[(0,n.jsxs)(R.Z,{children:[(0,n.jsx)(z.Z,{children:"Request Logs"}),(0,n.jsx)(z.Z,{children:"Audit Logs"}),(0,n.jsx)(z.Z,{children:"Deleted Keys"}),(0,n.jsx)(z.Z,{children:"Deleted Teams"})]}),(0,n.jsxs)(O.Z,{children:[(0,n.jsxs)(I.Z,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h1",{className:"text-xl font-semibold",children:e_?(0,n.jsxs)(n.Fragment,{children:["Session: ",(0,n.jsx)("span",{className:"font-mono",children:e_}),(0,n.jsx)("button",{className:"ml-4 px-3 py-1 text-sm border rounded hover:bg-gray-50",onClick:()=>ek(null),children:"← Back to All Logs"})]}):"Request Logs"}),!e_&&(0,n.jsx)(e1.Z,{dot:!0,children:(0,n.jsx)(P.ZP,{icon:(0,n.jsx)(D.Z,{}),onClick:()=>eC(!0),title:"Spend Logs Settings"})})]}),ee&&et&&ee.api_key===et?(0,n.jsx)(em.Z,{keyId:et,keyData:ee,teams:u,onClose:()=>ea(null),backButtonText:"Back to Logs"}):e_?(0,n.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,n.jsx)(eu.w,{columns:ej,data:eG,onRowClick:eQ})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ed.Z,{options:eX,onApplyFilters:eY,onResetFilters:eU}),(0,n.jsx)(ss,{isVisible:eS,onCancel:()=>eC(!1),onSuccess:()=>eC(!1)}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full box-border",children:[(0,n.jsx)("div",{className:"border-b px-6 py-4 w-full max-w-full box-border",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0 w-full max-w-full box-border",children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-3 w-full max-w-full box-border",children:[(0,n.jsxs)("div",{className:"relative w-64 min-w-0 flex-shrink-0",children:[(0,n.jsx)("input",{type:"text",placeholder:"Search by Request ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:h,onChange:e=>p(e.target.value)}),(0,n.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-shrink",children:[(0,n.jsxs)("div",{className:"relative z-50",ref:k,children:[(0,n.jsxs)("button",{onClick:()=>K(!H),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e4]}),H&&(0,n.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border p-2 z-50",children:(0,n.jsxs)("div",{className:"space-y-1",children:[e0.map(e=>(0,n.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(e4===e.label?"bg-blue-50 text-blue-600":""),onClick:()=>{E(d()().format("YYYY-MM-DDTHH:mm")),C(d()().subtract(e.value,e.unit).format("YYYY-MM-DDTHH:mm")),eI({value:e.value,unit:e.unit}),M(!1),K(!1)},children:e.label},e.label)),(0,n.jsx)("div",{className:"border-t my-2"}),(0,n.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(T?"bg-blue-50 text-blue-600":""),onClick:()=>M(!T),children:"Custom Range"})]})})]}),(0,n.jsx)(()=>(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Live Tail"}),(0,n.jsx)(Z.Z,{color:"green",checked:eE,defaultChecked:!0,onChange:eA})]}),{}),(0,n.jsxs)("button",{onClick:()=>{eO.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,n.jsx)("svg",{className:"w-4 h-4 ".concat(eO.isFetching?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,n.jsx)("span",{children:"Refresh"})]})]}),T&&(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{children:(0,n.jsx)("input",{type:"datetime-local",value:S,onChange:e=>{C(e.target.value),b(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,n.jsx)("span",{className:"text-gray-500",children:"to"}),(0,n.jsx)("div",{children:(0,n.jsx)("input",{type:"datetime-local",value:L,onChange:e=>{E(e.target.value),b(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-700 whitespace-nowrap",children:["Showing ",eO.isLoading?"...":eH?(y-1)*N+1:0," -"," ",eO.isLoading?"...":eH?Math.min(y*N,eH.total):0," ","of ",eO.isLoading?"...":eH?eH.total:0," results"]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-700 min-w-[90px]",children:["Page ",eO.isLoading?"...":y," of"," ",eO.isLoading?"...":eH?eH.total_pages:1]}),(0,n.jsx)("button",{onClick:()=>b(e=>Math.max(1,e-1)),disabled:eO.isLoading||1===y,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,n.jsx)("button",{onClick:()=>b(e=>Math.min(eH.total_pages||1,e+1)),disabled:eO.isLoading||y===(eH.total_pages||1),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}),eE&&1===y&&(0,n.jsxs)("div",{className:"mb-4 px-4 py-2 bg-green-50 border border-greem-200 rounded-md flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)("span",{className:"text-sm text-green-700",children:"Auto-refreshing every 15 seconds"})}),(0,n.jsx)("button",{onClick:()=>eA(!1),className:"text-sm text-green-600 hover:text-green-800",children:"Stop"})]}),(0,n.jsx)(eu.w,{columns:ej,data:eJ,onRowClick:eQ})]})]})]}),(0,n.jsx)(I.Z,{children:(0,n.jsx)(ew,{userID:m,userRole:o,token:l,accessToken:a,isActive:"audit logs"===eg,premiumUser:x,allTeams:u})}),(0,n.jsx)(I.Z,{children:(0,n.jsx)(J,{})}),(0,n.jsx)(I.Z,{children:(0,n.jsx)(ei,{})})]})]}),(0,n.jsx)(tt,{open:eb,onClose:()=>{eN(!1)},logEntry:ev,onOpenSettings:()=>eC(!0),allLogs:eJ,onSelectLog:e=>{ey(e)}})]})}function tc(e){var s,t,a,l,r,i,o,d,c,u,x,h;let{row:p,onOpenSettings:g}=e,f=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},j=p.original.metadata||{},v="failure"===j.status,y=v?j.error_information:null,b=p.original.messages&&(Array.isArray(p.original.messages)?p.original.messages.length>0:Object.keys(p.original.messages).length>0),N=p.original.response&&Object.keys(f(p.original.response)).length>0,w=j.vector_store_request_metadata&&Array.isArray(j.vector_store_request_metadata)&&j.vector_store_request_metadata.length>0,_=null===(s=p.original.metadata)||void 0===s?void 0:s.guardrail_information,k=Array.isArray(_)?_:_?[_]:[],S=k.length>0,C=k.reduce((e,s)=>{let t=null==s?void 0:s.masked_entity_count;return t?e+Object.values(t).reduce((e,s)=>"number"==typeof s?e+s:e,0):e},0),L=1===k.length?null!==(h=null===(t=k[0])||void 0===t?void 0:t.guardrail_name)&&void 0!==h?h:"-":k.length>1?"".concat(k.length," guardrails"):"-",D=(0,M.aS)(p.original.request_id,64);return(0,n.jsxs)("div",{className:"p-6 bg-gray-50 space-y-6 w-full max-w-full overflow-hidden box-border",children:[(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden",children:[(0,n.jsx)("div",{className:"p-4 border-b",children:(0,n.jsx)("h3",{className:"text-lg font-medium",children:"Request Details"})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 w-full max-w-full overflow-hidden",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Request ID:"}),p.original.request_id.length>64?(0,n.jsx)(m.Z,{title:p.original.request_id,children:(0,n.jsx)("span",{className:"font-mono text-sm",children:D})}):(0,n.jsx)("span",{className:"font-mono text-sm",children:p.original.request_id})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Model:"}),(0,n.jsx)("span",{children:p.original.model})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Model ID:"}),(0,n.jsx)("span",{children:p.original.model_id})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Call Type:"}),(0,n.jsx)("span",{children:p.original.call_type})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,n.jsx)("span",{children:p.original.custom_llm_provider||"-"})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"API Base:"}),(0,n.jsx)(m.Z,{title:p.original.api_base||"-",children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:p.original.api_base||"-"})})]}),(null==p?void 0:null===(a=p.original)||void 0===a?void 0:a.requester_ip_address)&&(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"IP Address:"}),(0,n.jsx)("span",{children:null==p?void 0:null===(l=p.original)||void 0===l?void 0:l.requester_ip_address})]}),S&&(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail:"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-mono",children:L}),C>0&&(0,n.jsxs)("span",{className:"ml-2 px-2 py-0.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[C," masked"]})]})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Tokens:"}),(0,n.jsxs)("span",{children:[p.original.total_tokens," (",p.original.prompt_tokens," prompt tokens +"," ",p.original.completion_tokens," completion tokens)"]})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Cache Read Tokens:"}),(0,n.jsx)("span",{children:(0,T.pw)((null===(i=p.original.metadata)||void 0===i?void 0:null===(r=i.additional_usage_values)||void 0===r?void 0:r.cache_read_input_tokens)||0)})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Cache Creation Tokens:"}),(0,n.jsx)("span",{children:(0,T.pw)(null===(o=p.original.metadata)||void 0===o?void 0:o.additional_usage_values.cache_creation_input_tokens)})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Cost:"}),(0,n.jsxs)("span",{children:["$",(0,T.pw)(p.original.spend||0,6)]})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Cache Hit:"}),(0,n.jsx)("span",{children:p.original.cache_hit})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat("failure"!==((null===(d=p.original.metadata)||void 0===d?void 0:d.status)||"Success").toLowerCase()?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"failure"!==((null===(c=p.original.metadata)||void 0===c?void 0:c.status)||"Success").toLowerCase()?"Success":"Failure"})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,n.jsx)("span",{children:p.original.startTime})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,n.jsx)("span",{children:p.original.endTime})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,n.jsxs)("span",{children:[p.original.duration," s."]})]}),(null===(u=p.original.metadata)||void 0===u?void 0:u.litellm_overhead_time_ms)!==void 0&&(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"LiteLLM Overhead:"}),(0,n.jsxs)("span",{children:[p.original.metadata.litellm_overhead_time_ms," ms"]})]})]})]})]}),(0,n.jsx)(eC,{costBreakdown:null===(x=p.original.metadata)||void 0===x?void 0:x.cost_breakdown,totalSpend:p.original.spend||0}),(0,n.jsx)(e_,{show:!b&&!N,onOpenSettings:g}),(0,n.jsx)("div",{className:"w-full max-w-full overflow-hidden",children:(0,n.jsx)(eI,{row:p,hasMessages:b,hasResponse:N,hasError:v,errorInfo:y,getRawRequest:()=>{var e;return(null===(e=p.original)||void 0===e?void 0:e.proxy_server_request)?f(p.original.proxy_server_request):f(p.original.messages)},formattedResponse:()=>v&&y?{error:{message:y.error_message||"An error occurred",type:y.error_class||"error",code:y.error_code||"unknown",param:null}}:f(p.original.response)})}),S&&(0,n.jsx)(E,{data:_}),w&&(0,n.jsx)(st,{data:j.vector_store_request_metadata}),v&&y&&(0,n.jsx)(eL,{errorInfo:y}),p.original.request_tags&&Object.keys(p.original.request_tags).length>0&&(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,n.jsx)("div",{className:"flex justify-between items-center p-4 border-b",children:(0,n.jsx)("h3",{className:"text-lg font-medium",children:"Request Tags"})}),(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(p.original.request_tags).map(e=>{let[s,t]=e;return(0,n.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[s,": ",String(t)]},s)})})})]}),p.original.metadata&&Object.keys(p.original.metadata).length>0&&(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,n.jsx)("h3",{className:"text-lg font-medium",children:"Metadata"}),(0,n.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(p.original.metadata,null,2))},className:"p-1 hover:bg-gray-200 rounded",title:"Copy metadata",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,n.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,n.jsx)("div",{className:"p-4 overflow-auto max-h-64",children:(0,n.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(p.original.metadata,null,2)})})]})]})}}}]);