"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9992],{1309:function(e,l,a){a.d(l,{C:function(){return t.Z}});var t=a(41649)},29992:function(e,l,a){a.d(l,{Z:function(){return lX}});var t,r,s,i,n=a(57437),o=a(2265),d=a(71618),c=a(73705),u=a(96473),m=a(11894),x=a(70464),p=a(19250),g=a(57840),h=a(37592),f=a(15690),j=a(10032),y=a(4260),v=a(3810),_=a(5545),b=a(22116),N=a(9114),w=a(5945),C=a(55590),k=a(65319),S=a(3632);let{Text:Z}=g.default,{Option:P}=h.default;var A=e=>{let{visible:l,prebuiltPatterns:a,categories:t,selectedPatternName:r,patternAction:s,onPatternNameChange:i,onActionChange:o,onAdd:d,onCancel:c}=e;return(0,n.jsxs)(b.Z,{title:"Add prebuilt pattern",open:l,onCancel:c,footer:null,width:800,children:[(0,n.jsxs)(C.Z,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(Z,{strong:!0,children:"Pattern type"}),(0,n.jsx)(h.default,{placeholder:"Choose pattern type",value:r,onChange:i,style:{width:"100%",marginTop:8},showSearch:!0,filterOption:(e,l)=>{let t=a.find(e=>e.name===(null==l?void 0:l.value));return!!t&&(t.display_name.toLowerCase().includes(e.toLowerCase())||t.name.toLowerCase().includes(e.toLowerCase()))},children:t.map(e=>{let l=a.filter(l=>l.category===e);return 0===l.length?null:(0,n.jsx)(h.default.OptGroup,{label:e,children:l.map(e=>(0,n.jsx)(P,{value:e.name,children:e.display_name},e.name))},e)})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(Z,{strong:!0,children:"Action"}),(0,n.jsx)(Z,{type:"secondary",style:{display:"block",marginTop:4,marginBottom:8},children:"Choose what action the guardrail should take when this pattern is detected"}),(0,n.jsxs)(h.default,{value:s,onChange:o,style:{width:"100%"},children:[(0,n.jsx)(P,{value:"BLOCK",children:"Block"}),(0,n.jsx)(P,{value:"MASK",children:"Mask"})]})]})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"24px"},children:[(0,n.jsx)(_.ZP,{onClick:c,children:"Cancel"}),(0,n.jsx)(_.ZP,{type:"primary",onClick:d,children:"Add"})]})]})};let{Text:O}=g.default,{Option:I}=h.default;var L=e=>{let{visible:l,patternName:a,patternRegex:t,patternAction:r,onNameChange:s,onRegexChange:i,onActionChange:o,onAdd:d,onCancel:c}=e;return(0,n.jsxs)(b.Z,{title:"Add custom regex pattern",open:l,onCancel:c,footer:null,width:800,children:[(0,n.jsxs)(C.Z,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(O,{strong:!0,children:"Pattern name"}),(0,n.jsx)(y.default,{placeholder:"e.g., internal_id, employee_code",value:a,onChange:e=>s(e.target.value),style:{marginTop:8}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(O,{strong:!0,children:"Regex pattern"}),(0,n.jsx)(y.default,{placeholder:"e.g., ID-[0-9]{6}",value:t,onChange:e=>i(e.target.value),style:{marginTop:8}}),(0,n.jsx)(O,{type:"secondary",style:{fontSize:12},children:"Enter a valid regular expression to match sensitive data"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(O,{strong:!0,children:"Action"}),(0,n.jsx)(O,{type:"secondary",style:{display:"block",marginTop:4,marginBottom:8},children:"Choose what action the guardrail should take when this pattern is detected"}),(0,n.jsxs)(h.default,{value:r,onChange:o,style:{width:"100%"},children:[(0,n.jsx)(I,{value:"BLOCK",children:"Block"}),(0,n.jsx)(I,{value:"MASK",children:"Mask"})]})]})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"24px"},children:[(0,n.jsx)(_.ZP,{onClick:c,children:"Cancel"}),(0,n.jsx)(_.ZP,{type:"primary",onClick:d,children:"Add"})]})]})};let{Text:T}=g.default,{Option:E}=h.default;var B=e=>{let{visible:l,keyword:a,action:t,description:r,onKeywordChange:s,onActionChange:i,onDescriptionChange:o,onAdd:d,onCancel:c}=e;return(0,n.jsxs)(b.Z,{title:"Add blocked keyword",open:l,onCancel:c,footer:null,width:800,children:[(0,n.jsxs)(C.Z,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(T,{strong:!0,children:"Keyword"}),(0,n.jsx)(y.default,{placeholder:"Enter sensitive keyword or phrase",value:a,onChange:e=>s(e.target.value),style:{marginTop:8}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(T,{strong:!0,children:"Action"}),(0,n.jsx)(T,{type:"secondary",style:{display:"block",marginTop:4,marginBottom:8},children:"Choose what action the guardrail should take when this keyword is detected"}),(0,n.jsxs)(h.default,{value:t,onChange:i,style:{width:"100%"},children:[(0,n.jsx)(E,{value:"BLOCK",children:"Block"}),(0,n.jsx)(E,{value:"MASK",children:"Mask"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(T,{strong:!0,children:"Description (optional)"}),(0,n.jsx)(y.default.TextArea,{placeholder:"Explain why this keyword is sensitive",value:r,onChange:e=>o(e.target.value),rows:3,style:{marginTop:8}})]})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"24px"},children:[(0,n.jsx)(_.ZP,{onClick:c,children:"Cancel"}),(0,n.jsx)(_.ZP,{type:"primary",onClick:d,children:"Add"})]})]})},z=a(56609),F=a(26349);let{Text:M}=g.default,{Option:G}=h.default;var R=e=>{let{patterns:l,onActionChange:a,onRemove:t}=e,r=[{title:"Type",dataIndex:"type",key:"type",width:100,render:e=>(0,n.jsx)(v.Z,{color:"prebuilt"===e?"blue":"green",children:"prebuilt"===e?"Prebuilt":"Custom"})},{title:"Pattern name",dataIndex:"name",key:"name",render:(e,l)=>l.display_name||l.name},{title:"Regex pattern",dataIndex:"pattern",key:"pattern",render:e=>e?(0,n.jsxs)(M,{code:!0,style:{fontSize:12},children:[e.substring(0,40),"..."]}):"-"},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,l)=>(0,n.jsxs)(h.default,{value:e,onChange:e=>a(l.id,e),style:{width:120},size:"small",children:[(0,n.jsx)(G,{value:"BLOCK",children:"Block"}),(0,n.jsx)(G,{value:"MASK",children:"Mask"})]})},{title:"",key:"actions",width:100,render:(e,l)=>(0,n.jsx)(_.ZP,{type:"text",danger:!0,size:"small",icon:(0,n.jsx)(F.Z,{}),onClick:()=>t(l.id),children:"Delete"})}];return 0===l.length?(0,n.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:"No patterns added."}):(0,n.jsx)(z.Z,{dataSource:l,columns:r,rowKey:"id",pagination:!1,size:"small"})};let{Text:K}=g.default,{Option:D}=h.default;var J=e=>{let{keywords:l,onActionChange:a,onRemove:t}=e,r=[{title:"Keyword",dataIndex:"keyword",key:"keyword"},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,l)=>(0,n.jsxs)(h.default,{value:e,onChange:e=>a(l.id,"action",e),style:{width:120},size:"small",children:[(0,n.jsx)(D,{value:"BLOCK",children:"Block"}),(0,n.jsx)(D,{value:"MASK",children:"Mask"})]})},{title:"Description",dataIndex:"description",key:"description",render:e=>e||"-"},{title:"",key:"actions",width:100,render:(e,l)=>(0,n.jsx)(_.ZP,{type:"text",danger:!0,size:"small",icon:(0,n.jsx)(F.Z,{}),onClick:()=>t(l.id),children:"Delete"})}];return 0===l.length?(0,n.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:"No keywords added."}):(0,n.jsx)(z.Z,{dataSource:l,columns:r,rowKey:"id",pagination:!1,size:"small"})},q=a(44851),U=a(38434);let{Title:V,Text:Y}=g.default,{Option:W}=h.default;var H=e=>{var l;let{availableCategories:a,selectedCategories:t,onCategoryAdd:r,onCategoryRemove:s,onCategoryUpdate:i,accessToken:d}=e,[c,m]=o.useState(""),[x,g]=o.useState({}),[f,j]=o.useState({}),[y,b]=o.useState([]),[N,C]=o.useState(""),[k,S]=o.useState(!1),Z=async e=>{if(d&&!x[e]){j(l=>({...l,[e]:!0}));try{let l=await (0,p.getCategoryYaml)(d,e);g(a=>({...a,[e]:l.yaml_content}))}catch(l){console.error("Failed to fetch YAML for category ".concat(e,":"),l)}finally{j(l=>({...l,[e]:!1}))}}};o.useEffect(()=>{if(c&&d){let e=x[c];if(e){C(e);return}S(!0),console.log("Fetching YAML for category: ".concat(c),{accessToken:d?"present":"missing"}),(0,p.getCategoryYaml)(d,c).then(e=>{console.log("Successfully fetched YAML for ".concat(c,":"),e),C(e.yaml_content),g(l=>({...l,[c]:e.yaml_content}))}).catch(e=>{console.error("Failed to fetch preview YAML for category ".concat(c,":"),e),C("")}).finally(()=>{S(!1)})}else C(""),S(!1)},[c,d]);let P=[{title:"Category",dataIndex:"display_name",key:"display_name",render:(e,l)=>{let t=a.find(e=>e.name===l.category);return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontWeight:500},children:e}),(null==t?void 0:t.description)&&(0,n.jsx)("div",{style:{fontSize:"12px",color:"#888",marginTop:"4px"},children:t.description})]})}},{title:"Action",dataIndex:"action",key:"action",width:150,render:(e,l)=>(0,n.jsxs)(h.default,{value:e,onChange:e=>i(l.id,"action",e),style:{width:"100%"},children:[(0,n.jsx)(W,{value:"BLOCK",children:(0,n.jsx)(v.Z,{color:"red",children:"BLOCK"})}),(0,n.jsx)(W,{value:"MASK",children:(0,n.jsx)(v.Z,{color:"orange",children:"MASK"})})]})},{title:"Severity Threshold",dataIndex:"severity_threshold",key:"severity_threshold",width:180,render:(e,l)=>(0,n.jsxs)(h.default,{value:e,onChange:e=>i(l.id,"severity_threshold",e),style:{width:"100%"},children:[(0,n.jsx)(W,{value:"low",children:"Low"}),(0,n.jsx)(W,{value:"medium",children:"Medium"}),(0,n.jsx)(W,{value:"high",children:"High"})]})},{title:"",key:"actions",width:80,render:(e,l)=>(0,n.jsx)(_.ZP,{icon:(0,n.jsx)(F.Z,{}),onClick:()=>s(l.id),size:"small",children:"Remove"})}],A=a.filter(e=>!t.some(l=>l.category===e.name));return(0,n.jsxs)(w.Z,{title:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)(V,{level:5,style:{margin:0},children:"Content Categories"}),(0,n.jsx)(Y,{type:"secondary",style:{fontSize:14,fontWeight:400},children:"Detect harmful content, bias, and inappropriate advice using semantic analysis"})]}),size:"small",children:[(0,n.jsxs)("div",{style:{marginBottom:16,display:"flex",gap:8},children:[(0,n.jsx)(h.default,{placeholder:"Select a content category",value:c||void 0,onChange:m,style:{flex:1},showSearch:!0,optionLabelProp:"label",filterOption:(e,l)=>{var a,t;return(null!==(t=null==l?void 0:null===(a=l.label)||void 0===a?void 0:a.toString().toLowerCase())&&void 0!==t?t:"").includes(e.toLowerCase())},children:A.map(e=>(0,n.jsx)(W,{value:e.name,label:e.display_name,children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontWeight:500},children:e.display_name}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:e.description})]})},e.name))}),(0,n.jsx)(_.ZP,{type:"primary",onClick:()=>{if(!c)return;let e=a.find(e=>e.name===c);!e||t.some(e=>e.category===c)||(r({id:"category-".concat(Date.now()),category:e.name,display_name:e.display_name,action:e.default_action,severity_threshold:"medium"}),m(""),C(""))},disabled:!c,icon:(0,n.jsx)(u.Z,{}),children:"Add"})]}),c&&(0,n.jsxs)("div",{style:{marginBottom:16,padding:"12px",background:"#f9f9f9",border:"1px solid #e0e0e0",borderRadius:"4px"},children:[(0,n.jsxs)("div",{style:{marginBottom:8,fontWeight:500,fontSize:"14px"},children:["Preview: ",null===(l=a.find(e=>e.name===c))||void 0===l?void 0:l.display_name]}),k?(0,n.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#888"},children:"Loading YAML..."}):N?(0,n.jsx)("pre",{style:{background:"#fff",padding:"12px",borderRadius:"4px",overflow:"auto",maxHeight:"300px",fontSize:"12px",lineHeight:"1.5",margin:0,border:"1px solid #e0e0e0"},children:(0,n.jsx)("code",{children:N})}):(0,n.jsx)("div",{style:{padding:"8px",textAlign:"center",color:"#888",fontSize:"12px"},children:"Unable to load YAML content"})]}),t.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z.Z,{dataSource:t,columns:P,pagination:!1,size:"small",rowKey:"id"}),(0,n.jsx)("div",{style:{marginTop:16},children:(0,n.jsx)(q.default,{activeKey:y,onChange:e=>{let l=Array.isArray(e)?e:e?[e]:[],a=new Set(y);l.forEach(e=>{a.has(e)||x[e]||Z(e)}),b(l)},ghost:!0,items:t.map(e=>({key:e.category,label:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,n.jsx)(U.Z,{}),(0,n.jsxs)("span",{children:["View YAML for ",e.display_name]})]}),children:f[e.category]?(0,n.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#888"},children:"Loading YAML..."}):x[e.category]?(0,n.jsx)("pre",{style:{background:"#f5f5f5",padding:"16px",borderRadius:"4px",overflow:"auto",maxHeight:"400px",fontSize:"12px",lineHeight:"1.5",margin:0},children:(0,n.jsx)("code",{children:x[e.category]})}):(0,n.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#888"},children:"YAML will load when expanded"})}))})})]}):(0,n.jsx)("div",{style:{textAlign:"center",padding:"24px",color:"#888",border:"1px dashed #d9d9d9",borderRadius:"4px"},children:"No content categories selected. Add categories to detect harmful content, bias, or inappropriate advice."})]})};let{Title:Q,Text:$}=g.default;var X=e=>{let{prebuiltPatterns:l,categories:a,selectedPatterns:t,blockedWords:r,onPatternAdd:s,onPatternRemove:i,onPatternActionChange:d,onBlockedWordAdd:c,onBlockedWordRemove:m,onBlockedWordUpdate:x,onFileUpload:g,accessToken:h,showStep:f,contentCategories:j=[],selectedContentCategories:y=[],onContentCategoryAdd:v,onContentCategoryRemove:b,onContentCategoryUpdate:Z}=e,[P,O]=(0,o.useState)(!1),[I,T]=(0,o.useState)(!1),[E,z]=(0,o.useState)(!1),[F,M]=(0,o.useState)(""),[G,K]=(0,o.useState)("BLOCK"),[D,q]=(0,o.useState)(""),[U,V]=(0,o.useState)(""),[Y,W]=(0,o.useState)("BLOCK"),[X,ee]=(0,o.useState)(""),[el,ea]=(0,o.useState)("BLOCK"),[et,er]=(0,o.useState)(""),[es,ei]=(0,o.useState)(!1),en=async e=>{ei(!0);try{let l=await e.text();if(h){let e=await (0,p.validateBlockedWordsFile)(h,l);if(e.valid)g&&g(l),N.ZP.success(e.message||"File uploaded successfully");else{let l=e.error||e.errors&&e.errors.join(", ")||"Invalid file";N.ZP.error("Validation failed: ".concat(l))}}}catch(e){N.ZP.error("Failed to upload file: ".concat(e))}finally{ei(!1)}return!1};return(0,n.jsxs)("div",{className:"space-y-6",children:[!f&&(0,n.jsx)("div",{children:(0,n.jsx)($,{type:"secondary",children:"Configure patterns, keywords, and content categories to detect and filter sensitive information in requests and responses."})}),(!f||"patterns"===f)&&(0,n.jsxs)(w.Z,{title:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)(Q,{level:5,style:{margin:0},children:"Pattern Detection"}),(0,n.jsx)($,{type:"secondary",style:{fontSize:14,fontWeight:400},children:"Detect sensitive information using regex patterns (SSN, credit cards, API keys, etc.)"})]}),size:"small",children:[(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsxs)(C.Z,{children:[(0,n.jsx)(_.ZP,{type:"primary",onClick:()=>O(!0),icon:(0,n.jsx)(u.Z,{}),children:"Add prebuilt pattern"}),(0,n.jsx)(_.ZP,{onClick:()=>z(!0),icon:(0,n.jsx)(u.Z,{}),children:"Add custom regex"})]})}),(0,n.jsx)(R,{patterns:t,onActionChange:d,onRemove:i})]}),(!f||"keywords"===f)&&(0,n.jsxs)(w.Z,{title:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)(Q,{level:5,style:{margin:0},children:"Blocked Keywords"}),(0,n.jsx)($,{type:"secondary",style:{fontSize:14,fontWeight:400},children:"Block or mask specific sensitive terms and phrases"})]}),size:"small",children:[(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsxs)(C.Z,{children:[(0,n.jsx)(_.ZP,{type:"primary",onClick:()=>T(!0),icon:(0,n.jsx)(u.Z,{}),children:"Add keyword"}),(0,n.jsx)(k.default,{beforeUpload:en,accept:".yaml,.yml",showUploadList:!1,children:(0,n.jsx)(_.ZP,{icon:(0,n.jsx)(S.Z,{}),loading:es,children:"Upload YAML file"})})]})}),(0,n.jsx)(J,{keywords:r,onActionChange:x,onRemove:m})]}),(!f||"categories"===f)&&j.length>0&&v&&b&&Z&&(0,n.jsx)(H,{availableCategories:j,selectedCategories:y,onCategoryAdd:v,onCategoryRemove:b,onCategoryUpdate:Z,accessToken:h}),(0,n.jsx)(A,{visible:P,prebuiltPatterns:l,categories:a,selectedPatternName:F,patternAction:G,onPatternNameChange:M,onActionChange:e=>K(e),onAdd:()=>{if(!F){N.ZP.error("Please select a pattern");return}let e=l.find(e=>e.name===F);s({id:"pattern-".concat(Date.now()),type:"prebuilt",name:F,display_name:null==e?void 0:e.display_name,action:G}),O(!1),M(""),K("BLOCK")},onCancel:()=>{O(!1),M(""),K("BLOCK")}}),(0,n.jsx)(L,{visible:E,patternName:D,patternRegex:U,patternAction:Y,onNameChange:q,onRegexChange:V,onActionChange:e=>W(e),onAdd:()=>{if(!D||!U){N.ZP.error("Please provide pattern name and regex");return}s({id:"custom-".concat(Date.now()),type:"custom",name:D,pattern:U,action:Y}),z(!1),q(""),V(""),W("BLOCK")},onCancel:()=>{z(!1),q(""),V(""),W("BLOCK")}}),(0,n.jsx)(B,{visible:I,keyword:X,action:el,description:et,onKeywordChange:ee,onActionChange:e=>ea(e),onDescriptionChange:er,onAdd:()=>{if(!X){N.ZP.error("Please enter a keyword");return}c({id:"word-".concat(Date.now()),keyword:X,action:el,description:et||void 0}),T(!1),ee(""),er(""),ea("BLOCK")},onCancel:()=>{T(!1),ee(""),er(""),ea("BLOCK")}})]})};(t=s||(s={})).PresidioPII="Presidio PII",t.Bedrock="Bedrock Guardrail",t.Lakera="Lakera";let ee={},el=e=>{let l={};return l.PresidioPII="Presidio PII",l.Bedrock="Bedrock Guardrail",l.Lakera="Lakera",Object.entries(e).forEach(e=>{let[a,t]=e;t&&"object"==typeof t&&"ui_friendly_name"in t&&(l[a.split("_").map((e,l)=>e.charAt(0).toUpperCase()+e.slice(1)).join("")]=t.ui_friendly_name)}),ee=l,l},ea=()=>Object.keys(ee).length>0?ee:s,et={PresidioPII:"presidio",Bedrock:"bedrock",Lakera:"lakera_v2",LitellmContentFilter:"litellm_content_filter",ToolPermission:"tool_permission"},er=e=>{Object.entries(e).forEach(e=>{let[l,a]=e;a&&"object"==typeof a&&"ui_friendly_name"in a&&(et[l.split("_").map((e,l)=>e.charAt(0).toUpperCase()+e.slice(1)).join("")]=l)})},es=e=>!!e&&"Presidio PII"===ea()[e],ei=e=>!!e&&"LiteLLM Content Filter"===ea()[e],en="../ui/assets/logos/",eo={"Zscaler AI Guard":"".concat(en,"zscaler.svg"),"Presidio PII":"".concat(en,"presidio.png"),"Bedrock Guardrail":"".concat(en,"bedrock.svg"),Lakera:"".concat(en,"lakeraai.jpeg"),"Azure Content Safety Prompt Shield":"".concat(en,"presidio.png"),"Azure Content Safety Text Moderation":"".concat(en,"presidio.png"),"Aporia AI":"".concat(en,"aporia.png"),"PANW Prisma AIRS":"".concat(en,"palo_alto_networks.jpeg"),"Noma Security":"".concat(en,"noma_security.png"),"Javelin Guardrails":"".concat(en,"javelin.png"),"Pillar Guardrail":"".concat(en,"pillar.jpeg"),"Google Cloud Model Armor":"".concat(en,"google.svg"),"Guardrails AI":"".concat(en,"guardrails_ai.jpeg"),"Lasso Guardrail":"".concat(en,"lasso.png"),"Pangea Guardrail":"".concat(en,"pangea.png"),"AIM Guardrail":"".concat(en,"aim_security.jpeg"),"OpenAI Moderation":"".concat(en,"openai_small.svg"),EnkryptAI:"".concat(en,"enkrypt_ai.avif"),"Prompt Security":"".concat(en,"prompt_security.png"),"LiteLLM Content Filter":"".concat(en,"litellm_logo.jpg")},ed=e=>{if(!e)return{logo:"",displayName:"-"};let l=Object.keys(et).find(l=>et[l].toLowerCase()===e.toLowerCase());if(!l)return{logo:"",displayName:e};let a=ea()[l];return{logo:eo[a]||"",displayName:a||e}};var ec=a(24199);let{Title:eu}=g.default,em=e=>{let{field:l,fieldKey:a,fullFieldKey:t,value:r}=e,[s,i]=o.useState([]),[d,c]=o.useState(l.dict_key_options||[]);o.useEffect(()=>{if(r&&"object"==typeof r){let e=Object.keys(r);i(e.map(e=>({key:e,id:"".concat(e,"_").concat(Date.now(),"_").concat(Math.random())}))),c((l.dict_key_options||[]).filter(l=>!e.includes(l)))}},[r,l.dict_key_options]);let u=e=>{e&&(i([...s,{key:e,id:"".concat(e,"_").concat(Date.now())}]),c(d.filter(l=>l!==e)))},m=(e,l)=>{i(s.filter(l=>l.id!==e)),c([...d,l].sort())};return(0,n.jsxs)("div",{className:"space-y-3",children:[s.map(e=>(0,n.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[(0,n.jsx)("div",{className:"w-24 font-medium text-sm",children:e.key}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(j.Z.Item,{name:Array.isArray(t)?[...t,e.key]:[t,e.key],style:{marginBottom:0},initialValue:r&&"object"==typeof r?r[e.key]:void 0,normalize:"number"===l.dict_value_type?e=>{if(null==e||""===e)return;let l=Number(e);return isNaN(l)?e:l}:void 0,children:"number"===l.dict_value_type?(0,n.jsx)(ec.Z,{step:1,width:200,placeholder:"Enter ".concat(e.key," value")}):"boolean"===l.dict_value_type?(0,n.jsxs)(h.default,{placeholder:"Select ".concat(e.key," value"),children:[(0,n.jsx)(h.default.Option,{value:!0,children:"True"}),(0,n.jsx)(h.default.Option,{value:!1,children:"False"})]}):(0,n.jsx)(y.default,{placeholder:"Enter ".concat(e.key," value")})})}),(0,n.jsx)(_.ZP,{type:"text",danger:!0,size:"small",onClick:()=>m(e.id,e.key),children:"Remove"})]},e.id)),d.length>0&&(0,n.jsxs)("div",{className:"flex items-center space-x-3 mt-2",children:[(0,n.jsx)(h.default,{placeholder:"Select category to configure",style:{width:200},onSelect:e=>e&&u(e),value:void 0,children:d.map(e=>(0,n.jsx)(h.default.Option,{value:e,children:e},e))}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Select a category to add threshold configuration"})]})]})};var ex=e=>{let{optionalParams:l,parentFieldKey:a,values:t}=e,r=(e,l)=>{let r="".concat(a,".").concat(e),s=null==t?void 0:t[e];return(console.log("value",s),"dict"===l.type&&l.dict_key_options)?(0,n.jsxs)("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[(0,n.jsx)("div",{className:"mb-4 font-medium text-gray-900 text-base",children:e}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:l.description}),(0,n.jsx)(em,{field:l,fieldKey:e,fullFieldKey:[a,e],value:s})]},r):(0,n.jsx)("div",{className:"mb-8 p-6 bg-white rounded-lg border border-gray-200 shadow-sm",children:(0,n.jsx)(j.Z.Item,{name:[a,e],label:(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("div",{className:"font-medium text-gray-900 text-base",children:e}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:l.description})]}),rules:l.required?[{required:!0,message:"".concat(e," is required")}]:void 0,className:"mb-0",initialValue:void 0!==s?s:l.default_value,normalize:"number"===l.type?e=>{if(null==e||""===e)return;let l=Number(e);return isNaN(l)?e:l}:void 0,children:"select"===l.type&&l.options?(0,n.jsx)(h.default,{placeholder:l.description,children:l.options.map(e=>(0,n.jsx)(h.default.Option,{value:e,children:e},e))}):"multiselect"===l.type&&l.options?(0,n.jsx)(h.default,{mode:"multiple",placeholder:l.description,children:l.options.map(e=>(0,n.jsx)(h.default.Option,{value:e,children:e},e))}):"bool"===l.type||"boolean"===l.type?(0,n.jsxs)(h.default,{placeholder:l.description,children:[(0,n.jsx)(h.default.Option,{value:"true",children:"True"}),(0,n.jsx)(h.default.Option,{value:"false",children:"False"})]}):"number"===l.type?(0,n.jsx)(ec.Z,{step:1,width:400,placeholder:l.description}):e.includes("password")||e.includes("secret")||e.includes("key")?(0,n.jsx)(y.default.Password,{placeholder:l.description}):(0,n.jsx)(y.default,{placeholder:l.description})})},r)};return l.fields&&0!==Object.keys(l.fields).length?(0,n.jsxs)("div",{className:"guardrail-optional-params",children:[(0,n.jsxs)("div",{className:"mb-8 pb-4 border-b border-gray-100",children:[(0,n.jsx)(eu,{level:3,className:"mb-2 font-semibold text-gray-900",children:"Optional Parameters"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:l.description||"Configure additional settings for this guardrail provider"})]}),(0,n.jsx)("div",{className:"space-y-8",children:Object.entries(l.fields).map(e=>{let[l,a]=e;return r(l,a)})})]}):null},ep=a(10353),eg=e=>{var l;let{selectedProvider:a,accessToken:t,providerParams:r=null,value:s=null}=e,[i,d]=(0,o.useState)(!1),[c,u]=(0,o.useState)(r),[m,x]=(0,o.useState)(null);if((0,o.useEffect)(()=>{if(r){u(r);return}let e=async()=>{if(t){d(!0),x(null);try{let e=await (0,p.getGuardrailProviderSpecificParams)(t);console.log("Provider params API response:",e),u(e),el(e),er(e)}catch(e){console.error("Error fetching provider params:",e),x("Failed to load provider parameters")}finally{d(!1)}}};r||e()},[t,r]),!a)return null;if(i)return(0,n.jsx)(ep.Z,{tip:"Loading provider parameters..."});if(m)return(0,n.jsx)("div",{className:"text-red-500",children:m});let g=null===(l=et[a])||void 0===l?void 0:l.toLowerCase(),f=c&&c[g];if(console.log("Provider key:",g),console.log("Provider fields:",f),!f||0===Object.keys(f).length)return(0,n.jsx)("div",{children:"No configuration fields available for this provider."});console.log("Value:",s);let v=new Set(["patterns","blocked_words","blocked_words_file","categories","severity_threshold","pattern_redaction_format","keyword_redaction_tag"]),_=ei(a),b=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0;return Object.entries(e).map(e=>{let[t,r]=e,i=l?"".concat(l,".").concat(t):t,o=a?a[t]:null==s?void 0:s[t];return(console.log("Field value:",o),"ui_friendly_name"===t||"optional_params"===t&&"nested"===r.type&&r.fields||_&&v.has(t))?null:"nested"===r.type&&r.fields?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"mb-2 font-medium",children:t}),(0,n.jsx)("div",{className:"ml-4 border-l-2 border-gray-200 pl-4",children:b(r.fields,i,o)})]},i):(0,n.jsx)(j.Z.Item,{name:i,label:t,tooltip:r.description,rules:r.required?[{required:!0,message:"".concat(t," is required")}]:void 0,children:"select"===r.type&&r.options?(0,n.jsx)(h.default,{placeholder:r.description,defaultValue:o||r.default_value,children:r.options.map(e=>(0,n.jsx)(h.default.Option,{value:e,children:e},e))}):"multiselect"===r.type&&r.options?(0,n.jsx)(h.default,{mode:"multiple",placeholder:r.description,defaultValue:o||r.default_value,children:r.options.map(e=>(0,n.jsx)(h.default.Option,{value:e,children:e},e))}):"bool"===r.type||"boolean"===r.type?(0,n.jsxs)(h.default,{placeholder:r.description,defaultValue:void 0!==o?String(o):r.default_value,children:[(0,n.jsx)(h.default.Option,{value:"true",children:"True"}),(0,n.jsx)(h.default.Option,{value:"false",children:"False"})]}):"number"===r.type?(0,n.jsx)(ec.Z,{step:1,width:400,placeholder:r.description,defaultValue:void 0!==o?Number(o):void 0}):t.includes("password")||t.includes("secret")||t.includes("key")?(0,n.jsx)(y.default.Password,{placeholder:r.description,defaultValue:o||""}):(0,n.jsx)(y.default,{placeholder:r.description,defaultValue:o||""})},i)})};return(0,n.jsx)(n.Fragment,{children:b(f)})},eh=a(99981),ef=a(61994),ej=a(97416),ey=a(8881),ev=a(10798),e_=a(49638);let{Text:eb}=g.default,{Option:eN}=h.default,ew=e=>e.replace(/_/g," "),eC=e=>{switch(e){case"MASK":return(0,n.jsx)(ej.Z,{style:{marginRight:4}});case"BLOCK":return(0,n.jsx)(ey.Z,{style:{marginRight:4}});default:return null}},ek=e=>{let{categories:l,selectedCategories:a,onChange:t}=e;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center mb-2",children:[(0,n.jsx)(ev.Z,{className:"text-gray-500 mr-1"}),(0,n.jsx)(eb,{className:"text-gray-500 font-medium",children:"Filter by category"})]}),(0,n.jsx)(h.default,{mode:"multiple",placeholder:"Select categories to filter by",style:{width:"100%"},onChange:t,value:a,allowClear:!0,showSearch:!0,optionFilterProp:"children",className:"mb-4",tagRender:e=>(0,n.jsx)(v.Z,{color:"blue",closable:e.closable,onClose:e.onClose,className:"mr-2 mb-2",children:e.label}),children:l.map(e=>(0,n.jsx)(eN,{value:e.category,children:e.category},e.category))})]})},eS=e=>{let{onSelectAll:l,onUnselectAll:a,hasSelectedEntities:t}=e;return(0,n.jsxs)("div",{className:"bg-gray-50 p-5 rounded-lg mb-6 border border-gray-200 shadow-sm",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(eb,{strong:!0,className:"text-gray-700 text-base",children:"Quick Actions"}),(0,n.jsx)(eh.Z,{title:"Apply action to all PII types at once",children:(0,n.jsx)("div",{className:"ml-2 text-gray-400 cursor-help text-xs",children:"â“˜"})})]}),(0,n.jsx)(_.ZP,{color:"danger",variant:"outlined",onClick:a,disabled:!t,icon:(0,n.jsx)(e_.Z,{}),children:"Unselect All"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsx)(_.ZP,{color:"primary",variant:"outlined",onClick:()=>l("MASK"),className:"h-10",block:!0,icon:(0,n.jsx)(ej.Z,{}),children:"Select All & Mask"}),(0,n.jsx)(_.ZP,{color:"danger",variant:"outlined",onClick:()=>l("BLOCK"),className:"h-10 hover:bg-red-100",block:!0,icon:(0,n.jsx)(ey.Z,{}),children:"Select All & Block"})]})]})},eZ=e=>{let{entities:l,selectedEntities:a,selectedActions:t,actions:r,onEntitySelect:s,onActionSelect:i,entityToCategoryMap:o}=e;return(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[(0,n.jsxs)("div",{className:"bg-gray-50 px-5 py-3 border-b flex",children:[(0,n.jsx)(eb,{strong:!0,className:"flex-1 text-gray-700",children:"PII Type"}),(0,n.jsx)(eb,{strong:!0,className:"w-32 text-right text-gray-700",children:"Action"})]}),(0,n.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:0===l.length?(0,n.jsx)("div",{className:"py-10 text-center text-gray-500",children:"No PII types match your filter criteria"}):l.map(e=>(0,n.jsxs)("div",{className:"px-5 py-3 flex items-center justify-between hover:bg-gray-50 border-b ".concat(a.includes(e)?"bg-blue-50":""),children:[(0,n.jsxs)("div",{className:"flex items-center flex-1",children:[(0,n.jsx)(ef.Z,{checked:a.includes(e),onChange:()=>s(e),className:"mr-3"}),(0,n.jsx)(eb,{className:a.includes(e)?"font-medium text-gray-900":"text-gray-700",children:ew(e)}),o.get(e)&&(0,n.jsx)(v.Z,{className:"ml-2 text-xs",color:"blue",children:o.get(e)})]}),(0,n.jsx)("div",{className:"w-32",children:(0,n.jsx)(h.default,{value:a.includes(e)&&t[e]||"MASK",onChange:l=>i(e,l),style:{width:120},disabled:!a.includes(e),className:"".concat(a.includes(e)?"":"opacity-50"),dropdownMatchSelectWidth:!1,children:r.map(e=>(0,n.jsx)(eN,{value:e,children:(0,n.jsxs)("div",{className:"flex items-center",children:[eC(e),e]})},e))})})]},e))})]})},{Title:eP,Text:eA}=g.default;var eO=e=>{let{entities:l,actions:a,selectedEntities:t,selectedActions:r,onEntitySelect:s,onActionSelect:i,entityCategories:d=[]}=e,[c,u]=(0,o.useState)([]),m=new Map;d.forEach(e=>{e.entities.forEach(l=>{m.set(l,e.category)})});let x=l.filter(e=>0===c.length||c.includes(m.get(e)||""));return(0,n.jsxs)("div",{className:"pii-configuration",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(eP,{level:4,className:"!m-0 font-semibold text-gray-800",children:"Configure PII Protection"})}),(0,n.jsxs)(eA,{className:"text-gray-500",children:[t.length," items selected"]})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)(ek,{categories:d,selectedCategories:c,onChange:u}),(0,n.jsx)(eS,{onSelectAll:e=>{l.forEach(l=>{t.includes(l)||s(l),i(l,e)})},onUnselectAll:()=>{t.forEach(e=>{s(e)})},hasSelectedEntities:t.length>0})]}),(0,n.jsx)(eZ,{entities:x,selectedEntities:t,selectedActions:r,actions:a,onEntitySelect:s,onActionSelect:i,entityToCategoryMap:m})]})},eI=a(78801),eL=a(23496),eT=a(85180),eE=a(15424);let eB={rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""},ez=e=>({...eB,...e||{},rules:(null==e?void 0:e.rules)?[...e.rules]:[]});var eF=e=>{let{value:l,onChange:a,disabled:t=!1}=e,r=ez(l),s=e=>{let l={...r,...e};null==a||a(l)},i=(e,l)=>{s({rules:r.rules.map((a,t)=>t===e?{...a,...l}:a)})},o=e=>{s({rules:r.rules.filter((l,a)=>a!==e)})},d=(e,l)=>{let a=r.rules[e];if(!a)return;let t=Object.entries(a.allowed_param_patterns||{});l(t);let s={};t.forEach(e=>{let[l,a]=e;s[l]=a}),i(e,{allowed_param_patterns:Object.keys(s).length>0?s:void 0})},c=(e,l,a)=>{d(e,e=>{if(!e[l])return;let[,t]=e[l];e[l]=[a,t]})},m=(e,l,a)=>{d(e,e=>{if(!e[l])return;let[t]=e[l];e[l]=[t,a]})},x=(e,l)=>{let a=Object.entries(e.allowed_param_patterns||{});return 0===a.length?(0,n.jsx)(_.ZP,{disabled:t,size:"small",onClick:()=>i(l,{allowed_param_patterns:{"":""}}),children:"+ Restrict tool arguments (optional)"}):(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eI.x,{className:"text-sm text-gray-600",children:"Argument constraints (dot or array paths)"}),a.map((a,r)=>{let[s,i]=a;return(0,n.jsxs)(C.Z,{align:"start",children:[(0,n.jsx)(y.default,{disabled:t,placeholder:"messages[0].content",value:s,onChange:e=>c(l,r,e.target.value)}),(0,n.jsx)(y.default,{disabled:t,placeholder:"^email@.*$",value:i,onChange:e=>m(l,r,e.target.value)}),(0,n.jsx)(_.ZP,{disabled:t,icon:(0,n.jsx)(F.Z,{}),danger:!0,onClick:()=>d(l,e=>{e.splice(r,1)})})]},"".concat(e.id||l,"-").concat(r))}),(0,n.jsx)(_.ZP,{disabled:t,size:"small",onClick:()=>i(l,{allowed_param_patterns:{...e.allowed_param_patterns||{},"":""}}),children:"+ Add another constraint"})]})};return(0,n.jsxs)(eI.Z,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(eI.x,{className:"text-lg font-semibold",children:"LiteLLM Tool Permission Guardrail"}),(0,n.jsx)(eI.x,{className:"text-sm text-gray-500",children:"Provide regex patterns (e.g., ^mcp__github_.*$) for tool names or types and optionally constrain payload fields."})]}),!t&&(0,n.jsx)(_.ZP,{icon:(0,n.jsx)(u.Z,{}),type:"primary",onClick:()=>{s({rules:[...r.rules,{id:"rule_".concat(Math.random().toString(36).slice(2,8)),decision:"allow",allowed_param_patterns:void 0}]})},className:"!bg-blue-600 !text-white hover:!bg-blue-500",children:"Add Rule"})]}),(0,n.jsx)(eL.Z,{}),0===r.rules.length?(0,n.jsx)(eT.Z,{description:"No tool rules added yet"}):(0,n.jsx)("div",{className:"space-y-4",children:r.rules.map((e,l)=>{var a,r;return(0,n.jsxs)(eI.Z,{className:"bg-gray-50",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsxs)(eI.x,{className:"font-semibold",children:["Rule ",l+1]}),(0,n.jsx)(_.ZP,{icon:(0,n.jsx)(F.Z,{}),danger:!0,type:"text",disabled:t,onClick:()=>o(l),children:"Remove"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(eI.x,{className:"text-sm font-medium",children:"Rule ID"}),(0,n.jsx)(y.default,{disabled:t,placeholder:"unique_rule_id",value:e.id,onChange:e=>i(l,{id:e.target.value})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(eI.x,{className:"text-sm font-medium",children:"Tool Name (optional)"}),(0,n.jsx)(y.default,{disabled:t,placeholder:"^mcp__github_.*$",value:null!==(a=e.tool_name)&&void 0!==a?a:"",onChange:e=>i(l,{tool_name:""===e.target.value.trim()?void 0:e.target.value})})]})]}),(0,n.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 mt-4",children:(0,n.jsxs)("div",{children:[(0,n.jsx)(eI.x,{className:"text-sm font-medium",children:"Tool Type (optional)"}),(0,n.jsx)(y.default,{disabled:t,placeholder:"^function$",value:null!==(r=e.tool_type)&&void 0!==r?r:"",onChange:e=>i(l,{tool_type:""===e.target.value.trim()?void 0:e.target.value})})]})}),(0,n.jsxs)("div",{className:"mt-4 flex flex-col gap-2",children:[(0,n.jsx)(eI.x,{className:"text-sm font-medium",children:"Decision"}),(0,n.jsxs)(h.default,{disabled:t,value:e.decision,style:{width:200},onChange:e=>i(l,{decision:e}),children:[(0,n.jsx)(h.default.Option,{value:"allow",children:"Allow"}),(0,n.jsx)(h.default.Option,{value:"deny",children:"Deny"})]})]}),(0,n.jsx)("div",{className:"mt-4",children:x(e,l)})]},e.id||l)})}),(0,n.jsx)(eL.Z,{}),(0,n.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(eI.x,{className:"text-sm font-medium",children:"Default action"}),(0,n.jsxs)(h.default,{disabled:t,value:r.default_action,onChange:e=>s({default_action:e}),children:[(0,n.jsx)(h.default.Option,{value:"allow",children:"Allow"}),(0,n.jsx)(h.default.Option,{value:"deny",children:"Deny"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)(eI.x,{className:"text-sm font-medium flex items-center gap-1",children:["On disallowed action",(0,n.jsx)(eh.Z,{title:"Block returns an error when a forbidden tool is invoked. Rewrite strips the tool call but lets the rest of the response continue.",children:(0,n.jsx)(eE.Z,{})})]}),(0,n.jsxs)(h.default,{disabled:t,value:r.on_disallowed_action,onChange:e=>s({on_disallowed_action:e}),children:[(0,n.jsx)(h.default.Option,{value:"block",children:"Block"}),(0,n.jsx)(h.default.Option,{value:"rewrite",children:"Rewrite"})]})]})]}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(eI.x,{className:"text-sm font-medium",children:"Violation message (optional)"}),(0,n.jsx)(y.default.TextArea,{disabled:t,rows:3,placeholder:"This violates our org policy...",value:r.violation_message_template,onChange:e=>s({violation_message_template:e.target.value})})]})]})};let{Title:eM,Text:eG,Link:eR}=g.default,{Option:eK}=h.default,{Step:eD}=f.default,eJ={pre_call:"Before LLM Call - Runs before the LLM call and checks the input (Recommended)",during_call:"During LLM Call - Runs in parallel with the LLM call, with response held until check completes",post_call:"After LLM Call - Runs after the LLM call and checks only the output",logging_only:"Logging Only - Only runs on logging callbacks without affecting the LLM call",pre_mcp_call:"Before MCP Tool Call - Runs before MCP tool execution and validates tool calls",during_mcp_call:"During MCP Tool Call - Runs in parallel with MCP tool execution for monitoring"};var eq=e=>{let{visible:l,onClose:a,accessToken:t,onSuccess:r}=e,[s]=j.Z.useForm(),[i,d]=(0,o.useState)(!1),[c,u]=(0,o.useState)(null),[m,x]=(0,o.useState)(null),[g,w]=(0,o.useState)([]),[C,k]=(0,o.useState)({}),[S,Z]=(0,o.useState)(0),[P,A]=(0,o.useState)(null),[O,I]=(0,o.useState)([]),[L,T]=(0,o.useState)(2),[E,B]=(0,o.useState)({}),[z,F]=(0,o.useState)([]),[M,G]=(0,o.useState)([]),[R,K]=(0,o.useState)([]),[D,J]=(0,o.useState)({rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""}),q=(0,o.useMemo)(()=>!!c&&"tool_permission"===(et[c]||"").toLowerCase(),[c]);(0,o.useEffect)(()=>{t&&(async()=>{try{let[e,l]=await Promise.all([(0,p.getGuardrailUISettings)(t),(0,p.getGuardrailProviderSpecificParams)(t)]);x(e),A(l),el(l),er(l)}catch(e){console.error("Error fetching guardrail data:",e),N.ZP.fromBackend("Failed to load guardrail configuration")}})()},[t]);let U=e=>{u(e),s.setFieldsValue({config:void 0,presidio_analyzer_api_base:void 0,presidio_anonymizer_api_base:void 0}),w([]),k({}),I([]),T(2),B({}),J({rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""})},V=e=>{w(l=>l.includes(e)?l.filter(l=>l!==e):[...l,e])},Y=(e,l)=>{k(a=>({...a,[e]:l}))},W=async()=>{try{if(0===S&&(await s.validateFields(["guardrail_name","provider","mode","default_on"]),c)){let e=["guardrail_name","provider","mode","default_on"];"PresidioPII"===c&&e.push("presidio_analyzer_api_base","presidio_anonymizer_api_base"),await s.validateFields(e)}if(1===S&&es(c)&&0===g.length){N.ZP.fromBackend("Please select at least one PII entity to continue");return}Z(S+1)}catch(e){console.error("Form validation failed:",e)}},H=()=>{Z(S-1)},Q=()=>{s.resetFields(),u(null),w([]),k({}),I([]),T(2),B({}),F([]),G([]),K([]),J({rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""}),Z(0)},$=()=>{Q(),a()},ee=async()=>{try{d(!0),await s.validateFields();let l=s.getFieldsValue(!0),i=et[l.provider],n={guardrail_name:l.guardrail_name,litellm_params:{guardrail:i,mode:l.mode,default_on:l.default_on},guardrail_info:{}};if("PresidioPII"===l.provider&&g.length>0){let e={};g.forEach(l=>{e[l]=C[l]||"MASK"}),n.litellm_params.pii_entities_config=e,l.presidio_analyzer_api_base&&(n.litellm_params.presidio_analyzer_api_base=l.presidio_analyzer_api_base),l.presidio_anonymizer_api_base&&(n.litellm_params.presidio_anonymizer_api_base=l.presidio_anonymizer_api_base)}if(ei(l.provider))z.length>0&&(n.litellm_params.patterns=z.map(e=>({pattern_type:"prebuilt"===e.type?"prebuilt":"regex",pattern_name:"prebuilt"===e.type?e.name:void 0,pattern:"custom"===e.type?e.pattern:void 0,name:e.name,action:e.action}))),M.length>0&&(n.litellm_params.blocked_words=M.map(e=>({keyword:e.keyword,action:e.action,description:e.description}))),R.length>0&&(n.litellm_params.categories=R.map(e=>({category:e.category,enabled:!0,action:e.action,severity_threshold:e.severity_threshold||"medium"})));else if(l.config)try{let e=JSON.parse(l.config);n.guardrail_info=e}catch(e){N.ZP.fromBackend("Invalid JSON in configuration"),d(!1);return}if("tool_permission"===i){if(0===D.rules.length){N.ZP.fromBackend("Add at least one tool permission rule"),d(!1);return}n.litellm_params.rules=D.rules,n.litellm_params.default_action=D.default_action,n.litellm_params.on_disallowed_action=D.on_disallowed_action,D.violation_message_template&&(n.litellm_params.violation_message_template=D.violation_message_template)}if(console.log("values: ",JSON.stringify(l)),P&&c){var e;let a=null===(e=et[c])||void 0===e?void 0:e.toLowerCase();console.log("providerKey: ",a);let t=P[a]||{},r=new Set;console.log("providerSpecificParams: ",JSON.stringify(t)),Object.keys(t).forEach(e=>{"optional_params"!==e&&r.add(e)}),t.optional_params&&t.optional_params.fields&&Object.keys(t.optional_params.fields).forEach(e=>{r.add(e)}),console.log("allowedParams: ",r),r.forEach(e=>{let a=l[e];if(null==a||""===a){var t;a=null===(t=l.optional_params)||void 0===t?void 0:t[e]}null!=a&&""!==a&&(n.litellm_params[e]=a)})}if(!t)throw Error("No access token available");console.log("Sending guardrail data:",JSON.stringify(n)),await (0,p.createGuardrailCall)(t,n),N.ZP.success("Guardrail created successfully"),Q(),r(),a()}catch(e){console.error("Failed to create guardrail:",e),N.ZP.fromBackend("Failed to create guardrail: "+(e instanceof Error?e.message:String(e)))}finally{d(!1)}},en=()=>{var e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.Z.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,n.jsx)(y.default,{placeholder:"Enter a name for this guardrail"})}),(0,n.jsx)(j.Z.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,n.jsx)(h.default,{placeholder:"Select a guardrail provider",onChange:U,labelInValue:!1,optionLabelProp:"label",dropdownRender:e=>e,showSearch:!0,children:Object.entries(ea()).map(e=>{let[l,a]=e;return(0,n.jsx)(eK,{value:l,label:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[eo[a]&&(0,n.jsx)("img",{src:eo[a],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,n.jsx)("span",{children:a})]}),children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[eo[a]&&(0,n.jsx)("img",{src:eo[a],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,n.jsx)("span",{children:a})]})},l)})})}),(0,n.jsx)(j.Z.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,n.jsx)(h.default,{optionLabelProp:"label",mode:"multiple",children:(null==m?void 0:null===(e=m.supported_modes)||void 0===e?void 0:e.map(e=>(0,n.jsx)(eK,{value:e,label:e,children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:e}),"pre_call"===e&&(0,n.jsx)(v.Z,{color:"green",style:{marginLeft:"8px"},children:"Recommended"})]}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eJ[e]})]})},e)))||(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eK,{value:"pre_call",label:"pre_call",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"pre_call"})," ",(0,n.jsx)(v.Z,{color:"green",children:"Recommended"})]}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eJ.pre_call})]})}),(0,n.jsx)(eK,{value:"during_call",label:"during_call",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:(0,n.jsx)("strong",{children:"during_call"})}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eJ.during_call})]})}),(0,n.jsx)(eK,{value:"post_call",label:"post_call",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:(0,n.jsx)("strong",{children:"post_call"})}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eJ.post_call})]})}),(0,n.jsx)(eK,{value:"logging_only",label:"logging_only",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:(0,n.jsx)("strong",{children:"logging_only"})}),(0,n.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:eJ.logging_only})]})})]})})}),(0,n.jsx)(j.Z.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default.",children:(0,n.jsxs)(h.default,{children:[(0,n.jsx)(h.default.Option,{value:!0,children:"Yes"}),(0,n.jsx)(h.default.Option,{value:!1,children:"No"})]})}),!q&&!ei(c)&&(0,n.jsx)(eg,{selectedProvider:c,accessToken:t,providerParams:P})]})},ed=()=>m&&"PresidioPII"===c?(0,n.jsx)(eO,{entities:m.supported_entities,actions:m.supported_actions,selectedEntities:g,selectedActions:C,onEntitySelect:V,onActionSelect:Y,entityCategories:m.pii_entity_categories}):null,ec=e=>{if(!m||!ei(c))return null;let l=m.content_filter_settings;return l?(0,n.jsx)(X,{prebuiltPatterns:l.prebuilt_patterns||[],categories:l.pattern_categories||[],selectedPatterns:z,blockedWords:M,onPatternAdd:e=>F([...z,e]),onPatternRemove:e=>F(z.filter(l=>l.id!==e)),onPatternActionChange:(e,l)=>{F(z.map(a=>a.id===e?{...a,action:l}:a))},onBlockedWordAdd:e=>G([...M,e]),onBlockedWordRemove:e=>G(M.filter(l=>l.id!==e)),onBlockedWordUpdate:(e,l,a)=>{G(M.map(t=>t.id===e?{...t,[l]:a}:t))},contentCategories:l.content_categories||[],selectedContentCategories:R,onContentCategoryAdd:e=>K([...R,e]),onContentCategoryRemove:e=>K(R.filter(l=>l.id!==e)),onContentCategoryUpdate:(e,l,a)=>{K(R.map(t=>t.id===e?{...t,[l]:a}:t))},accessToken:t,showStep:e}):null},eu=()=>{var e;if(!c)return null;if(q)return(0,n.jsx)(eF,{value:D,onChange:J});if(!P)return null;console.log("guardrail_provider_map: ",et),console.log("selectedProvider: ",c);let l=null===(e=et[c])||void 0===e?void 0:e.toLowerCase(),a=P&&P[l];return a&&a.optional_params?(0,n.jsx)(ex,{optionalParams:a.optional_params,parentFieldKey:"optional_params"}):null};return(0,n.jsx)(b.Z,{title:"Add Guardrail",open:l,onCancel:$,footer:null,width:800,children:(0,n.jsxs)(j.Z,{form:s,layout:"vertical",initialValues:{mode:"pre_call",default_on:!1},children:[(0,n.jsxs)(f.default,{current:S,className:"mb-6",style:{overflow:"visible"},children:[(0,n.jsx)(eD,{title:"Basic Info"}),(0,n.jsx)(eD,{title:es(c)?"PII Configuration":ei(c)?"Default Categories":"Provider Configuration"}),ei(c)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eD,{title:"Patterns"}),(0,n.jsx)(eD,{title:"Keywords"})]})]}),(()=>{switch(S){case 0:return en();case 1:if(es(c))return ed();if(ei(c))return ec("categories");return eu();case 2:if(ei(c))return ec("patterns");return null;case 3:if(ei(c))return ec("keywords");return null;default:return null}})(),(()=>{let e=S===(ei(c)?4:2)-1;return(0,n.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[S>0&&(0,n.jsx)(_.ZP,{onClick:H,children:"Previous"}),!e&&(0,n.jsx)(_.ZP,{type:"primary",onClick:W,children:"Next"}),e&&(0,n.jsx)(_.ZP,{type:"primary",onClick:ee,loading:i,children:"Create Guardrail"}),(0,n.jsx)(_.ZP,{onClick:$,children:"Cancel"})]})})()]})})},eU=a(78489),eV=a(47323),eY=a(21626),eW=a(97214),eH=a(28241),eQ=a(58834),e$=a(69552),eX=a(71876),e0=a(74998),e1=a(44633),e2=a(86462),e4=a(49084),e5=a(1309),e8=a(71594),e6=a(24525),e3=a(63709),e9=a(64504);let{Title:e7,Text:le}=g.default,{Option:ll}=h.default;var la=e=>{var l;let{visible:a,onClose:t,accessToken:r,onSuccess:s,guardrailId:i,initialValues:d}=e,[c]=j.Z.useForm(),[u,m]=(0,o.useState)(!1),[x,g]=(0,o.useState)((null==d?void 0:d.provider)||null),[f,v]=(0,o.useState)(null),[_,w]=(0,o.useState)([]),[C,k]=(0,o.useState)({});(0,o.useEffect)(()=>{(async()=>{try{if(!r)return;let e=await (0,p.getGuardrailUISettings)(r);v(e)}catch(e){console.error("Error fetching guardrail settings:",e),N.ZP.fromBackend("Failed to load guardrail settings")}})()},[r]),(0,o.useEffect)(()=>{(null==d?void 0:d.pii_entities_config)&&Object.keys(d.pii_entities_config).length>0&&(w(Object.keys(d.pii_entities_config)),k(d.pii_entities_config))},[d]);let S=e=>{w(l=>l.includes(e)?l.filter(l=>l!==e):[...l,e])},Z=(e,l)=>{k(a=>({...a,[e]:l}))},P=async()=>{try{m(!0);let e=await c.validateFields(),l=et[e.provider],a={guardrail_id:i,guardrail:{guardrail_name:e.guardrail_name,litellm_params:{guardrail:l,mode:e.mode,default_on:e.default_on},guardrail_info:{}}};if("PresidioPII"===e.provider&&_.length>0){let e={};_.forEach(l=>{e[l]=C[l]||"MASK"}),a.guardrail.litellm_params.pii_entities_config=e}else if(e.config)try{let l=JSON.parse(e.config);"Bedrock"===e.provider&&l?(l.guardrail_id&&(a.guardrail.litellm_params.guardrailIdentifier=l.guardrail_id),l.guardrail_version&&(a.guardrail.litellm_params.guardrailVersion=l.guardrail_version)):a.guardrail.guardrail_info=l}catch(e){N.ZP.fromBackend("Invalid JSON in configuration"),m(!1);return}if(!r)throw Error("No access token available");console.log("Sending guardrail update data:",JSON.stringify(a));let n=await fetch("/guardrails/".concat(i),{method:"PUT",headers:{[(0,p.getGlobalLitellmHeaderName)()]:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok){let e=await n.text();throw Error(e||"Failed to update guardrail")}N.ZP.success("Guardrail updated successfully"),s(),t()}catch(e){console.error("Failed to update guardrail:",e),N.ZP.fromBackend("Failed to update guardrail: "+(e instanceof Error?e.message:String(e)))}finally{m(!1)}},A=()=>f&&x&&"PresidioPII"===x?(0,n.jsx)(eO,{entities:f.supported_entities,actions:f.supported_actions,selectedEntities:_,selectedActions:C,onEntitySelect:S,onActionSelect:Z,entityCategories:f.pii_entity_categories}):null;return(0,n.jsx)(b.Z,{title:"Edit Guardrail",open:a,onCancel:t,footer:null,width:700,children:(0,n.jsxs)(j.Z,{form:c,layout:"vertical",initialValues:d,children:[(0,n.jsx)(j.Z.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,n.jsx)(e9.o,{placeholder:"Enter a name for this guardrail"})}),(0,n.jsx)(j.Z.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,n.jsx)(h.default,{placeholder:"Select a guardrail provider",onChange:e=>{g(e),c.setFieldsValue({config:void 0}),w([]),k({})},disabled:!0,optionLabelProp:"label",children:Object.entries(ea()).map(e=>{let[l,a]=e;return(0,n.jsx)(ll,{value:l,label:a,children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[eo[a]&&(0,n.jsx)("img",{src:eo[a],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,n.jsx)("span",{children:a})]})},l)})})}),(0,n.jsx)(j.Z.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,n.jsx)(h.default,{children:(null==f?void 0:null===(l=f.supported_modes)||void 0===l?void 0:l.map(e=>(0,n.jsx)(ll,{value:e,children:e},e)))||(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ll,{value:"pre_call",children:"pre_call"}),(0,n.jsx)(ll,{value:"post_call",children:"post_call"})]})})}),(0,n.jsx)(j.Z.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default",valuePropName:"checked",children:(0,n.jsx)(e3.Z,{})}),(()=>{if(!x)return null;if("PresidioPII"===x)return A();switch(x){case"Aporia":return(0,n.jsx)(j.Z.Item,{label:"Aporia Configuration",name:"config",tooltip:"JSON configuration for Aporia",children:(0,n.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_aporia_api_key",\n  "project_name": "your_project_name"\n}'})});case"AimSecurity":return(0,n.jsx)(j.Z.Item,{label:"Aim Security Configuration",name:"config",tooltip:"JSON configuration for Aim Security",children:(0,n.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_aim_api_key"\n}'})});case"Bedrock":return(0,n.jsx)(j.Z.Item,{label:"Amazon Bedrock Configuration",name:"config",tooltip:"JSON configuration for Amazon Bedrock guardrails",children:(0,n.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "guardrail_id": "your_guardrail_id",\n  "guardrail_version": "your_guardrail_version"\n}'})});case"GuardrailsAI":return(0,n.jsx)(j.Z.Item,{label:"Guardrails.ai Configuration",name:"config",tooltip:"JSON configuration for Guardrails.ai",children:(0,n.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_guardrails_api_key",\n  "guardrail_id": "your_guardrail_id"\n}'})});case"LakeraAI":return(0,n.jsx)(j.Z.Item,{label:"Lakera AI Configuration",name:"config",tooltip:"JSON configuration for Lakera AI",children:(0,n.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_lakera_api_key"\n}'})});case"PromptInjection":return(0,n.jsx)(j.Z.Item,{label:"Prompt Injection Configuration",name:"config",tooltip:"JSON configuration for prompt injection detection",children:(0,n.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "threshold": 0.8\n}'})});default:return(0,n.jsx)(j.Z.Item,{label:"Custom Configuration",name:"config",tooltip:"JSON configuration for your custom guardrail",children:(0,n.jsx)(y.default.TextArea,{rows:4,placeholder:'{\n  "key1": "value1",\n  "key2": "value2"\n}'})})}})(),(0,n.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,n.jsx)(e9.z,{variant:"secondary",onClick:t,children:"Cancel"}),(0,n.jsx)(e9.z,{onClick:P,loading:u,children:"Update Guardrail"})]})]})})};(r=i||(i={})).DB="db",r.CONFIG="config";var lt=e=>{let{guardrailsList:l,isLoading:a,onDeleteClick:t,accessToken:r,onGuardrailUpdated:s,isAdmin:d=!1,onGuardrailClick:c}=e,[u,m]=(0,o.useState)([{id:"created_at",desc:!0}]),[x,p]=(0,o.useState)(!1),[g,h]=(0,o.useState)(null),f=e=>e?new Date(e).toLocaleString():"-",j=[{header:"Guardrail ID",accessorKey:"guardrail_id",cell:e=>(0,n.jsx)(eh.Z,{title:String(e.getValue()||""),children:(0,n.jsx)(eU.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>e.getValue()&&c(e.getValue()),children:e.getValue()?"".concat(String(e.getValue()).slice(0,7),"..."):""})})},{header:"Name",accessorKey:"guardrail_name",cell:e=>{let{row:l}=e,a=l.original;return(0,n.jsx)(eh.Z,{title:a.guardrail_name,children:(0,n.jsx)("span",{className:"text-xs font-medium",children:a.guardrail_name||"-"})})}},{header:"Provider",accessorKey:"litellm_params.guardrail",cell:e=>{let{row:l}=e,{logo:a,displayName:t}=ed(l.original.litellm_params.guardrail);return(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[a&&(0,n.jsx)("img",{src:a,alt:"".concat(t," logo"),className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,n.jsx)("span",{className:"text-xs",children:t})]})}},{header:"Mode",accessorKey:"litellm_params.mode",cell:e=>{let{row:l}=e,a=l.original;return(0,n.jsx)("span",{className:"text-xs",children:a.litellm_params.mode})}},{header:"Default On",accessorKey:"litellm_params.default_on",cell:e=>{var l,a;let{row:t}=e,r=t.original;return(0,n.jsx)(e5.C,{color:(null===(l=r.litellm_params)||void 0===l?void 0:l.default_on)?"green":"gray",className:"text-xs font-normal",size:"xs",children:(null===(a=r.litellm_params)||void 0===a?void 0:a.default_on)?"Default On":"Default Off"})}},{header:"Created At",accessorKey:"created_at",cell:e=>{let{row:l}=e,a=l.original;return(0,n.jsx)(eh.Z,{title:a.created_at,children:(0,n.jsx)("span",{className:"text-xs",children:f(a.created_at)})})}},{header:"Updated At",accessorKey:"updated_at",cell:e=>{let{row:l}=e,a=l.original;return(0,n.jsx)(eh.Z,{title:a.updated_at,children:(0,n.jsx)("span",{className:"text-xs",children:f(a.updated_at)})})}},{id:"actions",header:"Actions",cell:e=>{let{row:l}=e,a=l.original,r=a.guardrail_definition_location===i.CONFIG;return(0,n.jsx)("div",{className:"flex space-x-2",children:r?(0,n.jsx)(eh.Z,{title:"Config guardrail cannot be deleted on the dashboard. Please delete it from the config file.",children:(0,n.jsx)(eV.Z,{"data-testid":"config-delete-icon",icon:e0.Z,size:"sm",className:"cursor-not-allowed text-gray-400",title:"Config guardrail cannot be deleted on the dashboard. Please delete it from the config file.","aria-label":"Delete guardrail (config)"})}):(0,n.jsx)(eh.Z,{title:"Delete guardrail",children:(0,n.jsx)(eV.Z,{icon:e0.Z,size:"sm",onClick:()=>a.guardrail_id&&t(a.guardrail_id,a.guardrail_name||"Unnamed Guardrail"),className:"cursor-pointer hover:text-red-500"})})})}}],y=(0,e8.b7)({data:l,columns:j,state:{sorting:u},onSortingChange:m,getCoreRowModel:(0,e6.sC)(),getSortedRowModel:(0,e6.tj)(),enableSorting:!0});return(0,n.jsxs)("div",{className:"rounded-lg custom-border relative",children:[(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)(eY.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,n.jsx)(eQ.Z,{children:y.getHeaderGroups().map(e=>(0,n.jsx)(eX.Z,{children:e.headers.map(e=>(0,n.jsx)(e$.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,e8.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,n.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,n.jsx)(e1.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,n.jsx)(e2.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,n.jsx)(e4.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,n.jsx)(eW.Z,{children:a?(0,n.jsx)(eX.Z,{children:(0,n.jsx)(eH.Z,{colSpan:j.length,className:"h-8 text-center",children:(0,n.jsx)("div",{className:"text-center text-gray-500",children:(0,n.jsx)("p",{children:"Loading..."})})})}):l.length>0?y.getRowModel().rows.map(e=>(0,n.jsx)(eX.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,n.jsx)(eH.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,e8.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,n.jsx)(eX.Z,{children:(0,n.jsx)(eH.Z,{colSpan:j.length,className:"h-8 text-center",children:(0,n.jsx)("div",{className:"text-center text-gray-500",children:(0,n.jsx)("p",{children:"No guardrails found"})})})})})]})}),g&&(0,n.jsx)(la,{visible:x,onClose:()=>p(!1),accessToken:r,onSuccess:()=>{p(!1),h(null),s()},guardrailId:g.guardrail_id||"",initialValues:{guardrail_name:g.guardrail_name||"",provider:Object.keys(et).find(e=>et[e]===(null==g?void 0:g.litellm_params.guardrail))||"",mode:g.litellm_params.mode,default_on:g.litellm_params.default_on,pii_entities_config:g.litellm_params.pii_entities_config,...g.guardrail_info}})]})},lr=a(20347),ls=a(59872),li=a(10900),ln=a(41649),lo=a(12514),ld=a(67101),lc=a(12485),lu=a(18135),lm=a(35242),lx=a(29706),lp=a(77991),lg=a(84264),lh=a(96761),lf=a(30401),lj=a(78867),ly=a(51653),lv=e=>{let{patterns:l,blockedWords:a,readOnly:t=!0,onPatternActionChange:r,onPatternRemove:s,onBlockedWordUpdate:i,onBlockedWordRemove:o}=e;if(0===l.length&&0===a.length)return null;let d=()=>{};return(0,n.jsxs)(n.Fragment,{children:[l.length>0&&(0,n.jsxs)(lo.Z,{className:"mt-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)(lg.Z,{className:"text-lg font-semibold",children:"Pattern Detection"}),(0,n.jsxs)(ln.Z,{color:"blue",children:[l.length," patterns configured"]})]}),(0,n.jsx)(R,{patterns:l,onActionChange:t?d:r||d,onRemove:t?d:s||d})]}),a.length>0&&(0,n.jsxs)(lo.Z,{className:"mt-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)(lg.Z,{className:"text-lg font-semibold",children:"Blocked Keywords"}),(0,n.jsxs)(ln.Z,{color:"blue",children:[a.length," keywords configured"]})]}),(0,n.jsx)(J,{keywords:a,onActionChange:t?d:i||d,onRemove:t?d:o||d})]})]})};let{Text:l_}=g.default;var lb=e=>{var l,a;let{guardrailData:t,guardrailSettings:r,isEditing:s,accessToken:i,onDataChange:d,onUnsavedChanges:c}=e,[u,m]=(0,o.useState)([]),[x,p]=(0,o.useState)([]),[g,h]=(0,o.useState)([]),[f,j]=(0,o.useState)([]),[y,v]=(0,o.useState)([]),[_,b]=(0,o.useState)([]);(0,o.useEffect)(()=>{var e,l,a,s,i;if(null==t?void 0:null===(e=t.litellm_params)||void 0===e?void 0:e.patterns){let e=t.litellm_params.patterns.map((e,l)=>({id:"pattern-".concat(l),type:"prebuilt"===e.pattern_type?"prebuilt":"custom",name:e.pattern_name||e.name,display_name:e.display_name,pattern:e.pattern,action:e.action||"BLOCK"}));m(e),j(e)}else m([]),j([]);if(null==t?void 0:null===(l=t.litellm_params)||void 0===l?void 0:l.blocked_words){let e=t.litellm_params.blocked_words.map((e,l)=>({id:"word-".concat(l),keyword:e.keyword,action:e.action||"BLOCK",description:e.description}));p(e),v(e)}else p([]),v([]);if((null==t?void 0:null===(s=t.litellm_params)||void 0===s?void 0:null===(a=s.categories)||void 0===a?void 0:a.length)>0){let e=(null==r?void 0:null===(i=r.content_filter_settings)||void 0===i?void 0:i.content_categories)?Object.fromEntries(r.content_filter_settings.content_categories.map(e=>[e.name,e])):{},l=t.litellm_params.categories.map((l,a)=>{var t;let r=e[l.category];return{id:"category-".concat(a),category:l.category,display_name:null!==(t=null==r?void 0:r.display_name)&&void 0!==t?t:l.category,action:l.action||"BLOCK",severity_threshold:l.severity_threshold||"medium"}});h(l),b(l)}else h([]),b([])},[t,null==r?void 0:null===(l=r.content_filter_settings)||void 0===l?void 0:l.content_categories]),(0,o.useEffect)(()=>{d&&d(u,x,g)},[u,x,g,d]);let N=o.useMemo(()=>{let e=JSON.stringify(u)!==JSON.stringify(f),l=JSON.stringify(x)!==JSON.stringify(y),a=JSON.stringify(g)!==JSON.stringify(_);return e||l||a},[u,x,g,f,y,_]);return((0,o.useEffect)(()=>{s&&c&&c(N)},[N,s,c]),(null==t?void 0:null===(a=t.litellm_params)||void 0===a?void 0:a.guardrail)!=="litellm_content_filter")?null:s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eL.Z,{orientation:"left",children:"Content Filter Configuration"}),N&&(0,n.jsx)(ly.Z,{type:"warning",showIcon:!0,className:"mb-4",message:(0,n.jsx)(l_,{children:'You have unsaved changes to patterns or keywords. Remember to click "Save Changes" at the bottom.'})}),(0,n.jsx)("div",{className:"mb-6",children:r&&r.content_filter_settings&&(0,n.jsx)(X,{prebuiltPatterns:r.content_filter_settings.prebuilt_patterns||[],categories:r.content_filter_settings.pattern_categories||[],selectedPatterns:u,blockedWords:x,onPatternAdd:e=>m([...u,e]),onPatternRemove:e=>m(u.filter(l=>l.id!==e)),onPatternActionChange:(e,l)=>m(u.map(a=>a.id===e?{...a,action:l}:a)),onBlockedWordAdd:e=>p([...x,e]),onBlockedWordRemove:e=>p(x.filter(l=>l.id!==e)),onBlockedWordUpdate:(e,l,a)=>p(x.map(t=>t.id===e?{...t,[l]:a}:t)),onFileUpload:e=>{console.log("File uploaded:",e)},accessToken:i,contentCategories:r.content_filter_settings.content_categories||[],selectedContentCategories:g,onContentCategoryAdd:e=>h([...g,e]),onContentCategoryRemove:e=>h(g.filter(l=>l.id!==e)),onContentCategoryUpdate:(e,l,a)=>h(g.map(t=>t.id===e?{...t,[l]:a}:t))})})]}):(0,n.jsx)(lv,{patterns:u,blockedWords:x,readOnly:!0})};let lN=(e,l,a)=>{let t={patterns:e.map(e=>({pattern_type:"prebuilt"===e.type?"prebuilt":"regex",pattern_name:"prebuilt"===e.type?e.name:void 0,pattern:"custom"===e.type?e.pattern:void 0,name:e.name,action:e.action})),blocked_words:l.map(e=>({keyword:e.keyword,action:e.action,description:e.description}))};return void 0!==a&&(t.categories=a.map(e=>({category:e.category,enabled:!0,action:e.action,severity_threshold:e.severity_threshold||"medium"}))),t};var lw=a(83683),lC=a(11741),lk=a(28291),lS=a(28595),lZ=a(81770),lP=a(83669),lA=a(78355);let{Panel:lO}=q.default,{TextArea:lI}=y.default,lL={empty:{name:"Empty Template",code:'async def apply_guardrail(inputs, request_data, input_type):\n    # inputs: {texts, images, tools, tool_calls, structured_messages, model}\n    # request_data: {model, user_id, team_id, end_user_id, metadata}\n    # input_type: "request" or "response"\n    return allow()'},blockSSN:{name:"Block SSN",code:'def apply_guardrail(inputs, request_data, input_type):\n    for text in inputs["texts"]:\n        if regex_match(text, r"\\d{3}-\\d{2}-\\d{4}"):\n            return block("SSN detected")\n    return allow()'},redactEmail:{name:"Redact Emails",code:'def apply_guardrail(inputs, request_data, input_type):\n    pattern = r"[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"\n    modified = []\n    for text in inputs["texts"]:\n        modified.append(regex_replace(text, pattern, "[EMAIL REDACTED]"))\n    return modify(texts=modified)'},blockSQL:{name:"Block SQL Injection",code:'def apply_guardrail(inputs, request_data, input_type):\n    if input_type != "request":\n        return allow()\n    for text in inputs["texts"]:\n        if contains_code_language(text, ["sql"]):\n            return block("SQL code not allowed")\n    return allow()'},validateJSON:{name:"Validate JSON",code:'def apply_guardrail(inputs, request_data, input_type):\n    if input_type != "response":\n        return allow()\n    \n    schema = {"type": "object", "required": ["name", "value"]}\n    \n    for text in inputs["texts"]:\n        obj = json_parse(text)\n        if obj is None:\n            return block("Invalid JSON response")\n        if not json_schema_valid(obj, schema):\n            return block("Response missing required fields")\n    return allow()'},externalAPI:{name:"External API Check (async)",code:'async def apply_guardrail(inputs, request_data, input_type):\n    # Call an external moderation API (async for non-blocking)\n    for text in inputs["texts"]:\n        response = await http_post(\n            "https://api.example.com/moderate",\n            body={"text": text, "user_id": request_data["user_id"]},\n            headers={"Authorization": "Bearer YOUR_API_KEY"},\n            timeout=10\n        )\n        \n        if not response["success"]:\n            # API call failed, allow by default or block\n            return allow()\n        \n        if response["body"].get("flagged"):\n            return block(response["body"].get("reason", "Content flagged"))\n    \n    return allow()'}},lT={"Return Values":[{name:"allow()",desc:"Let request/response through"},{name:"block(reason)",desc:"Reject with message"},{name:"modify(texts=[], images=[], tool_calls=[])",desc:"Transform content"}],"HTTP Requests (async)":[{name:"await http_request(url, method, headers, body)",desc:"Make async HTTP request"},{name:"await http_get(url, headers)",desc:"Async GET request"},{name:"await http_post(url, body, headers)",desc:"Async POST request"}],"Regex Functions":[{name:"regex_match(text, pattern)",desc:"Returns True if pattern found"},{name:"regex_replace(text, pattern, replacement)",desc:"Replace all matches"},{name:"regex_find_all(text, pattern)",desc:"Return list of matches"}],"JSON Functions":[{name:"json_parse(text)",desc:"Parse JSON string, returns None on error"},{name:"json_stringify(obj)",desc:"Convert to JSON string"},{name:"json_schema_valid(obj, schema)",desc:"Validate against JSON schema"}],"URL Functions":[{name:"extract_urls(text)",desc:"Extract all URLs from text"},{name:"is_valid_url(url)",desc:"Check if URL is valid"},{name:"all_urls_valid(text)",desc:"Check all URLs in text are valid"}],"Code Detection":[{name:"detect_code(text)",desc:"Returns True if code detected"},{name:"detect_code_languages(text)",desc:"Returns list of detected languages"},{name:'contains_code_language(text, ["sql"])',desc:"Check for specific languages"}],"Text Utilities":[{name:"contains(text, substring)",desc:"Check if substring exists"},{name:"contains_any(text, [substr1, substr2])",desc:"Check if any substring exists"},{name:"word_count(text)",desc:"Count words"},{name:"char_count(text)",desc:"Count characters"},{name:"lower(text) / upper(text) / trim(text)",desc:"String transforms"}]},lE=[{value:"pre_call",label:"pre_call (Request)"},{value:"post_call",label:"post_call (Response)"},{value:"during_call",label:"during_call (Parallel)"},{value:"logging_only",label:"logging_only"},{value:"pre_mcp_call",label:"pre_mcp_call (Before MCP Tool Call)"},{value:"post_mcp_call",label:"post_mcp_call (After MCP Tool Call)"},{value:"during_mcp_call",label:"during_mcp_call (During MCP Tool Call)"}];var lB=e=>{let{visible:l,onClose:a,onSuccess:t,accessToken:r,editData:s}=e,i=!!s,[d,c]=(0,o.useState)(""),[u,x]=(0,o.useState)(["pre_call"]),[g,f]=(0,o.useState)(!1),[j,y]=(0,o.useState)("empty"),[v,_]=(0,o.useState)(lL.empty.code),[w,C]=(0,o.useState)(!1),[k,S]=(0,o.useState)(!1),[Z,P]=(0,o.useState)(!1),A={texts:["Hello, my SSN is 123-45-6789"],images:[],tools:[{type:"function",function:{name:"get_weather",description:"Get the current weather in a location",parameters:{type:"object",properties:{location:{type:"string",description:"City name"}},required:["location"]}}}],tool_calls:[],structured_messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:"Hello, my SSN is 123-45-6789"}],model:"gpt-4"},O={texts:["The weather in San Francisco is 72\xb0F and sunny."],images:[],tools:[],tool_calls:[{id:"call_abc123",type:"function",function:{name:"get_weather",arguments:'{"location": "San Francisco"}'}}],structured_messages:[],model:"gpt-4"},[I,L]=(0,o.useState)(JSON.stringify(A,null,2)),[T,E]=(0,o.useState)(null),[B,z]=(0,o.useState)(null),F=(0,o.useRef)(null),M=e=>null==e?["pre_call"]:Array.isArray(e)?e.length?e:["pre_call"]:[e];(0,o.useEffect)(()=>{if(l){if(s){var e,a,t;c(s.guardrail_name||""),x(M(null===(e=s.litellm_params)||void 0===e?void 0:e.mode)),f((null===(a=s.litellm_params)||void 0===a?void 0:a.default_on)||!1),_((null===(t=s.litellm_params)||void 0===t?void 0:t.custom_code)||lL.empty.code),y("")}else c(""),x(["pre_call"]),f(!1),y("empty"),_(lL.empty.code);E(null),P(!1)}},[l,s]);let G=async e=>{try{await navigator.clipboard.writeText(e),z(e),setTimeout(()=>z(null),2e3)}catch(e){console.error("Failed to copy:",e)}},R=async()=>{if(!d.trim()){N.ZP.fromBackend("Please enter a guardrail name");return}if(!v.trim()){N.ZP.fromBackend("Please enter custom code");return}if(!r){N.ZP.fromBackend("No access token available");return}C(!0);try{if(i&&s){var e,l;let a={litellm_params:{custom_code:v}};d!==s.guardrail_name&&(a.guardrail_name=d);let t=M(null===(e=s.litellm_params)||void 0===e?void 0:e.mode);(u.length!==t.length||u.some((e,l)=>e!==t[l]))&&(a.litellm_params.mode=u),g!==(null===(l=s.litellm_params)||void 0===l?void 0:l.default_on)&&(a.litellm_params.default_on=g),await (0,p.updateGuardrailCall)(r,s.guardrail_id,a),N.ZP.success("Custom code guardrail updated successfully")}else await (0,p.createGuardrailCall)(r,{guardrail_name:d,litellm_params:{guardrail:"custom_code",mode:u,default_on:g,custom_code:v},guardrail_info:{}}),N.ZP.success("Custom code guardrail created successfully");t(),a()}catch(e){console.error("Failed to save guardrail:",e),N.ZP.fromBackend("Failed to ".concat(i?"update":"create"," guardrail: ")+(e instanceof Error?e.message:String(e)))}finally{C(!1)}},K=async()=>{if(!r){E({error:"No access token available"});return}S(!0),E(null);try{let e;try{e=JSON.parse(I)}catch(e){E({error:"Invalid test input JSON"}),S(!1);return}e.texts||(e.texts=[]);let l=["pre_call","pre_mcp_call"],a=["post_call","post_mcp_call"],t=u.some(e=>l.includes(e))?"request":u.some(e=>a.includes(e))?"response":"request",s=await (0,p.testCustomCodeGuardrail)(r,{custom_code:v,test_input:e,input_type:t,request_data:{model:"test-model",metadata:{}}});s.success&&s.result?E(s.result):s.error?E({error:s.error,error_type:s.error_type}):E({error:"Unknown error occurred"})}catch(e){console.error("Failed to test custom code:",e),E({error:e instanceof Error?e.message:"Failed to test custom code"})}finally{S(!1)}},D=v.split("\n").length;return(0,n.jsxs)(b.Z,{open:l,onCancel:a,footer:null,width:1400,className:"custom-code-modal",closable:!0,destroyOnClose:!0,children:[(0,n.jsxs)("div",{className:"flex flex-col h-[80vh]",children:[(0,n.jsxs)("div",{className:"pb-4 border-b border-gray-200",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:i?"Edit Custom Guardrail":"Create Custom Guardrail"}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Define custom logic using Python-like syntax"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4 py-4 border-b border-gray-100",children:[(0,n.jsxs)("div",{className:"flex-1 max-w-[200px]",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Guardrail Name"}),(0,n.jsx)(e9.o,{value:d,onValueChange:c,placeholder:"e.g., block-pii-custom"})]}),(0,n.jsxs)("div",{className:"w-[280px]",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Mode (can select multiple)"}),(0,n.jsx)(h.default,{mode:"multiple",value:u,onChange:x,options:lE,className:"w-full",size:"middle",placeholder:"Select modes"})]}),(0,n.jsxs)("div",{className:"w-[180px]",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Template"}),(0,n.jsx)(h.default,{value:j,onChange:e=>{y(e),_(lL[e].code)},className:"w-full",size:"middle",dropdownRender:e=>(0,n.jsxs)(n.Fragment,{children:[e,(0,n.jsx)(eL.Z,{style:{margin:"8px 0"}}),(0,n.jsxs)("div",{style:{padding:"8px 12px",cursor:"pointer",color:"#1890ff",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},onClick:e=>{e.preventDefault(),window.open("https://models.litellm.ai/guardrails","_blank")},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f0f0f0"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[(0,n.jsx)(lw.Z,{}),(0,n.jsx)("span",{children:"Browse Community templates"}),(0,n.jsx)(lC.Z,{style:{fontSize:"10px"}})]})]}),children:(0,n.jsx)(h.default.OptGroup,{label:"STANDARD",children:Object.entries(lL).map(e=>{let[l,a]=e;return(0,n.jsx)(h.default.Option,{value:l,children:a.name},l)})})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 pt-5",children:[(0,n.jsx)("span",{className:"text-sm text-gray-600",children:"Default On"}),(0,n.jsx)(e3.Z,{checked:g,onChange:f})]})]}),(0,n.jsxs)("div",{className:"flex flex-1 overflow-hidden mt-4 gap-6",children:[(0,n.jsxs)("div",{className:"flex-[2] flex flex-col min-w-0 overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2 flex-shrink-0",children:[(0,n.jsx)("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Python Logic"}),(0,n.jsx)("span",{className:"text-xs text-gray-400",children:"Restricted environment (no imports)"})]}),(0,n.jsxs)("div",{className:"relative rounded-lg overflow-hidden border border-gray-700 bg-[#1e1e1e] flex-shrink-0",style:{minHeight:"300px",maxHeight:"400px"},children:[(0,n.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-12 bg-[#1e1e1e] border-r border-gray-700 text-right pr-3 pt-3 select-none overflow-hidden",style:{fontFamily:"'Fira Code', 'Monaco', 'Consolas', monospace",fontSize:"14px",lineHeight:"1.6"},children:Array.from({length:Math.max(D,20)},(e,l)=>(0,n.jsx)("div",{className:"text-gray-500 h-[22.4px]",children:l+1},l+1))}),(0,n.jsx)("textarea",{ref:F,value:v,onChange:e=>_(e.target.value),onKeyDown:e=>{if("Tab"===e.key){e.preventDefault();let l=e.currentTarget,a=l.selectionStart,t=l.selectionEnd;_(v.substring(0,a)+"    "+v.substring(t)),setTimeout(()=>{l.selectionStart=l.selectionEnd=a+4},0)}},spellCheck:!1,className:"w-full h-full pl-14 pr-4 pt-3 pb-3 resize-none focus:outline-none bg-transparent text-gray-200",style:{fontFamily:"'Fira Code', 'Monaco', 'Consolas', monospace",fontSize:"14px",lineHeight:"1.6",tabSize:4}})]}),(0,n.jsx)(q.default,{activeKey:Z?["test"]:[],onChange:e=>P(e.includes("test")),className:"mt-3 bg-white border border-gray-200 rounded-lg flex-shrink-0",expandIcon:e=>{let{isActive:l}=e;return(0,n.jsx)(lk.Z,{rotate:l?90:0})},children:(0,n.jsx)(lO,{header:(0,n.jsxs)("span",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,n.jsx)(lS.Z,{className:"text-blue-500"}),"Test Your Guardrail"]}),children:(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-600",children:"Test Input (JSON)"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-xs text-gray-500",children:"Load example:"}),(0,n.jsx)("button",{type:"button",onClick:()=>L(JSON.stringify(A,null,2)),className:"px-2 py-1 text-xs rounded border border-orange-200 bg-orange-50 text-orange-700 hover:bg-orange-100 transition-colors",children:"Pre-call"}),(0,n.jsx)("button",{type:"button",onClick:()=>L(JSON.stringify(O,null,2)),className:"px-2 py-1 text-xs rounded border border-green-200 bg-green-50 text-green-700 hover:bg-green-100 transition-colors",children:"Post-call"})]})]}),(0,n.jsx)("div",{className:"mb-2 p-2 bg-gray-50 rounded text-xs text-gray-600 border border-gray-200",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"texts"}),": Message content (always)"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"images"}),": Base64 images (vision)"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"tools"}),": Tool definitions ",(0,n.jsx)("span",{className:"text-orange-600",children:"(pre_call)"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"tool_calls"}),": LLM tool calls ",(0,n.jsx)("span",{className:"text-green-600",children:"(post_call)"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"structured_messages"}),": Full messages ",(0,n.jsx)("span",{className:"text-orange-600",children:"(pre_call)"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"model"}),": Model name (always)"]})]})}),(0,n.jsx)(lI,{value:I,onChange:e=>L(e.target.value),rows:8,className:"font-mono text-xs",placeholder:'{"texts": ["test message"], ...}'})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(e9.z,{size:"xs",onClick:K,disabled:k,icon:lS.Z,children:k?"Running...":"Run Test"}),T&&(0,n.jsx)("div",{className:"flex items-center gap-2 text-sm ".concat(T.error?"text-red-600":"allow"===T.action?"text-green-600":"block"===T.action?"text-orange-600":"text-blue-600"),children:T.error?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(lZ.Z,{}),(0,n.jsxs)("span",{children:[T.error_type&&(0,n.jsxs)("span",{className:"font-medium",children:["[",T.error_type,"] "]}),T.error]})]}):"allow"===T.action?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(lP.Z,{})," Allowed"]}):"block"===T.action?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(lZ.Z,{})," Blocked: ",T.reason]}):"modify"===T.action?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(lP.Z,{})," Modified",T.texts&&T.texts.length>0&&(0,n.jsxs)("span",{className:"text-xs text-gray-500 ml-1",children:["â†’ ",T.texts[0].substring(0,50),T.texts[0].length>50?"...":""]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(lP.Z,{})," ",T.action||"Unknown"]})})]})]})},"test")}),(0,n.jsxs)("div",{className:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg flex items-center justify-between flex-shrink-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"bg-blue-100 rounded-full p-2",children:(0,n.jsx)(lw.Z,{className:"text-blue-600 text-lg"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Built a useful guardrail?"}),(0,n.jsx)("div",{className:"text-xs text-gray-600",children:"Share it with the community and help others build faster"})]})]}),(0,n.jsx)(e9.z,{size:"xs",onClick:()=>window.open("https://github.com/BerriAI/litellm-guardrails","_blank"),icon:lC.Z,className:"bg-blue-600 hover:bg-blue-700 text-white border-0",children:"Contribute Template"})]})]}),(0,n.jsxs)("div",{className:"w-[300px] flex-shrink-0 overflow-auto border-l border-gray-200 pl-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,n.jsx)(m.Z,{className:"text-blue-500"}),(0,n.jsx)("span",{className:"font-semibold text-gray-700",children:"Available Primitives"})]}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:"Click to copy functions to clipboard"}),(0,n.jsx)(q.default,{defaultActiveKey:["Return Values"],className:"primitives-collapse bg-transparent border-0",expandIconPosition:"end",children:Object.entries(lT).map(e=>{let[l,a]=e;return(0,n.jsx)(lO,{header:(0,n.jsx)("span",{className:"text-sm font-medium text-gray-700",children:l}),className:"bg-white mb-2 rounded-lg border border-gray-200",children:(0,n.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,n.jsx)("button",{onClick:()=>G(e.name),className:"w-full text-left px-2 py-2 rounded transition-colors ".concat(B===e.name?"bg-green-100":"bg-gray-50 hover:bg-blue-50"),children:B===e.name?(0,n.jsxs)("span",{className:"flex items-center gap-1 text-xs font-mono text-green-700",children:[(0,n.jsx)(lP.Z,{})," Copied!"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"text-xs font-mono text-gray-800",children:e.name}),(0,n.jsx)("div",{className:"text-[10px] text-gray-500 mt-0.5",children:e.desc})]})},e.name))})},l)})})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between pt-4 mt-4 border-t border-gray-200",children:[(0,n.jsx)("span",{className:"text-xs text-gray-400",children:"Changes are auto-saved to local draft"}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(e9.z,{variant:"secondary",onClick:a,children:"Cancel"}),(0,n.jsx)(e9.z,{onClick:R,loading:w,disabled:w||!d.trim(),icon:lA.Z,children:i?"Update Guardrail":"Save Guardrail"})]})]})]}),(0,n.jsx)("style",{children:"\n        .custom-code-modal .ant-modal-content {\n          padding: 24px;\n        }\n        .custom-code-modal .ant-modal-close {\n          top: 20px;\n          right: 20px;\n        }\n        .primitives-collapse .ant-collapse-item {\n          border: none !important;\n        }\n        .primitives-collapse .ant-collapse-header {\n          padding: 8px 12px !important;\n        }\n        .primitives-collapse .ant-collapse-content-box {\n          padding: 8px 12px !important;\n        }\n      "})]})},lz=e=>{var l,a,t,r,s,i,d,c,u,x,g,f,v,b,w,C,k,S,Z,P;let{guardrailId:A,onClose:O,accessToken:I,isAdmin:L}=e,[T,E]=(0,o.useState)(null),[B,z]=(0,o.useState)(null),[F,M]=(0,o.useState)(!0),[G,R]=(0,o.useState)(!1),[K]=j.Z.useForm(),[D,J]=(0,o.useState)([]),[q,U]=(0,o.useState)({}),[V,Y]=(0,o.useState)(null),[W,H]=(0,o.useState)({}),[Q,$]=(0,o.useState)(!1),X={rules:[],default_action:"deny",on_disallowed_action:"block",violation_message_template:""},[ee,el]=(0,o.useState)(X),[ea,er]=(0,o.useState)(!1),[es,ei]=(0,o.useState)(!1),en=o.useRef({patterns:[],blockedWords:[],categories:[]}),eo=(0,o.useCallback)((e,l,a)=>{en.current={patterns:e,blockedWords:l,categories:a||[]}},[]),ec=async()=>{try{var e;if(M(!0),!I)return;let l=await (0,p.getGuardrailInfo)(I,A);if(E(l),null===(e=l.litellm_params)||void 0===e?void 0:e.pii_entities_config){let e=l.litellm_params.pii_entities_config;if(J([]),U({}),Object.keys(e).length>0){let l=[],a={};Object.entries(e).forEach(e=>{let[t,r]=e;l.push(t),a[t]="string"==typeof r?r:"MASK"}),J(l),U(a)}}else J([]),U({})}catch(e){N.ZP.fromBackend("Failed to load guardrail information"),console.error("Error fetching guardrail info:",e)}finally{M(!1)}},eu=async()=>{try{if(!I)return;let e=await (0,p.getGuardrailProviderSpecificParams)(I);z(e)}catch(e){console.error("Error fetching guardrail provider specific params:",e)}},em=async()=>{try{if(!I)return;let e=await (0,p.getGuardrailUISettings)(I);Y(e)}catch(e){console.error("Error fetching guardrail UI settings:",e)}};(0,o.useEffect)(()=>{eu()},[I]),(0,o.useEffect)(()=>{ec(),em()},[A,I]),(0,o.useEffect)(()=>{if(T&&K){var e;K.setFieldsValue({guardrail_name:T.guardrail_name,...T.litellm_params,guardrail_info:T.guardrail_info?JSON.stringify(T.guardrail_info,null,2):"",...(null===(e=T.litellm_params)||void 0===e?void 0:e.optional_params)&&{optional_params:T.litellm_params.optional_params}})}},[T,B,K]);let ep=(0,o.useCallback)(()=>{var e,l,a,t,r;(null==T?void 0:null===(e=T.litellm_params)||void 0===e?void 0:e.guardrail)==="tool_permission"?el({rules:(null===(l=T.litellm_params)||void 0===l?void 0:l.rules)||[],default_action:((null===(a=T.litellm_params)||void 0===a?void 0:a.default_action)||"deny").toLowerCase(),on_disallowed_action:((null===(t=T.litellm_params)||void 0===t?void 0:t.on_disallowed_action)||"block").toLowerCase(),violation_message_template:(null===(r=T.litellm_params)||void 0===r?void 0:r.violation_message_template)||""}):el(X),er(!1)},[T]);(0,o.useEffect)(()=>{ep()},[ep]);let ef=async e=>{try{var l,a,t,r,s,i,n,o,d,c;if(!I)return;let u={litellm_params:{}};e.guardrail_name!==T.guardrail_name&&(u.guardrail_name=e.guardrail_name),e.default_on!==(null===(l=T.litellm_params)||void 0===l?void 0:l.default_on)&&(u.litellm_params.default_on=e.default_on);let m=T.guardrail_info,x=e.guardrail_info?JSON.parse(e.guardrail_info):void 0;JSON.stringify(m)!==JSON.stringify(x)&&(u.guardrail_info=x);let g=(null===(a=T.litellm_params)||void 0===a?void 0:a.pii_entities_config)||{},h={};if(D.forEach(e=>{h[e]=q[e]||"MASK"}),JSON.stringify(g)!==JSON.stringify(h)&&(u.litellm_params.pii_entities_config=h),(null===(t=T.litellm_params)||void 0===t?void 0:t.guardrail)==="litellm_content_filter"&&Q){let e=lN(en.current.patterns||[],en.current.blockedWords||[],en.current.categories||[]);u.litellm_params.patterns=e.patterns,u.litellm_params.blocked_words=e.blocked_words,u.litellm_params.categories=e.categories}if((null===(r=T.litellm_params)||void 0===r?void 0:r.guardrail)==="tool_permission"){let e=(null===(i=T.litellm_params)||void 0===i?void 0:i.rules)||[],l=ee.rules||[],a=JSON.stringify(e)!==JSON.stringify(l),t=((null===(n=T.litellm_params)||void 0===n?void 0:n.default_action)||"deny").toLowerCase(),r=(ee.default_action||"deny").toLowerCase(),s=t!==r,c=((null===(o=T.litellm_params)||void 0===o?void 0:o.on_disallowed_action)||"block").toLowerCase(),m=(ee.on_disallowed_action||"block").toLowerCase(),x=c!==m,p=(null===(d=T.litellm_params)||void 0===d?void 0:d.violation_message_template)||"",g=ee.violation_message_template||"",h=p!==g;(ea||a||s||x||h)&&(u.litellm_params.rules=l,u.litellm_params.default_action=r,u.litellm_params.on_disallowed_action=m,u.litellm_params.violation_message_template=g||null)}let f=Object.keys(et).find(e=>{var l;return et[e]===(null===(l=T.litellm_params)||void 0===l?void 0:l.guardrail)});console.log("values: ",JSON.stringify(e)),console.log("currentProvider: ",f);let j=(null===(s=T.litellm_params)||void 0===s?void 0:s.guardrail)==="tool_permission";if(B&&f&&!j){let l=B[null===(c=et[f])||void 0===c?void 0:c.toLowerCase()]||{},a=new Set;console.log("providerSpecificParams: ",JSON.stringify(l)),Object.keys(l).forEach(e=>{"optional_params"!==e&&a.add(e)}),l.optional_params&&l.optional_params.fields&&Object.keys(l.optional_params.fields).forEach(e=>{a.add(e)}),console.log("allowedParams: ",a),a.forEach(l=>{var a,t;if("patterns"===l||"blocked_words"===l||"categories"===l)return;let r=e[l];(null==r||""===r)&&(r=null===(t=e.optional_params)||void 0===t?void 0:t[l]);let s=null===(a=T.litellm_params)||void 0===a?void 0:a[l];JSON.stringify(r)!==JSON.stringify(s)&&(null!=r&&""!==r?u.litellm_params[l]=r:null!=s&&""!==s&&(u.litellm_params[l]=null))})}if(0===Object.keys(u.litellm_params).length&&delete u.litellm_params,0===Object.keys(u).length){N.ZP.info("No changes detected"),R(!1);return}await (0,p.updateGuardrailCall)(I,A,u),N.ZP.success("Guardrail updated successfully"),$(!1),ec(),R(!1)}catch(e){console.error("Error updating guardrail:",e),N.ZP.fromBackend("Failed to update guardrail")}};if(F)return(0,n.jsx)("div",{className:"p-4",children:"Loading..."});if(!T)return(0,n.jsx)("div",{className:"p-4",children:"Guardrail not found"});let ev=e=>e?new Date(e).toLocaleString():"-",{logo:e_,displayName:eb}=ed((null===(l=T.litellm_params)||void 0===l?void 0:l.guardrail)||""),eN=async(e,l)=>{await (0,ls.vQ)(e)&&(H(e=>({...e,[l]:!0})),setTimeout(()=>{H(e=>({...e,[l]:!1}))},2e3))},ew="config"===T.guardrail_definition_location;return(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(_.ZP,{type:"text",icon:(0,n.jsx)(li.Z,{className:"w-4 h-4"}),onClick:O,className:"mb-4",children:"Back to Guardrails"}),(0,n.jsx)(lh.Z,{children:T.guardrail_name||"Unnamed Guardrail"}),(0,n.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,n.jsx)(lg.Z,{className:"text-gray-500 font-mono",children:T.guardrail_id}),(0,n.jsx)(_.ZP,{type:"text",size:"small",icon:W["guardrail-id"]?(0,n.jsx)(lf.Z,{size:12}):(0,n.jsx)(lj.Z,{size:12}),onClick:()=>eN(T.guardrail_id,"guardrail-id"),className:"left-2 z-10 transition-all duration-200 ".concat(W["guardrail-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),(0,n.jsxs)(lu.Z,{children:[(0,n.jsxs)(lm.Z,{className:"mb-4",children:[(0,n.jsx)(lc.Z,{children:"Overview"},"overview"),L?(0,n.jsx)(lc.Z,{children:"Settings"},"settings"):(0,n.jsx)(n.Fragment,{})]}),(0,n.jsxs)(lp.Z,{children:[(0,n.jsxs)(lx.Z,{children:[(0,n.jsxs)(ld.Z,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,n.jsxs)(lo.Z,{children:[(0,n.jsx)(lg.Z,{children:"Provider"}),(0,n.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[e_&&(0,n.jsx)("img",{src:e_,alt:"".concat(eb," logo"),className:"w-6 h-6",onError:e=>{e.target.style.display="none"}}),(0,n.jsx)(lh.Z,{children:eb})]})]}),(0,n.jsxs)(lo.Z,{children:[(0,n.jsx)(lg.Z,{children:"Mode"}),(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsx)(lh.Z,{children:(null===(a=T.litellm_params)||void 0===a?void 0:a.mode)||"-"}),(0,n.jsx)(ln.Z,{color:(null===(t=T.litellm_params)||void 0===t?void 0:t.default_on)?"green":"gray",children:(null===(r=T.litellm_params)||void 0===r?void 0:r.default_on)?"Default On":"Default Off"})]})]}),(0,n.jsxs)(lo.Z,{children:[(0,n.jsx)(lg.Z,{children:"Created At"}),(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsx)(lh.Z,{children:ev(T.created_at)}),(0,n.jsxs)(lg.Z,{children:["Last Updated: ",ev(T.updated_at)]})]})]})]}),(null===(s=T.litellm_params)||void 0===s?void 0:s.pii_entities_config)&&Object.keys(T.litellm_params.pii_entities_config).length>0&&(0,n.jsx)(lo.Z,{className:"mt-6",children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)(lg.Z,{className:"font-medium",children:"PII Protection"}),(0,n.jsxs)(ln.Z,{color:"blue",children:[Object.keys(T.litellm_params.pii_entities_config).length," PII entities configured"]})]})}),(null===(i=T.litellm_params)||void 0===i?void 0:i.pii_entities_config)&&Object.keys(T.litellm_params.pii_entities_config).length>0&&(0,n.jsxs)(lo.Z,{className:"mt-6",children:[(0,n.jsx)(lg.Z,{className:"mb-4 text-lg font-semibold",children:"PII Entity Configuration"}),(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[(0,n.jsxs)("div",{className:"bg-gray-50 px-5 py-3 border-b flex",children:[(0,n.jsx)(lg.Z,{className:"flex-1 font-semibold text-gray-700",children:"Entity Type"}),(0,n.jsx)(lg.Z,{className:"flex-1 font-semibold text-gray-700",children:"Configuration"})]}),(0,n.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:Object.entries(null===(d=T.litellm_params)||void 0===d?void 0:d.pii_entities_config).map(e=>{let[l,a]=e;return(0,n.jsxs)("div",{className:"px-5 py-3 flex border-b hover:bg-gray-50 transition-colors",children:[(0,n.jsx)(lg.Z,{className:"flex-1 font-medium text-gray-900",children:l}),(0,n.jsx)(lg.Z,{className:"flex-1",children:(0,n.jsxs)("span",{className:"inline-flex items-center gap-1.5 ".concat("MASK"===a?"text-blue-600":"text-red-600"),children:["MASK"===a?(0,n.jsx)(ej.Z,{}):(0,n.jsx)(ey.Z,{}),String(a)]})})]},l)})})]})]}),(null===(c=T.litellm_params)||void 0===c?void 0:c.guardrail)==="tool_permission"&&(0,n.jsx)(lo.Z,{className:"mt-6",children:(0,n.jsx)(eF,{value:ee,disabled:!0})}),(null===(u=T.litellm_params)||void 0===u?void 0:u.guardrail)==="custom_code"&&(null===(x=T.litellm_params)||void 0===x?void 0:x.custom_code)&&(0,n.jsxs)(lo.Z,{className:"mt-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(m.Z,{className:"text-blue-500"}),(0,n.jsx)(lg.Z,{className:"font-medium text-lg",children:"Custom Code"})]}),L&&!ew&&(0,n.jsx)(_.ZP,{size:"small",icon:(0,n.jsx)(m.Z,{}),onClick:()=>ei(!0),children:"Edit Code"})]}),(0,n.jsx)("div",{className:"relative rounded-lg overflow-hidden border border-gray-700 bg-[#1e1e1e]",children:(0,n.jsx)("pre",{className:"p-4 text-sm text-gray-200 overflow-x-auto",style:{fontFamily:"'Fira Code', 'Monaco', 'Consolas', monospace"},children:(0,n.jsx)("code",{children:T.litellm_params.custom_code})})})]}),(0,n.jsx)(lb,{guardrailData:T,guardrailSettings:V,isEditing:!1,accessToken:I})]}),L&&(0,n.jsx)(lx.Z,{children:(0,n.jsxs)(lo.Z,{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)(lh.Z,{children:"Guardrail Settings"}),ew&&(0,n.jsx)(eh.Z,{title:"Guardrail is defined in the config file and cannot be edited.",children:(0,n.jsx)(eE.Z,{})}),!G&&!ew&&((null===(g=T.litellm_params)||void 0===g?void 0:g.guardrail)==="custom_code"?(0,n.jsx)(_.ZP,{icon:(0,n.jsx)(m.Z,{}),onClick:()=>ei(!0),children:"Edit Code"}):(0,n.jsx)(_.ZP,{onClick:()=>R(!0),children:"Edit Settings"}))]}),G?(0,n.jsxs)(j.Z,{form:K,onFinish:ef,initialValues:{guardrail_name:T.guardrail_name,...T.litellm_params,guardrail_info:T.guardrail_info?JSON.stringify(T.guardrail_info,null,2):"",...(null===(f=T.litellm_params)||void 0===f?void 0:f.optional_params)&&{optional_params:T.litellm_params.optional_params}},layout:"vertical",children:[(0,n.jsx)(j.Z.Item,{label:"Guardrail Name",name:"guardrail_name",rules:[{required:!0,message:"Please input a guardrail name"}],children:(0,n.jsx)(y.default,{placeholder:"Enter guardrail name"})}),(0,n.jsx)(j.Z.Item,{label:"Default On",name:"default_on",children:(0,n.jsxs)(h.default,{children:[(0,n.jsx)(h.default.Option,{value:!0,children:"Yes"}),(0,n.jsx)(h.default.Option,{value:!1,children:"No"})]})}),(null===(v=T.litellm_params)||void 0===v?void 0:v.guardrail)==="presidio"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eL.Z,{orientation:"left",children:"PII Protection"}),(0,n.jsx)("div",{className:"mb-6",children:V&&(0,n.jsx)(eO,{entities:V.supported_entities,actions:V.supported_actions,selectedEntities:D,selectedActions:q,onEntitySelect:e=>{J(l=>l.includes(e)?l.filter(l=>l!==e):[...l,e])},onActionSelect:(e,l)=>{U(a=>({...a,[e]:l}))},entityCategories:V.pii_entity_categories})})]}),(0,n.jsx)(lb,{guardrailData:T,guardrailSettings:V,isEditing:!0,accessToken:I,onDataChange:eo,onUnsavedChanges:$}),((null===(b=T.litellm_params)||void 0===b?void 0:b.guardrail)==="tool_permission"||B)&&(0,n.jsx)(eL.Z,{orientation:"left",children:"Provider Settings"}),(null===(w=T.litellm_params)||void 0===w?void 0:w.guardrail)==="tool_permission"?(0,n.jsx)(eF,{value:ee,onChange:el}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eg,{selectedProvider:Object.keys(et).find(e=>{var l;return et[e]===(null===(l=T.litellm_params)||void 0===l?void 0:l.guardrail)})||null,accessToken:I,providerParams:B,value:T.litellm_params}),B&&(()=>{var e;let l=Object.keys(et).find(e=>{var l;return et[e]===(null===(l=T.litellm_params)||void 0===l?void 0:l.guardrail)});if(!l)return null;let a=B[null===(e=et[l])||void 0===e?void 0:e.toLowerCase()];return a&&a.optional_params?(0,n.jsx)(ex,{optionalParams:a.optional_params,parentFieldKey:"optional_params",values:T.litellm_params}):null})()]}),(0,n.jsx)(eL.Z,{orientation:"left",children:"Advanced Settings"}),(0,n.jsx)(j.Z.Item,{label:"Guardrail Information",name:"guardrail_info",children:(0,n.jsx)(y.default.TextArea,{rows:5})}),(0,n.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,n.jsx)(_.ZP,{onClick:()=>{R(!1),$(!1),ep()},children:"Cancel"}),(0,n.jsx)(_.ZP,{type:"primary",htmlType:"submit",children:"Save Changes"})]})]}):(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(lg.Z,{className:"font-medium",children:"Guardrail ID"}),(0,n.jsx)("div",{className:"font-mono",children:T.guardrail_id})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(lg.Z,{className:"font-medium",children:"Guardrail Name"}),(0,n.jsx)("div",{children:T.guardrail_name||"Unnamed Guardrail"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(lg.Z,{className:"font-medium",children:"Provider"}),(0,n.jsx)("div",{children:eb})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(lg.Z,{className:"font-medium",children:"Mode"}),(0,n.jsx)("div",{children:(null===(C=T.litellm_params)||void 0===C?void 0:C.mode)||"-"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(lg.Z,{className:"font-medium",children:"Default On"}),(0,n.jsx)(ln.Z,{color:(null===(k=T.litellm_params)||void 0===k?void 0:k.default_on)?"green":"gray",children:(null===(S=T.litellm_params)||void 0===S?void 0:S.default_on)?"Yes":"No"})]}),(null===(Z=T.litellm_params)||void 0===Z?void 0:Z.pii_entities_config)&&Object.keys(T.litellm_params.pii_entities_config).length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)(lg.Z,{className:"font-medium",children:"PII Protection"}),(0,n.jsx)("div",{className:"mt-2",children:(0,n.jsxs)(ln.Z,{color:"blue",children:[Object.keys(T.litellm_params.pii_entities_config).length," PII entities configured"]})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(lg.Z,{className:"font-medium",children:"Created At"}),(0,n.jsx)("div",{children:ev(T.created_at)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(lg.Z,{className:"font-medium",children:"Last Updated"}),(0,n.jsx)("div",{children:ev(T.updated_at)})]}),(null===(P=T.litellm_params)||void 0===P?void 0:P.guardrail)==="tool_permission"&&(0,n.jsx)(eF,{value:ee,disabled:!0})]})]})})]})]}),(0,n.jsx)(lB,{visible:es,onClose:()=>ei(!1),onSuccess:()=>{ei(!1),ec()},accessToken:I,editData:T?{guardrail_id:T.guardrail_id,guardrail_name:T.guardrail_name,litellm_params:T.litellm_params}:null})]})},lF=a(49566),lM=a(35631),lG=a(29436),lR=a(41169),lK=a(16312),lD=a(23639),lJ=a(77565),lq=a(5540);let{Text:lU}=g.default;var lV=function(e){let{results:l,errors:a}=e,[t,r]=(0,o.useState)(new Set),s=e=>{let l=new Set(t);l.has(e)?l.delete(e):l.add(e),r(l)},i=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let l=document.createElement("textarea");l.value=e,l.style.position="fixed",l.style.opacity="0",document.body.appendChild(l),l.focus(),l.select();let a=document.execCommand("copy");if(document.body.removeChild(l),!a)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}};return l||a?(0,n.jsxs)("div",{className:"space-y-3 pt-4 border-t border-gray-200",children:[(0,n.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Results"}),l&&l.map(e=>{let l=t.has(e.guardrailName);return(0,n.jsx)(lo.Z,{className:"bg-green-50 border-green-200",children:(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer flex-1",onClick:()=>s(e.guardrailName),children:[l?(0,n.jsx)(lJ.Z,{className:"text-gray-500 text-xs"}):(0,n.jsx)(x.Z,{className:"text-gray-500 text-xs"}),(0,n.jsx)(lP.Z,{className:"text-green-600 text-lg"}),(0,n.jsx)("span",{className:"text-sm font-medium text-green-800",children:e.guardrailName})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-600",children:[(0,n.jsx)(lq.Z,{}),(0,n.jsxs)("span",{className:"font-medium",children:[e.latency,"ms"]})]}),!l&&(0,n.jsx)(eU.Z,{size:"xs",variant:"secondary",icon:lD.Z,onClick:async()=>{await i(e.response_text)?N.ZP.success("Result copied to clipboard"):N.ZP.fromBackend("Failed to copy result")},children:"Copy"})]})]}),!l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"bg-white border border-green-200 rounded p-3",children:[(0,n.jsx)("label",{className:"text-xs font-medium text-gray-600 mb-2 block",children:"Output Text"}),(0,n.jsx)("div",{className:"font-mono text-sm text-gray-900 whitespace-pre-wrap break-words",children:e.response_text})]}),(0,n.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,n.jsx)("span",{className:"font-medium",children:"Characters:"})," ",e.response_text.length]})]})]})},e.guardrailName)}),a&&a.map(e=>{let l=t.has(e.guardrailName);return(0,n.jsx)(lo.Z,{className:"bg-red-50 border-red-200",children:(0,n.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,n.jsx)("div",{className:"cursor-pointer mt-0.5",onClick:()=>s(e.guardrailName),children:l?(0,n.jsx)(lJ.Z,{className:"text-gray-500 text-xs"}):(0,n.jsx)(x.Z,{className:"text-gray-500 text-xs"})}),(0,n.jsx)("div",{className:"text-red-600 mt-0.5",children:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,n.jsxs)("p",{className:"text-sm font-medium text-red-800 cursor-pointer",onClick:()=>s(e.guardrailName),children:[e.guardrailName," - Error"]}),(0,n.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-600",children:[(0,n.jsx)(lq.Z,{}),(0,n.jsxs)("span",{className:"font-medium",children:[e.latency,"ms"]})]})]}),!l&&(0,n.jsx)("p",{className:"text-sm text-red-700 mt-1",children:e.error.message})]})]})},e.guardrailName)})]}):null};let{TextArea:lY}=y.default,{Text:lW}=g.default;var lH=function(e){let{guardrailNames:l,onSubmit:a,isLoading:t,results:r,errors:s,onClose:i}=e,[d,c]=(0,o.useState)(""),u=()=>{if(!d.trim()){N.ZP.fromBackend("Please enter text to test");return}a(d)},m=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let l=document.createElement("textarea");l.value=e,l.style.position="fixed",l.style.opacity="0",document.body.appendChild(l),l.focus(),l.select();let a=document.execCommand("copy");if(document.body.removeChild(l),!a)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}},x=async()=>{await m(d)?N.ZP.success("Input copied to clipboard"):N.ZP.fromBackend("Failed to copy input")};return(0,n.jsxs)("div",{className:"space-y-4 h-full flex flex-col",children:[(0,n.jsx)("div",{className:"flex items-center justify-between pb-3 border-b border-gray-200",children:(0,n.jsx)("div",{className:"flex items-center space-x-3",children:(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Test Guardrails:"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:l.map(e=>(0,n.jsx)("div",{className:"inline-flex items-center space-x-1 bg-blue-50 px-3 py-1 rounded-md border border-blue-200",children:(0,n.jsx)("span",{className:"font-mono text-blue-700 font-medium text-sm",children:e})},e))})]}),(0,n.jsxs)("p",{className:"text-sm text-gray-500",children:["Test ",l.length>1?"guardrails":"guardrail"," and compare results"]})]})})}),(0,n.jsxs)("div",{className:"flex-1 overflow-auto space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Input Text"}),(0,n.jsx)(eh.Z,{title:"Press Enter to submit. Use Shift+Enter for new line.",children:(0,n.jsx)(eE.Z,{className:"text-gray-400 cursor-help"})})]}),d&&(0,n.jsx)(lK.z,{size:"xs",variant:"secondary",icon:lD.Z,onClick:x,children:"Copy Input"})]}),(0,n.jsx)(lY,{value:d,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||e.ctrlKey||e.metaKey||(e.preventDefault(),u())},placeholder:"Enter text to test with guardrails...",rows:8,className:"font-mono text-sm"}),(0,n.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,n.jsxs)(lW,{className:"text-xs text-gray-500",children:["Press ",(0,n.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"Enter"})," to submit â€¢ ",(0,n.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"Shift+Enter"})," for new line"]}),(0,n.jsxs)(lW,{className:"text-xs text-gray-500",children:["Characters: ",d.length]})]})]}),(0,n.jsx)("div",{className:"pt-2",children:(0,n.jsx)(lK.z,{onClick:u,loading:t,disabled:!d.trim(),className:"w-full",children:t?"Testing ".concat(l.length," guardrail").concat(l.length>1?"s":"","..."):"Test ".concat(l.length," guardrail").concat(l.length>1?"s":"")})})]}),(0,n.jsx)(lV,{results:r,errors:s})]})]})},lQ=e=>{let{guardrailsList:l,isLoading:a,accessToken:t,onClose:r}=e,[s,i]=(0,o.useState)(new Set),[d,c]=(0,o.useState)(""),[u,m]=(0,o.useState)([]),[x,g]=(0,o.useState)([]),[h,f]=(0,o.useState)(!1),j=l.filter(e=>{var l;return null===(l=e.guardrail_name)||void 0===l?void 0:l.toLowerCase().includes(d.toLowerCase())}),y=e=>{let l=new Set(s);l.has(e)?l.delete(e):l.add(e),i(l)},v=async e=>{if(0===s.size||!t)return;f(!0),m([]),g([]);let l=[],a=[];await Promise.all(Array.from(s).map(async r=>{let s=Date.now();try{let a=await (0,p.applyGuardrail)(t,r,e,null,null),i=Date.now()-s;l.push({guardrailName:r,response_text:a.response_text,latency:i})}catch(l){let e=Date.now()-s;console.error("Error testing guardrail ".concat(r,":"),l),a.push({guardrailName:r,error:l,latency:e})}})),m(l),g(a),f(!1),l.length>0&&N.ZP.success("".concat(l.length," guardrail").concat(l.length>1?"s":""," applied successfully")),a.length>0&&N.ZP.fromBackend("".concat(a.length," guardrail").concat(a.length>1?"s":""," failed"))};return(0,n.jsx)("div",{className:"w-full h-[calc(100vh-200px)]",children:(0,n.jsx)(lo.Z,{className:"h-full",children:(0,n.jsxs)("div",{className:"flex h-full",children:[(0,n.jsxs)("div",{className:"w-1/4 border-r border-gray-200 flex flex-col overflow-hidden",children:[(0,n.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)(lh.Z,{className:"text-lg font-semibold mb-3",children:"Guardrails"}),(0,n.jsx)(lF.Z,{icon:lG.Z,placeholder:"Search guardrails...",value:d,onValueChange:c})]})}),(0,n.jsx)("div",{className:"flex-1 overflow-auto",children:a?(0,n.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,n.jsx)(ep.Z,{})}):0===j.length?(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(eT.Z,{description:d?"No guardrails match your search":"No guardrails available"})}):(0,n.jsx)(lM.Z,{dataSource:j,renderItem:e=>(0,n.jsx)(lM.Z.Item,{onClick:()=>{e.guardrail_name&&y(e.guardrail_name)},className:"cursor-pointer hover:bg-gray-50 transition-colors px-4 ".concat(s.has(e.guardrail_name||"")?"bg-blue-50 border-l-4 border-l-blue-500":"border-l-4 border-l-transparent"),children:(0,n.jsx)(lM.Z.Item.Meta,{avatar:(0,n.jsx)(ef.Z,{checked:s.has(e.guardrail_name||""),onClick:l=>{l.stopPropagation(),e.guardrail_name&&y(e.guardrail_name)}}),title:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(lR.Z,{className:"text-gray-400"}),(0,n.jsx)("span",{className:"font-medium text-gray-900",children:e.guardrail_name})]}),description:(0,n.jsxs)("div",{className:"text-xs space-y-1 mt-1",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Type: "}),(0,n.jsx)("span",{className:"text-gray-600",children:e.litellm_params.guardrail})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Mode: "}),(0,n.jsx)("span",{className:"text-gray-600",children:e.litellm_params.mode})]})]})})})})}),(0,n.jsx)("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:(0,n.jsxs)(lg.Z,{className:"text-xs text-gray-600",children:[s.size," of ",j.length," selected"]})})]}),(0,n.jsxs)("div",{className:"w-3/4 flex flex-col bg-white",children:[(0,n.jsx)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:(0,n.jsx)(lh.Z,{className:"text-xl font-semibold mb-0",children:"Guardrail Testing Playground"})}),(0,n.jsx)("div",{className:"flex-1 overflow-auto p-4",children:0===s.size?(0,n.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,n.jsx)(lR.Z,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,n.jsx)(lg.Z,{className:"text-lg font-medium text-gray-600 mb-2",children:"Select Guardrails to Test"}),(0,n.jsx)(lg.Z,{className:"text-center text-gray-500 max-w-md",children:"Choose one or more guardrails from the left sidebar to start testing and comparing results."})]}):(0,n.jsx)("div",{className:"h-full",children:(0,n.jsx)(lH,{guardrailNames:Array.from(s),onSubmit:v,results:u.length>0?u:null,errors:x.length>0?x:null,isLoading:h,onClose:()=>i(new Set)})})})]})]})})})},l$=a(21609),lX=e=>{let{accessToken:l,userRole:a}=e,[t,r]=(0,o.useState)([]),[s,i]=(0,o.useState)(!1),[g,h]=(0,o.useState)(!1),[f,j]=(0,o.useState)(!1),[y,v]=(0,o.useState)(!1),[_,b]=(0,o.useState)(null),[w,C]=(0,o.useState)(!1),[k,S]=(0,o.useState)(null),[Z,P]=(0,o.useState)(0),A=!!a&&(0,lr.tY)(a),O=async()=>{if(l){j(!0);try{let e=await (0,p.getGuardrailsList)(l);console.log("guardrails: ".concat(JSON.stringify(e))),r(e.guardrails)}catch(e){console.error("Error fetching guardrails:",e)}finally{j(!1)}}};(0,o.useEffect)(()=>{O()},[l]);let I=()=>{O()},L=async()=>{if(_&&l){v(!0);try{await (0,p.deleteGuardrailCall)(l,_.guardrail_id),N.ZP.success('Guardrail "'.concat(_.guardrail_name,'" deleted successfully')),await O()}catch(e){console.error("Error deleting guardrail:",e),N.ZP.fromBackend("Failed to delete guardrail")}finally{v(!1),C(!1),b(null)}}},T=_&&_.litellm_params?ed(_.litellm_params.guardrail).displayName:void 0;return(0,n.jsx)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:(0,n.jsxs)(d.v0,{index:Z,onIndexChange:P,children:[(0,n.jsxs)(d.td,{className:"mb-4",children:[(0,n.jsx)(d.OK,{children:"Guardrails"}),(0,n.jsx)(d.OK,{disabled:!l||0===t.length,children:"Test Playground"})]}),(0,n.jsxs)(d.nP,{children:[(0,n.jsxs)(d.x4,{children:[(0,n.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,n.jsx)(c.Z,{menu:{items:[{key:"provider",icon:(0,n.jsx)(u.Z,{}),label:"Add Provider Guardrail",onClick:()=>{k&&S(null),i(!0)}},{key:"custom_code",icon:(0,n.jsx)(m.Z,{}),label:"Create Custom Code Guardrail",onClick:()=>{k&&S(null),h(!0)}}]},trigger:["click"],disabled:!l,children:(0,n.jsxs)(d.zx,{disabled:!l,children:["+ Add New Guardrail ",(0,n.jsx)(x.Z,{className:"ml-2"})]})})}),k?(0,n.jsx)(lz,{guardrailId:k,onClose:()=>S(null),accessToken:l,isAdmin:A}):(0,n.jsx)(lt,{guardrailsList:t,isLoading:f,onDeleteClick:(e,l)=>{b(t.find(l=>l.guardrail_id===e)||null),C(!0)},accessToken:l,onGuardrailUpdated:O,isAdmin:A,onGuardrailClick:e=>S(e)}),(0,n.jsx)(eq,{visible:s,onClose:()=>{i(!1)},accessToken:l,onSuccess:I}),(0,n.jsx)(lB,{visible:g,onClose:()=>{h(!1)},accessToken:l,onSuccess:I}),(0,n.jsx)(l$.Z,{isOpen:w,title:"Delete Guardrail",message:"Are you sure you want to delete guardrail: ".concat(null==_?void 0:_.guardrail_name,"? This action cannot be undone."),resourceInformationTitle:"Guardrail Information",resourceInformation:[{label:"Name",value:null==_?void 0:_.guardrail_name},{label:"ID",value:null==_?void 0:_.guardrail_id,code:!0},{label:"Provider",value:T},{label:"Mode",value:null==_?void 0:_.litellm_params.mode},{label:"Default On",value:(null==_?void 0:_.litellm_params.default_on)?"Yes":"No"}],onCancel:()=>{C(!1),b(null)},onOk:L,confirmLoading:y})]}),(0,n.jsx)(d.x4,{children:(0,n.jsx)(lQ,{guardrailsList:t,isLoading:f,accessToken:l,onClose:()=>P(0)})})]})]})})}}}]);