"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[874],{62099:function(e,s,l){var t=l(57437),a=l(2265),r=l(52787),i=l(89970),n=l(23496),o=l(63709),d=l(15424),c=l(31283);let{Option:m}=r.default;s.Z=e=>{let{form:s,autoRotationEnabled:l,onAutoRotationChange:u,rotationInterval:h,onRotationIntervalChange:x}=e,p=h&&!["7d","30d","90d","180d","365d"].includes(h),[g,j]=(0,a.useState)(p),[y,f]=(0,a.useState)(p?h:"");return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Key Expiry Settings"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-sm font-medium text-gray-700 flex items-center space-x-1",children:[(0,t.jsx)("span",{children:"Expire Key"}),(0,t.jsx)(i.Z,{title:"Set when this key should expire. Format: 30s (seconds), 30m (minutes), 30h (hours), 30d (days)",children:(0,t.jsx)(d.Z,{className:"text-gray-400 cursor-help text-xs"})})]}),(0,t.jsx)(c.o,{name:"duration",placeholder:"e.g., 30d",className:"w-full"})]})]}),(0,t.jsx)(n.Z,{}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Auto-Rotation Settings"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-sm font-medium text-gray-700 flex items-center space-x-1",children:[(0,t.jsx)("span",{children:"Enable Auto-Rotation"}),(0,t.jsx)(i.Z,{title:"Key will automatically regenerate at the specified interval for enhanced security.",children:(0,t.jsx)(d.Z,{className:"text-gray-400 cursor-help text-xs"})})]}),(0,t.jsx)(o.Z,{checked:l,onChange:u,size:"default",className:l?"":"bg-gray-400"})]}),l&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-sm font-medium text-gray-700 flex items-center space-x-1",children:[(0,t.jsx)("span",{children:"Rotation Interval"}),(0,t.jsx)(i.Z,{title:"How often the key should be automatically rotated. Choose the interval that best fits your security requirements.",children:(0,t.jsx)(d.Z,{className:"text-gray-400 cursor-help text-xs"})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(r.default,{value:g?"custom":h,onChange:e=>{"custom"===e?j(!0):(j(!1),f(""),x(e))},className:"w-full",placeholder:"Select interval",children:[(0,t.jsx)(m,{value:"7d",children:"7 days"}),(0,t.jsx)(m,{value:"30d",children:"30 days"}),(0,t.jsx)(m,{value:"90d",children:"90 days"}),(0,t.jsx)(m,{value:"180d",children:"180 days"}),(0,t.jsx)(m,{value:"365d",children:"365 days"}),(0,t.jsx)(m,{value:"custom",children:"Custom interval"})]}),g&&(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)(c.o,{value:y,onChange:e=>{let s=e.target.value;f(s),x(s)},placeholder:"e.g., 1s, 5m, 2h, 14d"}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Supported formats: seconds (s), minutes (m), hours (h), days (d)"})]})]})]})]}),l&&(0,t.jsx)("div",{className:"bg-blue-50 p-3 rounded-md text-sm text-blue-700",children:"When rotation occurs, you'll receive a notification with the new key. The old key will be deactivated after a brief grace period."})]})]})}},51750:function(e,s,l){l.d(s,{Z:function(){return p}});var t=l(57437),a=l(2265),r=l(77355),i=l(93416),n=l(74998),o=l(95704),d=l(56522),c=l(52787),m=l(69993),u=l(51601),h=e=>{let{accessToken:s,value:l,placeholder:r="Select a Model",onChange:i,disabled:n=!1,style:o,className:h,showLabel:x=!0,labelText:p="Select Model"}=e,[g,j]=(0,a.useState)(l),[y,f]=(0,a.useState)(!1),[b,v]=(0,a.useState)([]),_=(0,a.useRef)(null);return(0,a.useEffect)(()=>{j(l)},[l]),(0,a.useEffect)(()=>{s&&(async()=>{try{let e=await (0,u.p)(s);console.log("Fetched models for selector:",e),e.length>0&&v(e)}catch(e){console.error("Error fetching model info:",e)}})()},[s]),(0,t.jsxs)("div",{children:[x&&(0,t.jsxs)(d.x,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,t.jsx)(m.Z,{className:"mr-2"})," ",p]}),(0,t.jsx)(c.default,{value:g,placeholder:r,onChange:e=>{"custom"===e?(f(!0),j(void 0)):(f(!1),j(e),i&&i(e))},options:[...Array.from(new Set(b.map(e=>e.model_group))).map((e,s)=>({value:e,label:e,key:s})),{value:"custom",label:"Enter custom model",key:"custom"}],style:{width:"100%",...o},showSearch:!0,className:"rounded-md ".concat(h||""),disabled:n}),y&&(0,t.jsx)(d.o,{className:"mt-2",placeholder:"Enter custom model name",onValueChange:e=>{_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{j(e),i&&i(e)},500)},disabled:n})]})},x=l(9114),p=e=>{let{accessToken:s,initialModelAliases:l={},onAliasUpdate:d,showExampleConfig:c=!0}=e,[m,u]=(0,a.useState)([]),[p,g]=(0,a.useState)({aliasName:"",targetModel:""}),[j,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{u(Object.entries(l).map((e,s)=>{let[l,t]=e;return{id:"".concat(s,"-").concat(l),aliasName:l,targetModel:t}}))},[l]);let f=e=>{y({...e})},b=()=>{if(!j)return;if(!j.aliasName||!j.targetModel){x.Z.fromBackend("Please provide both alias name and target model");return}if(m.some(e=>e.id!==j.id&&e.aliasName===j.aliasName)){x.Z.fromBackend("An alias with this name already exists");return}let e=m.map(e=>e.id===j.id?j:e);u(e),y(null);let s={};e.forEach(e=>{s[e.aliasName]=e.targetModel}),d&&d(s),x.Z.success("Alias updated successfully")},v=()=>{y(null)},_=e=>{let s=m.filter(s=>s.id!==e);u(s);let l={};s.forEach(e=>{l[e.aliasName]=e.targetModel}),d&&d(l),x.Z.success("Alias deleted successfully")},N=m.reduce((e,s)=>(e[s.aliasName]=s.targetModel,e),{});return(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)(o.xv,{className:"text-sm font-medium text-gray-700 mb-2",children:"Add New Alias"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Alias Name"}),(0,t.jsx)("input",{type:"text",value:p.aliasName,onChange:e=>g({...p,aliasName:e.target.value}),placeholder:"e.g., gpt-4o",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Target Model"}),(0,t.jsx)(h,{accessToken:s,value:p.targetModel,placeholder:"Select target model",onChange:e=>g({...p,targetModel:e}),showLabel:!1})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsxs)("button",{onClick:()=>{if(!p.aliasName||!p.targetModel){x.Z.fromBackend("Please provide both alias name and target model");return}if(m.some(e=>e.aliasName===p.aliasName)){x.Z.fromBackend("An alias with this name already exists");return}let e=[...m,{id:"".concat(Date.now(),"-").concat(p.aliasName),aliasName:p.aliasName,targetModel:p.targetModel}];u(e),g({aliasName:"",targetModel:""});let s={};e.forEach(e=>{s[e.aliasName]=e.targetModel}),d&&d(s),x.Z.success("Alias added successfully")},disabled:!p.aliasName||!p.targetModel,className:"flex items-center px-4 py-2 rounded-md text-sm ".concat(p.aliasName&&p.targetModel?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:[(0,t.jsx)(r.Z,{className:"w-4 h-4 mr-1"}),"Add Alias"]})})]})]}),(0,t.jsx)(o.xv,{className:"text-sm font-medium text-gray-700 mb-2",children:"Manage Existing Aliases"}),(0,t.jsx)("div",{className:"rounded-lg custom-border relative mb-6",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(o.iA,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,t.jsx)(o.ss,{children:(0,t.jsxs)(o.SC,{children:[(0,t.jsx)(o.xs,{className:"py-1 h-8",children:"Alias Name"}),(0,t.jsx)(o.xs,{className:"py-1 h-8",children:"Target Model"}),(0,t.jsx)(o.xs,{className:"py-1 h-8",children:"Actions"})]})}),(0,t.jsxs)(o.RM,{children:[m.map(e=>(0,t.jsx)(o.SC,{className:"h-8",children:j&&j.id===e.id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.pj,{className:"py-0.5",children:(0,t.jsx)("input",{type:"text",value:j.aliasName,onChange:e=>y({...j,aliasName:e.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm"})}),(0,t.jsx)(o.pj,{className:"py-0.5",children:(0,t.jsx)(h,{accessToken:s,value:j.targetModel,onChange:e=>y({...j,targetModel:e}),showLabel:!1,style:{height:"32px"}})}),(0,t.jsx)(o.pj,{className:"py-0.5 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:b,className:"text-xs bg-blue-50 text-blue-600 px-2 py-1 rounded hover:bg-blue-100",children:"Save"}),(0,t.jsx)("button",{onClick:v,className:"text-xs bg-gray-50 text-gray-600 px-2 py-1 rounded hover:bg-gray-100",children:"Cancel"})]})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.pj,{className:"py-0.5 text-sm text-gray-900",children:e.aliasName}),(0,t.jsx)(o.pj,{className:"py-0.5 text-sm text-gray-500",children:e.targetModel}),(0,t.jsx)(o.pj,{className:"py-0.5 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>f(e),className:"text-xs bg-blue-50 text-blue-600 px-2 py-1 rounded hover:bg-blue-100",children:(0,t.jsx)(i.Z,{className:"w-3 h-3"})}),(0,t.jsx)("button",{onClick:()=>_(e.id),className:"text-xs bg-red-50 text-red-600 px-2 py-1 rounded hover:bg-red-100",children:(0,t.jsx)(n.Z,{className:"w-3 h-3"})})]})})]})},e.id)),0===m.length&&(0,t.jsx)(o.SC,{children:(0,t.jsx)(o.pj,{colSpan:3,className:"py-0.5 text-sm text-gray-500 text-center",children:"No aliases added yet. Add a new alias above."})})]})]})})}),c&&(0,t.jsxs)(o.Zb,{children:[(0,t.jsx)(o.Dx,{className:"mb-4",children:"Configuration Example"}),(0,t.jsx)(o.xv,{className:"text-gray-600 mb-4",children:"Here's how your current aliases would look in the config:"}),(0,t.jsx)("div",{className:"bg-gray-100 rounded-lg p-4 font-mono text-sm",children:(0,t.jsxs)("div",{className:"text-gray-700",children:["model_aliases:",0===Object.keys(N).length?(0,t.jsxs)("span",{className:"text-gray-500",children:[(0,t.jsx)("br",{}),"\xa0\xa0# No aliases configured yet"]}):Object.entries(N).map(e=>{let[s,l]=e;return(0,t.jsxs)("span",{children:[(0,t.jsx)("br",{}),'\xa0\xa0"',s,'": "',l,'"']},s)})]})})]})]})}},2597:function(e,s,l){var t=l(57437);l(2265);var a=l(92280),r=l(54507);s.Z=function(e){let{value:s,onChange:l,premiumUser:i=!1,disabledCallbacks:n=[],onDisabledCallbacksChange:o}=e;return i?(0,t.jsx)(r.Z,{value:s,onChange:l,disabledCallbacks:n,onDisabledCallbacksChange:o}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[(0,t.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-green-50 border border-green-200 text-green-800 text-sm font-medium opacity-50",children:"✨ langfuse-logging"}),(0,t.jsx)("div",{className:"inline-flex items-center px-3 py-1.5 rounded-lg bg-green-50 border border-green-200 text-green-800 text-sm font-medium opacity-50",children:"✨ datadog-logging"})]}),(0,t.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,t.jsxs)(a.x,{className:"text-sm text-yellow-800",children:["Setting Key/Team logging settings is a LiteLLM Enterprise feature. Global Logging Settings are available for all free users. Get a trial key"," ",(0,t.jsx)("a",{href:"https://www.litellm.ai/#pricing",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"here"}),"."]})})]})}},65895:function(e,s,l){var t=l(57437);l(2265);var a=l(52787),r=l(13634),i=l(89970),n=l(15424);let{Option:o}=a.default;s.Z=e=>{let{type:s,name:l,showDetailedDescriptions:d=!0,className:c="",initialValue:m=null,form:u,onChange:h}=e,x=s.toUpperCase(),p=s.toLowerCase(),g="Select 'guaranteed_throughput' to prevent overallocating ".concat(x," limit when the key belongs to a Team with specific ").concat(x," limits.");return(0,t.jsx)(r.Z.Item,{label:(0,t.jsxs)("span",{children:[x," Rate Limit Type"," ",(0,t.jsx)(i.Z,{title:g,children:(0,t.jsx)(n.Z,{style:{marginLeft:"4px"}})})]}),name:l,initialValue:m,className:c,children:(0,t.jsx)(a.default,{defaultValue:d?"default":void 0,placeholder:"Select rate limit type",style:{width:"100%"},optionLabelProp:d?"label":void 0,onChange:e=>{u&&u.setFieldValue(l,e),h&&h(e)},children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o,{value:"best_effort_throughput",label:"Default",children:(0,t.jsxs)("div",{style:{padding:"4px 0"},children:[(0,t.jsx)("div",{style:{fontWeight:500},children:"Default"}),(0,t.jsxs)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:["Best effort throughput - no error if we're overallocating ",p," (Team/Key Limits checked at runtime)."]})]})}),(0,t.jsx)(o,{value:"guaranteed_throughput",label:"Guaranteed throughput",children:(0,t.jsxs)("div",{style:{padding:"4px 0"},children:[(0,t.jsx)("div",{style:{fontWeight:500},children:"Guaranteed throughput"}),(0,t.jsxs)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:["Guaranteed throughput - raise an error if we're overallocating ",p," (also checks model-specific limits)"]})]})}),(0,t.jsx)(o,{value:"dynamic",label:"Dynamic",children:(0,t.jsxs)("div",{style:{padding:"4px 0"},children:[(0,t.jsx)("div",{style:{fontWeight:500},children:"Dynamic"}),(0,t.jsxs)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:["If the key has a set ",x," (e.g. 2 ",x,") and there are no 429 errors, it can dynamically exceed the limit when the model being called is not erroring."]})]})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o,{value:"best_effort_throughput",children:"Best effort throughput"}),(0,t.jsx)(o,{value:"guaranteed_throughput",children:"Guaranteed throughput"}),(0,t.jsx)(o,{value:"dynamic",children:"Dynamic"})]})})})}},30874:function(e,s,l){l.d(s,{ZP:function(){return z},wk:function(){return W},Nr:function(){return J}});var t=l(57437),a=l(2265),r=l(20831),i=l(49804),n=l(67101),o=l(49566),d=l(87452),c=l(88829),m=l(72208),u=l(84264),h=l(96761),x=l(29233),p=l(52787),g=l(13634),j=l(82680),y=l(29967),f=l(73002),b=l(64482),v=l(24199),_=l(46468),N=l(63610),w=l(19250),Z=l(97415),k=l(95096),S=l(84376),C=l(15424),P=l(89970),M=l(2597),A=l(7765),I=l(7310),L=l.n(I),T=l(20347),E=l(65925),F=l(59872),U=l(97434),D=l(95920),R=l(68473),V=l(51750),K=l(9114),O=l(62099),B=l(65895);let{Option:q}=p.default,G=e=>{let s=[];if(console.log("data:",JSON.stringify(e)),e)for(let l of e)l.metadata&&l.metadata.tags&&s.push(...l.metadata.tags);let l=Array.from(new Set(s)).map(e=>({value:e,label:e}));return console.log("uniqueTags:",l),l},W=async(e,s,l,t)=>{try{if(null===e||null===s)return[];if(null!==l){let a=(await (0,w.modelAvailableCall)(l,e,s,!0,t,!0)).data.map(e=>e.id);return console.log("available_model_names:",a),a}return[]}catch(e){return console.error("Error fetching user models:",e),[]}},J=async(e,s,l,t)=>{try{if(null===e||null===s)return;if(null!==l){let a=(await (0,w.modelAvailableCall)(l,e,s)).data.map(e=>e.id);console.log("available_model_names:",a),t(a)}}catch(e){console.error("Error fetching user models:",e)}};var z=e=>{let{userID:s,team:l,teams:I,userRole:z,accessToken:H,data:$,addKey:Q,premiumUser:Y=!1}=e,[X]=g.Z.useForm(),[ee,es]=(0,a.useState)(!1),[el,et]=(0,a.useState)(null),[ea,er]=(0,a.useState)(null),[ei,en]=(0,a.useState)([]),[eo,ed]=(0,a.useState)([]),[ec,em]=(0,a.useState)("you"),[eu,eh]=(0,a.useState)(G($)),[ex,ep]=(0,a.useState)([]),[eg,ej]=(0,a.useState)([]),[ey,ef]=(0,a.useState)([]),[eb,ev]=(0,a.useState)(l),[e_,eN]=(0,a.useState)(!1),[ew,eZ]=(0,a.useState)(null),[ek,eS]=(0,a.useState)({}),[eC,eP]=(0,a.useState)([]),[eM,eA]=(0,a.useState)(!1),[eI,eL]=(0,a.useState)([]),[eT,eE]=(0,a.useState)(!1),[eF,eU]=(0,a.useState)([]),[eD,eR]=(0,a.useState)("default"),[eV,eK]=(0,a.useState)({}),[eO,eB]=(0,a.useState)(!1),[eq,eG]=(0,a.useState)("30d"),eW=()=>{es(!1),X.resetFields(),ef([]),eU([]),eR("default"),eK({}),eB(!1),eG("30d")},eJ=()=>{es(!1),et(null),ev(null),X.resetFields(),ef([]),eU([]),eR("default"),eK({}),eB(!1),eG("30d")};(0,a.useEffect)(()=>{s&&z&&H&&J(s,z,H,en)},[H,s,z]);let ez=async()=>{try{if(null==H)return;let e=await (0,w.fetchMCPAccessGroups)(H);eL(e)}catch(e){console.error("Failed to fetch MCP access groups:",e)}};(0,a.useEffect)(()=>{ez()},[H]),(0,a.useEffect)(()=>{let e=async()=>{try{let e=await (0,w.getPromptsList)(H);ej(e.prompts.map(e=>e.prompt_id))}catch(e){console.error("Failed to fetch prompts:",e)}};(async()=>{try{let e=(await (0,w.getGuardrailsList)(H)).guardrails.map(e=>e.guardrail_name);ep(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})(),e()},[H]),(0,a.useEffect)(()=>{(async()=>{try{if(H){let e=sessionStorage.getItem("possibleUserRoles");if(e)eS(JSON.parse(e));else{let e=await (0,w.getPossibleUserRoles)(H);sessionStorage.setItem("possibleUserRoles",JSON.stringify(e)),eS(e)}}}catch(e){console.error("Error fetching possible user roles:",e)}})()},[H]);let eH=eo.includes("no-default-models")&&!eb,e$=async e=>{try{var l,t,a,r,i;let n;let o=null!==(a=null==e?void 0:e.key_alias)&&void 0!==a?a:"",d=null!==(r=null==e?void 0:e.team_id)&&void 0!==r?r:null;if((null!==(i=null==$?void 0:$.filter(e=>e.team_id===d).map(e=>e.key_alias))&&void 0!==i?i:[]).includes(o))throw Error("Key alias ".concat(o," already exists for team with ID ").concat(d,", please provide another key alias"));K.Z.info("Making API Call"),es(!0),"you"===ec&&(e.user_id=s);let c={};try{c=JSON.parse(e.metadata||"{}")}catch(e){console.error("Error parsing metadata:",e)}if("service_account"===ec&&(c.service_account_id=e.key_alias),ey.length>0&&(c={...c,logging:ey.filter(e=>e.callback_name)}),eF.length>0){let e=(0,U.Z3)(eF);c={...c,litellm_disabled_callbacks:e}}if(eO&&(e.auto_rotate=!0,e.rotation_interval=eq),e.duration&&(e.duration=e.duration),e.metadata=JSON.stringify(c),e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0&&(e.object_permission={vector_stores:e.allowed_vector_store_ids},delete e.allowed_vector_store_ids),e.allowed_mcp_servers_and_groups&&((null===(l=e.allowed_mcp_servers_and_groups.servers)||void 0===l?void 0:l.length)>0||(null===(t=e.allowed_mcp_servers_and_groups.accessGroups)||void 0===t?void 0:t.length)>0)){e.object_permission||(e.object_permission={});let{servers:s,accessGroups:l}=e.allowed_mcp_servers_and_groups;s&&s.length>0&&(e.object_permission.mcp_servers=s),l&&l.length>0&&(e.object_permission.mcp_access_groups=l),delete e.allowed_mcp_servers_and_groups}let m=e.mcp_tool_permissions||{};Object.keys(m).length>0&&(e.object_permission||(e.object_permission={}),e.object_permission.mcp_tool_permissions=m),delete e.mcp_tool_permissions,e.allowed_mcp_access_groups&&e.allowed_mcp_access_groups.length>0&&(e.object_permission||(e.object_permission={}),e.object_permission.mcp_access_groups=e.allowed_mcp_access_groups,delete e.allowed_mcp_access_groups),Object.keys(eV).length>0&&(e.aliases=JSON.stringify(eV)),n="service_account"===ec?await (0,w.keyCreateServiceAccountCall)(H,e):await (0,w.keyCreateCall)(H,s,e),console.log("key create Response:",n),Q(n),et(n.key),er(n.soft_budget),K.Z.success("API Key Created"),X.resetFields(),localStorage.removeItem("userData"+s)}catch(e){console.log("error in create key:",e),K.Z.fromBackend("Error creating the key: ".concat(e))}};(0,a.useEffect)(()=>{if(s&&z&&H){var e;W(s,z,H,null!==(e=null==eb?void 0:eb.team_id)&&void 0!==e?e:null).then(e=>{var s;ed(Array.from(new Set([...null!==(s=null==eb?void 0:eb.models)&&void 0!==s?s:[],...e])))})}X.setFieldValue("models",[])},[eb,H,s,z]);let eQ=async e=>{if(!e){eP([]);return}eA(!0);try{let s=new URLSearchParams;if(s.append("user_email",e),null==H)return;let l=(await (0,w.userFilterUICall)(H,s)).map(e=>({label:"".concat(e.user_email," (").concat(e.user_id,")"),value:e.user_id,user:e}));eP(l)}catch(e){console.error("Error fetching users:",e),K.Z.fromBackend("Failed to search for users")}finally{eA(!1)}},eY=(0,a.useCallback)(L()(e=>eQ(e),300),[H]),eX=(e,s)=>{let l=s.user;X.setFieldsValue({user_id:l.user_id})};return(0,t.jsxs)("div",{children:[z&&T.LQ.includes(z)&&(0,t.jsx)(r.Z,{className:"mx-auto",onClick:()=>es(!0),children:"+ Create New Key"}),(0,t.jsx)(j.Z,{visible:ee,width:1e3,footer:null,onOk:eW,onCancel:eJ,children:(0,t.jsxs)(g.Z,{form:X,onFinish:e$,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)(h.Z,{className:"mb-4",children:"Key Ownership"}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Owned By"," ",(0,t.jsx)(P.Z,{title:"Select who will own this API key",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),className:"mb-4",children:(0,t.jsxs)(y.ZP.Group,{onChange:e=>em(e.target.value),value:ec,children:[(0,t.jsx)(y.ZP,{value:"you",children:"You"}),(0,t.jsx)(y.ZP,{value:"service_account",children:"Service Account"}),"Admin"===z&&(0,t.jsx)(y.ZP,{value:"another_user",children:"Another User"})]})}),"another_user"===ec&&(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["User ID"," ",(0,t.jsx)(P.Z,{title:"The user who will own this key and be responsible for its usage",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"user_id",className:"mt-4",rules:[{required:"another_user"===ec,message:"Please input the user ID of the user you are assigning the key to"}],children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{display:"flex",marginBottom:"8px"},children:[(0,t.jsx)(p.default,{showSearch:!0,placeholder:"Type email to search for users",filterOption:!1,onSearch:e=>{eY(e)},onSelect:(e,s)=>eX(e,s),options:eC,loading:eM,allowClear:!0,style:{width:"100%"},notFoundContent:eM?"Searching...":"No users found"}),(0,t.jsx)(f.ZP,{onClick:()=>eN(!0),style:{marginLeft:"8px"},children:"Create User"})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Search by email to find users"})]})}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Team"," ",(0,t.jsx)(P.Z,{title:"The team this key belongs to, which determines available models and budget limits",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"team_id",initialValue:l?l.team_id:null,className:"mt-4",rules:[{required:"service_account"===ec,message:"Please select a team for the service account"}],help:"service_account"===ec?"required":"",children:(0,t.jsx)(S.Z,{teams:I,onChange:e=>{ev((null==I?void 0:I.find(s=>s.team_id===e))||null)}})})]}),eH&&(0,t.jsx)("div",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,t.jsx)(u.Z,{className:"text-blue-800 text-sm",children:"Please select a team to continue configuring your API key. If you do not see any teams, please contact your Proxy Admin to either provide you with access to models or to add you to a team."})}),!eH&&(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)(h.Z,{className:"mb-4",children:"Key Details"}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["you"===ec||"another_user"===ec?"Key Name":"Service Account ID"," ",(0,t.jsx)(P.Z,{title:"you"===ec||"another_user"===ec?"A descriptive name to identify this key":"Unique identifier for this service account",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"key_alias",rules:[{required:!0,message:"Please input a ".concat("you"===ec?"key name":"service account ID")}],help:"required",children:(0,t.jsx)(o.Z,{placeholder:""})}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Models"," ",(0,t.jsx)(P.Z,{title:"Select which models this key can access. Choose 'All Team Models' to grant access to all models available to the team",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"models",rules:"management"===eD||"read_only"===eD?[]:[{required:!0,message:"Please select a model"}],help:"management"===eD||"read_only"===eD?"Models field is disabled for this key type":"required",className:"mt-4",children:(0,t.jsxs)(p.default,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},disabled:"management"===eD||"read_only"===eD,onChange:e=>{e.includes("all-team-models")&&X.setFieldsValue({models:["all-team-models"]})},children:[(0,t.jsx)(q,{value:"all-team-models",children:"All Team Models"},"all-team-models"),eo.map(e=>(0,t.jsx)(q,{value:e,children:(0,_.W0)(e)},e))]})}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Key Type"," ",(0,t.jsx)(P.Z,{title:"Select the type of key to determine what routes and operations this key can access",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"key_type",initialValue:"default",className:"mt-4",children:(0,t.jsxs)(p.default,{defaultValue:"default",placeholder:"Select key type",style:{width:"100%"},optionLabelProp:"label",onChange:e=>{eR(e),("management"===e||"read_only"===e)&&X.setFieldsValue({models:[]})},children:[(0,t.jsx)(q,{value:"default",label:"Default",children:(0,t.jsxs)("div",{style:{padding:"4px 0"},children:[(0,t.jsx)("div",{style:{fontWeight:500},children:"Default"}),(0,t.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:"Can call LLM API + Management routes"})]})}),(0,t.jsx)(q,{value:"llm_api",label:"LLM API",children:(0,t.jsxs)("div",{style:{padding:"4px 0"},children:[(0,t.jsx)("div",{style:{fontWeight:500},children:"LLM API"}),(0,t.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:"Can call only LLM API routes (chat/completions, embeddings, etc.)"})]})}),(0,t.jsx)(q,{value:"management",label:"Management",children:(0,t.jsxs)("div",{style:{padding:"4px 0"},children:[(0,t.jsx)("div",{style:{fontWeight:500},children:"Management"}),(0,t.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:"Can call only management routes (user/team/key management)"})]})})]})})]}),!eH&&(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)(d.Z,{className:"mt-4 mb-4",children:[(0,t.jsx)(m.Z,{children:(0,t.jsx)(h.Z,{className:"m-0",children:"Optional Settings"})}),(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(g.Z.Item,{className:"mt-4",label:(0,t.jsxs)("span",{children:["Max Budget (USD)"," ",(0,t.jsx)(P.Z,{title:"Maximum amount in USD this key can spend. When reached, the key will be blocked from making further requests",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"max_budget",help:"Budget cannot exceed team max budget: $".concat((null==l?void 0:l.max_budget)!==null&&(null==l?void 0:l.max_budget)!==void 0?null==l?void 0:l.max_budget:"unlimited"),rules:[{validator:async(e,s)=>{if(s&&l&&null!==l.max_budget&&s>l.max_budget)throw Error("Budget cannot exceed team max budget: $".concat((0,F.pw)(l.max_budget,4)))}}],children:(0,t.jsx)(v.Z,{step:.01,precision:2,width:200})}),(0,t.jsx)(g.Z.Item,{className:"mt-4",label:(0,t.jsxs)("span",{children:["Reset Budget"," ",(0,t.jsx)(P.Z,{title:"How often the budget should reset. For example, setting 'daily' will reset the budget every 24 hours",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"budget_duration",help:"Team Reset Budget: ".concat((null==l?void 0:l.budget_duration)!==null&&(null==l?void 0:l.budget_duration)!==void 0?null==l?void 0:l.budget_duration:"None"),children:(0,t.jsx)(E.Z,{onChange:e=>X.setFieldValue("budget_duration",e)})}),(0,t.jsx)(g.Z.Item,{className:"mt-4",label:(0,t.jsxs)("span",{children:["Tokens per minute Limit (TPM)"," ",(0,t.jsx)(P.Z,{title:"Maximum number of tokens this key can process per minute. Helps control usage and costs",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"tpm_limit",help:"TPM cannot exceed team TPM limit: ".concat((null==l?void 0:l.tpm_limit)!==null&&(null==l?void 0:l.tpm_limit)!==void 0?null==l?void 0:l.tpm_limit:"unlimited"),rules:[{validator:async(e,s)=>{if(s&&l&&null!==l.tpm_limit&&s>l.tpm_limit)throw Error("TPM limit cannot exceed team TPM limit: ".concat(l.tpm_limit))}}],children:(0,t.jsx)(v.Z,{step:1,width:400})}),(0,t.jsx)(B.Z,{type:"tpm",name:"tpm_limit_type",className:"mt-4",initialValue:null,form:X,showDetailedDescriptions:!0}),(0,t.jsx)(g.Z.Item,{className:"mt-4",label:(0,t.jsxs)("span",{children:["Requests per minute Limit (RPM)"," ",(0,t.jsx)(P.Z,{title:"Maximum number of API requests this key can make per minute. Helps prevent abuse and manage load",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"rpm_limit",help:"RPM cannot exceed team RPM limit: ".concat((null==l?void 0:l.rpm_limit)!==null&&(null==l?void 0:l.rpm_limit)!==void 0?null==l?void 0:l.rpm_limit:"unlimited"),rules:[{validator:async(e,s)=>{if(s&&l&&null!==l.rpm_limit&&s>l.rpm_limit)throw Error("RPM limit cannot exceed team RPM limit: ".concat(l.rpm_limit))}}],children:(0,t.jsx)(v.Z,{step:1,width:400})}),(0,t.jsx)(B.Z,{type:"rpm",name:"rpm_limit_type",className:"mt-4",initialValue:null,form:X,showDetailedDescriptions:!0}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Guardrails"," ",(0,t.jsx)(P.Z,{title:"Apply safety guardrails to this key to filter content or enforce policies",children:(0,t.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",className:"mt-4",help:Y?"Select existing guardrails or enter new ones":"Premium feature - Upgrade to set guardrails by key",children:(0,t.jsx)(p.default,{mode:"tags",style:{width:"100%"},disabled:!Y,placeholder:Y?"Select or enter guardrails":"Premium feature - Upgrade to set guardrails by key",options:ex.map(e=>({value:e,label:e}))})}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Prompts"," ",(0,t.jsx)(P.Z,{title:"Allow this key to use specific prompt templates",children:(0,t.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/prompt_management",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})})]}),name:"prompts",className:"mt-4",help:Y?"Select existing prompts or enter new ones":"Premium feature - Upgrade to set prompts by key",children:(0,t.jsx)(p.default,{mode:"tags",style:{width:"100%"},disabled:!Y,placeholder:Y?"Select or enter prompts":"Premium feature - Upgrade to set prompts by key",options:eg.map(e=>({value:e,label:e}))})}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Allowed Pass Through Routes"," ",(0,t.jsx)(P.Z,{title:"Allow this key to use specific pass through routes",children:(0,t.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/pass_through",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})})]}),name:"allowed_passthrough_routes",className:"mt-4",help:Y?"Select existing pass through routes or enter new ones":"Premium feature - Upgrade to set pass through routes by key",children:(0,t.jsx)(k.Z,{onChange:e=>X.setFieldValue("allowed_passthrough_routes",e),value:X.getFieldValue("allowed_passthrough_routes"),accessToken:H,placeholder:Y?"Select or enter pass through routes":"Premium feature - Upgrade to set pass through routes by key",disabled:!Y,teamId:eb?eb.team_id:null})}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Allowed Vector Stores"," ",(0,t.jsx)(P.Z,{title:"Select which vector stores this key can access. If none selected, the key will have access to all available vector stores",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-4",help:"Select vector stores this key can access. Leave empty for access to all vector stores",children:(0,t.jsx)(Z.Z,{onChange:e=>X.setFieldValue("allowed_vector_store_ids",e),value:X.getFieldValue("allowed_vector_store_ids"),accessToken:H,placeholder:"Select vector stores (optional)"})}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Metadata"," ",(0,t.jsx)(P.Z,{title:"JSON object with additional information about this key. Used for tracking or custom logic",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"metadata",className:"mt-4",children:(0,t.jsx)(b.default.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Tags"," ",(0,t.jsx)(P.Z,{title:"Tags for tracking spend and/or doing tag-based routing. Used for analytics and filtering",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"tags",className:"mt-4",help:"Tags for tracking spend and/or doing tag-based routing.",children:(0,t.jsx)(p.default,{mode:"tags",style:{width:"100%"},placeholder:"Enter tags",tokenSeparators:[","],options:eu})}),(0,t.jsxs)(d.Z,{className:"mt-4 mb-4",onClick:()=>{eT||(ez(),eE(!0))},children:[(0,t.jsx)(m.Z,{children:(0,t.jsx)("b",{children:"MCP Settings"})}),(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(g.Z.Item,{label:(0,t.jsxs)("span",{children:["Allowed MCP Servers"," ",(0,t.jsx)(P.Z,{title:"Select which MCP servers or access groups this key can access",children:(0,t.jsx)(C.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_servers_and_groups",help:"Select MCP servers or access groups this key can access",children:(0,t.jsx)(D.Z,{onChange:e=>X.setFieldValue("allowed_mcp_servers_and_groups",e),value:X.getFieldValue("allowed_mcp_servers_and_groups"),accessToken:H,placeholder:"Select MCP servers or access groups (optional)"})}),(0,t.jsx)(g.Z.Item,{name:"mcp_tool_permissions",initialValue:{},hidden:!0,children:(0,t.jsx)(b.default,{type:"hidden"})}),(0,t.jsx)(g.Z.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.allowed_mcp_servers_and_groups!==s.allowed_mcp_servers_and_groups||e.mcp_tool_permissions!==s.mcp_tool_permissions,children:()=>{var e;return(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)(R.Z,{accessToken:H,selectedServers:(null===(e=X.getFieldValue("allowed_mcp_servers_and_groups"))||void 0===e?void 0:e.servers)||[],toolPermissions:X.getFieldValue("mcp_tool_permissions")||{},onChange:e=>X.setFieldsValue({mcp_tool_permissions:e})})})}})]})]}),Y?(0,t.jsxs)(d.Z,{className:"mt-4 mb-4",children:[(0,t.jsx)(m.Z,{children:(0,t.jsx)("b",{children:"Logging Settings"})}),(0,t.jsx)(c.Z,{children:(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(M.Z,{value:ey,onChange:ef,premiumUser:!0,disabledCallbacks:eF,onDisabledCallbacksChange:eU})})})]}):(0,t.jsx)(P.Z,{title:(0,t.jsxs)("span",{children:["Key-level logging settings is an enterprise feature, get in touch -",(0,t.jsx)("a",{href:"https://www.litellm.ai/enterprise",target:"_blank",children:"https://www.litellm.ai/enterprise"})]}),placement:"top",children:(0,t.jsxs)("div",{style:{position:"relative"},children:[(0,t.jsx)("div",{style:{opacity:.5},children:(0,t.jsxs)(d.Z,{className:"mt-4 mb-4",children:[(0,t.jsx)(m.Z,{children:(0,t.jsx)("b",{children:"Logging Settings"})}),(0,t.jsx)(c.Z,{children:(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(M.Z,{value:ey,onChange:ef,premiumUser:!1,disabledCallbacks:eF,onDisabledCallbacksChange:eU})})})]})}),(0,t.jsx)("div",{style:{position:"absolute",inset:0,cursor:"not-allowed"}})]})}),(0,t.jsxs)(d.Z,{className:"mt-4 mb-4",children:[(0,t.jsx)(m.Z,{children:(0,t.jsx)("b",{children:"Model Aliases"})}),(0,t.jsx)(c.Z,{children:(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)(u.Z,{className:"text-sm text-gray-600 mb-4",children:"Create custom aliases for models that can be used in API calls. This allows you to create shortcuts for specific models."}),(0,t.jsx)(V.Z,{accessToken:H,initialModelAliases:eV,onAliasUpdate:eK,showExampleConfig:!1})]})})]}),(0,t.jsxs)(d.Z,{className:"mt-4 mb-4",children:[(0,t.jsx)(m.Z,{children:(0,t.jsx)("b",{children:"Key Lifecycle"})}),(0,t.jsx)(c.Z,{children:(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(O.Z,{form:X,autoRotationEnabled:eO,onAutoRotationChange:eB,rotationInterval:eq,onRotationIntervalChange:eG})})})]}),(0,t.jsxs)(d.Z,{className:"mt-4 mb-4",children:[(0,t.jsx)(m.Z,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("b",{children:"Advanced Settings"}),(0,t.jsx)(P.Z,{title:(0,t.jsxs)("span",{children:["Learn more about advanced settings in our"," ",(0,t.jsx)("a",{href:w.proxyBaseUrl?"".concat(w.proxyBaseUrl,"/#/key%20management/generate_key_fn_key_generate_post"):"/#/key%20management/generate_key_fn_key_generate_post",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300",children:"documentation"})]}),children:(0,t.jsx)(C.Z,{className:"text-gray-400 hover:text-gray-300 cursor-help"})})]})}),(0,t.jsx)(c.Z,{children:(0,t.jsx)(N.Z,{schemaComponent:"GenerateKeyRequest",form:X,excludedFields:["key_alias","team_id","models","duration","metadata","tags","guardrails","max_budget","budget_duration","tpm_limit","rpm_limit"]})})]})]})]})}),(0,t.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,t.jsx)(f.ZP,{htmlType:"submit",disabled:eH,style:{opacity:eH?.5:1},children:"Create Key"})})]})}),e_&&(0,t.jsx)(j.Z,{title:"Create New User",visible:e_,onCancel:()=>eN(!1),footer:null,width:800,children:(0,t.jsx)(A.Z,{userID:s,accessToken:H,teams:I,possibleUIRoles:ek,onUserCreated:e=>{eZ(e),X.setFieldsValue({user_id:e}),eN(!1)},isEmbedded:!0})}),el&&(0,t.jsx)(j.Z,{visible:ee,onOk:eW,onCancel:eJ,footer:null,children:(0,t.jsxs)(n.Z,{numItems:1,className:"gap-2 w-full",children:[(0,t.jsx)(h.Z,{children:"Save your Key"}),(0,t.jsx)(i.Z,{numColSpan:1,children:(0,t.jsxs)("p",{children:["Please save this secret key somewhere safe and accessible. For security reasons,"," ",(0,t.jsx)("b",{children:"you will not be able to view it again"})," through your LiteLLM account. If you lose this secret key, you will need to generate a new one."]})}),(0,t.jsx)(i.Z,{numColSpan:1,children:null!=el?(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Z,{className:"mt-3",children:"API Key:"}),(0,t.jsx)("div",{style:{background:"#f8f8f8",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:(0,t.jsx)("pre",{style:{wordWrap:"break-word",whiteSpace:"normal"},children:el})}),(0,t.jsx)(x.CopyToClipboard,{text:el,onCopy:()=>{K.Z.success("API Key copied to clipboard")},children:(0,t.jsx)(r.Z,{className:"mt-3",children:"Copy API Key"})})]}):(0,t.jsx)(u.Z,{children:"Key being created, this might take 30s"})})]})})]})}}}]);