"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5301],{19046:function(e,t,s){s.d(t,{Dx:function(){return l.Z},Zb:function(){return o.Z},oi:function(){return n.Z},xv:function(){return r.Z},zx:function(){return a.Z}});var a=s(78489),o=s(12514),r=s(84264),n=s(49566),l=s(96761)},88712:function(e,t,s){var a=s(57437);s(2265);var o=s(33145),r=s(66830),n=s(50010);t.Z=e=>{let{message:t}=e;if(!(0,r.br)(t))return null;let s="string"==typeof t.content&&t.content.includes("[PDF attached]");return(0,a.jsx)("div",{className:"mb-2",children:s?(0,a.jsx)("div",{className:"w-64 h-32 rounded-md border border-gray-200 bg-red-50 flex items-center justify-center",children:(0,a.jsx)(n.Z,{style:{fontSize:"48px",color:"#dc2626"}})}):(0,a.jsx)(o.default,{src:t.imagePreviewUrl||"",alt:"User uploaded image",width:256,height:200,className:"max-w-64 rounded-md border border-gray-200 shadow-sm",style:{maxHeight:"200px",width:"auto",height:"auto"}})})}},27930:function(e,t,s){var a=s(57437);s(2265);var o=s(65319),r=s(99981),n=s(53508);let{Dragger:l}=o.default;t.Z=e=>{let{chatUploadedImage:t,chatImagePreviewUrl:s,onImageUpload:o,onRemoveImage:i}=e;return(0,a.jsx)(a.Fragment,{children:!t&&(0,a.jsx)(l,{beforeUpload:o,accept:"image/*,.pdf",showUploadList:!1,className:"inline-block",style:{padding:0,border:"none",background:"none"},children:(0,a.jsx)(r.Z,{title:"Attach image or PDF",children:(0,a.jsx)("button",{type:"button",className:"flex items-center justify-center w-8 h-8 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors",children:(0,a.jsx)(n.Z,{style:{fontSize:"16px"}})})})})})}},66830:function(e,t,s){s.d(t,{Hk:function(){return r},Sn:function(){return o},br:function(){return n}});let a=e=>new Promise((t,s)=>{let a=new FileReader;a.onload=()=>{t(a.result)},a.onerror=s,a.readAsDataURL(e)}),o=async(e,t)=>({role:"user",content:[{type:"text",text:e},{type:"image_url",image_url:{url:await a(t)}}]}),r=(e,t,s,a)=>{let o="";t&&a&&(o=a.toLowerCase().endsWith(".pdf")?"[PDF attached]":"[Image attached]");let r={role:"user",content:t?"".concat(e," ").concat(o):e};return t&&s&&(r.imagePreviewUrl=s),r},n=e=>"user"===e.role&&"string"==typeof e.content&&(e.content.includes("[Image attached]")||e.content.includes("[PDF attached]"))&&!!e.imagePreviewUrl},75301:function(e,t,s){s.d(t,{Z:function(){return e0}});var a=s(57437),o=s(61935),r=s(92403),n=s(12660),l=s(25980),i=s(69993),c=s(55322),d=s(71891),m=s(58630),u=s(15424),x=s(44625),g=s(57400),p=s(26430),h=s(11894),f=s(15883),v=s(99890),b=s(26349),y=s(50010),j=s(79276),N=s(19046),w=s(4260),S=s(65319),k=s(57840),P=s(37592),A=s(79326),C=s(5545),Z=s(99981),T=s(10353),_=s(22116),E=s(2265),I=s(62831),R=s(17906),M=s(94263),L=s(93837),O=s(9309),K=s(67479),U=s(9114),D=s(99020),z=s(97415),F=s(92280),B=s(61994),H=s(19015),G=s(85847),q=e=>{let{temperature:t=1,maxTokens:s=2048,useAdvancedParams:o,onTemperatureChange:r,onMaxTokensChange:n,onUseAdvancedParamsChange:l}=e,[i,c]=(0,E.useState)(!1),d=void 0!==o?o:i,[m,x]=(0,E.useState)(t),[g,p]=(0,E.useState)(s);(0,E.useEffect)(()=>{x(t)},[t]),(0,E.useEffect)(()=>{p(s)},[s]);let h=e=>{let t=null!=e?e:1;x(t),null==r||r(t)},f=e=>{let t=null!=e?e:1e3;p(t),null==n||n(t)},v=d?"text-gray-700":"text-gray-400",b=e=>{l?l(e):c(e)};return(0,a.jsxs)("div",{className:"space-y-4 p-4 w-80",children:[(0,a.jsx)(B.Z,{checked:d,onChange:e=>b(e.target.checked),children:(0,a.jsx)("span",{className:"font-medium",children:"Use Advanced Parameters"})}),(0,a.jsxs)("div",{className:"space-y-4 transition-opacity duration-200",style:{opacity:d?1:.4},children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(F.x,{className:"text-sm ".concat(v),children:"Temperature"}),(0,a.jsx)(Z.Z,{title:"Controls randomness. Lower values make output more deterministic, higher values more creative.",children:(0,a.jsx)(u.Z,{className:"text-xs ".concat(v," cursor-help")})})]}),(0,a.jsx)(H.Z,{min:0,max:2,step:.1,value:m,onChange:h,disabled:!d,precision:1,className:"w-20"})]}),(0,a.jsx)(G.Z,{min:0,max:2,step:.1,value:m,onChange:h,disabled:!d,marks:{0:"0",1:"1.0",2:"2.0"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(F.x,{className:"text-sm ".concat(v),children:"Max Tokens"}),(0,a.jsx)(Z.Z,{title:"Maximum number of tokens to generate in the response.",children:(0,a.jsx)(u.Z,{className:"text-xs ".concat(v," cursor-help")})})]}),(0,a.jsx)(H.Z,{min:1,max:32768,step:1,value:g,onChange:f,disabled:!d})]}),(0,a.jsx)(G.Z,{min:1,max:32768,step:1,value:g,onChange:f,disabled:!d,marks:{1:"1",32768:"32768"}})]})]})]})},J=e=>{let{message:t}=e;return t.isAudio&&"string"==typeof t.content?(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)("audio",{controls:!0,src:t.content,className:"max-w-full",style:{maxWidth:"500px"},children:"Your browser does not support the audio element."})}):null},V=s(8443);let W={ALLOY:"Alloy - Professional and confident",ASH:"Ash - Casual and relaxed",BALAD:"Ballad - Smooth and melodic",CORAL:"Coral - Warm and engaging",ECHO:"Echo - Friendly and conversational",FABLE:"Fable - Wise and measured",NOVA:"Nova - Friendly and conversational",ONYX:"Onyx - Deep and authoritative",SAGE:"Sage - Wise and measured",SHIMMER:"Shimmer - Bright and cheerful"},Y=Object.entries({ALLOY:"alloy",ASH:"ash",BALAD:"ballad",CORAL:"coral",ECHO:"echo",FABLE:"fable",NOVA:"nova",ONYX:"onyx",SAGE:"sage",SHIMMER:"shimmer"}).map(e=>{let[t,s]=e;return{value:s,label:W[t]}}),X=[{value:V.KP.CHAT,label:"/v1/chat/completions"},{value:V.KP.RESPONSES,label:"/v1/responses"},{value:V.KP.ANTHROPIC_MESSAGES,label:"/v1/messages"},{value:V.KP.IMAGE,label:"/v1/images/generations"},{value:V.KP.IMAGE_EDITS,label:"/v1/images/edits"},{value:V.KP.EMBEDDINGS,label:"/v1/embeddings"},{value:V.KP.SPEECH,label:"/v1/audio/speech"},{value:V.KP.TRANSCRIPTION,label:"/v1/audio/transcriptions"},{value:V.KP.A2A_AGENTS,label:"/v1/a2a/message/send"}];var $=s(88712),Q=s(27930),ee=s(66830),et=s(82971),es=e=>{let{endpointType:t,onEndpointChange:s,className:o}=e;return(0,a.jsx)("div",{className:o,children:(0,a.jsx)(P.default,{showSearch:!0,value:t,style:{width:"100%"},onChange:s,options:X,className:"rounded-md"})})},ea=s(85498),eo=s(19250);async function er(e,t,s,a){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=arguments.length>5?arguments[5]:void 0,n=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,i=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,d=arguments.length>10?arguments[10]:void 0,m=arguments.length>11?arguments[11]:void 0,u=arguments.length>12?arguments[12]:void 0;if(!a)throw Error("Virtual Key is required");console.log=function(){};let x=(0,eo.getProxyBaseUrl)(),g={};o&&o.length>0&&(g["x-litellm-tags"]=o.join(","));let p=new ea.ZP({apiKey:a,baseURL:x,dangerouslyAllowBrowser:!0,defaultHeaders:g});try{let o=Date.now(),g=!1,h=u&&u.length>0?[{type:"mcp",server_label:"litellm",server_url:"".concat(x,"/mcp"),require_approval:"never",allowed_tools:u,headers:{"x-litellm-api-key":"Bearer ".concat(a)}}]:void 0,f={model:s,messages:e.map(e=>({role:e.role,content:e.content})),stream:!0,max_tokens:1024,litellm_trace_id:c};for await(let e of(d&&(f.vector_store_ids=d),m&&(f.guardrails=m),h&&(f.tools=h,f.tool_choice="auto"),p.messages.stream(f,{signal:r}))){if(console.log("Stream event:",e),"content_block_delta"===e.type){let a=e.delta;if(!g){g=!0;let e=Date.now()-o;console.log("First token received! Time:",e,"ms"),l&&l(e)}"text_delta"===a.type?t("assistant",a.text,s):"reasoning_delta"===a.type&&n&&n(a.text)}if("message_delta"===e.type&&e.usage&&i){let t=e.usage;console.log("Usage data found:",t);let s={completionTokens:t.output_tokens,promptTokens:t.input_tokens,totalTokens:t.input_tokens+t.output_tokens};i(s)}}}catch(e){throw(null==r?void 0:r.aborted)?console.log("Anthropic messages request was cancelled"):U.Z.fromBackend("Error occurred while generating model response. Please try again. Error: ".concat(e)),e}}var en=s(7271);async function el(e,t,s,a,o,r,n,l,i){console.log=function(){},console.log("isLocal:",!1);let c=(0,eo.getProxyBaseUrl)(),d=new en.ZP.OpenAI({apiKey:o,baseURL:c,dangerouslyAllowBrowser:!0,defaultHeaders:r&&r.length>0?{"x-litellm-tags":r.join(",")}:void 0});try{let o=await d.audio.speech.create({model:a,input:e,voice:t,...l?{response_format:l}:{},...i?{speed:i}:{}},{signal:n}),r=await o.blob(),c=URL.createObjectURL(r);s(c,a)}catch(e){throw(null==n?void 0:n.aborted)?console.log("Audio speech request was cancelled"):U.Z.fromBackend("Error occurred while generating speech. Please try again. Error: ".concat(e)),e}}async function ei(e,t,s,a,o,r,n,l,i,c){console.log=function(){},console.log("isLocal:",!1);let d=(0,eo.getProxyBaseUrl)(),m=new en.ZP.OpenAI({apiKey:a,baseURL:d,dangerouslyAllowBrowser:!0,defaultHeaders:o&&o.length>0?{"x-litellm-tags":o.join(",")}:void 0});try{console.log("Processing audio file for transcription:",e.name);let a=await m.audio.transcriptions.create({model:s,file:e,...n?{language:n}:{},...l?{prompt:l}:{},...i?{response_format:i}:{},...void 0!==c?{temperature:c}:{}},{signal:r});if(console.log("Transcription response:",a),a&&a.text)t(a.text,s),U.Z.success("Audio transcribed successfully");else throw Error("No transcription text in response")}catch(e){if(console.error("Error making audio transcription request:",e),null==r?void 0:r.aborted)console.log("Audio transcription request was cancelled");else{var u;let t="Failed to transcribe audio";(null==e?void 0:null===(u=e.error)||void 0===u?void 0:u.message)?t=e.error.message:(null==e?void 0:e.message)&&(t=e.message),U.Z.fromBackend("Audio transcription failed: ".concat(t))}throw e}}var ec=s(95459);async function ed(e,t,s,a,o){if(!a)throw Error("Virtual Key is required");console.log=function(){};let r=(0,eo.getProxyBaseUrl)(),n={};o&&o.length>0&&(n["x-litellm-tags"]=o.join(","));try{var l,i,c;let o=r.endsWith("/")?r.slice(0,-1):r,d=await fetch("".concat(o,"/embeddings"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a),...n},body:JSON.stringify({model:s,input:e})});if(!d.ok){let e=await d.text();throw Error(e||"Request failed with status ".concat(d.status))}let m=await d.json(),u=null==m?void 0:null===(i=m.data)||void 0===i?void 0:null===(l=i[0])||void 0===l?void 0:l.embedding;if(!u)throw Error("No embedding returned from server");t(JSON.stringify(u),null!==(c=null==m?void 0:m.model)&&void 0!==c?c:s)}catch(e){throw U.Z.fromBackend("Error occurred while making embeddings request. Please try again. Error: ".concat(e)),e}}async function em(e){try{return(await (0,eo.mcpToolsCall)(e)).tools||[]}catch(e){return console.error("Error fetching MCP tools:",e),[]}}var eu=s(10703);async function ex(e,t,s,a,o,r,n){console.log=function(){},console.log("isLocal:",!1);let l=(0,eo.getProxyBaseUrl)(),i=new en.ZP.OpenAI({apiKey:o,baseURL:l,dangerouslyAllowBrowser:!0,defaultHeaders:r&&r.length>0?{"x-litellm-tags":r.join(",")}:void 0});try{let o=Array.isArray(e)?e:[e],r=[];for(let e=0;e<o.length;e++){let l=o[e];console.log("Processing image ".concat(e+1," of ").concat(o.length));let c=await i.images.edit({model:a,image:l,prompt:t},{signal:n});if(console.log("Response for image ".concat(e+1,":"),c.data),c.data&&c.data[0]){if(c.data[0].url)s(c.data[0].url,a),r.push(c.data[0].url);else if(c.data[0].b64_json){let e=c.data[0].b64_json,t="data:image/png;base64,".concat(e);s(t,a),r.push(t)}}}r.length>1&&U.Z.success("Successfully processed ".concat(r.length," images"))}catch(e){if(console.error("Error making image edit request:",e),null==n?void 0:n.aborted)console.log("Image edits request was cancelled");else{var c;let t="Failed to edit image(s)";(null==e?void 0:null===(c=e.error)||void 0===c?void 0:c.message)?t=e.error.message:(null==e?void 0:e.message)&&(t=e.message),U.Z.fromBackend("Image edit failed: ".concat(t))}throw e}}async function eg(e,t,s,a,o,r){console.log=function(){},console.log("isLocal:",!1);let n=(0,eo.getProxyBaseUrl)(),l=new en.ZP.OpenAI({apiKey:a,baseURL:n,dangerouslyAllowBrowser:!0,defaultHeaders:o&&o.length>0?{"x-litellm-tags":o.join(",")}:void 0});try{let a=await l.images.generate({model:s,prompt:e},{signal:r});if(console.log(a.data),a.data&&a.data[0]){if(a.data[0].url)t(a.data[0].url,s);else if(a.data[0].b64_json){let e=a.data[0].b64_json;t("data:image/png;base64,".concat(e),s)}else throw Error("No image data found in response")}else throw Error("Invalid response format")}catch(e){throw(null==r?void 0:r.aborted)?console.log("Image generation request was cancelled"):U.Z.fromBackend("Error occurred while generating image. Please try again. Error: ".concat(e)),e}}async function ep(e,t,s,a){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=arguments.length>5?arguments[5]:void 0,n=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,i=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,d=arguments.length>10?arguments[10]:void 0,m=arguments.length>11?arguments[11]:void 0,u=arguments.length>12?arguments[12]:void 0,x=arguments.length>13?arguments[13]:void 0,g=arguments.length>14?arguments[14]:void 0,p=arguments.length>15?arguments[15]:void 0;if(!a)throw Error("Virtual Key is required");console.log=function(){};let h=(0,eo.getProxyBaseUrl)(),f={};o&&o.length>0&&(f["x-litellm-tags"]=o.join(","));let v=new en.ZP.OpenAI({apiKey:a,baseURL:h,dangerouslyAllowBrowser:!0,defaultHeaders:f});try{let a=Date.now(),o=!1,h=e.map(e=>(Array.isArray(e.content),{role:e.role,content:e.content,type:"message"})),f=u&&u.length>0?[{type:"mcp",server_label:"litellm",server_url:"litellm_proxy/mcp",require_approval:"never",allowed_tools:u}]:void 0,P=await v.responses.create({model:s,input:h,stream:!0,litellm_trace_id:c,...x?{previous_response_id:x}:{},...d?{vector_store_ids:d}:{},...m?{guardrails:m}:{},...f?{tools:f,tool_choice:"required"}:{}},{signal:r}),A="";for await(let e of P)if(console.log("Response event:",e),"object"==typeof e&&null!==e){var b,y,j,N,w,S,k;if(((null===(b=e.type)||void 0===b?void 0:b.startsWith("response.mcp_"))||"response.output_item.done"===e.type&&((null===(y=e.item)||void 0===y?void 0:y.type)==="mcp_list_tools"||(null===(j=e.item)||void 0===j?void 0:j.type)==="mcp_call"))&&(console.log("MCP event received:",e),p)){let t={type:e.type,sequence_number:e.sequence_number,output_index:e.output_index,item_id:e.item_id||(null===(S=e.item)||void 0===S?void 0:S.id),item:e.item,delta:e.delta,arguments:e.arguments,timestamp:Date.now()};p(t)}if("response.output_item.done"===e.type&&(null===(N=e.item)||void 0===N?void 0:N.type)==="mcp_call"&&(null===(w=e.item)||void 0===w?void 0:w.name)&&(A=e.item.name,console.log("MCP tool used:",A)),"response.role.delta"===e.type)continue;if("response.output_text.delta"===e.type&&"string"==typeof e.delta){let r=e.delta;if(console.log("Text delta",r),r.trim().length>0&&(t("assistant",r,s),!o)){o=!0;let e=Date.now()-a;console.log("First token received! Time:",e,"ms"),l&&l(e)}}if("response.reasoning.delta"===e.type&&"delta"in e){let t=e.delta;"string"==typeof t&&n&&n(t)}if("response.completed"===e.type&&"response"in e){let t=e.response,s=t.usage;if(console.log("Usage data:",s),console.log("Response completed event:",t),t.id&&g&&(console.log("Response ID for session management:",t.id),g(t.id)),s&&i){console.log("Usage data:",s);let e={completionTokens:s.output_tokens,promptTokens:s.input_tokens,totalTokens:s.total_tokens};(null===(k=s.completion_tokens_details)||void 0===k?void 0:k.reasoning_tokens)&&(e.reasoningTokens=s.completion_tokens_details.reasoning_tokens),i(e,A)}}}return P}catch(e){throw(null==r?void 0:r.aborted)?console.log("Responses API request was cancelled"):U.Z.fromBackend("Error occurred while generating model response. Please try again. Error: ".concat(e)),e}}let eh=async e=>{try{let t=(0,eo.getProxyBaseUrl)(),s=await fetch(t?"".concat(t,"/v1/agents"):"/v1/agents",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok){let e=await s.json();throw Error(e.detail||"Failed to fetch agents")}let a=await s.json();return console.log("Fetched agents:",a),a.sort((e,t)=>{let s=e.agent_name||e.agent_id,a=t.agent_name||t.agent_id;return s.localeCompare(a)}),a}catch(e){throw console.error("Error fetching agents:",e),e}},ef=e=>{if(!e)return;let t={};if(e.id&&(t.taskId=e.id),e.contextId&&(t.contextId=e.contextId),e.status){var s;if(t.status={state:e.status.state,timestamp:e.status.timestamp},null===(s=e.status.message)||void 0===s?void 0:s.parts){let s=e.status.message.parts.filter(e=>"text"===e.kind&&e.text).map(e=>e.text).join(" ");s&&(t.status.message=s)}}return e.metadata&&"object"==typeof e.metadata&&(t.metadata=e.metadata),Object.keys(t).length>0?t:void 0},ev=async(e,t,s,a,o,r,n,l)=>{let i;let c=(0,eo.getProxyBaseUrl)(),d=c?"".concat(c,"/a2a/").concat(e):"/a2a/".concat(e),m=(0,L.Z)(),u=(0,L.Z)().replace(/-/g,""),x=performance.now(),g=!1,p="";try{var h,f,v,b;let c=await fetch(d,{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:m,method:"message/stream",params:{message:{kind:"message",messageId:u,role:"user",parts:[{kind:"text",text:t}]}}}),signal:o});if(!c.ok){let e=await c.json();throw Error((null===(f=e.error)||void 0===f?void 0:f.message)||e.detail||"HTTP ".concat(c.status))}let y=null===(h=c.body)||void 0===h?void 0:h.getReader();if(!y)throw Error("No response body");let j=new TextDecoder,N="",w=!1;for(;!w;){let t=await y.read();w=t.done;let a=t.value;if(w)break;let o=(N+=j.decode(a,{stream:!0})).split("\n");for(let t of(N=o.pop()||"",o))if(t.trim())try{let a=JSON.parse(t);if(!g){g=!0;let e=performance.now()-x;r&&r(e)}let o=a.result;if(o){let t=ef(o);t&&(i={...i,...t});let a=o.kind;if("artifact-update"===a&&o.artifact){let t=o.artifact;if(t.parts&&Array.isArray(t.parts))for(let a of t.parts)"text"===a.kind&&a.text&&(p+=a.text,s(p,"a2a_agent/".concat(e)))}else if(o.artifacts&&Array.isArray(o.artifacts)){for(let t of o.artifacts)if(t.parts&&Array.isArray(t.parts))for(let a of t.parts)"text"===a.kind&&a.text&&(p+=a.text,s(p,"a2a_agent/".concat(e)))}else if("status-update"===a&&(null===(b=o.status)||void 0===b?void 0:null===(v=b.message)||void 0===v?void 0:v.parts)){if(!p)for(let t of o.status.message.parts)"text"===t.kind&&t.text&&s(t.text,"a2a_agent/".concat(e))}else if(o.parts&&Array.isArray(o.parts))for(let t of o.parts)"text"===t.kind&&t.text&&(p+=t.text,s(p,"a2a_agent/".concat(e)))}if(a.error)throw Error(a.error.message)}catch(e){t.trim().length>0&&console.warn("Failed to parse A2A streaming chunk:",t,e)}}let S=performance.now()-x;n&&n(S),i&&l&&l(i)}catch(e){if(null==o?void 0:o.aborted){console.log("A2A streaming request was cancelled");return}throw console.error("A2A stream message error:",e),e}};var eb=s(83669),ey=s(29271),ej=s(5540),eN=s(38434),ew=s(23639),eS=s(62272),ek=s(70464),eP=s(77565);let eA=e=>{switch(e){case"completed":return(0,a.jsx)(eb.Z,{className:"text-green-500"});case"working":case"submitted":return(0,a.jsx)(o.Z,{className:"text-blue-500"});case"failed":case"canceled":return(0,a.jsx)(ey.Z,{className:"text-red-500"});default:return(0,a.jsx)(ej.Z,{className:"text-gray-500"})}},eC=e=>{switch(e){case"completed":return"bg-green-100 text-green-700";case"working":case"submitted":return"bg-blue-100 text-blue-700";case"failed":case"canceled":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},eZ=e=>{if(!e)return null;try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch(t){return e}},eT=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return e?e.length>t?"".concat(e.substring(0,t),"…"):e:null},e_=e=>{navigator.clipboard.writeText(e)};var eE=e=>{let{a2aMetadata:t,timeToFirstToken:s,totalLatency:o}=e,[r,n]=(0,E.useState)(!1);if(!t&&!s&&!o)return null;let{taskId:l,contextId:c,status:d,metadata:m}=t||{},u=eZ(null==d?void 0:d.timestamp);return(0,a.jsxs)("div",{className:"a2a-metrics mt-3 pt-2 border-t border-gray-200 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2 text-gray-600",children:[(0,a.jsx)(i.Z,{className:"mr-1.5 text-blue-500"}),(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"A2A Metadata"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-gray-500 ml-4",children:[(null==d?void 0:d.state)&&(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat(eC(d.state)),children:[eA(d.state),(0,a.jsx)("span",{className:"ml-1 capitalize",children:d.state})]}),u&&(0,a.jsx)(Z.Z,{title:null==d?void 0:d.timestamp,children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(ej.Z,{className:"mr-1"}),u]})}),void 0!==o&&(0,a.jsx)(Z.Z,{title:"Total latency",children:(0,a.jsxs)("span",{className:"flex items-center text-blue-600",children:[(0,a.jsx)(ej.Z,{className:"mr-1"}),(o/1e3).toFixed(2),"s"]})}),void 0!==s&&(0,a.jsx)(Z.Z,{title:"Time to first token",children:(0,a.jsxs)("span",{className:"flex items-center text-green-600",children:["TTFT: ",(s/1e3).toFixed(2),"s"]})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-gray-500 ml-4 mt-1.5",children:[l&&(0,a.jsx)(Z.Z,{title:"Click to copy: ".concat(l),children:(0,a.jsxs)("span",{className:"flex items-center cursor-pointer hover:text-gray-700",onClick:()=>e_(l),children:[(0,a.jsx)(eN.Z,{className:"mr-1"}),"Task: ",eT(l),(0,a.jsx)(ew.Z,{className:"ml-1 text-gray-400 hover:text-gray-600"})]})}),c&&(0,a.jsx)(Z.Z,{title:"Click to copy: ".concat(c),children:(0,a.jsxs)("span",{className:"flex items-center cursor-pointer hover:text-gray-700",onClick:()=>e_(c),children:[(0,a.jsx)(eS.Z,{className:"mr-1"}),"Session: ",eT(c),(0,a.jsx)(ew.Z,{className:"ml-1 text-gray-400 hover:text-gray-600"})]})}),(m||(null==d?void 0:d.message))&&(0,a.jsxs)(C.ZP,{type:"text",size:"small",className:"text-xs text-blue-500 hover:text-blue-700 p-0 h-auto",onClick:()=>n(!r),children:[r?(0,a.jsx)(ek.Z,{}):(0,a.jsx)(eP.Z,{}),(0,a.jsx)("span",{className:"ml-1",children:"Details"})]})]}),r&&(0,a.jsxs)("div",{className:"mt-2 ml-4 p-3 bg-gray-50 rounded-md text-gray-600 border border-gray-200",children:[(null==d?void 0:d.message)&&(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Status Message:"}),(0,a.jsx)("span",{className:"ml-2",children:d.message})]}),l&&(0,a.jsxs)("div",{className:"mb-1.5 flex items-center",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700 w-24",children:"Task ID:"}),(0,a.jsx)("code",{className:"ml-2 px-2 py-1 bg-white border border-gray-200 rounded text-xs font-mono",children:l}),(0,a.jsx)(ew.Z,{className:"ml-2 cursor-pointer text-gray-400 hover:text-blue-500",onClick:()=>e_(l)})]}),c&&(0,a.jsxs)("div",{className:"mb-1.5 flex items-center",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700 w-24",children:"Session ID:"}),(0,a.jsx)("code",{className:"ml-2 px-2 py-1 bg-white border border-gray-200 rounded text-xs font-mono",children:c}),(0,a.jsx)(ew.Z,{className:"ml-2 cursor-pointer text-gray-400 hover:text-blue-500",onClick:()=>e_(c)})]}),m&&Object.keys(m).length>0&&(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Custom Metadata:"}),(0,a.jsx)("pre",{className:"mt-1.5 p-2 bg-white border border-gray-200 rounded text-xs font-mono overflow-x-auto whitespace-pre-wrap",children:JSON.stringify(m,null,2)})]})]})]})},eI=s(29),eR=s.n(eI),eM=s(44851);let{Text:eL}=k.default,{Panel:eO}=eM.default;var eK=e=>{var t,s;let{events:o,className:r}=e;if(console.log("MCPEventsDisplay: Received events:",o),!o||0===o.length)return console.log("MCPEventsDisplay: No events, returning null"),null;let n=o.find(e=>{var t;return"response.output_item.done"===e.type&&(null===(t=e.item)||void 0===t?void 0:t.type)==="mcp_list_tools"&&e.item.tools&&e.item.tools.length>0}),l=o.filter(e=>{var t;return"response.output_item.done"===e.type&&(null===(t=e.item)||void 0===t?void 0:t.type)==="mcp_call"});return(console.log("MCPEventsDisplay: toolsEvent:",n),console.log("MCPEventsDisplay: mcpCallEvents:",l),n||0!==l.length)?(0,a.jsxs)("div",{className:"jsx-32b14b04f420f3ac "+"mcp-events-display ".concat(r||""),children:[(0,a.jsx)(eR(),{id:"32b14b04f420f3ac",children:'.openai-mcp-tools.jsx-32b14b04f420f3ac{position:relative;margin:0;padding:0}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse.jsx-32b14b04f420f3ac{background:transparent!important;border:none!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-item.jsx-32b14b04f420f3ac{border:none!important;background:transparent!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-header.jsx-32b14b04f420f3ac{padding:0 0 0 20px!important;background:transparent!important;border:none!important;font-size:14px!important;color:#9ca3af!important;font-weight:400!important;line-height:20px!important;min-height:20px!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-header.jsx-32b14b04f420f3ac:hover{background:transparent!important;color:#6b7280!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-content.jsx-32b14b04f420f3ac{border:none!important;background:transparent!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-content-box.jsx-32b14b04f420f3ac{padding:4px 0 0 20px!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-expand-icon.jsx-32b14b04f420f3ac{position:absolute!important;left:2px!important;top:2px!important;color:#9ca3af!important;font-size:10px!important;width:16px!important;height:16px!important;display:-webkit-box!important;display:-webkit-flex!important;display:-moz-box!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-moz-box-align:center!important;-ms-flex-align:center!important;align-items:center!important;-webkit-box-pack:center!important;-webkit-justify-content:center!important;-moz-box-pack:center!important;-ms-flex-pack:center!important;justify-content:center!important}.openai-mcp-tools.jsx-32b14b04f420f3ac .ant-collapse-expand-icon.jsx-32b14b04f420f3ac:hover{color:#6b7280!important}.openai-vertical-line.jsx-32b14b04f420f3ac{position:absolute;left:9px;top:18px;bottom:0;width:.5px;background-color:#f3f4f6;opacity:.8}.tool-item.jsx-32b14b04f420f3ac{font-family:ui-monospace,SFMono-Regular,"SF Mono",Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:13px;color:#4b5563;line-height:18px;padding:0;margin:0;background:white;position:relative;z-index:1}.mcp-section.jsx-32b14b04f420f3ac{margin-bottom:12px;background:white;position:relative;z-index:1}.mcp-section.jsx-32b14b04f420f3ac:last-child{margin-bottom:0}.mcp-section-header.jsx-32b14b04f420f3ac{font-size:13px;color:#6b7280;font-weight:500;margin-bottom:4px}.mcp-code-block.jsx-32b14b04f420f3ac{background:#f9fafb;border:1px solid#f3f4f6;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;padding:8px;font-size:12px}.mcp-json.jsx-32b14b04f420f3ac{font-family:ui-monospace,SFMono-Regular,"SF Mono",Monaco,Consolas,"Liberation Mono","Courier New",monospace;color:#374151;margin:0;white-space:pre-wrap;word-wrap:break-word}.mcp-approved.jsx-32b14b04f420f3ac{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;font-size:13px;color:#6b7280}.mcp-checkmark.jsx-32b14b04f420f3ac{color:#10b981;margin-right:6px;font-weight:bold}.mcp-response-content.jsx-32b14b04f420f3ac{font-size:13px;color:#374151;line-height:1.5;white-space:pre-wrap;font-family:ui-monospace,SFMono-Regular,"SF Mono",Monaco,Consolas,"Liberation Mono","Courier New",monospace}'}),(0,a.jsxs)("div",{className:"jsx-32b14b04f420f3ac openai-mcp-tools",children:[(0,a.jsx)("div",{className:"jsx-32b14b04f420f3ac openai-vertical-line"}),(0,a.jsxs)(eM.default,{ghost:!0,size:"small",expandIconPosition:"start",defaultActiveKey:n?["list-tools"]:l.map((e,t)=>"mcp-call-".concat(t)),children:[n&&(0,a.jsx)(eO,{header:"List tools",children:(0,a.jsx)("div",{className:"jsx-32b14b04f420f3ac",children:null===(s=n.item)||void 0===s?void 0:null===(t=s.tools)||void 0===t?void 0:t.map((e,t)=>(0,a.jsx)("div",{className:"jsx-32b14b04f420f3ac tool-item",children:e.name},t))})},"list-tools"),l.map((e,t)=>{var s,o,r;return(0,a.jsx)(eO,{header:(null===(s=e.item)||void 0===s?void 0:s.name)||"Tool call",children:(0,a.jsxs)("div",{className:"jsx-32b14b04f420f3ac",children:[(0,a.jsxs)("div",{className:"jsx-32b14b04f420f3ac mcp-section",children:[(0,a.jsx)("div",{className:"jsx-32b14b04f420f3ac mcp-section-header",children:"Request"}),(0,a.jsx)("div",{className:"jsx-32b14b04f420f3ac mcp-code-block",children:(null===(o=e.item)||void 0===o?void 0:o.arguments)&&(0,a.jsx)("pre",{className:"jsx-32b14b04f420f3ac mcp-json",children:(()=>{try{return JSON.stringify(JSON.parse(e.item.arguments),null,2)}catch(t){return e.item.arguments}})()})})]}),(0,a.jsx)("div",{className:"jsx-32b14b04f420f3ac mcp-section",children:(0,a.jsxs)("div",{className:"jsx-32b14b04f420f3ac mcp-approved",children:[(0,a.jsx)("span",{className:"jsx-32b14b04f420f3ac mcp-checkmark",children:"✓"})," Approved"]})}),(null===(r=e.item)||void 0===r?void 0:r.output)&&(0,a.jsxs)("div",{className:"jsx-32b14b04f420f3ac mcp-section",children:[(0,a.jsx)("div",{className:"jsx-32b14b04f420f3ac mcp-section-header",children:"Response"}),(0,a.jsx)("div",{className:"jsx-32b14b04f420f3ac mcp-response-content",children:e.item.output})]})]})},"mcp-call-".concat(t))})]})]})]}):(console.log("MCPEventsDisplay: No valid events found, returning null"),null)},eU=s(94331),eD=s(38398);let ez=e=>new Promise((t,s)=>{let a=new FileReader;a.onload=()=>{t(a.result.split(",")[1])},a.onerror=s,a.readAsDataURL(e)}),eF=async(e,t)=>{let s=await ez(t),a=t.type||(t.name.toLowerCase().endsWith(".pdf")?"application/pdf":"image/jpeg");return{role:"user",content:[{type:"input_text",text:e},{type:"input_image",image_url:"data:".concat(a,";base64,").concat(s)}]}},eB=(e,t,s,a)=>{let o="";t&&a&&(o=a.toLowerCase().endsWith(".pdf")?"[PDF attached]":"[Image attached]");let r={role:"user",content:t?"".concat(e," ").concat(o):e};return t&&s&&(r.imagePreviewUrl=s),r},eH=e=>"user"===e.role&&"string"==typeof e.content&&(e.content.includes("[Image attached]")||e.content.includes("[PDF attached]"))&&!!e.imagePreviewUrl;var eG=e=>{let{message:t}=e;if(!eH(t))return null;let s="string"==typeof t.content&&t.content.includes("[PDF attached]");return(0,a.jsx)("div",{className:"mb-2",children:s?(0,a.jsx)("div",{className:"w-64 h-32 rounded-md border border-gray-200 bg-red-50 flex items-center justify-center",children:(0,a.jsx)(y.Z,{style:{fontSize:"48px",color:"#dc2626"}})}):(0,a.jsx)("img",{src:t.imagePreviewUrl,alt:"User uploaded image",className:"max-w-64 rounded-md border border-gray-200 shadow-sm",style:{maxHeight:"200px"}})})},eq=s(53508);let{Dragger:eJ}=S.default;var eV=e=>{let{responsesUploadedImage:t,responsesImagePreviewUrl:s,onImageUpload:o,onRemoveImage:r}=e;return(0,a.jsx)(a.Fragment,{children:!t&&(0,a.jsx)(eJ,{beforeUpload:o,accept:"image/*,.pdf",showUploadList:!1,className:"inline-block",style:{padding:0,border:"none",background:"none"},children:(0,a.jsx)(Z.Z,{title:"Attach image or PDF",children:(0,a.jsx)("button",{type:"button",className:"flex items-center justify-center w-8 h-8 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors",children:(0,a.jsx)(eq.Z,{style:{fontSize:"16px"}})})})})})},eW=s(33152),eY=s(63709),eX=e=>{let{endpointType:t,responsesSessionId:s,useApiSessionManagement:o,onToggleSessionManagement:r}=e;return t!==V.KP.RESPONSES?null:(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Session Management"}),(0,a.jsx)(Z.Z,{title:"Choose between LiteLLM API session management (using previous_response_id) or UI-based session management (using chat history)",children:(0,a.jsx)(u.Z,{className:"text-gray-400",style:{fontSize:"12px"}})})]}),(0,a.jsx)(eY.Z,{checked:o,onChange:r,checkedChildren:"API",unCheckedChildren:"UI",size:"small"})]}),(0,a.jsxs)("div",{className:"text-xs p-2 rounded-md ".concat(s?"bg-green-50 text-green-700 border border-green-200":"bg-blue-50 text-blue-700 border border-blue-200"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(u.Z,{style:{fontSize:"12px"}}),(()=>{if(!s)return o?"API Session: Ready":"UI Session: Ready";let e=o?"Response ID":"UI Session",t=s.slice(0,10);return"".concat(e,": ").concat(t,"...")})()]}),s&&(0,a.jsx)(Z.Z,{title:(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("div",{className:"mb-1",children:"Copy response ID to continue session:"}),(0,a.jsx)("div",{className:"bg-gray-800 text-gray-100 p-2 rounded font-mono text-xs whitespace-pre-wrap",children:'curl -X POST "your-proxy-url/v1/responses" \\\n  -H "Authorization: Bearer your-api-key" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "model": "your-model",\n    "input": [{"role": "user", "content": "your message", "type": "message"}],\n    "previous_response_id": "'.concat(s,'",\n    "stream": true\n  }\'')})]}),overlayStyle:{maxWidth:"500px"},children:(0,a.jsx)("button",{onClick:()=>{s&&(navigator.clipboard.writeText(s),U.Z.success("Response ID copied to clipboard!"))},className:"ml-2 p-1 hover:bg-green-100 rounded transition-colors",children:(0,a.jsx)(ew.Z,{style:{fontSize:"12px"}})})})]}),(0,a.jsx)("div",{className:"text-xs opacity-75 mt-1",children:s?o?"LiteLLM API session active - context maintained server-side":"UI session active - context maintained client-side":o?"LiteLLM will manage session using previous_response_id":"UI will manage session using chat history"})]})]})};let{TextArea:e$}=w.default,{Dragger:eQ}=S.default;var e0=e=>{let{accessToken:t,token:s,userRole:w,userID:S,disabledPersonalKeyCreation:F,proxySettings:B}=e,[H,G]=(0,E.useState)(!1),[W,X]=(0,E.useState)([]),[ea,eo]=(0,E.useState)(()=>{let e=sessionStorage.getItem("selectedMCPTools");try{let t=e?JSON.parse(e):[];return Array.isArray(t)?t:t?[t]:[]}catch(e){return console.error("Error parsing selectedMCPTools from sessionStorage",e),[]}}),[en,ef]=(0,E.useState)(!1),[eb,ey]=(0,E.useState)(()=>{let e=sessionStorage.getItem("apiKeySource");if(e)try{return JSON.parse(e)}catch(e){console.error("Error parsing apiKeySource from sessionStorage",e)}return F?"custom":"session"}),[ej,eN]=(0,E.useState)(()=>sessionStorage.getItem("apiKey")||""),[ew,eS]=(0,E.useState)(""),[ek,eP]=(0,E.useState)(()=>{try{let e=sessionStorage.getItem("chatHistory");return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing chatHistory from sessionStorage",e),[]}}),[eA,eC]=(0,E.useState)(void 0),[eZ,eT]=(0,E.useState)(!1),[e_,eI]=(0,E.useState)([]),[eR,eM]=(0,E.useState)([]),[eL,eO]=(0,E.useState)(void 0),ez=(0,E.useRef)(null),[eH,eq]=(0,E.useState)(()=>sessionStorage.getItem("endpointType")||V.KP.CHAT),[eJ,eY]=(0,E.useState)(!1),e0=(0,E.useRef)(null),[e1,e2]=(0,E.useState)(()=>{let e=sessionStorage.getItem("selectedTags");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedTags from sessionStorage",e),[]}}),[e4,e3]=(0,E.useState)(()=>{let e=sessionStorage.getItem("selectedVoice");if(!e)return"alloy";try{return JSON.parse(e)}catch(t){return e}}),[e5,e6]=(0,E.useState)(()=>{let e=sessionStorage.getItem("selectedVectorStores");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedVectorStores from sessionStorage",e),[]}}),[e7,e8]=(0,E.useState)(()=>{let e=sessionStorage.getItem("selectedGuardrails");try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing selectedGuardrails from sessionStorage",e),[]}}),[e9,te]=(0,E.useState)(()=>sessionStorage.getItem("messageTraceId")||null),[tt,ts]=(0,E.useState)(()=>sessionStorage.getItem("responsesSessionId")||null),[ta,to]=(0,E.useState)(()=>{let e=sessionStorage.getItem("useApiSessionManagement");return!e||JSON.parse(e)}),[tr,tn]=(0,E.useState)([]),[tl,ti]=(0,E.useState)([]),[tc,td]=(0,E.useState)(null),[tm,tu]=(0,E.useState)(null),[tx,tg]=(0,E.useState)(null),[tp,th]=(0,E.useState)(null),[tf,tv]=(0,E.useState)(null),[tb,ty]=(0,E.useState)(!1),[tj,tN]=(0,E.useState)(""),[tw,tS]=(0,E.useState)("openai"),[tk,tP]=(0,E.useState)([]),[tA,tC]=(0,E.useState)(1),[tZ,tT]=(0,E.useState)(2048),[t_,tE]=(0,E.useState)(!1),tI=(0,E.useRef)(null),tR=async()=>{let e="session"===eb?t:ej;if(e){ef(!0);try{let t=await em(e);X(t)}catch(e){console.error("Error fetching MCP tools:",e)}finally{ef(!1)}}};(0,E.useEffect)(()=>{H&&tR()},[H,t,ej,eb]),(0,E.useEffect)(()=>{tb&&tN((0,et.L)({apiKeySource:eb,accessToken:t,apiKey:ej,inputMessage:ew,chatHistory:ek,selectedTags:e1,selectedVectorStores:e5,selectedGuardrails:e7,selectedMCPTools:ea,endpointType:eH,selectedModel:eA,selectedSdk:tw,selectedVoice:e4,proxySettings:B}))},[tb,tw,eb,t,ej,ew,ek,e1,e5,e7,ea,eH,eA,B]),(0,E.useEffect)(()=>{let e=setTimeout(()=>{sessionStorage.setItem("chatHistory",JSON.stringify(ek))},500);return()=>{clearTimeout(e)}},[ek]),(0,E.useEffect)(()=>{sessionStorage.setItem("apiKeySource",JSON.stringify(eb)),sessionStorage.setItem("apiKey",ej),sessionStorage.setItem("endpointType",eH),sessionStorage.setItem("selectedTags",JSON.stringify(e1)),sessionStorage.setItem("selectedVectorStores",JSON.stringify(e5)),sessionStorage.setItem("selectedGuardrails",JSON.stringify(e7)),sessionStorage.setItem("selectedMCPTools",JSON.stringify(ea)),sessionStorage.setItem("selectedVoice",e4),eA?sessionStorage.setItem("selectedModel",eA):sessionStorage.removeItem("selectedModel"),e9?sessionStorage.setItem("messageTraceId",e9):sessionStorage.removeItem("messageTraceId"),tt?sessionStorage.setItem("responsesSessionId",tt):sessionStorage.removeItem("responsesSessionId"),sessionStorage.setItem("useApiSessionManagement",JSON.stringify(ta))},[eb,ej,eA,eH,e1,e5,e7,e9,tt,ta,ea,e4]),(0,E.useEffect)(()=>{let e="session"===eb?t:ej;if(!e||!s||!w||!S){console.log("userApiKey or token or userRole or userID is missing = ",e,s,w,S);return}(async()=>{try{if(!e){console.log("userApiKey is missing");return}let t=await (0,eu.p)(e);console.log("Fetched models:",t),eI(t);let s=t.some(e=>e.model_group===eA);t.length&&s||eC(void 0)}catch(e){console.error("Error fetching model info:",e)}})(),tR()},[t,S,w,eb,ej,s]),(0,E.useEffect)(()=>{let e="session"===eb?t:ej;e&&eH===V.KP.A2A_AGENTS&&(async()=>{try{let t=await eh(e);eM(t),eL&&!t.some(e=>e.agent_name===eL)&&eO(void 0)}catch(e){console.error("Error fetching agents:",e)}})()},[t,eb,ej,eH]),(0,E.useEffect)(()=>{tI.current&&setTimeout(()=>{var e;null===(e=tI.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})},100)},[ek]);let tM=(e,t,s)=>{console.log("updateTextUI called with:",e,t,s),eP(a=>{let o=a[a.length-1];if(!o||o.role!==e||o.isImage||o.isAudio)return[...a,{role:e,content:t,model:s}];{var r;let e={...o,content:o.content+t,model:null!==(r=o.model)&&void 0!==r?r:s};return[...a.slice(0,-1),e]}})},tL=e=>{eP(t=>{let s=t[t.length-1];return!s||"assistant"!==s.role||s.isImage||s.isAudio?t.length>0&&"user"===t[t.length-1].role?[...t,{role:"assistant",content:"",reasoningContent:e}]:t:[...t.slice(0,t.length-1),{...s,reasoningContent:(s.reasoningContent||"")+e}]})},tO=e=>{console.log("updateTimingData called with:",e),eP(t=>{let s=t[t.length-1];if(console.log("Current last message:",s),s&&"assistant"===s.role){console.log("Updating assistant message with timeToFirstToken:",e);let a=[...t.slice(0,t.length-1),{...s,timeToFirstToken:e}];return console.log("Updated chat history:",a),a}return s&&"user"===s.role?(console.log("Creating new assistant message with timeToFirstToken:",e),[...t,{role:"assistant",content:"",timeToFirstToken:e}]):(console.log("No appropriate message found to update timing"),t)})},tK=(e,t)=>{console.log("Received usage data:",e),eP(s=>{let a=s[s.length-1];if(a&&"assistant"===a.role){console.log("Updating message with usage data:",e);let o={...a,usage:e,toolName:t};return console.log("Updated message:",o),[...s.slice(0,s.length-1),o]}return s})},tU=e=>{console.log("Received A2A metadata:",e),eP(t=>{let s=t[t.length-1];if(s&&"assistant"===s.role){let a={...s,a2aMetadata:e};return[...t.slice(0,t.length-1),a]}return t})},tD=e=>{eP(t=>{let s=t[t.length-1];return s&&"assistant"===s.role?[...t.slice(0,t.length-1),{...s,totalLatency:e}]:t})},tz=e=>{console.log("Received search results:",e),eP(t=>{let s=t[t.length-1];if(s&&"assistant"===s.role){console.log("Updating message with search results");let a={...s,searchResults:e};return[...t.slice(0,t.length-1),a]}return t})},tF=e=>{console.log("Received response ID for session management:",e),ta&&ts(e)},tB=e=>{console.log("ChatUI: Received MCP event:",e),tP(t=>{if(t.some(t=>t.item_id===e.item_id&&t.type===e.type&&t.sequence_number===e.sequence_number))return console.log("ChatUI: Duplicate MCP event, skipping"),t;let s=[...t,e];return console.log("ChatUI: Updated MCP events:",s),s})},tH=(e,t)=>{eP(s=>[...s,{role:"assistant",content:e,model:t,isImage:!0}])},tG=(e,t)=>{eP(s=>[...s,{role:"assistant",content:(0,O.aS)(e,100),model:t,isEmbeddings:!0}])},tq=(e,t)=>{eP(s=>[...s,{role:"assistant",content:e,model:t,isAudio:!0}])},tJ=(e,t)=>{eP(s=>{let a=s[s.length-1];if(!a||"assistant"!==a.role||a.isImage||a.isAudio)return[...s,{role:"assistant",content:"",model:t,image:{url:e,detail:"auto"}}];{var o;let r={...a,image:{url:e,detail:"auto"},model:null!==(o=a.model)&&void 0!==o?o:t};return[...s.slice(0,-1),r]}})},tV=e=>{tn(t=>[...t,e]);let t=URL.createObjectURL(e);return ti(e=>[...e,t]),!1},tW=e=>{tl[e]&&URL.revokeObjectURL(tl[e]),tn(t=>t.filter((t,s)=>s!==e)),ti(t=>t.filter((t,s)=>s!==e))},tY=()=>{tl.forEach(e=>{URL.revokeObjectURL(e)}),tn([]),ti([])},tX=()=>{tm&&URL.revokeObjectURL(tm),td(null),tu(null)},t$=()=>{tp&&URL.revokeObjectURL(tp),tg(null),th(null)},tQ=()=>{tv(null)},t0=async()=>{let e;if(""===ew.trim()&&eH!==V.KP.TRANSCRIPTION)return;if(eH===V.KP.IMAGE_EDITS&&0===tr.length){U.Z.fromBackend("Please upload at least one image for editing");return}if(eH===V.KP.TRANSCRIPTION&&!tf){U.Z.fromBackend("Please upload an audio file for transcription");return}if(eH===V.KP.A2A_AGENTS&&!eL){U.Z.fromBackend("Please select an agent to send a message");return}if(!s||!w||!S)return;let a="session"===eb?t:ej;if(!a){U.Z.fromBackend("Please provide a Virtual Key or select Current UI Session");return}e0.current=new AbortController;let o=e0.current.signal;if(eH===V.KP.RESPONSES&&tc)try{e=await eF(ew,tc)}catch(e){U.Z.fromBackend("Failed to process image. Please try again.");return}else if(eH===V.KP.CHAT&&tx)try{e=await (0,ee.Sn)(ew,tx)}catch(e){U.Z.fromBackend("Failed to process image. Please try again.");return}else e={role:"user",content:ew};let r=e9||(0,L.Z)();e9||te(r),eP([...ek,eH===V.KP.RESPONSES&&tc?eB(ew,!0,tm||void 0,tc.name):eH===V.KP.CHAT&&tx?(0,ee.Hk)(ew,!0,tp||void 0,tx.name):eH===V.KP.TRANSCRIPTION&&tf?eB(ew?"\uD83C\uDFB5 Audio file: ".concat(tf.name,"\nPrompt: ").concat(ew):"\uD83C\uDFB5 Audio file: ".concat(tf.name),!1):eB(ew,!1)]),tP([]),eY(!0);try{if(eA){if(eH===V.KP.CHAT){let t=[...ek.filter(e=>!e.isImage&&!e.isAudio).map(e=>{let{role:t,content:s}=e;return{role:t,content:"string"==typeof s?s:""}}),e];await (0,ec.n)(t,(e,t)=>tM("assistant",e,t),eA,a,e1,o,tL,tO,tK,r,e5.length>0?e5:void 0,e7.length>0?e7:void 0,ea,tJ,tz,t_?tA:void 0,t_?tZ:void 0,tD)}else if(eH===V.KP.IMAGE)await eg(ew,(e,t)=>tH(e,t),eA,a,e1,o);else if(eH===V.KP.SPEECH)await el(ew,e4,(e,t)=>tq(e,t),eA||"",a,e1,o);else if(eH===V.KP.IMAGE_EDITS)tr.length>0&&await ex(1===tr.length?tr[0]:tr,ew,(e,t)=>tH(e,t),eA,a,e1,o);else if(eH===V.KP.RESPONSES){let t;t=ta&&tt?[e]:[...ek.filter(e=>!e.isImage&&!e.isAudio).map(e=>{let{role:t,content:s}=e;return{role:t,content:s}}),e],await ep(t,(e,t,s)=>tM(e,t,s),eA,a,e1,o,tL,tO,tK,r,e5.length>0?e5:void 0,e7.length>0?e7:void 0,ea,ta?tt:null,tF,tB)}else if(eH===V.KP.ANTHROPIC_MESSAGES){let t=[...ek.filter(e=>!e.isImage&&!e.isAudio).map(e=>{let{role:t,content:s}=e;return{role:t,content:s}}),e];await er(t,(e,t,s)=>tM(e,t,s),eA,a,e1,o,tL,tO,tK,r,e5.length>0?e5:void 0,e7.length>0?e7:void 0,ea)}else eH===V.KP.EMBEDDINGS?await ed(ew,(e,t)=>tG(e,t),eA,a,e1):eH===V.KP.TRANSCRIPTION&&tf&&await ei(tf,(e,t)=>tM("assistant",e,t),eA,a,e1,o)}eH===V.KP.A2A_AGENTS&&eL&&await ev(eL,ew,(e,t)=>tM("assistant",e,t),a,o,tO,tD,tU)}catch(e){o.aborted?console.log("Request was cancelled"):(console.error("Error fetching response",e),tM("assistant","Error fetching response:"+e))}finally{eY(!1),e0.current=null,eH===V.KP.IMAGE_EDITS&&tY(),eH===V.KP.RESPONSES&&tc&&tX(),eH===V.KP.CHAT&&tx&&t$(),eH===V.KP.TRANSCRIPTION&&tf&&tQ()}eS("")};if(w&&"Admin Viewer"===w){let{Title:e,Paragraph:t}=k.default;return(0,a.jsxs)("div",{children:[(0,a.jsx)(e,{level:1,children:"Access Denied"}),(0,a.jsx)(t,{children:"Ask your proxy admin for access to test models"})]})}let t1=(0,a.jsx)(o.Z,{style:{fontSize:24},spin:!0});return(0,a.jsxs)("div",{className:"w-full p-4 pb-0 bg-white",children:[(0,a.jsx)(N.Zb,{className:"w-full rounded-xl shadow-md overflow-hidden",children:(0,a.jsxs)("div",{className:"flex h-[80vh] w-full gap-4",children:[(0,a.jsxs)("div",{className:"w-1/4 p-4 bg-gray-50 overflow-y-auto",children:[(0,a.jsx)(N.Dx,{className:"text-xl font-semibold mb-6 mt-2",children:"Configurations"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(N.xv,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,a.jsx)(r.Z,{className:"mr-2"})," Virtual Key Source"]}),(0,a.jsx)(P.default,{disabled:F,value:eb,style:{width:"100%"},onChange:e=>{ey(e)},options:[{value:"session",label:"Current UI Session"},{value:"custom",label:"Virtual Key"}],className:"rounded-md"}),"custom"===eb&&(0,a.jsx)(N.oi,{className:"mt-2",placeholder:"Enter custom Virtual Key",type:"password",onValueChange:eN,value:ej,icon:r.Z})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(N.xv,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,a.jsx)(n.Z,{className:"mr-2"})," Endpoint Type"]}),(0,a.jsx)(es,{endpointType:eH,onEndpointChange:e=>{eq(e),eC(void 0),eO(void 0),eT(!1);try{sessionStorage.removeItem("selectedModel"),sessionStorage.removeItem("selectedAgent")}catch(e){}},className:"mb-4"}),eH===V.KP.SPEECH&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)(N.xv,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,a.jsx)(l.Z,{className:"mr-2"}),"Voice"]}),(0,a.jsx)(P.default,{value:e4,onChange:e=>{e3(e),sessionStorage.setItem("selectedVoice",e)},style:{width:"100%"},className:"rounded-md",options:Y})]}),(0,a.jsx)(eX,{endpointType:eH,responsesSessionId:tt,useApiSessionManagement:ta,onToggleSessionManagement:e=>{to(e),e||ts(null)}})]}),eH!==V.KP.A2A_AGENTS&&(0,a.jsxs)("div",{children:[(0,a.jsxs)(N.xv,{className:"font-medium block mb-2 text-gray-700 flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(i.Z,{className:"mr-2"})," Select Model"]}),(()=>{if(!eA||"custom"===eA)return!1;let e=e_.find(e=>e.model_group===eA);return!!e&&(!e.mode||"chat"===e.mode)})()?(0,a.jsx)(A.Z,{content:(0,a.jsx)(q,{temperature:tA,maxTokens:tZ,useAdvancedParams:t_,onTemperatureChange:tC,onMaxTokensChange:tT,onUseAdvancedParamsChange:tE}),title:"Model Settings",trigger:"click",placement:"right",children:(0,a.jsx)(C.ZP,{type:"text",size:"small",icon:(0,a.jsx)(c.Z,{}),className:"text-gray-500 hover:text-gray-700"})}):(0,a.jsx)(Z.Z,{title:"Advanced parameters are only supported for chat models currently",children:(0,a.jsx)(C.ZP,{type:"text",size:"small",icon:(0,a.jsx)(c.Z,{}),className:"text-gray-300 cursor-not-allowed",disabled:!0})})]}),(0,a.jsx)(P.default,{value:eA,placeholder:"Select a Model",onChange:e=>{console.log("selected ".concat(e)),eC(e),eT("custom"===e)},options:[...Array.from(new Set(e_.filter(e=>{if(!e.mode)return!0;let t=(0,V.vf)(e.mode);return eH===V.KP.RESPONSES||eH===V.KP.ANTHROPIC_MESSAGES?t===eH||t===V.KP.CHAT:eH===V.KP.IMAGE_EDITS?t===eH||t===V.KP.IMAGE:t===eH}).map(e=>e.model_group))).map((e,t)=>({value:e,label:e,key:t})),{value:"custom",label:"Enter custom model",key:"custom"}],style:{width:"100%"},showSearch:!0,className:"rounded-md"}),eZ&&(0,a.jsx)(N.oi,{className:"mt-2",placeholder:"Enter custom model name",onValueChange:e=>{ez.current&&clearTimeout(ez.current),ez.current=setTimeout(()=>{eC(e)},500)}})]}),eH===V.KP.A2A_AGENTS&&(0,a.jsxs)("div",{children:[(0,a.jsxs)(N.xv,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,a.jsx)(i.Z,{className:"mr-2"})," Select Agent"]}),(0,a.jsx)(P.default,{value:eL,placeholder:"Select an Agent",onChange:e=>eO(e),options:eR.map(e=>({value:e.agent_name,label:e.agent_name||e.agent_id,key:e.agent_id})),style:{width:"100%"},showSearch:!0,className:"rounded-md",optionLabelProp:"label",children:eR.map(e=>{var t;return(0,a.jsx)(P.default.Option,{value:e.agent_name,label:e.agent_name||e.agent_id,children:(0,a.jsxs)("div",{className:"flex flex-col py-1",children:[(0,a.jsx)("span",{className:"font-medium",children:e.agent_name||e.agent_id}),(null===(t=e.agent_card_params)||void 0===t?void 0:t.description)&&(0,a.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:e.agent_card_params.description})]})},e.agent_id)})}),0===eR.length&&(0,a.jsx)(N.xv,{className:"text-xs text-gray-500 mt-2 block",children:"No agents found. Create agents via /v1/agents endpoint."})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(N.xv,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,a.jsx)(d.Z,{className:"mr-2"})," Tags"]}),(0,a.jsx)(D.Z,{value:e1,onChange:e2,className:"mb-4",accessToken:t||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(N.xv,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,a.jsx)(m.Z,{className:"mr-2"})," MCP Tool",(0,a.jsx)(Z.Z,{className:"ml-1",title:"Select MCP tools to use in your conversation, only available for /v1/responses endpoint",children:(0,a.jsx)(u.Z,{})})]}),(0,a.jsx)(P.default,{mode:"multiple",style:{width:"100%"},placeholder:"Select MCP tools",value:ea,onChange:e=>eo(e),loading:en,className:"mb-4",allowClear:!0,optionLabelProp:"label",disabled:eH!==V.KP.RESPONSES,maxTagCount:"responsive",children:Array.isArray(W)&&W.map(e=>(0,a.jsx)(P.default.Option,{value:e.name,label:(0,a.jsx)("div",{className:"font-medium",children:e.name}),children:(0,a.jsxs)("div",{className:"flex flex-col py-1",children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:e.description})]})},e.name))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(N.xv,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,a.jsx)(x.Z,{className:"mr-2"})," Vector Store",(0,a.jsx)(Z.Z,{className:"ml-1",title:(0,a.jsxs)("span",{children:["Select vector store(s) to use for this LLM API call. You can set up your vector store"," ",(0,a.jsx)("a",{href:"?page=vector-stores",style:{color:"#1890ff"},children:"here"}),"."]}),children:(0,a.jsx)(u.Z,{})})]}),(0,a.jsx)(z.Z,{value:e5,onChange:e6,className:"mb-4",accessToken:t||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(N.xv,{className:"font-medium block mb-2 text-gray-700 flex items-center",children:[(0,a.jsx)(g.Z,{className:"mr-2"})," Guardrails",(0,a.jsx)(Z.Z,{className:"ml-1",title:(0,a.jsxs)("span",{children:["Select guardrail(s) to use for this LLM API call. You can set up your guardrails"," ",(0,a.jsx)("a",{href:"?page=guardrails",style:{color:"#1890ff"},children:"here"}),"."]}),children:(0,a.jsx)(u.Z,{})})]}),(0,a.jsx)(K.Z,{value:e7,onChange:e8,className:"mb-4",accessToken:t||""})]})]})]}),(0,a.jsxs)("div",{className:"w-3/4 flex flex-col bg-white",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,a.jsx)(N.Dx,{className:"text-xl font-semibold mb-0",children:"Test Key"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(N.zx,{onClick:()=>{ek.forEach(e=>{e.isAudio&&"string"==typeof e.content&&URL.revokeObjectURL(e.content)}),eP([]),te(null),ts(null),tP([]),tY(),tX(),t$(),tQ(),sessionStorage.removeItem("chatHistory"),sessionStorage.removeItem("messageTraceId"),sessionStorage.removeItem("responsesSessionId"),U.Z.success("Chat history cleared.")},className:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",icon:p.Z,children:"Clear Chat"}),(0,a.jsx)(N.zx,{onClick:()=>ty(!0),className:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",icon:h.Z,children:"Get Code"})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto p-4 pb-0",children:[0===ek.length&&(0,a.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,a.jsx)(i.Z,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,a.jsx)(N.xv,{children:"Start a conversation, generate an image, or handle audio"})]}),ek.map((e,t)=>(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"mb-4 ".concat("user"===e.role?"text-right":"text-left"),children:(0,a.jsxs)("div",{className:"inline-block max-w-[80%] rounded-lg shadow-sm p-3.5 px-4",style:{backgroundColor:"user"===e.role?"#f0f8ff":"#ffffff",border:"user"===e.role?"1px solid #e6f0fa":"1px solid #f0f0f0",textAlign:"left"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full mr-1",style:{backgroundColor:"user"===e.role?"#e6f0fa":"#f5f5f5"},children:"user"===e.role?(0,a.jsx)(f.Z,{style:{fontSize:"12px",color:"#2563eb"}}):(0,a.jsx)(i.Z,{style:{fontSize:"12px",color:"#4b5563"}})}),(0,a.jsx)("strong",{className:"text-sm capitalize",children:e.role}),"assistant"===e.role&&e.model&&(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-600 font-normal",children:e.model})]}),e.reasoningContent&&(0,a.jsx)(eU.Z,{reasoningContent:e.reasoningContent}),"assistant"===e.role&&t===ek.length-1&&tk.length>0&&eH===V.KP.RESPONSES&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)(eK,{events:tk})}),"assistant"===e.role&&e.searchResults&&(0,a.jsx)(eW.J,{searchResults:e.searchResults}),(0,a.jsxs)("div",{className:"whitespace-pre-wrap break-words max-w-full message-content",style:{wordWrap:"break-word",overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},children:[e.isImage?(0,a.jsx)("img",{src:"string"==typeof e.content?e.content:"",alt:"Generated image",className:"max-w-full rounded-md border border-gray-200 shadow-sm",style:{maxHeight:"500px"}}):e.isAudio?(0,a.jsx)(J,{message:e}):(0,a.jsxs)(a.Fragment,{children:[eH===V.KP.RESPONSES&&(0,a.jsx)(eG,{message:e}),eH===V.KP.CHAT&&(0,a.jsx)($.Z,{message:e}),(0,a.jsx)(I.UG,{components:{code(e){let{node:t,inline:s,className:o,children:r,...n}=e,l=/language-(\w+)/.exec(o||"");return!s&&l?(0,a.jsx)(R.Z,{style:M.Z,language:l[1],PreTag:"div",className:"rounded-md my-2",wrapLines:!0,wrapLongLines:!0,...n,children:String(r).replace(/\n$/,"")}):(0,a.jsx)("code",{className:"".concat(o," px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono"),style:{wordBreak:"break-word"},...n,children:r})},pre:e=>{let{node:t,...s}=e;return(0,a.jsx)("pre",{style:{overflowX:"auto",maxWidth:"100%"},...s})}},children:"string"==typeof e.content?e.content:""}),e.image&&(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)("img",{src:e.image.url,alt:"Generated image",className:"max-w-full rounded-md border border-gray-200 shadow-sm",style:{maxHeight:"500px"}})})]}),"assistant"===e.role&&(e.timeToFirstToken||e.totalLatency||e.usage)&&!e.a2aMetadata&&(0,a.jsx)(eD.Z,{timeToFirstToken:e.timeToFirstToken,totalLatency:e.totalLatency,usage:e.usage,toolName:e.toolName}),"assistant"===e.role&&e.a2aMetadata&&(0,a.jsx)(eE,{a2aMetadata:e.a2aMetadata,timeToFirstToken:e.timeToFirstToken,totalLatency:e.totalLatency})]})]})})},t)),eJ&&tk.length>0&&eH===V.KP.RESPONSES&&ek.length>0&&"user"===ek[ek.length-1].role&&(0,a.jsx)("div",{className:"text-left mb-4",children:(0,a.jsxs)("div",{className:"inline-block max-w-[80%] rounded-lg shadow-sm p-3.5 px-4",style:{backgroundColor:"#ffffff",border:"1px solid #f0f0f0",textAlign:"left"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full mr-1",style:{backgroundColor:"#f5f5f5"},children:(0,a.jsx)(i.Z,{style:{fontSize:"12px",color:"#4b5563"}})}),(0,a.jsx)("strong",{className:"text-sm capitalize",children:"Assistant"})]}),(0,a.jsx)(eK,{events:tk})]})}),eJ&&(0,a.jsx)("div",{className:"flex justify-center items-center my-4",children:(0,a.jsx)(T.Z,{indicator:t1})}),(0,a.jsx)("div",{ref:tI,style:{height:"1px"}})]}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-white",children:[eH===V.KP.IMAGE_EDITS&&(0,a.jsx)("div",{className:"mb-4",children:0===tr.length?(0,a.jsxs)(eQ,{beforeUpload:tV,accept:"image/*",showUploadList:!1,children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(v.Z,{style:{fontSize:"24px",color:"#666"}})}),(0,a.jsx)("p",{className:"ant-upload-text text-sm",children:"Click or drag images to upload"}),(0,a.jsx)("p",{className:"ant-upload-hint text-xs text-gray-500",children:"Support for PNG, JPG, JPEG formats. Multiple images supported."})]}):(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[tr.map((e,t)=>(0,a.jsxs)("div",{className:"relative inline-block",children:[(0,a.jsx)("img",{src:tl[t]||"",alt:"Upload preview ".concat(t+1),className:"max-w-32 max-h-32 rounded-md border border-gray-200 object-cover"}),(0,a.jsx)("button",{className:"absolute top-1 right-1 bg-white shadow-sm border border-gray-200 rounded px-1 py-1 text-red-500 hover:bg-red-50 text-xs",onClick:()=>tW(t),children:(0,a.jsx)(b.Z,{})})]},t)),(0,a.jsxs)("div",{className:"flex items-center justify-center w-32 h-32 border-2 border-dashed border-gray-300 rounded-md hover:border-gray-400 cursor-pointer",onClick:()=>{var e;return null===(e=document.getElementById("additional-image-upload"))||void 0===e?void 0:e.click()},children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(v.Z,{style:{fontSize:"24px",color:"#666"}}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Add more"})]}),(0,a.jsx)("input",{id:"additional-image-upload",type:"file",accept:"image/*",multiple:!0,style:{display:"none"},onChange:e=>{Array.from(e.target.files||[]).forEach(e=>tV(e))}})]})]})}),eH===V.KP.TRANSCRIPTION&&(0,a.jsx)("div",{className:"mb-4",children:tf?(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,a.jsx)(l.Z,{style:{fontSize:"20px",color:"#666"}}),(0,a.jsx)("span",{className:"text-sm font-medium",children:tf.name}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["(",(tf.size/1024/1024).toFixed(2)," MB)"]})]}),(0,a.jsxs)("button",{className:"bg-white shadow-sm border border-gray-200 rounded px-2 py-1 text-red-500 hover:bg-red-50 text-xs",onClick:tQ,children:[(0,a.jsx)(b.Z,{})," Remove"]})]}):(0,a.jsxs)(eQ,{beforeUpload:e=>(tv(e),!1),accept:"audio/*,.mp3,.mp4,.mpeg,.mpga,.m4a,.wav,.webm",showUploadList:!1,children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(l.Z,{style:{fontSize:"24px",color:"#666"}})}),(0,a.jsx)("p",{className:"ant-upload-text text-sm",children:"Click or drag audio file to upload"}),(0,a.jsx)("p",{className:"ant-upload-hint text-xs text-gray-500",children:"Support for MP3, MP4, MPEG, MPGA, M4A, WAV, WEBM formats. Max file size: 25 MB."})]})}),eH===V.KP.RESPONSES&&tc&&(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"relative inline-block",children:tc.name.toLowerCase().endsWith(".pdf")?(0,a.jsx)("div",{className:"w-10 h-10 rounded-md bg-red-500 flex items-center justify-center",children:(0,a.jsx)(y.Z,{style:{fontSize:"16px",color:"white"}})}):(0,a.jsx)("img",{src:tm||"",alt:"Upload preview",className:"w-10 h-10 rounded-md border border-gray-200 object-cover"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:tc.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:tc.name.toLowerCase().endsWith(".pdf")?"PDF":"Image"})]}),(0,a.jsx)("button",{className:"flex items-center justify-center w-6 h-6 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded-full transition-colors",onClick:tX,children:(0,a.jsx)(b.Z,{style:{fontSize:"12px"}})})]})}),eH===V.KP.CHAT&&tx&&(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"relative inline-block",children:tx.name.toLowerCase().endsWith(".pdf")?(0,a.jsx)("div",{className:"w-10 h-10 rounded-md bg-red-500 flex items-center justify-center",children:(0,a.jsx)(y.Z,{style:{fontSize:"16px",color:"white"}})}):(0,a.jsx)("img",{src:tp||"",alt:"Upload preview",className:"w-10 h-10 rounded-md border border-gray-200 object-cover"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:tx.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:tx.name.toLowerCase().endsWith(".pdf")?"PDF":"Image"})]}),(0,a.jsx)("button",{className:"flex items-center justify-center w-6 h-6 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded-full transition-colors",onClick:t$,children:(0,a.jsx)(b.Z,{style:{fontSize:"12px"}})})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center flex-1 bg-white border border-gray-300 rounded-xl px-3 py-1 min-h-[44px]",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 mr-2",children:[eH===V.KP.RESPONSES&&!tc&&(0,a.jsx)(eV,{responsesUploadedImage:tc,responsesImagePreviewUrl:tm,onImageUpload:e=>(td(e),tu(URL.createObjectURL(e)),!1),onRemoveImage:tX}),eH===V.KP.CHAT&&!tx&&(0,a.jsx)(Q.Z,{chatUploadedImage:tx,chatImagePreviewUrl:tp,onImageUpload:e=>(tg(e),th(URL.createObjectURL(e)),!1),onRemoveImage:t$})]}),(0,a.jsx)(e$,{value:ew,onChange:e=>eS(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t0())},placeholder:eH===V.KP.CHAT||eH===V.KP.EMBEDDINGS||eH===V.KP.RESPONSES||eH===V.KP.ANTHROPIC_MESSAGES?"Type your message... (Shift+Enter for new line)":eH===V.KP.A2A_AGENTS?"Send a message to the A2A agent...":eH===V.KP.IMAGE_EDITS?"Describe how you want to edit the image...":eH===V.KP.SPEECH?"Enter text to convert to speech...":eH===V.KP.TRANSCRIPTION?"Optional: Add context or prompt for transcription...":"Describe the image you want to generate...",disabled:eJ,className:"flex-1",autoSize:{minRows:1,maxRows:4},style:{resize:"none",border:"none",boxShadow:"none",background:"transparent",padding:"4px 0",fontSize:"14px",lineHeight:"20px"}}),(0,a.jsx)(N.zx,{onClick:t0,disabled:eJ||(eH===V.KP.TRANSCRIPTION?!tf:!ew.trim()),className:"flex-shrink-0 ml-2 !w-8 !h-8 !min-w-8 !p-0 !rounded-full !bg-blue-600 hover:!bg-blue-700 disabled:!bg-gray-300 !border-none !text-white disabled:!text-gray-500 !flex !items-center !justify-center",children:(0,a.jsx)(j.Z,{style:{fontSize:"14px"}})})]}),eJ&&(0,a.jsx)(N.zx,{onClick:()=>{e0.current&&(e0.current.abort(),e0.current=null,eY(!1),U.Z.info("Request cancelled"))},className:"bg-red-50 hover:bg-red-100 text-red-600 border-red-200",icon:b.Z,children:"Cancel"})]})]})]})]})}),(0,a.jsxs)(_.Z,{title:"Generated Code",visible:tb,onCancel:()=>ty(!1),footer:null,width:800,children:[(0,a.jsxs)("div",{className:"flex justify-between items-end my-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(N.xv,{className:"font-medium block mb-1 text-gray-700",children:"SDK Type"}),(0,a.jsx)(P.default,{value:tw,onChange:e=>tS(e),style:{width:150},options:[{value:"openai",label:"OpenAI SDK"},{value:"azure",label:"Azure SDK"}]})]}),(0,a.jsx)(C.ZP,{onClick:()=>{navigator.clipboard.writeText(tj),U.Z.success("Copied to clipboard!")},children:"Copy to Clipboard"})]}),(0,a.jsx)(R.Z,{language:"python",style:M.Z,wrapLines:!0,wrapLongLines:!0,className:"rounded-md",customStyle:{maxHeight:"60vh",overflowY:"auto"},children:tj})]}),"custom"===eb&&(0,a.jsx)(_.Z,{title:"Select MCP Tool",visible:H,onCancel:()=>G(!1),onOk:()=>{G(!1),U.Z.success("MCP tool selection updated")},width:800,children:en?(0,a.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,a.jsx)(T.Z,{indicator:(0,a.jsx)(o.Z,{style:{fontSize:24},spin:!0})})}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(N.xv,{className:"text-gray-600 block mb-4",children:"Select the MCP tools you want to use in your conversation."}),(0,a.jsx)(P.default,{mode:"multiple",style:{width:"100%"},placeholder:"Select MCP tools",value:ea,onChange:e=>eo(e),optionLabelProp:"label",allowClear:!0,maxTagCount:"responsive",children:W.map(e=>(0,a.jsx)(P.default.Option,{value:e.name,label:(0,a.jsx)("div",{className:"font-medium",children:e.name}),children:(0,a.jsxs)("div",{className:"flex flex-col py-1",children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:e.description})]})},e.name))})]})})]})}},94331:function(e,t,s){var a=s(57437),o=s(2265),r=s(5545),n=s(62831),l=s(17906),i=s(94263),c=s(83322),d=s(70464),m=s(77565);t.Z=e=>{let{reasoningContent:t}=e,[s,u]=(0,o.useState)(!0);return t?(0,a.jsxs)("div",{className:"reasoning-content mt-1 mb-2",children:[(0,a.jsxs)(r.ZP,{type:"text",className:"flex items-center text-xs text-gray-500 hover:text-gray-700",onClick:()=>u(!s),icon:(0,a.jsx)(c.Z,{}),children:[s?"Hide reasoning":"Show reasoning",s?(0,a.jsx)(d.Z,{className:"ml-1"}):(0,a.jsx)(m.Z,{className:"ml-1"})]}),s&&(0,a.jsx)("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md text-sm text-gray-700",children:(0,a.jsx)(n.UG,{components:{code(e){let{node:t,inline:s,className:o,children:r,...n}=e,c=/language-(\w+)/.exec(o||"");return!s&&c?(0,a.jsx)(l.Z,{style:i.Z,language:c[1],PreTag:"div",className:"rounded-md my-2",...n,children:String(r).replace(/\n$/,"")}):(0,a.jsx)("code",{className:"".concat(o," px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono"),...n,children:r})}},children:t})})]}):null}},38398:function(e,t,s){var a=s(57437);s(2265);var o=s(99981),r=s(5540),n=s(71282),l=s(11741),i=s(83322),c=s(16601),d=s(62670),m=s(58630);t.Z=e=>{let{timeToFirstToken:t,totalLatency:s,usage:u,toolName:x}=e;return t||s||u?(0,a.jsxs)("div",{className:"response-metrics mt-2 pt-2 border-t border-gray-100 text-xs text-gray-500 flex flex-wrap gap-3",children:[void 0!==t&&(0,a.jsx)(o.Z,{title:"Time to first token",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(r.Z,{className:"mr-1"}),(0,a.jsxs)("span",{children:["TTFT: ",(t/1e3).toFixed(2),"s"]})]})}),void 0!==s&&(0,a.jsx)(o.Z,{title:"Total latency",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(r.Z,{className:"mr-1"}),(0,a.jsxs)("span",{children:["Total Latency: ",(s/1e3).toFixed(2),"s"]})]})}),(null==u?void 0:u.promptTokens)!==void 0&&(0,a.jsx)(o.Z,{title:"Prompt tokens",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(n.Z,{className:"mr-1"}),(0,a.jsxs)("span",{children:["In: ",u.promptTokens]})]})}),(null==u?void 0:u.completionTokens)!==void 0&&(0,a.jsx)(o.Z,{title:"Completion tokens",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(l.Z,{className:"mr-1"}),(0,a.jsxs)("span",{children:["Out: ",u.completionTokens]})]})}),(null==u?void 0:u.reasoningTokens)!==void 0&&(0,a.jsx)(o.Z,{title:"Reasoning tokens",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i.Z,{className:"mr-1"}),(0,a.jsxs)("span",{children:["Reasoning: ",u.reasoningTokens]})]})}),(null==u?void 0:u.totalTokens)!==void 0&&(0,a.jsx)(o.Z,{title:"Total tokens",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(c.Z,{className:"mr-1"}),(0,a.jsxs)("span",{children:["Total: ",u.totalTokens]})]})}),(null==u?void 0:u.cost)!==void 0&&(0,a.jsx)(o.Z,{title:"Cost",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(d.Z,{className:"mr-1"}),(0,a.jsxs)("span",{children:["$",u.cost.toFixed(6)]})]})}),x&&(0,a.jsx)(o.Z,{title:"Tool used",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(m.Z,{className:"mr-1"}),(0,a.jsxs)("span",{children:["Tool: ",x]})]})})]}):null}},33152:function(e,t,s){s.d(t,{J:function(){return d}});var a=s(57437),o=s(2265),r=s(5545),n=s(44625),l=s(70464),i=s(77565),c=s(38434);function d(e){let{searchResults:t}=e,[s,d]=(0,o.useState)(!0),[m,u]=(0,o.useState)({});if(!t||0===t.length)return null;let x=(e,t)=>{let s="".concat(e,"-").concat(t);u(e=>({...e,[s]:!e[s]}))},g=t.reduce((e,t)=>e+t.data.length,0);return(0,a.jsxs)("div",{className:"search-results-content mt-1 mb-2",children:[(0,a.jsxs)(r.ZP,{type:"text",className:"flex items-center text-xs text-gray-500 hover:text-gray-700",onClick:()=>d(!s),icon:(0,a.jsx)(n.Z,{}),children:[s?"Hide sources":"Show sources (".concat(g,")"),s?(0,a.jsx)(l.Z,{className:"ml-1"}):(0,a.jsx)(i.Z,{className:"ml-1"})]}),s&&(0,a.jsx)("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md text-sm",children:(0,a.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs text-gray-600 mb-2 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Query:"}),(0,a.jsxs)("span",{className:"italic",children:['"',e.search_query,'"']}),(0,a.jsx)("span",{className:"text-gray-400",children:"•"}),(0,a.jsxs)("span",{className:"text-gray-500",children:[e.data.length," result",1!==e.data.length?"s":""]})]}),(0,a.jsx)("div",{className:"space-y-2",children:e.data.map((e,s)=>{let o=m["".concat(t,"-").concat(s)]||!1;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-md overflow-hidden bg-white",children:[(0,a.jsx)("div",{className:"flex items-center justify-between p-2 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>x(t,s),children:(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-400 transition-transform flex-shrink-0 ".concat(o?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,a.jsx)(c.Z,{className:"text-gray-400 flex-shrink-0",style:{fontSize:"12px"}}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-700 truncate",children:e.filename||e.file_id||"Result ".concat(s+1)}),(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-blue-100 text-blue-700 font-mono flex-shrink-0",children:e.score.toFixed(3)})]})}),o&&(0,a.jsx)("div",{className:"border-t border-gray-200 bg-white",children:(0,a.jsxs)("div",{className:"p-3 space-y-2",children:[e.content.map((e,t)=>(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"text-xs font-mono bg-gray-50 p-2 rounded text-gray-800 whitespace-pre-wrap break-words",children:e.text})},t)),e.attributes&&Object.keys(e.attributes).length>0&&(0,a.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-100",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-1 font-medium",children:"Metadata:"}),(0,a.jsx)("div",{className:"space-y-1",children:Object.entries(e.attributes).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"text-xs flex gap-2",children:[(0,a.jsxs)("span",{className:"text-gray-500 font-medium",children:[t,":"]}),(0,a.jsx)("span",{className:"text-gray-700 font-mono break-all",children:String(s)})]},t)})})]})]})})]},s)})})]},t))})})]})}},95459:function(e,t,s){s.d(t,{n:function(){return r}});var a=s(7271),o=s(19250);async function r(e,t,s,r,n,l,i,c,d,m,u,x,g,p,h,f,v,b){console.log=function(){},console.log("isLocal:",!1);let y=(0,o.getProxyBaseUrl)(),j={};n&&n.length>0&&(j["x-litellm-tags"]=n.join(","));let N=new a.ZP.OpenAI({apiKey:r,baseURL:y,dangerouslyAllowBrowser:!0,defaultHeaders:j});try{let a;let o=Date.now(),n=!1,j=g&&g.length>0?[{type:"mcp",server_label:"litellm",server_url:"".concat(y,"/mcp"),require_approval:"never",allowed_tools:g,headers:{"x-litellm-api-key":"Bearer ".concat(r)}}]:void 0;for await(let r of(await N.chat.completions.create({model:s,stream:!0,stream_options:{include_usage:!0},litellm_trace_id:m,messages:e,...u?{vector_store_ids:u}:{},...x?{guardrails:x}:{},...j?{tools:j,tool_choice:"auto"}:{},...void 0!==f?{temperature:f}:{},...void 0!==v?{max_tokens:v}:{}},{signal:l}))){var w,S,k,P,A,C,Z,T,_;console.log("Stream chunk:",r);let e=null===(w=r.choices[0])||void 0===w?void 0:w.delta;if(console.log("Delta content:",null===(k=r.choices[0])||void 0===k?void 0:null===(S=k.delta)||void 0===S?void 0:S.content),console.log("Delta reasoning content:",null==e?void 0:e.reasoning_content),!n&&((null===(A=r.choices[0])||void 0===A?void 0:null===(P=A.delta)||void 0===P?void 0:P.content)||e&&e.reasoning_content)&&(n=!0,a=Date.now()-o,console.log("First token received! Time:",a,"ms"),c?(console.log("Calling onTimingData with:",a),c(a)):console.log("onTimingData callback is not defined!")),null===(Z=r.choices[0])||void 0===Z?void 0:null===(C=Z.delta)||void 0===C?void 0:C.content){let e=r.choices[0].delta.content;t(e,r.model)}if(e&&e.image&&p&&(console.log("Image generated:",e.image),p(e.image.url,r.model)),e&&e.reasoning_content){let t=e.reasoning_content;i&&i(t)}if(e&&(null===(T=e.provider_specific_fields)||void 0===T?void 0:T.search_results)&&h&&(console.log("Search results found:",e.provider_specific_fields.search_results),h(e.provider_specific_fields.search_results)),r.usage&&d){console.log("Usage data found:",r.usage);let e={completionTokens:r.usage.completion_tokens,promptTokens:r.usage.prompt_tokens,totalTokens:r.usage.total_tokens};(null===(_=r.usage.completion_tokens_details)||void 0===_?void 0:_.reasoning_tokens)&&(e.reasoningTokens=r.usage.completion_tokens_details.reasoning_tokens),void 0!==r.usage.cost&&null!==r.usage.cost&&(e.cost=parseFloat(r.usage.cost)),d(e)}}let E=Date.now();b&&b(E-o)}catch(e){throw(null==l?void 0:l.aborted)&&console.log("Chat completion request was cancelled"),e}}},99020:function(e,t,s){var a=s(57437),o=s(2265),r=s(37592),n=s(19250);t.Z=e=>{let{onChange:t,value:s,className:l,accessToken:i}=e,[c,d]=(0,o.useState)([]),[m,u]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{(async()=>{if(i)try{let e=await (0,n.tagListCall)(i);console.log("List tags response:",e),d(Object.values(e))}catch(e){console.error("Error fetching tags:",e)}finally{u(!1)}})()},[i]),(0,a.jsx)(r.default,{mode:"tags",showSearch:!0,placeholder:"Select or create tags",onChange:t,value:s,loading:m,className:l,options:c.map(e=>({label:e.name,value:e.name,title:e.description||e.name})),optionFilterProp:"label",tokenSeparators:[","],maxTagCount:"responsive",allowClear:!0,style:{width:"100%"}})}}}]);