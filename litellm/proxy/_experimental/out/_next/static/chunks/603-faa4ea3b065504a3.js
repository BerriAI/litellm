"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{30603:function(e,t,r){r.d(t,{Z:function(){return J}});var s=r(57437),l=r(2265),a=r(16312),n=r(82680),i=r(19250),o=r(20831),c=r(21626),d=r(97214),m=r(28241),p=r(58834),x=r(69552),h=r(71876),j=r(74998),u=r(44633),g=r(86462),f=r(49084),v=r(89970),y=r(71594),N=r(24525),b=e=>{let{promptsList:t,isLoading:r,onPromptClick:a,onDeleteClick:n,accessToken:i,isAdmin:b}=e,[w,Z]=(0,l.useState)([{id:"created_at",desc:!0}]),_=e=>e?new Date(e).toLocaleString():"-",P=[{header:"Prompt ID",accessorKey:"prompt_id",cell:e=>(0,s.jsx)(v.Z,{title:String(e.getValue()||""),children:(0,s.jsx)(o.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>e.getValue()&&(null==a?void 0:a(e.getValue())),children:e.getValue()?"".concat(String(e.getValue()).slice(0,7),"..."):""})})},{header:"Created At",accessorKey:"created_at",cell:e=>{let{row:t}=e,r=t.original;return(0,s.jsx)(v.Z,{title:r.created_at,children:(0,s.jsx)("span",{className:"text-xs",children:_(r.created_at)})})}},{header:"Updated At",accessorKey:"updated_at",cell:e=>{let{row:t}=e,r=t.original;return(0,s.jsx)(v.Z,{title:r.updated_at,children:(0,s.jsx)("span",{className:"text-xs",children:_(r.updated_at)})})}},{header:"Type",accessorKey:"prompt_info.prompt_type",cell:e=>{let{row:t}=e,r=t.original;return(0,s.jsx)(v.Z,{title:r.prompt_info.prompt_type,children:(0,s.jsx)("span",{className:"text-xs",children:r.prompt_info.prompt_type})})}},...b?[{header:"Actions",id:"actions",enableSorting:!1,cell:e=>{let{row:t}=e,r=t.original,l=r.prompt_id||"Unknown Prompt";return(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsx)(v.Z,{title:"Delete prompt",children:(0,s.jsx)(o.Z,{size:"xs",variant:"light",color:"red",onClick:e=>{e.stopPropagation(),null==n||n(r.prompt_id,l)},icon:j.Z,className:"text-red-500 hover:text-red-700 hover:bg-red-50"})})})}}]:[]],C=(0,y.b7)({data:t,columns:P,state:{sorting:w},onSortingChange:Z,getCoreRowModel:(0,N.sC)(),getSortedRowModel:(0,N.tj)(),enableSorting:!0});return(0,s.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(c.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,s.jsx)(p.Z,{children:C.getHeaderGroups().map(e=>(0,s.jsx)(h.Z,{children:e.headers.map(e=>(0,s.jsx)(x.Z,{className:"py-1 h-8",onClick:e.column.getToggleSortingHandler(),children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,s.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,y.ie)(e.column.columnDef.header,e.getContext())}),(0,s.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,s.jsx)(u.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,s.jsx)(g.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,s.jsx)(f.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,s.jsx)(d.Z,{children:r?(0,s.jsx)(h.Z,{children:(0,s.jsx)(m.Z,{colSpan:P.length,className:"h-8 text-center",children:(0,s.jsx)("div",{className:"text-center text-gray-500",children:(0,s.jsx)("p",{children:"Loading..."})})})}):t.length>0?C.getRowModel().rows.map(e=>(0,s.jsx)(h.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,s.jsx)(m.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,y.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,s.jsx)(h.Z,{children:(0,s.jsx)(m.Z,{colSpan:P.length,className:"h-8 text-center",children:(0,s.jsx)("div",{className:"text-center text-gray-500",children:(0,s.jsx)("p",{children:"No prompts found"})})})})})]})})})},w=r(84717),Z=r(73002),_=r(10900),P=r(59872),C=r(30401),S=r(78867),k=r(9114),D=e=>{var t,r,a;let{promptId:o,onClose:c,accessToken:d,isAdmin:m,onDelete:p}=e,[x,h]=(0,l.useState)(null),[u,g]=(0,l.useState)(null),[f,v]=(0,l.useState)(null),[y,N]=(0,l.useState)(!0),[b,D]=(0,l.useState)({}),[I,O]=(0,l.useState)(!1),[L,F]=(0,l.useState)(!1),T=async()=>{try{if(N(!0),!d)return;let e=await (0,i.getPromptInfo)(d,o);h(e.prompt_spec),g(e.raw_prompt_template),v(e)}catch(e){k.Z.fromBackend("Failed to load prompt information"),console.error("Error fetching prompt info:",e)}finally{N(!1)}};if((0,l.useEffect)(()=>{T()},[o,d]),y)return(0,s.jsx)("div",{className:"p-4",children:"Loading..."});if(!x)return(0,s.jsx)("div",{className:"p-4",children:"Prompt not found"});let z=e=>e?new Date(e).toLocaleString():"-",A=async(e,t)=>{await (0,P.vQ)(e)&&(D(e=>({...e,[t]:!0})),setTimeout(()=>{D(e=>({...e,[t]:!1}))},2e3))},B=async()=>{if(d&&x){F(!0);try{await (0,i.deletePromptCall)(d,x.prompt_id),k.Z.success('Prompt "'.concat(x.prompt_id,'" deleted successfully')),null==p||p(),c()}catch(e){console.error("Error deleting prompt:",e),k.Z.fromBackend("Failed to delete prompt")}finally{F(!1),O(!1)}}};return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(w.zx,{icon:_.Z,variant:"light",onClick:c,className:"mb-4",children:"Back to Prompts"}),(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(w.Dx,{children:"Prompt Details"}),(0,s.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,s.jsx)(w.xv,{className:"text-gray-500 font-mono",children:x.prompt_id}),(0,s.jsx)(Z.ZP,{type:"text",size:"small",icon:b["prompt-id"]?(0,s.jsx)(C.Z,{size:12}):(0,s.jsx)(S.Z,{size:12}),onClick:()=>A(x.prompt_id,"prompt-id"),className:"left-2 z-10 transition-all duration-200 ".concat(b["prompt-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),m&&(0,s.jsx)(w.zx,{icon:j.Z,variant:"secondary",onClick:()=>{O(!0)},className:"flex items-center",children:"Delete Prompt"})]})]}),(0,s.jsxs)(w.v0,{children:[(0,s.jsxs)(w.td,{className:"mb-4",children:[(0,s.jsx)(w.OK,{children:"Overview"},"overview"),u?(0,s.jsx)(w.OK,{children:"Prompt Template"},"prompt-template"):(0,s.jsx)(s.Fragment,{}),m?(0,s.jsx)(w.OK,{children:"Details"},"details"):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)(w.OK,{children:"Raw JSON"},"raw-json")]}),(0,s.jsxs)(w.nP,{children:[(0,s.jsxs)(w.x4,{children:[(0,s.jsxs)(w.rj,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,s.jsxs)(w.Zb,{children:[(0,s.jsx)(w.xv,{children:"Prompt ID"}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(w.Dx,{className:"font-mono text-sm",children:x.prompt_id})})]}),(0,s.jsxs)(w.Zb,{children:[(0,s.jsx)(w.xv,{children:"Prompt Type"}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)(w.Dx,{children:(null===(t=x.prompt_info)||void 0===t?void 0:t.prompt_type)||"-"}),(0,s.jsx)(w.Ct,{color:"blue",className:"mt-1",children:(null===(r=x.prompt_info)||void 0===r?void 0:r.prompt_type)||"Unknown"})]})]}),(0,s.jsxs)(w.Zb,{children:[(0,s.jsx)(w.xv,{children:"Created At"}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)(w.Dx,{children:z(x.created_at)}),(0,s.jsxs)(w.xv,{children:["Last Updated: ",z(x.updated_at)]})]})]})]}),x.litellm_params&&Object.keys(x.litellm_params).length>0&&(0,s.jsxs)(w.Zb,{className:"mt-6",children:[(0,s.jsx)(w.xv,{className:"font-medium",children:"LiteLLM Parameters"}),(0,s.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md",children:(0,s.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(x.litellm_params,null,2)})})]})]}),u&&(0,s.jsx)(w.x4,{children:(0,s.jsxs)(w.Zb,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)(w.Dx,{children:"Prompt Template"}),(0,s.jsx)(Z.ZP,{type:"text",size:"small",icon:b["prompt-content"]?(0,s.jsx)(C.Z,{size:16}):(0,s.jsx)(S.Z,{size:16}),onClick:()=>A(u.content,"prompt-content"),className:"transition-all duration-200 ".concat(b["prompt-content"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:b["prompt-content"]?"Copied!":"Copy Content"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(w.xv,{className:"font-medium",children:"Template ID"}),(0,s.jsx)("div",{className:"font-mono text-sm bg-gray-50 p-2 rounded",children:u.litellm_prompt_id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w.xv,{className:"font-medium",children:"Content"}),(0,s.jsx)("div",{className:"mt-2 p-4 bg-gray-50 rounded-md border overflow-auto max-h-96",children:(0,s.jsx)("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:u.content})})]}),u.metadata&&Object.keys(u.metadata).length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)(w.xv,{className:"font-medium",children:"Template Metadata"}),(0,s.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,s.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap overflow-auto max-h-64",children:JSON.stringify(u.metadata,null,2)})})]})]})]})}),m&&(0,s.jsx)(w.x4,{children:(0,s.jsxs)(w.Zb,{children:[(0,s.jsx)(w.Dx,{className:"mb-4",children:"Prompt Details"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(w.xv,{className:"font-medium",children:"Prompt ID"}),(0,s.jsx)("div",{className:"font-mono text-sm bg-gray-50 p-2 rounded",children:x.prompt_id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w.xv,{className:"font-medium",children:"Prompt Type"}),(0,s.jsx)("div",{children:(null===(a=x.prompt_info)||void 0===a?void 0:a.prompt_type)||"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w.xv,{className:"font-medium",children:"Created At"}),(0,s.jsx)("div",{children:z(x.created_at)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w.xv,{className:"font-medium",children:"Last Updated"}),(0,s.jsx)("div",{children:z(x.updated_at)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w.xv,{className:"font-medium",children:"LiteLLM Parameters"}),(0,s.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,s.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap overflow-auto max-h-96",children:JSON.stringify(x.litellm_params,null,2)})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w.xv,{className:"font-medium",children:"Prompt Info"}),(0,s.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,s.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(x.prompt_info,null,2)})})]})]})]})}),(0,s.jsx)(w.x4,{children:(0,s.jsxs)(w.Zb,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)(w.Dx,{children:"Raw API Response"}),(0,s.jsx)(Z.ZP,{type:"text",size:"small",icon:b["raw-json"]?(0,s.jsx)(C.Z,{size:16}):(0,s.jsx)(S.Z,{size:16}),onClick:()=>A(JSON.stringify(f,null,2),"raw-json"),className:"transition-all duration-200 ".concat(b["raw-json"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:b["raw-json"]?"Copied!":"Copy JSON"})]}),(0,s.jsx)("div",{className:"p-4 bg-gray-50 rounded-md border overflow-auto",children:(0,s.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(f,null,2)})})]})})]})]}),(0,s.jsxs)(n.Z,{title:"Delete Prompt",open:I,onOk:B,onCancel:()=>{O(!1)},confirmLoading:L,okText:"Delete",okButtonProps:{danger:!0},children:[(0,s.jsxs)("p",{children:["Are you sure you want to delete prompt: ",(0,s.jsx)("strong",{children:null==x?void 0:x.prompt_id}),"?"]}),(0,s.jsx)("p",{children:"This action cannot be undone."})]})]})},I=r(52787),O=r(13634),L=r(23496),F=r(65319),T=r(31283),z=r(3632);let{Option:A}=I.default;var B=e=>{let{visible:t,onClose:r,accessToken:a,onSuccess:o}=e,[c]=O.Z.useForm(),[d,m]=(0,l.useState)(!1),[p,x]=(0,l.useState)([]),[h,j]=(0,l.useState)("dotprompt"),u=()=>{c.resetFields(),x([]),j("dotprompt"),r()},g=async()=>{try{let e=await c.validateFields();if(console.log("values: ",e),!a){k.Z.fromBackend("Access token is required");return}if("dotprompt"===h&&0===p.length){k.Z.fromBackend("Please upload a .prompt file");return}m(!0);let t={};if("dotprompt"===h&&p.length>0){let r=p[0].originFileObj;try{let s=await (0,i.convertPromptFileToJson)(a,r);console.log("Conversion result:",s),t={prompt_id:e.prompt_id,litellm_params:{prompt_integration:"dotprompt",prompt_id:s.prompt_id,prompt_data:s.json_data},prompt_info:{prompt_type:"db"}}}catch(e){console.error("Error converting prompt file:",e),k.Z.fromBackend("Failed to convert prompt file to JSON"),m(!1);return}}try{await (0,i.createPromptCall)(a,t),k.Z.success("Prompt created successfully!"),u(),o()}catch(e){console.error("Error creating prompt:",e),k.Z.fromBackend("Failed to create prompt")}}catch(e){console.error("Form validation error:",e)}finally{m(!1)}};return(0,s.jsx)(n.Z,{title:"Add New Prompt",open:t,onCancel:u,footer:[(0,s.jsx)(Z.ZP,{onClick:u,children:"Cancel"},"cancel"),(0,s.jsx)(Z.ZP,{loading:d,onClick:g,children:"Create Prompt"},"submit")],width:600,children:(0,s.jsxs)(O.Z,{form:c,layout:"vertical",requiredMark:!1,children:[(0,s.jsx)(O.Z.Item,{label:"Prompt ID",name:"prompt_id",rules:[{required:!0,message:"Please enter a prompt ID"},{pattern:/^[a-zA-Z0-9_-]+$/,message:"Prompt ID can only contain letters, numbers, underscores, and hyphens"}],children:(0,s.jsx)(T.o,{placeholder:"Enter unique prompt ID (e.g., my_prompt_id)"})}),(0,s.jsx)(O.Z.Item,{label:"Prompt Integration",name:"prompt_integration",initialValue:"dotprompt",children:(0,s.jsx)(I.default,{value:h,onChange:j,children:(0,s.jsx)(A,{value:"dotprompt",children:"dotprompt"})})}),"dotprompt"===h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(L.Z,{}),(0,s.jsxs)(O.Z.Item,{label:"Prompt File",extra:"Upload a .prompt file that follows the Dotprompt specification",children:[(0,s.jsx)(F.default,{beforeUpload:e=>(e.name.endsWith(".prompt")||k.Z.fromBackend("Please upload a .prompt file"),!1),fileList:p,onChange:e=>{let{fileList:t}=e;x(t.slice(-1))},onRemove:()=>{x([])},children:(0,s.jsx)(Z.ZP,{icon:(0,s.jsx)(z.Z,{}),children:"Select .prompt File"})}),p.length>0&&(0,s.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",p[0].name]})]})]})]})})},E=r(20347),J=e=>{let{accessToken:t,userRole:r}=e,[o,c]=(0,l.useState)([]),[d,m]=(0,l.useState)(!1),[p,x]=(0,l.useState)(null),[h,j]=(0,l.useState)(!1),[u,g]=(0,l.useState)(!1),[f,v]=(0,l.useState)(null),y=!!r&&(0,E.tY)(r),N=async()=>{if(t){m(!0);try{let e=await (0,i.getPromptsList)(t);console.log("prompts: ".concat(JSON.stringify(e))),c(e.prompts)}catch(e){console.error("Error fetching prompts:",e)}finally{m(!1)}}};(0,l.useEffect)(()=>{N()},[t]);let w=async()=>{if(f&&t){g(!0);try{await (0,i.deletePromptCall)(t,f.id),k.Z.success('Prompt "'.concat(f.name,'" deleted successfully')),N()}catch(e){console.error("Error deleting prompt:",e),k.Z.fromBackend("Failed to delete prompt")}finally{g(!1),v(null)}}};return(0,s.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[p?(0,s.jsx)(D,{promptId:p,onClose:()=>x(null),accessToken:t,isAdmin:y,onDelete:N}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,s.jsx)(a.z,{onClick:()=>{p&&x(null),j(!0)},disabled:!t,children:"+ Add New Prompt"})}),(0,s.jsx)(b,{promptsList:o,isLoading:d,onPromptClick:e=>{x(e)},onDeleteClick:(e,t)=>{v({id:e,name:t})},accessToken:t,isAdmin:y})]}),(0,s.jsx)(B,{visible:h,onClose:()=>{j(!1)},accessToken:t,onSuccess:()=>{N()}}),f&&(0,s.jsxs)(n.Z,{title:"Delete Prompt",open:null!==f,onOk:w,onCancel:()=>{v(null)},confirmLoading:u,okText:"Delete",okButtonProps:{danger:!0},children:[(0,s.jsxs)("p",{children:["Are you sure you want to delete prompt: ",f.name," ?"]}),(0,s.jsx)("p",{children:"This action cannot be undone."})]})]})}}}]);