"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1036],{91027:function(e,s,t){t.d(s,{Z:function(){return d}});var a=t(57437),l=t(33866),r=t(2265),n=t(9245);function i(e){let s=s=>{"disableShowNewBadge"===s.key&&e()},t=s=>{let{key:t}=s.detail;"disableShowNewBadge"===t&&e()};return window.addEventListener("storage",s),window.addEventListener(n.Qg,t),()=>{window.removeEventListener("storage",s),window.removeEventListener(n.Qg,t)}}function o(){return"true"===(0,n.le)("disableShowNewBadge")}function d(e){let{children:s,dot:t=!1}=e;return(0,r.useSyncExternalStore)(i,o)?s?(0,a.jsx)(a.Fragment,{children:s}):null:s?(0,a.jsx)(l.Z,{color:"blue",count:t?void 0:"New",dot:t,children:s}):(0,a.jsx)(l.Z,{color:"blue",count:t?void 0:"New",dot:t})}},12363:function(e,s,t){t.d(s,{d:function(){return r},n:function(){return l}});var a=t(2265);let l=()=>{let[e,s]=(0,a.useState)("http://localhost:4000");return(0,a.useEffect)(()=>{{let{protocol:e,host:t}=window.location;s("".concat(e,"//").concat(t))}},[]),e},r=25},30841:function(e,s,t){t.d(s,{IE:function(){return r},LO:function(){return l},cT:function(){return n}});var a=t(19250);let l=async e=>{if(!e)return[];try{let{aliases:s}=await (0,a.keyAliasesCall)(e);return Array.from(new Set((s||[]).filter(Boolean)))}catch(e){return console.error("Error fetching all key aliases:",e),[]}},r=async(e,s)=>{if(!e)return[];try{let t=[],l=1,r=!0;for(;r;){let n=await (0,a.teamListCall)(e,s||null,null);t=[...t,...n],l<n.total_pages?l++:r=!1}return t}catch(e){return console.error("Error fetching all teams:",e),[]}},n=async e=>{if(!e)return[];try{let s=[],t=1,l=!0;for(;l;){let r=await (0,a.organizationListCall)(e);s=[...s,...r],t<r.total_pages?t++:l=!1}return s}catch(e){return console.error("Error fetching all organizations:",e),[]}}},23048:function(e,s,t){var a=t(57437),l=t(2265),r=t(5545),n=t(37592),i=t(4260),o=t(2356),d=t(7310),c=t.n(d);s.Z=e=>{let{options:s,onApplyFilters:t,onResetFilters:d,initialValues:m={},buttonLabel:x="Filters"}=e,[u,h]=(0,l.useState)(!1),[g,p]=(0,l.useState)(m),[j,f]=(0,l.useState)({}),[v,y]=(0,l.useState)({}),[b,N]=(0,l.useState)({}),[w,_]=(0,l.useState)({}),k=(0,l.useCallback)(c()(async(e,s)=>{if(s.isSearchable&&s.searchFn){y(e=>({...e,[s.name]:!0}));try{let t=await s.searchFn(e);f(e=>({...e,[s.name]:t}))}catch(e){console.error("Error searching:",e),f(e=>({...e,[s.name]:[]}))}finally{y(e=>({...e,[s.name]:!1}))}}},300),[]),S=(0,l.useCallback)(async e=>{if(e.isSearchable&&e.searchFn&&!w[e.name]){y(s=>({...s,[e.name]:!0})),_(s=>({...s,[e.name]:!0}));try{let s=await e.searchFn("");f(t=>({...t,[e.name]:s}))}catch(s){console.error("Error loading initial options:",s),f(s=>({...s,[e.name]:[]}))}finally{y(s=>({...s,[e.name]:!1}))}}},[w]);(0,l.useEffect)(()=>{u&&s.forEach(e=>{e.isSearchable&&!w[e.name]&&S(e)})},[u,s,S,w]);let C=(e,s)=>{let a={...g,[e]:s};p(a),t(a)},L=(e,s)=>{e&&s.isSearchable&&!w[s.name]&&S(s)};return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,a.jsx)(r.ZP,{icon:(0,a.jsx)(o.Z,{className:"h-4 w-4"}),onClick:()=>h(!u),className:"flex items-center gap-2",children:x}),(0,a.jsx)(r.ZP,{onClick:()=>{let e={};s.forEach(s=>{e[s.name]=""}),p(e),d()},children:"Reset Filters"})]}),u&&(0,a.jsx)("div",{className:"grid grid-cols-3 gap-x-6 gap-y-4 mb-6",children:["Team ID","Status","Organization ID","Key Alias","User ID","End User","Error Code","Error Message","Key Hash","Model"].map(e=>{let t=s.find(s=>s.label===e||s.name===e);return t?(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:t.label||t.name}),t.isSearchable?(0,a.jsx)(n.default,{showSearch:!0,className:"w-full",placeholder:"Search ".concat(t.label||t.name,"..."),value:g[t.name]||void 0,onChange:e=>C(t.name,e),onDropdownVisibleChange:e=>L(e,t),onSearch:e=>{N(s=>({...s,[t.name]:e})),t.searchFn&&k(e,t)},filterOption:!1,loading:v[t.name],options:j[t.name]||[],allowClear:!0,notFoundContent:v[t.name]?"Loading...":"No results found"}):t.options?(0,a.jsx)(n.default,{className:"w-full",placeholder:"Select ".concat(t.label||t.name,"..."),value:g[t.name]||void 0,onChange:e=>C(t.name,e),allowClear:!0,children:t.options.map(e=>(0,a.jsx)(n.default.Option,{value:e.value,children:e.label},e.value))}):(0,a.jsx)(i.default,{className:"w-full",placeholder:"Enter ".concat(t.label||t.name,"..."),value:g[t.name]||"",onChange:e=>C(t.name,e.target.value),allowClear:!0})]},t.name):null})})]})}},81036:function(e,s,t){t.d(s,{I:function(){return sn},Z:function(){return sr}});var a,l,r=t(57437),n=t(29827),i=t(11713),o=t(77398),d=t.n(o),c=t(2265),m=t(99981);let x=e=>e>=.8?"text-green-600":"text-yellow-600";var u=e=>{let{entities:s}=e,[t,a]=(0,c.useState)(!0),[l,n]=(0,c.useState)({}),i=e=>{n(s=>({...s,[e]:!s[e]}))};return s&&0!==s.length?(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2 cursor-pointer",onClick:()=>a(!t),children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,r.jsxs)("h4",{className:"font-medium",children:["Detected Entities (",s.length,")"]})]}),t&&(0,r.jsx)("div",{className:"space-y-2",children:s.map((e,s)=>{let t=l[s]||!1;return(0,r.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>i(s),children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,r.jsx)("span",{className:"font-medium mr-2",children:e.entity_type}),(0,r.jsxs)("span",{className:"font-mono ".concat(x(e.score)),children:["Score: ",e.score.toFixed(2)]})]}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["Position: ",e.start,"-",e.end]})]}),t&&(0,r.jsx)("div",{className:"p-3 border-t bg-white",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Entity Type:"}),(0,r.jsx)("span",{children:e.entity_type})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Position:"}),(0,r.jsxs)("span",{children:["Characters ",e.start,"-",e.end]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Confidence:"}),(0,r.jsx)("span",{className:x(e.score),children:e.score.toFixed(2)})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[e.recognition_metadata&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Recognizer:"}),(0,r.jsx)("span",{children:e.recognition_metadata.recognizer_name})]}),(0,r.jsxs)("div",{className:"flex overflow-hidden",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Identifier:"}),(0,r.jsx)("span",{className:"truncate text-xs font-mono",children:e.recognition_metadata.recognizer_identifier})]})]}),e.analysis_explanation&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Explanation:"}),(0,r.jsx)("span",{children:e.analysis_explanation})]})]})]})})]},s)})})]}):null};let h=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"slate";return(0,r.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat({green:"bg-green-100 text-green-800",red:"bg-red-100 text-red-800",blue:"bg-blue-50 text-blue-700",slate:"bg-slate-100 text-slate-800",amber:"bg-amber-100 text-amber-800"}[s]),children:e})},g=e=>e?h("detected","red"):h("not detected","slate"),p=e=>{let{title:s,count:t,defaultOpen:a=!0,right:l,children:n}=e,[i,o]=(0,c.useState)(a);return(0,r.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>o(e=>!e),children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(i?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,r.jsxs)("h5",{className:"font-medium",children:[s," ","number"==typeof t&&(0,r.jsxs)("span",{className:"text-gray-500 font-normal",children:["(",t,")"]})]})]}),(0,r.jsx)("div",{children:l})]}),i&&(0,r.jsx)("div",{className:"p-3 border-t bg-white",children:n})]})},j=e=>{let{label:s,children:t,mono:a}=e;return(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:s}),(0,r.jsx)("span",{className:a?"font-mono text-sm break-all":"",children:t})]})},f=()=>(0,r.jsx)("div",{className:"my-3 border-t"});var v=e=>{var s,t,a,l,n,i,o,d,c,m;let{response:x}=e;if(!x)return null;let u=null!==(n=null!==(l=x.outputs)&&void 0!==l?l:x.output)&&void 0!==n?n:[],v="GUARDRAIL_INTERVENED"===x.action?"red":"green",y=(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(null===(s=x.guardrailCoverage)||void 0===s?void 0:s.textCharacters)&&h("text guarded ".concat(null!==(i=x.guardrailCoverage.textCharacters.guarded)&&void 0!==i?i:0,"/").concat(null!==(o=x.guardrailCoverage.textCharacters.total)&&void 0!==o?o:0),"blue"),(null===(t=x.guardrailCoverage)||void 0===t?void 0:t.images)&&h("images guarded ".concat(null!==(d=x.guardrailCoverage.images.guarded)&&void 0!==d?d:0,"/").concat(null!==(c=x.guardrailCoverage.images.total)&&void 0!==c?c:0),"blue")]}),b=x.usage&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(x.usage).map(e=>{let[s,t]=e;return"number"==typeof t?(0,r.jsxs)("span",{className:"px-2 py-1 bg-slate-100 text-slate-800 rounded-md text-xs font-medium",children:[s,": ",t]},s):null})});return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j,{label:"Action:",children:h(null!==(m=x.action)&&void 0!==m?m:"N/A",v)}),x.actionReason&&(0,r.jsx)(j,{label:"Action Reason:",children:x.actionReason}),x.blockedResponse&&(0,r.jsx)(j,{label:"Blocked Response:",children:(0,r.jsx)("span",{className:"italic",children:x.blockedResponse})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j,{label:"Coverage:",children:y}),(0,r.jsx)(j,{label:"Usage:",children:b})]})]}),u.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f,{}),(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Outputs"}),(0,r.jsx)("div",{className:"space-y-2",children:u.map((e,s)=>{var t;return(0,r.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,r.jsx)("div",{className:"text-sm whitespace-pre-wrap",children:null!==(t=e.text)&&void 0!==t?t:(0,r.jsx)("em",{children:"(non-text output)"})})},s)})})]})]}),(null===(a=x.assessments)||void 0===a?void 0:a.length)?(0,r.jsx)("div",{className:"space-y-3",children:x.assessments.map((e,s)=>{var t,a,l,n,i,o,d,c,m,x,u,f,v,y,b,N,w,_,k,S,C,L,E,D;let M=(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.wordPolicy&&h("word","slate"),e.contentPolicy&&h("content","slate"),e.topicPolicy&&h("topic","slate"),e.sensitiveInformationPolicy&&h("sensitive-info","slate"),e.contextualGroundingPolicy&&h("contextual-grounding","slate"),e.automatedReasoningPolicy&&h("automated-reasoning","slate")]});return(0,r.jsxs)(p,{title:"Assessment #".concat(s+1),defaultOpen:!0,right:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(null===(t=e.invocationMetrics)||void 0===t?void 0:t.guardrailProcessingLatency)!=null&&h("".concat(e.invocationMetrics.guardrailProcessingLatency," ms"),"amber"),M]}),children:[e.wordPolicy&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h6",{className:"font-medium mb-2",children:"Word Policy"}),(null!==(N=null===(a=e.wordPolicy.customWords)||void 0===a?void 0:a.length)&&void 0!==N?N:0)>0&&(0,r.jsx)(p,{title:"Custom Words",defaultOpen:!0,children:(0,r.jsx)("div",{className:"space-y-2",children:e.wordPolicy.customWords.map((e,s)=>{var t;return(0,r.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[h(null!==(t=e.action)&&void 0!==t?t:"N/A",e.detected?"red":"slate"),(0,r.jsx)("span",{className:"font-mono text-sm break-all",children:e.match})]}),g(e.detected)]},s)})})}),(null!==(w=null===(l=e.wordPolicy.managedWordLists)||void 0===l?void 0:l.length)&&void 0!==w?w:0)>0&&(0,r.jsx)(p,{title:"Managed Word Lists",defaultOpen:!1,children:(0,r.jsx)("div",{className:"space-y-2",children:e.wordPolicy.managedWordLists.map((e,s)=>{var t;return(0,r.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[h(null!==(t=e.action)&&void 0!==t?t:"N/A",e.detected?"red":"slate"),(0,r.jsx)("span",{className:"font-mono text-sm break-all",children:e.match}),e.type&&h(e.type,"slate")]}),g(e.detected)]},s)})})})]}),(null===(i=e.contentPolicy)||void 0===i?void 0:null===(n=i.filters)||void 0===n?void 0:n.length)?(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h6",{className:"font-medium mb-2",children:"Content Policy"}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left text-gray-600",children:[(0,r.jsx)("th",{className:"py-1 pr-4",children:"Type"}),(0,r.jsx)("th",{className:"py-1 pr-4",children:"Action"}),(0,r.jsx)("th",{className:"py-1 pr-4",children:"Detected"}),(0,r.jsx)("th",{className:"py-1 pr-4",children:"Strength"}),(0,r.jsx)("th",{className:"py-1 pr-4",children:"Confidence"})]})}),(0,r.jsx)("tbody",{children:e.contentPolicy.filters.map((e,s)=>{var t,a,l,n;return(0,r.jsxs)("tr",{className:"border-t",children:[(0,r.jsx)("td",{className:"py-1 pr-4",children:null!==(t=e.type)&&void 0!==t?t:"—"}),(0,r.jsx)("td",{className:"py-1 pr-4",children:h(null!==(a=e.action)&&void 0!==a?a:"—",e.detected?"red":"slate")}),(0,r.jsx)("td",{className:"py-1 pr-4",children:g(e.detected)}),(0,r.jsx)("td",{className:"py-1 pr-4",children:null!==(l=e.filterStrength)&&void 0!==l?l:"—"}),(0,r.jsx)("td",{className:"py-1 pr-4",children:null!==(n=e.confidence)&&void 0!==n?n:"—"})]},s)})})]})})]}):null,(null===(d=e.contextualGroundingPolicy)||void 0===d?void 0:null===(o=d.filters)||void 0===o?void 0:o.length)?(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h6",{className:"font-medium mb-2",children:"Contextual Grounding"}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left text-gray-600",children:[(0,r.jsx)("th",{className:"py-1 pr-4",children:"Type"}),(0,r.jsx)("th",{className:"py-1 pr-4",children:"Action"}),(0,r.jsx)("th",{className:"py-1 pr-4",children:"Detected"}),(0,r.jsx)("th",{className:"py-1 pr-4",children:"Score"}),(0,r.jsx)("th",{className:"py-1 pr-4",children:"Threshold"})]})}),(0,r.jsx)("tbody",{children:e.contextualGroundingPolicy.filters.map((e,s)=>{var t,a,l,n;return(0,r.jsxs)("tr",{className:"border-t",children:[(0,r.jsx)("td",{className:"py-1 pr-4",children:null!==(t=e.type)&&void 0!==t?t:"—"}),(0,r.jsx)("td",{className:"py-1 pr-4",children:h(null!==(a=e.action)&&void 0!==a?a:"—",e.detected?"red":"slate")}),(0,r.jsx)("td",{className:"py-1 pr-4",children:g(e.detected)}),(0,r.jsx)("td",{className:"py-1 pr-4",children:null!==(l=e.score)&&void 0!==l?l:"—"}),(0,r.jsx)("td",{className:"py-1 pr-4",children:null!==(n=e.threshold)&&void 0!==n?n:"—"})]},s)})})]})})]}):null,e.sensitiveInformationPolicy&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h6",{className:"font-medium mb-2",children:"Sensitive Information"}),(null!==(_=null===(c=e.sensitiveInformationPolicy.piiEntities)||void 0===c?void 0:c.length)&&void 0!==_?_:0)>0&&(0,r.jsx)(p,{title:"PII Entities",defaultOpen:!0,children:(0,r.jsx)("div",{className:"space-y-2",children:e.sensitiveInformationPolicy.piiEntities.map((e,s)=>{var t;return(0,r.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[h(null!==(t=e.action)&&void 0!==t?t:"N/A",e.detected?"red":"slate"),e.type&&h(e.type,"slate"),(0,r.jsx)("span",{className:"font-mono text-xs break-all",children:e.match})]}),g(e.detected)]},s)})})}),(null!==(k=null===(m=e.sensitiveInformationPolicy.regexes)||void 0===m?void 0:m.length)&&void 0!==k?k:0)>0&&(0,r.jsx)(p,{title:"Custom Regexes",defaultOpen:!1,children:(0,r.jsx)("div",{className:"space-y-2",children:e.sensitiveInformationPolicy.regexes.map((e,s)=>{var t,a;return(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-2 bg-gray-50 rounded gap-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[h(null!==(t=e.action)&&void 0!==t?t:"N/A",e.detected?"red":"slate"),(0,r.jsx)("span",{className:"font-medium",children:null!==(a=e.name)&&void 0!==a?a:"regex"}),(0,r.jsx)("span",{className:"font-mono text-xs break-all",children:e.regex})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[g(e.detected),e.match&&(0,r.jsx)("span",{className:"font-mono text-xs break-all",children:e.match})]})]},s)})})})]}),(null===(u=e.topicPolicy)||void 0===u?void 0:null===(x=u.topics)||void 0===x?void 0:x.length)?(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h6",{className:"font-medium mb-2",children:"Topic Policy"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.topicPolicy.topics.map((e,s)=>{var t,a;return(0,r.jsx)("div",{className:"px-3 py-1.5 bg-gray-50 rounded-md text-xs",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[h(null!==(t=e.action)&&void 0!==t?t:"N/A",e.detected?"red":"slate"),(0,r.jsx)("span",{className:"font-medium",children:null!==(a=e.name)&&void 0!==a?a:"topic"}),e.type&&h(e.type,"slate"),g(e.detected)]})},s)})})]}):null,e.invocationMetrics&&(0,r.jsx)(p,{title:"Invocation Metrics",defaultOpen:!1,children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j,{label:"Latency (ms)",children:null!==(S=e.invocationMetrics.guardrailProcessingLatency)&&void 0!==S?S:"—"}),(0,r.jsx)(j,{label:"Coverage:",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(null===(f=e.invocationMetrics.guardrailCoverage)||void 0===f?void 0:f.textCharacters)&&h("text ".concat(null!==(C=e.invocationMetrics.guardrailCoverage.textCharacters.guarded)&&void 0!==C?C:0,"/").concat(null!==(L=e.invocationMetrics.guardrailCoverage.textCharacters.total)&&void 0!==L?L:0),"blue"),(null===(v=e.invocationMetrics.guardrailCoverage)||void 0===v?void 0:v.images)&&h("images ".concat(null!==(E=e.invocationMetrics.guardrailCoverage.images.guarded)&&void 0!==E?E:0,"/").concat(null!==(D=e.invocationMetrics.guardrailCoverage.images.total)&&void 0!==D?D:0),"blue")]})})]}),(0,r.jsx)("div",{className:"space-y-2",children:(0,r.jsx)(j,{label:"Usage:",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.invocationMetrics.usage&&Object.entries(e.invocationMetrics.usage).map(e=>{let[s,t]=e;return"number"==typeof t?(0,r.jsxs)("span",{className:"px-2 py-1 bg-slate-100 text-slate-800 rounded-md text-xs font-medium",children:[s,": ",t]},s):null})})})})]})}),(null===(b=e.automatedReasoningPolicy)||void 0===b?void 0:null===(y=b.findings)||void 0===y?void 0:y.length)?(0,r.jsx)(p,{title:"Automated Reasoning Findings",defaultOpen:!1,children:(0,r.jsx)("div",{className:"space-y-2",children:e.automatedReasoningPolicy.findings.map((e,s)=>(0,r.jsx)("pre",{className:"bg-gray-50 rounded p-2 text-xs overflow-x-auto",children:JSON.stringify(e,null,2)},s))})}):null]},s)})}):null,(0,r.jsx)(p,{title:"Raw Bedrock Guardrail Response",defaultOpen:!1,children:(0,r.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(x,null,2)})})]})};let y=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"slate";return(0,r.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat({green:"bg-green-100 text-green-800",red:"bg-red-100 text-red-800",blue:"bg-blue-50 text-blue-700",slate:"bg-slate-100 text-slate-800",amber:"bg-amber-100 text-amber-800"}[s]),children:e})},b=e=>{let{title:s,count:t,defaultOpen:a=!0,children:l}=e,[n,i]=(0,c.useState)(a);return(0,r.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>i(e=>!e),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(n?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,r.jsxs)("h5",{className:"font-medium",children:[s," ","number"==typeof t&&(0,r.jsxs)("span",{className:"text-gray-500 font-normal",children:["(",t,")"]})]})]})}),n&&(0,r.jsx)("div",{className:"p-3 border-t bg-white",children:l})]})},N=e=>{let{label:s,children:t,mono:a}=e;return(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:s}),(0,r.jsx)("span",{className:a?"font-mono text-sm break-all":"",children:t})]})};var w=e=>{let{response:s}=e;if(!s||"string"==typeof s)return"string"==typeof s&&s?(0,r.jsx)("div",{className:"bg-white rounded-lg border border-red-200 p-4",children:(0,r.jsxs)("div",{className:"text-red-800",children:[(0,r.jsx)("h5",{className:"font-medium mb-2",children:"Error"}),(0,r.jsx)("p",{className:"text-sm",children:s})]})}):null;let t=Array.isArray(s)?s:[];if(0===t.length)return(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"No detections found"})});let a=t.filter(e=>"pattern"===e.type),l=t.filter(e=>"blocked_word"===e.type),n=t.filter(e=>"category_keyword"===e.type),i=t.filter(e=>"BLOCK"===e.action).length,o=t.filter(e=>"MASK"===e.action).length,d=t.length;return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(N,{label:"Total Detections:",children:(0,r.jsx)("span",{className:"font-semibold",children:d})}),(0,r.jsx)(N,{label:"Actions:",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[i>0&&y("".concat(i," blocked"),"red"),o>0&&y("".concat(o," masked"),"blue"),0===i&&0===o&&y("passed","green")]})})]}),(0,r.jsx)("div",{className:"space-y-2",children:(0,r.jsx)(N,{label:"By Type:",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.length>0&&y("".concat(a.length," patterns"),"slate"),l.length>0&&y("".concat(l.length," keywords"),"slate"),n.length>0&&y("".concat(n.length," categories"),"slate")]})})})]})}),a.length>0&&(0,r.jsx)(b,{title:"Patterns Matched",count:a.length,defaultOpen:!0,children:(0,r.jsx)("div",{className:"space-y-2",children:a.map((e,s)=>(0,r.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)("div",{className:"space-y-1",children:(0,r.jsx)(N,{label:"Pattern:",children:e.pattern_name||"unknown"})}),(0,r.jsx)("div",{className:"space-y-1",children:(0,r.jsx)(N,{label:"Action:",children:y(e.action,"BLOCK"===e.action?"red":"blue")})})]})},s))})}),l.length>0&&(0,r.jsx)(b,{title:"Blocked Words Detected",count:l.length,defaultOpen:!0,children:(0,r.jsx)("div",{className:"space-y-2",children:l.map((e,s)=>(0,r.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(N,{label:"Keyword:",mono:!0,children:e.keyword||"unknown"}),e.description&&(0,r.jsx)(N,{label:"Description:",children:e.description})]}),(0,r.jsx)("div",{className:"space-y-1",children:(0,r.jsx)(N,{label:"Action:",children:y(e.action,"BLOCK"===e.action?"red":"blue")})})]})},s))})}),n.length>0&&(0,r.jsx)(b,{title:"Category Keywords Detected",count:n.length,defaultOpen:!0,children:(0,r.jsx)("div",{className:"space-y-2",children:n.map((e,s)=>(0,r.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(N,{label:"Category:",children:e.category||"unknown"}),(0,r.jsx)(N,{label:"Keyword:",mono:!0,children:e.keyword||"unknown"}),e.severity&&(0,r.jsx)(N,{label:"Severity:",children:y(e.severity,"high"===e.severity?"red":"medium"===e.severity?"amber":"slate")})]}),(0,r.jsx)("div",{className:"space-y-1",children:(0,r.jsx)(N,{label:"Action:",children:y(e.action,"BLOCK"===e.action?"red":"blue")})})]})},s))})}),(0,r.jsx)(b,{title:"Raw Detection Data",defaultOpen:!1,children:(0,r.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(t,null,2)})})]})};let _=e=>new Date(1e3*e).toLocaleString(),k=new Set(["presidio","bedrock","litellm_content_filter"]),S=e=>{let{response:s}=e,[t,a]=(0,c.useState)(!1);return(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>a(!t),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,r.jsx)("h5",{className:"font-medium",children:"Raw Guardrail Response"})]})}),t&&(0,r.jsx)("div",{className:"p-3 border-t bg-white",children:(0,r.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(s,null,2)})})]})})},C=e=>{var s,t;let{entry:a,index:l,total:n}=e,i=null!==(s=a.guardrail_provider)&&void 0!==s?s:"presidio",o=null!==(t=a.guardrail_status)&&void 0!==t?t:"unknown",d="success"===o.toLowerCase(),c=a.masked_entity_count||{},x=Object.values(c).reduce((e,s)=>e+("number"==typeof s?s:0),0),h=a.guardrail_response,g=Array.isArray(h)?h:[],p="bedrock"!==i||null===h||"object"!=typeof h||Array.isArray(h)?void 0:h;return(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[n>1&&(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("h4",{className:"text-base font-semibold",children:["Guardrail #",l+1,(0,r.jsx)("span",{className:"ml-2 font-mono text-sm text-gray-600",children:a.guardrail_name})]}),(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded-md text-xs capitalize",children:i})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail Name:"}),(0,r.jsx)("span",{className:"font-mono break-words",children:a.guardrail_name})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Mode:"}),(0,r.jsx)("span",{className:"font-mono break-words",children:a.guardrail_mode})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,r.jsx)(m.Z,{title:d?null:"Guardrail failed to run.",placement:"top",arrow:!0,destroyTooltipOnHide:!0,children:(0,r.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat(d?"bg-green-100 text-green-800":"bg-red-100 text-red-800 cursor-help"),children:o})})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,r.jsx)("span",{children:_(a.start_time)})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,r.jsx)("span",{children:_(a.end_time)})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,r.jsxs)("span",{children:[a.duration.toFixed(4),"s"]})]})]})]}),x>0&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,r.jsx)("h5",{className:"font-medium mb-2",children:"Masked Entity Summary"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(c).map(e=>{let[s,t]=e;return(0,r.jsxs)("span",{className:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[s,": ",t]},s)})})]}),"presidio"===i&&g.length>0&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(u,{entities:g})}),"bedrock"===i&&p&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(v,{response:p})}),"litellm_content_filter"===i&&h&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(w,{response:h})}),i&&!k.has(i)&&h&&(0,r.jsx)(S,{response:h})]})};var L=e=>{let{data:s}=e,t=Array.isArray(s)?s.filter(e=>!!e):s?[s]:[],[a,l]=(0,c.useState)(!0),n=1===t.length?t[0].guardrail_name:"".concat(t.length," guardrails"),i=Array.from(new Set(t.map(e=>e.guardrail_status))).every(e=>"success"===(null!=e?e:"").toLowerCase()),o=t.reduce((e,s)=>e+Object.values(s.masked_entity_count||{}).reduce((e,s)=>e+("number"==typeof s?s:0),0),0);return 0===t.length?null:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-4 border-b cursor-pointer hover:bg-gray-50",onClick:()=>l(!a),children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-600 transition-transform ".concat(a?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Guardrail Information"}),(0,r.jsx)(m.Z,{title:i?null:"Guardrail failed to run.",placement:"top",arrow:!0,destroyTooltipOnHide:!0,children:(0,r.jsx)("span",{className:"ml-2 px-2 py-1 rounded-md text-xs font-medium inline-block ".concat(i?"bg-green-100 text-green-800":"bg-red-100 text-red-800 cursor-help"),children:i?"success":"failure"})}),(0,r.jsx)("span",{className:"ml-2 font-mono text-sm text-gray-600",children:n}),o>0&&(0,r.jsxs)("span",{className:"ml-2 px-2 py-1 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[o," masked ",1===o?"entity":"entities"]})]}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:a?"Click to collapse":"Click to expand"})]}),a&&(0,r.jsx)("div",{className:"p-4 space-y-6",children:t.map((e,s)=>{var a;return(0,r.jsx)(C,{entry:e,index:s,total:t.length},"".concat(null!==(a=e.guardrail_name)&&void 0!==a?a:"guardrail","-").concat(s))})})]})},E=t(59872),D=t(9309),M=t(55322),T=t(59341),R=t(12485),A=t(18135),O=t(35242),z=t(29706),Z=t(77991),I=t(5545),P=t(20347),K=t(30280),H=t(44633),q=t(86462),F=t(49084),B=t(71594),V=t(24525),Y=t(19130);function U(e){let{keys:s,totalCount:t,isLoading:a,isFetching:l,pageIndex:n,pageSize:i,onPageChange:o}=e,[d,x]=(0,c.useState)([{id:"deleted_at",desc:!0}]),[u,h]=(0,c.useState)({pageIndex:n,pageSize:i});c.useEffect(()=>{h({pageIndex:n,pageSize:i})},[n,i]);let g=[{id:"token",accessorKey:"token",header:"Key ID",size:150,maxSize:250,cell:e=>{let s=e.getValue();return(0,r.jsx)(m.Z,{title:s,children:(0,r.jsx)("span",{className:"font-mono text-blue-500 text-xs truncate block max-w-[250px]",children:s||"-"})})}},{id:"key_alias",accessorKey:"key_alias",header:"Key Alias",size:150,maxSize:200,cell:e=>{let s=e.getValue();return(0,r.jsx)(m.Z,{title:s,children:(0,r.jsx)("span",{className:"font-mono text-xs truncate block max-w-[200px]",children:null!=s?s:"-"})})}},{id:"team_alias",accessorKey:"team_alias",header:"Team Alias",size:120,maxSize:180,cell:e=>{let s=e.getValue();return(0,r.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",size:100,maxSize:140,cell:e=>(0,r.jsx)("span",{className:"block max-w-[140px]",children:(0,E.pw)(e.getValue(),4)})},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",size:110,maxSize:150,cell:e=>{let s=e.getValue();return(0,r.jsx)("span",{className:"block max-w-[150px]",children:null===s?"Unlimited":"$".concat((0,E.pw)(s))})}},{id:"user_email",accessorKey:"user_email",header:"User Email",size:160,maxSize:250,cell:e=>{let s=e.getValue();return(0,r.jsx)(m.Z,{title:s,children:(0,r.jsx)("span",{className:"font-mono text-xs truncate block max-w-[250px]",children:null!=s?s:"-"})})}},{id:"user_id",accessorKey:"user_id",header:"User ID",size:120,maxSize:200,cell:e=>{let s=e.getValue();return(0,r.jsx)(m.Z,{title:s||void 0,children:(0,r.jsx)("span",{className:"truncate block max-w-[200px]",children:s||"-"})})}},{id:"created_at",accessorKey:"created_at",header:"Created At",size:120,maxSize:140,cell:e=>{let s=e.getValue();return(0,r.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"created_by",accessorKey:"created_by",header:"Created By",size:120,maxSize:180,cell:e=>{let s=e.row.original.created_by;return(0,r.jsx)(m.Z,{title:s||void 0,children:(0,r.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})})}},{id:"deleted_at",accessorKey:"deleted_at",header:"Deleted At",size:120,maxSize:140,cell:e=>{let s=e.row.original.deleted_at;return(0,r.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"deleted_by",accessorKey:"deleted_by",header:"Deleted By",size:120,maxSize:180,cell:e=>{let s=e.row.original.deleted_by;return(0,r.jsx)(m.Z,{title:s||void 0,children:(0,r.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})})}}],p=(0,B.b7)({data:s,columns:g,columnResizeMode:"onChange",columnResizeDirection:"ltr",state:{sorting:d,pagination:u},onSortingChange:x,onPaginationChange:e=>{let s="function"==typeof e?e(u):e;h(s),o(s.pageIndex)},getCoreRowModel:(0,V.sC)(),getSortedRowModel:(0,V.tj)(),getPaginationRowModel:(0,V.G_)(),enableSorting:!0,manualSorting:!1,manualPagination:!0,pageCount:Math.ceil(t/i)}),{pageIndex:j}=p.getState().pagination,f=j*i+1,v="".concat(f," - ").concat(Math.min((j+1)*i,t));return(0,r.jsx)("div",{className:"w-full h-full overflow-hidden",children:(0,r.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between w-full mb-4",children:[a||l?(0,r.jsx)("span",{className:"inline-flex text-sm text-gray-700",children:"Loading..."}):(0,r.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",v," of ",t," results"]}),(0,r.jsxs)("div",{className:"inline-flex items-center gap-2",children:[a||l?(0,r.jsx)("span",{className:"text-sm text-gray-700",children:"Loading..."}):(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",j+1," of ",p.getPageCount()]}),(0,r.jsx)("button",{onClick:()=>p.previousPage(),disabled:a||l||!p.getCanPreviousPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,r.jsx)("button",{onClick:()=>p.nextPage(),disabled:a||l||!p.getCanNextPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),(0,r.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,r.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(Y.iA,{className:"[&_td]:py-0.5 [&_th]:py-1",style:{width:p.getCenterTotalSize()},children:[(0,r.jsx)(Y.ss,{children:p.getHeaderGroups().map(e=>(0,r.jsx)(Y.SC,{children:e.headers.map(e=>(0,r.jsx)(Y.xs,{"data-header-id":e.id,className:"py-1 h-8 relative hover:bg-gray-50",style:{width:e.getSize(),maxWidth:e.column.columnDef.maxSize,position:"relative"},onMouseEnter:()=>{let s=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));s&&(s.style.opacity="0.5")},onMouseLeave:()=>{let s=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));s&&!e.column.getIsResizing()&&(s.style.opacity="0")},onClick:e.column.getToggleSortingHandler(),children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,B.ie)(e.column.columnDef.header,e.getContext())}),(0,r.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,r.jsx)(H.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,r.jsx)(q.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,r.jsx)(F.Z,{className:"h-4 w-4 text-gray-400"})}),(0,r.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:"resizer ".concat(p.options.columnResizeDirection," ").concat(e.column.getIsResizing()?"isResizing":""),style:{position:"absolute",right:0,top:0,height:"100%",width:"5px",background:e.column.getIsResizing()?"#3b82f6":"transparent",cursor:"col-resize",userSelect:"none",touchAction:"none",opacity:e.column.getIsResizing()?1:0}})]})},e.id))},e.id))}),(0,r.jsx)(Y.RM,{children:a||l?(0,r.jsx)(Y.SC,{children:(0,r.jsx)(Y.pj,{colSpan:g.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"\uD83D\uDE85 Loading keys..."})})})}):s.length>0?p.getRowModel().rows.map(e=>(0,r.jsx)(Y.SC,{className:"h-8",children:e.getVisibleCells().map(e=>(0,r.jsx)(Y.pj,{style:{width:e.column.getSize(),maxWidth:e.column.columnDef.maxSize,whiteSpace:"pre-wrap",overflow:"hidden"},className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,B.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,r.jsx)(Y.SC,{children:(0,r.jsx)(Y.pj,{colSpan:g.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"No deleted keys found"})})})})})]})})})})]})})}function W(){let[e,s]=(0,c.useState)(0),[t]=(0,c.useState)(50),{data:a,isPending:l,isFetching:n}=(0,K.Tv)(e+1,t);return(0,r.jsx)(U,{keys:(null==a?void 0:a.keys)||[],totalCount:(null==a?void 0:a.total_count)||0,isLoading:l,isFetching:n,pageIndex:e,pageSize:t,onPageChange:s})}var G=t(47359),J=t(41649),Q=t(21626),$=t(97214),X=t(28241),ee=t(58834),es=t(69552),et=t(71876),ea=t(84264),el=t(46468);function er(e){let{teams:s,isLoading:t,isFetching:a}=e,[l,n]=(0,c.useState)([{id:"deleted_at",desc:!0}]),i=[{id:"team_alias",accessorKey:"team_alias",header:"Team Name",size:150,maxSize:200,cell:e=>{let s=e.getValue();return(0,r.jsx)(m.Z,{title:s||void 0,children:(0,r.jsx)("span",{className:"truncate block max-w-[200px]",children:s||"-"})})}},{id:"team_id",accessorKey:"team_id",header:"Team ID",size:150,maxSize:250,cell:e=>{let s=e.getValue();return(0,r.jsx)(m.Z,{title:s,children:(0,r.jsx)("span",{className:"font-mono text-blue-500 text-xs truncate block max-w-[250px]",children:s||"-"})})}},{id:"created_at",accessorKey:"created_at",header:"Created",size:120,maxSize:140,cell:e=>{let s=e.getValue();return(0,r.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",size:100,maxSize:140,cell:e=>{let s=e.row.original.spend;return(0,r.jsx)("span",{className:"block max-w-[140px]",children:void 0!==s?(0,E.pw)(s,4):"-"})}},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",size:110,maxSize:150,cell:e=>{let s=e.getValue();return(0,r.jsx)("span",{className:"block max-w-[150px]",children:null==s?"No limit":"$".concat((0,E.pw)(s))})}},{id:"models",accessorKey:"models",header:"Models",size:200,maxSize:300,cell:e=>{let s=e.getValue();return Array.isArray(s)&&0!==s.length?(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 max-w-[300px]",children:[s.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,r.jsx)(J.Z,{size:"xs",color:"red",children:(0,r.jsx)(ea.Z,{children:"All Proxy Models"})},s):(0,r.jsx)(J.Z,{size:"xs",color:"blue",children:(0,r.jsx)(ea.Z,{children:e.length>30?"".concat((0,el.W0)(e).slice(0,30),"..."):(0,el.W0)(e)})},s)),s.length>3&&(0,r.jsx)(J.Z,{size:"xs",color:"gray",children:(0,r.jsxs)(ea.Z,{children:["+",s.length-3," ",s.length-3==1?"more model":"more models"]})})]}):(0,r.jsx)(J.Z,{size:"xs",color:"red",children:(0,r.jsx)(ea.Z,{children:"All Proxy Models"})})}},{id:"organization_id",accessorKey:"organization_id",header:"Organization",size:150,maxSize:200,cell:e=>{let s=e.getValue();return(0,r.jsx)(m.Z,{title:s||void 0,children:(0,r.jsx)("span",{className:"truncate block max-w-[200px]",children:s||"-"})})}},{id:"deleted_at",accessorKey:"deleted_at",header:"Deleted At",size:120,maxSize:140,cell:e=>{let s=e.row.original.deleted_at;return(0,r.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"deleted_by",accessorKey:"deleted_by",header:"Deleted By",size:120,maxSize:180,cell:e=>{let s=e.row.original.deleted_by;return(0,r.jsx)(m.Z,{title:s||void 0,children:(0,r.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})})}}],o=(0,B.b7)({data:s,columns:i,columnResizeMode:"onChange",columnResizeDirection:"ltr",state:{sorting:l},onSortingChange:n,getCoreRowModel:(0,V.sC)(),getSortedRowModel:(0,V.tj)(),enableSorting:!0,manualSorting:!1});return(0,r.jsx)("div",{className:"w-full h-full overflow-hidden",children:(0,r.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,r.jsx)("div",{className:"flex items-center justify-between w-full mb-4",children:t||a?(0,r.jsx)("span",{className:"inline-flex text-sm text-gray-700",children:"Loading..."}):(0,r.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",s.length," ",1===s.length?"team":"teams"]})}),(0,r.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,r.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(Q.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",style:{width:o.getCenterTotalSize()},children:[(0,r.jsx)(ee.Z,{children:o.getHeaderGroups().map(e=>(0,r.jsx)(et.Z,{children:e.headers.map(e=>(0,r.jsx)(es.Z,{"data-header-id":e.id,className:"py-1 h-8 relative hover:bg-gray-50",style:{width:e.getSize(),maxWidth:e.column.columnDef.maxSize,position:"relative"},onMouseEnter:()=>{let s=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));s&&(s.style.opacity="0.5")},onMouseLeave:()=>{let s=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));s&&!e.column.getIsResizing()&&(s.style.opacity="0")},onClick:e.column.getToggleSortingHandler(),children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,B.ie)(e.column.columnDef.header,e.getContext())}),(0,r.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,r.jsx)(H.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,r.jsx)(q.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,r.jsx)(F.Z,{className:"h-4 w-4 text-gray-400"})}),(0,r.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:"resizer ".concat(o.options.columnResizeDirection," ").concat(e.column.getIsResizing()?"isResizing":""),style:{position:"absolute",right:0,top:0,height:"100%",width:"5px",background:e.column.getIsResizing()?"#3b82f6":"transparent",cursor:"col-resize",userSelect:"none",touchAction:"none",opacity:e.column.getIsResizing()?1:0}})]})},e.id))},e.id))}),(0,r.jsx)($.Z,{children:t||a?(0,r.jsx)(et.Z,{children:(0,r.jsx)(X.Z,{colSpan:i.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"\uD83D\uDE85 Loading teams..."})})})}):s.length>0?o.getRowModel().rows.map(e=>(0,r.jsx)(et.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,r.jsx)(X.Z,{style:{width:e.column.getSize(),maxWidth:e.column.columnDef.maxSize,whiteSpace:"pre-wrap",overflow:"hidden"},className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,B.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,r.jsx)(et.Z,{children:(0,r.jsx)(X.Z,{colSpan:i.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"No deleted teams found"})})})})})]})})})})]})})}function en(){let{data:e,isPending:s,isFetching:t}=(0,G.iN)(1,100);return(0,r.jsx)(er,{teams:e||[],isLoading:s,isFetching:t})}var ei=t(30841),eo=t(23048),ed=t(19250),ec=t(50665),em=t(60493),ex=t(78489),eu=t(42673);let eh=e=>{try{return new Date(e).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).replace(",","")}catch(e){return"Error converting time"}},eg=e=>{let{utcTime:s}=e;return(0,r.jsx)("span",{style:{fontFamily:"monospace",width:"180px",display:"inline-block"},children:eh(s)})},ep=(e,s)=>{var t,a;return(null===(a=e.metadata)||void 0===a?void 0:null===(t=a.mcp_tool_call_metadata)||void 0===t?void 0:t.mcp_server_logo_url)?e.metadata.mcp_tool_call_metadata.mcp_server_logo_url:s?(0,eu.dr)(s).logo:""},ej=[{id:"expander",header:()=>null,cell:e=>{let{row:s}=e;return(0,r.jsx)(()=>{let[e,t]=c.useState(s.getIsExpanded()),a=c.useCallback(()=>{t(e=>!e),s.getToggleExpandedHandler()()},[s]);return s.getCanExpand()?(0,r.jsx)("button",{onClick:a,style:{cursor:"pointer"},"aria-label":e?"Collapse row":"Expand row",className:"w-6 h-6 flex items-center justify-center focus:outline-none",children:(0,r.jsx)("svg",{className:"w-4 h-4 transform transition-transform duration-75 ".concat(e?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):(0,r.jsx)("span",{className:"w-6 h-6 flex items-center justify-center",children:"●"})},{})}},{header:"Time",accessorKey:"startTime",cell:e=>(0,r.jsx)(eg,{utcTime:e.getValue()})},{header:"Status",accessorKey:"metadata.status",cell:e=>{let s="failure"!==(e.getValue()||"Success").toLowerCase();return(0,r.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat(s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s?"Success":"Failure"})}},{header:"Session ID",accessorKey:"session_id",cell:e=>{let s=String(e.getValue()||""),t=e.row.original.onSessionClick;return(0,r.jsx)(m.Z,{title:String(e.getValue()||""),children:(0,r.jsx)(ex.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal text-xs max-w-[15ch] truncate block",onClick:()=>null==t?void 0:t(s),children:String(e.getValue()||"")})})}},{header:"Request ID",accessorKey:"request_id",cell:e=>(0,r.jsx)(m.Z,{title:String(e.getValue()||""),children:(0,r.jsx)("span",{className:"font-mono text-xs max-w-[15ch] truncate block",children:String(e.getValue()||"")})})},{header:"Cost",accessorKey:"spend",cell:e=>(0,r.jsx)(m.Z,{title:"$".concat(String(e.getValue()||0)," "),children:(0,r.jsx)("span",{children:(0,E.GS)(e.getValue()||0)})})},{header:"Duration (s)",accessorKey:"duration",cell:e=>(0,r.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Team Name",accessorKey:"metadata.user_api_key_team_alias",cell:e=>(0,r.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Key Hash",accessorKey:"metadata.user_api_key",cell:e=>{let s=String(e.getValue()||"-"),t=e.row.original.onKeyHashClick;return(0,r.jsx)(m.Z,{title:s,children:(0,r.jsx)("span",{className:"font-mono max-w-[15ch] truncate block cursor-pointer hover:text-blue-600",onClick:()=>null==t?void 0:t(s),children:s})})}},{header:"Key Name",accessorKey:"metadata.user_api_key_alias",cell:e=>(0,r.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Model",accessorKey:"model",cell:e=>{let s=e.row.original,t=s.custom_llm_provider,a=String(e.getValue()||"");return(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,r.jsx)("img",{src:ep(s,t),alt:"",className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,r.jsx)(m.Z,{title:a,children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:a})})]})}},{header:"Tokens",accessorKey:"total_tokens",cell:e=>{let s=e.row.original;return(0,r.jsxs)("span",{className:"text-sm",children:[String(s.total_tokens||"0"),(0,r.jsxs)("span",{className:"text-gray-400 text-xs ml-1",children:["(",String(s.prompt_tokens||"0"),"+",String(s.completion_tokens||"0"),")"]})]})}},{header:"Internal User",accessorKey:"user",cell:e=>(0,r.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"End User",accessorKey:"end_user",cell:e=>(0,r.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Tags",accessorKey:"request_tags",cell:e=>{let s=e.getValue();if(!s||0===Object.keys(s).length)return"-";let t=Object.entries(s),a=t[0],l=t.slice(1);return(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:(0,r.jsx)(m.Z,{title:(0,r.jsx)("div",{className:"flex flex-col gap-1",children:t.map(e=>{let[s,t]=e;return(0,r.jsxs)("span",{children:[s,": ",String(t)]},s)})}),children:(0,r.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[a[0],": ",String(a[1]),l.length>0&&" +".concat(l.length)]})})})}}],ef=e=>(0,r.jsx)(J.Z,{color:"gray",className:"flex items-center gap-1",children:(0,r.jsx)("span",{className:"whitespace-nowrap text-xs",children:e})}),ev=[{id:"expander",header:()=>null,cell:e=>{let{row:s}=e;return(0,r.jsx)(()=>{let[e,t]=c.useState(s.getIsExpanded()),a=c.useCallback(()=>{t(e=>!e),s.getToggleExpandedHandler()()},[s]);return s.getCanExpand()?(0,r.jsx)("button",{onClick:a,style:{cursor:"pointer"},"aria-label":e?"Collapse row":"Expand row",className:"w-6 h-6 flex items-center justify-center focus:outline-none",children:(0,r.jsx)("svg",{className:"w-4 h-4 transform transition-transform ".concat(e?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):(0,r.jsx)("span",{className:"w-6 h-6 flex items-center justify-center",children:"●"})},{})}},{header:"Timestamp",accessorKey:"updated_at",cell:e=>(0,r.jsx)(eg,{utcTime:e.getValue()})},{header:"Table Name",accessorKey:"table_name",cell:e=>{let s=e.getValue(),t=s;switch(s){case"LiteLLM_VerificationToken":t="Keys";break;case"LiteLLM_TeamTable":t="Teams";break;case"LiteLLM_OrganizationTable":t="Organizations";break;case"LiteLLM_UserTable":t="Users";break;case"LiteLLM_ProxyModelTable":t="Models";break;default:t=s}return(0,r.jsx)("span",{children:t})}},{header:"Action",accessorKey:"action",cell:e=>(0,r.jsx)("span",{children:ef(e.getValue())})},{header:"Changed By",accessorKey:"changed_by",cell:e=>{let s=e.row.original.changed_by,t=e.row.original.changed_by_api_key;return(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"font-medium",children:s}),t&&(0,r.jsx)(m.Z,{title:t,children:(0,r.jsxs)("div",{className:"text-xs text-muted-foreground max-w-[15ch] truncate",children:[" ",t]})})]})}},{header:"Affected Item ID",accessorKey:"object_id",cell:e=>(0,r.jsx)(()=>{let s=e.getValue(),[t,a]=(0,c.useState)(!1);if(!s)return(0,r.jsx)(r.Fragment,{children:"-"});let l=async()=>{try{await navigator.clipboard.writeText(String(s)),a(!0),setTimeout(()=>a(!1),1500)}catch(e){console.error("Failed to copy object ID: ",e)}};return(0,r.jsx)(m.Z,{title:t?"Copied!":String(s),children:(0,r.jsx)("span",{className:"max-w-[20ch] truncate block cursor-pointer hover:text-blue-600",onClick:l,children:String(s)})})},{})}];var ey=t(92280);let eb="".concat("../ui/assets/","audit-logs-preview.png");function eN(e){let{userID:s,userRole:t,token:a,accessToken:l,isActive:n,premiumUser:o,allTeams:m}=e,[x,u]=(0,c.useState)(d()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),h=(0,c.useRef)(null),g=(0,c.useRef)(null),[p,j]=(0,c.useState)(1),[f]=(0,c.useState)(50),[v,y]=(0,c.useState)({}),[b,N]=(0,c.useState)(""),[w,_]=(0,c.useState)(""),[k,S]=(0,c.useState)(""),[C,L]=(0,c.useState)("all"),[D,M]=(0,c.useState)("all"),[T,R]=(0,c.useState)(!1),[A,O]=(0,c.useState)(!1),z=(0,i.a)({queryKey:["all_audit_logs",l,a,t,s,x],queryFn:async()=>{if(!l||!a||!t||!s)return[];let e=d()(x).utc().format("YYYY-MM-DD HH:mm:ss"),r=d()().utc().format("YYYY-MM-DD HH:mm:ss"),n=[],i=1,o=1;do{let s=await (0,ed.uiAuditLogsCall)(l,e,r,i,50);n=n.concat(s.audit_logs),o=s.total_pages,i++}while(i<=o);return n},enabled:!!l&&!!a&&!!t&&!!s&&n,refetchInterval:5e3,refetchIntervalInBackground:!0}),Z=(0,c.useCallback)(async e=>{if(l)try{let s=(await (0,ed.keyListCall)(l,null,null,e,null,null,1,10)).keys.find(s=>s.key_alias===e);s?_(s.token):_("")}catch(e){console.error("Error fetching key hash for alias:",e),_("")}},[l]);(0,c.useEffect)(()=>{if(!l)return;let e=!1,s=!1;v["Team ID"]?b!==v["Team ID"]&&(N(v["Team ID"]),e=!0):""!==b&&(N(""),e=!0),v["Key Hash"]?w!==v["Key Hash"]&&(_(v["Key Hash"]),s=!0):v["Key Alias"]?Z(v["Key Alias"]):""!==w&&(_(""),s=!0),(e||s)&&j(1)},[v,l,Z,b,w]),(0,c.useEffect)(()=>{j(1)},[b,w,x,k,C,D]),(0,c.useEffect)(()=>{function e(e){h.current&&!h.current.contains(e.target)&&R(!1),g.current&&!g.current.contains(e.target)&&O(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let I=(0,c.useMemo)(()=>z.data?z.data.filter(e=>{var s,t,a,l,r,n,i;let o=!0,d=!0,c=!0,m=!0,x=!0;if(b){let r="string"==typeof e.before_value?null===(s=JSON.parse(e.before_value))||void 0===s?void 0:s.team_id:null===(t=e.before_value)||void 0===t?void 0:t.team_id,n="string"==typeof e.updated_values?null===(a=JSON.parse(e.updated_values))||void 0===a?void 0:a.team_id:null===(l=e.updated_values)||void 0===l?void 0:l.team_id;o=r===b||n===b}if(w)try{let s="string"==typeof e.before_value?JSON.parse(e.before_value):e.before_value,t="string"==typeof e.updated_values?JSON.parse(e.updated_values):e.updated_values,a=null==s?void 0:s.token,l=null==t?void 0:t.token;d="string"==typeof a&&a.includes(w)||"string"==typeof l&&l.includes(w)}catch(e){d=!1}if(k&&(c=null===(r=e.object_id)||void 0===r?void 0:r.toLowerCase().includes(k.toLowerCase())),"all"!==C&&(m=(null===(n=e.action)||void 0===n?void 0:n.toLowerCase())===C.toLowerCase()),"all"!==D){let s="";switch(D){case"keys":s="litellm_verificationtoken";break;case"teams":s="litellm_teamtable";break;case"users":s="litellm_usertable";break;default:s=D}x=(null===(i=e.table_name)||void 0===i?void 0:i.toLowerCase())===s}return o&&d&&c&&m&&x}):[],[z.data,b,w,k,C,D]),P=I.length,K=Math.ceil(P/f)||1,H=(0,c.useMemo)(()=>{let e=(p-1)*f,s=e+f;return I.slice(e,s)},[I,p,f]),q=!z.data||0===z.data.length,F=(0,c.useCallback)(e=>{let{row:s}=e;return(0,r.jsx)(e=>{let{rowData:s}=e,{before_value:t,updated_values:a,table_name:l,action:n}=s,i=(e,s)=>{if(!e||0===Object.keys(e).length)return(0,r.jsx)(ey.x,{children:"N/A"});if(s){let s=Object.keys(e),t=["token","spend","max_budget"];if(s.every(e=>t.includes(e))&&s.length>0)return(0,r.jsxs)("div",{children:[s.includes("token")&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Token:"})," ",e.token||"N/A"]}),s.includes("spend")&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Spend:"})," ",void 0!==e.spend?"$".concat((0,E.pw)(e.spend,6)):"N/A"]}),s.includes("max_budget")&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Max Budget:"})," ",void 0!==e.max_budget?"$".concat((0,E.pw)(e.max_budget,6)):"N/A"]})]});if(e["No differing fields detected in 'before' state"]||e["No differing fields detected in 'updated' state"]||e["No fields changed"])return(0,r.jsx)(ey.x,{children:e[Object.keys(e)[0]]})}return(0,r.jsx)("pre",{className:"p-2 bg-gray-50 border rounded text-xs overflow-auto max-h-60",children:JSON.stringify(e,null,2)})},o=t,d=a;if(("updated"===n||"rotated"===n)&&t&&a&&("LiteLLM_TeamTable"===l||"LiteLLM_UserTable"===l||"LiteLLM_VerificationToken"===l)){let e={},s={};new Set([...Object.keys(t),...Object.keys(a)]).forEach(l=>{JSON.stringify(t[l])!==JSON.stringify(a[l])&&(t.hasOwnProperty(l)&&(e[l]=t[l]),a.hasOwnProperty(l)&&(s[l]=a[l]))}),Object.keys(t).forEach(l=>{a.hasOwnProperty(l)||e.hasOwnProperty(l)||(e[l]=t[l],s[l]=void 0)}),Object.keys(a).forEach(l=>{t.hasOwnProperty(l)||s.hasOwnProperty(l)||(s[l]=a[l],e[l]=void 0)}),o=Object.keys(e).length>0?e:{"No differing fields detected in 'before' state":"N/A"},d=Object.keys(s).length>0?s:{"No differing fields detected in 'updated' state":"N/A"},0===Object.keys(e).length&&0===Object.keys(s).length&&(o={"No fields changed":"N/A"},d={"No fields changed":"N/A"})}return(0,r.jsxs)("div",{className:"-mx-4 p-4 bg-slate-100 border-y border-slate-300 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Before Value:"}),i(o,"LiteLLM_VerificationToken"===l)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Updated Value:"}),i(d,"LiteLLM_VerificationToken"===l)]})]})},{rowData:s.original})},[]);if(!o)return(0,r.jsxs)("div",{style:{textAlign:"center",marginTop:"20px"},children:[(0,r.jsx)("h1",{style:{display:"block",marginBottom:"10px"},children:"✨ Enterprise Feature."}),(0,r.jsx)(ey.x,{style:{display:"block",marginBottom:"10px"},children:"This is a LiteLLM Enterprise feature, and requires a valid key to use."}),(0,r.jsx)(ey.x,{style:{display:"block",marginBottom:"20px",fontStyle:"italic"},children:"Here's a preview of what Audit Logs offer:"}),(0,r.jsx)("img",{src:eb,alt:"Audit Logs Preview",style:{maxWidth:"100%",maxHeight:"700px",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",margin:"0 auto"},onError:e=>{console.error("Failed to load audit logs preview image"),e.target.style.display="none"}})]});let B=P>0?(p-1)*f+1:0,V=Math.min(p*f,P);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-4"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"border-b px-6 py-4",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold py-4",children:"Audit Logs"}),(0,r.jsx)(e=>{let{show:s}=e;return s?(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start mb-6",children:[(0,r.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,r.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Audit Logs Not Available"}),(0,r.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"To enable audit logging, add the following configuration to your LiteLLM proxy configuration file:"}),(0,r.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"litellm_settings:\n  store_audit_logs: true"}),(0,r.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change and proxy restart."})]})]}):null},{show:q}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:[(0,r.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("input",{type:"text",placeholder:"Search by Object ID...",value:k,onChange:e=>S(e.target.value),className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,r.jsxs)("button",{onClick:()=>{z.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,r.jsx)("svg",{className:"w-4 h-4 ".concat(z.isFetching?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,r.jsx)("span",{children:"Refresh"})]})]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"relative",ref:h,children:[(0,r.jsx)("label",{htmlFor:"actionFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Action:"}),(0,r.jsxs)("button",{id:"actionFilterDisplay",onClick:()=>R(!T),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,r.jsxs)("span",{children:["all"===C&&"All Actions","created"===C&&"Created","updated"===C&&"Updated","deleted"===C&&"Deleted","rotated"===C&&"Rotated"]}),(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),T&&(0,r.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,r.jsx)("div",{className:"space-y-1",children:[{label:"All Actions",value:"all"},{label:"Created",value:"created"},{label:"Updated",value:"updated"},{label:"Deleted",value:"deleted"},{label:"Rotated",value:"rotated"}].map(e=>(0,r.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(C===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"),onClick:()=>{L(e.value),R(!1)},children:e.label},e.value))})})]}),(0,r.jsxs)("div",{className:"relative",ref:g,children:[(0,r.jsx)("label",{htmlFor:"tableFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Table:"}),(0,r.jsxs)("button",{id:"tableFilterDisplay",onClick:()=>O(!A),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,r.jsxs)("span",{children:["all"===D&&"All Tables","keys"===D&&"Keys","teams"===D&&"Teams","users"===D&&"Users"]}),(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),A&&(0,r.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,r.jsx)("div",{className:"space-y-1",children:[{label:"All Tables",value:"all"},{label:"Keys",value:"keys"},{label:"Teams",value:"teams"},{label:"Users",value:"users"}].map(e=>(0,r.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(D===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"),onClick:()=>{M(e.value),O(!1)},children:e.label},e.value))})})]}),(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing ",z.isLoading?"...":B," -"," ",z.isLoading?"...":V," of"," ",z.isLoading?"...":P," results"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",z.isLoading?"...":p," of"," ",z.isLoading?"...":K]}),(0,r.jsx)("button",{onClick:()=>j(e=>Math.max(1,e-1)),disabled:z.isLoading||1===p,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,r.jsx)("button",{onClick:()=>j(e=>Math.min(K,e+1)),disabled:z.isLoading||p===K,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]}),(0,r.jsx)(em.w,{columns:ev,data:H,renderSubComponent:F,getRowCanExpand:()=>!0})]})]})}let ew=e=>{let{show:s,onOpenSettings:t}=e;return s?(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start",children:[(0,r.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,r.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Request/Response Data Not Available"}),(0,r.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["To view request and response details, enable prompt storage in your LiteLLM configuration by adding the following to your ",(0,r.jsx)("code",{className:"bg-blue-100 px-1 py-0.5 rounded",children:"proxy_config.yaml"})," file",t&&(0,r.jsxs)(r.Fragment,{children:[" or"," ",(0,r.jsx)("button",{onClick:t,className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"open the settings"})," ","to configure this directly."]})]}),(0,r.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"general_settings:\n  store_model_in_db: true\n  store_prompts_in_spend_logs: true"}),(0,r.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change."})]})]}):null};var e_=t(87452),ek=t(88829),eS=t(72208);let eC=e=>null==e?"-":"$".concat((0,E.pw)(e,8)),eL=e=>null==e?"-":"".concat((100*e).toFixed(2),"%"),eE=e=>{var s;let{costBreakdown:t,totalSpend:a}=e;if(!t)return null;let l=void 0!==t.discount_percent&&0!==t.discount_percent||void 0!==t.discount_amount&&0!==t.discount_amount,n=void 0!==t.margin_percent&&0!==t.margin_percent||void 0!==t.margin_fixed_amount&&0!==t.margin_fixed_amount||void 0!==t.margin_total_amount&&0!==t.margin_total_amount;return void 0!==t.input_cost||void 0!==t.output_cost||l||n?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden",children:(0,r.jsxs)(e_.Z,{children:[(0,r.jsx)(eS.Z,{className:"p-4 border-b hover:bg-gray-50 transition-colors text-left",children:(0,r.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Cost Breakdown"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 mr-4",children:[(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Total:"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:eC(a)})]})]})}),(0,r.jsx)(ek.Z,{className:"px-0",children:(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2 max-w-2xl",children:[(0,r.jsxs)("div",{className:"flex text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Input Cost:"}),(0,r.jsx)("span",{className:"text-gray-900",children:eC(t.input_cost)})]}),(0,r.jsxs)("div",{className:"flex text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Output Cost:"}),(0,r.jsx)("span",{className:"text-gray-900",children:eC(t.output_cost)})]}),void 0!==t.tool_usage_cost&&t.tool_usage_cost>0&&(0,r.jsxs)("div",{className:"flex text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Tool Usage Cost:"}),(0,r.jsx)("span",{className:"text-gray-900",children:eC(t.tool_usage_cost)})]})]}),(0,r.jsx)("div",{className:"pt-2 border-t border-gray-100 max-w-2xl",children:(0,r.jsxs)("div",{className:"flex text-sm font-semibold",children:[(0,r.jsx)("span",{className:"text-gray-900 w-1/3",children:"Original LLM Cost:"}),(0,r.jsx)("span",{className:"text-gray-900",children:eC(t.original_cost)})]})}),(l||n)&&(0,r.jsxs)("div",{className:"pt-2 space-y-2 max-w-2xl",children:[l&&(0,r.jsxs)("div",{className:"space-y-2",children:[void 0!==t.discount_percent&&0!==t.discount_percent&&(0,r.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,r.jsxs)("span",{className:"font-medium w-1/3",children:["Discount (",eL(t.discount_percent),"):"]}),(0,r.jsxs)("span",{className:"text-gray-900",children:["-",eC(t.discount_amount)]})]}),void 0!==t.discount_amount&&void 0===t.discount_percent&&(0,r.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Discount Amount:"}),(0,r.jsxs)("span",{className:"text-gray-900",children:["-",eC(t.discount_amount)]})]})]}),n&&(0,r.jsxs)("div",{className:"space-y-2",children:[void 0!==t.margin_percent&&0!==t.margin_percent&&(0,r.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,r.jsxs)("span",{className:"font-medium w-1/3",children:["Margin (",eL(t.margin_percent),"):"]}),(0,r.jsxs)("span",{className:"text-gray-900",children:["+",eC((t.margin_total_amount||0)-(t.margin_fixed_amount||0))]})]}),void 0!==t.margin_fixed_amount&&0!==t.margin_fixed_amount&&(0,r.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Margin:"}),(0,r.jsxs)("span",{className:"text-gray-900",children:["+",eC(t.margin_fixed_amount)]})]})]})]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 max-w-2xl",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"font-bold text-sm text-gray-900 w-1/3",children:"Final Calculated Cost:"}),(0,r.jsx)("span",{className:"text-sm font-bold text-gray-900",children:eC(null!==(s=t.total_cost)&&void 0!==s?s:a)})]})})]})})]})}):null},eD=e=>{var s;let{errorInfo:t}=e,[a,l]=c.useState({}),[n,i]=c.useState(!1),o=e=>{l(s=>({...s,[e]:!s[e]}))},d=t.traceback&&(s=t.traceback)?Array.from(s.matchAll(/File "([^"]+)", line (\d+)/g)).map(e=>{let t=e[1],a=e[2],l=t.split("/").pop()||t,r=e.index||0,n=s.indexOf('File "',r+1),i=n>-1?s.substring(r,n).trim():s.substring(r).trim(),o=i.split("\n"),d="";return o.length>1&&(d=o[o.length-1].trim()),{filePath:t,fileName:l,lineNumber:a,code:d,inFunction:i.includes(" in ")?i.split(" in ")[1].split("\n")[0]:""}}):[];return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"p-4 border-b",children:(0,r.jsxs)("h3",{className:"text-lg font-medium flex items-center text-red-600",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Error Details"]})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"bg-red-50 rounded-md p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"text-red-800 font-medium w-20",children:"Type:"}),(0,r.jsx)("span",{className:"text-red-700",children:t.error_class||"Unknown Error"})]}),(0,r.jsxs)("div",{className:"flex mt-2",children:[(0,r.jsx)("span",{className:"text-red-800 font-medium w-20 flex-shrink-0",children:"Message:"}),(0,r.jsx)("span",{className:"text-red-700 break-words whitespace-pre-wrap",children:t.error_message||"Unknown error occurred"})]})]}),t.traceback&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h4",{className:"font-medium",children:"Traceback"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>{let e=!n;if(i(e),d.length>0){let s={};d.forEach((t,a)=>{s[a]=e}),l(s)}},className:"text-gray-500 hover:text-gray-700 flex items-center text-sm",children:n?"Collapse All":"Expand All"}),(0,r.jsxs)("button",{onClick:()=>navigator.clipboard.writeText(t.traceback||""),className:"text-gray-500 hover:text-gray-700 flex items-center",title:"Copy traceback",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),(0,r.jsx)("span",{className:"ml-1",children:"Copy"})]})]})]}),(0,r.jsx)("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden shadow-sm",children:d.map((e,s)=>(0,r.jsxs)("div",{className:"border-b border-gray-200 last:border-b-0",children:[(0,r.jsxs)("div",{className:"px-4 py-2 flex items-center justify-between cursor-pointer hover:bg-gray-50",onClick:()=>o(s),children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-gray-400 mr-2 w-12 text-right",children:e.lineNumber}),(0,r.jsx)("span",{className:"text-gray-600 font-medium",children:e.fileName}),(0,r.jsx)("span",{className:"text-gray-500 mx-1",children:"in"}),(0,r.jsx)("span",{className:"text-indigo-600 font-medium",children:e.inFunction||e.fileName})]}),(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-500 transition-transform ".concat(a[s]?"transform rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(a[s]||!1)&&e.code&&(0,r.jsx)("div",{className:"px-12 py-2 font-mono text-sm text-gray-800 bg-gray-50 overflow-x-auto border-t border-gray-100",children:e.code})]},s))})]})]})]})};var eM=t(7310),eT=t.n(eM),eR=t(12363);let eA={TEAM_ID:"Team ID",KEY_HASH:"Key Hash",REQUEST_ID:"Request ID",MODEL:"Model",USER_ID:"User ID",END_USER:"End User",STATUS:"Status",KEY_ALIAS:"Key Alias",ERROR_CODE:"Error Code",ERROR_MESSAGE:"Error Message"},eO=(e,s,t)=>{if(e)return"".concat(d()(s).format("MMM D, h:mm A")," - ").concat(d()(t).format("MMM D, h:mm A"));let a=d()(),l=d()(s),r=a.diff(l,"minutes");if(r>=0&&r<2)return"Last 1 Minute";if(r>=2&&r<16)return"Last 15 Minutes";if(r>=16&&r<61)return"Last Hour";let n=a.diff(l,"hours");return n>=1&&n<5?"Last 4 Hours":n>=5&&n<25?"Last 24 Hours":n>=25&&n<169?"Last 7 Days":"".concat(l.format("MMM D")," - ").concat(a.format("MMM D"))},ez=async(e,s,t,a)=>{console.log("prefetchLogDetails called with",e.length,"logs");let l=e.map(e=>{if(e.request_id)return console.log("Prefetching details for request_id:",e.request_id),a.prefetchQuery({queryKey:["logDetails",e.request_id,s],queryFn:async()=>{console.log("Fetching details for",e.request_id);let a=await (0,ed.uiSpendLogDetailsCall)(t,e.request_id,s);return console.log("Received details for",e.request_id,":",a?"success":"failed"),a},staleTime:6e5,gcTime:6e5})});try{let e=await Promise.all(l);return console.log("All prefetch promises completed:",e.length),e}catch(e){throw console.error("Error in prefetchLogDetails:",e),e}};var eZ=t(9114),eI=t(86669);function eP(e){let{row:s,hasClientRequest:t,hasModelRequest:a,hasClientResponse:l,hasError:n,errorInfo:i,getClientRequest:o,getModelRequest:d,formattedResponse:c}=e,m=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select();let t=document.execCommand("copy");if(document.body.removeChild(s),!t)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}},x=(e,s,t)=>async()=>{await m(JSON.stringify(e(),null,2))?eZ.Z.success(s):eZ.Z.fromBackend(t)},u=[{key:"client-request",title:"Request from client",hasData:t,getData:o,copyTitle:"Copy request from client",successMessage:"Client request copied to clipboard",errorMessage:"Failed to copy client request",emptyText:"Request from client not available"},{key:"model-request",title:"Request to model/endpoint",hasData:a,getData:d,copyTitle:"Copy request to model/endpoint",successMessage:"Request to model/endpoint copied to clipboard",errorMessage:"Failed to copy request to model/endpoint",emptyText:(0,r.jsxs)("span",{className:"block whitespace-normal break-words text-left max-w-prose mx-auto",children:["Request not available. Enable"," ",(0,r.jsx)("a",{className:"text-blue-600 underline",href:"https://docs.litellm.ai/docs/proxy/config_settings#store_prompts_in_spend_logs",target:"_blank",rel:"noreferrer",children:(0,r.jsx)("code",{children:"store_prompts_in_spend_logs"})})," ","to capture and display model requests. If content is truncated, raise"," ",(0,r.jsx)("a",{className:"text-blue-600 underline",href:"https://docs.litellm.ai/docs/proxy/config_settings#store_prompts_in_spend_logs#MAX_STRING_LENGTH_PROMPT_IN_DB",target:"_blank",rel:"noreferrer",children:(0,r.jsx)("code",{children:"MAX_STRING_LENGTH_PROMPT_IN_DB"})}),"."]})},{key:"client-response",title:"Response to client",hasData:l,getData:c,copyTitle:"Copy response to client",successMessage:"Response to client copied to clipboard",errorMessage:"Failed to copy response to client",emptyText:"Response to client not available"}];return(0,r.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 w-full max-w-full overflow-hidden box-border",children:u.map(e=>{let s=!!e.hasData,t=s?e.getData():null,a=x(e.getData,e.successMessage,e.errorMessage);return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium",children:[e.title,"client-response"===e.key&&n&&(0,r.jsxs)("span",{className:"ml-2 text-sm text-red-600",children:["• HTTP code ",(null==i?void 0:i.error_code)||400]})]}),(0,r.jsx)("button",{onClick:a,className:"p-1 hover:bg-gray-200 rounded",title:e.copyTitle,disabled:!s,children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,r.jsx)("div",{className:"p-4 overflow-auto max-h-96 w-full max-w-full box-border",children:s?(0,r.jsx)("div",{className:"[&_[role='tree']]:bg-white [&_[role='tree']]:text-slate-900",children:(0,r.jsx)(eI.gc,{data:t,style:eI.jF,clickToExpandNode:!0})}):(0,r.jsx)("div",{className:"text-gray-500 text-sm italic text-center py-4",children:e.emptyText})})]},e.key)})})}t(52621);var eK=t(12514),eH=t(35829),eq=t(96761),eF=t(10900),eB=t(30401),eV=t(78867);let eY=e=>{let{sessionId:s,logs:t,onBack:a}=e,[l,n]=(0,c.useState)(null),[i,o]=(0,c.useState)({}),d=t.reduce((e,s)=>e+(s.spend||0),0),x=t.reduce((e,s)=>e+(s.total_tokens||0),0),u=t.reduce((e,s)=>{var t,a;return e+((null===(a=s.metadata)||void 0===a?void 0:null===(t=a.additional_usage_values)||void 0===t?void 0:t.cache_read_input_tokens)||0)},0),h=t.reduce((e,s)=>{var t,a;return e+((null===(a=s.metadata)||void 0===a?void 0:null===(t=a.additional_usage_values)||void 0===t?void 0:t.cache_creation_input_tokens)||0)},0),g=x+u+h,p=t.length>0?new Date(t[0].startTime):new Date;(((t.length>0?new Date(t[t.length-1].endTime):new Date).getTime()-p.getTime())/1e3).toFixed(2),t.map(e=>({time:new Date(e.startTime).toISOString(),tokens:e.total_tokens||0,cost:e.spend||0}));let j=async(e,s)=>{await (0,E.vQ)(e)&&(o(e=>({...e,[s]:!0})),setTimeout(()=>{o(e=>({...e,[s]:!1}))},2e3))};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)(ex.Z,{icon:eF.Z,variant:"light",onClick:a,className:"mb-4",children:"Back to All Logs"}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Session Details"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 font-mono",children:s}),(0,r.jsx)(I.ZP,{type:"text",size:"small",icon:i["session-id"]?(0,r.jsx)(eB.Z,{size:12}):(0,r.jsx)(eV.Z,{size:12}),onClick:()=>j(s,"session-id"),className:"left-2 z-10 transition-all duration-200 ".concat(i["session-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]}),(0,r.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/ui_logs_sessions",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:["Get started with session management here",(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)(eK.Z,{children:[(0,r.jsx)(ea.Z,{children:"Total Requests"}),(0,r.jsx)(eH.Z,{children:t.length})]}),(0,r.jsxs)(eK.Z,{children:[(0,r.jsx)(ea.Z,{children:"Total Cost"}),(0,r.jsxs)(eH.Z,{children:["$",(0,E.pw)(d,6)]})]}),(0,r.jsx)(m.Z,{title:(0,r.jsxs)("div",{className:"text-white min-w-[200px]",children:[(0,r.jsx)("div",{className:"text-lg font-medium mb-3",children:"Usage breakdown"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-base font-medium mb-2",children:"Input usage:"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-300",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"input:"}),(0,r.jsx)("span",{className:"ml-8",children:(0,E.pw)(t.reduce((e,s)=>e+(s.prompt_tokens||0),0))})]}),u>0&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"input_cached_tokens:"}),(0,r.jsx)("span",{className:"ml-8",children:(0,E.pw)(u)})]}),h>0&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"input_cache_creation_tokens:"}),(0,r.jsx)("span",{className:"ml-8",children:(0,E.pw)(h)})]})]})]}),(0,r.jsxs)("div",{className:"border-t border-gray-600 pt-3",children:[(0,r.jsx)("div",{className:"text-base font-medium mb-2",children:"Output usage:"}),(0,r.jsx)("div",{className:"space-y-2 text-sm text-gray-300",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"output:"}),(0,r.jsx)("span",{className:"ml-8",children:(0,E.pw)(t.reduce((e,s)=>e+(s.completion_tokens||0),0))})]})})]}),(0,r.jsx)("div",{className:"border-t border-gray-600 pt-3",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-base font-medium",children:"Total usage:"}),(0,r.jsx)("span",{className:"text-sm text-gray-300",children:(0,E.pw)(g)})]})})]})]}),placement:"top",overlayStyle:{minWidth:"300px"},children:(0,r.jsxs)(eK.Z,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(ea.Z,{children:"Total Tokens"}),(0,r.jsx)("span",{className:"text-gray-400 text-sm",children:"ⓘ"})]}),(0,r.jsx)(eH.Z,{children:(0,E.pw)(g)})]})})]}),(0,r.jsx)(eq.Z,{children:"Session Logs"}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(em.w,{columns:ej,data:t,renderSubComponent:sn,getRowCanExpand:()=>!0,loadingMessage:"Loading logs...",noDataMessage:"No logs found"})})]})};var eU=t(21770),eW=t(90246),eG=t(80443);(a||(a={})).GENERAL_SETTINGS="general_settings",(l||(l={})).MAXIMUM_SPEND_LOGS_RETENTION_PERIOD="maximum_spend_logs_retention_period";let eJ=async(e,s)=>{try{let t=ed.proxyBaseUrl?"".concat(ed.proxyBaseUrl,"/config/list?config_type=").concat(s):"/config/list?config_type=".concat(s),a=await fetch(t,{method:"GET",headers:{[(0,ed.getGlobalLitellmHeaderName)()]:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok){let e=await a.json(),s=(0,ed.deriveErrorMessage)(e);throw(0,ed.handleError)(s),Error(s)}return await a.json()}catch(e){throw console.error("Failed to get proxy config for ".concat(s,":"),e),e}},eQ=(0,eW.n)("proxyConfig"),e$=async(e,s)=>{try{let t=ed.proxyBaseUrl?"".concat(ed.proxyBaseUrl,"/config/field/delete"):"/config/field/delete",a=await fetch(t,{method:"POST",headers:{[(0,ed.getGlobalLitellmHeaderName)()]:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){let e=await a.json(),s=(0,ed.deriveErrorMessage)(e);throw(0,ed.handleError)(s),Error(s)}return await a.json()}catch(e){throw console.error("Failed to delete proxy config field ".concat(s.field_name,":"),e),e}},eX=e=>{let{accessToken:s}=(0,eG.Z)();return(0,i.a)({queryKey:eQ.list({filters:{configType:e}}),queryFn:async()=>await eJ(s,e),enabled:!!s})},e0=()=>{let{accessToken:e}=(0,eG.Z)();return(0,eU.D)({mutationFn:async s=>{if(!e)throw Error("Access token is required");return await e$(e,s)}})},e1=async(e,s)=>{let t=(0,ed.getProxyBaseUrl)(),a=await fetch(t?"".concat(t,"/config/update"):"/config/update",{method:"POST",headers:{[(0,ed.getGlobalLitellmHeaderName)()]:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({general_settings:{store_prompts_in_spend_logs:s.store_prompts_in_spend_logs,...s.maximum_spend_logs_retention_period&&{maximum_spend_logs_retention_period:s.maximum_spend_logs_retention_period}}})});if(!a.ok){var l;let e=await a.json().catch(()=>({}));throw Error((null==e?void 0:null===(l=e.error)||void 0===l?void 0:l.message)||(null==e?void 0:e.message)||(null==e?void 0:e.detail)||"Failed to update spend logs settings")}return await a.json()},e2=()=>{let{accessToken:e}=(0,eG.Z)();return(0,eU.D)({mutationFn:async s=>{if(!e)throw Error("Access token is required");return await e1(e,s)}})};var e4=t(91027),e5=t(85968),e3=t(5540),e6=t(10032),e7=t(22116),e8=t(57840),e9=t(58760),se=t(50337),ss=t(63709),st=t(4260),sa=e=>{var s,t;let{isVisible:n,onCancel:i,onSuccess:o}=e,[d]=e6.Z.useForm(),{mutateAsync:m,isPending:x}=e2(),{mutateAsync:u,isPending:h}=e0(),{data:g,isLoading:p,refetch:j}=eX(a.GENERAL_SETTINGS),f=e6.Z.useWatch("store_prompts_in_spend_logs",d);(0,c.useEffect)(()=>{n&&j()},[n,j]);let v=(0,c.useMemo)(()=>{var e,s;if(!g)return{store_prompts_in_spend_logs:!1,maximum_spend_logs_retention_period:void 0};let t=g.find(e=>"store_prompts_in_spend_logs"===e.field_name),a=g.find(e=>"maximum_spend_logs_retention_period"===e.field_name);return{store_prompts_in_spend_logs:null!==(e=null==t?void 0:t.field_value)&&void 0!==e&&e,maximum_spend_logs_retention_period:null!==(s=null==a?void 0:a.field_value)&&void 0!==s?s:void 0}},[g]),y=async e=>{try{let s=e.maximum_spend_logs_retention_period;if(!s||"string"==typeof s&&""===s.trim())try{await u({config_type:a.GENERAL_SETTINGS,field_name:l.MAXIMUM_SPEND_LOGS_RETENTION_PERIOD})}catch(e){console.warn("Failed to delete retention period field (may not exist):",e)}let t={store_prompts_in_spend_logs:e.store_prompts_in_spend_logs,...s&&"string"==typeof s&&""!==s.trim()&&{maximum_spend_logs_retention_period:s}};await m(t,{onSuccess:()=>{eZ.Z.success("Spend logs settings updated successfully"),j(),null==o||o()},onError:e=>{eZ.Z.fromBackend("Failed to save spend logs settings: "+(0,e5.O)(e))}})}catch(e){eZ.Z.fromBackend("Failed to save spend logs settings: "+(0,e5.O)(e))}},b=()=>{d.resetFields(),i()};return(0,r.jsx)(e7.Z,{title:(0,r.jsxs)("span",{className:"flex gap-2",children:[(0,r.jsx)(e8.default.Title,{level:5,children:"Spend Logs Settings"}),(0,r.jsx)(e4.Z,{})]}),open:n,footer:(0,r.jsxs)(e9.Z,{children:[(0,r.jsx)(I.ZP,{onClick:b,disabled:x||h||p,children:"Cancel"}),(0,r.jsx)(I.ZP,{type:"primary",loading:x||h,disabled:p,onClick:()=>d.submit(),children:x||h?"Saving...":"Save Settings"})]}),onCancel:b,children:(0,r.jsxs)(e6.Z,{form:d,layout:"horizontal",onFinish:y,initialValues:v,children:[(0,r.jsx)(e6.Z.Item,{label:"Store Prompts in Spend Logs",name:"store_prompts_in_spend_logs",tooltip:(null==g?void 0:null===(s=g.find(e=>"store_prompts_in_spend_logs"===e.field_name))||void 0===s?void 0:s.field_description)||"When enabled, prompts will be stored in spend logs for tracking and analysis purposes.",valuePropName:"checked",children:(0,r.jsx)("div",{children:p?(0,r.jsx)(se.Z.Input,{active:!0,block:!0}):(0,r.jsx)(ss.Z,{checked:null!=f&&f,onChange:e=>d.setFieldValue("store_prompts_in_spend_logs",e)})})}),(0,r.jsx)(e6.Z.Item,{label:"Maximum Spend Logs Retention Period (Optional)",name:"maximum_spend_logs_retention_period",tooltip:(null==g?void 0:null===(t=g.find(e=>"maximum_spend_logs_retention_period"===e.field_name))||void 0===t?void 0:t.field_description)||"Set the maximum retention period for spend logs (e.g., '7d' for 7 days, '30d' for 30 days). Leave empty for no limit.",children:p?(0,r.jsx)(se.Z.Input,{active:!0,block:!0}):(0,r.jsx)(st.default,{placeholder:"e.g., 7d, 30d",prefix:(0,r.jsx)(e3.Z,{})})})]},g?JSON.stringify(v):"loading")})};function sl(e){let{data:s}=e,[t,a]=(0,c.useState)(!0),[l,n]=(0,c.useState)({});if(!s||0===s.length)return null;let i=e=>new Date(1e3*e).toLocaleString(),o=(e,s)=>"".concat(((s-e)*1e3).toFixed(2),"ms"),d=(e,s)=>{let t="".concat(e,"-").concat(s);n(e=>({...e,[t]:!e[t]}))};return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-4 border-b cursor-pointer hover:bg-gray-50",onClick:()=>a(!t),children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2 text-gray-600 transition-transform ".concat(t?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Vector Store Requests"})]}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:t?"Click to collapse":"Click to expand"})]}),t&&(0,r.jsx)("div",{className:"p-4",children:s.map((e,s)=>(0,r.jsxs)("div",{className:"mb-6 last:mb-0",children:[(0,r.jsx)("div",{className:"bg-white rounded-lg border p-4 mb-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Query:"}),(0,r.jsx)("span",{className:"font-mono",children:e.query})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Vector Store ID:"}),(0,r.jsx)("span",{className:"font-mono",children:e.vector_store_id})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,r.jsx)("span",{className:"flex items-center",children:(()=>{let{logo:s,displayName:t}=(0,eu.dr)(e.custom_llm_provider);return(0,r.jsxs)(r.Fragment,{children:[s&&(0,r.jsx)("img",{src:s,alt:"".concat(t," logo"),className:"h-5 w-5 mr-2"}),t]})})()})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,r.jsx)("span",{children:i(e.start_time)})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,r.jsx)("span",{children:i(e.end_time)})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,r.jsx)("span",{children:o(e.start_time,e.end_time)})]})]})]})}),(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Search Results"}),(0,r.jsx)("div",{className:"space-y-2",children:e.vector_store_search_response.data.map((e,t)=>{let a=l["".concat(s,"-").concat(t)]||!1;return(0,r.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 cursor-pointer",onClick:()=>d(s,t),children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(a?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("span",{className:"font-medium mr-2",children:["Result ",t+1]}),(0,r.jsxs)("span",{className:"text-gray-500 text-sm",children:["Score: ",(0,r.jsx)("span",{className:"font-mono",children:e.score.toFixed(4)})]})]})]}),a&&(0,r.jsx)("div",{className:"p-3 border-t bg-white",children:e.content.map((e,s)=>(0,r.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:e.type}),(0,r.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all bg-gray-50 p-2 rounded",children:e.text})]},s))})]},t)})})]},s))})]})}function sr(e){var s,t,a;let{accessToken:l,token:o,userRole:m,userID:x,allTeams:u,premiumUser:h}=e,[g,p]=(0,c.useState)(""),[j,f]=(0,c.useState)(!1),[v,y]=(0,c.useState)(!1),[b,N]=(0,c.useState)(1),[w]=(0,c.useState)(50),_=(0,c.useRef)(null),k=(0,c.useRef)(null),S=(0,c.useRef)(null),[C,L]=(0,c.useState)(d()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),[E,D]=(0,c.useState)(d()().format("YYYY-MM-DDTHH:mm")),[K,H]=(0,c.useState)(!1),[q,F]=(0,c.useState)(!1),[B,V]=(0,c.useState)(""),[Y,U]=(0,c.useState)(""),[G,J]=(0,c.useState)(""),[Q,$]=(0,c.useState)(""),[X,ee]=(0,c.useState)(""),[es,et]=(0,c.useState)(null),[ea,el]=(0,c.useState)(null),[er,ex]=(0,c.useState)(""),[eu,eh]=(0,c.useState)(""),[eg,ep]=(0,c.useState)(m&&P.lo.includes(m)),[ef,ev]=(0,c.useState)("request logs"),[ey,eb]=(0,c.useState)(null),[ew,e_]=(0,c.useState)(null),[ek,eS]=(0,c.useState)(!1),eC=(0,n.NL)(),[eL,eE]=(0,c.useState)(()=>{let e=sessionStorage.getItem("isLiveTail");return null===e||JSON.parse(e)});(0,c.useEffect)(()=>{sessionStorage.setItem("isLiveTail",JSON.stringify(eL))},[eL]);let[eD,eM]=(0,c.useState)({value:24,unit:"hours"});(0,c.useEffect)(()=>{(async()=>{ea&&l&&et({...(await (0,ed.keyInfoV1Call)(l,ea)).info,token:ea,api_key:ea})})()},[ea,l]),(0,c.useEffect)(()=>{function e(e){_.current&&!_.current.contains(e.target)&&y(!1),k.current&&!k.current.contains(e.target)&&f(!1),S.current&&!S.current.contains(e.target)&&F(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,c.useEffect)(()=>{m&&P.lo.includes(m)&&ep(!0)},[m]);let eZ=(0,i.a)({queryKey:["logs","table",b,w,C,E,G,Q,eg?x:null,er,X],queryFn:async()=>{if(!l||!o||!m||!x)return{data:[],total:0,page:1,page_size:w,total_pages:0};let e=d()(C).utc().format("YYYY-MM-DD HH:mm:ss"),s=K?d()(E).utc().format("YYYY-MM-DD HH:mm:ss"):d()().utc().format("YYYY-MM-DD HH:mm:ss"),t=await (0,ed.uiSpendLogsCall)(l,Q||void 0,G||void 0,void 0,e,s,b,w,eg?x:void 0,eu,er,X);return await ez(t.data,e,l,eC),t.data=t.data.map(s=>{let t=eC.getQueryData(["logDetails",s.request_id,e]);return(null==t?void 0:t.messages)&&(null==t?void 0:t.response)&&(s.messages=t.messages,s.response=t.response),s}),t},enabled:!!l&&!!o&&!!m&&!!x&&"request logs"===ef,refetchInterval:!!eL&&1===b&&15e3,refetchIntervalInBackground:!0}),eI=eZ.data||{data:[],total:0,page:1,page_size:w||10,total_pages:1},{filters:eP,filteredLogs:eK,allTeams:eH,allKeyAliases:eq,handleFilterChange:eF,handleFilterReset:eB}=function(e){let{logs:s,accessToken:t,startTime:a,endTime:l,pageSize:r=eR.d,isCustomDate:n,setCurrentPage:o,userID:m,userRole:x}=e,u=(0,c.useMemo)(()=>({[eA.TEAM_ID]:"",[eA.KEY_HASH]:"",[eA.REQUEST_ID]:"",[eA.MODEL]:"",[eA.USER_ID]:"",[eA.END_USER]:"",[eA.STATUS]:"",[eA.KEY_ALIAS]:"",[eA.ERROR_CODE]:"",[eA.ERROR_MESSAGE]:""}),[]),[h,g]=(0,c.useState)(u),[p,j]=(0,c.useState)({data:[],total:0,page:1,page_size:50,total_pages:0}),f=(0,c.useRef)(0),v=(0,c.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!t)return;console.log("Filters being sent to API:",e);let i=Date.now();f.current=i;let o=d()(a).utc().format("YYYY-MM-DD HH:mm:ss"),c=n?d()(l).utc().format("YYYY-MM-DD HH:mm:ss"):d()().utc().format("YYYY-MM-DD HH:mm:ss");try{let a=await (0,ed.uiSpendLogsCall)(t,e[eA.KEY_HASH]||void 0,e[eA.TEAM_ID]||void 0,e[eA.REQUEST_ID]||void 0,o,c,s,r,e[eA.USER_ID]||void 0,e[eA.END_USER]||void 0,e[eA.STATUS]||void 0,e[eA.MODEL]||void 0,e[eA.KEY_ALIAS]||void 0,e[eA.ERROR_CODE]||void 0,e[eA.ERROR_MESSAGE]||void 0);i===f.current&&a.data&&j(a)}catch(e){console.error("Error searching users:",e)}},[t,a,l,n,r]),y=(0,c.useMemo)(()=>eT()((e,s)=>v(e,s),300),[v]);(0,c.useEffect)(()=>()=>y.cancel(),[y]);let b=(0,i.a)({queryKey:["allKeys"],queryFn:async()=>{if(!t)throw Error("Access token required");return await (0,ei.LO)(t)},enabled:!!t}).data||[],N=(0,c.useMemo)(()=>!!(h[eA.KEY_ALIAS]||h[eA.KEY_HASH]||h[eA.REQUEST_ID]||h[eA.USER_ID]||h[eA.END_USER]||h[eA.ERROR_CODE]||h[eA.ERROR_MESSAGE]),[h]),w=(0,c.useMemo)(()=>{if(!s||!s.data)return{data:[],total:0,page:1,page_size:50,total_pages:0};if(N)return s;let e=[...s.data];return h[eA.TEAM_ID]&&(e=e.filter(e=>e.team_id===h[eA.TEAM_ID])),h[eA.STATUS]&&(e=e.filter(e=>"success"===h[eA.STATUS]?!e.status||"success"===e.status:e.status===h[eA.STATUS])),h[eA.MODEL]&&(e=e.filter(e=>e.model===h[eA.MODEL])),h[eA.KEY_HASH]&&(e=e.filter(e=>e.api_key===h[eA.KEY_HASH])),h[eA.END_USER]&&(e=e.filter(e=>e.end_user===h[eA.END_USER])),h[eA.ERROR_CODE]&&(e=e.filter(e=>{let s=(e.metadata||{}).error_information;return s&&s.error_code===h[eA.ERROR_CODE]})),{data:e,total:s.total,page:s.page,page_size:s.page_size,total_pages:s.total_pages}},[s,h,N]),_=(0,c.useMemo)(()=>N?p&&p.data&&p.data.length>0?p:s||{data:[],total:0,page:1,page_size:50,total_pages:0}:w,[N,p,w,s]),{data:k}=(0,i.a)({queryKey:["allTeamsForLogFilters",t],queryFn:async()=>t&&await (0,ei.IE)(t)||[],enabled:!!t});return{filters:h,filteredLogs:_,allKeyAliases:b,allTeams:k,handleFilterChange:e=>{g(s=>{let t={...s,...e};for(let e of Object.keys(u))e in t||(t[e]=u[e]);return JSON.stringify(t)!==JSON.stringify(s)&&(o(1),y(t,1)),t})},handleFilterReset:()=>{g(u),j({data:[],total:0,page:1,page_size:50,total_pages:0}),y(u,1)}}}({logs:eI,accessToken:l,startTime:C,endTime:E,pageSize:w,isCustomDate:K,setCurrentPage:N,userID:x,userRole:m}),eV=(0,c.useCallback)(async e=>{if(l)try{let s=(await (0,ed.keyListCall)(l,null,null,e,null,null,b,w)).keys.find(s=>s.key_alias===e);s&&$(s.token)}catch(e){console.error("Error fetching key hash for alias:",e)}},[l,b,w]);(0,c.useEffect)(()=>{l&&(eP["Team ID"]?J(eP["Team ID"]):J(""),ex(eP.Status||""),ee(eP.Model||""),eh(eP["End User"]||""),eP["Key Hash"]?$(eP["Key Hash"]):eP["Key Alias"]?eV(eP["Key Alias"]):$(""))},[eP,l,eV]);let eU=(0,i.a)({queryKey:["sessionLogs",ew],queryFn:async()=>{if(!l||!ew)return{data:[],total:0,page:1,page_size:50,total_pages:1};let e=await (0,ed.sessionSpendLogsCall)(l,ew);return{data:e.data||e||[],total:(e.data||e||[]).length,page:1,page_size:1e3,total_pages:1}},enabled:!!l&&!!ew});if((0,c.useEffect)(()=>{var e;(null===(e=eZ.data)||void 0===e?void 0:e.data)&&ey&&!eZ.data.data.some(e=>e.request_id===ey)&&eb(null)},[null===(s=eZ.data)||void 0===s?void 0:s.data,ey]),!l||!o||!m||!x)return null;let eW=eK.data.filter(e=>!g||e.request_id.includes(g)||e.model.includes(g)||e.user&&e.user.includes(g)).map(e=>({...e,duration:(Date.parse(e.endTime)-Date.parse(e.startTime))/1e3,onKeyHashClick:e=>el(e),onSessionClick:e=>{e&&e_(e)}}))||[],eG=(null===(a=eU.data)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.map(e=>({...e,onKeyHashClick:e=>el(e),onSessionClick:e=>{}})))||[],eJ=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=new Set;return e.forEach(e=>{let a=e.metadata||{};if("failure"===a.status&&a.error_information){let e=a.error_information.error_code;e&&(!s||e.toLowerCase().includes(s.toLowerCase()))&&t.add(e)}}),Array.from(t).map(e=>({label:e,value:e}))},eQ=[{name:"Team ID",label:"Team ID",isSearchable:!0,searchFn:async e=>u&&0!==u.length?u.filter(s=>s.team_id.toLowerCase().includes(e.toLowerCase())||s.team_alias&&s.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:"".concat(e.team_alias||e.team_id," (").concat(e.team_id,")"),value:e.team_id})):[]},{name:"Status",label:"Status",isSearchable:!1,options:[{label:"Success",value:"success"},{label:"Failure",value:"failure"}]},{name:"Model",label:"Model",isSearchable:!1},{name:"Key Alias",label:"Key Alias",isSearchable:!0,searchFn:async e=>l?(await (0,ei.LO)(l)).filter(s=>s.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e})):[]},{name:"End User",label:"End User",isSearchable:!0,searchFn:async e=>{if(!l)return[];let s=await (0,ed.allEndUsersCall)(l);return((null==s?void 0:s.map(e=>e.user_id))||[]).filter(s=>s.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e}))}},{name:"Error Code",label:"Error Code",isSearchable:!0,searchFn:async e=>eJ(eI.data,e)},{name:"Key Hash",label:"Key Hash",isSearchable:!1},{name:"Error Message",label:"Error Message",isSearchable:!1}];if(ew&&eU.data)return(0,r.jsx)("div",{className:"w-full p-6",children:(0,r.jsx)(eY,{sessionId:ew,logs:eU.data.data,onBack:()=>e_(null)})});let e$=[{label:"Last 15 Minutes",value:15,unit:"minutes"},{label:"Last Hour",value:1,unit:"hours"},{label:"Last 4 Hours",value:4,unit:"hours"},{label:"Last 24 Hours",value:24,unit:"hours"},{label:"Last 7 Days",value:7,unit:"days"}],eX=e$.find(e=>e.value===eD.value&&e.unit===eD.unit),e0=K?eO(K,C,E):null==eX?void 0:eX.label;return(0,r.jsx)("div",{className:"w-full max-w-screen p-6 overflow-x-hidden box-border",children:(0,r.jsxs)(A.Z,{defaultIndex:0,onIndexChange:e=>ev(0===e?"request logs":"audit logs"),children:[(0,r.jsxs)(O.Z,{children:[(0,r.jsx)(R.Z,{children:"Request Logs"}),(0,r.jsx)(R.Z,{children:"Audit Logs"}),(0,r.jsx)(R.Z,{children:"Deleted Keys"}),(0,r.jsx)(R.Z,{children:"Deleted Teams"})]}),(0,r.jsxs)(Z.Z,{children:[(0,r.jsxs)(z.Z,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold",children:ew?(0,r.jsxs)(r.Fragment,{children:["Session: ",(0,r.jsx)("span",{className:"font-mono",children:ew}),(0,r.jsx)("button",{className:"ml-4 px-3 py-1 text-sm border rounded hover:bg-gray-50",onClick:()=>e_(null),children:"← Back to All Logs"})]}):"Request Logs"}),!ew&&(0,r.jsx)(e4.Z,{dot:!0,children:(0,r.jsx)(I.ZP,{icon:(0,r.jsx)(M.Z,{}),onClick:()=>eS(!0),title:"Spend Logs Settings"})})]}),es&&ea&&es.api_key===ea?(0,r.jsx)(ec.Z,{keyId:ea,keyData:es,teams:u,onClose:()=>el(null),backButtonText:"Back to Logs"}):ew?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,r.jsx)(em.w,{columns:ej,data:eG,renderSubComponent:e=>{let{row:s}=e;return(0,r.jsx)(sn,{row:s,onOpenSettings:()=>eS(!0)})},getRowCanExpand:()=>!0})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eo.Z,{options:eQ,onApplyFilters:eF,onResetFilters:eB}),(0,r.jsx)(sa,{isVisible:ek,onCancel:()=>eS(!1),onSuccess:()=>eS(!1)}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full box-border",children:[(0,r.jsx)("div",{className:"border-b px-6 py-4 w-full max-w-full box-border",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0 w-full max-w-full box-border",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3 w-full max-w-full box-border",children:[(0,r.jsxs)("div",{className:"relative w-64 min-w-0 flex-shrink-0",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by Request ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:g,onChange:e=>p(e.target.value)}),(0,r.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-shrink",children:[(0,r.jsxs)("div",{className:"relative z-50",ref:S,children:[(0,r.jsxs)("button",{onClick:()=>F(!q),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e0]}),q&&(0,r.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border p-2 z-50",children:(0,r.jsxs)("div",{className:"space-y-1",children:[e$.map(e=>(0,r.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(e0===e.label?"bg-blue-50 text-blue-600":""),onClick:()=>{D(d()().format("YYYY-MM-DDTHH:mm")),L(d()().subtract(e.value,e.unit).format("YYYY-MM-DDTHH:mm")),eM({value:e.value,unit:e.unit}),H(!1),F(!1)},children:e.label},e.label)),(0,r.jsx)("div",{className:"border-t my-2"}),(0,r.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(K?"bg-blue-50 text-blue-600":""),onClick:()=>H(!K),children:"Custom Range"})]})})]}),(0,r.jsx)(()=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Live Tail"}),(0,r.jsx)(T.Z,{color:"green",checked:eL,defaultChecked:!0,onChange:eE})]}),{}),(0,r.jsxs)("button",{onClick:()=>{eZ.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,r.jsx)("svg",{className:"w-4 h-4 ".concat(eZ.isFetching?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,r.jsx)("span",{children:"Refresh"})]})]}),K&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"datetime-local",value:C,onChange:e=>{L(e.target.value),N(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,r.jsx)("span",{className:"text-gray-500",children:"to"}),(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"datetime-local",value:E,onChange:e=>{D(e.target.value),N(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-700 whitespace-nowrap",children:["Showing ",eZ.isLoading?"...":eK?(b-1)*w+1:0," -"," ",eZ.isLoading?"...":eK?Math.min(b*w,eK.total):0," ","of ",eZ.isLoading?"...":eK?eK.total:0," results"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-700 min-w-[90px]",children:["Page ",eZ.isLoading?"...":b," of"," ",eZ.isLoading?"...":eK?eK.total_pages:1]}),(0,r.jsx)("button",{onClick:()=>N(e=>Math.max(1,e-1)),disabled:eZ.isLoading||1===b,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,r.jsx)("button",{onClick:()=>N(e=>Math.min(eK.total_pages||1,e+1)),disabled:eZ.isLoading||b===(eK.total_pages||1),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}),eL&&1===b&&(0,r.jsxs)("div",{className:"mb-4 px-4 py-2 bg-green-50 border border-greem-200 rounded-md flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("span",{className:"text-sm text-green-700",children:"Auto-refreshing every 15 seconds"})}),(0,r.jsx)("button",{onClick:()=>eE(!1),className:"text-sm text-green-600 hover:text-green-800",children:"Stop"})]}),(0,r.jsx)(em.w,{columns:ej,data:eW,renderSubComponent:e=>{let{row:s}=e;return(0,r.jsx)(sn,{row:s,onOpenSettings:()=>eS(!0)})},getRowCanExpand:()=>!0})]})]})]}),(0,r.jsx)(z.Z,{children:(0,r.jsx)(eN,{userID:x,userRole:m,token:o,accessToken:l,isActive:"audit logs"===ef,premiumUser:h,allTeams:u})}),(0,r.jsx)(z.Z,{children:(0,r.jsx)(W,{})}),(0,r.jsx)(z.Z,{children:(0,r.jsx)(en,{})})]})]})})}function sn(e){var s,t,a,l,n,i,o,d,c,x,u,h;let{row:g,onOpenSettings:p}=e,j=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},f=g.original.metadata||{},v="failure"===f.status,y=v?f.error_information:null,b=g.original.messages&&(Array.isArray(g.original.messages)?g.original.messages.length>0:Object.keys(g.original.messages).length>0),N=g.original.response&&Object.keys(j(g.original.response)).length>0,w=!!g.original.proxy_server_request&&Object.keys(j(g.original.proxy_server_request)).length>0,_=N||v,k=!b&&!N&&!w,S=f.vector_store_request_metadata&&Array.isArray(f.vector_store_request_metadata)&&f.vector_store_request_metadata.length>0,C=null===(s=g.original.metadata)||void 0===s?void 0:s.guardrail_information,M=Array.isArray(C)?C:C?[C]:[],T=M.length>0,R=M.reduce((e,s)=>{let t=null==s?void 0:s.masked_entity_count;return t?e+Object.values(t).reduce((e,s)=>"number"==typeof s?e+s:e,0):e},0),A=1===M.length?null!==(h=null===(t=M[0])||void 0===t?void 0:t.guardrail_name)&&void 0!==h?h:"-":M.length>1?"".concat(M.length," guardrails"):"-",O=(0,D.aS)(g.original.request_id,64);return(0,r.jsxs)("div",{className:"p-6 bg-gray-50 space-y-6 w-full max-w-full overflow-hidden box-border",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden",children:[(0,r.jsx)("div",{className:"p-4 border-b",children:(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Request Details"})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 w-full max-w-full overflow-hidden",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Request ID:"}),g.original.request_id.length>64?(0,r.jsx)(m.Z,{title:g.original.request_id,children:(0,r.jsx)("span",{className:"font-mono text-sm",children:O})}):(0,r.jsx)("span",{className:"font-mono text-sm",children:g.original.request_id})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Model:"}),(0,r.jsx)("span",{children:g.original.model})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Model ID:"}),(0,r.jsx)("span",{children:g.original.model_id})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Call Type:"}),(0,r.jsx)("span",{children:g.original.call_type})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,r.jsx)("span",{children:g.original.custom_llm_provider||"-"})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"API Base:"}),(0,r.jsx)(m.Z,{title:g.original.api_base||"-",children:(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:g.original.api_base||"-"})})]}),(null==g?void 0:null===(a=g.original)||void 0===a?void 0:a.requester_ip_address)&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"IP Address:"}),(0,r.jsx)("span",{children:null==g?void 0:null===(l=g.original)||void 0===l?void 0:l.requester_ip_address})]}),T&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail:"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-mono",children:A}),R>0&&(0,r.jsxs)("span",{className:"ml-2 px-2 py-0.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[R," masked"]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Tokens:"}),(0,r.jsxs)("span",{children:[g.original.total_tokens," (",g.original.prompt_tokens," prompt tokens +"," ",g.original.completion_tokens," completion tokens)"]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Cache Read Tokens:"}),(0,r.jsx)("span",{children:(0,E.pw)((null===(i=g.original.metadata)||void 0===i?void 0:null===(n=i.additional_usage_values)||void 0===n?void 0:n.cache_read_input_tokens)||0)})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Cache Creation Tokens:"}),(0,r.jsx)("span",{children:(0,E.pw)(null===(o=g.original.metadata)||void 0===o?void 0:o.additional_usage_values.cache_creation_input_tokens)})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Cost:"}),(0,r.jsxs)("span",{children:["$",(0,E.pw)(g.original.spend||0,6)]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Cache Hit:"}),(0,r.jsx)("span",{children:g.original.cache_hit})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat("failure"!==((null===(d=g.original.metadata)||void 0===d?void 0:d.status)||"Success").toLowerCase()?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"failure"!==((null===(c=g.original.metadata)||void 0===c?void 0:c.status)||"Success").toLowerCase()?"Success":"Failure"})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,r.jsx)("span",{children:g.original.startTime})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,r.jsx)("span",{children:g.original.endTime})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,r.jsxs)("span",{children:[g.original.duration," s."]})]}),(null===(x=g.original.metadata)||void 0===x?void 0:x.litellm_overhead_time_ms)!==void 0&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"font-medium w-1/3",children:"LiteLLM Overhead:"}),(0,r.jsxs)("span",{children:[g.original.metadata.litellm_overhead_time_ms," ms"]})]})]})]})]}),(0,r.jsx)(eE,{costBreakdown:null===(u=g.original.metadata)||void 0===u?void 0:u.cost_breakdown,totalSpend:g.original.spend||0}),(0,r.jsx)(ew,{show:k,onOpenSettings:p}),(0,r.jsx)("div",{className:"w-full max-w-full overflow-hidden",children:(0,r.jsx)(eP,{row:g,hasClientRequest:w||b,hasModelRequest:b,hasClientResponse:_,hasError:v,errorInfo:y,getClientRequest:()=>{var e;return(null===(e=g.original)||void 0===e?void 0:e.proxy_server_request)?j(g.original.proxy_server_request):j(g.original.messages)},getModelRequest:()=>j(g.original.messages),formattedResponse:()=>v&&y?{error:{message:y.error_message||"An error occurred",type:y.error_class||"error",code:y.error_code||"unknown",param:null}}:j(g.original.response)})}),T&&(0,r.jsx)(L,{data:C}),S&&(0,r.jsx)(sl,{data:f.vector_store_request_metadata}),v&&y&&(0,r.jsx)(eD,{errorInfo:y}),g.original.request_tags&&Object.keys(g.original.request_tags).length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"flex justify-between items-center p-4 border-b",children:(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Request Tags"})}),(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(g.original.request_tags).map(e=>{let[s,t]=e;return(0,r.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[s,": ",String(t)]},s)})})})]}),g.original.metadata&&Object.keys(g.original.metadata).length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Metadata"}),(0,r.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(g.original.metadata,null,2))},className:"p-1 hover:bg-gray-200 rounded",title:"Copy metadata",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,r.jsx)("div",{className:"p-4 overflow-auto max-h-64",children:(0,r.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(g.original.metadata,null,2)})})]})]})}}}]);