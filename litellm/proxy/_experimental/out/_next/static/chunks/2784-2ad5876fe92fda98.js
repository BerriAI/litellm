"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2784],{91027:function(e,t,s){s.d(t,{Z:function(){return d}});var l=s(57437),a=s(33866),n=s(2265),r=s(9245);function i(e){let t=t=>{"disableShowNewBadge"===t.key&&e()},s=t=>{let{key:s}=t.detail;"disableShowNewBadge"===s&&e()};return window.addEventListener("storage",t),window.addEventListener(r.Qg,s),()=>{window.removeEventListener("storage",t),window.removeEventListener(r.Qg,s)}}function o(){return"true"===(0,r.le)("disableShowNewBadge")}function d(e){let{children:t,dot:s=!1}=e;return(0,n.useSyncExternalStore)(i,o)?t?(0,l.jsx)(l.Fragment,{children:t}):null:t?(0,l.jsx)(a.Z,{color:"blue",count:s?void 0:"New",dot:s,children:t}):(0,l.jsx)(a.Z,{color:"blue",count:s?void 0:"New",dot:s})}},12363:function(e,t,s){s.d(t,{d:function(){return n},n:function(){return a}});var l=s(2265);let a=()=>{let[e,t]=(0,l.useState)("http://localhost:4000");return(0,l.useEffect)(()=>{{let{protocol:e,host:s}=window.location;t("".concat(e,"//").concat(s))}},[]),e},n=25},30841:function(e,t,s){s.d(t,{IE:function(){return n},LO:function(){return a},cT:function(){return r}});var l=s(19250);let a=async e=>{if(!e)return[];try{let{aliases:t}=await (0,l.keyAliasesCall)(e);return Array.from(new Set((t||[]).filter(Boolean)))}catch(e){return console.error("Error fetching all key aliases:",e),[]}},n=async(e,t)=>{if(!e)return[];try{let s=[],a=1,n=!0;for(;n;){let r=await (0,l.teamListCall)(e,t||null,null);s=[...s,...r],a<r.total_pages?a++:n=!1}return s}catch(e){return console.error("Error fetching all teams:",e),[]}},r=async e=>{if(!e)return[];try{let t=[],s=1,a=!0;for(;a;){let n=await (0,l.organizationListCall)(e);t=[...t,...n],s<n.total_pages?s++:a=!1}return t}catch(e){return console.error("Error fetching all organizations:",e),[]}}},23048:function(e,t,s){var l=s(57437),a=s(2356),n=s(5545),r=s(37592),i=s(4260),o=s(7310),d=s.n(o),c=s(2265);t.Z=e=>{let{options:t,onApplyFilters:s,onResetFilters:o,initialValues:u={},buttonLabel:m="Filters"}=e,[x,h]=(0,c.useState)(!1),[p,g]=(0,c.useState)(u),[f,j]=(0,c.useState)({}),[y,v]=(0,c.useState)({}),[b,N]=(0,c.useState)({}),[_,w]=(0,c.useState)({}),S=(0,c.useCallback)(d()(async(e,t)=>{if(t.isSearchable&&t.searchFn){v(e=>({...e,[t.name]:!0}));try{let s=await t.searchFn(e);j(e=>({...e,[t.name]:s}))}catch(e){console.error("Error searching:",e),j(e=>({...e,[t.name]:[]}))}finally{v(e=>({...e,[t.name]:!1}))}}},300),[]),k=(0,c.useCallback)(async e=>{if(e.isSearchable&&e.searchFn&&!_[e.name]){v(t=>({...t,[e.name]:!0})),w(t=>({...t,[e.name]:!0}));try{let t=await e.searchFn("");j(s=>({...s,[e.name]:t}))}catch(t){console.error("Error loading initial options:",t),j(t=>({...t,[e.name]:[]}))}finally{v(t=>({...t,[e.name]:!1}))}}},[_]);(0,c.useEffect)(()=>{x&&t.forEach(e=>{e.isSearchable&&!_[e.name]&&k(e)})},[x,t,k,_]);let C=(e,t)=>{let l={...p,[e]:t};g(l),s(l)},L=(e,t)=>{e&&t.isSearchable&&!_[t.name]&&k(t)};return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,l.jsx)(n.ZP,{icon:(0,l.jsx)(a.Z,{className:"h-4 w-4"}),onClick:()=>h(!x),className:"flex items-center gap-2",children:m}),(0,l.jsx)(n.ZP,{onClick:()=>{let e={};t.forEach(t=>{e[t.name]=""}),g(e),o()},children:"Reset Filters"})]}),x&&(0,l.jsx)("div",{className:"grid grid-cols-3 gap-x-6 gap-y-4 mb-6",children:["Team ID","Status","Organization ID","Key Alias","User ID","End User","Error Code","Error Message","Key Hash","Model"].map(e=>{let s=t.find(t=>t.label===e||t.name===e);return s?(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:s.label||s.name}),s.isSearchable?(0,l.jsx)(r.default,{showSearch:!0,className:"w-full",placeholder:"Search ".concat(s.label||s.name,"..."),value:p[s.name]||void 0,onChange:e=>C(s.name,e),onOpenChange:e=>L(e,s),onSearch:e=>{N(t=>({...t,[s.name]:e})),s.searchFn&&S(e,s)},filterOption:!1,loading:y[s.name],options:f[s.name]||[],allowClear:!0,notFoundContent:y[s.name]?"Loading...":"No results found"}):s.options?(0,l.jsx)(r.default,{className:"w-full",placeholder:"Select ".concat(s.label||s.name,"..."),value:p[s.name]||void 0,onChange:e=>C(s.name,e),allowClear:!0,children:s.options.map(e=>(0,l.jsx)(r.default.Option,{value:e.value,children:e.label},e.value))}):s.customComponent?(()=>{let e=s.customComponent;return(0,l.jsx)(e,{value:p[s.name]||void 0,onChange:e=>C(s.name,null!=e?e:""),placeholder:"Select ".concat(s.label||s.name,"...")})})():(0,l.jsx)(i.default,{className:"w-full",placeholder:"Enter ".concat(s.label||s.name,"..."),value:p[s.name]||"",onChange:e=>C(s.name,e.target.value),allowClear:!0})]},s.name):null})})]})}},82784:function(e,t,s){s.d(t,{Z:function(){return s_}});var l,a,n=s(57437),r=s(29827),i=s(71632),o=s(45345),d=s(77398),c=s.n(d),u=s(2265),m=s(99981),x=s(44851);let h=e=>e>=.8?"text-green-600":"text-yellow-600";var p=e=>{let{entities:t}=e,[s,l]=(0,u.useState)(!0),[a,r]=(0,u.useState)({}),i=e=>{r(t=>({...t,[e]:!t[e]}))};return t&&0!==t.length?(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsxs)("div",{className:"flex items-center mb-2 cursor-pointer",onClick:()=>l(!s),children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(s?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsxs)("h4",{className:"font-medium",children:["Detected Entities (",t.length,")"]})]}),s&&(0,n.jsx)("div",{className:"space-y-2",children:t.map((e,t)=>{let s=a[t]||!1;return(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>i(t),children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(s?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsx)("span",{className:"font-medium mr-2",children:e.entity_type}),(0,n.jsxs)("span",{className:"font-mono ".concat(h(e.score)),children:["Score: ",e.score.toFixed(2)]})]}),(0,n.jsxs)("span",{className:"text-xs text-gray-500",children:["Position: ",e.start,"-",e.end]})]}),s&&(0,n.jsx)("div",{className:"p-3 border-t bg-white",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Entity Type:"}),(0,n.jsx)("span",{children:e.entity_type})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Position:"}),(0,n.jsxs)("span",{children:["Characters ",e.start,"-",e.end]})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Confidence:"}),(0,n.jsx)("span",{className:h(e.score),children:e.score.toFixed(2)})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[e.recognition_metadata&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Recognizer:"}),(0,n.jsx)("span",{children:e.recognition_metadata.recognizer_name})]}),(0,n.jsxs)("div",{className:"flex overflow-hidden",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Identifier:"}),(0,n.jsx)("span",{className:"truncate text-xs font-mono",children:e.recognition_metadata.recognizer_identifier})]})]}),e.analysis_explanation&&(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Explanation:"}),(0,n.jsx)("span",{children:e.analysis_explanation})]})]})]})})]},t)})})]}):null};let g=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"slate";return(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat({green:"bg-green-100 text-green-800",red:"bg-red-100 text-red-800",blue:"bg-blue-50 text-blue-700",slate:"bg-slate-100 text-slate-800",amber:"bg-amber-100 text-amber-800"}[t]),children:e})},f=e=>e?g("detected","red"):g("not detected","slate"),j=e=>{let{title:t,count:s,defaultOpen:l=!0,right:a,children:r}=e,[i,o]=(0,u.useState)(l);return(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>o(e=>!e),children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(i?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsxs)("h5",{className:"font-medium",children:[t," ","number"==typeof s&&(0,n.jsxs)("span",{className:"text-gray-500 font-normal",children:["(",s,")"]})]})]}),(0,n.jsx)("div",{children:a})]}),i&&(0,n.jsx)("div",{className:"p-3 border-t bg-white",children:r})]})},y=e=>{let{label:t,children:s,mono:l}=e;return(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:t}),(0,n.jsx)("span",{className:l?"font-mono text-sm break-all":"",children:s})]})},v=()=>(0,n.jsx)("div",{className:"my-3 border-t"});var b=e=>{var t,s,l,a,r,i,o,d,c,u;let{response:m}=e;if(!m)return null;let x=null!==(r=null!==(a=m.outputs)&&void 0!==a?a:m.output)&&void 0!==r?r:[],h="GUARDRAIL_INTERVENED"===m.action?"red":"green",p=(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(null===(t=m.guardrailCoverage)||void 0===t?void 0:t.textCharacters)&&g("text guarded ".concat(null!==(i=m.guardrailCoverage.textCharacters.guarded)&&void 0!==i?i:0,"/").concat(null!==(o=m.guardrailCoverage.textCharacters.total)&&void 0!==o?o:0),"blue"),(null===(s=m.guardrailCoverage)||void 0===s?void 0:s.images)&&g("images guarded ".concat(null!==(d=m.guardrailCoverage.images.guarded)&&void 0!==d?d:0,"/").concat(null!==(c=m.guardrailCoverage.images.total)&&void 0!==c?c:0),"blue")]}),b=m.usage&&(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(m.usage).map(e=>{let[t,s]=e;return"number"==typeof s?(0,n.jsxs)("span",{className:"px-2 py-1 bg-slate-100 text-slate-800 rounded-md text-xs font-medium",children:[t,": ",s]},t):null})});return(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(y,{label:"Action:",children:g(null!==(u=m.action)&&void 0!==u?u:"N/A",h)}),m.actionReason&&(0,n.jsx)(y,{label:"Action Reason:",children:m.actionReason}),m.blockedResponse&&(0,n.jsx)(y,{label:"Blocked Response:",children:(0,n.jsx)("span",{className:"italic",children:m.blockedResponse})})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(y,{label:"Coverage:",children:p}),(0,n.jsx)(y,{label:"Usage:",children:b})]})]}),x.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v,{}),(0,n.jsx)("h4",{className:"font-medium mb-2",children:"Outputs"}),(0,n.jsx)("div",{className:"space-y-2",children:x.map((e,t)=>{var s;return(0,n.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,n.jsx)("div",{className:"text-sm whitespace-pre-wrap",children:null!==(s=e.text)&&void 0!==s?s:(0,n.jsx)("em",{children:"(non-text output)"})})},t)})})]})]}),(null===(l=m.assessments)||void 0===l?void 0:l.length)?(0,n.jsx)("div",{className:"space-y-3",children:m.assessments.map((e,t)=>{var s,l,a,r,i,o,d,c,u,m,x,h,p,v,b,N,_,w,S,k,C,L,T,E;let M=(0,n.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.wordPolicy&&g("word","slate"),e.contentPolicy&&g("content","slate"),e.topicPolicy&&g("topic","slate"),e.sensitiveInformationPolicy&&g("sensitive-info","slate"),e.contextualGroundingPolicy&&g("contextual-grounding","slate"),e.automatedReasoningPolicy&&g("automated-reasoning","slate")]});return(0,n.jsxs)(j,{title:"Assessment #".concat(t+1),defaultOpen:!0,right:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(null===(s=e.invocationMetrics)||void 0===s?void 0:s.guardrailProcessingLatency)!=null&&g("".concat(e.invocationMetrics.guardrailProcessingLatency," ms"),"amber"),M]}),children:[e.wordPolicy&&(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h6",{className:"font-medium mb-2",children:"Word Policy"}),(null!==(N=null===(l=e.wordPolicy.customWords)||void 0===l?void 0:l.length)&&void 0!==N?N:0)>0&&(0,n.jsx)(j,{title:"Custom Words",defaultOpen:!0,children:(0,n.jsx)("div",{className:"space-y-2",children:e.wordPolicy.customWords.map((e,t)=>{var s;return(0,n.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[g(null!==(s=e.action)&&void 0!==s?s:"N/A",e.detected?"red":"slate"),(0,n.jsx)("span",{className:"font-mono text-sm break-all",children:e.match})]}),f(e.detected)]},t)})})}),(null!==(_=null===(a=e.wordPolicy.managedWordLists)||void 0===a?void 0:a.length)&&void 0!==_?_:0)>0&&(0,n.jsx)(j,{title:"Managed Word Lists",defaultOpen:!1,children:(0,n.jsx)("div",{className:"space-y-2",children:e.wordPolicy.managedWordLists.map((e,t)=>{var s;return(0,n.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[g(null!==(s=e.action)&&void 0!==s?s:"N/A",e.detected?"red":"slate"),(0,n.jsx)("span",{className:"font-mono text-sm break-all",children:e.match}),e.type&&g(e.type,"slate")]}),f(e.detected)]},t)})})})]}),(null===(i=e.contentPolicy)||void 0===i?void 0:null===(r=i.filters)||void 0===r?void 0:r.length)?(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h6",{className:"font-medium mb-2",children:"Content Policy"}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full text-sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"text-left text-gray-600",children:[(0,n.jsx)("th",{className:"py-1 pr-4",children:"Type"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Action"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Detected"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Strength"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Confidence"})]})}),(0,n.jsx)("tbody",{children:e.contentPolicy.filters.map((e,t)=>{var s,l,a,r;return(0,n.jsxs)("tr",{className:"border-t",children:[(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(s=e.type)&&void 0!==s?s:"—"}),(0,n.jsx)("td",{className:"py-1 pr-4",children:g(null!==(l=e.action)&&void 0!==l?l:"—",e.detected?"red":"slate")}),(0,n.jsx)("td",{className:"py-1 pr-4",children:f(e.detected)}),(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(a=e.filterStrength)&&void 0!==a?a:"—"}),(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(r=e.confidence)&&void 0!==r?r:"—"})]},t)})})]})})]}):null,(null===(d=e.contextualGroundingPolicy)||void 0===d?void 0:null===(o=d.filters)||void 0===o?void 0:o.length)?(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h6",{className:"font-medium mb-2",children:"Contextual Grounding"}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full text-sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"text-left text-gray-600",children:[(0,n.jsx)("th",{className:"py-1 pr-4",children:"Type"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Action"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Detected"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Score"}),(0,n.jsx)("th",{className:"py-1 pr-4",children:"Threshold"})]})}),(0,n.jsx)("tbody",{children:e.contextualGroundingPolicy.filters.map((e,t)=>{var s,l,a,r;return(0,n.jsxs)("tr",{className:"border-t",children:[(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(s=e.type)&&void 0!==s?s:"—"}),(0,n.jsx)("td",{className:"py-1 pr-4",children:g(null!==(l=e.action)&&void 0!==l?l:"—",e.detected?"red":"slate")}),(0,n.jsx)("td",{className:"py-1 pr-4",children:f(e.detected)}),(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(a=e.score)&&void 0!==a?a:"—"}),(0,n.jsx)("td",{className:"py-1 pr-4",children:null!==(r=e.threshold)&&void 0!==r?r:"—"})]},t)})})]})})]}):null,e.sensitiveInformationPolicy&&(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h6",{className:"font-medium mb-2",children:"Sensitive Information"}),(null!==(w=null===(c=e.sensitiveInformationPolicy.piiEntities)||void 0===c?void 0:c.length)&&void 0!==w?w:0)>0&&(0,n.jsx)(j,{title:"PII Entities",defaultOpen:!0,children:(0,n.jsx)("div",{className:"space-y-2",children:e.sensitiveInformationPolicy.piiEntities.map((e,t)=>{var s;return(0,n.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[g(null!==(s=e.action)&&void 0!==s?s:"N/A",e.detected?"red":"slate"),e.type&&g(e.type,"slate"),(0,n.jsx)("span",{className:"font-mono text-xs break-all",children:e.match})]}),f(e.detected)]},t)})})}),(null!==(S=null===(u=e.sensitiveInformationPolicy.regexes)||void 0===u?void 0:u.length)&&void 0!==S?S:0)>0&&(0,n.jsx)(j,{title:"Custom Regexes",defaultOpen:!1,children:(0,n.jsx)("div",{className:"space-y-2",children:e.sensitiveInformationPolicy.regexes.map((e,t)=>{var s,l;return(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-2 bg-gray-50 rounded gap-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[g(null!==(s=e.action)&&void 0!==s?s:"N/A",e.detected?"red":"slate"),(0,n.jsx)("span",{className:"font-medium",children:null!==(l=e.name)&&void 0!==l?l:"regex"}),(0,n.jsx)("span",{className:"font-mono text-xs break-all",children:e.regex})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[f(e.detected),e.match&&(0,n.jsx)("span",{className:"font-mono text-xs break-all",children:e.match})]})]},t)})})})]}),(null===(x=e.topicPolicy)||void 0===x?void 0:null===(m=x.topics)||void 0===m?void 0:m.length)?(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h6",{className:"font-medium mb-2",children:"Topic Policy"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:e.topicPolicy.topics.map((e,t)=>{var s,l;return(0,n.jsx)("div",{className:"px-3 py-1.5 bg-gray-50 rounded-md text-xs",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[g(null!==(s=e.action)&&void 0!==s?s:"N/A",e.detected?"red":"slate"),(0,n.jsx)("span",{className:"font-medium",children:null!==(l=e.name)&&void 0!==l?l:"topic"}),e.type&&g(e.type,"slate"),f(e.detected)]})},t)})})]}):null,e.invocationMetrics&&(0,n.jsx)(j,{title:"Invocation Metrics",defaultOpen:!1,children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(y,{label:"Latency (ms)",children:null!==(k=e.invocationMetrics.guardrailProcessingLatency)&&void 0!==k?k:"—"}),(0,n.jsx)(y,{label:"Coverage:",children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(null===(h=e.invocationMetrics.guardrailCoverage)||void 0===h?void 0:h.textCharacters)&&g("text ".concat(null!==(C=e.invocationMetrics.guardrailCoverage.textCharacters.guarded)&&void 0!==C?C:0,"/").concat(null!==(L=e.invocationMetrics.guardrailCoverage.textCharacters.total)&&void 0!==L?L:0),"blue"),(null===(p=e.invocationMetrics.guardrailCoverage)||void 0===p?void 0:p.images)&&g("images ".concat(null!==(T=e.invocationMetrics.guardrailCoverage.images.guarded)&&void 0!==T?T:0,"/").concat(null!==(E=e.invocationMetrics.guardrailCoverage.images.total)&&void 0!==E?E:0),"blue")]})})]}),(0,n.jsx)("div",{className:"space-y-2",children:(0,n.jsx)(y,{label:"Usage:",children:(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:e.invocationMetrics.usage&&Object.entries(e.invocationMetrics.usage).map(e=>{let[t,s]=e;return"number"==typeof s?(0,n.jsxs)("span",{className:"px-2 py-1 bg-slate-100 text-slate-800 rounded-md text-xs font-medium",children:[t,": ",s]},t):null})})})})]})}),(null===(b=e.automatedReasoningPolicy)||void 0===b?void 0:null===(v=b.findings)||void 0===v?void 0:v.length)?(0,n.jsx)(j,{title:"Automated Reasoning Findings",defaultOpen:!1,children:(0,n.jsx)("div",{className:"space-y-2",children:e.automatedReasoningPolicy.findings.map((e,t)=>(0,n.jsx)("pre",{className:"bg-gray-50 rounded p-2 text-xs overflow-x-auto",children:JSON.stringify(e,null,2)},t))})}):null]},t)})}):null,(0,n.jsx)(j,{title:"Raw Bedrock Guardrail Response",defaultOpen:!1,children:(0,n.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(m,null,2)})})]})};let N=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"slate";return(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat({green:"bg-green-100 text-green-800",red:"bg-red-100 text-red-800",blue:"bg-blue-50 text-blue-700",slate:"bg-slate-100 text-slate-800",amber:"bg-amber-100 text-amber-800"}[t]),children:e})},_=e=>{let{title:t,count:s,defaultOpen:l=!0,children:a}=e,[r,i]=(0,u.useState)(l);return(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,n.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>i(e=>!e),children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(r?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsxs)("h5",{className:"font-medium",children:[t," ","number"==typeof s&&(0,n.jsxs)("span",{className:"text-gray-500 font-normal",children:["(",s,")"]})]})]})}),r&&(0,n.jsx)("div",{className:"p-3 border-t bg-white",children:a})]})},w=e=>{let{label:t,children:s,mono:l}=e;return(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:t}),(0,n.jsx)("span",{className:l?"font-mono text-sm break-all":"",children:s})]})};var S=e=>{let{response:t}=e;if(!t||"string"==typeof t)return"string"==typeof t&&t?(0,n.jsx)("div",{className:"bg-white rounded-lg border border-red-200 p-4",children:(0,n.jsxs)("div",{className:"text-red-800",children:[(0,n.jsx)("h5",{className:"font-medium mb-2",children:"Error"}),(0,n.jsx)("p",{className:"text-sm",children:t})]})}):null;let s=Array.isArray(t)?t:[];if(0===s.length)return(0,n.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,n.jsx)("div",{className:"text-gray-600 text-sm",children:"No detections found"})});let l=s.filter(e=>"pattern"===e.type),a=s.filter(e=>"blocked_word"===e.type),r=s.filter(e=>"category_keyword"===e.type),i=s.filter(e=>"BLOCK"===e.action).length,o=s.filter(e=>"MASK"===e.action).length,d=s.length;return(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(w,{label:"Total Detections:",children:(0,n.jsx)("span",{className:"font-semibold",children:d})}),(0,n.jsx)(w,{label:"Actions:",children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[i>0&&N("".concat(i," blocked"),"red"),o>0&&N("".concat(o," masked"),"blue"),0===i&&0===o&&N("passed","green")]})})]}),(0,n.jsx)("div",{className:"space-y-2",children:(0,n.jsx)(w,{label:"By Type:",children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[l.length>0&&N("".concat(l.length," patterns"),"slate"),a.length>0&&N("".concat(a.length," keywords"),"slate"),r.length>0&&N("".concat(r.length," categories"),"slate")]})})})]})}),l.length>0&&(0,n.jsx)(_,{title:"Patterns Matched",count:l.length,defaultOpen:!0,children:(0,n.jsx)("div",{className:"space-y-2",children:l.map((e,t)=>(0,n.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsx)("div",{className:"space-y-1",children:(0,n.jsx)(w,{label:"Pattern:",children:e.pattern_name||"unknown"})}),(0,n.jsx)("div",{className:"space-y-1",children:(0,n.jsx)(w,{label:"Action:",children:N(e.action,"BLOCK"===e.action?"red":"blue")})})]})},t))})}),a.length>0&&(0,n.jsx)(_,{title:"Blocked Words Detected",count:a.length,defaultOpen:!0,children:(0,n.jsx)("div",{className:"space-y-2",children:a.map((e,t)=>(0,n.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(w,{label:"Keyword:",mono:!0,children:e.keyword||"unknown"}),e.description&&(0,n.jsx)(w,{label:"Description:",children:e.description})]}),(0,n.jsx)("div",{className:"space-y-1",children:(0,n.jsx)(w,{label:"Action:",children:N(e.action,"BLOCK"===e.action?"red":"blue")})})]})},t))})}),r.length>0&&(0,n.jsx)(_,{title:"Category Keywords Detected",count:r.length,defaultOpen:!0,children:(0,n.jsx)("div",{className:"space-y-2",children:r.map((e,t)=>(0,n.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(w,{label:"Category:",children:e.category||"unknown"}),(0,n.jsx)(w,{label:"Keyword:",mono:!0,children:e.keyword||"unknown"}),e.severity&&(0,n.jsx)(w,{label:"Severity:",children:N(e.severity,"high"===e.severity?"red":"medium"===e.severity?"amber":"slate")})]}),(0,n.jsx)("div",{className:"space-y-1",children:(0,n.jsx)(w,{label:"Action:",children:N(e.action,"BLOCK"===e.action?"red":"blue")})})]})},t))})}),(0,n.jsx)(_,{title:"Raw Detection Data",defaultOpen:!1,children:(0,n.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(s,null,2)})})]})};let k=e=>new Date(1e3*e).toLocaleString(),C=new Set(["presidio","bedrock","litellm_content_filter"]),L=e=>{let{response:t}=e,[s,l]=(0,u.useState)(!1);return(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,n.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>l(!s),children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(s?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsx)("h5",{className:"font-medium",children:"Raw Guardrail Response"})]})}),s&&(0,n.jsx)("div",{className:"p-3 border-t bg-white",children:(0,n.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(t,null,2)})})]})})},T=e=>{var t,s;let{entry:l,index:a,total:r}=e,i=null!==(t=l.guardrail_provider)&&void 0!==t?t:"presidio",o=null!==(s=l.guardrail_status)&&void 0!==s?s:"unknown",d="success"===o.toLowerCase(),c=l.masked_entity_count||{},u=Object.values(c).reduce((e,t)=>e+("number"==typeof t?t:0),0),x=l.guardrail_response,h=Array.isArray(x)?x:[],g="bedrock"!==i||null===x||"object"!=typeof x||Array.isArray(x)?void 0:x;return(0,n.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[r>1&&(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsxs)("h4",{className:"text-base font-semibold",children:["Guardrail #",a+1,(0,n.jsx)("span",{className:"ml-2 font-mono text-sm text-gray-600",children:l.guardrail_name})]}),(0,n.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded-md text-xs capitalize",children:i})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail Name:"}),(0,n.jsx)("span",{className:"font-mono break-words",children:l.guardrail_name})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Mode:"}),(0,n.jsx)("span",{className:"font-mono break-words",children:l.guardrail_mode})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,n.jsx)(m.Z,{title:d?null:"Guardrail failed to run.",placement:"top",arrow:!0,destroyTooltipOnHide:!0,children:(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat(d?"bg-green-100 text-green-800":"bg-red-100 text-red-800 cursor-help"),children:o})})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,n.jsx)("span",{children:k(l.start_time)})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,n.jsx)("span",{children:k(l.end_time)})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,n.jsxs)("span",{children:[l.duration.toFixed(4),"s"]})]})]})]}),u>0&&(0,n.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,n.jsx)("h5",{className:"font-medium mb-2",children:"Masked Entity Summary"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(c).map(e=>{let[t,s]=e;return(0,n.jsxs)("span",{className:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[t,": ",s]},t)})})]}),"presidio"===i&&h.length>0&&(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(p,{entities:h})}),"bedrock"===i&&g&&(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(b,{response:g})}),"litellm_content_filter"===i&&x&&(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(S,{response:x})}),i&&!C.has(i)&&x&&(0,n.jsx)(L,{response:x})]})};var E=e=>{let{data:t}=e,s=Array.isArray(t)?t.filter(e=>!!e):t?[t]:[],l=1===s.length?s[0].guardrail_name:"".concat(s.length," guardrails"),a=Array.from(new Set(s.map(e=>e.guardrail_status))).every(e=>"success"===(null!=e?e:"").toLowerCase()),r=s.reduce((e,t)=>e+Object.values(t.masked_entity_count||{}).reduce((e,t)=>e+("number"==typeof t?t:0),0),0);return 0===s.length?null:(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(x.default,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Guardrail Information"}),(0,n.jsx)(m.Z,{title:a?null:"Guardrail failed to run.",placement:"top",arrow:!0,destroyTooltipOnHide:!0,children:(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block ".concat(a?"bg-green-100 text-green-800":"bg-red-100 text-red-800 cursor-help"),children:a?"success":"failure"})}),(0,n.jsx)("span",{className:"font-mono text-sm text-gray-600",children:l}),r>0&&(0,n.jsxs)("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[r," masked ",1===r?"entity":"entities"]})]}),children:(0,n.jsx)("div",{className:"p-4 space-y-6",children:s.map((e,t)=>{var l;return(0,n.jsx)(T,{entry:e,index:t,total:s.length},"".concat(null!==(l=e.guardrail_name)&&void 0!==l?l:"guardrail","-").concat(t))})})}]})})},M=s(59872),D=s(55322),z=s(30356),Z=s(59341),I=s(12485),R=s(18135),A=s(35242),O=s(29706),P=s(77991),H=s(5545),F=s(20347),q=s(91027),B=s(30280),K=s(44633),Y=s(86462),U=s(49084),V=s(71594),G=s(24525),W=s(19130);function J(e){let{keys:t,totalCount:s,isLoading:l,isFetching:a,pageIndex:r,pageSize:i,onPageChange:o}=e,[d,c]=(0,u.useState)([{id:"deleted_at",desc:!0}]),[x,h]=(0,u.useState)({pageIndex:r,pageSize:i});u.useEffect(()=>{h({pageIndex:r,pageSize:i})},[r,i]);let p=[{id:"token",accessorKey:"token",header:"Key ID",size:150,maxSize:250,cell:e=>{let t=e.getValue();return(0,n.jsx)(m.Z,{title:t,children:(0,n.jsx)("span",{className:"font-mono text-blue-500 text-xs truncate block max-w-[250px]",children:t||"-"})})}},{id:"key_alias",accessorKey:"key_alias",header:"Key Alias",size:150,maxSize:200,cell:e=>{let t=e.getValue();return(0,n.jsx)(m.Z,{title:t,children:(0,n.jsx)("span",{className:"font-mono text-xs truncate block max-w-[200px]",children:null!=t?t:"-"})})}},{id:"team_alias",accessorKey:"team_alias",header:"Team Alias",size:120,maxSize:180,cell:e=>{let t=e.getValue();return(0,n.jsx)("span",{className:"truncate block max-w-[180px]",children:t||"-"})}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",size:100,maxSize:140,cell:e=>(0,n.jsx)("span",{className:"block max-w-[140px]",children:(0,M.pw)(e.getValue(),4)})},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",size:110,maxSize:150,cell:e=>{let t=e.getValue();return(0,n.jsx)("span",{className:"block max-w-[150px]",children:null===t?"Unlimited":"$".concat((0,M.pw)(t))})}},{id:"user_email",accessorKey:"user_email",header:"User Email",size:160,maxSize:250,cell:e=>{let t=e.getValue();return(0,n.jsx)(m.Z,{title:t,children:(0,n.jsx)("span",{className:"font-mono text-xs truncate block max-w-[250px]",children:null!=t?t:"-"})})}},{id:"user_id",accessorKey:"user_id",header:"User ID",size:120,maxSize:200,cell:e=>{let t=e.getValue();return(0,n.jsx)(m.Z,{title:t||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[200px]",children:t||"-"})})}},{id:"created_at",accessorKey:"created_at",header:"Created At",size:120,maxSize:140,cell:e=>{let t=e.getValue();return(0,n.jsx)("span",{className:"block max-w-[140px]",children:t?new Date(t).toLocaleDateString():"-"})}},{id:"created_by",accessorKey:"created_by",header:"Created By",size:120,maxSize:180,cell:e=>{let t=e.row.original.created_by;return(0,n.jsx)(m.Z,{title:t||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[180px]",children:t||"-"})})}},{id:"deleted_at",accessorKey:"deleted_at",header:"Deleted At",size:120,maxSize:140,cell:e=>{let t=e.row.original.deleted_at;return(0,n.jsx)("span",{className:"block max-w-[140px]",children:t?new Date(t).toLocaleDateString():"-"})}},{id:"deleted_by",accessorKey:"deleted_by",header:"Deleted By",size:120,maxSize:180,cell:e=>{let t=e.row.original.deleted_by;return(0,n.jsx)(m.Z,{title:t||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[180px]",children:t||"-"})})}}],g=(0,V.b7)({data:t,columns:p,columnResizeMode:"onChange",columnResizeDirection:"ltr",state:{sorting:d,pagination:x},onSortingChange:c,onPaginationChange:e=>{let t="function"==typeof e?e(x):e;h(t),o(t.pageIndex)},getCoreRowModel:(0,G.sC)(),getSortedRowModel:(0,G.tj)(),getPaginationRowModel:(0,G.G_)(),enableSorting:!0,manualSorting:!1,manualPagination:!0,pageCount:Math.ceil(s/i)}),{pageIndex:f}=g.getState().pagination,j=f*i+1,y="".concat(j," - ").concat(Math.min((f+1)*i,s));return(0,n.jsx)("div",{className:"w-full h-full overflow-hidden",children:(0,n.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between w-full mb-4",children:[l||a?(0,n.jsx)("span",{className:"inline-flex text-sm text-gray-700",children:"Loading..."}):(0,n.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",y," of ",s," results"]}),(0,n.jsxs)("div",{className:"inline-flex items-center gap-2",children:[l||a?(0,n.jsx)("span",{className:"text-sm text-gray-700",children:"Loading..."}):(0,n.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",f+1," of ",g.getPageCount()]}),(0,n.jsx)("button",{onClick:()=>g.previousPage(),disabled:l||a||!g.getCanPreviousPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,n.jsx)("button",{onClick:()=>g.nextPage(),disabled:l||a||!g.getCanNextPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),(0,n.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,n.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)(W.iA,{className:"[&_td]:py-0.5 [&_th]:py-1",style:{width:g.getCenterTotalSize()},children:[(0,n.jsx)(W.ss,{children:g.getHeaderGroups().map(e=>(0,n.jsx)(W.SC,{children:e.headers.map(e=>(0,n.jsx)(W.xs,{"data-header-id":e.id,className:"py-1 h-8 relative hover:bg-gray-50",style:{width:e.getSize(),maxWidth:e.column.columnDef.maxSize,position:"relative"},onMouseEnter:()=>{let t=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));t&&(t.style.opacity="0.5")},onMouseLeave:()=>{let t=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));t&&!e.column.getIsResizing()&&(t.style.opacity="0")},onClick:e.column.getToggleSortingHandler(),children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,V.ie)(e.column.columnDef.header,e.getContext())}),(0,n.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,n.jsx)(K.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,n.jsx)(Y.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,n.jsx)(U.Z,{className:"h-4 w-4 text-gray-400"})}),(0,n.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:"resizer ".concat(g.options.columnResizeDirection," ").concat(e.column.getIsResizing()?"isResizing":""),style:{position:"absolute",right:0,top:0,height:"100%",width:"5px",background:e.column.getIsResizing()?"#3b82f6":"transparent",cursor:"col-resize",userSelect:"none",touchAction:"none",opacity:e.column.getIsResizing()?1:0}})]})},e.id))},e.id))}),(0,n.jsx)(W.RM,{children:l||a?(0,n.jsx)(W.SC,{children:(0,n.jsx)(W.pj,{colSpan:p.length,className:"h-8 text-center",children:(0,n.jsx)("div",{className:"text-center text-gray-500",children:(0,n.jsx)("p",{children:"\uD83D\uDE85 Loading keys..."})})})}):t.length>0?g.getRowModel().rows.map(e=>(0,n.jsx)(W.SC,{className:"h-8",children:e.getVisibleCells().map(e=>(0,n.jsx)(W.pj,{style:{width:e.column.getSize(),maxWidth:e.column.columnDef.maxSize,whiteSpace:"pre-wrap",overflow:"hidden"},className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,V.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,n.jsx)(W.SC,{children:(0,n.jsx)(W.pj,{colSpan:p.length,className:"h-8 text-center",children:(0,n.jsx)("div",{className:"text-center text-gray-500",children:(0,n.jsx)("p",{children:"No deleted keys found"})})})})})]})})})})]})})}function $(){let[e,t]=(0,u.useState)(0),[s]=(0,u.useState)(50),{data:l,isPending:a,isFetching:r}=(0,B.Tv)(e+1,s);return(0,n.jsx)(J,{keys:(null==l?void 0:l.keys)||[],totalCount:(null==l?void 0:l.total_count)||0,isLoading:a,isFetching:r,pageIndex:e,pageSize:s,onPageChange:t})}var Q=s(47359),X=s(41649),ee=s(21626),et=s(97214),es=s(28241),el=s(58834),ea=s(69552),en=s(71876),er=s(84264),ei=s(46468);function eo(e){let{teams:t,isLoading:s,isFetching:l}=e,[a,r]=(0,u.useState)([{id:"deleted_at",desc:!0}]),i=[{id:"team_alias",accessorKey:"team_alias",header:"Team Name",size:150,maxSize:200,cell:e=>{let t=e.getValue();return(0,n.jsx)(m.Z,{title:t||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[200px]",children:t||"-"})})}},{id:"team_id",accessorKey:"team_id",header:"Team ID",size:150,maxSize:250,cell:e=>{let t=e.getValue();return(0,n.jsx)(m.Z,{title:t,children:(0,n.jsx)("span",{className:"font-mono text-blue-500 text-xs truncate block max-w-[250px]",children:t||"-"})})}},{id:"created_at",accessorKey:"created_at",header:"Created",size:120,maxSize:140,cell:e=>{let t=e.getValue();return(0,n.jsx)("span",{className:"block max-w-[140px]",children:t?new Date(t).toLocaleDateString():"-"})}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",size:100,maxSize:140,cell:e=>{let t=e.row.original.spend;return(0,n.jsx)("span",{className:"block max-w-[140px]",children:void 0!==t?(0,M.pw)(t,4):"-"})}},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",size:110,maxSize:150,cell:e=>{let t=e.getValue();return(0,n.jsx)("span",{className:"block max-w-[150px]",children:null==t?"No limit":"$".concat((0,M.pw)(t))})}},{id:"models",accessorKey:"models",header:"Models",size:200,maxSize:300,cell:e=>{let t=e.getValue();return Array.isArray(t)&&0!==t.length?(0,n.jsxs)("div",{className:"flex flex-wrap gap-1 max-w-[300px]",children:[t.slice(0,3).map((e,t)=>"all-proxy-models"===e?(0,n.jsx)(X.Z,{size:"xs",color:"red",children:(0,n.jsx)(er.Z,{children:"All Proxy Models"})},t):(0,n.jsx)(X.Z,{size:"xs",color:"blue",children:(0,n.jsx)(er.Z,{children:e.length>30?"".concat((0,ei.W0)(e).slice(0,30),"..."):(0,ei.W0)(e)})},t)),t.length>3&&(0,n.jsx)(X.Z,{size:"xs",color:"gray",children:(0,n.jsxs)(er.Z,{children:["+",t.length-3," ",t.length-3==1?"more model":"more models"]})})]}):(0,n.jsx)(X.Z,{size:"xs",color:"red",children:(0,n.jsx)(er.Z,{children:"All Proxy Models"})})}},{id:"organization_id",accessorKey:"organization_id",header:"Organization",size:150,maxSize:200,cell:e=>{let t=e.getValue();return(0,n.jsx)(m.Z,{title:t||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[200px]",children:t||"-"})})}},{id:"deleted_at",accessorKey:"deleted_at",header:"Deleted At",size:120,maxSize:140,cell:e=>{let t=e.row.original.deleted_at;return(0,n.jsx)("span",{className:"block max-w-[140px]",children:t?new Date(t).toLocaleDateString():"-"})}},{id:"deleted_by",accessorKey:"deleted_by",header:"Deleted By",size:120,maxSize:180,cell:e=>{let t=e.row.original.deleted_by;return(0,n.jsx)(m.Z,{title:t||void 0,children:(0,n.jsx)("span",{className:"truncate block max-w-[180px]",children:t||"-"})})}}],o=(0,V.b7)({data:t,columns:i,columnResizeMode:"onChange",columnResizeDirection:"ltr",state:{sorting:a},onSortingChange:r,getCoreRowModel:(0,G.sC)(),getSortedRowModel:(0,G.tj)(),enableSorting:!0,manualSorting:!1});return(0,n.jsx)("div",{className:"w-full h-full overflow-hidden",children:(0,n.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,n.jsx)("div",{className:"flex items-center justify-between w-full mb-4",children:s||l?(0,n.jsx)("span",{className:"inline-flex text-sm text-gray-700",children:"Loading..."}):(0,n.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",t.length," ",1===t.length?"team":"teams"]})}),(0,n.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,n.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)(ee.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",style:{width:o.getCenterTotalSize()},children:[(0,n.jsx)(el.Z,{children:o.getHeaderGroups().map(e=>(0,n.jsx)(en.Z,{children:e.headers.map(e=>(0,n.jsx)(ea.Z,{"data-header-id":e.id,className:"py-1 h-8 relative hover:bg-gray-50",style:{width:e.getSize(),maxWidth:e.column.columnDef.maxSize,position:"relative"},onMouseEnter:()=>{let t=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));t&&(t.style.opacity="0.5")},onMouseLeave:()=>{let t=document.querySelector('[data-header-id="'.concat(e.id,'"] .resizer'));t&&!e.column.getIsResizing()&&(t.style.opacity="0")},onClick:e.column.getToggleSortingHandler(),children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,V.ie)(e.column.columnDef.header,e.getContext())}),(0,n.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,n.jsx)(K.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,n.jsx)(Y.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,n.jsx)(U.Z,{className:"h-4 w-4 text-gray-400"})}),(0,n.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:"resizer ".concat(o.options.columnResizeDirection," ").concat(e.column.getIsResizing()?"isResizing":""),style:{position:"absolute",right:0,top:0,height:"100%",width:"5px",background:e.column.getIsResizing()?"#3b82f6":"transparent",cursor:"col-resize",userSelect:"none",touchAction:"none",opacity:e.column.getIsResizing()?1:0}})]})},e.id))},e.id))}),(0,n.jsx)(et.Z,{children:s||l?(0,n.jsx)(en.Z,{children:(0,n.jsx)(es.Z,{colSpan:i.length,className:"h-8 text-center",children:(0,n.jsx)("div",{className:"text-center text-gray-500",children:(0,n.jsx)("p",{children:"\uD83D\uDE85 Loading teams..."})})})}):t.length>0?o.getRowModel().rows.map(e=>(0,n.jsx)(en.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,n.jsx)(es.Z,{style:{width:e.column.getSize(),maxWidth:e.column.columnDef.maxSize,whiteSpace:"pre-wrap",overflow:"hidden"},className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,V.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,n.jsx)(en.Z,{children:(0,n.jsx)(es.Z,{colSpan:i.length,className:"h-8 text-center",children:(0,n.jsx)("div",{className:"text-center text-gray-500",children:(0,n.jsx)("p",{children:"No deleted teams found"})})})})})]})})})})]})})}function ed(){let{data:e,isPending:t,isFetching:s}=(0,Q.iN)(1,100);return(0,n.jsx)(eo,{teams:e||[],isLoading:t,isFetching:s})}var ec=s(30841),eu=s(52178),em=s(61935),ex=s(19616),eh=s(57840),ep=s(55590),eg=s(37592);let{Text:ef}=eh.default,ej=e=>{let{value:t,onChange:s,placeholder:l="Select a model",style:a,pageSize:r=50,allowClear:i=!0,disabled:o=!1}=e,[d,c]=(0,u.useState)(""),[m,x]=(0,ex.G)("",{wait:300}),{data:h,fetchNextPage:p,hasNextPage:g,isFetchingNextPage:f,isLoading:j}=(0,eu.QT)(r,m||void 0),y=(0,u.useMemo)(()=>{if(!(null==h?void 0:h.pages))return[];let e=new Set,t=[];for(let n of h.pages)for(let r of n.data){var s,l,a;let n=null!==(l=null===(s=r.model_info)||void 0===s?void 0:s.id)&&void 0!==l?l:"",i=null!==(a=r.model_name)&&void 0!==a?a:"";!n||e.has(n)||(e.add(n),t.push({label:i?"".concat(i," (").concat(n,")"):n,value:n,modelName:i,modelId:n}))}return t},[h]);return(0,n.jsx)(eg.default,{value:t||void 0,onChange:e=>{var t;let l="string"==typeof e?e:Array.isArray(e)&&null!==(t=e[0])&&void 0!==t?t:"";null==s||s(l)},placeholder:l,style:{width:"100%",...a},allowClear:i,disabled:o,showSearch:!0,filterOption:!1,onSearch:e=>{c(e),x(e)},searchValue:d,onPopupScroll:e=>{let t=e.currentTarget;(t.scrollTop+t.clientHeight)/t.scrollHeight>=.8&&g&&!f&&p()},loading:j,notFoundContent:j?(0,n.jsx)(em.Z,{spin:!0}):"No models found",options:y,optionRender:e=>{let{modelName:t,modelId:s}=e.data;return(0,n.jsx)(n.Fragment,{children:t?(0,n.jsxs)(ep.Z,{direction:"vertical",children:[(0,n.jsxs)(ep.Z,{direction:"horizontal",children:[(0,n.jsx)(ef,{strong:!0,children:"Model name:"}),(0,n.jsx)(ef,{ellipsis:!0,children:t})]}),(0,n.jsxs)(ef,{ellipsis:!0,type:"secondary",children:["Model ID: ",s]})]}):(0,n.jsxs)(ef,{ellipsis:!0,type:"secondary",children:["Model ID: ",s]})})},popupRender:e=>(0,n.jsxs)(n.Fragment,{children:[e,f&&(0,n.jsx)("div",{style:{textAlign:"center",padding:8},children:(0,n.jsx)(em.Z,{spin:!0})})]})})};var ey=s(23048),ev=s(19250),eb=s(50665),eN=s(60493),e_=s(78489),ew=s(42673),eS=s(47024);let ek=e=>{try{return new Date(e).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).replace(",","")}catch(e){return"Error converting time"}},eC=e=>{let{utcTime:t}=e;return(0,n.jsx)("span",{style:{fontFamily:"monospace",width:"180px",display:"inline-block"},children:ek(t)})},eL=[{label:"400 - Bad Request",value:"400"},{label:"401 - Invalid Authentication",value:"401"},{label:"403 - Permission Denied",value:"403"},{label:"404 - Not Found",value:"404"},{label:"408 - Request Timeout",value:"408"},{label:"422 - Unprocessable Entity",value:"422"},{label:"429 - Rate Limited",value:"429"},{label:"500 - Internal Server Error",value:"500"},{label:"502 - Bad Gateway",value:"502"},{label:"503 - Service Unavailable",value:"503"},{label:"529 - Overloaded",value:"529"}],eT=["call_mcp_tool","list_mcp_tools"],eE=[{label:"Last 15 Minutes",value:15,unit:"minutes"},{label:"Last Hour",value:1,unit:"hours"},{label:"Last 4 Hours",value:4,unit:"hours"},{label:"Last 24 Hours",value:24,unit:"hours"},{label:"Last 7 Days",value:7,unit:"days"}],eM=e=>{let{size:t=12}=e;return(0,n.jsx)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"flex-shrink-0 text-gray-400",children:(0,n.jsx)("path",{d:"M12 3l1.912 5.813a2 2 0 0 0 1.275 1.275L21 12l-5.813 1.912a2 2 0 0 0-1.275 1.275L12 21l-1.912-5.813a2 2 0 0 0-1.275-1.275L3 12l5.813-1.912a2 2 0 0 0 1.275-1.275L12 3z"})})},eD=e=>{let{size:t=10}=e;return(0,n.jsx)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"flex-shrink-0",children:(0,n.jsx)("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})})},ez=e=>{let{count:t}=e;return(0,n.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-50 text-blue-700 border border-blue-200 rounded-full text-[11px] font-medium whitespace-nowrap",children:[(0,n.jsx)(eM,{}),null!=t?t:"LLM"]})},eZ=e=>{let{count:t}=e;return(0,n.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-amber-50 text-amber-700 border border-amber-200 rounded-full text-[11px] font-medium whitespace-nowrap",children:[(0,n.jsx)(eD,{}),null!=t?t:"MCP"]})},eI=(e,t)=>{var s,l;return(null===(l=e.metadata)||void 0===l?void 0:null===(s=l.mcp_tool_call_metadata)||void 0===s?void 0:s.mcp_server_logo_url)?e.metadata.mcp_tool_call_metadata.mcp_server_logo_url:t?(0,ew.dr)(t).logo:""},eR=e=>{let{label:t,field:s,sortBy:l,sortOrder:a,onSortChange:r}=e;return(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("span",{children:t}),(0,n.jsx)(eS._,{sortState:l===s&&a,onSortChange:e=>{!1===e?r("startTime","desc"):r(s,e)}})]})},eA=e=>[{header:e?()=>(0,n.jsx)(eR,{label:"Time",field:"startTime",sortBy:e.sortBy,sortOrder:e.sortOrder,onSortChange:e.onSortChange}):"Time",accessorKey:"startTime",cell:e=>(0,n.jsx)(eC,{utcTime:e.getValue()})},{header:"Type",id:"type",cell:e=>{var t,s;let l=e.row.original,a=l.session_total_count||1,r=eT.includes(l.call_type),i=null!==(t=l.session_llm_count)&&void 0!==t?t:r?0:a,o=null!==(s=l.session_mcp_count)&&void 0!==s?s:r?a:0;if(r)return(0,n.jsx)(eZ,{});if(a<=1)return(0,n.jsx)(ez,{});let d=(0,n.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-50 text-blue-700 border border-blue-200 rounded-full text-[11px] font-medium whitespace-nowrap",children:[(0,n.jsx)(eM,{}),(0,n.jsx)("span",{children:a}),o>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-blue-300",children:"\xb7"}),(0,n.jsx)(eD,{})]})]});return(0,n.jsx)(m.Z,{title:"".concat(i," LLM • ").concat(o," MCP"),children:d})}},{header:"Status",accessorKey:"metadata.status",cell:e=>{let t="failure"!==(e.getValue()||"Success").toLowerCase();return(0,n.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ".concat(t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t?"Success":"Failure"})}},{header:"Session ID",accessorKey:"session_id",cell:e=>{let t=String(e.getValue()||""),s=e.row.original.onSessionClick;return(0,n.jsx)(m.Z,{title:String(e.getValue()||""),children:(0,n.jsx)(e_.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal text-xs max-w-[15ch] truncate block",onClick:()=>null==s?void 0:s(t),children:String(e.getValue()||"")})})}},{header:"Request ID",accessorKey:"request_id",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||""),children:(0,n.jsx)("span",{className:"font-mono text-xs max-w-[15ch] truncate block",children:String(e.getValue()||"")})})},{header:e?()=>(0,n.jsx)(eR,{label:"Cost",field:"spend",sortBy:e.sortBy,sortOrder:e.sortOrder,onSortChange:e.onSortChange}):"Cost",accessorKey:"spend",cell:e=>{let t=e.row.original,s=t.mcp_tool_call_count||0,l=t.mcp_tool_call_spend||0;return(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)(m.Z,{title:"$".concat(String(e.getValue()||0)),children:(0,n.jsx)("span",{children:(0,M.GS)(e.getValue()||0)})}),s>0&&l>0&&(0,n.jsxs)("span",{className:"text-[10px] text-amber-600",children:["incl. ",(0,M.GS)(l)," from ",s," MCP"]})]})}},{header:"Duration (s)",accessorKey:"duration",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Team Name",accessorKey:"metadata.user_api_key_team_alias",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Key Hash",accessorKey:"metadata.user_api_key",cell:e=>{let t=String(e.getValue()||"-"),s=e.row.original.onKeyHashClick;return(0,n.jsx)(m.Z,{title:t,children:(0,n.jsx)("span",{className:"font-mono max-w-[15ch] truncate block cursor-pointer hover:text-blue-600",onClick:()=>null==s?void 0:s(t),children:t})})}},{header:"Key Name",accessorKey:"metadata.user_api_key_alias",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Model",accessorKey:"model",cell:e=>{let t=e.row.original,s=t.custom_llm_provider,l=String(e.getValue()||"");return(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[s&&(0,n.jsx)("img",{src:eI(t,s),alt:"",className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,n.jsx)(m.Z,{title:l,children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:l})})]})}},{header:e?()=>(0,n.jsx)(eR,{label:"Tokens",field:"total_tokens",sortBy:e.sortBy,sortOrder:e.sortOrder,onSortChange:e.onSortChange}):"Tokens",accessorKey:"total_tokens",cell:e=>{let t=e.row.original;return(0,n.jsxs)("span",{className:"text-sm",children:[String(t.total_tokens||"0"),(0,n.jsxs)("span",{className:"text-gray-400 text-xs ml-1",children:["(",String(t.prompt_tokens||"0"),"+",String(t.completion_tokens||"0"),")"]})]})}},{header:"Internal User",accessorKey:"user",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"End User",accessorKey:"end_user",cell:e=>(0,n.jsx)(m.Z,{title:String(e.getValue()||"-"),children:(0,n.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Tags",accessorKey:"request_tags",cell:e=>{let t=e.getValue();if(!t||0===Object.keys(t).length)return"-";let s=Object.entries(t),l=s[0],a=s.slice(1);return(0,n.jsx)("div",{className:"flex flex-wrap gap-1",children:(0,n.jsx)(m.Z,{title:(0,n.jsx)("div",{className:"flex flex-col gap-1",children:s.map(e=>{let[t,s]=e;return(0,n.jsxs)("span",{children:[t,": ",String(s)]},t)})}),children:(0,n.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[l[0],": ",String(l[1]),a.length>0&&" +".concat(a.length)]})})})}}];eA();let eO=e=>(0,n.jsx)(X.Z,{color:"gray",className:"flex items-center gap-1",children:(0,n.jsx)("span",{className:"whitespace-nowrap text-xs",children:e})}),eP=[{id:"expander",header:()=>null,cell:e=>{let{row:t}=e;return(0,n.jsx)(()=>{let[e,s]=u.useState(t.getIsExpanded()),l=u.useCallback(()=>{s(e=>!e),t.getToggleExpandedHandler()()},[t]);return t.getCanExpand()?(0,n.jsx)("button",{onClick:l,style:{cursor:"pointer"},"aria-label":e?"Collapse row":"Expand row",className:"w-6 h-6 flex items-center justify-center focus:outline-none",children:(0,n.jsx)("svg",{className:"w-4 h-4 transform transition-transform ".concat(e?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):(0,n.jsx)("span",{className:"w-6 h-6 flex items-center justify-center",children:"●"})},{})}},{header:"Timestamp",accessorKey:"updated_at",cell:e=>(0,n.jsx)(eC,{utcTime:e.getValue()})},{header:"Table Name",accessorKey:"table_name",cell:e=>{let t=e.getValue(),s=t;switch(t){case"LiteLLM_VerificationToken":s="Keys";break;case"LiteLLM_TeamTable":s="Teams";break;case"LiteLLM_OrganizationTable":s="Organizations";break;case"LiteLLM_UserTable":s="Users";break;case"LiteLLM_ProxyModelTable":s="Models";break;default:s=t}return(0,n.jsx)("span",{children:s})}},{header:"Action",accessorKey:"action",cell:e=>(0,n.jsx)("span",{children:eO(e.getValue())})},{header:"Changed By",accessorKey:"changed_by",cell:e=>{let t=e.row.original.changed_by,s=e.row.original.changed_by_api_key;return(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("div",{className:"font-medium",children:t}),s&&(0,n.jsx)(m.Z,{title:s,children:(0,n.jsxs)("div",{className:"text-xs text-muted-foreground max-w-[15ch] truncate",children:[" ",s]})})]})}},{header:"Affected Item ID",accessorKey:"object_id",cell:e=>(0,n.jsx)(()=>{let t=e.getValue(),[s,l]=(0,u.useState)(!1);if(!t)return(0,n.jsx)(n.Fragment,{children:"-"});let a=async()=>{try{await navigator.clipboard.writeText(String(t)),l(!0),setTimeout(()=>l(!1),1500)}catch(e){console.error("Failed to copy object ID: ",e)}};return(0,n.jsx)(m.Z,{title:s?"Copied!":String(t),children:(0,n.jsx)("span",{className:"max-w-[20ch] truncate block cursor-pointer hover:text-blue-600",onClick:a,children:String(t)})})},{})}];var eH=s(92280);let eF="".concat("../ui/assets/","audit-logs-preview.png");function eq(e){let{userID:t,userRole:s,token:l,accessToken:a,isActive:r,premiumUser:o,allTeams:d}=e,[m,x]=(0,u.useState)(c()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),h=(0,u.useRef)(null),p=(0,u.useRef)(null),[g,f]=(0,u.useState)(1),[j]=(0,u.useState)(50),[y,v]=(0,u.useState)({}),[b,N]=(0,u.useState)(""),[_,w]=(0,u.useState)(""),[S,k]=(0,u.useState)(""),[C,L]=(0,u.useState)("all"),[T,E]=(0,u.useState)("all"),[D,z]=(0,u.useState)(!1),[Z,I]=(0,u.useState)(!1),R=(0,i.a)({queryKey:["all_audit_logs",a,l,s,t,m],queryFn:async()=>{if(!a||!l||!s||!t)return[];let e=c()(m).utc().format("YYYY-MM-DD HH:mm:ss"),n=c()().utc().format("YYYY-MM-DD HH:mm:ss"),r=[],i=1,o=1;do{let t=await (0,ev.uiAuditLogsCall)(a,e,n,i,50);r=r.concat(t.audit_logs),o=t.total_pages,i++}while(i<=o);return r},enabled:!!a&&!!l&&!!s&&!!t&&r,refetchInterval:5e3,refetchIntervalInBackground:!0}),A=(0,u.useCallback)(async e=>{if(a)try{let t=(await (0,ev.keyListCall)(a,null,null,e,null,null,1,10)).keys.find(t=>t.key_alias===e);t?w(t.token):w("")}catch(e){console.error("Error fetching key hash for alias:",e),w("")}},[a]);(0,u.useEffect)(()=>{if(!a)return;let e=!1,t=!1;y["Team ID"]?b!==y["Team ID"]&&(N(y["Team ID"]),e=!0):""!==b&&(N(""),e=!0),y["Key Hash"]?_!==y["Key Hash"]&&(w(y["Key Hash"]),t=!0):y["Key Alias"]?A(y["Key Alias"]):""!==_&&(w(""),t=!0),(e||t)&&f(1)},[y,a,A,b,_]),(0,u.useEffect)(()=>{f(1)},[b,_,m,S,C,T]),(0,u.useEffect)(()=>{function e(e){h.current&&!h.current.contains(e.target)&&z(!1),p.current&&!p.current.contains(e.target)&&I(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let O=(0,u.useMemo)(()=>R.data?R.data.filter(e=>{var t,s,l,a,n,r,i;let o=!0,d=!0,c=!0,u=!0,m=!0;if(b){let n="string"==typeof e.before_value?null===(t=JSON.parse(e.before_value))||void 0===t?void 0:t.team_id:null===(s=e.before_value)||void 0===s?void 0:s.team_id,r="string"==typeof e.updated_values?null===(l=JSON.parse(e.updated_values))||void 0===l?void 0:l.team_id:null===(a=e.updated_values)||void 0===a?void 0:a.team_id;o=n===b||r===b}if(_)try{let t="string"==typeof e.before_value?JSON.parse(e.before_value):e.before_value,s="string"==typeof e.updated_values?JSON.parse(e.updated_values):e.updated_values,l=null==t?void 0:t.token,a=null==s?void 0:s.token;d="string"==typeof l&&l.includes(_)||"string"==typeof a&&a.includes(_)}catch(e){d=!1}if(S&&(c=null===(n=e.object_id)||void 0===n?void 0:n.toLowerCase().includes(S.toLowerCase())),"all"!==C&&(u=(null===(r=e.action)||void 0===r?void 0:r.toLowerCase())===C.toLowerCase()),"all"!==T){let t="";switch(T){case"keys":t="litellm_verificationtoken";break;case"teams":t="litellm_teamtable";break;case"users":t="litellm_usertable";break;default:t=T}m=(null===(i=e.table_name)||void 0===i?void 0:i.toLowerCase())===t}return o&&d&&c&&u&&m}):[],[R.data,b,_,S,C,T]),P=O.length,H=Math.ceil(P/j)||1,F=(0,u.useMemo)(()=>{let e=(g-1)*j,t=e+j;return O.slice(e,t)},[O,g,j]),q=!R.data||0===R.data.length,B=(0,u.useCallback)(e=>{let{row:t}=e;return(0,n.jsx)(e=>{let{rowData:t}=e,{before_value:s,updated_values:l,table_name:a,action:r}=t,i=(e,t)=>{if(!e||0===Object.keys(e).length)return(0,n.jsx)(eH.x,{children:"N/A"});if(t){let t=Object.keys(e),s=["token","spend","max_budget"];if(t.every(e=>s.includes(e))&&t.length>0)return(0,n.jsxs)("div",{children:[t.includes("token")&&(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Token:"})," ",e.token||"N/A"]}),t.includes("spend")&&(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Spend:"})," ",void 0!==e.spend?"$".concat((0,M.pw)(e.spend,6)):"N/A"]}),t.includes("max_budget")&&(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Max Budget:"})," ",void 0!==e.max_budget?"$".concat((0,M.pw)(e.max_budget,6)):"N/A"]})]});if(e["No differing fields detected in 'before' state"]||e["No differing fields detected in 'updated' state"]||e["No fields changed"])return(0,n.jsx)(eH.x,{children:e[Object.keys(e)[0]]})}return(0,n.jsx)("pre",{className:"p-2 bg-gray-50 border rounded text-xs overflow-auto max-h-60",children:JSON.stringify(e,null,2)})},o=s,d=l;if(("updated"===r||"rotated"===r)&&s&&l&&("LiteLLM_TeamTable"===a||"LiteLLM_UserTable"===a||"LiteLLM_VerificationToken"===a)){let e={},t={};new Set([...Object.keys(s),...Object.keys(l)]).forEach(a=>{JSON.stringify(s[a])!==JSON.stringify(l[a])&&(s.hasOwnProperty(a)&&(e[a]=s[a]),l.hasOwnProperty(a)&&(t[a]=l[a]))}),Object.keys(s).forEach(a=>{l.hasOwnProperty(a)||e.hasOwnProperty(a)||(e[a]=s[a],t[a]=void 0)}),Object.keys(l).forEach(a=>{s.hasOwnProperty(a)||t.hasOwnProperty(a)||(t[a]=l[a],e[a]=void 0)}),o=Object.keys(e).length>0?e:{"No differing fields detected in 'before' state":"N/A"},d=Object.keys(t).length>0?t:{"No differing fields detected in 'updated' state":"N/A"},0===Object.keys(e).length&&0===Object.keys(t).length&&(o={"No fields changed":"N/A"},d={"No fields changed":"N/A"})}return(0,n.jsxs)("div",{className:"-mx-4 p-4 bg-slate-100 border-y border-slate-300 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Before Value:"}),i(o,"LiteLLM_VerificationToken"===a)]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Updated Value:"}),i(d,"LiteLLM_VerificationToken"===a)]})]})},{rowData:t.original})},[]);if(!o)return(0,n.jsxs)("div",{style:{textAlign:"center",marginTop:"20px"},children:[(0,n.jsx)("h1",{style:{display:"block",marginBottom:"10px"},children:"✨ Enterprise Feature."}),(0,n.jsx)(eH.x,{style:{display:"block",marginBottom:"10px"},children:"This is a LiteLLM Enterprise feature, and requires a valid key to use."}),(0,n.jsx)(eH.x,{style:{display:"block",marginBottom:"20px",fontStyle:"italic"},children:"Here's a preview of what Audit Logs offer:"}),(0,n.jsx)("img",{src:eF,alt:"Audit Logs Preview",style:{maxWidth:"100%",maxHeight:"700px",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",margin:"0 auto"},onError:e=>{console.error("Failed to load audit logs preview image"),e.target.style.display="none"}})]});let K=P>0?(g-1)*j+1:0,Y=Math.min(g*j,P);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex items-center justify-between mb-4"}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,n.jsxs)("div",{className:"border-b px-6 py-4",children:[(0,n.jsx)("h1",{className:"text-xl font-semibold py-4",children:"Audit Logs"}),(0,n.jsx)(e=>{let{show:t}=e;return t?(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start mb-6",children:[(0,n.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,n.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Audit Logs Not Available"}),(0,n.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"To enable audit logging, add the following configuration to your LiteLLM proxy configuration file:"}),(0,n.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"litellm_settings:\n  store_audit_logs: true"}),(0,n.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change and proxy restart."})]})]}):null},{show:q}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:[(0,n.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("input",{type:"text",placeholder:"Search by Object ID...",value:S,onChange:e=>k(e.target.value),className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,n.jsxs)("button",{onClick:()=>{R.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,n.jsx)("svg",{className:"w-4 h-4 ".concat(R.isFetching?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,n.jsx)("span",{children:"Refresh"})]})]})}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("div",{className:"relative",ref:h,children:[(0,n.jsx)("label",{htmlFor:"actionFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Action:"}),(0,n.jsxs)("button",{id:"actionFilterDisplay",onClick:()=>z(!D),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,n.jsxs)("span",{children:["all"===C&&"All Actions","created"===C&&"Created","updated"===C&&"Updated","deleted"===C&&"Deleted","rotated"===C&&"Rotated"]}),(0,n.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),D&&(0,n.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,n.jsx)("div",{className:"space-y-1",children:[{label:"All Actions",value:"all"},{label:"Created",value:"created"},{label:"Updated",value:"updated"},{label:"Deleted",value:"deleted"},{label:"Rotated",value:"rotated"}].map(e=>(0,n.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(C===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"),onClick:()=>{L(e.value),z(!1)},children:e.label},e.value))})})]}),(0,n.jsxs)("div",{className:"relative",ref:p,children:[(0,n.jsx)("label",{htmlFor:"tableFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Table:"}),(0,n.jsxs)("button",{id:"tableFilterDisplay",onClick:()=>I(!Z),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,n.jsxs)("span",{children:["all"===T&&"All Tables","keys"===T&&"Keys","teams"===T&&"Teams","users"===T&&"Users"]}),(0,n.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),Z&&(0,n.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,n.jsx)("div",{className:"space-y-1",children:[{label:"All Tables",value:"all"},{label:"Keys",value:"keys"},{label:"Teams",value:"teams"},{label:"Users",value:"users"}].map(e=>(0,n.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(T===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"),onClick:()=>{E(e.value),I(!1)},children:e.label},e.value))})})]}),(0,n.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing ",R.isLoading?"...":K," -"," ",R.isLoading?"...":Y," of"," ",R.isLoading?"...":P," results"]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",R.isLoading?"...":g," of"," ",R.isLoading?"...":H]}),(0,n.jsx)("button",{onClick:()=>f(e=>Math.max(1,e-1)),disabled:R.isLoading||1===g,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,n.jsx)("button",{onClick:()=>f(e=>Math.min(H,e+1)),disabled:R.isLoading||g===H,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]}),(0,n.jsx)(eN.w,{columns:eP,data:F,renderSubComponent:B,getRowCanExpand:()=>!0})]})]})}let eB=e=>{let{show:t,onOpenSettings:s}=e;return t?(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start",children:[(0,n.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,n.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Request/Response Data Not Available"}),(0,n.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["To view request and response details, enable prompt storage in your LiteLLM configuration by adding the following to your ",(0,n.jsx)("code",{className:"bg-blue-100 px-1 py-0.5 rounded",children:"proxy_config.yaml"})," file",s&&(0,n.jsxs)(n.Fragment,{children:[" or"," ",(0,n.jsx)("button",{onClick:s,className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"open the settings"})," ","to configure this directly."]})]}),(0,n.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:"general_settings:\n  store_model_in_db: true\n  store_prompts_in_spend_logs: true"}),(0,n.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change."})]})]}):null},eK=e=>null==e?"-":"$".concat((0,M.pw)(e,8)),eY=e=>null==e?"-":"".concat((100*e).toFixed(2),"%"),eU=e=>{var t;let{costBreakdown:s,totalSpend:l}=e;if(!s)return null;let a=void 0!==s.discount_percent&&0!==s.discount_percent||void 0!==s.discount_amount&&0!==s.discount_amount,r=void 0!==s.margin_percent&&0!==s.margin_percent||void 0!==s.margin_fixed_amount&&0!==s.margin_fixed_amount||void 0!==s.margin_total_amount&&0!==s.margin_total_amount;return void 0!==s.input_cost||void 0!==s.output_cost||a||r?(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(x.default,{expandIconPosition:"start",items:[{key:"1",label:(0,n.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Cost Breakdown"}),(0,n.jsxs)("div",{className:"flex items-center space-x-2 mr-4",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Total:"}),(0,n.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:eK(l)})]})]}),children:(0,n.jsxs)("div",{className:"p-6 space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2 max-w-2xl",children:[(0,n.jsxs)("div",{className:"flex text-sm",children:[(0,n.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Input Cost:"}),(0,n.jsx)("span",{className:"text-gray-900",children:eK(s.input_cost)})]}),(0,n.jsxs)("div",{className:"flex text-sm",children:[(0,n.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Output Cost:"}),(0,n.jsx)("span",{className:"text-gray-900",children:eK(s.output_cost)})]}),void 0!==s.tool_usage_cost&&s.tool_usage_cost>0&&(0,n.jsxs)("div",{className:"flex text-sm",children:[(0,n.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Tool Usage Cost:"}),(0,n.jsx)("span",{className:"text-gray-900",children:eK(s.tool_usage_cost)})]}),s.additional_costs&&Object.keys(s.additional_costs).length>0&&(0,n.jsx)(n.Fragment,{children:Object.entries(s.additional_costs).map(e=>{let[t,s]=e;return(0,n.jsxs)("div",{className:"flex text-sm",children:[(0,n.jsxs)("span",{className:"text-gray-600 font-medium w-1/3",children:[t,":"]}),(0,n.jsx)("span",{className:"text-gray-900",children:eK(s)})]},t)})})]}),(0,n.jsx)("div",{className:"pt-2 border-t border-gray-100 max-w-2xl",children:(0,n.jsxs)("div",{className:"flex text-sm font-semibold",children:[(0,n.jsx)("span",{className:"text-gray-900 w-1/3",children:"Original LLM Cost:"}),(0,n.jsx)("span",{className:"text-gray-900",children:eK(s.original_cost)})]})}),(a||r)&&(0,n.jsxs)("div",{className:"pt-2 space-y-2 max-w-2xl",children:[a&&(0,n.jsxs)("div",{className:"space-y-2",children:[void 0!==s.discount_percent&&0!==s.discount_percent&&(0,n.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,n.jsxs)("span",{className:"font-medium w-1/3",children:["Discount (",eY(s.discount_percent),"):"]}),(0,n.jsxs)("span",{className:"text-gray-900",children:["-",eK(s.discount_amount)]})]}),void 0!==s.discount_amount&&void 0===s.discount_percent&&(0,n.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Discount Amount:"}),(0,n.jsxs)("span",{className:"text-gray-900",children:["-",eK(s.discount_amount)]})]})]}),r&&(0,n.jsxs)("div",{className:"space-y-2",children:[void 0!==s.margin_percent&&0!==s.margin_percent&&(0,n.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,n.jsxs)("span",{className:"font-medium w-1/3",children:["Margin (",eY(s.margin_percent),"):"]}),(0,n.jsxs)("span",{className:"text-gray-900",children:["+",eK((s.margin_total_amount||0)-(s.margin_fixed_amount||0))]})]}),void 0!==s.margin_fixed_amount&&0!==s.margin_fixed_amount&&(0,n.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Margin:"}),(0,n.jsxs)("span",{className:"text-gray-900",children:["+",eK(s.margin_fixed_amount)]})]})]})]}),(0,n.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 max-w-2xl",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"font-bold text-sm text-gray-900 w-1/3",children:"Final Calculated Cost:"}),(0,n.jsx)("span",{className:"text-sm font-bold text-gray-900",children:eK(null!==(t=s.total_cost)&&void 0!==t?t:l)})]})})]})}]})}):null};var eV=s(7310),eG=s.n(eV),eW=s(12363);let eJ={TEAM_ID:"Team ID",KEY_HASH:"Key Hash",REQUEST_ID:"Request ID",MODEL:"Model",USER_ID:"User ID",END_USER:"End User",STATUS:"Status",KEY_ALIAS:"Key Alias",ERROR_CODE:"Error Code",ERROR_MESSAGE:"Error Message"};var e$=s(63134),eQ=s(15327),eX=s(77565),e0=s(9738),e1=s(23639),e2=s(29525),e5=s(82023),e4=s(3810),e3=s(59352),e6=s(70464),e8=s(49638);let e7="24px",e9="request",te="response",tt="monospace",ts="#f0f0f0",{Text:tl}=eh.default;function ta(e){let{log:t,onClose:s,onPrevious:l,onNext:a,statusLabel:r,statusColor:i,environment:o}=e,d=t.custom_llm_provider||"",c=d?(0,ew.dr)(d):null;return(0,n.jsxs)("div",{style:{padding:"16px 24px",borderBottom:"1px solid ".concat(ts),backgroundColor:"#fff",position:"sticky",top:0,zIndex:10},children:[(0,n.jsx)(tn,{model:t.model,providerLogo:null==c?void 0:c.logo,providerName:null==c?void 0:c.displayName}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,n.jsx)(tr,{requestId:t.request_id}),(0,n.jsx)(ti,{onPrevious:l,onNext:a,onClose:s})]}),(0,n.jsx)(to,{log:t,statusLabel:r,statusColor:i,environment:o})]})}function tn(e){let{model:t,providerLogo:s,providerName:l}=e;return(0,n.jsxs)(ep.Z,{size:8,style:{marginBottom:8},children:[s&&(0,n.jsx)("img",{src:s,alt:l||"Provider",style:{width:24,height:24},onError:e=>{e.target.style.display="none"}}),(0,n.jsxs)(ep.Z,{size:8,direction:"horizontal",children:[(0,n.jsx)(tl,{strong:!0,style:{fontSize:14},children:t}),l&&(0,n.jsx)(tl,{type:"secondary",style:{fontSize:12},children:l})]})]})}function tr(e){let{requestId:t}=e;return(0,n.jsx)("div",{style:{flex:1,minWidth:0},children:(0,n.jsx)(m.Z,{title:t,children:(0,n.jsx)(tl,{strong:!0,copyable:{text:t,tooltips:["Copy Request ID","Copied!"]},style:{fontSize:16,fontFamily:tt,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:t})})})}function ti(e){let{onPrevious:t,onNext:s,onClose:l}=e,a={border:"1px solid #d9d9d9",borderRadius:4,padding:"0 4px",fontSize:12,fontFamily:"monospace",marginLeft:4,background:"#fafafa"};return(0,n.jsxs)(ep.Z,{size:4,split:(0,n.jsx)("div",{style:{width:1,height:20,background:ts}}),children:[(0,n.jsxs)(H.ZP,{type:"text",size:"small",onClick:t,children:[(0,n.jsx)(e3.Z,{}),(0,n.jsx)("span",{style:a,children:"K"})]}),(0,n.jsxs)(H.ZP,{type:"text",size:"small",onClick:s,children:[(0,n.jsx)(e6.Z,{}),(0,n.jsx)("span",{style:a,children:"J"})]}),(0,n.jsx)(m.Z,{title:"ESC to close",children:(0,n.jsx)(H.ZP,{type:"text",icon:(0,n.jsx)(e8.Z,{}),onClick:l})})]})}function to(e){let{log:t,statusLabel:s,statusColor:l,environment:a}=e;return(0,n.jsxs)(ep.Z,{size:12,children:[(0,n.jsx)(e4.Z,{color:l,children:s}),(0,n.jsxs)(e4.Z,{children:["Env: ",a]}),(0,n.jsxs)(ep.Z,{size:8,children:[(0,n.jsx)(tl,{type:"secondary",style:{fontSize:13},children:c()(t.startTime).format("MMM D, YYYY h:mm:ss A")}),(0,n.jsxs)(tl,{type:"secondary",style:{fontSize:13},children:["(",c()(t.startTime).fromNow(),")"]})]})]})}var td=s(51653),tc=s(5945),tu=s(76188),tm=s(10353),tx=s(29967),th=s(65869);function tp(e){let{data:t}=e,[s,l]=(0,u.useState)({});if(!t||0===t.length)return null;let a=e=>new Date(1e3*e).toLocaleString(),r=(e,t)=>"".concat(((t-e)*1e3).toFixed(2),"ms"),i=(e,t)=>{let s="".concat(e,"-").concat(t);l(e=>({...e,[s]:!e[s]}))};return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(x.default,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Vector Store Requests"}),children:(0,n.jsx)("div",{className:"p-4",children:t.map((e,t)=>(0,n.jsxs)("div",{className:"mb-6 last:mb-0",children:[(0,n.jsx)("div",{className:"bg-white rounded-lg border p-4 mb-4",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Query:"}),(0,n.jsx)("span",{className:"font-mono",children:e.query})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Vector Store ID:"}),(0,n.jsx)("span",{className:"font-mono",children:e.vector_store_id})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,n.jsx)("span",{className:"flex items-center",children:(()=>{let{logo:t,displayName:s}=(0,ew.dr)(e.custom_llm_provider);return(0,n.jsxs)(n.Fragment,{children:[t&&(0,n.jsx)("img",{src:t,alt:"".concat(s," logo"),className:"h-5 w-5 mr-2"}),s]})})()})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,n.jsx)("span",{children:a(e.start_time)})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,n.jsx)("span",{children:a(e.end_time)})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,n.jsx)("span",{children:r(e.start_time,e.end_time)})]})]})]})}),(0,n.jsx)("h4",{className:"font-medium mb-2",children:"Search Results"}),(0,n.jsx)("div",{className:"space-y-2",children:e.vector_store_search_response.data.map((e,l)=>{let a=s["".concat(t,"-").concat(l)]||!1;return(0,n.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 cursor-pointer",onClick:()=>i(t,l),children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform ".concat(a?"transform rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("span",{className:"font-medium mr-2",children:["Result ",l+1]}),(0,n.jsxs)("span",{className:"text-gray-500 text-sm",children:["Score: ",(0,n.jsx)("span",{className:"font-mono",children:e.score.toFixed(4)})]})]})]}),a&&(0,n.jsx)("div",{className:"p-3 border-t bg-white",children:e.content.map((e,t)=>(0,n.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,n.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:e.type}),(0,n.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all bg-gray-50 p-2 rounded",children:e.text})]},t))})]},l)})})]},t))})}]})})}let{Text:tg}=eh.default;function tf(e){let{value:t,maxWidth:s=180}=e;return t?(0,n.jsx)(m.Z,{title:t,children:(0,n.jsx)(tg,{copyable:{text:t,tooltips:["Copy","Copied!"]},style:{maxWidth:s,display:"inline-block",verticalAlign:"bottom",fontFamily:tt,fontSize:12},ellipsis:!0,children:t})}):(0,n.jsx)(tg,{type:"secondary",children:"-"})}let{Text:tj}=eh.default;function ty(e){let{prompt:t=0,completion:s=0,total:l=0}=e;return(0,n.jsxs)(tj,{children:[l.toLocaleString()," (",t.toLocaleString()," prompt tokens + ",s.toLocaleString()," completion tokens)"]})}var tv=s(86669);s(52621);let{Text:tb}=eh.default;function tN(e){let{data:t}=e;return t?(0,n.jsx)("div",{style:{maxHeight:400,overflow:"auto",background:"#fafafa",padding:12,borderRadius:4},children:(0,n.jsx)("div",{className:"[&_[role='tree']]:bg-white [&_[role='tree']]:text-slate-900",children:(0,n.jsx)(tv.gc,{data:t,style:tv.jF,clickToExpandNode:!0})})}):(0,n.jsx)(tb,{type:"secondary",children:"No data"})}function t_(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}function tw(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}var tS=s(58630),tk=s(56609);let{Text:tC}=eh.default;function tL(e){var t;let{tool:s}=e,l=Object.entries((null===(t=s.parameters)||void 0===t?void 0:t.properties)||{}).map(e=>{var t,l;let[a,n]=e;return{key:a,name:a,type:n.type||"any",description:n.description||"-",required:(null===(l=s.parameters)||void 0===l?void 0:null===(t=l.required)||void 0===t?void 0:t.includes(a))||!1}}),a=[{title:"Parameter",dataIndex:"name",key:"name",render:(e,t)=>(0,n.jsxs)(tC,{code:!0,children:[e,t.required&&(0,n.jsx)(tC,{type:"danger",children:"*"})]})},{title:"Type",dataIndex:"type",key:"type",render:e=>(0,n.jsx)(tC,{code:!0,style:{color:"#1890ff"},children:e})},{title:"Description",dataIndex:"description",key:"description",render:e=>(0,n.jsx)(tC,{type:"secondary",children:e})}];return(0,n.jsxs)("div",{children:[s.description&&(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsx)(tC,{style:{lineHeight:1.6},children:s.description})}),l.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)(tC,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:8},children:"Parameters"}),(0,n.jsx)(tk.Z,{dataSource:l,columns:a,pagination:!1,size:"small",bordered:!0})]}),s.called&&s.callData&&(0,n.jsxs)("div",{style:{marginTop:16},children:[(0,n.jsx)(tC,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:8},children:"Called With"}),(0,n.jsx)("div",{style:{background:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:4,padding:12},children:(0,n.jsx)("pre",{style:{margin:0,fontSize:12,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(s.callData.arguments,null,2)})})]})]})}function tT(e){let{tool:t}=e,s={type:"function",function:{name:t.name,description:t.description,parameters:t.parameters}};return(0,n.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:12,background:"#fafafa",padding:12,borderRadius:4,maxHeight:300,overflow:"auto"},children:JSON.stringify(s,null,2)})}let{Text:tE}=eh.default;function tM(e){let{tool:t}=e,[s,l]=(0,u.useState)("formatted");return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[(0,n.jsx)(tE,{type:"secondary",style:{fontSize:12},children:"Description"}),(0,n.jsxs)(tx.ZP.Group,{size:"small",value:s,onChange:e=>l(e.target.value),children:[(0,n.jsx)(tx.ZP.Button,{value:"formatted",children:"Formatted"}),(0,n.jsx)(tx.ZP.Button,{value:"json",children:"JSON"})]})]}),"formatted"===s?(0,n.jsx)(tL,{tool:t}):(0,n.jsx)(tT,{tool:t})]})}let{Text:tD}=eh.default;function tz(e){let{tool:t}=e,[s,l]=(0,u.useState)(!1);return(0,n.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:8,overflow:"hidden"},children:[(0,n.jsxs)("div",{onClick:()=>l(!s),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",cursor:"pointer",background:s?"#fafafa":"#fff",transition:"background 0.2s"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,n.jsx)(tS.Z,{style:{color:"#8c8c8c",fontSize:14}}),(0,n.jsxs)(tD,{style:{fontSize:14},children:[t.index,". ",t.name]})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,n.jsx)(e4.Z,{color:t.called?"blue":"default",children:t.called?"called":"not called"}),s?(0,n.jsx)(e6.Z,{style:{fontSize:12,color:"#8c8c8c"}}):(0,n.jsx)(eX.Z,{style:{fontSize:12,color:"#8c8c8c"}})]})]}),s&&(0,n.jsx)("div",{style:{padding:"16px",borderTop:"1px solid #f0f0f0",background:"#fff"},children:(0,n.jsx)(tM,{tool:t})})]})}let{Text:tZ}=eh.default;function tI(e){let{log:t}=e,s=function(e){let t=function(e){let t=tw(e.proxy_server_request||e.messages);return!t||Array.isArray(t)?[]:"object"==typeof t&&t.tools&&Array.isArray(t.tools)?t.tools:[]}(e);if(0===t.length)return[];let s=function(e){let t=tw(e.response);if(!t||"object"!=typeof t)return[];let s=t.choices;if(Array.isArray(s)&&s.length>0){let e=s[0].message;if(e&&Array.isArray(e.tool_calls))return e.tool_calls}return[]}(e),l=new Set(s.map(e=>{var t;return null===(t=e.function)||void 0===t?void 0:t.name}).filter(Boolean)),a=new Map;return s.forEach(e=>{var t,s;let l=null===(t=e.function)||void 0===t?void 0:t.name;l&&a.set(l,{id:e.id,name:l,arguments:function(e){try{return JSON.parse(e)}catch(e){return{}}}((null===(s=e.function)||void 0===s?void 0:s.arguments)||"{}")})}),t.map((e,t)=>{let s=e.function||{name:"Tool ".concat(t+1)},n=s.name||"Tool ".concat(t+1);return{index:t+1,name:n,description:s.description||"",parameters:s.parameters||{},called:l.has(n),callData:a.get(n)}})}(t);if(0===s.length)return null;let l=s.length,a=s.filter(e=>e.called).length,r=s.slice(0,2).map(e=>e.name).join(", "),i=s.length>2;return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(x.default,{expandIconPosition:"start",items:[{key:"1",label:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Tools"}),(0,n.jsxs)(tZ,{type:"secondary",style:{fontSize:14},children:[l," provided, ",a," called"]}),(0,n.jsxs)(tZ,{type:"secondary",style:{fontSize:14},children:["• ",r,i&&"..."]})]}),children:(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:s.map(e=>(0,n.jsx)(tz,{tool:e},e.name))})}]})})}let tR=(e,t)=>{var s,l;let a=[];(null==e?void 0:e.messages)&&Array.isArray(e.messages)&&e.messages.forEach(e=>{a.push({role:e.role||"user",content:tA(e.content),toolCallId:e.tool_call_id})});let n=null,r=null==t?void 0:null===(l=t.choices)||void 0===l?void 0:null===(s=l[0])||void 0===s?void 0:s.message;return r&&(n={role:r.role||"assistant",content:r.content||"",toolCalls:tO(r.tool_calls)}),{requestMessages:a,responseMessage:n}},tA=e=>"string"==typeof e?e:Array.isArray(e)?e.map(e=>"string"==typeof e?e:"text"===e.type?e.text:"image_url"===e.type?"[Image]":JSON.stringify(e)).join("\n"):JSON.stringify(e),tO=e=>{if(e&&Array.isArray(e))return e.map(e=>{var t,s;return{id:e.id||"",name:(null===(t=e.function)||void 0===t?void 0:t.name)||"unknown",arguments:tP(null===(s=e.function)||void 0===s?void 0:s.arguments)}})},tP=e=>{if(!e)return{};if("string"==typeof e)try{return JSON.parse(e)}catch(t){return{raw:e}}return e};var tH=s(42264),tF=s(61340);let{Text:tq}=eh.default;function tB(e){let{type:t,tokens:s,cost:l,onCopy:a,isCollapsed:r,onToggleCollapse:i}=e;return(0,n.jsxs)("div",{onClick:i,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 16px",borderBottom:r?"none":"1px solid #f0f0f0",background:"#fafafa",cursor:i?"pointer":"default",transition:"background 0.15s ease"},onMouseEnter:e=>{i&&(e.currentTarget.style.background="#f5f5f5")},onMouseLeave:e=>{e.currentTarget.style.background="#fafafa"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[i&&(0,n.jsx)("div",{style:{display:"flex",alignItems:"center"},children:r?(0,n.jsx)(e6.Z,{style:{fontSize:10,color:"#8c8c8c"}}):(0,n.jsx)(e3.Z,{style:{fontSize:10,color:"#8c8c8c"}})}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:["input"===t?(0,n.jsx)(tF.Z,{style:{color:"#8c8c8c",fontSize:14}}):(0,n.jsx)("span",{style:{fontSize:14,filter:"grayscale(1)",opacity:.6},children:"✨"}),(0,n.jsx)(tq,{style:{fontWeight:500,fontSize:14},children:"input"===t?"Input":"Output"})]}),void 0!==s&&(0,n.jsxs)(tq,{type:"secondary",style:{fontSize:12},children:["Tokens: ",s.toLocaleString()]}),void 0!==l&&(0,n.jsxs)(tq,{type:"secondary",style:{fontSize:12},children:["Cost: $",l.toFixed(6)]})]}),(0,n.jsx)(m.Z,{title:"Copy",children:(0,n.jsx)(H.ZP,{type:"text",size:"small",icon:(0,n.jsx)(e1.Z,{}),onClick:e=>{e.stopPropagation(),a()}})})]})}let{Text:tK}=eh.default;function tY(e){let{label:t,content:s,defaultExpanded:l=!1}=e,[a,r]=(0,u.useState)(l),[i,o]=(0,u.useState)(!1),d=(null==s?void 0:s.length)||0;return s&&0!==d?(0,n.jsxs)("div",{style:{marginBottom:8},children:[(0,n.jsxs)("div",{onClick:()=>r(!a),onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",padding:"4px 0",borderRadius:4,background:i?"#f5f5f5":"transparent",transition:"background 0.15s ease",marginBottom:a?4:0},children:[a?(0,n.jsx)(e6.Z,{style:{fontSize:10,color:"#8c8c8c"}}):(0,n.jsx)(eX.Z,{style:{fontSize:10,color:"#8c8c8c"}}),(0,n.jsx)(tK,{type:"secondary",style:{fontSize:10,letterSpacing:"0.5px",textTransform:"uppercase"},children:t}),(0,n.jsxs)(tK,{type:"secondary",style:{fontSize:10},children:["(",d.toLocaleString()," chars)"]})]}),(0,n.jsx)("div",{style:{maxHeight:a?"2000px":"0px",overflow:"hidden",transition:"max-height 0.2s ease-out, opacity 0.2s ease-out",opacity:a?1:0},children:(0,n.jsx)("div",{style:{paddingLeft:16,fontSize:13,lineHeight:1.7,color:"#262626",borderLeft:"1px solid #f0f0f0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:s})})]}):null}let{Text:tU}=eh.default;function tV(e){let{tool:t,compact:s=!1}=e;return(0,n.jsxs)("div",{style:{background:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:6,padding:s?"6px 10px":"10px 14px",marginTop:8,fontFamily:"monospace",fontSize:12,position:"relative"},children:[(0,n.jsx)("div",{style:{position:"absolute",top:-8,left:12,background:"#fff",padding:"0 6px",fontSize:10,color:"#8c8c8c",border:"1px solid #e9ecef",borderRadius:3},children:"function"}),(0,n.jsx)(tU,{strong:!0,style:{fontSize:13,display:"block",marginBottom:6},children:t.name}),Object.keys(t.arguments).length>0&&(0,n.jsx)("div",{children:Object.entries(t.arguments).map(e=>{let[t,s]=e;return(0,n.jsxs)("div",{style:{marginBottom:2},children:[(0,n.jsxs)(tU,{type:"secondary",style:{fontSize:12},children:[t,":"," "]}),(0,n.jsx)(tU,{style:{fontSize:12},children:JSON.stringify(s)})]},t)})})]})}let{Text:tG}=eh.default;function tW(e){let{label:t,content:s,toolCalls:l,isCompact:a=!1}=e,r=s&&"null"!==s&&s.length>0?s:null,i=l&&l.length>0;return r||i?(0,n.jsxs)("div",{style:{marginBottom:a?8:0},children:[(0,n.jsx)(tG,{type:"secondary",style:{fontSize:10,letterSpacing:"0.5px",textTransform:"uppercase",display:"block",marginBottom:3},children:t}),r&&(0,n.jsx)("div",{style:{fontSize:13,lineHeight:1.7,color:"#262626",whiteSpace:"pre-wrap",wordBreak:"break-word",marginBottom:i?6:0},children:r}),i&&(0,n.jsx)("div",{children:l.map((e,t)=>(0,n.jsx)(tV,{tool:e,compact:a},e.id||t))})]}):null}let{Text:tJ}=eh.default;function t$(e){let{messages:t}=e,[s,l]=(0,u.useState)(!1),[a,r]=(0,u.useState)(!1);return 0===t.length?null:(0,n.jsxs)("div",{style:{marginBottom:8},children:[(0,n.jsxs)("div",{onClick:()=>l(!s),onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",padding:"4px 0",borderRadius:4,background:a?"#f5f5f5":"transparent",transition:"background 0.15s ease",marginBottom:s?4:0},children:[s?(0,n.jsx)(e6.Z,{style:{fontSize:10,color:"#8c8c8c"}}):(0,n.jsx)(eX.Z,{style:{fontSize:10,color:"#8c8c8c"}}),(0,n.jsxs)(tJ,{type:"secondary",style:{fontSize:10,letterSpacing:"0.5px",textTransform:"uppercase"},children:["HISTORY (",t.length," message",1!==t.length?"s":"",")"]})]}),(0,n.jsx)("div",{style:{maxHeight:s?"2000px":"0px",overflow:"hidden",transition:"max-height 0.2s ease-out, opacity 0.2s ease-out",opacity:s?1:0},children:(0,n.jsx)("div",{style:{paddingLeft:16,borderLeft:"1px solid #f0f0f0"},children:t.map((e,t)=>(0,n.jsx)(tW,{label:e.role.toUpperCase(),content:e.content,toolCalls:e.toolCalls,isCompact:!0},t))})})]})}function tQ(e){let{messages:t,promptTokens:s,inputCost:l}=e,[a,r]=(0,u.useState)(!1);if(0===t.length)return null;let i=t.find(e=>"system"===e.role),o=t.filter(e=>"system"!==e.role),d=o.length>0?o[o.length-1]:null,c=o.slice(0,-1);return(0,n.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:6,marginBottom:8,overflow:"hidden"},children:[(0,n.jsx)(tB,{type:"input",tokens:s,cost:l,onCopy:()=>{let e=(null==d?void 0:d.content)||"";navigator.clipboard.writeText(e),tH.ZP.success("Input copied")},isCollapsed:a,onToggleCollapse:()=>r(!a)}),(0,n.jsx)("div",{style:{maxHeight:a?"0px":"10000px",overflow:"hidden",transition:"max-height 0.3s ease-out, opacity 0.3s ease-out",opacity:a?0:1},children:(0,n.jsxs)("div",{style:{padding:"12px 16px"},children:[i&&(0,n.jsx)(tY,{label:"SYSTEM",content:i.content,defaultExpanded:!!(i.content&&i.content.length<200)}),c.length>0&&(0,n.jsx)(t$,{messages:c}),d&&(0,n.jsx)(tW,{label:d.role.toUpperCase(),content:d.content,toolCalls:d.toolCalls})]})})]})}let{Text:tX}=eh.default;function t0(e){let{message:t,completionTokens:s,outputCost:l}=e,[a,r]=(0,u.useState)(!1),i=()=>{if(!t)return;let e=t.content||"";navigator.clipboard.writeText(e),tH.ZP.success("Output copied")};return t?(0,n.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:6,overflow:"hidden"},children:[(0,n.jsx)(tB,{type:"output",tokens:s,cost:l,onCopy:i,isCollapsed:a,onToggleCollapse:()=>r(!a)}),(0,n.jsx)("div",{style:{maxHeight:a?"0px":"10000px",overflow:"hidden",transition:"max-height 0.3s ease-out, opacity 0.3s ease-out",opacity:a?0:1},children:(0,n.jsx)("div",{style:{padding:"12px 16px"},children:(0,n.jsx)(tW,{label:"ASSISTANT",content:t.content,toolCalls:t.toolCalls})})})]}):(0,n.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:6,overflow:"hidden"},children:[(0,n.jsx)(tB,{type:"output",tokens:s,cost:l,onCopy:i,isCollapsed:a,onToggleCollapse:()=>r(!a)}),(0,n.jsx)("div",{style:{maxHeight:a?"0px":"10000px",overflow:"hidden",transition:"max-height 0.3s ease-out, opacity 0.3s ease-out",opacity:a?0:1},children:(0,n.jsx)("div",{style:{padding:"12px 16px"},children:(0,n.jsx)(tX,{type:"secondary",style:{fontSize:13,fontStyle:"italic"},children:"No response data available"})})})]})}function t1(e){let{request:t,response:s,metrics:l}=e,{requestMessages:a,responseMessage:r}=tR(t,s);return(0,n.jsxs)("div",{children:[(0,n.jsx)(tQ,{messages:a,promptTokens:null==l?void 0:l.prompt_tokens,inputCost:null==l?void 0:l.input_cost}),(0,n.jsx)(t0,{message:r,completionTokens:null==l?void 0:l.completion_tokens,outputCost:null==l?void 0:l.output_cost})]})}let{Text:t2}=eh.default;function t5(e){var t,s,l,a;let{logEntry:r,onOpenSettings:i,isLoadingDetails:o=!1}=e,d=r.metadata||{},c="failure"===d.status,u=c?d.error_information:null,m=!!(t=r.messages)&&(Array.isArray(t)?t.length>0:"object"==typeof t&&Object.keys(t).length>0),x=!!(s=r.response)&&Object.keys(t_(s)).length>0,h=!m&&!x&&!c&&!o,p=null==d?void 0:d.guardrail_information,g=Array.isArray(p)?p:p?[p]:[],f=g.length>0,j=g.reduce((e,t)=>{let s=null==t?void 0:t.masked_entity_count;return s?e+Object.values(s).reduce((e,t)=>"number"==typeof t?e+t:e,0):e},0),y=0===g.length?"-":1===g.length?null!==(a=null===(l=g[0])||void 0===l?void 0:l.guardrail_name)&&void 0!==a?a:"-":"".concat(g.length," guardrails"),v=d.vector_store_request_metadata&&Array.isArray(d.vector_store_request_metadata)&&d.vector_store_request_metadata.length>0;return(0,n.jsxs)("div",{style:{padding:"".concat(e7," ").concat(e7," 0")},children:[c&&u&&(0,n.jsx)(td.Z,{type:"error",showIcon:!0,message:"Request Failed",description:(0,n.jsx)(t4,{errorInfo:u}),className:"mb-6"}),r.request_tags&&Object.keys(r.request_tags).length>0&&(0,n.jsx)(t3,{tags:r.request_tags}),(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(tc.Z,{title:"Request Details",size:"small",bordered:!1,style:{marginBottom:0},children:(0,n.jsxs)(tu.Z,{column:2,size:"small",children:[(0,n.jsx)(tu.Z.Item,{label:"Model",children:r.model}),(0,n.jsx)(tu.Z.Item,{label:"Provider",children:r.custom_llm_provider||"-"}),(0,n.jsx)(tu.Z.Item,{label:"Call Type",children:r.call_type}),(0,n.jsx)(tu.Z.Item,{label:"Model ID",children:(0,n.jsx)(tf,{value:r.model_id})}),(0,n.jsx)(tu.Z.Item,{label:"API Base",children:(0,n.jsx)(tf,{value:r.api_base,maxWidth:200})}),r.requester_ip_address&&(0,n.jsx)(tu.Z.Item,{label:"IP Address",children:r.requester_ip_address}),f&&(0,n.jsx)(tu.Z.Item,{label:"Guardrail",children:(0,n.jsx)(t6,{label:y,maskedCount:j})})]})})}),(0,n.jsx)(t8,{logEntry:r,metadata:d}),(0,n.jsx)(eU,{costBreakdown:null==d?void 0:d.cost_breakdown,totalSpend:r.spend||0}),(0,n.jsx)(tI,{log:r}),h&&(0,n.jsx)("div",{className:"mb-6",children:(0,n.jsx)(eB,{show:h,onOpenSettings:i})}),o?(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6 p-8 text-center",children:[(0,n.jsx)(tm.Z,{size:"default"}),(0,n.jsx)("div",{style:{marginTop:8,color:"#999"},children:"Loading request & response data..."})]}):(0,n.jsx)(t7,{hasResponse:x,hasError:c,getRawRequest:()=>t_(r.proxy_server_request||r.messages),getFormattedResponse:()=>c&&u?{error:{message:u.error_message||"An error occurred",type:u.error_class||"error",code:u.error_code||"unknown",param:null}}:t_(r.response),logEntry:r}),f&&(0,n.jsx)(E,{data:p}),v&&(0,n.jsx)(tp,{data:d.vector_store_request_metadata}),r.metadata&&Object.keys(r.metadata).length>0&&(0,n.jsx)(t9,{metadata:r.metadata}),(0,n.jsx)("div",{style:{height:e7}})]})}function t4(e){let{errorInfo:t}=e;return(0,n.jsxs)("div",{children:[t.error_code&&(0,n.jsxs)("div",{children:[(0,n.jsx)(t2,{strong:!0,children:"Error Code:"})," ",t.error_code]}),t.error_message&&(0,n.jsxs)("div",{children:[(0,n.jsx)(t2,{strong:!0,children:"Message:"})," ",t.error_message]})]})}function t3(e){let{tags:t}=e;return(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden p-4 mb-6",children:[(0,n.jsx)(t2,{strong:!0,style:{display:"block",marginBottom:8,fontSize:16},children:"Tags"}),(0,n.jsx)(ep.Z,{size:8,wrap:!0,children:Object.entries(t).map(e=>{let[t,s]=e;return(0,n.jsxs)(e4.Z,{children:[t,": ",String(s)]},t)})})]})}function t6(e){let{label:t,maskedCount:s}=e;return(0,n.jsxs)(ep.Z,{size:8,children:[(0,n.jsx)("span",{children:t}),s>0&&(0,n.jsxs)(e4.Z,{color:"blue",children:[s," masked"]})]})}function t8(e){var t,s,l,a;let{logEntry:r,metadata:i}=e,o=r.cache_hit||(null==i?void 0:null===(t=i.additional_usage_values)||void 0===t?void 0:t.cache_read_input_tokens)&&i.additional_usage_values.cache_read_input_tokens>0;return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(tc.Z,{title:"Metrics",size:"small",bordered:!1,style:{marginBottom:0},children:(0,n.jsxs)(tu.Z,{column:2,size:"small",children:[(0,n.jsx)(tu.Z.Item,{label:"Tokens",children:(0,n.jsx)(ty,{prompt:r.prompt_tokens,completion:r.completion_tokens,total:r.total_tokens})}),(0,n.jsxs)(tu.Z.Item,{label:"Cost",children:["$",(0,M.pw)(r.spend||0,8)]}),(0,n.jsxs)(tu.Z.Item,{label:"Duration",children:[null===(s=r.duration)||void 0===s?void 0:s.toFixed(3)," s"]}),o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tu.Z.Item,{label:"Cache Hit",children:(0,n.jsx)(e4.Z,{color:r.cache_hit?"green":"default",children:r.cache_hit||"None"})}),(null==i?void 0:null===(l=i.additional_usage_values)||void 0===l?void 0:l.cache_read_input_tokens)>0&&(0,n.jsx)(tu.Z.Item,{label:"Cache Read Tokens",children:(0,M.pw)(i.additional_usage_values.cache_read_input_tokens)}),(null==i?void 0:null===(a=i.additional_usage_values)||void 0===a?void 0:a.cache_creation_input_tokens)>0&&(0,n.jsx)(tu.Z.Item,{label:"Cache Creation Tokens",children:(0,M.pw)(i.additional_usage_values.cache_creation_input_tokens)})]}),(null==i?void 0:i.litellm_overhead_time_ms)!==void 0&&null!==i.litellm_overhead_time_ms&&(0,n.jsxs)(tu.Z.Item,{label:"LiteLLM Overhead",children:[i.litellm_overhead_time_ms.toFixed(2)," ms"]}),(0,n.jsx)(tu.Z.Item,{label:"Start Time",children:c()(r.startTime).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}),(0,n.jsx)(tu.Z.Item,{label:"End Time",children:c()(r.endTime).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")})]})})})}function t7(e){let{hasResponse:t,hasError:s,getRawRequest:l,getFormattedResponse:a,logEntry:r}=e,[i,o]=(0,u.useState)(e9),[d,c]=(0,u.useState)("pretty"),m=r.spend||0,h=r.prompt_tokens||0,p=r.completion_tokens||0,g=h+p;return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(x.default,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},onClick:e=>{e.target.closest(".ant-radio-group")&&e.stopPropagation()},children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",style:{margin:0},children:"Request & Response"}),(0,n.jsxs)(tx.ZP.Group,{size:"small",value:d,onChange:e=>c(e.target.value),children:[(0,n.jsx)(tx.ZP.Button,{value:"pretty",children:"Pretty"}),(0,n.jsx)(tx.ZP.Button,{value:"json",children:"JSON"})]})]}),children:(0,n.jsx)("div",{children:"pretty"===d?(0,n.jsx)(t1,{request:l(),response:a(),metrics:{prompt_tokens:h,completion_tokens:p,input_cost:g>0?m*h/g:0,output_cost:g>0?m*p/g:0}}):(0,n.jsx)(th.default,{activeKey:i,onChange:e=>o(e),tabBarExtraContent:(0,n.jsx)(t2,{copyable:{text:JSON.stringify(i===e9?l():a(),null,2),tooltips:["Copy JSON","Copied!"]},disabled:i===te&&!t&&!s}),items:[{key:e9,label:"Request",children:(0,n.jsx)("div",{style:{paddingTop:16,paddingBottom:16},children:(0,n.jsx)(tN,{data:l(),mode:"formatted"})})},{key:te,label:"Response",children:(0,n.jsx)("div",{style:{paddingTop:16,paddingBottom:16},children:t||s?(0,n.jsx)(tN,{data:a(),mode:"formatted"}):(0,n.jsx)("div",{style:{textAlign:"center",padding:20,color:"#999",fontStyle:"italic"},children:"Response data not available"})})}]})})}]})})}function t9(e){let{metadata:t}=e;return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,n.jsx)(x.default,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Metadata"}),children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:8},children:(0,n.jsx)(t2,{copyable:{text:JSON.stringify(t,null,2),tooltips:["Copy Metadata","Copied!"]}})}),(0,n.jsx)("pre",{style:{maxHeight:300,overflowY:"auto",fontSize:12,fontFamily:tt,whiteSpace:"pre-wrap",wordBreak:"break-all",margin:0},children:JSON.stringify(t,null,2)})]})}]})})}var se=s(39760);let st=(e,t,s)=>{let{accessToken:l}=(0,se.Z)();return(0,i.a)({queryKey:["logDetails",e,t,l],queryFn:async()=>l&&e&&t?await (0,ev.uiSpendLogDetailsCall)(l,e,t):null,enabled:s&&!!l&&!!e&&!!t,staleTime:6e5,gcTime:6e5})};function ss(e){let{row:t,isSelected:s,onClick:l}=e,a=eT.includes(t.call_type),r=null!=t.duration?t.duration.toFixed(3):t.startTime&&t.endTime?((Date.parse(t.endTime)-Date.parse(t.startTime))/1e3).toFixed(3):"-";return(0,n.jsxs)("button",{type:"button",className:"w-full text-left pl-8 pr-2 py-1 transition-colors ".concat(s?"bg-blue-50":"hover:bg-slate-100"),onClick:l,children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[a?(0,n.jsx)(e2.Z,{size:12,className:"text-slate-500 flex-shrink-0"}):(0,n.jsx)(e5.Z,{size:12,className:"text-slate-500 flex-shrink-0"}),(0,n.jsx)("span",{className:"text-xs font-medium text-slate-900 truncate",children:function(e,t){let s=(t||"").trim();if(eT.includes(e))return s.replace(/^mcp:\s*/i,"").split("/").pop()||s||"mcp_tool";let l=(s.split("/").pop()||s).replace(/-20\d{6}.*$/i,"").replace(/:.*$/,""),a=l.match(/claude-[a-z0-9-]+/i);return a?a[0]:l||"llm_call"}(t.call_type,t.model)})]}),(0,n.jsxs)("div",{className:"text-[10px] text-slate-500 mt-0 flex items-center gap-1.5 font-mono",children:[(0,n.jsxs)("span",{children:[r,"s"]}),t.spend?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"\xb7"}),(0,n.jsx)("span",{children:(0,M.GS)(t.spend)})]}):null,t.total_tokens?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"\xb7"}),(0,n.jsxs)("span",{children:[t.total_tokens," tok"]})]}):null]})]})}function sl(e){let{open:t,onClose:s,logEntry:l,sessionId:a,accessToken:r,onOpenSettings:o,allLogs:d=[],onSelectLog:c,startTime:m}=e,x=!!a,[h,p]=(0,u.useState)(null),[g,f]=(0,u.useState)(!1),[j,y]=(0,u.useState)(!1),{data:v=[]}=(0,i.a)({queryKey:["sessionLogs",a],queryFn:async()=>{if(!a||!r)return[];let e=await (0,ev.sessionSpendLogsCall)(r,a);return(e.data||e||[]).map(e=>({...e,duration:(Date.parse(e.endTime)-Date.parse(e.startTime))/1e3})).sort((e,t)=>{let s=eT.includes(e.call_type)?1:0,l=eT.includes(t.call_type)?1:0;return s!==l?s-l:new Date(e.startTime).getTime()-new Date(t.startTime).getTime()})},enabled:!!(t&&x&&a&&r)}),b=(0,u.useMemo)(()=>x?v.length?h?v.find(e=>e.request_id===h)||v[0]:(null==l?void 0:l.request_id)&&v.find(e=>e.request_id===l.request_id)||v[0]:null:l,[x,l,h,v]);(0,u.useEffect)(()=>{x&&v.length&&(!h||!v.some(e=>e.request_id===h))&&p((null==l?void 0:l.request_id)&&v.some(e=>e.request_id===l.request_id)?l.request_id:v[0].request_id)},[x,l,h,v]),(0,u.useEffect)(()=>{t?f(!1):(x&&p(null),y(!1))},[t,x]);let{selectNextLog:N,selectPreviousLog:_}=function(e){let{isOpen:t,currentLog:s,allLogs:l,onClose:a,onSelectLog:n}=e;(0,u.useEffect)(()=>{let e=e=>{var s;if(!((s=e.target)instanceof HTMLInputElement||s instanceof HTMLTextAreaElement)&&t)switch(e.key){case"Escape":a();break;case"j":case"J":i();break;case"k":case"K":r()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t,s,l]);let r=()=>{if(!s||!l.length||!n)return;let e=l.findIndex(e=>e.request_id===s.request_id);e<l.length-1&&n(l[e+1])},i=()=>{if(!s||!l.length||!n)return;let e=l.findIndex(e=>e.request_id===s.request_id);e>0&&n(l[e-1])};return{selectNextLog:r,selectPreviousLog:i}}({isOpen:t,currentLog:b,allLogs:x?v:d,onClose:s,onSelectLog:e=>{x&&p(e.request_id),null==c||c(e)}}),w=st(null==b?void 0:b.request_id,m,t&&!!(null==b?void 0:b.request_id)),S=w.data,k=w.isLoading,C=(0,u.useMemo)(()=>b?{...b,messages:(null==S?void 0:S.messages)||b.messages,response:(null==S?void 0:S.response)||b.response,proxy_server_request:(null==S?void 0:S.proxy_server_request)||b.proxy_server_request}:null,[b,S]),L=(null==b?void 0:b.metadata)||{},T="failure"===L.status?"Failure":"Success",E="failure"===L.status?"error":"success",D=(null==L?void 0:L.user_api_key_team_alias)||"default",z=v.reduce((e,t)=>e+(t.spend||0),0),Z=v.length>0?new Date(Math.min(...v.map(e=>new Date(e.startTime).getTime()))):null,I=v.length>0?new Date(Math.max(...v.map(e=>new Date(e.endTime).getTime()))):null,R=Z&&I?((I.getTime()-Z.getTime())/1e3).toFixed(2):"0.00",A=v.filter(e=>!eT.includes(e.call_type)).length,O=v.filter(e=>eT.includes(e.call_type)).length,P=x?v:b?[b]:[],F=x?a||"":(null==b?void 0:b.request_id)||"",q=F.length>14?"".concat(F.slice(0,11),"..."):F,B=async()=>{if(F)try{await navigator.clipboard.writeText(F),y(!0),setTimeout(()=>y(!1),1200)}catch(e){}};return b&&C?(0,n.jsx)(e$.Z,{title:null,placement:"right",onClose:s,open:t,width:"60%",closable:!1,mask:!0,maskClosable:!0,styles:{body:{padding:0,overflow:"hidden"},header:{display:"none"}},children:(0,n.jsxs)("div",{style:{height:"100%"},className:"flex relative",children:[g?(0,n.jsx)(H.ZP,{type:"text",size:"small",icon:(0,n.jsx)(eX.Z,{}),onClick:()=>f(!1),className:"absolute top-2 left-2 z-20 !bg-white !border !border-slate-200 !rounded-md","aria-label":"Expand trace sidebar"}):(0,n.jsx)(H.ZP,{type:"text",size:"small",icon:(0,n.jsx)(eQ.Z,{}),onClick:()=>f(!0),className:"absolute top-2 left-2 z-20 !bg-white !border !border-slate-200 !rounded-md","aria-label":"Collapse trace sidebar"}),!g&&(0,n.jsxs)("div",{className:"border-r border-slate-200 bg-slate-50 flex flex-col",style:{width:224},children:[(0,n.jsxs)("div",{className:"pl-12 pr-3 py-2 border-b border-slate-200 bg-white",children:[(0,n.jsx)("div",{className:"flex items-start justify-between gap-2",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-[10px] uppercase tracking-wide text-slate-500",children:x?"Session":"Trace"}),(0,n.jsxs)("div",{className:"font-mono text-[12px] text-slate-900 leading-tight flex items-center gap-1",children:[(0,n.jsx)("span",{className:"truncate",children:q}),(0,n.jsx)("button",{type:"button",onClick:B,className:"text-slate-400 hover:text-slate-600","aria-label":"Copy trace id",children:j?(0,n.jsx)(e0.Z,{className:"text-[11px]"}):(0,n.jsx)(e1.Z,{className:"text-[11px]"})})]})]})}),(0,n.jsxs)("div",{className:"mt-1 text-[11px] text-slate-500 font-mono",children:[P.length," req",(0,n.jsx)("span",{className:"mx-1.5",children:"\xb7"}),x?"".concat(A," LLM"):"".concat(P.filter(e=>!eT.includes(e.call_type)).length," LLM"),(0,n.jsx)("span",{className:"mx-1.5",children:"\xb7"}),x?"".concat(O," MCP"):"".concat(P.filter(e=>eT.includes(e.call_type)).length," MCP"),(0,n.jsx)("span",{className:"mx-1.5",children:"\xb7"}),x?(0,M.GS)(z):(0,M.GS)(b.spend||0),x&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"mx-1.5",children:"\xb7"}),R,"s"]})]})]}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto",children:x?(0,n.jsx)("div",{className:"py-1",children:(0,n.jsxs)("div",{className:"relative pl-2",children:[(0,n.jsx)("div",{className:"absolute left-4 top-1 bottom-1 border-l border-slate-300"}),P.map((e,t)=>{let s=t===P.length-1;return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute left-4 top-3 w-3 border-t border-slate-300"}),s&&(0,n.jsx)("div",{className:"absolute left-4 top-3 bottom-0 w-px bg-slate-50"}),(0,n.jsx)(ss,{row:e,isSelected:e.request_id===b.request_id,onClick:()=>{p(e.request_id),null==c||c(e)}})]},e.request_id)})]})}):(0,n.jsx)("div",{className:"py-1",children:P.map(e=>(0,n.jsx)(ss,{row:e,isSelected:e.request_id===b.request_id,onClick:()=>null==c?void 0:c(e)},e.request_id))})})]}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,n.jsx)(ta,{log:b,onClose:s,onPrevious:_,onNext:N,statusLabel:T,statusColor:E,environment:D}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,n.jsx)(t5,{logEntry:C,onOpenSettings:o,isLoadingDetails:k})})]})]})}):null}let sa=(e,t,s)=>{if(e)return"".concat(c()(t).format("MMM D, h:mm A")," - ").concat(c()(s).format("MMM D, h:mm A"));let l=c()(),a=c()(t),n=l.diff(a,"minutes");if(n>=0&&n<2)return"Last 1 Minute";if(n>=2&&n<16)return"Last 15 Minutes";if(n>=16&&n<61)return"Last Hour";let r=l.diff(a,"hours");return r>=1&&r<5?"Last 4 Hours":r>=5&&r<25?"Last 24 Hours":r>=25&&r<169?"Last 7 Days":"".concat(a.format("MMM D")," - ").concat(l.format("MMM D"))};var sn=s(9114),sr=s(21770),si=s(90246);(l||(l={})).GENERAL_SETTINGS="general_settings",(a||(a={})).MAXIMUM_SPEND_LOGS_RETENTION_PERIOD="maximum_spend_logs_retention_period";let so=async(e,t)=>{try{let s=ev.proxyBaseUrl?"".concat(ev.proxyBaseUrl,"/config/list?config_type=").concat(t):"/config/list?config_type=".concat(t),l=await fetch(s,{method:"GET",headers:{[(0,ev.getGlobalLitellmHeaderName)()]:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!l.ok){let e=await l.json(),t=(0,ev.deriveErrorMessage)(e);throw(0,ev.handleError)(t),Error(t)}return await l.json()}catch(e){throw console.error("Failed to get proxy config for ".concat(t,":"),e),e}},sd=(0,si.n)("proxyConfig"),sc=async(e,t)=>{try{let s=ev.proxyBaseUrl?"".concat(ev.proxyBaseUrl,"/config/field/delete"):"/config/field/delete",l=await fetch(s,{method:"POST",headers:{[(0,ev.getGlobalLitellmHeaderName)()]:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)});if(!l.ok){let e=await l.json(),t=(0,ev.deriveErrorMessage)(e);throw(0,ev.handleError)(t),Error(t)}return await l.json()}catch(e){throw console.error("Failed to delete proxy config field ".concat(t.field_name,":"),e),e}},su=e=>{let{accessToken:t}=(0,se.Z)();return(0,i.a)({queryKey:sd.list({filters:{configType:e}}),queryFn:async()=>await so(t,e),enabled:!!t})},sm=()=>{let{accessToken:e}=(0,se.Z)();return(0,sr.D)({mutationFn:async t=>{if(!e)throw Error("Access token is required");return await sc(e,t)}})},sx=async(e,t)=>{let s=(0,ev.getProxyBaseUrl)(),l=await fetch(s?"".concat(s,"/config/update"):"/config/update",{method:"POST",headers:{[(0,ev.getGlobalLitellmHeaderName)()]:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({general_settings:{store_prompts_in_spend_logs:t.store_prompts_in_spend_logs,...t.maximum_spend_logs_retention_period&&{maximum_spend_logs_retention_period:t.maximum_spend_logs_retention_period}}})});if(!l.ok){var a;let e=await l.json().catch(()=>({}));throw Error((null==e?void 0:null===(a=e.error)||void 0===a?void 0:a.message)||(null==e?void 0:e.message)||(null==e?void 0:e.detail)||"Failed to update spend logs settings")}return await l.json()},sh=()=>{let{accessToken:e}=(0,se.Z)();return(0,sr.D)({mutationFn:async t=>{if(!e)throw Error("Access token is required");return await sx(e,t)}})};var sp=s(85968),sg=s(5540),sf=s(10032),sj=s(22116),sy=s(50337),sv=s(63709),sb=s(4260),sN=e=>{var t,s;let{isVisible:r,onCancel:i,onSuccess:o}=e,[d]=sf.Z.useForm(),{mutateAsync:c,isPending:m}=sh(),{mutateAsync:x,isPending:h}=sm(),{data:p,isLoading:g,refetch:f}=su(l.GENERAL_SETTINGS),j=sf.Z.useWatch("store_prompts_in_spend_logs",d);(0,u.useEffect)(()=>{r&&f()},[r,f]);let y=(0,u.useMemo)(()=>{var e,t;if(!p)return{store_prompts_in_spend_logs:!1,maximum_spend_logs_retention_period:void 0};let s=p.find(e=>"store_prompts_in_spend_logs"===e.field_name),l=p.find(e=>"maximum_spend_logs_retention_period"===e.field_name);return{store_prompts_in_spend_logs:null!==(e=null==s?void 0:s.field_value)&&void 0!==e&&e,maximum_spend_logs_retention_period:null!==(t=null==l?void 0:l.field_value)&&void 0!==t?t:void 0}},[p]),v=async e=>{try{let t=e.maximum_spend_logs_retention_period;if(!t||"string"==typeof t&&""===t.trim())try{await x({config_type:l.GENERAL_SETTINGS,field_name:a.MAXIMUM_SPEND_LOGS_RETENTION_PERIOD})}catch(e){console.warn("Failed to delete retention period field (may not exist):",e)}let s={store_prompts_in_spend_logs:e.store_prompts_in_spend_logs,...t&&"string"==typeof t&&""!==t.trim()&&{maximum_spend_logs_retention_period:t}};await c(s,{onSuccess:()=>{sn.ZP.success("Spend logs settings updated successfully"),f(),null==o||o()},onError:e=>{sn.ZP.fromBackend("Failed to save spend logs settings: "+(0,sp.O)(e))}})}catch(e){sn.ZP.fromBackend("Failed to save spend logs settings: "+(0,sp.O)(e))}},b=()=>{d.resetFields(),i()};return(0,n.jsx)(sj.Z,{title:(0,n.jsxs)("span",{className:"flex gap-2",children:[(0,n.jsx)(eh.default.Title,{level:5,children:"Spend Logs Settings"}),(0,n.jsx)(q.Z,{})]}),open:r,footer:(0,n.jsxs)(ep.Z,{children:[(0,n.jsx)(H.ZP,{onClick:b,disabled:m||h||g,children:"Cancel"}),(0,n.jsx)(H.ZP,{type:"primary",loading:m||h,disabled:g,onClick:()=>d.submit(),children:m||h?"Saving...":"Save Settings"})]}),onCancel:b,children:(0,n.jsxs)(sf.Z,{form:d,layout:"horizontal",onFinish:v,initialValues:y,children:[(0,n.jsx)(sf.Z.Item,{label:"Store Prompts in Spend Logs",name:"store_prompts_in_spend_logs",tooltip:(null==p?void 0:null===(t=p.find(e=>"store_prompts_in_spend_logs"===e.field_name))||void 0===t?void 0:t.field_description)||"When enabled, prompts will be stored in spend logs for tracking and analysis purposes.",valuePropName:"checked",children:(0,n.jsx)("div",{children:g?(0,n.jsx)(sy.Z.Input,{active:!0,block:!0}):(0,n.jsx)(sv.Z,{checked:null!=j&&j,onChange:e=>d.setFieldValue("store_prompts_in_spend_logs",e)})})}),(0,n.jsx)(sf.Z.Item,{label:"Maximum Spend Logs Retention Period (Optional)",name:"maximum_spend_logs_retention_period",tooltip:(null==p?void 0:null===(s=p.find(e=>"maximum_spend_logs_retention_period"===e.field_name))||void 0===s?void 0:s.field_description)||"Set the maximum retention period for spend logs (e.g., '7d' for 7 days, '30d' for 30 days). Leave empty for no limit.",children:g?(0,n.jsx)(sy.Z.Input,{active:!0,block:!0}):(0,n.jsx)(sb.default,{placeholder:"e.g., 7d, 30d",prefix:(0,n.jsx)(sg.Z,{})})})]},p?JSON.stringify(y):"loading")})};function s_(e){let{accessToken:t,token:s,userRole:l,userID:a,allTeams:d,premiumUser:m}=e,[x,h]=(0,u.useState)(""),[p,g]=(0,u.useState)(!1),[f,j]=(0,u.useState)(!1),[y,v]=(0,u.useState)(1),[b]=(0,u.useState)(50),N=(0,u.useRef)(null),_=(0,u.useRef)(null),w=(0,u.useRef)(null),[S,k]=(0,u.useState)(c()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),[C,L]=(0,u.useState)(c()().format("YYYY-MM-DDTHH:mm")),[T,E]=(0,u.useState)(!1),[M,B]=(0,u.useState)(!1),[K,Y]=(0,u.useState)(""),[U,V]=(0,u.useState)(""),[G,W]=(0,u.useState)(""),[J,Q]=(0,u.useState)(""),[X,ee]=(0,u.useState)(""),[et,es]=(0,u.useState)(null),[el,ea]=(0,u.useState)(null),[en,er]=(0,u.useState)(""),[ei,eo]=(0,u.useState)(""),[eu,em]=(0,u.useState)(l&&F.lo.includes(l)),[ex,eh]=(0,u.useState)("request logs"),[ep,eg]=(0,u.useState)(null),[ef,e_]=(0,u.useState)(!1),[ew,eS]=(0,u.useState)(null),[ek,eC]=(0,u.useState)(!1),[eM,eD]=(0,u.useState)("startTime"),[ez,eZ]=(0,u.useState)("desc");(0,r.NL)();let[eI,eR]=(0,u.useState)(()=>{let e=sessionStorage.getItem("isLiveTail");return null===e||JSON.parse(e)});(0,u.useEffect)(()=>{sessionStorage.setItem("isLiveTail",JSON.stringify(eI))},[eI]);let[eO,eP]=(0,u.useState)({value:24,unit:"hours"});(0,u.useEffect)(()=>{(async()=>{el&&t&&es({...(await (0,ev.keyInfoV1Call)(t,el)).info,token:el,api_key:el})})()},[el,t]),(0,u.useEffect)(()=>{function e(e){N.current&&!N.current.contains(e.target)&&j(!1),_.current&&!_.current.contains(e.target)&&g(!1),w.current&&!w.current.contains(e.target)&&B(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,u.useEffect)(()=>{l&&F.lo.includes(l)&&em(!0)},[l]);let eH=(0,i.a)({queryKey:["logs","table",y,b,S,C,G,J,eu?a:null,en,X,eM,ez],queryFn:async()=>{if(!t||!s||!l||!a)return{data:[],total:0,page:1,page_size:b,total_pages:0};let e=c()(S).utc().format("YYYY-MM-DD HH:mm:ss"),n=T?c()(C).utc().format("YYYY-MM-DD HH:mm:ss"):c()().utc().format("YYYY-MM-DD HH:mm:ss");return await (0,ev.uiSpendLogsCall)({accessToken:t,start_date:e,end_date:n,page:y,page_size:b,params:{api_key:J||void 0,team_id:G||void 0,user_id:eu&&null!=a?a:void 0,end_user:ei||void 0,status_filter:en||void 0,model_id:X||void 0,sort_by:eM,sort_order:ez}})},enabled:!!t&&!!s&&!!l&&!!a&&"request logs"===ex,refetchInterval:!!eI&&1===y&&15e3,placeholderData:o.Wk,refetchIntervalInBackground:!0}),eF=(0,u.useDeferredValue)(eH.isFetching),eB=eH.isFetching||eF,{filters:eK,filteredLogs:eY,allTeams:eU,allKeyAliases:eV,handleFilterChange:e$,handleFilterReset:eQ}=function(e){let{logs:t,accessToken:s,startTime:l,endTime:a,pageSize:n=eW.d,isCustomDate:r,setCurrentPage:o,userID:d,userRole:m,sortBy:x="startTime",sortOrder:h="desc",currentPage:p=1}=e,g=(0,u.useMemo)(()=>({[eJ.TEAM_ID]:"",[eJ.KEY_HASH]:"",[eJ.REQUEST_ID]:"",[eJ.MODEL]:"",[eJ.USER_ID]:"",[eJ.END_USER]:"",[eJ.STATUS]:"",[eJ.KEY_ALIAS]:"",[eJ.ERROR_CODE]:"",[eJ.ERROR_MESSAGE]:""}),[]),[f,j]=(0,u.useState)(g),[y,v]=(0,u.useState)({data:[],total:0,page:1,page_size:50,total_pages:0}),b=(0,u.useRef)(0),N=(0,u.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!s)return;console.log("Filters being sent to API:",e);let i=Date.now();b.current=i;let o=c()(l).utc().format("YYYY-MM-DD HH:mm:ss"),d=r?c()(a).utc().format("YYYY-MM-DD HH:mm:ss"):c()().utc().format("YYYY-MM-DD HH:mm:ss");try{let l=await (0,ev.uiSpendLogsCall)({accessToken:s,start_date:o,end_date:d,page:t,page_size:n,params:{api_key:e[eJ.KEY_HASH]||void 0,team_id:e[eJ.TEAM_ID]||void 0,request_id:e[eJ.REQUEST_ID]||void 0,user_id:e[eJ.USER_ID]||void 0,end_user:e[eJ.END_USER]||void 0,status_filter:e[eJ.STATUS]||void 0,model_id:e[eJ.MODEL]||void 0,key_alias:e[eJ.KEY_ALIAS]||void 0,error_code:e[eJ.ERROR_CODE]||void 0,error_message:e[eJ.ERROR_MESSAGE]||void 0,sort_by:x,sort_order:h}});i===b.current&&l.data&&v(l)}catch(e){console.error("Error searching users:",e)}},[s,l,a,r,n,x,h]),_=(0,u.useMemo)(()=>eG()((e,t)=>N(e,t),300),[N]);(0,u.useEffect)(()=>()=>_.cancel(),[_]);let w=(0,i.a)({queryKey:["allKeys"],queryFn:async()=>{if(!s)throw Error("Access token required");return await (0,ec.LO)(s)},enabled:!!s}).data||[],S=(0,u.useMemo)(()=>!!(f[eJ.KEY_ALIAS]||f[eJ.KEY_HASH]||f[eJ.REQUEST_ID]||f[eJ.USER_ID]||f[eJ.END_USER]||f[eJ.ERROR_CODE]||f[eJ.ERROR_MESSAGE]||f[eJ.MODEL]),[f]);(0,u.useEffect)(()=>{S&&s&&N(f,p)},[x,h,p]);let k=(0,u.useMemo)(()=>{if(!t||!t.data)return{data:[],total:0,page:1,page_size:50,total_pages:0};if(S)return t;let e=[...t.data];return f[eJ.TEAM_ID]&&(e=e.filter(e=>e.team_id===f[eJ.TEAM_ID])),f[eJ.STATUS]&&(e=e.filter(e=>"success"===f[eJ.STATUS]?!e.status||"success"===e.status:e.status===f[eJ.STATUS])),f[eJ.MODEL]&&(e=e.filter(e=>e.model_id===f[eJ.MODEL])),f[eJ.KEY_HASH]&&(e=e.filter(e=>e.api_key===f[eJ.KEY_HASH])),f[eJ.END_USER]&&(e=e.filter(e=>e.end_user===f[eJ.END_USER])),f[eJ.ERROR_CODE]&&(e=e.filter(e=>{let t=(e.metadata||{}).error_information;return t&&t.error_code===f[eJ.ERROR_CODE]})),{data:e,total:t.total,page:t.page,page_size:t.page_size,total_pages:t.total_pages}},[t,f,S]),C=(0,u.useMemo)(()=>S?y&&y.data&&y.data.length>0?y:t||{data:[],total:0,page:1,page_size:50,total_pages:0}:k,[S,y,k,t]),{data:L}=(0,i.a)({queryKey:["allTeamsForLogFilters",s],queryFn:async()=>s&&await (0,ec.IE)(s)||[],enabled:!!s});return{filters:f,filteredLogs:C,allKeyAliases:w,allTeams:L,handleFilterChange:e=>{j(t=>{let s={...t,...e};for(let e of Object.keys(g))e in s||(s[e]=g[e]);return JSON.stringify(s)!==JSON.stringify(t)&&(o(1),_(s,1)),s})},handleFilterReset:()=>{j(g),v({data:[],total:0,page:1,page_size:50,total_pages:0}),_(g,1)}}}({logs:eH.data||{data:[],total:0,page:1,page_size:b||10,total_pages:1},accessToken:t,startTime:S,endTime:C,pageSize:b,isCustomDate:T,setCurrentPage:v,userID:a,userRole:l,sortBy:eM,sortOrder:ez,currentPage:y}),eX=(0,u.useCallback)(async e=>{if(t)try{let s=(await (0,ev.keyListCall)(t,null,null,e,null,null,y,b)).keys.find(t=>t.key_alias===e);s&&Q(s.token)}catch(e){console.error("Error fetching key hash for alias:",e)}},[t,y,b]),e0=(0,u.useCallback)(()=>{eQ(),k(c()().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),L(c()().format("YYYY-MM-DDTHH:mm")),E(!1),eP({value:24,unit:"hours"}),v(1)},[eQ]);if((0,u.useEffect)(()=>{t&&(eK["Team ID"]?W(eK["Team ID"]):W(""),er(eK.Status||""),ee(eK.Model||""),eo(eK["End User"]||""),eK["Key Hash"]?Q(eK["Key Hash"]):eK["Key Alias"]?eX(eK["Key Alias"]):Q(""))},[eK,t,eX]),!t||!s||!l||!a)return null;let e1=eY.data.filter(e=>!x||e.request_id.includes(x)||e.model.includes(x)||e.user&&e.user.includes(x)),e2=e1.reduce((e,t)=>(t.session_id&&(e[t.session_id]||(e[t.session_id]={llm:0,mcp:0}),eT.includes(t.call_type)?e[t.session_id].mcp+=1:e[t.session_id].llm+=1),e),{}),e5=new Map;for(let e of e1){if(!e.session_id||1>=(e.session_total_count||1))continue;let t=eT.includes(e.call_type),s=e5.get(e.session_id);s&&(!s.isMcp||t)||e5.set(e.session_id,{requestId:e.request_id,isMcp:t})}let e4=e1.map(e=>{var t,s;let l=e.session_id?e2[e.session_id]:void 0;return{...e,duration:(Date.parse(e.endTime)-Date.parse(e.startTime))/1e3,session_llm_count:null!==(t=null==l?void 0:l.llm)&&void 0!==t?t:void 0,session_mcp_count:null!==(s=null==l?void 0:l.mcp)&&void 0!==s?s:void 0,onKeyHashClick:e=>ea(e),onSessionClick:t=>{t&&(eS(t),eg(e),e_(!0))}}}).filter(e=>{var t;return!e.session_id||1>=(e.session_total_count||1)||(null===(t=e5.get(e.session_id))||void 0===t?void 0:t.requestId)===e.request_id})||[],e3=[{name:"Team ID",label:"Team ID",isSearchable:!0,searchFn:async e=>d&&0!==d.length?d.filter(t=>t.team_id.toLowerCase().includes(e.toLowerCase())||t.team_alias&&t.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:"".concat(e.team_alias||e.team_id," (").concat(e.team_id,")"),value:e.team_id})):[]},{name:"Status",label:"Status",isSearchable:!1,options:[{label:"Success",value:"success"},{label:"Failure",value:"failure"}]},{name:"Model",label:"Model",customComponent:ej},{name:"Key Alias",label:"Key Alias",isSearchable:!0,searchFn:async e=>t?(await (0,ec.LO)(t)).filter(t=>t.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e})):[]},{name:"End User",label:"End User",isSearchable:!0,searchFn:async e=>{if(!t)return[];let s=await (0,ev.allEndUsersCall)(t);return((null==s?void 0:s.map(e=>e.user_id))||[]).filter(t=>t.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e}))}},{name:"Error Code",label:"Error Code",isSearchable:!0,searchFn:async e=>{if(!e)return eL;let t=e.toLowerCase(),s=eL.filter(e=>e.label.toLowerCase().includes(t));return!eL.some(t=>t.value===e.trim())&&e.trim()&&s.push({label:"Use custom code: ".concat(e.trim()),value:e.trim()}),s}},{name:"Key Hash",label:"Key Hash",isSearchable:!1},{name:"Error Message",label:"Error Message",isSearchable:!1}],e6=eE.find(e=>e.value===eO.value&&e.unit===eO.unit),e8=T?sa(T,S,C):null==e6?void 0:e6.label;return(0,n.jsxs)("div",{className:"w-full max-w-screen p-6 overflow-x-hidden box-border",children:[(0,n.jsxs)(R.Z,{defaultIndex:0,onIndexChange:e=>eh(0===e?"request logs":"audit logs"),children:[(0,n.jsxs)(A.Z,{children:[(0,n.jsx)(I.Z,{children:"Request Logs"}),(0,n.jsx)(I.Z,{children:"Audit Logs"}),(0,n.jsx)(I.Z,{children:"Deleted Keys"}),(0,n.jsx)(I.Z,{children:"Deleted Teams"})]}),(0,n.jsxs)(P.Z,{children:[(0,n.jsxs)(O.Z,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h1",{className:"text-xl font-semibold",children:"Request Logs"}),(0,n.jsx)(q.Z,{dot:!0,children:(0,n.jsx)(H.ZP,{icon:(0,n.jsx)(D.Z,{}),onClick:()=>eC(!0),title:"Spend Logs Settings"})})]}),et&&el&&et.api_key===el?(0,n.jsx)(eb.Z,{keyId:el,keyData:et,teams:d,onClose:()=>ea(null),backButtonText:"Back to Logs"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ey.Z,{options:e3,onApplyFilters:e$,onResetFilters:e0}),(0,n.jsx)(sN,{isVisible:ek,onCancel:()=>eC(!1),onSuccess:()=>eC(!1)}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full box-border",children:[(0,n.jsx)("div",{className:"border-b px-6 py-4 w-full max-w-full box-border",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0 w-full max-w-full box-border",children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-3 w-full max-w-full box-border",children:[(0,n.jsxs)("div",{className:"relative w-64 min-w-0 flex-shrink-0",children:[(0,n.jsx)("input",{type:"text",placeholder:"Search by Request ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:x,onChange:e=>h(e.target.value)}),(0,n.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-shrink",children:[(0,n.jsxs)("div",{className:"relative z-50",ref:w,children:[(0,n.jsxs)("button",{onClick:()=>B(!M),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e8]}),M&&(0,n.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border p-2 z-50",children:(0,n.jsxs)("div",{className:"space-y-1",children:[eE.map(e=>(0,n.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(e8===e.label?"bg-blue-50 text-blue-600":""),onClick:()=>{L(c()().format("YYYY-MM-DDTHH:mm")),k(c()().subtract(e.value,e.unit).format("YYYY-MM-DDTHH:mm")),eP({value:e.value,unit:e.unit}),E(!1),B(!1)},children:e.label},e.label)),(0,n.jsx)("div",{className:"border-t my-2"}),(0,n.jsx)("button",{className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ".concat(T?"bg-blue-50 text-blue-600":""),onClick:()=>E(!T),children:"Custom Range"})]})})]}),(0,n.jsx)(()=>(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Live Tail"}),(0,n.jsx)(Z.Z,{color:"green",checked:eI,defaultChecked:!0,onChange:eR})]}),{}),(0,n.jsx)(H.ZP,{type:"default",icon:(0,n.jsx)(z.Z,{spin:eB}),onClick:()=>{eH.refetch()},disabled:eB,title:"Fetch data",children:eB?"Fetching":"Fetch"})]}),T&&(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{children:(0,n.jsx)("input",{type:"datetime-local",value:S,onChange:e=>{k(e.target.value),v(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,n.jsx)("span",{className:"text-gray-500",children:"to"}),(0,n.jsx)("div",{children:(0,n.jsx)("input",{type:"datetime-local",value:C,onChange:e=>{L(e.target.value),v(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-700 whitespace-nowrap",children:["Showing ",eH.isLoading?"...":eY?(y-1)*b+1:0," -"," ",eH.isLoading?"...":eY?Math.min(y*b,eY.total):0," ","of ",eH.isLoading?"...":eY?eY.total:0," results"]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-700 min-w-[90px]",children:["Page ",eH.isLoading?"...":y," of"," ",eH.isLoading?"...":eY?eY.total_pages:1]}),(0,n.jsx)("button",{onClick:()=>v(e=>Math.max(1,e-1)),disabled:eH.isLoading||1===y,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,n.jsx)("button",{onClick:()=>v(e=>Math.min(eY.total_pages||1,e+1)),disabled:eH.isLoading||y===(eY.total_pages||1),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}),eI&&1===y&&(0,n.jsxs)("div",{className:"mb-4 px-4 py-2 bg-green-50 border border-greem-200 rounded-md flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)("span",{className:"text-sm text-green-700",children:"Auto-refreshing every 15 seconds"})}),(0,n.jsx)("button",{onClick:()=>eR(!1),className:"text-sm text-green-600 hover:text-green-800",children:"Stop"})]}),(0,n.jsx)(eN.w,{columns:eA({sortBy:eM,sortOrder:ez,onSortChange:(e,t)=>{eD(e),eZ(t),v(1)}}),data:e4,onRowClick:e=>{if(e.session_id&&(e.session_total_count||1)>1){eS(e.session_id),eg(e),e_(!0);return}eS(null),eg(e),e_(!0)},isLoading:eH.isLoading})]})]})]}),(0,n.jsx)(O.Z,{children:(0,n.jsx)(eq,{userID:a,userRole:l,token:s,accessToken:t,isActive:"audit logs"===ex,premiumUser:m,allTeams:d})}),(0,n.jsx)(O.Z,{children:(0,n.jsx)($,{})}),(0,n.jsx)(O.Z,{children:(0,n.jsx)(ed,{})})]})]}),(0,n.jsx)(sl,{open:ef,onClose:()=>{e_(!1),eS(null)},logEntry:ep,sessionId:ew,accessToken:t,onOpenSettings:()=>eC(!0),allLogs:e4,onSelectLog:e=>{eg(e)},startTime:c()(S).utc().format("YYYY-MM-DD HH:mm:ss")})]})}}}]);