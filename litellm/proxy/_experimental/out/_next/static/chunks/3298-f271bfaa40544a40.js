"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3298],{1309:function(e,l,a){a.d(l,{C:function(){return r.Z}});var r=a(41649)},63298:function(e,l,a){a.d(l,{Z:function(){return eG}});var r,i,t=a(57437),s=a(2265),n=a(16312),o=a(82680),d=a(19250),c=a(93192),u=a(52787),m=a(91810),p=a(13634),g=a(3810),x=a(64504);(r=i||(i={})).PresidioPII="Presidio PII",r.Bedrock="Bedrock Guardrail",r.Lakera="Lakera";let h={},f=e=>{let l={};return l.PresidioPII="Presidio PII",l.Bedrock="Bedrock Guardrail",l.Lakera="Lakera",Object.entries(e).forEach(e=>{let[a,r]=e;r&&"object"==typeof r&&"ui_friendly_name"in r&&(l[a.split("_").map((e,l)=>e.charAt(0).toUpperCase()+e.slice(1)).join("")]=r.ui_friendly_name)}),h=l,l},j=()=>Object.keys(h).length>0?h:i,v={PresidioPII:"presidio",Bedrock:"bedrock",Lakera:"lakera_v2"},_=e=>{Object.entries(e).forEach(e=>{let[l,a]=e;a&&"object"==typeof a&&"ui_friendly_name"in a&&(v[l.split("_").map((e,l)=>e.charAt(0).toUpperCase()+e.slice(1)).join("")]=l)})},y=e=>!!e&&"Presidio PII"===j()[e],b="../ui/assets/logos/",N={"Presidio PII":"".concat(b,"presidio.png"),"Bedrock Guardrail":"".concat(b,"bedrock.svg"),Lakera:"".concat(b,"lakeraai.jpeg"),"Azure Content Safety Prompt Shield":"".concat(b,"presidio.png"),"Azure Content Safety Text Moderation":"".concat(b,"presidio.png"),"Aporia AI":"".concat(b,"aporia.png"),"PANW Prisma AIRS":"".concat(b,"palo_alto_networks.jpeg"),"Noma Security":"".concat(b,"noma_security.png"),"Javelin Guardrails":"".concat(b,"javelin.png"),"Pillar Guardrail":"".concat(b,"pillar.jpeg"),"Google Cloud Model Armor":"".concat(b,"google.svg"),"Guardrails AI":"".concat(b,"guardrails_ai.jpeg"),"Lasso Guardrail":"".concat(b,"lasso.png"),"Pangea Guardrail":"".concat(b,"pangea.png"),"AIM Guardrail":"".concat(b,"aim_security.jpeg"),"OpenAI Moderation":"".concat(b,"openai_small.svg"),EnkryptAI:"".concat(b,"enkrypt_ai.avif")},S=e=>{if(!e)return{logo:"",displayName:"-"};let l=Object.keys(v).find(l=>v[l].toLowerCase()===e.toLowerCase());if(!l)return{logo:"",displayName:e};let a=j()[l];return{logo:N[a]||"",displayName:a||e}};var k=a(33866),w=a(89970),I=a(73002),P=a(61994),Z=a(97416),C=a(8881),O=a(10798),A=a(49638);let{Text:E}=c.default,{Option:G}=u.default,L=e=>e.replace(/_/g," "),F=e=>{switch(e){case"MASK":return(0,t.jsx)(Z.Z,{style:{marginRight:4}});case"BLOCK":return(0,t.jsx)(C.Z,{style:{marginRight:4}});default:return null}},z=e=>{let{categories:l,selectedCategories:a,onChange:r}=e;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)(O.Z,{className:"text-gray-500 mr-1"}),(0,t.jsx)(E,{className:"text-gray-500 font-medium",children:"Filter by category"})]}),(0,t.jsx)(u.default,{mode:"multiple",placeholder:"Select categories to filter by",style:{width:"100%"},onChange:r,value:a,allowClear:!0,showSearch:!0,optionFilterProp:"children",className:"mb-4",tagRender:e=>(0,t.jsx)(g.Z,{color:"blue",closable:e.closable,onClose:e.onClose,className:"mr-2 mb-2",children:e.label}),children:l.map(e=>(0,t.jsx)(G,{value:e.category,children:e.category},e.category))})]})},T=e=>{let{onSelectAll:l,onUnselectAll:a,hasSelectedEntities:r}=e;return(0,t.jsxs)("div",{className:"bg-gray-50 p-5 rounded-lg mb-6 border border-gray-200 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(E,{strong:!0,className:"text-gray-700 text-base",children:"Quick Actions"}),(0,t.jsx)(w.Z,{title:"Apply action to all PII types at once",children:(0,t.jsx)("div",{className:"ml-2 text-gray-400 cursor-help text-xs",children:"â“˜"})})]}),(0,t.jsx)(I.ZP,{type:"default",onClick:a,disabled:!r,icon:(0,t.jsx)(A.Z,{}),className:"border-gray-300 hover:text-red-600 hover:border-red-300",children:"Unselect All"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(I.ZP,{type:"default",onClick:()=>l("MASK"),className:"flex items-center justify-center h-10 border-blue-200 hover:border-blue-300 hover:text-blue-700 bg-blue-50 hover:bg-blue-100 text-blue-600",block:!0,icon:(0,t.jsx)(Z.Z,{}),children:"Select All & Mask"}),(0,t.jsx)(I.ZP,{type:"default",onClick:()=>l("BLOCK"),className:"flex items-center justify-center h-10 border-red-200 hover:border-red-300 hover:text-red-700 bg-red-50 hover:bg-red-100 text-red-600",block:!0,icon:(0,t.jsx)(C.Z,{}),children:"Select All & Block"})]})]})},M=e=>{let{entities:l,selectedEntities:a,selectedActions:r,actions:i,onEntitySelect:s,onActionSelect:n,entityToCategoryMap:o}=e;return(0,t.jsxs)("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[(0,t.jsxs)("div",{className:"bg-gray-50 px-5 py-3 border-b flex",children:[(0,t.jsx)(E,{strong:!0,className:"flex-1 text-gray-700",children:"PII Type"}),(0,t.jsx)(E,{strong:!0,className:"w-32 text-right text-gray-700",children:"Action"})]}),(0,t.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:0===l.length?(0,t.jsx)("div",{className:"py-10 text-center text-gray-500",children:"No PII types match your filter criteria"}):l.map(e=>(0,t.jsxs)("div",{className:"px-5 py-3 flex items-center justify-between hover:bg-gray-50 border-b ".concat(a.includes(e)?"bg-blue-50":""),children:[(0,t.jsxs)("div",{className:"flex items-center flex-1",children:[(0,t.jsx)(P.Z,{checked:a.includes(e),onChange:()=>s(e),className:"mr-3"}),(0,t.jsx)(E,{className:a.includes(e)?"font-medium text-gray-900":"text-gray-700",children:L(e)}),o.get(e)&&(0,t.jsx)(g.Z,{className:"ml-2 text-xs",color:"blue",children:o.get(e)})]}),(0,t.jsx)("div",{className:"w-32",children:(0,t.jsx)(u.default,{value:a.includes(e)&&r[e]||"MASK",onChange:l=>n(e,l),style:{width:120},disabled:!a.includes(e),className:"".concat(a.includes(e)?"":"opacity-50"),dropdownMatchSelectWidth:!1,children:i.map(e=>(0,t.jsx)(G,{value:e,children:(0,t.jsxs)("div",{className:"flex items-center",children:[F(e),e]})},e))})})]},e))})]})},{Title:B,Text:J}=c.default;var D=e=>{let{entities:l,actions:a,selectedEntities:r,selectedActions:i,onEntitySelect:n,onActionSelect:o,entityCategories:d=[]}=e,[c,u]=(0,s.useState)([]),m=new Map;d.forEach(e=>{e.entities.forEach(l=>{m.set(l,e.category)})});let p=l.filter(e=>0===c.length||c.includes(m.get(e)||""));return(0,t.jsxs)("div",{className:"pii-configuration",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)(B,{level:4,className:"mb-0 font-semibold text-gray-800",children:"Configure PII Protection"})}),(0,t.jsx)(k.Z,{count:r.length,showZero:!0,style:{backgroundColor:r.length>0?"#4f46e5":"#d9d9d9"},overflowCount:999,children:(0,t.jsxs)(J,{className:"text-gray-500",children:[r.length," items selected"]})})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)(z,{categories:d,selectedCategories:c,onChange:u}),(0,t.jsx)(T,{onSelectAll:e=>{l.forEach(l=>{r.includes(l)||n(l),o(l,e)})},onUnselectAll:()=>{r.forEach(e=>{n(e)})},hasSelectedEntities:r.length>0})]}),(0,t.jsx)(M,{entities:p,selectedEntities:r,selectedActions:i,actions:a,onEntitySelect:n,onActionSelect:o,entityToCategoryMap:m})]})},V=a(87908),K=a(31283),R=a(24199),U=e=>{var l;let{selectedProvider:a,accessToken:r,providerParams:i=null,value:n=null}=e,[o,c]=(0,s.useState)(!1),[m,g]=(0,s.useState)(i),[x,h]=(0,s.useState)(null);if((0,s.useEffect)(()=>{if(i){g(i);return}let e=async()=>{if(r){c(!0),h(null);try{let e=await (0,d.getGuardrailProviderSpecificParams)(r);console.log("Provider params API response:",e),g(e),f(e),_(e)}catch(e){console.error("Error fetching provider params:",e),h("Failed to load provider parameters")}finally{c(!1)}}};i||e()},[r,i]),!a)return null;if(o)return(0,t.jsx)(V.Z,{tip:"Loading provider parameters..."});if(x)return(0,t.jsx)("div",{className:"text-red-500",children:x});let j=null===(l=v[a])||void 0===l?void 0:l.toLowerCase(),y=m&&m[j];if(console.log("Provider key:",j),console.log("Provider fields:",y),!y||0===Object.keys(y).length)return(0,t.jsx)("div",{children:"No configuration fields available for this provider."});console.log("Value:",n);let b=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0;return Object.entries(e).map(e=>{let[r,i]=e,s=l?"".concat(l,".").concat(r):r,o=a?a[r]:null==n?void 0:n[r];return(console.log("Field value:",o),"ui_friendly_name"===r||"optional_params"===r&&"nested"===i.type&&i.fields)?null:"nested"===i.type&&i.fields?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-2 font-medium",children:r}),(0,t.jsx)("div",{className:"ml-4 border-l-2 border-gray-200 pl-4",children:b(i.fields,s,o)})]},s):(0,t.jsx)(p.Z.Item,{name:s,label:r,tooltip:i.description,rules:i.required?[{required:!0,message:"".concat(r," is required")}]:void 0,children:"select"===i.type&&i.options?(0,t.jsx)(u.default,{placeholder:i.description,defaultValue:o||i.default_value,children:i.options.map(e=>(0,t.jsx)(u.default.Option,{value:e,children:e},e))}):"multiselect"===i.type&&i.options?(0,t.jsx)(u.default,{mode:"multiple",placeholder:i.description,defaultValue:o||i.default_value,children:i.options.map(e=>(0,t.jsx)(u.default.Option,{value:e,children:e},e))}):"bool"===i.type||"boolean"===i.type?(0,t.jsxs)(u.default,{placeholder:i.description,defaultValue:void 0!==o?String(o):i.default_value,children:[(0,t.jsx)(u.default.Option,{value:"true",children:"True"}),(0,t.jsx)(u.default.Option,{value:"false",children:"False"})]}):"number"===i.type?(0,t.jsx)(R.Z,{step:1,width:400,placeholder:i.description,defaultValue:void 0!==o?Number(o):void 0}):r.includes("password")||r.includes("secret")||r.includes("key")?(0,t.jsx)(K.o,{placeholder:i.description,type:"password",defaultValue:o||""}):(0,t.jsx)(K.o,{placeholder:i.description,type:"text",defaultValue:o||""})},s)})};return(0,t.jsx)(t.Fragment,{children:b(y)})};let{Title:q}=c.default,H=e=>{let{field:l,fieldKey:a,fullFieldKey:r,value:i}=e,[n,o]=s.useState([]),[d,c]=s.useState(l.dict_key_options||[]);s.useEffect(()=>{if(i&&"object"==typeof i){let e=Object.keys(i);o(e.map(e=>({key:e,id:"".concat(e,"_").concat(Date.now(),"_").concat(Math.random())}))),c((l.dict_key_options||[]).filter(l=>!e.includes(l)))}},[i,l.dict_key_options]);let m=e=>{e&&(o([...n,{key:e,id:"".concat(e,"_").concat(Date.now())}]),c(d.filter(l=>l!==e)))},g=(e,l)=>{o(n.filter(l=>l.id!==e)),c([...d,l].sort())};return(0,t.jsxs)("div",{className:"space-y-3",children:[n.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[(0,t.jsx)("div",{className:"w-24 font-medium text-sm",children:e.key}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(p.Z.Item,{name:Array.isArray(r)?[...r,e.key]:[r,e.key],style:{marginBottom:0},initialValue:i&&"object"==typeof i?i[e.key]:void 0,normalize:"number"===l.dict_value_type?e=>{if(null==e||""===e)return;let l=Number(e);return isNaN(l)?e:l}:void 0,children:"number"===l.dict_value_type?(0,t.jsx)(R.Z,{step:1,width:200,placeholder:"Enter ".concat(e.key," value")}):"boolean"===l.dict_value_type?(0,t.jsxs)(u.default,{placeholder:"Select ".concat(e.key," value"),children:[(0,t.jsx)(u.default.Option,{value:!0,children:"True"}),(0,t.jsx)(u.default.Option,{value:!1,children:"False"})]}):(0,t.jsx)(K.o,{placeholder:"Enter ".concat(e.key," value"),type:"text"})})}),(0,t.jsx)("button",{type:"button",className:"text-red-500 hover:text-red-700 text-sm",onClick:()=>g(e.id,e.key),children:"Remove"})]},e.id)),d.length>0&&(0,t.jsxs)("div",{className:"flex items-center space-x-3 mt-2",children:[(0,t.jsx)(u.default,{placeholder:"Select category to configure",style:{width:200},onSelect:e=>e&&m(e),value:void 0,children:d.map(e=>(0,t.jsx)(u.default.Option,{value:e,children:e},e))}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Select a category to add threshold configuration"})]})]})};var Y=e=>{let{optionalParams:l,parentFieldKey:a,values:r}=e,i=(e,l)=>{let i="".concat(a,".").concat(e),s=null==r?void 0:r[e];return(console.log("value",s),"dict"===l.type&&l.dict_key_options)?(0,t.jsxs)("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[(0,t.jsx)("div",{className:"mb-4 font-medium text-gray-900 text-base",children:e}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:l.description}),(0,t.jsx)(H,{field:l,fieldKey:e,fullFieldKey:[a,e],value:s})]},i):(0,t.jsx)("div",{className:"mb-8 p-6 bg-white rounded-lg border border-gray-200 shadow-sm",children:(0,t.jsx)(p.Z.Item,{name:[a,e],label:(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsx)("div",{className:"font-medium text-gray-900 text-base",children:e}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:l.description})]}),rules:l.required?[{required:!0,message:"".concat(e," is required")}]:void 0,className:"mb-0",initialValue:void 0!==s?s:l.default_value,normalize:"number"===l.type?e=>{if(null==e||""===e)return;let l=Number(e);return isNaN(l)?e:l}:void 0,children:"select"===l.type&&l.options?(0,t.jsx)(u.default,{placeholder:l.description,children:l.options.map(e=>(0,t.jsx)(u.default.Option,{value:e,children:e},e))}):"multiselect"===l.type&&l.options?(0,t.jsx)(u.default,{mode:"multiple",placeholder:l.description,children:l.options.map(e=>(0,t.jsx)(u.default.Option,{value:e,children:e},e))}):"bool"===l.type||"boolean"===l.type?(0,t.jsxs)(u.default,{placeholder:l.description,children:[(0,t.jsx)(u.default.Option,{value:"true",children:"True"}),(0,t.jsx)(u.default.Option,{value:"false",children:"False"})]}):"number"===l.type?(0,t.jsx)(R.Z,{step:1,width:400,placeholder:l.description}):e.includes("password")||e.includes("secret")||e.includes("key")?(0,t.jsx)(K.o,{placeholder:l.description,type:"password"}):(0,t.jsx)(K.o,{placeholder:l.description,type:"text"})})},i)};return l.fields&&0!==Object.keys(l.fields).length?(0,t.jsxs)("div",{className:"guardrail-optional-params",children:[(0,t.jsxs)("div",{className:"mb-8 pb-4 border-b border-gray-100",children:[(0,t.jsx)(q,{level:3,className:"mb-2 font-semibold text-gray-900",children:"Optional Parameters"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:l.description||"Configure additional settings for this guardrail provider"})]}),(0,t.jsx)("div",{className:"space-y-8",children:Object.entries(l.fields).map(e=>{let[l,a]=e;return i(l,a)})})]}):null},Q=a(9114);let{Title:W,Text:X,Link:$}=c.default,{Option:ee}=u.default,{Step:el}=m.default,ea={pre_call:"Before LLM Call - Runs before the LLM call and checks the input (Recommended)",during_call:"During LLM Call - Runs in parallel with the LLM call, with response held until check completes",post_call:"After LLM Call - Runs after the LLM call and checks only the output",logging_only:"Logging Only - Only runs on logging callbacks without affecting the LLM call",pre_mcp_call:"Before MCP Tool Call - Runs before MCP tool execution and validates tool calls",during_mcp_call:"During MCP Tool Call - Runs in parallel with MCP tool execution for monitoring"};var er=e=>{let{visible:l,onClose:a,accessToken:r,onSuccess:i}=e,[n]=p.Z.useForm(),[c,h]=(0,s.useState)(!1),[b,S]=(0,s.useState)(null),[k,w]=(0,s.useState)(null),[I,P]=(0,s.useState)([]),[Z,C]=(0,s.useState)({}),[O,A]=(0,s.useState)(0),[E,G]=(0,s.useState)(null),[L,F]=(0,s.useState)([]),[z,T]=(0,s.useState)(2),[M,B]=(0,s.useState)({});(0,s.useEffect)(()=>{r&&(async()=>{try{let[e,l]=await Promise.all([(0,d.getGuardrailUISettings)(r),(0,d.getGuardrailProviderSpecificParams)(r)]);w(e),G(l),f(l),_(l)}catch(e){console.error("Error fetching guardrail data:",e),Q.Z.fromBackend("Failed to load guardrail configuration")}})()},[r]);let J=e=>{S(e),n.setFieldsValue({config:void 0,presidio_analyzer_api_base:void 0,presidio_anonymizer_api_base:void 0}),P([]),C({}),F([]),T(2),B({})},V=e=>{P(l=>l.includes(e)?l.filter(l=>l!==e):[...l,e])},K=(e,l)=>{C(a=>({...a,[e]:l}))},R=async()=>{try{if(0===O&&(await n.validateFields(["guardrail_name","provider","mode","default_on"]),b)){let e=["guardrail_name","provider","mode","default_on"];"PresidioPII"===b&&e.push("presidio_analyzer_api_base","presidio_anonymizer_api_base"),await n.validateFields(e)}if(1===O&&y(b)&&0===I.length){Q.Z.fromBackend("Please select at least one PII entity to continue");return}A(O+1)}catch(e){console.error("Form validation failed:",e)}},q=()=>{n.resetFields(),S(null),P([]),C({}),F([]),T(2),B({}),A(0)},H=()=>{q(),a()},W=async()=>{try{h(!0),await n.validateFields();let l=n.getFieldsValue(!0),t=v[l.provider],s={guardrail_name:l.guardrail_name,litellm_params:{guardrail:t,mode:l.mode,default_on:l.default_on},guardrail_info:{}};if("PresidioPII"===l.provider&&I.length>0){let e={};I.forEach(l=>{e[l]=Z[l]||"MASK"}),s.litellm_params.pii_entities_config=e,l.presidio_analyzer_api_base&&(s.litellm_params.presidio_analyzer_api_base=l.presidio_analyzer_api_base),l.presidio_anonymizer_api_base&&(s.litellm_params.presidio_anonymizer_api_base=l.presidio_anonymizer_api_base)}else if(l.config)try{let e=JSON.parse(l.config);s.guardrail_info=e}catch(e){Q.Z.fromBackend("Invalid JSON in configuration"),h(!1);return}if(console.log("values: ",JSON.stringify(l)),E&&b){var e;let a=null===(e=v[b])||void 0===e?void 0:e.toLowerCase();console.log("providerKey: ",a);let r=E[a]||{},i=new Set;console.log("providerSpecificParams: ",JSON.stringify(r)),Object.keys(r).forEach(e=>{"optional_params"!==e&&i.add(e)}),r.optional_params&&r.optional_params.fields&&Object.keys(r.optional_params.fields).forEach(e=>{i.add(e)}),console.log("allowedParams: ",i),i.forEach(e=>{let a=l[e];if(null==a||""===a){var r;a=null===(r=l.optional_params)||void 0===r?void 0:r[e]}null!=a&&""!==a&&(s.litellm_params[e]=a)})}if(!r)throw Error("No access token available");console.log("Sending guardrail data:",JSON.stringify(s)),await (0,d.createGuardrailCall)(r,s),Q.Z.success("Guardrail created successfully"),q(),i(),a()}catch(e){console.error("Failed to create guardrail:",e),Q.Z.fromBackend("Failed to create guardrail: "+(e instanceof Error?e.message:String(e)))}finally{h(!1)}},X=()=>{var e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,t.jsx)(x.o,{placeholder:"Enter a name for this guardrail"})}),(0,t.jsx)(p.Z.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,t.jsx)(u.default,{placeholder:"Select a guardrail provider",onChange:J,labelInValue:!1,optionLabelProp:"label",dropdownRender:e=>e,showSearch:!0,children:Object.entries(j()).map(e=>{let[l,a]=e;return(0,t.jsx)(ee,{value:l,label:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[N[a]&&(0,t.jsx)("img",{src:N[a],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,t.jsx)("span",{children:a})]}),children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[N[a]&&(0,t.jsx)("img",{src:N[a],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,t.jsx)("span",{children:a})]})},l)})})}),(0,t.jsx)(p.Z.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,t.jsx)(u.default,{optionLabelProp:"label",mode:"multiple",children:(null==k?void 0:null===(e=k.supported_modes)||void 0===e?void 0:e.map(e=>(0,t.jsx)(ee,{value:e,label:e,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:e}),"pre_call"===e&&(0,t.jsx)(g.Z,{color:"green",style:{marginLeft:"8px"},children:"Recommended"})]}),(0,t.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:ea[e]})]})},e)))||(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ee,{value:"pre_call",label:"pre_call",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"pre_call"})," ",(0,t.jsx)(g.Z,{color:"green",children:"Recommended"})]}),(0,t.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:ea.pre_call})]})}),(0,t.jsx)(ee,{value:"during_call",label:"during_call",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:(0,t.jsx)("strong",{children:"during_call"})}),(0,t.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:ea.during_call})]})}),(0,t.jsx)(ee,{value:"post_call",label:"post_call",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:(0,t.jsx)("strong",{children:"post_call"})}),(0,t.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:ea.post_call})]})}),(0,t.jsx)(ee,{value:"logging_only",label:"logging_only",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:(0,t.jsx)("strong",{children:"logging_only"})}),(0,t.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:ea.logging_only})]})})]})})}),(0,t.jsx)(p.Z.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default.",children:(0,t.jsxs)(u.default,{children:[(0,t.jsx)(u.default.Option,{value:!0,children:"Yes"}),(0,t.jsx)(u.default.Option,{value:!1,children:"No"})]})}),(0,t.jsx)(U,{selectedProvider:b,accessToken:r,providerParams:E})]})},$=()=>k&&"PresidioPII"===b?(0,t.jsx)(D,{entities:k.supported_entities,actions:k.supported_actions,selectedEntities:I,selectedActions:Z,onEntitySelect:V,onActionSelect:K,entityCategories:k.pii_entity_categories}):null,er=()=>{var e;if(!b||!E)return null;console.log("guardrail_provider_map: ",v),console.log("selectedProvider: ",b);let l=null===(e=v[b])||void 0===e?void 0:e.toLowerCase(),a=E&&E[l];return a&&a.optional_params?(0,t.jsx)(Y,{optionalParams:a.optional_params,parentFieldKey:"optional_params"}):null};return(0,t.jsx)(o.Z,{title:"Add Guardrail",open:l,onCancel:H,footer:null,width:700,children:(0,t.jsxs)(p.Z,{form:n,layout:"vertical",initialValues:{mode:"pre_call",default_on:!1},children:[(0,t.jsxs)(m.default,{current:O,className:"mb-6",children:[(0,t.jsx)(el,{title:"Basic Info"}),(0,t.jsx)(el,{title:y(b)?"PII Configuration":"Provider Configuration"})]}),(()=>{switch(O){case 0:return X();case 1:if(y(b))return $();return er();default:return null}})(),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[O>0&&(0,t.jsx)(x.z,{variant:"secondary",onClick:()=>{A(O-1)},children:"Previous"}),O<2&&(0,t.jsx)(x.z,{onClick:R,children:"Next"}),2===O&&(0,t.jsx)(x.z,{onClick:W,loading:c,children:"Create Guardrail"}),(0,t.jsx)(x.z,{variant:"secondary",onClick:H,children:"Cancel"})]})]})})},ei=a(20831),et=a(47323),es=a(21626),en=a(97214),eo=a(28241),ed=a(58834),ec=a(69552),eu=a(71876),em=a(74998),ep=a(44633),eg=a(86462),ex=a(49084),eh=a(1309),ef=a(71594),ej=a(24525),ev=a(64482),e_=a(63709);let{Title:ey,Text:eb}=c.default,{Option:eN}=u.default;var eS=e=>{var l;let{visible:a,onClose:r,accessToken:i,onSuccess:n,guardrailId:c,initialValues:m}=e,[g]=p.Z.useForm(),[h,f]=(0,s.useState)(!1),[_,y]=(0,s.useState)((null==m?void 0:m.provider)||null),[b,S]=(0,s.useState)(null),[k,w]=(0,s.useState)([]),[I,P]=(0,s.useState)({});(0,s.useEffect)(()=>{(async()=>{try{if(!i)return;let e=await (0,d.getGuardrailUISettings)(i);S(e)}catch(e){console.error("Error fetching guardrail settings:",e),Q.Z.fromBackend("Failed to load guardrail settings")}})()},[i]),(0,s.useEffect)(()=>{(null==m?void 0:m.pii_entities_config)&&Object.keys(m.pii_entities_config).length>0&&(w(Object.keys(m.pii_entities_config)),P(m.pii_entities_config))},[m]);let Z=e=>{w(l=>l.includes(e)?l.filter(l=>l!==e):[...l,e])},C=(e,l)=>{P(a=>({...a,[e]:l}))},O=async()=>{try{f(!0);let e=await g.validateFields(),l=v[e.provider],a={guardrail_id:c,guardrail:{guardrail_name:e.guardrail_name,litellm_params:{guardrail:l,mode:e.mode,default_on:e.default_on},guardrail_info:{}}};if("PresidioPII"===e.provider&&k.length>0){let e={};k.forEach(l=>{e[l]=I[l]||"MASK"}),a.guardrail.litellm_params.pii_entities_config=e}else if(e.config)try{let l=JSON.parse(e.config);"Bedrock"===e.provider&&l?(l.guardrail_id&&(a.guardrail.litellm_params.guardrailIdentifier=l.guardrail_id),l.guardrail_version&&(a.guardrail.litellm_params.guardrailVersion=l.guardrail_version)):a.guardrail.guardrail_info=l}catch(e){Q.Z.fromBackend("Invalid JSON in configuration"),f(!1);return}if(!i)throw Error("No access token available");console.log("Sending guardrail update data:",JSON.stringify(a));let t=await fetch("/guardrails/".concat(c),{method:"PUT",headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok){let e=await t.text();throw Error(e||"Failed to update guardrail")}Q.Z.success("Guardrail updated successfully"),n(),r()}catch(e){console.error("Failed to update guardrail:",e),Q.Z.fromBackend("Failed to update guardrail: "+(e instanceof Error?e.message:String(e)))}finally{f(!1)}},A=()=>b&&_&&"PresidioPII"===_?(0,t.jsx)(D,{entities:b.supported_entities,actions:b.supported_actions,selectedEntities:k,selectedActions:I,onEntitySelect:Z,onActionSelect:C,entityCategories:b.pii_entity_categories}):null;return(0,t.jsx)(o.Z,{title:"Edit Guardrail",open:a,onCancel:r,footer:null,width:700,children:(0,t.jsxs)(p.Z,{form:g,layout:"vertical",initialValues:m,children:[(0,t.jsx)(p.Z.Item,{name:"guardrail_name",label:"Guardrail Name",rules:[{required:!0,message:"Please enter a guardrail name"}],children:(0,t.jsx)(x.o,{placeholder:"Enter a name for this guardrail"})}),(0,t.jsx)(p.Z.Item,{name:"provider",label:"Guardrail Provider",rules:[{required:!0,message:"Please select a provider"}],children:(0,t.jsx)(u.default,{placeholder:"Select a guardrail provider",onChange:e=>{y(e),g.setFieldsValue({config:void 0}),w([]),P({})},disabled:!0,optionLabelProp:"label",children:Object.entries(j()).map(e=>{let[l,a]=e;return(0,t.jsx)(eN,{value:l,label:a,children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[N[a]&&(0,t.jsx)("img",{src:N[a],alt:"",style:{height:"20px",width:"20px",marginRight:"8px",objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}}),(0,t.jsx)("span",{children:a})]})},l)})})}),(0,t.jsx)(p.Z.Item,{name:"mode",label:"Mode",tooltip:"How the guardrail should be applied",rules:[{required:!0,message:"Please select a mode"}],children:(0,t.jsx)(u.default,{children:(null==b?void 0:null===(l=b.supported_modes)||void 0===l?void 0:l.map(e=>(0,t.jsx)(eN,{value:e,children:e},e)))||(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eN,{value:"pre_call",children:"pre_call"}),(0,t.jsx)(eN,{value:"post_call",children:"post_call"})]})})}),(0,t.jsx)(p.Z.Item,{name:"default_on",label:"Always On",tooltip:"If enabled, this guardrail will be applied to all requests by default",valuePropName:"checked",children:(0,t.jsx)(e_.Z,{})}),(()=>{if(!_)return null;if("PresidioPII"===_)return A();switch(_){case"Aporia":return(0,t.jsx)(p.Z.Item,{label:"Aporia Configuration",name:"config",tooltip:"JSON configuration for Aporia",children:(0,t.jsx)(ev.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_aporia_api_key",\n  "project_name": "your_project_name"\n}'})});case"AimSecurity":return(0,t.jsx)(p.Z.Item,{label:"Aim Security Configuration",name:"config",tooltip:"JSON configuration for Aim Security",children:(0,t.jsx)(ev.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_aim_api_key"\n}'})});case"Bedrock":return(0,t.jsx)(p.Z.Item,{label:"Amazon Bedrock Configuration",name:"config",tooltip:"JSON configuration for Amazon Bedrock guardrails",children:(0,t.jsx)(ev.default.TextArea,{rows:4,placeholder:'{\n  "guardrail_id": "your_guardrail_id",\n  "guardrail_version": "your_guardrail_version"\n}'})});case"GuardrailsAI":return(0,t.jsx)(p.Z.Item,{label:"Guardrails.ai Configuration",name:"config",tooltip:"JSON configuration for Guardrails.ai",children:(0,t.jsx)(ev.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_guardrails_api_key",\n  "guardrail_id": "your_guardrail_id"\n}'})});case"LakeraAI":return(0,t.jsx)(p.Z.Item,{label:"Lakera AI Configuration",name:"config",tooltip:"JSON configuration for Lakera AI",children:(0,t.jsx)(ev.default.TextArea,{rows:4,placeholder:'{\n  "api_key": "your_lakera_api_key"\n}'})});case"PromptInjection":return(0,t.jsx)(p.Z.Item,{label:"Prompt Injection Configuration",name:"config",tooltip:"JSON configuration for prompt injection detection",children:(0,t.jsx)(ev.default.TextArea,{rows:4,placeholder:'{\n  "threshold": 0.8\n}'})});default:return(0,t.jsx)(p.Z.Item,{label:"Custom Configuration",name:"config",tooltip:"JSON configuration for your custom guardrail",children:(0,t.jsx)(ev.default.TextArea,{rows:4,placeholder:'{\n  "key1": "value1",\n  "key2": "value2"\n}'})})}})(),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,t.jsx)(x.z,{variant:"secondary",onClick:r,children:"Cancel"}),(0,t.jsx)(x.z,{onClick:O,loading:h,children:"Update Guardrail"})]})]})})},ek=e=>{let{guardrailsList:l,isLoading:a,onDeleteClick:r,accessToken:i,onGuardrailUpdated:n,isAdmin:o=!1,onGuardrailClick:d}=e,[c,u]=(0,s.useState)([{id:"created_at",desc:!0}]),[m,p]=(0,s.useState)(!1),[g,x]=(0,s.useState)(null),h=e=>e?new Date(e).toLocaleString():"-",f=[{header:"Guardrail ID",accessorKey:"guardrail_id",cell:e=>(0,t.jsx)(w.Z,{title:String(e.getValue()||""),children:(0,t.jsx)(ei.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>e.getValue()&&d(e.getValue()),children:e.getValue()?"".concat(String(e.getValue()).slice(0,7),"..."):""})})},{header:"Name",accessorKey:"guardrail_name",cell:e=>{let{row:l}=e,a=l.original;return(0,t.jsx)(w.Z,{title:a.guardrail_name,children:(0,t.jsx)("span",{className:"text-xs font-medium",children:a.guardrail_name||"-"})})}},{header:"Provider",accessorKey:"litellm_params.guardrail",cell:e=>{let{row:l}=e,{logo:a,displayName:r}=S(l.original.litellm_params.guardrail);return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[a&&(0,t.jsx)("img",{src:a,alt:"".concat(r," logo"),className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,t.jsx)("span",{className:"text-xs",children:r})]})}},{header:"Mode",accessorKey:"litellm_params.mode",cell:e=>{let{row:l}=e,a=l.original;return(0,t.jsx)("span",{className:"text-xs",children:a.litellm_params.mode})}},{header:"Default On",accessorKey:"litellm_params.default_on",cell:e=>{var l,a;let{row:r}=e,i=r.original;return(0,t.jsx)(eh.C,{color:(null===(l=i.litellm_params)||void 0===l?void 0:l.default_on)?"green":"gray",className:"text-xs font-normal",size:"xs",children:(null===(a=i.litellm_params)||void 0===a?void 0:a.default_on)?"Default On":"Default Off"})}},{header:"Created At",accessorKey:"created_at",cell:e=>{let{row:l}=e,a=l.original;return(0,t.jsx)(w.Z,{title:a.created_at,children:(0,t.jsx)("span",{className:"text-xs",children:h(a.created_at)})})}},{header:"Updated At",accessorKey:"updated_at",cell:e=>{let{row:l}=e,a=l.original;return(0,t.jsx)(w.Z,{title:a.updated_at,children:(0,t.jsx)("span",{className:"text-xs",children:h(a.updated_at)})})}},{id:"actions",header:"",cell:e=>{let{row:l}=e,a=l.original;return(0,t.jsx)("div",{className:"flex space-x-2",children:(0,t.jsx)(et.Z,{icon:em.Z,size:"sm",onClick:()=>a.guardrail_id&&r(a.guardrail_id,a.guardrail_name||"Unnamed Guardrail"),className:"cursor-pointer hover:text-red-500",tooltip:"Delete guardrail"})})}}],j=(0,ef.b7)({data:l,columns:f,state:{sorting:c},onSortingChange:u,getCoreRowModel:(0,ej.sC)(),getSortedRowModel:(0,ej.tj)(),enableSorting:!0});return(0,t.jsxs)("div",{className:"rounded-lg custom-border relative",children:[(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(es.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,t.jsx)(ed.Z,{children:j.getHeaderGroups().map(e=>(0,t.jsx)(eu.Z,{children:e.headers.map(e=>(0,t.jsx)(ec.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,ef.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,t.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,t.jsx)(ep.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,t.jsx)(eg.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,t.jsx)(ex.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,t.jsx)(en.Z,{children:a?(0,t.jsx)(eu.Z,{children:(0,t.jsx)(eo.Z,{colSpan:f.length,className:"h-8 text-center",children:(0,t.jsx)("div",{className:"text-center text-gray-500",children:(0,t.jsx)("p",{children:"Loading..."})})})}):l.length>0?j.getRowModel().rows.map(e=>(0,t.jsx)(eu.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,t.jsx)(eo.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,ef.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,t.jsx)(eu.Z,{children:(0,t.jsx)(eo.Z,{colSpan:f.length,className:"h-8 text-center",children:(0,t.jsx)("div",{className:"text-center text-gray-500",children:(0,t.jsx)("p",{children:"No guardrails found"})})})})})]})}),g&&(0,t.jsx)(eS,{visible:m,onClose:()=>p(!1),accessToken:i,onSuccess:()=>{p(!1),x(null),n()},guardrailId:g.guardrail_id||"",initialValues:{guardrail_name:g.guardrail_name||"",provider:Object.keys(v).find(e=>v[e]===(null==g?void 0:g.litellm_params.guardrail))||"",mode:g.litellm_params.mode,default_on:g.litellm_params.default_on,pii_entities_config:g.litellm_params.pii_entities_config,...g.guardrail_info}})]})},ew=a(20347),eI=a(30078),eP=a(23496),eZ=a(10900),eC=a(59872),eO=a(30401),eA=a(78867),eE=e=>{var l,a,r,i,n,o,c,m,g,x,h;let{guardrailId:f,onClose:j,accessToken:_,isAdmin:y}=e,[b,N]=(0,s.useState)(null),[k,w]=(0,s.useState)(null),[P,Z]=(0,s.useState)(!0),[C,O]=(0,s.useState)(!1),[A]=p.Z.useForm(),[E,G]=(0,s.useState)([]),[L,F]=(0,s.useState)({}),[z,T]=(0,s.useState)(null),[M,B]=(0,s.useState)({}),J=async()=>{try{var e;if(Z(!0),!_)return;let l=await (0,d.getGuardrailInfo)(_,f);if(N(l),null===(e=l.litellm_params)||void 0===e?void 0:e.pii_entities_config){let e=l.litellm_params.pii_entities_config;if(G([]),F({}),Object.keys(e).length>0){let l=[],a={};Object.entries(e).forEach(e=>{let[r,i]=e;l.push(r),a[r]="string"==typeof i?i:"MASK"}),G(l),F(a)}}else G([]),F({})}catch(e){Q.Z.fromBackend("Failed to load guardrail information"),console.error("Error fetching guardrail info:",e)}finally{Z(!1)}},V=async()=>{try{if(!_)return;let e=await (0,d.getGuardrailProviderSpecificParams)(_);w(e)}catch(e){console.error("Error fetching guardrail provider specific params:",e)}},K=async()=>{try{if(!_)return;let e=await (0,d.getGuardrailUISettings)(_);T(e)}catch(e){console.error("Error fetching guardrail UI settings:",e)}};(0,s.useEffect)(()=>{V()},[_]),(0,s.useEffect)(()=>{J(),K()},[f,_]),(0,s.useEffect)(()=>{if(b&&A){var e;A.setFieldsValue({guardrail_name:b.guardrail_name,...b.litellm_params,guardrail_info:b.guardrail_info?JSON.stringify(b.guardrail_info,null,2):"",...(null===(e=b.litellm_params)||void 0===e?void 0:e.optional_params)&&{optional_params:b.litellm_params.optional_params}})}},[b,k,A]);let R=async e=>{try{var l,a,r;if(!_)return;let i={litellm_params:{}};e.guardrail_name!==b.guardrail_name&&(i.guardrail_name=e.guardrail_name),e.default_on!==(null===(l=b.litellm_params)||void 0===l?void 0:l.default_on)&&(i.litellm_params.default_on=e.default_on);let t=b.guardrail_info,s=e.guardrail_info?JSON.parse(e.guardrail_info):void 0;JSON.stringify(t)!==JSON.stringify(s)&&(i.guardrail_info=s);let n=(null===(a=b.litellm_params)||void 0===a?void 0:a.pii_entities_config)||{},o={};E.forEach(e=>{o[e]=L[e]||"MASK"}),JSON.stringify(n)!==JSON.stringify(o)&&(i.litellm_params.pii_entities_config=o);let c=Object.keys(v).find(e=>{var l;return v[e]===(null===(l=b.litellm_params)||void 0===l?void 0:l.guardrail)});if(console.log("values: ",JSON.stringify(e)),console.log("currentProvider: ",c),k&&c){let l=k[null===(r=v[c])||void 0===r?void 0:r.toLowerCase()]||{},a=new Set;console.log("providerSpecificParams: ",JSON.stringify(l)),Object.keys(l).forEach(e=>{"optional_params"!==e&&a.add(e)}),l.optional_params&&l.optional_params.fields&&Object.keys(l.optional_params.fields).forEach(e=>{a.add(e)}),console.log("allowedParams: ",a),a.forEach(l=>{var a,r;let t=e[l];(null==t||""===t)&&(t=null===(r=e.optional_params)||void 0===r?void 0:r[l]);let s=null===(a=b.litellm_params)||void 0===a?void 0:a[l];JSON.stringify(t)!==JSON.stringify(s)&&(null!=t&&""!==t?i.litellm_params[l]=t:null!=s&&""!==s&&(i.litellm_params[l]=null))})}if(0===Object.keys(i.litellm_params).length&&delete i.litellm_params,0===Object.keys(i).length){Q.Z.info("No changes detected"),O(!1);return}await (0,d.updateGuardrailCall)(_,f,i),Q.Z.success("Guardrail updated successfully"),J(),O(!1)}catch(e){console.error("Error updating guardrail:",e),Q.Z.fromBackend("Failed to update guardrail")}};if(P)return(0,t.jsx)("div",{className:"p-4",children:"Loading..."});if(!b)return(0,t.jsx)("div",{className:"p-4",children:"Guardrail not found"});let q=e=>e?new Date(e).toLocaleString():"-",{logo:H,displayName:W}=S((null===(l=b.litellm_params)||void 0===l?void 0:l.guardrail)||""),X=async(e,l)=>{await (0,eC.vQ)(e)&&(B(e=>({...e,[l]:!0})),setTimeout(()=>{B(e=>({...e,[l]:!1}))},2e3))};return(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(eI.zx,{icon:eZ.Z,variant:"light",onClick:j,className:"mb-4",children:"Back to Guardrails"}),(0,t.jsx)(eI.Dx,{children:b.guardrail_name||"Unnamed Guardrail"}),(0,t.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,t.jsx)(eI.xv,{className:"text-gray-500 font-mono",children:b.guardrail_id}),(0,t.jsx)(I.ZP,{type:"text",size:"small",icon:M["guardrail-id"]?(0,t.jsx)(eO.Z,{size:12}):(0,t.jsx)(eA.Z,{size:12}),onClick:()=>X(b.guardrail_id,"guardrail-id"),className:"left-2 z-10 transition-all duration-200 ".concat(M["guardrail-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),(0,t.jsxs)(eI.v0,{children:[(0,t.jsxs)(eI.td,{className:"mb-4",children:[(0,t.jsx)(eI.OK,{children:"Overview"},"overview"),y?(0,t.jsx)(eI.OK,{children:"Settings"},"settings"):(0,t.jsx)(t.Fragment,{})]}),(0,t.jsxs)(eI.nP,{children:[(0,t.jsxs)(eI.x4,{children:[(0,t.jsxs)(eI.rj,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,t.jsxs)(eI.Zb,{children:[(0,t.jsx)(eI.xv,{children:"Provider"}),(0,t.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[H&&(0,t.jsx)("img",{src:H,alt:"".concat(W," logo"),className:"w-6 h-6",onError:e=>{e.target.style.display="none"}}),(0,t.jsx)(eI.Dx,{children:W})]})]}),(0,t.jsxs)(eI.Zb,{children:[(0,t.jsx)(eI.xv,{children:"Mode"}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)(eI.Dx,{children:(null===(a=b.litellm_params)||void 0===a?void 0:a.mode)||"-"}),(0,t.jsx)(eI.Ct,{color:(null===(r=b.litellm_params)||void 0===r?void 0:r.default_on)?"green":"gray",children:(null===(i=b.litellm_params)||void 0===i?void 0:i.default_on)?"Default On":"Default Off"})]})]}),(0,t.jsxs)(eI.Zb,{children:[(0,t.jsx)(eI.xv,{children:"Created At"}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)(eI.Dx,{children:q(b.created_at)}),(0,t.jsxs)(eI.xv,{children:["Last Updated: ",q(b.updated_at)]})]})]})]}),(null===(n=b.litellm_params)||void 0===n?void 0:n.pii_entities_config)&&Object.keys(b.litellm_params.pii_entities_config).length>0&&(0,t.jsx)(eI.Zb,{className:"mt-6",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(eI.xv,{className:"font-medium",children:"PII Protection"}),(0,t.jsxs)(eI.Ct,{color:"blue",children:[Object.keys(b.litellm_params.pii_entities_config).length," PII entities configured"]})]})}),b.guardrail_info&&Object.keys(b.guardrail_info).length>0&&(0,t.jsxs)(eI.Zb,{className:"mt-6",children:[(0,t.jsx)(eI.xv,{children:"Guardrail Info"}),(0,t.jsx)("div",{className:"mt-2 space-y-2",children:Object.entries(b.guardrail_info).map(e=>{let[l,a]=e;return(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)(eI.xv,{className:"font-medium w-1/3",children:l}),(0,t.jsx)(eI.xv,{className:"w-2/3",children:"object"==typeof a?JSON.stringify(a,null,2):String(a)})]},l)})})]})]}),y&&(0,t.jsx)(eI.x4,{children:(0,t.jsxs)(eI.Zb,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)(eI.Dx,{children:"Guardrail Settings"}),!C&&(0,t.jsx)(eI.zx,{onClick:()=>O(!0),children:"Edit Settings"})]}),C?(0,t.jsxs)(p.Z,{form:A,onFinish:R,initialValues:{guardrail_name:b.guardrail_name,...b.litellm_params,guardrail_info:b.guardrail_info?JSON.stringify(b.guardrail_info,null,2):"",...(null===(o=b.litellm_params)||void 0===o?void 0:o.optional_params)&&{optional_params:b.litellm_params.optional_params}},layout:"vertical",children:[(0,t.jsx)(p.Z.Item,{label:"Guardrail Name",name:"guardrail_name",rules:[{required:!0,message:"Please input a guardrail name"}],children:(0,t.jsx)(eI.oi,{})}),(0,t.jsx)(p.Z.Item,{label:"Default On",name:"default_on",children:(0,t.jsxs)(u.default,{children:[(0,t.jsx)(u.default.Option,{value:!0,children:"Yes"}),(0,t.jsx)(u.default.Option,{value:!1,children:"No"})]})}),(null===(c=b.litellm_params)||void 0===c?void 0:c.guardrail)==="presidio"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eP.Z,{orientation:"left",children:"PII Protection"}),(0,t.jsx)("div",{className:"mb-6",children:z&&(0,t.jsx)(D,{entities:z.supported_entities,actions:z.supported_actions,selectedEntities:E,selectedActions:L,onEntitySelect:e=>{G(l=>l.includes(e)?l.filter(l=>l!==e):[...l,e])},onActionSelect:(e,l)=>{F(a=>({...a,[e]:l}))},entityCategories:z.pii_entity_categories})})]}),(0,t.jsx)(eP.Z,{orientation:"left",children:"Provider Settings"}),(0,t.jsx)(U,{selectedProvider:Object.keys(v).find(e=>{var l;return v[e]===(null===(l=b.litellm_params)||void 0===l?void 0:l.guardrail)})||null,accessToken:_,providerParams:k,value:b.litellm_params}),k&&(()=>{var e;let l=Object.keys(v).find(e=>{var l;return v[e]===(null===(l=b.litellm_params)||void 0===l?void 0:l.guardrail)});if(!l)return null;let a=k[null===(e=v[l])||void 0===e?void 0:e.toLowerCase()];return a&&a.optional_params?(0,t.jsx)(Y,{optionalParams:a.optional_params,parentFieldKey:"optional_params",values:b.litellm_params}):null})(),(0,t.jsx)(eP.Z,{orientation:"left",children:"Advanced Settings"}),(0,t.jsx)(p.Z.Item,{label:"Guardrail Information",name:"guardrail_info",children:(0,t.jsx)(ev.default.TextArea,{rows:5})}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,t.jsx)(I.ZP,{onClick:()=>O(!1),children:"Cancel"}),(0,t.jsx)(eI.zx,{children:"Save Changes"})]})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(eI.xv,{className:"font-medium",children:"Guardrail ID"}),(0,t.jsx)("div",{className:"font-mono",children:b.guardrail_id})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(eI.xv,{className:"font-medium",children:"Guardrail Name"}),(0,t.jsx)("div",{children:b.guardrail_name||"Unnamed Guardrail"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(eI.xv,{className:"font-medium",children:"Provider"}),(0,t.jsx)("div",{children:W})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(eI.xv,{className:"font-medium",children:"Mode"}),(0,t.jsx)("div",{children:(null===(m=b.litellm_params)||void 0===m?void 0:m.mode)||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(eI.xv,{className:"font-medium",children:"Default On"}),(0,t.jsx)(eI.Ct,{color:(null===(g=b.litellm_params)||void 0===g?void 0:g.default_on)?"green":"gray",children:(null===(x=b.litellm_params)||void 0===x?void 0:x.default_on)?"Yes":"No"})]}),(null===(h=b.litellm_params)||void 0===h?void 0:h.pii_entities_config)&&Object.keys(b.litellm_params.pii_entities_config).length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)(eI.xv,{className:"font-medium",children:"PII Protection"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsxs)(eI.Ct,{color:"blue",children:[Object.keys(b.litellm_params.pii_entities_config).length," PII entities configured"]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(eI.xv,{className:"font-medium",children:"Created At"}),(0,t.jsx)("div",{children:q(b.created_at)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(eI.xv,{className:"font-medium",children:"Last Updated"}),(0,t.jsx)("div",{children:q(b.updated_at)})]})]})]})})]})]})]})},eG=e=>{let{accessToken:l,userRole:a}=e,[r,i]=(0,s.useState)([]),[c,u]=(0,s.useState)(!1),[m,p]=(0,s.useState)(!1),[g,x]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null),[j,v]=(0,s.useState)(null),_=!!a&&(0,ew.tY)(a),y=async()=>{if(l){p(!0);try{let e=await (0,d.getGuardrailsList)(l);console.log("guardrails: ".concat(JSON.stringify(e))),i(e.guardrails)}catch(e){console.error("Error fetching guardrails:",e)}finally{p(!1)}}};(0,s.useEffect)(()=>{y()},[l]);let b=async()=>{if(h&&l){x(!0);try{await (0,d.deleteGuardrailCall)(l,h.id),Q.Z.success('Guardrail "'.concat(h.name,'" deleted successfully')),y()}catch(e){console.error("Error deleting guardrail:",e),Q.Z.fromBackend("Failed to delete guardrail")}finally{x(!1),f(null)}}};return(0,t.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,t.jsx)(n.z,{onClick:()=>{j&&v(null),u(!0)},disabled:!l,children:"+ Add New Guardrail"})}),j?(0,t.jsx)(eE,{guardrailId:j,onClose:()=>v(null),accessToken:l,isAdmin:_}):(0,t.jsx)(ek,{guardrailsList:r,isLoading:m,onDeleteClick:(e,l)=>{f({id:e,name:l})},accessToken:l,onGuardrailUpdated:y,isAdmin:_,onGuardrailClick:e=>v(e)}),(0,t.jsx)(er,{visible:c,onClose:()=>{u(!1)},accessToken:l,onSuccess:()=>{y()}}),h&&(0,t.jsxs)(o.Z,{title:"Delete Guardrail",open:null!==h,onOk:b,onCancel:()=>{f(null)},confirmLoading:g,okText:"Delete",okButtonProps:{danger:!0},children:[(0,t.jsxs)("p",{children:["Are you sure you want to delete guardrail: ",h.name," ?"]}),(0,t.jsx)("p",{children:"This action cannot be undone."})]})]})}}}]);