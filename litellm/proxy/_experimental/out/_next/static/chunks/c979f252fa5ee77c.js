(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,964306,e=>{"use strict";var t=e.i(271645);let s=t.forwardRef(function(e,s){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:s},e),t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"}))});e.s(["XCircleIcon",0,s],964306)},743151,(e,t,s)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(s,"__esModule",{value:!0}),s.CopyToClipboard=void 0;var l=n(e.r(271645)),a=n(e.r(844343)),i=["text","onCopy","options","children"];function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach(function(t){x(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var h=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&c(o,e);var t,s,n=(t=function(){if("u"<typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,s=u(o);return e=t?Reflect.construct(s,arguments,u(this).constructor):s.apply(this,arguments),function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return m(e)}(this,e)});function o(){var e;if(!(this instanceof o))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,s=Array(t),r=0;r<t;r++)s[r]=arguments[r];return x(m(e=n.call.apply(n,[this].concat(s))),"onClick",function(t){var s=e.props,r=s.text,i=s.onCopy,n=s.children,o=s.options,d=l.default.Children.only(n),c=(0,a.default)(r,o);i&&i(r,c),d&&d.props&&"function"==typeof d.props.onClick&&d.props.onClick(t)}),e}return s=[{key:"render",value:function(){var e=this.props,t=(e.text,e.onCopy,e.options,e.children),s=function(e,t){if(null==e)return{};var s,r,l=function(e,t){if(null==e)return{};var s,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)s=a[r],t.indexOf(s)>=0||(l[s]=e[s]);return l}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)s=a[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(l[s]=e[s])}return l}(e,i),r=l.default.Children.only(t);return l.default.cloneElement(r,d(d({},s),{},{onClick:this.onClick}))}}],function(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(o.prototype,s),Object.defineProperty(o,"prototype",{writable:!1}),o}(l.default.PureComponent);s.CopyToClipboard=h,x(h,"defaultProps",{onCopy:void 0,options:void 0})},237016,(e,t,s)=>{"use strict";var r=e.r(743151).CopyToClipboard;r.CopyToClipboard=r,t.exports=r},371455,172372,e=>{"use strict";var t=e.i(843476),s=e.i(827252),r=e.i(213205),l=e.i(912598),a=e.i(677667),i=e.i(130643),n=e.i(898667),o=e.i(994388),d=e.i(35983),c=e.i(779241),m=e.i(560445),u=e.i(464571),x=e.i(808613),h=e.i(311451),p=e.i(212931),f=e.i(199133),g=e.i(770914),j=e.i(592968),y=e.i(898586),b=e.i(271645),v=e.i(599724),w=e.i(291542),N=e.i(515831),_=e.i(519756),C=e.i(737434),S=e.i(285027),k=e.i(993914),O=e.i(955135);e.i(247167);var T=e.i(931067);let I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM472 744a40 40 0 1080 0 40 40 0 10-80 0zm16-104h48c4.4 0 8-3.6 8-8V448c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v184c0 4.4 3.6 8 8 8z"}}]},name:"file-exclamation",theme:"outlined"};var U=e.i(9583),P=b.forwardRef(function(e,t){return b.createElement(U.default,(0,T.default)({},e,{ref:t,icon:I}))}),B=e.i(764205),V=e.i(59935),L=e.i(220508),E=e.i(964306);let R=b.forwardRef(function(e,t){return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"}))});var F=e.i(237016),M=e.i(727749);let D=({accessToken:e,teams:s,possibleUIRoles:r,onUsersCreated:l})=>{let[a,i]=(0,b.useState)(!1),[n,d]=(0,b.useState)([]),[c,m]=(0,b.useState)(!1),[u,x]=(0,b.useState)(null),[h,f]=(0,b.useState)(null),[g,j]=(0,b.useState)(null),[T,I]=(0,b.useState)(null),[U,D]=(0,b.useState)(null),[A,$]=(0,b.useState)("http://localhost:4000");(0,b.useEffect)(()=>{(async()=>{try{let t=await (0,B.getProxyUISettings)(e);D(t)}catch(e){console.error("Error fetching UI settings:",e)}})(),$(new URL("/",window.location.href).toString())},[e]);let z=async()=>{m(!0);let t=n.map(e=>({...e,status:"pending"}));d(t);let s=!1;for(let r=0;r<t.length;r++){let l=t[r];try{let t={user_email:l.user_email,user_role:l.user_role};if(l.teams&&"string"==typeof l.teams&&""!==l.teams.trim()&&(t.teams=l.teams.split(",").map(e=>e.trim()).filter(Boolean),0===t.teams.length&&delete t.teams),l.models&&"string"==typeof l.models&&""!==l.models.trim()&&(t.models=l.models.split(",").map(e=>e.trim()).filter(Boolean),0===t.models.length&&delete t.models),l.max_budget&&""!==l.max_budget.toString().trim()){let e=parseFloat(l.max_budget.toString());!isNaN(e)&&e>0&&(t.max_budget=e)}l.budget_duration&&""!==l.budget_duration.trim()&&(t.budget_duration=l.budget_duration.trim()),l.metadata&&"string"==typeof l.metadata&&""!==l.metadata.trim()&&(t.metadata=l.metadata.trim()),console.log("Sending user data:",t);let a=await (0,B.userCreateCall)(e,null,t);if(console.log("Full response:",a),a&&(a.key||a.user_id)){s=!0,console.log("Success case triggered");let t=a.data?.user_id||a.user_id;try{if(U?.SSO_ENABLED){let e=new URL("/ui",A).toString();d(t=>t.map((t,s)=>s===r?{...t,status:"success",key:a.key||a.user_id,invitation_link:e}:t))}else{let s=await (0,B.invitationCreateCall)(e,t),l=new URL(`/ui?invitation_id=${s.id}`,A).toString();d(e=>e.map((e,t)=>t===r?{...e,status:"success",key:a.key||a.user_id,invitation_link:l}:e))}}catch(e){console.error("Error creating invitation:",e),d(e=>e.map((e,t)=>t===r?{...e,status:"success",key:a.key||a.user_id,error:"User created but failed to generate invitation link"}:e))}}else{console.log("Error case triggered");let e=a?.error||"Failed to create user";console.log("Error message:",e),d(t=>t.map((t,s)=>s===r?{...t,status:"failed",error:e}:t))}}catch(t){console.error("Caught error:",t);let e=t?.response?.data?.error||t?.message||String(t);d(t=>t.map((t,s)=>s===r?{...t,status:"failed",error:e}:t))}}m(!1),s&&l&&l()},q=[{title:"Row",dataIndex:"rowNumber",key:"rowNumber",width:80},{title:"Email",dataIndex:"user_email",key:"user_email"},{title:"Role",dataIndex:"user_role",key:"user_role"},{title:"Teams",dataIndex:"teams",key:"teams"},{title:"Budget",dataIndex:"max_budget",key:"max_budget"},{title:"Status",key:"status",render:(e,s)=>s.isValid?s.status&&"pending"!==s.status?"success"===s.status?(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(L.CheckCircleIcon,{className:"h-5 w-5 text-green-500 mr-2"}),(0,t.jsx)("span",{className:"text-green-500",children:"Success"})]}),s.invitation_link&&(0,t.jsx)("div",{className:"mt-1",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:s.invitation_link}),(0,t.jsx)(F.CopyToClipboard,{text:s.invitation_link,onCopy:()=>M.default.success("Invitation link copied!"),children:(0,t.jsx)("button",{className:"ml-1 text-blue-500 text-xs hover:text-blue-700",children:"Copy"})})]})})]}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(E.XCircleIcon,{className:"h-5 w-5 text-red-500 mr-2"}),(0,t.jsx)("span",{className:"text-red-500",children:"Failed"})]}),s.error&&(0,t.jsx)("span",{className:"text-sm text-red-500 ml-7",children:JSON.stringify(s.error)})]}):(0,t.jsx)("span",{className:"text-gray-500",children:"Pending"}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(E.XCircleIcon,{className:"h-5 w-5 text-red-500 mr-2"}),(0,t.jsx)("span",{className:"text-red-500",children:"Invalid"})]}),s.error&&(0,t.jsx)("span",{className:"text-sm text-red-500 ml-7",children:s.error})]})}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Button,{className:"mb-0",onClick:()=>i(!0),children:"+ Bulk Invite Users"}),(0,t.jsx)(p.Modal,{title:"Bulk Invite Users",open:a,width:800,onCancel:()=>i(!1),bodyStyle:{maxHeight:"70vh",overflow:"auto"},footer:null,children:(0,t.jsx)("div",{className:"flex flex-col",children:0===n.length?(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"1"}),(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Download and fill the template"})]}),(0,t.jsxs)("div",{className:"ml-11 mb-6",children:[(0,t.jsx)("p",{className:"mb-4",children:"Add multiple users at once by following these steps:"}),(0,t.jsxs)("ol",{className:"list-decimal list-inside space-y-2 ml-2 mb-4",children:[(0,t.jsx)("li",{children:"Download our CSV template"}),(0,t.jsx)("li",{children:"Add your users' information to the spreadsheet"}),(0,t.jsx)("li",{children:"Save the file and upload it here"}),(0,t.jsx)("li",{children:"After creation, download the results file containing the Virtual Keys for each user"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md border border-gray-200 mb-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Template Column Names"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"user_email"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"User's email address (required)"})]})]}),(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 mt-1.5 mr-2 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"user_role"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:'User\'s role (one of: "proxy_admin", "proxy_admin_viewer", "internal_user", "internal_user_viewer")'})]})]}),(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"teams"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated team IDs (e.g., "team-1,team-2")'})]})]}),(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"max_budget"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:'Maximum budget as a number (e.g., "100")'})]})]}),(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"budget_duration"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:'Budget reset period (e.g., "30d", "1mo")'})]})]}),(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-300 mt-1.5 mr-2 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"models"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:'Comma-separated allowed models (e.g., "gpt-3.5-turbo,gpt-4")'})]})]})]})]}),(0,t.jsxs)(o.Button,{onClick:()=>{let e=new Blob([V.default.unparse([["user_email","user_role","teams","max_budget","budget_duration","models"],["user@example.com","internal_user","team-id-1,team-id-2","100","30d","gpt-3.5-turbo,gpt-4"]])],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="bulk_users_template.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(t)},size:"lg",className:"w-full md:w-auto",children:[(0,t.jsx)(C.DownloadOutlined,{className:"mr-2"})," Download CSV Template"]})]}),(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"2"}),(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Upload your completed CSV"})]}),(0,t.jsxs)("div",{className:"ml-11",children:[T?(0,t.jsxs)("div",{className:`mb-4 p-4 rounded-md border ${g?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[g?(0,t.jsx)(P,{className:"text-red-500 text-xl mr-3"}):(0,t.jsx)(k.FileTextOutlined,{className:"text-blue-500 text-xl mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Typography.Text,{strong:!0,className:g?"text-red-800":"text-blue-800",children:T.name}),(0,t.jsxs)(y.Typography.Text,{className:`block text-xs ${g?"text-red-600":"text-blue-600"}`,children:[(T.size/1024).toFixed(1)," KB â€¢ ",new Date().toLocaleDateString()]})]})]}),(0,t.jsxs)(o.Button,{size:"xs",variant:"secondary",onClick:()=>{I(null),d([]),x(null),f(null),j(null)},className:"flex items-center",children:[(0,t.jsx)(O.DeleteOutlined,{className:"mr-1"})," Remove"]})]}),g?(0,t.jsxs)("div",{className:"mt-3 text-red-600 text-sm flex items-start",children:[(0,t.jsx)(S.WarningOutlined,{className:"mr-2 mt-0.5"}),(0,t.jsx)("span",{children:g})]}):!h&&(0,t.jsxs)("div",{className:"mt-3 flex items-center",children:[(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,t.jsx)("div",{className:"bg-blue-500 h-1.5 rounded-full w-full animate-pulse"})}),(0,t.jsx)("span",{className:"ml-2 text-xs text-blue-600",children:"Processing..."})]})]}):(0,t.jsx)(N.Upload,{beforeUpload:e=>((x(null),f(null),j(null),I(e),"text/csv"===e.type||e.name.endsWith(".csv"))?e.size>5242880?j(`File is too large (${(e.size/1048576).toFixed(1)} MB). Please upload a CSV file smaller than 5MB.`):V.default.parse(e,{complete:e=>{if(!e.data||0===e.data.length){f("The CSV file appears to be empty. Please upload a file with data."),d([]);return}if(1===e.data.length){f("The CSV file only contains headers but no user data. Please add user data to your CSV."),d([]);return}let t=e.data[0];if(0===t.length||1===t.length&&""===t[0]){f("The CSV file doesn't contain any column headers. Please make sure your CSV has headers."),d([]);return}let r=["user_email","user_role"].filter(e=>!t.includes(e));if(r.length>0){f(`Your CSV is missing these required columns: ${r.join(", ")}. Please add these columns to your CSV file.`),d([]);return}try{let r=e.data.slice(1).map((e,r)=>{if(0===e.length||1===e.length&&""===e[0])return null;if(e.length<t.length)return{rowNumber:r+2,isValid:!1,error:`Row ${r+2} has fewer columns than the header row. Please ensure all data is properly formatted.`,user_email:"",user_role:""};let l={user_email:e[t.indexOf("user_email")]?.trim()||"",user_role:e[t.indexOf("user_role")]?.trim()||"",teams:e[t.indexOf("teams")]?.trim(),max_budget:e[t.indexOf("max_budget")]?.trim(),budget_duration:e[t.indexOf("budget_duration")]?.trim(),models:e[t.indexOf("models")]?.trim(),rowNumber:r+2,isValid:!0,error:""},a=[];if(l.user_email?l.user_email.includes("@")&&l.user_email.includes(".")||a.push("Invalid email format (must contain @ and domain)"):a.push("Email is required"),l.user_role){let e=["proxy_admin","proxy_admin_viewer","internal_user","internal_user_viewer"];e.includes(l.user_role)||a.push(`Invalid role "${l.user_role}". Must be one of: ${e.join(", ")}`)}else a.push("Role is required");if(l.max_budget&&""!==l.max_budget.toString().trim()&&(isNaN(parseFloat(l.max_budget.toString()))?a.push(`Max budget "${l.max_budget}" must be a number`):0>=parseFloat(l.max_budget.toString())&&a.push("Max budget must be greater than 0")),l.budget_duration&&!l.budget_duration.match(/^\d+[dhmwy]$|^\d+mo$/)&&a.push(`Invalid budget duration format "${l.budget_duration}". Use format like "30d", "1mo", "2w", "6h"`),l.teams&&"string"==typeof l.teams&&s&&s.length>0){let e=s.map(e=>e.team_id),t=l.teams.split(",").map(e=>e.trim()).filter(t=>!e.includes(t));t.length>0&&a.push(`Unknown team(s): ${t.join(", ")}`)}return a.length>0&&(l.isValid=!1,l.error=a.join(", ")),l}).filter(Boolean),l=r.filter(e=>e.isValid);d(r),0===r.length?f("No valid data rows found in the CSV file. Please check your file format."):0===l.length?x("No valid users found in the CSV. Please check the errors below and fix your CSV file."):l.length<r.length?x(`Found ${r.length-l.length} row(s) with errors out of ${r.length} total rows. Please correct them before proceeding.`):M.default.success(`Successfully parsed ${l.length} users`)}catch(t){let e=t instanceof Error?t.message:"Unknown error";x(`Error parsing CSV: ${e}`),d([])}},error:e=>{x(`Failed to parse CSV file: ${e.message}`),d([])},header:!1}):(j(`Invalid file type: ${e.name}. Please upload a CSV file (.csv extension).`),M.default.fromBackend("Invalid file type. Please upload a CSV file.")),!1),accept:".csv",maxCount:1,showUploadList:!1,children:(0,t.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-colors cursor-pointer",children:[(0,t.jsx)(_.UploadOutlined,{className:"text-3xl text-gray-400 mb-2"}),(0,t.jsx)("p",{className:"mb-1",children:"Drag and drop your CSV file here"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"or"}),(0,t.jsx)(o.Button,{size:"sm",children:"Browse files"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"Only CSV files (.csv) are supported"})]})}),h&&(0,t.jsx)("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)(R,{className:"h-5 w-5 text-yellow-500 mr-2 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Typography.Text,{strong:!0,className:"text-yellow-800",children:"CSV Structure Error"}),(0,t.jsx)(y.Typography.Paragraph,{className:"text-yellow-700 mt-1 mb-0",children:h}),(0,t.jsx)(y.Typography.Paragraph,{className:"text-yellow-700 mt-2 mb-0",children:"Please download our template and ensure your CSV follows the required format."})]})]})})]})]}):(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:"3"}),(0,t.jsx)("h3",{className:"text-lg font-medium",children:n.some(e=>"success"===e.status||"failed"===e.status)?"User Creation Results":"Review and create users"})]}),u&&(0,t.jsx)("div",{className:"ml-11 mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)(S.WarningOutlined,{className:"text-red-500 mr-2 mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Text,{className:"text-red-600 font-medium",children:u}),n.some(e=>!e.isValid)&&(0,t.jsxs)("ul",{className:"mt-2 list-disc list-inside text-red-600 text-sm",children:[(0,t.jsx)("li",{children:"Check the table below for specific errors in each row"}),(0,t.jsx)("li",{children:"Common issues include invalid email formats, missing required fields, or incorrect role values"}),(0,t.jsx)("li",{children:"Fix these issues in your CSV file and upload again"})]})]})]})}),(0,t.jsxs)("div",{className:"ml-11",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,t.jsx)("div",{className:"flex items-center",children:n.some(e=>"success"===e.status||"failed"===e.status)?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(v.Text,{className:"text-lg font-medium mr-3",children:"Creation Summary"}),(0,t.jsxs)(v.Text,{className:"text-sm bg-green-100 text-green-800 px-2 py-1 rounded mr-2",children:[n.filter(e=>"success"===e.status).length," Successful"]}),n.some(e=>"failed"===e.status)&&(0,t.jsxs)(v.Text,{className:"text-sm bg-red-100 text-red-800 px-2 py-1 rounded",children:[n.filter(e=>"failed"===e.status).length," Failed"]})]}):(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(v.Text,{className:"text-lg font-medium mr-3",children:"User Preview"}),(0,t.jsxs)(v.Text,{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded",children:[n.filter(e=>e.isValid).length," of ",n.length," users valid"]})]})}),!n.some(e=>"success"===e.status||"failed"===e.status)&&(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)(o.Button,{onClick:()=>{d([]),x(null)},variant:"secondary",children:"Back"}),(0,t.jsx)(o.Button,{onClick:z,disabled:0===n.filter(e=>e.isValid).length||c,children:c?"Creating...":`Create ${n.filter(e=>e.isValid).length} Users`})]})]}),n.some(e=>"success"===e.status)&&(0,t.jsx)("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"mr-3 mt-1",children:(0,t.jsx)(L.CheckCircleIcon,{className:"h-5 w-5 text-blue-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Text,{className:"font-medium text-blue-800",children:"User creation complete"}),(0,t.jsxs)(v.Text,{className:"block text-sm text-blue-700 mt-1",children:[(0,t.jsx)("span",{className:"font-medium",children:"Next step:"})," Download the credentials file containing Virtual Keys and invitation links. Users will need these Virtual Keys to make LLM requests through LiteLLM."]})]})]})}),(0,t.jsx)(w.Table,{dataSource:n,columns:q,size:"small",pagination:{pageSize:5},scroll:{y:300},rowClassName:e=>e.isValid?"":"bg-red-50"}),!n.some(e=>"success"===e.status||"failed"===e.status)&&(0,t.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,t.jsx)(o.Button,{onClick:()=>{d([]),x(null)},variant:"secondary",className:"mr-3",children:"Back"}),(0,t.jsx)(o.Button,{onClick:z,disabled:0===n.filter(e=>e.isValid).length||c,children:c?"Creating...":`Create ${n.filter(e=>e.isValid).length} Users`})]}),n.some(e=>"success"===e.status||"failed"===e.status)&&(0,t.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,t.jsx)(o.Button,{onClick:()=>{d([]),x(null)},variant:"secondary",className:"mr-3",children:"Start New Bulk Import"}),(0,t.jsxs)(o.Button,{onClick:()=>{let e=n.map(e=>({user_email:e.user_email,user_role:e.user_role,status:e.status,key:e.key||"",invitation_link:e.invitation_link||"",error:e.error||""})),t=new Blob([V.default.unparse(e)],{type:"text/csv"}),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="bulk_users_results.csv",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s)},variant:"primary",className:"flex items-center",children:[(0,t.jsx)(C.DownloadOutlined,{className:"mr-2"})," Download User Credentials"]})]})]})]})})})]})};var A=e.i(663435),$=e.i(355619);function z({isInvitationLinkModalVisible:e,setIsInvitationLinkModalVisible:s,baseUrl:r,invitationLinkData:l,modalType:a="invitation"}){let{Title:i,Paragraph:n}=y.Typography,d=()=>{if(!r)return"";let e=new URL(r).pathname,t=e&&"/"!==e?`${e}/ui`:"ui";if(l?.has_user_setup_sso)return new URL(t,r).toString();let s=`${t}?invitation_id=${l?.id}`;return"resetPassword"===a&&(s+="&action=reset_password"),new URL(s,r).toString()};return(0,t.jsxs)(p.Modal,{title:"invitation"===a?"Invitation Link":"Reset Password Link",open:e,width:800,footer:null,onOk:()=>{s(!1)},onCancel:()=>{s(!1)},children:[(0,t.jsx)(n,{children:"invitation"===a?"Copy and send the generated link to onboard this user to the proxy.":"Copy and send the generated link to the user to reset their password."}),(0,t.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,t.jsx)(v.Text,{className:"text-base",children:"User ID"}),(0,t.jsx)(v.Text,{children:l?.user_id})]}),(0,t.jsxs)("div",{className:"flex justify-between pt-5 pb-2",children:[(0,t.jsx)(v.Text,{children:"invitation"===a?"Invitation Link":"Reset Password Link"}),(0,t.jsx)(v.Text,{children:(0,t.jsx)(v.Text,{children:d()})})]}),(0,t.jsx)("div",{className:"flex justify-end mt-5",children:(0,t.jsx)(F.CopyToClipboard,{text:d(),onCopy:()=>M.default.success("Copied!"),children:(0,t.jsx)(o.Button,{variant:"primary",children:"invitation"===a?"Copy invitation link":"Copy password reset link"})})})]})}e.s(["default",()=>z],172372);let{Option:q}=f.Select,{Text:K,Link:H,Title:W}=y.Typography;e.s(["CreateUserButton",0,({userID:e,accessToken:y,teams:v,possibleUIRoles:w,onUserCreated:N,isEmbedded:_=!1})=>{let C=(0,l.useQueryClient)(),[S,k]=(0,b.useState)(null),[O]=x.Form.useForm(),[T,I]=(0,b.useState)(!1),[U,P]=(0,b.useState)(!1),[V,L]=(0,b.useState)([]),[E,R]=(0,b.useState)(!1),[F,q]=(0,b.useState)(null),[W,G]=(0,b.useState)(null);(0,b.useEffect)(()=>{let t=async()=>{try{let t=await (0,B.modelAvailableCall)(y,e,"any"),s=[];for(let e=0;e<t.data.length;e++){let r=t.data[e];s.push(r.id)}L(s);let r=await (0,B.getProxyUISettings)(y);k(r)}catch(e){console.error("Error fetching model data:",e)}};G((0,B.getProxyBaseUrl)()),t()},[]);let J=async t=>{try{M.default.info("Making API Call"),_||I(!0),t.models&&0!==t.models.length||"proxy_admin"===t.user_role||(t.models=["no-default-models"]);let s=await (0,B.userCreateCall)(y,null,t);await C.invalidateQueries({queryKey:["userList"]}),P(!0);let r=s.data?.user_id||s.user_id;if(N&&_){N(r),O.resetFields();return}if(S?.SSO_ENABLED){let t={id:"u">typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),user_id:r,is_accepted:!1,accepted_at:null,expires_at:new Date(Date.now()+6048e5),created_at:new Date,created_by:e,updated_at:new Date,updated_by:e,has_user_setup_sso:!0};q(t),R(!0)}else(0,B.invitationCreateCall)(y,r).then(e=>{e.has_user_setup_sso=!1,q(e),R(!0)});M.default.success("API user Created"),O.resetFields(),localStorage.removeItem("userData"+e)}catch(t){let e=t.response?.data?.detail||t?.message||"Error creating the user";M.default.fromBackend(e),console.error("Error creating the user:",t)}};return _?(0,t.jsxs)(x.Form,{form:O,onFinish:J,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,t.jsx)(m.Alert,{message:"Email invitations",description:(0,t.jsxs)(t.Fragment,{children:["New users receive an email invite only when an email integration (SMTP, Resend, or SendGrid) is configured."," ",(0,t.jsx)(H,{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",children:"Learn how to set up email notifications"})]}),type:"info",showIcon:!0,className:"mb-4"}),(0,t.jsx)(x.Form.Item,{label:"User Email",name:"user_email",children:(0,t.jsx)(c.TextInput,{placeholder:""})}),(0,t.jsx)(x.Form.Item,{label:"User Role",name:"user_role",children:(0,t.jsx)(f.Select,{children:w&&Object.entries(w).map(([e,{ui_label:s,description:r}])=>(0,t.jsx)(d.SelectItem,{value:e,title:s,children:(0,t.jsxs)("div",{className:"flex",children:[s," ",(0,t.jsx)(K,{className:"ml-2",style:{color:"gray",fontSize:"12px"},children:r})]})},e))})}),(0,t.jsx)(x.Form.Item,{label:"Team",name:"team_id",children:(0,t.jsx)(f.Select,{placeholder:"Select Team",style:{width:"100%"},children:(0,t.jsx)(A.default,{teams:v})})}),(0,t.jsx)(x.Form.Item,{label:"Metadata",name:"metadata",children:(0,t.jsx)(h.Input.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,t.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,t.jsx)(u.Button,{htmlType:"submit",children:"Create User"})})]}):(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.Button,{className:"mb-0",onClick:()=>I(!0),children:"+ Invite User"}),(0,t.jsx)(D,{accessToken:y,teams:v,possibleUIRoles:w}),(0,t.jsxs)(p.Modal,{title:"Invite User",open:T,width:800,footer:null,onOk:()=>{I(!1),O.resetFields()},onCancel:()=>{I(!1),P(!1),O.resetFields()},children:[(0,t.jsxs)(g.Space,{direction:"vertical",size:"middle",children:[(0,t.jsx)(K,{className:"mb-1",children:"Create a User who can own keys"}),(0,t.jsx)(m.Alert,{message:"Email invitations",description:(0,t.jsxs)(t.Fragment,{children:["New users receive an email invite only when an email integration (SMTP, Resend, or SendGrid) is configured."," ",(0,t.jsx)(H,{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",children:"Learn how to set up email notifications"})]}),type:"info",showIcon:!0,className:"mb-4"})]}),(0,t.jsxs)(x.Form,{form:O,onFinish:J,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,t.jsx)(x.Form.Item,{label:"User Email",name:"user_email",children:(0,t.jsx)(h.Input,{})}),(0,t.jsx)(x.Form.Item,{label:(0,t.jsxs)("span",{children:["Global Proxy Role"," ",(0,t.jsx)(j.Tooltip,{title:"This role is independent of any team/org specific roles. Configure Team / Organization Admins in the Settings",children:(0,t.jsx)(s.InfoCircleOutlined,{})})]}),name:"user_role",children:(0,t.jsx)(f.Select,{children:w&&Object.entries(w).map(([e,{ui_label:s,description:r}])=>(0,t.jsxs)(d.SelectItem,{value:e,title:s,children:[(0,t.jsx)(K,{children:s}),(0,t.jsxs)(K,{type:"secondary",children:[" - ",r]})]},e))})}),(0,t.jsx)(x.Form.Item,{label:"Team",className:"gap-2",name:"team_id",help:"If selected, user will be added as a 'user' role to the team.",children:(0,t.jsx)(A.default,{teams:v})}),(0,t.jsx)(x.Form.Item,{label:"Metadata",name:"metadata",children:(0,t.jsx)(h.Input.TextArea,{rows:4,placeholder:"Enter metadata as JSON"})}),(0,t.jsxs)(a.Accordion,{children:[(0,t.jsx)(n.AccordionHeader,{children:(0,t.jsx)(K,{strong:!0,children:"Personal Key Creation"})}),(0,t.jsx)(i.AccordionBody,{children:(0,t.jsx)(x.Form.Item,{className:"gap-2",label:(0,t.jsxs)("span",{children:["Models"," ",(0,t.jsx)(j.Tooltip,{title:"Models user has access to, outside of team scope.",children:(0,t.jsx)(s.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"models",help:"Models user has access to, outside of team scope.",children:(0,t.jsxs)(f.Select,{mode:"multiple",placeholder:"Select models",style:{width:"100%"},children:[(0,t.jsx)(f.Select.Option,{value:"all-proxy-models",children:"All Proxy Models"},"all-proxy-models"),(0,t.jsx)(f.Select.Option,{value:"no-default-models",children:"No Default Models"},"no-default-models"),V.map(e=>(0,t.jsx)(f.Select.Option,{value:e,children:(0,$.getModelDisplayName)(e)},e))]})})})]}),(0,t.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,t.jsx)(u.Button,{type:"primary",icon:(0,t.jsx)(r.UserAddOutlined,{}),htmlType:"submit",children:"Invite User"})})]})]}),U&&(0,t.jsx)(z,{isInvitationLinkModalVisible:E,setIsInvitationLinkModalVisible:R,baseUrl:W||"",invitationLinkData:F})]})}],371455)}]);