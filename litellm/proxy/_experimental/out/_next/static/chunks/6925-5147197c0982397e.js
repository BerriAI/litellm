"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6925],{6925:function(e,l,s){s.d(l,{Z:function(){return Q}});var t=s(57437),a=s(2265),n=s(20831),i=s(12514),r=s(67101),c=s(47323),d=s(43227),o=s(92858),h=s(12485),u=s(18135),m=s(35242),x=s(29706),g=s(77991),j=s(21626),f=s(97214),p=s(28241),Z=s(58834),y=s(69552),b=s(71876),v=s(84264),k=s(49566),_=s(53410),C=s(74998),S=s(93192),w=s(13634),E=s(82680),N=s(52787),A=s(64482),T=s(73002),O=s(9114),L=s(19250),R=s(23496),F=s(87908),P=s(61994);let{Title:I}=S.default;var M=e=>{let{accessToken:l}=e,[s,r]=(0,a.useState)(!0),[c,d]=(0,a.useState)([]);(0,a.useEffect)(()=>{o()},[l]);let o=async()=>{if(l){r(!0);try{let e=await (0,L.getEmailEventSettings)(l);d(e.settings)}catch(e){console.error("Failed to fetch email event settings:",e),O.Z.fromBackend(e)}finally{r(!1)}}},h=(e,l)=>{d(c.map(s=>s.event===e?{...s,enabled:l}:s))},u=async()=>{if(l)try{await (0,L.updateEmailEventSettings)(l,{settings:c}),O.Z.success("Email event settings updated successfully")}catch(e){console.error("Failed to update email event settings:",e),O.Z.fromBackend(e)}},m=async()=>{if(l)try{await (0,L.resetEmailEventSettings)(l),O.Z.success("Email event settings reset to defaults"),o()}catch(e){console.error("Failed to reset email event settings:",e),O.Z.fromBackend(e)}},x=e=>{if(e.includes("Virtual Key Created"))return"An email will be sent to the user when a new virtual key is created with their user ID";if(e.includes("New User Invitation"))return"An email will be sent to the email address of the user when a new user is created";{let l=e.split(/(?=[A-Z])/).join(" ").toLowerCase();return"Receive an email notification when ".concat(l)}};return(0,t.jsxs)(i.Z,{children:[(0,t.jsx)(I,{level:4,children:"Email Notifications"}),(0,t.jsx)(v.Z,{children:"Select which events should trigger email notifications."}),(0,t.jsx)(R.Z,{}),s?(0,t.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:(0,t.jsx)(F.Z,{size:"large"})}):(0,t.jsx)("div",{className:"space-y-4",children:c.map(e=>(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(P.Z,{checked:e.enabled,onChange:l=>h(e.event,l.target.checked)}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)(v.Z,{children:e.event}),(0,t.jsx)("div",{className:"text-sm text-gray-500 block",children:x(e.event)})]})]},e.event))}),(0,t.jsxs)("div",{className:"mt-6 flex space-x-4",children:[(0,t.jsx)(n.Z,{onClick:u,disabled:s,children:"Save Changes"}),(0,t.jsx)(n.Z,{onClick:m,variant:"secondary",disabled:s,children:"Reset to Defaults"})]})]})};let{Title:U}=S.default;var B=e=>{let{accessToken:l,premiumUser:s,alerts:a}=e,c=async()=>{if(!l)return;let e={};a.filter(e=>"email"===e.name).forEach(l=>{var s;Object.entries(null!==(s=l.variables)&&void 0!==s?s:{}).forEach(l=>{let[s,t]=l,a=document.querySelector('input[name="'.concat(s,'"]'));a&&a.value&&(e[s]=null==a?void 0:a.value)})}),console.log("updatedVariables",e);try{await (0,L.setCallbacksCall)(l,{general_settings:{alerting:["email"]},environment_variables:e}),O.Z.success("Email settings updated successfully")}catch(e){O.Z.fromBackend(e)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-6 mb-6",children:(0,t.jsx)(M,{accessToken:l})}),(0,t.jsxs)(i.Z,{children:[(0,t.jsx)(U,{level:4,children:"Email Server Settings"}),(0,t.jsxs)(v.Z,{children:[(0,t.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",style:{color:"blue"},children:[" ","LiteLLM Docs: email alerts"]})," ",(0,t.jsx)("br",{})]}),(0,t.jsx)("div",{className:"flex w-full",children:a.filter(e=>"email"===e.name).map((e,l)=>{var a;return(0,t.jsx)(p.Z,{children:(0,t.jsx)("ul",{children:(0,t.jsx)(r.Z,{numItems:2,children:Object.entries(null!==(a=e.variables)&&void 0!==a?a:{}).map(e=>{let[l,a]=e;return(0,t.jsxs)("li",{className:"mx-2 my-2",children:[!0!=s&&("EMAIL_LOGO_URL"===l||"EMAIL_SUPPORT_CONTACT"===l)?(0,t.jsxs)("div",{children:[(0,t.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:(0,t.jsxs)(v.Z,{className:"mt-2",children:[" ✨ ",l]})}),(0,t.jsx)(k.Z,{name:l,defaultValue:a,type:"password",disabled:!0,style:{width:"400px"}})]}):(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Z,{className:"mt-2",children:l}),(0,t.jsx)(k.Z,{name:l,defaultValue:a,type:"password",style:{width:"400px"}})]}),(0,t.jsxs)("p",{style:{fontSize:"small",fontStyle:"italic"},children:["SMTP_HOST"===l&&(0,t.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP host address, e.g. `smtp.resend.com`",(0,t.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PORT"===l&&(0,t.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP port number, e.g. `587`",(0,t.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_USERNAME"===l&&(0,t.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP username, e.g. `username`",(0,t.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PASSWORD"===l&&(0,t.jsx)("span",{style:{color:"red"},children:" Required * "}),"SMTP_SENDER_EMAIL"===l&&(0,t.jsxs)("div",{style:{color:"gray"},children:["Enter the sender email address, e.g. `sender@berri.ai`",(0,t.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"TEST_EMAIL_ADDRESS"===l&&(0,t.jsxs)("div",{style:{color:"gray"},children:["Email Address to send `Test Email Alert` to. example: `info@berri.ai`",(0,t.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"EMAIL_LOGO_URL"===l&&(0,t.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the Logo that appears in the email, pass a url to your logo"}),"EMAIL_SUPPORT_CONTACT"===l&&(0,t.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the support email address that appears in the email. Default is support@berri.ai"})]})]},l)})})})},l)})}),(0,t.jsx)(n.Z,{className:"mt-2",onClick:()=>c(),children:"Save Changes"}),(0,t.jsx)(n.Z,{onClick:async()=>{if(l)try{await (0,L.serviceHealthCheck)(l,"email"),O.Z.success("Email test triggered. Check your configured email inbox/logs.")}catch(e){O.Z.fromBackend(e)}},className:"mx-2",children:"Test Email Alerts"})]})]})},D=s(20577),q=s(44643),H=s(41649),W=e=>{let{alertingSettings:l,handleInputChange:s,handleResetField:a,handleSubmit:i,premiumUser:r}=e,[d]=w.Z.useForm();return(0,t.jsxs)(w.Z,{form:d,onFinish:()=>{console.log("INSIDE ONFINISH");let e=d.getFieldsValue(),l=Object.entries(e).every(e=>{let[l,s]=e;return"boolean"!=typeof s&&(""===s||null==s)});console.log("formData: ".concat(JSON.stringify(e),", isEmpty: ").concat(l)),l?console.log("Some form fields are empty."):i(e)},labelAlign:"left",children:[l.map((e,l)=>(0,t.jsxs)(b.Z,{children:[(0,t.jsxs)(p.Z,{align:"center",children:[(0,t.jsx)(v.Z,{children:e.field_name}),(0,t.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:e.field_description})]}),e.premium_field?r?(0,t.jsx)(w.Z.Item,{name:e.field_name,children:(0,t.jsx)(p.Z,{children:"Integer"===e.field_type?(0,t.jsx)(D.Z,{step:1,value:e.field_value,onChange:l=>s(e.field_name,l)}):"Boolean"===e.field_type?(0,t.jsx)(o.Z,{checked:e.field_value,onChange:l=>s(e.field_name,l)}):(0,t.jsx)(A.default,{value:e.field_value,onChange:l=>s(e.field_name,l)})})}):(0,t.jsx)(p.Z,{children:(0,t.jsx)(n.Z,{className:"flex items-center justify-center",children:(0,t.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})})}):(0,t.jsx)(w.Z.Item,{name:e.field_name,className:"mb-0",valuePropName:"Boolean"===e.field_type?"checked":"value",children:(0,t.jsx)(p.Z,{children:"Integer"===e.field_type?(0,t.jsx)(D.Z,{step:1,value:e.field_value,onChange:l=>s(e.field_name,l),className:"p-0"}):"Boolean"===e.field_type?(0,t.jsx)(o.Z,{checked:e.field_value,onChange:l=>{s(e.field_name,l),d.setFieldsValue({[e.field_name]:l})}}):(0,t.jsx)(A.default,{value:e.field_value,onChange:l=>s(e.field_name,l)})})}),(0,t.jsx)(p.Z,{children:!0==e.stored_in_db?(0,t.jsx)(H.Z,{icon:q.Z,className:"text-white",children:"In DB"}):!1==e.stored_in_db?(0,t.jsx)(H.Z,{className:"text-gray bg-white outline",children:"In Config"}):(0,t.jsx)(H.Z,{className:"text-gray bg-white outline",children:"Not Set"})}),(0,t.jsx)(p.Z,{children:(0,t.jsx)(c.Z,{icon:C.Z,color:"red",onClick:()=>a(e.field_name,l),children:"Reset"})})]},l)),(0,t.jsx)("div",{children:(0,t.jsx)(T.ZP,{htmlType:"submit",children:"Update Settings"})})]})},V=e=>{let{accessToken:l,premiumUser:s}=e,[n,i]=(0,a.useState)([]);return(0,a.useEffect)(()=>{l&&(0,L.alertingSettingsCall)(l).then(e=>{i(e)})},[l]),(0,t.jsx)(W,{alertingSettings:n,handleInputChange:(e,l)=>{let s=n.map(s=>s.field_name===e?{...s,field_value:l}:s);console.log("updatedSettings: ".concat(JSON.stringify(s))),i(s)},handleResetField:(e,s)=>{if(l)try{let l=n.map(l=>l.field_name===e?{...l,stored_in_db:null,field_value:l.field_default_value}:l);i(l)}catch(e){console.log("ERROR OCCURRED!")}},handleSubmit:e=>{if(!l||(console.log("formValues: ".concat(e)),null==e||void 0==e))return;let s={};n.forEach(e=>{s[e.field_name]=e.field_value});let t={...e,...s};console.log("mergedFormValues: ".concat(JSON.stringify(t)));let{slack_alerting:a,...i}=t;console.log("slack_alerting: ".concat(a,", alertingArgs: ").concat(JSON.stringify(i)));try{(0,L.updateConfigFieldSetting)(l,"alerting_args",i),"boolean"==typeof a&&(!0==a?(0,L.updateConfigFieldSetting)(l,"alerting",["slack"]):(0,L.updateConfigFieldSetting)(l,"alerting",[])),O.Z.success("Wait 10s for proxy to update.")}catch(e){}},premiumUser:s})},z=s(38994),J=s(97434),G=s(85968);let{Title:K,Paragraph:Y}=S.default;var Q=e=>{let{accessToken:l,userRole:s,userID:S,premiumUser:R}=e,[F,P]=(0,a.useState)([]),[I,M]=(0,a.useState)([]),[U,D]=(0,a.useState)(!1),[q]=w.Z.useForm(),[H]=w.Z.useForm(),[W,Y]=(0,a.useState)(null),[Q,X]=(0,a.useState)(""),[$,ee]=(0,a.useState)({}),[el,es]=(0,a.useState)([]),[et,ea]=(0,a.useState)(!1),[en,ei]=(0,a.useState)([]),[er,ec]=(0,a.useState)([]),[ed,eo]=(0,a.useState)(!1),[eh,eu]=(0,a.useState)(null),[em,ex]=(0,a.useState)(!1),[eg,ej]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(ed&&eh){let e=Object.fromEntries(Object.entries(eh.variables||{}).map(e=>{let[l,s]=e;return[l,null!=s?s:""]}));H.setFieldsValue(e)}},[ed,eh,H]);let ef=e=>{el.includes(e)?es(el.filter(l=>l!==e)):es([...el,e])},ep={llm_exceptions:"LLM Exceptions",llm_too_slow:"LLM Responses Too Slow",llm_requests_hanging:"LLM Requests Hanging",budget_alerts:"Budget Alerts (API Keys, Users)",db_exceptions:"Database Exceptions (Read/Write)",daily_reports:"Weekly/Monthly Spend Reports",outage_alerts:"Outage Alerts",region_outage_alerts:"Region Outage Alerts"};(0,a.useEffect)(()=>{l&&s&&S&&(0,L.getCallbacksCall)(l,S,s).then(e=>{P(e.callbacks),ei(e.available_callbacks);let l=e.alerts;if(l&&l.length>0){let e=l[0],s=e.variables.SLACK_WEBHOOK_URL;es(e.active_alerts),X(s),ee(e.alerts_to_webhook)}M(l)})},[l,s,S]);let eZ=e=>el&&el.includes(e),ey=async e=>{if(!l||!eh)return;let t={};Object.entries(e).forEach(e=>{let[l,s]=e;"callback"!==l&&(t[l]=s)});let a={environment_variables:e,litellm_settings:{success_callback:[eh.name]}};try{if(await (0,L.setCallbacksCall)(l,a),O.Z.success("Callback updated successfully"),eo(!1),H.resetFields(),eu(null),S&&s){let e=await (0,L.getCallbacksCall)(l,S,s);P(e.callbacks)}}catch(e){O.Z.fromBackend(e)}},eb=async e=>{if(!l)return;let t=null==e?void 0:e.callback,a={};Object.entries(e).forEach(e=>{let[l,s]=e;"callback"!==l&&(a[l]=s)});try{await (0,L.setCallbacksCall)(l,{environment_variables:e,litellm_settings:{success_callback:[t]}}),O.Z.success("Callback ".concat(t," added successfully")),ea(!1),q.resetFields(),Y(null),ec([]);let a=await (0,L.getCallbacksCall)(l,S||"",s||"");P(a.callbacks)}catch(e){O.Z.fromBackend(e)}},ev=e=>{Y(e.litellm_callback_name),e&&e.litellm_callback_params?ec(e.litellm_callback_params):ec([])},ek=async()=>{if(!l)return;let e={};Object.entries(ep).forEach(l=>{let[s,t]=l,a=document.querySelector('input[name="'.concat(s,'"]')),n=(null==a?void 0:a.value)||"";e[s]=n});try{await (0,L.setCallbacksCall)(l,{general_settings:{alert_to_webhook_url:e,alert_types:el}})}catch(e){O.Z.fromBackend(e)}O.Z.success("Alerts updated successfully")},e_=e=>{ej(e),ex(!0)},eC=async()=>{if(eg&&l)try{if(await (0,L.deleteCallback)(l,eg),O.Z.success("Callback ".concat(eg," deleted successfully")),S&&s){let e=await (0,L.getCallbacksCall)(l,S,s);P(e.callbacks)}ex(!1),ej(null)}catch(e){console.error("Failed to delete callback:",e),O.Z.fromBackend(e)}};return l?(0,t.jsxs)("div",{className:"w-full mx-4",children:[(0,t.jsx)(r.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,t.jsxs)(u.Z,{children:[(0,t.jsxs)(m.Z,{variant:"line",defaultValue:"1",children:[(0,t.jsx)(h.Z,{value:"1",children:"Logging Callbacks"}),(0,t.jsx)(h.Z,{value:"2",children:"Alerting Types"}),(0,t.jsx)(h.Z,{value:"3",children:"Alerting Settings"}),(0,t.jsx)(h.Z,{value:"4",children:"Email Alerts"})]}),(0,t.jsxs)(g.Z,{children:[(0,t.jsxs)(x.Z,{children:[(0,t.jsx)(K,{level:4,children:"Active Logging Callbacks"}),(0,t.jsx)(r.Z,{numItems:2,children:(0,t.jsx)(i.Z,{className:"max-h-[50vh]",children:(0,t.jsxs)(j.Z,{children:[(0,t.jsx)(Z.Z,{children:(0,t.jsx)(b.Z,{children:(0,t.jsx)(y.Z,{children:"Callback Name"})})}),(0,t.jsx)(f.Z,{children:F.map((e,s)=>(0,t.jsxs)(b.Z,{className:"flex justify-between",children:[(0,t.jsx)(p.Z,{children:(0,t.jsx)(v.Z,{children:e.name})}),(0,t.jsx)(p.Z,{children:(0,t.jsxs)(r.Z,{numItems:2,className:"flex justify-between",children:[(0,t.jsx)(c.Z,{icon:_.Z,size:"sm",onClick:()=>{eu(e),eo(!0)}}),(0,t.jsx)(c.Z,{icon:C.Z,size:"sm",onClick:()=>e_(e.name),className:"text-red-500 hover:text-red-700 cursor-pointer"}),(0,t.jsx)(n.Z,{onClick:async()=>{try{await (0,L.serviceHealthCheck)(l,e.name),O.Z.success("Health check triggered")}catch(e){O.Z.fromBackend((0,G.O)(e))}},className:"ml-2",variant:"secondary",children:"Test Callback"})]})})]},s))})]})})}),(0,t.jsx)(n.Z,{className:"mt-2",onClick:()=>ea(!0),children:"Add Callback"})]}),(0,t.jsx)(x.Z,{children:(0,t.jsxs)(i.Z,{children:[(0,t.jsxs)(v.Z,{className:"my-2",children:["Alerts are only supported for Slack Webhook URLs. Get your webhook urls from"," ",(0,t.jsx)("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",style:{color:"blue"},children:"here"})]}),(0,t.jsxs)(j.Z,{children:[(0,t.jsx)(Z.Z,{children:(0,t.jsxs)(b.Z,{children:[(0,t.jsx)(y.Z,{}),(0,t.jsx)(y.Z,{}),(0,t.jsx)(y.Z,{children:"Slack Webhook URL"})]})}),(0,t.jsx)(f.Z,{children:Object.entries(ep).map((e,l)=>{let[s,a]=e;return(0,t.jsxs)(b.Z,{children:[(0,t.jsx)(p.Z,{children:"region_outage_alerts"==s?R?(0,t.jsx)(o.Z,{id:"switch",name:"switch",checked:eZ(s),onChange:()=>ef(s)}):(0,t.jsx)(n.Z,{className:"flex items-center justify-center",children:(0,t.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})}):(0,t.jsx)(o.Z,{id:"switch",name:"switch",checked:eZ(s),onChange:()=>ef(s)})}),(0,t.jsx)(p.Z,{children:(0,t.jsx)(v.Z,{children:a})}),(0,t.jsx)(p.Z,{children:(0,t.jsx)(k.Z,{name:s,type:"password",defaultValue:$&&$[s]?$[s]:Q})})]},l)})})]}),(0,t.jsx)(n.Z,{size:"xs",className:"mt-2",onClick:ek,children:"Save Changes"}),(0,t.jsx)(n.Z,{onClick:async()=>{try{await (0,L.serviceHealthCheck)(l,"slack"),O.Z.success("Alert test triggered. Test request to slack made - check logs/alerts on slack to verify")}catch(e){O.Z.fromBackend((0,G.O)(e))}},className:"mx-2",children:"Test Alerts"})]})}),(0,t.jsx)(x.Z,{children:(0,t.jsx)(V,{accessToken:l,premiumUser:R})}),(0,t.jsx)(x.Z,{children:(0,t.jsx)(B,{accessToken:l,premiumUser:R,alerts:I})})]})]})}),(0,t.jsxs)(E.Z,{title:"Add Logging Callback",visible:et,width:800,onCancel:()=>{ea(!1),Y(null),ec([])},footer:null,children:[(0,t.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/logging",className:"mb-8 mt-4",target:"_blank",style:{color:"blue"},children:[" ","LiteLLM Docs: Logging"]}),(0,t.jsx)(w.Z,{form:q,onFinish:eb,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z.Z,{label:"Callback",name:"callback",rules:[{required:!0,message:"Please select a callback"}],children:(0,t.jsx)(N.default,{onChange:e=>{let l=en[e];l&&ev(l)},children:Object.entries(J.Y5).map(e=>{var l;let[s,a]=e;return(0,t.jsx)(d.Z,{value:J.Lo[s],children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(null===(l=J.Dg[a])||void 0===l?void 0:l.logo)?(0,t.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,t.jsx)("img",{src:J.Dg[a].logo,alt:"".concat(s," logo"),className:"w-5 h-5",onError:e=>{e.currentTarget.style.display="none"}})}):(0,t.jsx)("div",{className:"w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-xs",children:a.charAt(0).toUpperCase()}),(0,t.jsx)("span",{children:a})]})},a)})})}),er&&er.map(e=>(0,t.jsx)(z.Z,{label:e,name:e,rules:[{required:!0,message:"Please enter the value for "+e}],children:(0,t.jsx)(A.default.Password,{})},e)),(0,t.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,t.jsx)(T.ZP,{htmlType:"submit",children:"Save"})})]})})]}),(0,t.jsx)(E.Z,{visible:ed,width:800,title:"Edit ".concat(null==eh?void 0:eh.name," Settings"),onCancel:()=>{eo(!1),eu(null)},footer:null,children:(0,t.jsxs)(w.Z,{form:H,onFinish:ey,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,t.jsx)(t.Fragment,{children:eh&&eh.variables&&Object.entries(eh.variables).map(e=>{let[l]=e;return(0,t.jsx)(z.Z,{label:l,name:l,rules:[{required:!0,message:"Please enter the value for ".concat(l)}],children:(0,t.jsx)(A.default.Password,{})},l)})}),(0,t.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,t.jsx)(T.ZP,{htmlType:"submit",children:"Save"})})]})}),(0,t.jsx)(E.Z,{title:"Confirm Delete",visible:em,onOk:eC,onCancel:()=>{ex(!1),ej(null)},okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},children:(0,t.jsxs)("p",{children:["Are you sure you want to delete the callback - ",eg,"? This action cannot be undone."]})})]}):null}}}]);