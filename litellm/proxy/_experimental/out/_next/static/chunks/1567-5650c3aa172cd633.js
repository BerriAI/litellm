"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1567],{31567:function(e,t,s){s.d(t,{Z:function(){return eg}});var a=s(57437),r=s(2265),l=s(16312),n=s(82680),o=s(19250),i=s(20831),c=s(21626),d=s(97214),m=s(28241),x=s(58834),p=s(69552),h=s(71876),u=s(74998),g=s(44633),j=s(86462),f=s(49084),v=s(89970),y=s(71594),b=s(24525),N=e=>{let{promptsList:t,isLoading:s,onPromptClick:l,onDeleteClick:n,accessToken:o,isAdmin:N}=e,[w,C]=(0,r.useState)([{id:"created_at",desc:!0}]),Z=e=>e?new Date(e).toLocaleString():"-",k=[{header:"Prompt ID",accessorKey:"prompt_id",cell:e=>(0,a.jsx)(v.Z,{title:String(e.getValue()||""),children:(0,a.jsx)(i.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>e.getValue()&&(null==l?void 0:l(e.getValue())),children:e.getValue()?"".concat(String(e.getValue()).slice(0,7),"..."):""})})},{header:"Created At",accessorKey:"created_at",cell:e=>{let{row:t}=e,s=t.original;return(0,a.jsx)(v.Z,{title:s.created_at,children:(0,a.jsx)("span",{className:"text-xs",children:Z(s.created_at)})})}},{header:"Updated At",accessorKey:"updated_at",cell:e=>{let{row:t}=e,s=t.original;return(0,a.jsx)(v.Z,{title:s.updated_at,children:(0,a.jsx)("span",{className:"text-xs",children:Z(s.updated_at)})})}},{header:"Type",accessorKey:"prompt_info.prompt_type",cell:e=>{let{row:t}=e,s=t.original;return(0,a.jsx)(v.Z,{title:s.prompt_info.prompt_type,children:(0,a.jsx)("span",{className:"text-xs",children:s.prompt_info.prompt_type})})}},...N?[{header:"Actions",id:"actions",enableSorting:!1,cell:e=>{let{row:t}=e,s=t.original,r=s.prompt_id||"Unknown Prompt";return(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsx)(v.Z,{title:"Delete prompt",children:(0,a.jsx)(i.Z,{size:"xs",variant:"light",color:"red",onClick:e=>{e.stopPropagation(),null==n||n(s.prompt_id,r)},icon:u.Z,className:"text-red-500 hover:text-red-700 hover:bg-red-50"})})})}}]:[]],_=(0,y.b7)({data:t,columns:k,state:{sorting:w},onSortingChange:C,getCoreRowModel:(0,b.sC)(),getSortedRowModel:(0,b.tj)(),enableSorting:!0});return(0,a.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(c.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,a.jsx)(x.Z,{children:_.getHeaderGroups().map(e=>(0,a.jsx)(h.Z,{children:e.headers.map(e=>(0,a.jsx)(p.Z,{className:"py-1 h-8",onClick:e.column.getToggleSortingHandler(),children:(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,y.ie)(e.column.columnDef.header,e.getContext())}),(0,a.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,a.jsx)(g.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,a.jsx)(j.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,a.jsx)(f.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,a.jsx)(d.Z,{children:s?(0,a.jsx)(h.Z,{children:(0,a.jsx)(m.Z,{colSpan:k.length,className:"h-8 text-center",children:(0,a.jsx)("div",{className:"text-center text-gray-500",children:(0,a.jsx)("p",{children:"Loading..."})})})}):t.length>0?_.getRowModel().rows.map(e=>(0,a.jsx)(h.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,a.jsx)(m.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,y.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,a.jsx)(h.Z,{children:(0,a.jsx)(m.Z,{colSpan:k.length,className:"h-8 text-center",children:(0,a.jsx)("div",{className:"text-center text-gray-500",children:(0,a.jsx)("p",{children:"No prompts found"})})})})})]})})})},w=s(84717),C=s(73002),Z=s(10900),k=s(59872),_=s(30401),S=s(78867),P=s(9114),D=e=>{var t,s,l;let{promptId:i,onClose:c,accessToken:d,isAdmin:m,onDelete:x}=e,[p,h]=(0,r.useState)(null),[g,j]=(0,r.useState)(null),[f,v]=(0,r.useState)(null),[y,b]=(0,r.useState)(!0),[N,D]=(0,r.useState)({}),[T,z]=(0,r.useState)(!1),[O,A]=(0,r.useState)(!1),E=async()=>{try{if(b(!0),!d)return;let e=await (0,o.getPromptInfo)(d,i);h(e.prompt_spec),j(e.raw_prompt_template),v(e)}catch(e){P.Z.fromBackend("Failed to load prompt information"),console.error("Error fetching prompt info:",e)}finally{b(!1)}};if((0,r.useEffect)(()=>{E()},[i,d]),y)return(0,a.jsx)("div",{className:"p-4",children:"Loading..."});if(!p)return(0,a.jsx)("div",{className:"p-4",children:"Prompt not found"});let I=e=>e?new Date(e).toLocaleString():"-",M=async(e,t)=>{await (0,k.vQ)(e)&&(D(e=>({...e,[t]:!0})),setTimeout(()=>{D(e=>({...e,[t]:!1}))},2e3))},F=async()=>{if(d&&p){A(!0);try{await (0,o.deletePromptCall)(d,p.prompt_id),P.Z.success('Prompt "'.concat(p.prompt_id,'" deleted successfully')),null==x||x(),c()}catch(e){console.error("Error deleting prompt:",e),P.Z.fromBackend("Failed to delete prompt")}finally{A(!1),z(!1)}}};return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.zx,{icon:Z.Z,variant:"light",onClick:c,className:"mb-4",children:"Back to Prompts"}),(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.Dx,{children:"Prompt Details"}),(0,a.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,a.jsx)(w.xv,{className:"text-gray-500 font-mono",children:p.prompt_id}),(0,a.jsx)(C.ZP,{type:"text",size:"small",icon:N["prompt-id"]?(0,a.jsx)(_.Z,{size:12}):(0,a.jsx)(S.Z,{size:12}),onClick:()=>M(p.prompt_id,"prompt-id"),className:"left-2 z-10 transition-all duration-200 ".concat(N["prompt-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]})]}),m&&(0,a.jsx)(w.zx,{icon:u.Z,variant:"secondary",onClick:()=>{z(!0)},className:"flex items-center",children:"Delete Prompt"})]})]}),(0,a.jsxs)(w.v0,{children:[(0,a.jsxs)(w.td,{className:"mb-4",children:[(0,a.jsx)(w.OK,{children:"Overview"},"overview"),g?(0,a.jsx)(w.OK,{children:"Prompt Template"},"prompt-template"):(0,a.jsx)(a.Fragment,{}),m?(0,a.jsx)(w.OK,{children:"Details"},"details"):(0,a.jsx)(a.Fragment,{}),(0,a.jsx)(w.OK,{children:"Raw JSON"},"raw-json")]}),(0,a.jsxs)(w.nP,{children:[(0,a.jsxs)(w.x4,{children:[(0,a.jsxs)(w.rj,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,a.jsxs)(w.Zb,{children:[(0,a.jsx)(w.xv,{children:"Prompt ID"}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(w.Dx,{className:"font-mono text-sm",children:p.prompt_id})})]}),(0,a.jsxs)(w.Zb,{children:[(0,a.jsx)(w.xv,{children:"Prompt Type"}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)(w.Dx,{children:(null===(t=p.prompt_info)||void 0===t?void 0:t.prompt_type)||"-"}),(0,a.jsx)(w.Ct,{color:"blue",className:"mt-1",children:(null===(s=p.prompt_info)||void 0===s?void 0:s.prompt_type)||"Unknown"})]})]}),(0,a.jsxs)(w.Zb,{children:[(0,a.jsx)(w.xv,{children:"Created At"}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)(w.Dx,{children:I(p.created_at)}),(0,a.jsxs)(w.xv,{children:["Last Updated: ",I(p.updated_at)]})]})]})]}),p.litellm_params&&Object.keys(p.litellm_params).length>0&&(0,a.jsxs)(w.Zb,{className:"mt-6",children:[(0,a.jsx)(w.xv,{className:"font-medium",children:"LiteLLM Parameters"}),(0,a.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md",children:(0,a.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(p.litellm_params,null,2)})})]})]}),g&&(0,a.jsx)(w.x4,{children:(0,a.jsxs)(w.Zb,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(w.Dx,{children:"Prompt Template"}),(0,a.jsx)(C.ZP,{type:"text",size:"small",icon:N["prompt-content"]?(0,a.jsx)(_.Z,{size:16}):(0,a.jsx)(S.Z,{size:16}),onClick:()=>M(g.content,"prompt-content"),className:"transition-all duration-200 ".concat(N["prompt-content"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:N["prompt-content"]?"Copied!":"Copy Content"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.xv,{className:"font-medium",children:"Template ID"}),(0,a.jsx)("div",{className:"font-mono text-sm bg-gray-50 p-2 rounded",children:g.litellm_prompt_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.xv,{className:"font-medium",children:"Content"}),(0,a.jsx)("div",{className:"mt-2 p-4 bg-gray-50 rounded-md border overflow-auto max-h-96",children:(0,a.jsx)("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:g.content})})]}),g.metadata&&Object.keys(g.metadata).length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(w.xv,{className:"font-medium",children:"Template Metadata"}),(0,a.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,a.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap overflow-auto max-h-64",children:JSON.stringify(g.metadata,null,2)})})]})]})]})}),m&&(0,a.jsx)(w.x4,{children:(0,a.jsxs)(w.Zb,{children:[(0,a.jsx)(w.Dx,{className:"mb-4",children:"Prompt Details"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w.xv,{className:"font-medium",children:"Prompt ID"}),(0,a.jsx)("div",{className:"font-mono text-sm bg-gray-50 p-2 rounded",children:p.prompt_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.xv,{className:"font-medium",children:"Prompt Type"}),(0,a.jsx)("div",{children:(null===(l=p.prompt_info)||void 0===l?void 0:l.prompt_type)||"-"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.xv,{className:"font-medium",children:"Created At"}),(0,a.jsx)("div",{children:I(p.created_at)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.xv,{className:"font-medium",children:"Last Updated"}),(0,a.jsx)("div",{children:I(p.updated_at)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.xv,{className:"font-medium",children:"LiteLLM Parameters"}),(0,a.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,a.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap overflow-auto max-h-96",children:JSON.stringify(p.litellm_params,null,2)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w.xv,{className:"font-medium",children:"Prompt Info"}),(0,a.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,a.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(p.prompt_info,null,2)})})]})]})]})}),(0,a.jsx)(w.x4,{children:(0,a.jsxs)(w.Zb,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(w.Dx,{children:"Raw API Response"}),(0,a.jsx)(C.ZP,{type:"text",size:"small",icon:N["raw-json"]?(0,a.jsx)(_.Z,{size:16}):(0,a.jsx)(S.Z,{size:16}),onClick:()=>M(JSON.stringify(f,null,2),"raw-json"),className:"transition-all duration-200 ".concat(N["raw-json"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:N["raw-json"]?"Copied!":"Copy JSON"})]}),(0,a.jsx)("div",{className:"p-4 bg-gray-50 rounded-md border overflow-auto",children:(0,a.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(f,null,2)})})]})})]})]}),(0,a.jsxs)(n.Z,{title:"Delete Prompt",open:T,onOk:F,onCancel:()=>{z(!1)},confirmLoading:O,okText:"Delete",okButtonProps:{danger:!0},children:[(0,a.jsxs)("p",{children:["Are you sure you want to delete prompt: ",(0,a.jsx)("strong",{children:null==p?void 0:p.prompt_id}),"?"]}),(0,a.jsx)("p",{children:"This action cannot be undone."})]})]})},T=s(52787),z=s(13634),O=s(23496),A=s(65319),E=s(31283),I=s(3632);let{Option:M}=T.default;var F=e=>{let{visible:t,onClose:s,accessToken:l,onSuccess:i}=e,[c]=z.Z.useForm(),[d,m]=(0,r.useState)(!1),[x,p]=(0,r.useState)([]),[h,u]=(0,r.useState)("dotprompt"),g=()=>{c.resetFields(),p([]),u("dotprompt"),s()},j=async()=>{try{let e=await c.validateFields();if(console.log("values: ",e),!l){P.Z.fromBackend("Access token is required");return}if("dotprompt"===h&&0===x.length){P.Z.fromBackend("Please upload a .prompt file");return}m(!0);let t={};if("dotprompt"===h&&x.length>0){let s=x[0].originFileObj;try{let a=await (0,o.convertPromptFileToJson)(l,s);console.log("Conversion result:",a),t={prompt_id:e.prompt_id,litellm_params:{prompt_integration:"dotprompt",prompt_id:a.prompt_id,prompt_data:a.json_data},prompt_info:{prompt_type:"db"}}}catch(e){console.error("Error converting prompt file:",e),P.Z.fromBackend("Failed to convert prompt file to JSON"),m(!1);return}}try{await (0,o.createPromptCall)(l,t),P.Z.success("Prompt created successfully!"),g(),i()}catch(e){console.error("Error creating prompt:",e),P.Z.fromBackend("Failed to create prompt")}}catch(e){console.error("Form validation error:",e)}finally{m(!1)}};return(0,a.jsx)(n.Z,{title:"Add New Prompt",open:t,onCancel:g,footer:[(0,a.jsx)(C.ZP,{onClick:g,children:"Cancel"},"cancel"),(0,a.jsx)(C.ZP,{loading:d,onClick:j,children:"Create Prompt"},"submit")],width:600,children:(0,a.jsxs)(z.Z,{form:c,layout:"vertical",requiredMark:!1,children:[(0,a.jsx)(z.Z.Item,{label:"Prompt ID",name:"prompt_id",rules:[{required:!0,message:"Please enter a prompt ID"},{pattern:/^[a-zA-Z0-9_-]+$/,message:"Prompt ID can only contain letters, numbers, underscores, and hyphens"}],children:(0,a.jsx)(E.o,{placeholder:"Enter unique prompt ID (e.g., my_prompt_id)"})}),(0,a.jsx)(z.Z.Item,{label:"Prompt Integration",name:"prompt_integration",initialValue:"dotprompt",children:(0,a.jsx)(T.default,{value:h,onChange:u,children:(0,a.jsx)(M,{value:"dotprompt",children:"dotprompt"})})}),"dotprompt"===h&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O.Z,{}),(0,a.jsxs)(z.Z.Item,{label:"Prompt File",extra:"Upload a .prompt file that follows the Dotprompt specification",children:[(0,a.jsx)(A.default,{beforeUpload:e=>(e.name.endsWith(".prompt")||P.Z.fromBackend("Please upload a .prompt file"),!1),fileList:x,onChange:e=>{let{fileList:t}=e;p(t.slice(-1))},onRemove:()=>{p([])},children:(0,a.jsx)(C.ZP,{icon:(0,a.jsx)(I.Z,{}),children:"Select .prompt File"})}),x.length>0&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",x[0].name]})]})]})]})})},L=e=>{let{visible:t,initialJson:s,onSave:l,onClose:o}=e,[i,c]=(0,r.useState)(s||'{\n  "type": "function",\n  "function": {\n    "name": "get_current_weather",\n    "description": "Get the current weather in a given location",\n    "parameters": {\n      "type": "object",\n      "properties": {\n        "location": {\n          "type": "string",\n          "description": "The city and state, e.g. San Francisco, CA"\n        },\n        "unit": {\n          "type": "string",\n          "enum": ["celsius", "fahrenheit"]\n        }\n      },\n      "required": ["location"]\n    }\n  }\n}'),[d,m]=(0,r.useState)(null),x=()=>{m(null),o()};return(0,a.jsx)(n.Z,{title:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("span",{className:"text-lg font-medium",children:"Add Tool"})}),open:t,onCancel:x,width:800,footer:[(0,a.jsx)(C.ZP,{onClick:x,children:"Cancel"},"cancel"),(0,a.jsx)(C.ZP,{type:"primary",onClick:()=>{try{JSON.parse(i),m(null),l(i)}catch(e){m("Invalid JSON format. Please check your syntax.")}},children:"Add"},"save")],children:(0,a.jsxs)("div",{className:"space-y-3",children:[d&&(0,a.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-red-600 text-sm",children:d}),(0,a.jsx)("textarea",{value:i,onChange:e=>c(e.target.value),className:"w-full min-h-[400px] px-4 py-3 border border-gray-300 rounded-lg text-sm font-mono focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Paste your tool JSON here..."})]})})};let J=e=>{let t=new Set,s=/\{\{(\w+)\}\}/g;if(e.messages.forEach(e=>{let a;for(;null!==(a=s.exec(e.content));)t.add(a[1])}),e.developerMessage){let a;for(;null!==(a=s.exec(e.developerMessage));)t.add(a[1])}return Array.from(t)},B=e=>{let t=J(e),s="---\nmodel: ".concat(e.model,"\n");return void 0!==e.config.temperature&&(s+="temperature: ".concat(e.config.temperature,"\n")),void 0!==e.config.max_tokens&&(s+="max_tokens: ".concat(e.config.max_tokens,"\n")),void 0!==e.config.top_p&&(s+="top_p: ".concat(e.config.top_p,"\n")),s+="input:\n  schema:\n",t.forEach(e=>{s+="    ".concat(e,": string\n")}),s+="output:\n  format: text\n",e.tools&&e.tools.length>0&&(s+="tools:\n",e.tools.forEach(e=>{let t=JSON.parse(e.json);s+="  - ".concat(JSON.stringify(t),"\n")})),s+="---\n\n",e.developerMessage&&""!==e.developerMessage.trim()&&(s+="Developer: ".concat(e.developerMessage.trim(),"\n\n")),e.messages.forEach(e=>{let t=e.role.charAt(0).toUpperCase()+e.role.slice(1);s+="".concat(t,": ").concat(e.content,"\n\n")}),s.trim()};var U=s(64482),R=s(32660),K=s(83229),V=e=>{let{promptName:t,onNameChange:s,onBack:r,onSave:n,isSaving:o}=e;return(0,a.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 py-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(l.z,{icon:R.Z,variant:"light",onClick:r,size:"xs",children:"Back"}),(0,a.jsx)(U.default,{value:t,onChange:e=>s(e.target.value),className:"text-base font-medium border-none shadow-none",style:{width:"200px"}}),(0,a.jsx)("span",{className:"px-2 py-0.5 text-xs bg-gray-100 text-gray-600 rounded",children:"Draft"}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"Unsaved changes"})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)(l.z,{icon:K.Z,onClick:n,loading:o,disabled:o,children:"Save"})})]})},q=s(92280),Y=s(98728),G=s(76593),H=e=>{let{model:t,temperature:s=1,maxTokens:l=1e3,accessToken:n,onModelChange:o,onTemperatureChange:i,onMaxTokensChange:c}=e,[d,m]=(0,r.useState)(!1);return(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-[300px]",children:(0,a.jsx)(G.Z,{accessToken:n||"",value:t,onChange:o,showLabel:!1})}),(0,a.jsxs)("button",{onClick:()=>m(!d),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,a.jsx)(Y.Z,{size:16}),(0,a.jsx)("span",{children:"Parameters"})]}),d&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Model Parameters"}),(0,a.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(q.x,{className:"text-sm text-gray-700",children:"Temperature"}),(0,a.jsx)(U.default,{type:"number",size:"small",min:0,max:2,step:.1,value:s,onChange:e=>i(parseFloat(e.target.value)||0),className:"w-20"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(q.x,{className:"text-sm text-gray-700",children:"Max Tokens"}),(0,a.jsx)(U.default,{type:"number",size:"small",min:1,max:32768,value:l,onChange:e=>c(parseInt(e.target.value)||1e3),className:"w-24"})]})})]})]})})]})},W=s(78801),Q=s(99397),$=s(27413),X=e=>{let{tools:t,onAddTool:s,onEditTool:r,onRemoveTool:l}=e;return(0,a.jsxs)(W.Z,{className:"p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(W.x,{className:"text-sm font-medium",children:"Tools"}),(0,a.jsxs)("button",{onClick:s,className:"text-xs text-blue-600 hover:text-blue-700 flex items-center",children:[(0,a.jsx)(Q.Z,{size:14,className:"mr-1"}),"Add"]})]}),0===t.length?(0,a.jsx)(W.x,{className:"text-gray-500 text-xs",children:"No tools added"}):(0,a.jsx)("div",{className:"space-y-2",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"font-medium text-xs truncate",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.description})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1 ml-2",children:[(0,a.jsx)("button",{onClick:()=>r(t),className:"text-xs text-blue-600 hover:text-blue-700",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>l(t),className:"text-gray-400 hover:text-red-500",children:(0,a.jsx)($.Z,{size:14})})]})]},t))})]})},ee=s(79326),et=s(3810),es=s(13377);let{TextArea:ea}=U.default;var er=e=>{let{value:t,onChange:s,placeholder:l,rows:n=4,className:o}=e,[i,c]=(0,r.useState)(null),[d,m]=(0,r.useState)(""),x=()=>{d.trim()&&i&&(s(t.substring(0,i.start)+"{{".concat(d,"}}")+t.substring(i.end)),c(null),m(""))},p=(()=>{let e;let s=/\{\{(\w+)\}\}/g,a=[];for(;null!==(e=s.exec(t));)a.push({name:e[1],start:e.index,end:e.index+e[0].length});return a})();return(0,a.jsxs)("div",{className:"variable-textarea-container ".concat(o),children:[(0,a.jsx)("style",{children:"\n          .variable-highlight-text {\n            color: #f97316;\n            background-color: #fff7ed;\n            border-radius: 4px;\n            padding: 0 2px;\n            border: 1px solid #fed7aa;\n            font-family: monospace;\n          }\n        "}),(0,a.jsx)(ea,{value:t,onChange:e=>s(e.target.value),placeholder:l,rows:n,className:"font-sans"}),p.length>0&&(0,a.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2 items-center",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500 mr-1",children:"Detected variables:"}),p.map((e,t)=>(0,a.jsx)(ee.Z,{content:(0,a.jsxs)("div",{className:"p-2",style:{minWidth:"200px"},children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Edit variable name"}),(0,a.jsx)(U.default,{size:"small",value:d,onChange:e=>m(e.target.value),onPressEnter:x,placeholder:"Variable name",autoFocus:!0}),(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsx)("button",{onClick:x,className:"text-xs px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Save"}),(0,a.jsx)("button",{onClick:()=>{c(null),m("")},className:"text-xs px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:"Cancel"})]})]}),open:(null==i?void 0:i.start)===e.start,onOpenChange:e=>{e||(c(null),m(""))},trigger:"click",children:(0,a.jsx)(et.Z,{color:"orange",className:"cursor-pointer hover:opacity-80 transition-all m-0",icon:(0,a.jsx)(es.Z,{}),onClick:()=>{c({oldName:e.name,start:e.start,end:e.end}),m(e.name)},children:e.name})},"".concat(e.start,"-").concat(t)))]})]})},el=e=>{let{value:t,onChange:s}=e;return(0,a.jsxs)(W.Z,{className:"p-3",children:[(0,a.jsx)(W.x,{className:"block mb-2 text-sm font-medium",children:"Developer message"}),(0,a.jsx)(W.x,{className:"text-gray-500 text-xs mb-2",children:"Optional system instructions for the model"}),(0,a.jsx)(er,{value:t,onChange:s,rows:3,placeholder:"e.g., You are a helpful assistant..."})]})},en=s(41905);let{Option:eo}=T.default;var ei=e=>{let{messages:t,onAddMessage:s,onUpdateMessage:l,onRemoveMessage:n,onMoveMessage:o}=e,[i,c]=(0,r.useState)(null),[d,m]=(0,r.useState)(null),x=e=>{c(e)},p=(e,t)=>{e.preventDefault(),m(t)},h=(e,t)=>{e.preventDefault(),null!==i&&i!==t&&o(i,t),c(null),m(null)},u=()=>{c(null),m(null)};return(0,a.jsxs)(W.Z,{className:"p-3",children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)(W.x,{className:"text-sm font-medium",children:"Prompt messages"}),(0,a.jsxs)(W.x,{className:"text-gray-500 text-xs mt-1",children:["Use ",(0,a.jsx)("code",{className:"bg-gray-100 px-1 rounded text-xs",children:"{{variable}}"})," syntax for template variables"]})]}),(0,a.jsx)("div",{className:"space-y-2",children:t.map((e,s)=>(0,a.jsxs)("div",{draggable:!0,onDragStart:()=>x(s),onDragOver:e=>p(e,s),onDrop:e=>h(e,s),onDragEnd:u,className:"border border-gray-300 rounded overflow-hidden bg-white transition-all ".concat(i===s?"opacity-50":""," ").concat(d===s&&i!==s?"border-blue-500 border-2":""),children:[(0,a.jsxs)("div",{className:"bg-gray-50 px-2 py-1.5 border-b border-gray-300 flex items-center justify-between",children:[(0,a.jsxs)(T.default,{value:e.role,onChange:e=>l(s,"role",e),style:{width:100},size:"small",bordered:!1,children:[(0,a.jsx)(eo,{value:"user",children:"User"}),(0,a.jsx)(eo,{value:"assistant",children:"Assistant"}),(0,a.jsx)(eo,{value:"system",children:"System"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[t.length>1&&(0,a.jsx)("button",{onClick:()=>n(s),className:"text-gray-400 hover:text-red-500",children:(0,a.jsx)($.Z,{size:14})}),(0,a.jsx)("div",{className:"cursor-grab active:cursor-grabbing text-gray-400 hover:text-gray-600",children:(0,a.jsx)(en.Z,{size:16})})]})]}),(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)(er,{value:e.content,onChange:e=>l(s,"content",e),rows:3,placeholder:"Enter prompt content..."})})]},s))}),(0,a.jsxs)("button",{onClick:s,className:"mt-2 text-xs text-blue-600 hover:text-blue-700 flex items-center",children:[(0,a.jsx)(Q.Z,{size:14,className:"mr-1"}),"Add message"]})]})},ec=s(11),ed=()=>(0,a.jsx)("div",{className:"flex-1 bg-white flex flex-col",children:(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 mx-auto mb-3 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(ec.Z,{size:24,className:"text-gray-400"})}),(0,a.jsx)("p",{className:"text-sm",children:"Your conversation will appear here"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Save the prompt to test it"})]})})}),em=s(19431),ex=e=>{let{visible:t,promptName:s,isSaving:r,onNameChange:l,onPublish:o,onCancel:i}=e;return(0,a.jsx)(n.Z,{title:"Publish Prompt",open:t,onCancel:i,footer:[(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(em.z,{variant:"secondary",onClick:i,children:"Cancel"}),(0,a.jsx)(em.z,{onClick:o,loading:r,children:"Publish"})]},"footer")],children:(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsx)(em.x,{className:"mb-2",children:"Name"}),(0,a.jsx)(U.default,{value:s,onChange:e=>l(e.target.value),placeholder:"Enter prompt name",onPressEnter:o,autoFocus:!0}),(0,a.jsx)(em.x,{className:"text-gray-500 text-xs mt-2",children:"Published prompts can be used in API calls and are versioned for easy tracking."})]})})},ep=e=>{let{prompt:t}=e,s=B(t);return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Generated .prompt file"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"This is the dotprompt format that will be saved to the database"})]}),(0,a.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 overflow-auto",children:(0,a.jsx)("pre",{className:"text-sm text-gray-900 font-mono whitespace-pre-wrap",children:s})})]})},eh=e=>{let{onClose:t,onSuccess:s,accessToken:l}=e,[n,i]=(0,r.useState)({name:"New prompt",model:"gpt-4o",config:{temperature:1,max_tokens:1e3},tools:[],developerMessage:"",messages:[{role:"user",content:"Enter task specifics. Use {{template_variables}} for dynamic inputs"}]}),[c,d]=(0,r.useState)(!1),[m,x]=(0,r.useState)(!1),[p,h]=(0,r.useState)(null),[u,g]=(0,r.useState)(!1),[j,f]=(0,r.useState)("pretty"),v=e=>{void 0!==e?h(e):h(null),d(!0)},y=async()=>{if(!l){P.Z.fromBackend("Access token is required");return}if(!n.name||""===n.name.trim()){P.Z.fromBackend("Please enter a valid prompt name");return}g(!0);try{let e=n.name.replace(/[^a-zA-Z0-9_-]/g,"_").toLowerCase(),a=B(n);await (0,o.createPromptCall)(l,{prompt_id:e,litellm_params:{prompt_integration:"dotprompt",prompt_id:e,dotprompt_content:a},prompt_info:{prompt_type:"db"}}),P.Z.success("Prompt created successfully!"),s(),t()}catch(e){console.error("Error saving prompt:",e),P.Z.fromBackend("Failed to save prompt")}finally{g(!1),x(!1)}};return(0,a.jsxs)("div",{className:"flex h-full bg-white",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,a.jsx)(V,{promptName:n.name,onNameChange:e=>i({...n,name:e}),onBack:t,onSave:()=>{n.name&&""!==n.name.trim()&&"New prompt"!==n.name?y():x(!0)},isSaving:u}),(0,a.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,a.jsxs)("div",{className:"w-1/2 overflow-y-auto bg-white border-r border-gray-200",children:[(0,a.jsxs)("div",{className:"border-b border-gray-200 bg-white px-6 py-4 flex items-center gap-3",children:[(0,a.jsx)(H,{model:n.model,temperature:n.config.temperature,maxTokens:n.config.max_tokens,accessToken:l,onModelChange:e=>i({...n,model:e}),onTemperatureChange:e=>i({...n,config:{...n.config,temperature:e}}),onMaxTokensChange:e=>i({...n,config:{...n.config,max_tokens:e}})}),(0,a.jsxs)("div",{className:"ml-auto inline-flex items-center bg-gray-200 rounded-full p-0.5",children:[(0,a.jsx)("button",{className:"px-3 py-1 text-xs font-medium rounded-full transition-colors ".concat("pretty"===j?"bg-white text-gray-900 shadow-sm":"text-gray-600"),onClick:()=>f("pretty"),children:"PRETTY"}),(0,a.jsx)("button",{className:"px-3 py-1 text-xs font-medium rounded-full transition-colors ".concat("dotprompt"===j?"bg-white text-gray-900 shadow-sm":"text-gray-600"),onClick:()=>f("dotprompt"),children:"DOTPROMPT"})]})]}),"pretty"===j?(0,a.jsxs)("div",{className:"p-6 space-y-4 pb-20",children:[(0,a.jsx)(X,{tools:n.tools,onAddTool:()=>v(),onEditTool:v,onRemoveTool:e=>{i({...n,tools:n.tools.filter((t,s)=>s!==e)})}}),(0,a.jsx)(el,{value:n.developerMessage,onChange:e=>i({...n,developerMessage:e})}),(0,a.jsx)(ei,{messages:n.messages,onAddMessage:()=>{i({...n,messages:[...n.messages,{role:"user",content:""}]})},onUpdateMessage:(e,t,s)=>{let a=[...n.messages];a[e][t]=s,i({...n,messages:a})},onRemoveMessage:e=>{n.messages.length>1&&i({...n,messages:n.messages.filter((t,s)=>s!==e)})},onMoveMessage:(e,t)=>{let s=[...n.messages],[a]=s.splice(e,1);s.splice(t,0,a),i({...n,messages:s})}})]}):(0,a.jsx)(ep,{prompt:n})]}),(0,a.jsx)(ed,{})]})]}),(0,a.jsx)(ex,{visible:m,promptName:n.name,isSaving:u,onNameChange:e=>i({...n,name:e}),onPublish:y,onCancel:()=>x(!1)}),c&&(0,a.jsx)(L,{visible:c,initialJson:null!==p?n.tools[p].json:"",onSave:e=>{try{var t,s;let a=JSON.parse(e),r={name:(null===(t=a.function)||void 0===t?void 0:t.name)||"Unnamed Tool",description:(null===(s=a.function)||void 0===s?void 0:s.description)||"",json:e};if(null!==p){let e=[...n.tools];e[p]=r,i({...n,tools:e})}else i({...n,tools:[...n.tools,r]});d(!1),h(null)}catch(e){P.Z.fromBackend("Invalid JSON format")}},onClose:()=>{d(!1),h(null)}})]})},eu=s(20347),eg=e=>{let{accessToken:t,userRole:s}=e,[i,c]=(0,r.useState)([]),[d,m]=(0,r.useState)(!1),[x,p]=(0,r.useState)(null),[h,u]=(0,r.useState)(!1),[g,j]=(0,r.useState)(!1),[f,v]=(0,r.useState)(!1),[y,b]=(0,r.useState)(null),w=!!s&&(0,eu.tY)(s),C=async()=>{if(t){m(!0);try{let e=await (0,o.getPromptsList)(t);console.log("prompts: ".concat(JSON.stringify(e))),c(e.prompts)}catch(e){console.error("Error fetching prompts:",e)}finally{m(!1)}}};(0,r.useEffect)(()=>{C()},[t]);let Z=()=>{C()},k=async()=>{if(y&&t){v(!0);try{await (0,o.deletePromptCall)(t,y.id),P.Z.success('Prompt "'.concat(y.name,'" deleted successfully')),C()}catch(e){console.error("Error deleting prompt:",e),P.Z.fromBackend("Failed to delete prompt")}finally{v(!1),b(null)}}};return(0,a.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[g?(0,a.jsx)(eh,{onClose:()=>{j(!1)},onSuccess:Z,accessToken:t}):x?(0,a.jsx)(D,{promptId:x,onClose:()=>p(null),accessToken:t,isAdmin:w,onDelete:C}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l.z,{onClick:()=>{x&&p(null),j(!0)},disabled:!t,children:"+ Add New Prompt"}),(0,a.jsx)(l.z,{onClick:()=>{x&&p(null),u(!0)},disabled:!t,variant:"secondary",children:"Upload .prompt File"})]})}),(0,a.jsx)(N,{promptsList:i,isLoading:d,onPromptClick:e=>{p(e)},onDeleteClick:(e,t)=>{b({id:e,name:t})},accessToken:t,isAdmin:w})]}),(0,a.jsx)(F,{visible:h,onClose:()=>{u(!1)},accessToken:t,onSuccess:Z}),y&&(0,a.jsxs)(n.Z,{title:"Delete Prompt",open:null!==y,onOk:k,onCancel:()=>{b(null)},confirmLoading:f,okText:"Delete",okButtonProps:{danger:!0},children:[(0,a.jsxs)("p",{children:["Are you sure you want to delete prompt: ",y.name," ?"]}),(0,a.jsx)("p",{children:"This action cannot be undone."})]})]})}}}]);