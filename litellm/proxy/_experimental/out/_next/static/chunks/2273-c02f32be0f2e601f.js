"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2273],{42273:function(e,s,t){t.d(s,{Z:function(){return Y}});var l=t(57437),a=t(2265),i=t(45822),r=t(23628),n=t(87452),d=t(88829),c=t(72208),o=t(41649),m=t(78489),x=t(12514),h=t(84264),u=t(96761),g=t(10032),j=t(4260),p=t(99981),b=t(37592),f=t(15424),Z=t(30874),_=t(46468),v=t(19250),y=t(9114),N=t(24199),w=t(65925),C=t(59872),S=t(30401),k=t(78867),D=t(5545),M=e=>{let{tagId:s,onClose:t,accessToken:i,is_admin:r,editTag:M}=e,[T]=g.Z.useForm(),[L,I]=(0,a.useState)(null),[E,B]=(0,a.useState)(M),[A,z]=(0,a.useState)([]),[R,F]=(0,a.useState)({}),P=async(e,s)=>{await (0,C.vQ)(e)&&(F(e=>({...e,[s]:!0})),setTimeout(()=>{F(e=>({...e,[s]:!1}))},2e3))},q=async()=>{if(i)try{let l=(await (0,v.tagInfoCall)(i,[s]))[s];if(l&&(I(l),M)){var e,t;T.setFieldsValue({name:l.name,description:l.description,models:l.models,max_budget:null===(e=l.litellm_budget_table)||void 0===e?void 0:e.max_budget,budget_duration:null===(t=l.litellm_budget_table)||void 0===t?void 0:t.budget_duration})}}catch(e){console.error("Error fetching tag details:",e),y.Z.fromBackend("Error fetching tag details: "+e)}};(0,a.useEffect)(()=>{q()},[s,i]),(0,a.useEffect)(()=>{i&&(0,Z.Nr)("dummy-user","Admin",i,z)},[i]);let H=async e=>{if(i)try{await (0,v.tagUpdateCall)(i,{name:e.name,description:e.description,models:e.models,max_budget:e.max_budget,tpm_limit:e.tpm_limit,rpm_limit:e.rpm_limit,budget_duration:e.budget_duration}),y.Z.success("Tag updated successfully"),B(!1),q()}catch(e){console.error("Error updating tag:",e),y.Z.fromBackend("Error updating tag: "+e)}};return L?(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(m.Z,{onClick:t,className:"mb-4",children:"â† Back to Tags"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(h.Z,{className:"font-medium",children:"Tag Name:"}),(0,l.jsx)("span",{className:"font-mono px-2 py-1 bg-gray-100 rounded text-sm border border-gray-200",children:L.name}),(0,l.jsx)(D.ZP,{type:"text",size:"small",icon:R["tag-name"]?(0,l.jsx)(S.Z,{size:12}):(0,l.jsx)(k.Z,{size:12}),onClick:()=>P(L.name,"tag-name"),className:"transition-all duration-200 ".concat(R["tag-name"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100")})]}),(0,l.jsx)(h.Z,{className:"text-gray-500",children:L.description||"No description"})]}),r&&!E&&(0,l.jsx)(m.Z,{onClick:()=>B(!0),children:"Edit Tag"})]}),E?(0,l.jsx)(x.Z,{children:(0,l.jsxs)(g.Z,{form:T,onFinish:H,layout:"vertical",initialValues:L,children:[(0,l.jsx)(g.Z.Item,{label:"Tag Name",name:"name",rules:[{required:!0,message:"Please input a tag name"}],children:(0,l.jsx)(j.default,{className:"rounded-md border-gray-300"})}),(0,l.jsx)(g.Z.Item,{label:"Description",name:"description",children:(0,l.jsx)(j.default.TextArea,{rows:4})}),(0,l.jsx)(g.Z.Item,{label:(0,l.jsxs)("span",{children:["Allowed Models",(0,l.jsx)(p.Z,{title:"Select which models are allowed to process this type of data",children:(0,l.jsx)(f.Z,{style:{marginLeft:"4px"}})})]}),name:"models",children:(0,l.jsx)(b.default,{mode:"multiple",placeholder:"Select Models",children:A.map(e=>(0,l.jsx)(b.default.Option,{value:e,children:(0,_.W0)(e)},e))})}),(0,l.jsxs)(n.Z,{className:"mt-4 mb-4",children:[(0,l.jsx)(c.Z,{children:(0,l.jsx)(u.Z,{className:"m-0",children:"Budget & Rate Limits"})}),(0,l.jsxs)(d.Z,{children:[(0,l.jsx)(g.Z.Item,{label:(0,l.jsxs)("span",{children:["Max Budget (USD)"," ",(0,l.jsx)(p.Z,{title:"Maximum amount in USD this tag can spend",children:(0,l.jsx)(f.Z,{style:{marginLeft:"4px"}})})]}),name:"max_budget",children:(0,l.jsx)(N.Z,{step:.01,precision:2,width:200})}),(0,l.jsx)(g.Z.Item,{label:(0,l.jsxs)("span",{children:["Reset Budget"," ",(0,l.jsx)(p.Z,{title:"How often the budget should reset",children:(0,l.jsx)(f.Z,{style:{marginLeft:"4px"}})})]}),name:"budget_duration",children:(0,l.jsx)(w.Z,{onChange:e=>T.setFieldValue("budget_duration",e)})}),(0,l.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-md border border-gray-200",children:(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["TPM/RPM limits for tags are not currently supported. If you need this feature, please"," ",(0,l.jsx)("a",{href:"https://github.com/BerriAI/litellm/issues/new",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"create a GitHub issue"}),"."]})})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,l.jsx)(m.Z,{onClick:()=>B(!1),children:"Cancel"}),(0,l.jsx)(m.Z,{type:"submit",children:"Save Changes"})]})]})}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)(x.Z,{children:[(0,l.jsx)(u.Z,{children:"Tag Details"}),(0,l.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(h.Z,{className:"font-medium",children:"Name"}),(0,l.jsx)(h.Z,{children:L.name})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.Z,{className:"font-medium",children:"Description"}),(0,l.jsx)(h.Z,{children:L.description||"-"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.Z,{className:"font-medium",children:"Allowed Models"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:L.models&&0!==L.models.length?L.models.map(e=>{var s;return(0,l.jsx)(o.Z,{color:"blue",children:(0,l.jsx)(p.Z,{title:"ID: ".concat(e),children:(null===(s=L.model_info)||void 0===s?void 0:s[e])||e})},e)}):(0,l.jsx)(o.Z,{color:"red",children:"All Models"})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.Z,{className:"font-medium",children:"Created"}),(0,l.jsx)(h.Z,{children:L.created_at?new Date(L.created_at).toLocaleString():"-"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.Z,{className:"font-medium",children:"Last Updated"}),(0,l.jsx)(h.Z,{children:L.updated_at?new Date(L.updated_at).toLocaleString():"-"})]})]})]}),L.litellm_budget_table&&(0,l.jsxs)(x.Z,{children:[(0,l.jsx)(u.Z,{children:"Budget & Rate Limits"}),(0,l.jsxs)("div",{className:"space-y-4 mt-4",children:[void 0!==L.litellm_budget_table.max_budget&&null!==L.litellm_budget_table.max_budget&&(0,l.jsxs)("div",{children:[(0,l.jsx)(h.Z,{className:"font-medium",children:"Max Budget"}),(0,l.jsxs)(h.Z,{children:["$",L.litellm_budget_table.max_budget]})]}),L.litellm_budget_table.budget_duration&&(0,l.jsxs)("div",{children:[(0,l.jsx)(h.Z,{className:"font-medium",children:"Budget Duration"}),(0,l.jsx)(h.Z,{children:L.litellm_budget_table.budget_duration})]}),void 0!==L.litellm_budget_table.tpm_limit&&null!==L.litellm_budget_table.tpm_limit&&(0,l.jsxs)("div",{children:[(0,l.jsx)(h.Z,{className:"font-medium",children:"TPM Limit"}),(0,l.jsx)(h.Z,{children:L.litellm_budget_table.tpm_limit.toLocaleString()})]}),void 0!==L.litellm_budget_table.rpm_limit&&null!==L.litellm_budget_table.rpm_limit&&(0,l.jsxs)("div",{children:[(0,l.jsx)(h.Z,{className:"font-medium",children:"RPM Limit"}),(0,l.jsx)(h.Z,{children:L.litellm_budget_table.rpm_limit.toLocaleString()})]})]})]})]})]}):(0,l.jsx)("div",{children:"Loading..."})},T=t(53410),L=t(74998),I=t(44633),E=t(86462),B=t(49084),A=t(71594),z=t(24525),R=t(47323),F=t(21626),P=t(97214),q=t(28241),H=t(58834),U=t(69552),O=t(71876);let V="This is just a spend tag that was passed dynamically in a request. It does not control any LLM models.";var K=e=>{let{data:s,onEdit:t,onDelete:i,onSelectTag:r}=e,[n,d]=a.useState([{id:"created_at",desc:!0}]),c=[{header:"Tag Name",accessorKey:"name",cell:e=>{let{row:s}=e,t=s.original,a=t.description===V;return(0,l.jsx)("div",{className:"overflow-hidden",children:(0,l.jsx)(p.Z,{title:a?"You cannot view the information of a dynamically generated spend tag":t.name,children:(0,l.jsx)(m.Z,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5",onClick:()=>r(t.name),disabled:a,children:t.name})})})}},{header:"Description",accessorKey:"description",cell:e=>{let{row:s}=e,t=s.original;return(0,l.jsx)(p.Z,{title:t.description,children:(0,l.jsx)("span",{className:"text-xs",children:t.description||"-"})})}},{header:"Allowed Models",accessorKey:"models",cell:e=>{var s,t;let{row:a}=e,i=a.original;return(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(null==i?void 0:null===(s=i.models)||void 0===s?void 0:s.length)===0?(0,l.jsx)(o.Z,{size:"xs",className:"mb-1",color:"red",children:"All Models"}):null==i?void 0:null===(t=i.models)||void 0===t?void 0:t.map(e=>{var s;return(0,l.jsx)(o.Z,{size:"xs",className:"mb-1",color:"blue",children:(0,l.jsx)(p.Z,{title:"ID: ".concat(e),children:(0,l.jsx)(h.Z,{children:(null===(s=i.model_info)||void 0===s?void 0:s[e])||e})})},e)})})}},{header:"Created",accessorKey:"created_at",sortingFn:"datetime",cell:e=>{let{row:s}=e,t=s.original;return(0,l.jsx)("span",{className:"text-xs",children:new Date(t.created_at).toLocaleDateString()})}},{id:"actions",header:"Actions",cell:e=>{let{row:s}=e,a=s.original,r=a.description===V;return(0,l.jsxs)("div",{className:"flex space-x-2",children:[r?(0,l.jsx)(p.Z,{title:"Dynamically generated spend tags cannot be edited",children:(0,l.jsx)(R.Z,{icon:T.Z,size:"sm",className:"opacity-50 cursor-not-allowed","aria-label":"Edit tag (disabled)"})}):(0,l.jsx)(p.Z,{title:"Edit tag",children:(0,l.jsx)(R.Z,{icon:T.Z,size:"sm",onClick:()=>t(a),className:"cursor-pointer hover:text-blue-500"})}),r?(0,l.jsx)(p.Z,{title:"Dynamically generated spend tags cannot be deleted",children:(0,l.jsx)(R.Z,{icon:L.Z,size:"sm",className:"opacity-50 cursor-not-allowed","aria-label":"Delete tag (disabled)"})}):(0,l.jsx)(p.Z,{title:"Delete tag",children:(0,l.jsx)(R.Z,{icon:L.Z,size:"sm",onClick:()=>i(a.name),className:"cursor-pointer hover:text-red-500"})})]})}}],x=(0,A.b7)({data:s,columns:c,state:{sorting:n},onSortingChange:d,getCoreRowModel:(0,z.sC)(),getSortedRowModel:(0,z.tj)(),enableSorting:!0});return(0,l.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(F.Z,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,l.jsx)(H.Z,{children:x.getHeaderGroups().map(e=>(0,l.jsx)(O.Z,{children:e.headers.map(e=>(0,l.jsx)(U.Z,{className:"py-1 h-8 ".concat("actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),onClick:e.column.getToggleSortingHandler(),children:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,A.ie)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&(0,l.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,l.jsx)(I.Z,{className:"h-4 w-4 text-blue-500"}),desc:(0,l.jsx)(E.Z,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,l.jsx)(B.Z,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,l.jsx)(P.Z,{children:x.getRowModel().rows.length>0?x.getRowModel().rows.map(e=>(0,l.jsx)(O.Z,{className:"h-8",children:e.getVisibleCells().map(e=>(0,l.jsx)(q.Z,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ".concat("actions"===e.column.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""),children:(0,A.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,l.jsx)(O.Z,{children:(0,l.jsx)(q.Z,{colSpan:c.length,className:"h-8 text-center",children:(0,l.jsx)("div",{className:"text-center text-gray-500",children:(0,l.jsx)("p",{children:"No tags found"})})})})})]})})})},G=t(49566),J=t(22116),W=e=>{let{visible:s,onCancel:t,onSubmit:a,availableModels:i}=e,[r]=g.Z.useForm();return(0,l.jsx)(J.Z,{title:"Create New Tag",visible:s,width:800,footer:null,onCancel:()=>{r.resetFields(),t()},children:(0,l.jsxs)(g.Z,{form:r,onFinish:e=>{a(e),r.resetFields()},labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsx)(g.Z.Item,{label:"Tag Name",name:"tag_name",rules:[{required:!0,message:"Please input a tag name"}],children:(0,l.jsx)(G.Z,{})}),(0,l.jsx)(g.Z.Item,{label:"Description",name:"description",children:(0,l.jsx)(j.default.TextArea,{rows:4})}),(0,l.jsx)(g.Z.Item,{label:(0,l.jsxs)("span",{children:["Allowed Models",(0,l.jsx)(p.Z,{title:"Select which models are allowed to process requests from this tag",children:(0,l.jsx)(f.Z,{style:{marginLeft:"4px"}})})]}),name:"allowed_llms",children:(0,l.jsx)(b.default,{mode:"multiple",placeholder:"Select Models",children:i.map(e=>(0,l.jsx)(b.default.Option,{value:e.model_info.id,children:(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{children:e.model_name}),(0,l.jsxs)("span",{className:"text-gray-400 ml-2",children:["(",e.model_info.id,")"]})]})},e.model_info.id))})}),(0,l.jsxs)(n.Z,{className:"mt-4 mb-4",children:[(0,l.jsx)(c.Z,{children:(0,l.jsx)(u.Z,{className:"m-0",children:"Budget & Rate Limits (Optional)"})}),(0,l.jsxs)(d.Z,{children:[(0,l.jsx)(g.Z.Item,{className:"mt-4",label:(0,l.jsxs)("span",{children:["Max Budget (USD)"," ",(0,l.jsx)(p.Z,{title:"Maximum amount in USD this tag can spend. When reached, requests with this tag will be blocked",children:(0,l.jsx)(f.Z,{style:{marginLeft:"4px"}})})]}),name:"max_budget",children:(0,l.jsx)(N.Z,{step:.01,precision:2,width:200})}),(0,l.jsx)(g.Z.Item,{className:"mt-4",label:(0,l.jsxs)("span",{children:["Reset Budget"," ",(0,l.jsx)(p.Z,{title:"How often the budget should reset. For example, setting 'daily' will reset the budget every 24 hours",children:(0,l.jsx)(f.Z,{style:{marginLeft:"4px"}})})]}),name:"budget_duration",children:(0,l.jsx)(w.Z,{onChange:e=>r.setFieldValue("budget_duration",e)})}),(0,l.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-md border border-gray-200",children:(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["TPM/RPM limits for tags are not currently supported. If you need this feature, please"," ",(0,l.jsx)("a",{href:"https://github.com/BerriAI/litellm/issues/new",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"create a GitHub issue"}),"."]})})]})]}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(m.Z,{type:"submit",children:"Create Tag"})})]})})},Y=e=>{let{accessToken:s,userID:t,userRole:n}=e,[d,c]=(0,a.useState)([]),[o,m]=(0,a.useState)(!1),[x,h]=(0,a.useState)(null),[u,g]=(0,a.useState)(!1),[j,p]=(0,a.useState)(!1),[b,f]=(0,a.useState)(null),[Z,_]=(0,a.useState)(""),[N,w]=(0,a.useState)([]),C=async()=>{if(s)try{let e=await (0,v.tagListCall)(s);console.log("List tags response:",e),c(Object.values(e))}catch(e){console.error("Error fetching tags:",e),y.Z.fromBackend("Error fetching tags: "+e)}},S=async e=>{if(s)try{await (0,v.tagCreateCall)(s,{name:e.tag_name,description:e.description,models:e.allowed_llms,max_budget:e.max_budget,soft_budget:e.soft_budget,tpm_limit:e.tpm_limit,rpm_limit:e.rpm_limit,budget_duration:e.budget_duration}),y.Z.success("Tag created successfully"),m(!1),C()}catch(e){console.error("Error creating tag:",e),y.Z.fromBackend("Error creating tag: "+e)}},k=async e=>{f(e),p(!0)},D=async()=>{if(s&&b){try{await (0,v.tagDeleteCall)(s,b),y.Z.success("Tag deleted successfully"),C()}catch(e){console.error("Error deleting tag:",e),y.Z.fromBackend("Error deleting tag: "+e)}p(!1),f(null)}};return(0,a.useEffect)(()=>{t&&n&&s&&(async()=>{try{let e=await (0,v.modelInfoCall)(s,t,n);e&&e.data&&w(e.data)}catch(e){console.error("Error fetching models:",e),y.Z.fromBackend("Error fetching models: "+e)}})()},[s,t,n]),(0,a.useEffect)(()=>{C()},[s]),(0,l.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:x?(0,l.jsx)(M,{tagId:x,onClose:()=>{h(null),g(!1)},accessToken:s,is_admin:"Admin"===n,editTag:u}):(0,l.jsxs)("div",{className:"gap-2 p-8 h-[75vh] w-full mt-2",children:[(0,l.jsxs)("div",{className:"flex justify-between mt-2 w-full items-center mb-4",children:[(0,l.jsx)("h1",{children:"Tag Management"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[Z&&(0,l.jsxs)(i.xv,{children:["Last Refreshed: ",Z]}),(0,l.jsx)(i.JO,{icon:r.Z,variant:"shadow",size:"xs",className:"self-center cursor-pointer",onClick:()=>{C(),_(new Date().toLocaleString())}})]})]}),(0,l.jsxs)(i.xv,{className:"mb-4",children:["Click on a tag name to view and edit its details.",(0,l.jsxs)("p",{children:["You can use tags to restrict the usage of certain LLMs based on tags passed in the request. Read more about tag routing"," ",(0,l.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/tag_routing",target:"_blank",rel:"noopener noreferrer",children:"here"}),"."]})]}),(0,l.jsx)(i.zx,{className:"mb-4",onClick:()=>m(!0),children:"+ Create New Tag"}),(0,l.jsx)(i.rj,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:(0,l.jsx)(i.JX,{numColSpan:1,children:(0,l.jsx)(K,{data:d,onEdit:e=>{h(e.name),g(!0)},onDelete:k,onSelectTag:h})})}),(0,l.jsx)(W,{visible:o,onCancel:()=>m(!1),onSubmit:S,availableModels:N}),j&&(0,l.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,l.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,l.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,l.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,l.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,l.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,l.jsx)("div",{className:"sm:flex sm:items-start",children:(0,l.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,l.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete Tag"}),(0,l.jsx)("div",{className:"mt-2",children:(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this tag?"})})]})})}),(0,l.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,l.jsx)(i.zx,{onClick:D,color:"red",className:"ml-2",children:"Delete"}),(0,l.jsx)(i.zx,{onClick:()=>{p(!1),f(null)},children:"Cancel"})]})]})]})})]})})}}}]);