(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,936190,e=>{"use strict";e.s(["RequestViewer",()=>tj,"default",()=>tf],936190);var s,t,a=e.i(843476),l=e.i(266027),r=e.i(912598),n=e.i(166540),i=e.i(271645),o=e.i(592968),d=e.i(362024);let c=e=>e>=.8?"text-green-600":"text-yellow-600",m=({entities:e})=>{let[s,t]=(0,i.useState)(!0),[l,r]=(0,i.useState)({});return e&&0!==e.length?(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2 cursor-pointer",onClick:()=>t(!s),children:[(0,a.jsx)("svg",{className:`w-5 h-5 mr-2 transition-transform ${s?"transform rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,a.jsxs)("h4",{className:"font-medium",children:["Detected Entities (",e.length,")"]})]}),s&&(0,a.jsx)("div",{className:"space-y-2",children:e.map((e,s)=>{let t=l[s]||!1;return(0,a.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>{r(e=>({...e,[s]:!e[s]}))},children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("svg",{className:`w-5 h-5 mr-2 transition-transform ${t?"transform rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,a.jsx)("span",{className:"font-medium mr-2",children:e.entity_type}),(0,a.jsxs)("span",{className:`font-mono ${c(e.score)}`,children:["Score: ",e.score.toFixed(2)]})]}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Position: ",e.start,"-",e.end]})]}),t&&(0,a.jsx)("div",{className:"p-3 border-t bg-white",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Entity Type:"}),(0,a.jsx)("span",{children:e.entity_type})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Position:"}),(0,a.jsxs)("span",{children:["Characters ",e.start,"-",e.end]})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Confidence:"}),(0,a.jsx)("span",{className:c(e.score),children:e.score.toFixed(2)})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[e.recognition_metadata&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Recognizer:"}),(0,a.jsx)("span",{children:e.recognition_metadata.recognizer_name})]}),(0,a.jsxs)("div",{className:"flex overflow-hidden",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Identifier:"}),(0,a.jsx)("span",{className:"truncate text-xs font-mono",children:e.recognition_metadata.recognizer_identifier})]})]}),e.analysis_explanation&&(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Explanation:"}),(0,a.jsx)("span",{children:e.analysis_explanation})]})]})]})})]},s)})})]}):null},x=(e,s="slate")=>(0,a.jsx)("span",{className:`px-2 py-1 rounded-md text-xs font-medium inline-block ${{green:"bg-green-100 text-green-800",red:"bg-red-100 text-red-800",blue:"bg-blue-50 text-blue-700",slate:"bg-slate-100 text-slate-800",amber:"bg-amber-100 text-amber-800"}[s]}`,children:e}),u=e=>e?x("detected","red"):x("not detected","slate"),h=({title:e,count:s,defaultOpen:t=!0,right:l,children:r})=>{let[n,o]=(0,i.useState)(t);return(0,a.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>o(e=>!e),children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("svg",{className:`w-5 h-5 mr-2 transition-transform ${n?"transform rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,a.jsxs)("h5",{className:"font-medium",children:[e," ","number"==typeof s&&(0,a.jsxs)("span",{className:"text-gray-500 font-normal",children:["(",s,")"]})]})]}),(0,a.jsx)("div",{children:l})]}),n&&(0,a.jsx)("div",{className:"p-3 border-t bg-white",children:r})]})},p=({label:e,children:s,mono:t})=>(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:e}),(0,a.jsx)("span",{className:t?"font-mono text-sm break-all":"",children:s})]}),g=()=>(0,a.jsx)("div",{className:"my-3 border-t"}),f=({response:e})=>{if(!e)return null;let s=e.outputs??e.output??[],t="GUARDRAIL_INTERVENED"===e.action?"red":"green",l=(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[e.guardrailCoverage?.textCharacters&&x(`text guarded ${e.guardrailCoverage.textCharacters.guarded??0}/${e.guardrailCoverage.textCharacters.total??0}`,"blue"),e.guardrailCoverage?.images&&x(`images guarded ${e.guardrailCoverage.images.guarded??0}/${e.guardrailCoverage.images.total??0}`,"blue")]}),r=e.usage&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(e.usage).map(([e,s])=>"number"==typeof s?(0,a.jsxs)("span",{className:"px-2 py-1 bg-slate-100 text-slate-800 rounded-md text-xs font-medium",children:[e,": ",s]},e):null)});return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p,{label:"Action:",children:x(e.action??"N/A",t)}),e.actionReason&&(0,a.jsx)(p,{label:"Action Reason:",children:e.actionReason}),e.blockedResponse&&(0,a.jsx)(p,{label:"Blocked Response:",children:(0,a.jsx)("span",{className:"italic",children:e.blockedResponse})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p,{label:"Coverage:",children:l}),(0,a.jsx)(p,{label:"Usage:",children:r})]})]}),s.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g,{}),(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Outputs"}),(0,a.jsx)("div",{className:"space-y-2",children:s.map((e,s)=>(0,a.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,a.jsx)("div",{className:"text-sm whitespace-pre-wrap",children:e.text??(0,a.jsx)("em",{children:"(non-text output)"})})},s))})]})]}),e.assessments?.length?(0,a.jsx)("div",{className:"space-y-3",children:e.assessments.map((e,s)=>{let t=(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.wordPolicy&&x("word","slate"),e.contentPolicy&&x("content","slate"),e.topicPolicy&&x("topic","slate"),e.sensitiveInformationPolicy&&x("sensitive-info","slate"),e.contextualGroundingPolicy&&x("contextual-grounding","slate"),e.automatedReasoningPolicy&&x("automated-reasoning","slate")]});return(0,a.jsxs)(h,{title:`Assessment #${s+1}`,defaultOpen:!0,right:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[e.invocationMetrics?.guardrailProcessingLatency!=null&&x(`${e.invocationMetrics.guardrailProcessingLatency} ms`,"amber"),t]}),children:[e.wordPolicy&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h6",{className:"font-medium mb-2",children:"Word Policy"}),(e.wordPolicy.customWords?.length??0)>0&&(0,a.jsx)(h,{title:"Custom Words",defaultOpen:!0,children:(0,a.jsx)("div",{className:"space-y-2",children:e.wordPolicy.customWords.map((e,s)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[x(e.action??"N/A",e.detected?"red":"slate"),(0,a.jsx)("span",{className:"font-mono text-sm break-all",children:e.match})]}),u(e.detected)]},s))})}),(e.wordPolicy.managedWordLists?.length??0)>0&&(0,a.jsx)(h,{title:"Managed Word Lists",defaultOpen:!1,children:(0,a.jsx)("div",{className:"space-y-2",children:e.wordPolicy.managedWordLists.map((e,s)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[x(e.action??"N/A",e.detected?"red":"slate"),(0,a.jsx)("span",{className:"font-mono text-sm break-all",children:e.match}),e.type&&x(e.type,"slate")]}),u(e.detected)]},s))})})]}),e.contentPolicy?.filters?.length?(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h6",{className:"font-medium mb-2",children:"Content Policy"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-left text-gray-600",children:[(0,a.jsx)("th",{className:"py-1 pr-4",children:"Type"}),(0,a.jsx)("th",{className:"py-1 pr-4",children:"Action"}),(0,a.jsx)("th",{className:"py-1 pr-4",children:"Detected"}),(0,a.jsx)("th",{className:"py-1 pr-4",children:"Strength"}),(0,a.jsx)("th",{className:"py-1 pr-4",children:"Confidence"})]})}),(0,a.jsx)("tbody",{children:e.contentPolicy.filters.map((e,s)=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"py-1 pr-4",children:e.type??"â€”"}),(0,a.jsx)("td",{className:"py-1 pr-4",children:x(e.action??"â€”",e.detected?"red":"slate")}),(0,a.jsx)("td",{className:"py-1 pr-4",children:u(e.detected)}),(0,a.jsx)("td",{className:"py-1 pr-4",children:e.filterStrength??"â€”"}),(0,a.jsx)("td",{className:"py-1 pr-4",children:e.confidence??"â€”"})]},s))})]})})]}):null,e.contextualGroundingPolicy?.filters?.length?(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h6",{className:"font-medium mb-2",children:"Contextual Grounding"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-left text-gray-600",children:[(0,a.jsx)("th",{className:"py-1 pr-4",children:"Type"}),(0,a.jsx)("th",{className:"py-1 pr-4",children:"Action"}),(0,a.jsx)("th",{className:"py-1 pr-4",children:"Detected"}),(0,a.jsx)("th",{className:"py-1 pr-4",children:"Score"}),(0,a.jsx)("th",{className:"py-1 pr-4",children:"Threshold"})]})}),(0,a.jsx)("tbody",{children:e.contextualGroundingPolicy.filters.map((e,s)=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"py-1 pr-4",children:e.type??"â€”"}),(0,a.jsx)("td",{className:"py-1 pr-4",children:x(e.action??"â€”",e.detected?"red":"slate")}),(0,a.jsx)("td",{className:"py-1 pr-4",children:u(e.detected)}),(0,a.jsx)("td",{className:"py-1 pr-4",children:e.score??"â€”"}),(0,a.jsx)("td",{className:"py-1 pr-4",children:e.threshold??"â€”"})]},s))})]})})]}):null,e.sensitiveInformationPolicy&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h6",{className:"font-medium mb-2",children:"Sensitive Information"}),(e.sensitiveInformationPolicy.piiEntities?.length??0)>0&&(0,a.jsx)(h,{title:"PII Entities",defaultOpen:!0,children:(0,a.jsx)("div",{className:"space-y-2",children:e.sensitiveInformationPolicy.piiEntities.map((e,s)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[x(e.action??"N/A",e.detected?"red":"slate"),e.type&&x(e.type,"slate"),(0,a.jsx)("span",{className:"font-mono text-xs break-all",children:e.match})]}),u(e.detected)]},s))})}),(e.sensitiveInformationPolicy.regexes?.length??0)>0&&(0,a.jsx)(h,{title:"Custom Regexes",defaultOpen:!1,children:(0,a.jsx)("div",{className:"space-y-2",children:e.sensitiveInformationPolicy.regexes.map((e,s)=>(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-2 bg-gray-50 rounded gap-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[x(e.action??"N/A",e.detected?"red":"slate"),(0,a.jsx)("span",{className:"font-medium",children:e.name??"regex"}),(0,a.jsx)("span",{className:"font-mono text-xs break-all",children:e.regex})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[u(e.detected),e.match&&(0,a.jsx)("span",{className:"font-mono text-xs break-all",children:e.match})]})]},s))})})]}),e.topicPolicy?.topics?.length?(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h6",{className:"font-medium mb-2",children:"Topic Policy"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.topicPolicy.topics.map((e,s)=>(0,a.jsx)("div",{className:"px-3 py-1.5 bg-gray-50 rounded-md text-xs",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[x(e.action??"N/A",e.detected?"red":"slate"),(0,a.jsx)("span",{className:"font-medium",children:e.name??"topic"}),e.type&&x(e.type,"slate"),u(e.detected)]})},s))})]}):null,e.invocationMetrics&&(0,a.jsx)(h,{title:"Invocation Metrics",defaultOpen:!1,children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p,{label:"Latency (ms)",children:e.invocationMetrics.guardrailProcessingLatency??"â€”"}),(0,a.jsx)(p,{label:"Coverage:",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[e.invocationMetrics.guardrailCoverage?.textCharacters&&x(`text ${e.invocationMetrics.guardrailCoverage.textCharacters.guarded??0}/${e.invocationMetrics.guardrailCoverage.textCharacters.total??0}`,"blue"),e.invocationMetrics.guardrailCoverage?.images&&x(`images ${e.invocationMetrics.guardrailCoverage.images.guarded??0}/${e.invocationMetrics.guardrailCoverage.images.total??0}`,"blue")]})})]}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(p,{label:"Usage:",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.invocationMetrics.usage&&Object.entries(e.invocationMetrics.usage).map(([e,s])=>"number"==typeof s?(0,a.jsxs)("span",{className:"px-2 py-1 bg-slate-100 text-slate-800 rounded-md text-xs font-medium",children:[e,": ",s]},e):null)})})})]})}),e.automatedReasoningPolicy?.findings?.length?(0,a.jsx)(h,{title:"Automated Reasoning Findings",defaultOpen:!1,children:(0,a.jsx)("div",{className:"space-y-2",children:e.automatedReasoningPolicy.findings.map((e,s)=>(0,a.jsx)("pre",{className:"bg-gray-50 rounded p-2 text-xs overflow-x-auto",children:JSON.stringify(e,null,2)},s))})}):null]},s)})}):null,(0,a.jsx)(h,{title:"Raw Bedrock Guardrail Response",defaultOpen:!1,children:(0,a.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(e,null,2)})})]})},j=(e,s="slate")=>(0,a.jsx)("span",{className:`px-2 py-1 rounded-md text-xs font-medium inline-block ${{green:"bg-green-100 text-green-800",red:"bg-red-100 text-red-800",blue:"bg-blue-50 text-blue-700",slate:"bg-slate-100 text-slate-800",amber:"bg-amber-100 text-amber-800"}[s]}`,children:e}),y=({title:e,count:s,defaultOpen:t=!0,children:l})=>{let[r,n]=(0,i.useState)(t);return(0,a.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>n(e=>!e),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("svg",{className:`w-5 h-5 mr-2 transition-transform ${r?"transform rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,a.jsxs)("h5",{className:"font-medium",children:[e," ","number"==typeof s&&(0,a.jsxs)("span",{className:"text-gray-500 font-normal",children:["(",s,")"]})]})]})}),r&&(0,a.jsx)("div",{className:"p-3 border-t bg-white",children:l})]})},b=({label:e,children:s,mono:t})=>(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:e}),(0,a.jsx)("span",{className:t?"font-mono text-sm break-all":"",children:s})]}),v=({response:e})=>{if(!e||"string"==typeof e)return"string"==typeof e&&e?(0,a.jsx)("div",{className:"bg-white rounded-lg border border-red-200 p-4",children:(0,a.jsxs)("div",{className:"text-red-800",children:[(0,a.jsx)("h5",{className:"font-medium mb-2",children:"Error"}),(0,a.jsx)("p",{className:"text-sm",children:e})]})}):null;let s=Array.isArray(e)?e:[];if(0===s.length)return(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"No detections found"})});let t=s.filter(e=>"pattern"===e.type),l=s.filter(e=>"blocked_word"===e.type),r=s.filter(e=>"category_keyword"===e.type),n=s.filter(e=>"BLOCK"===e.action).length,i=s.filter(e=>"MASK"===e.action).length,o=s.length;return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(b,{label:"Total Detections:",children:(0,a.jsx)("span",{className:"font-semibold",children:o})}),(0,a.jsx)(b,{label:"Actions:",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[n>0&&j(`${n} blocked`,"red"),i>0&&j(`${i} masked`,"blue"),0===n&&0===i&&j("passed","green")]})})]}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(b,{label:"By Type:",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[t.length>0&&j(`${t.length} patterns`,"slate"),l.length>0&&j(`${l.length} keywords`,"slate"),r.length>0&&j(`${r.length} categories`,"slate")]})})})]})}),t.length>0&&(0,a.jsx)(y,{title:"Patterns Matched",count:t.length,defaultOpen:!0,children:(0,a.jsx)("div",{className:"space-y-2",children:t.map((e,s)=>(0,a.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)(b,{label:"Pattern:",children:e.pattern_name||"unknown"})}),(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)(b,{label:"Action:",children:j(e.action,"BLOCK"===e.action?"red":"blue")})})]})},s))})}),l.length>0&&(0,a.jsx)(y,{title:"Blocked Words Detected",count:l.length,defaultOpen:!0,children:(0,a.jsx)("div",{className:"space-y-2",children:l.map((e,s)=>(0,a.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(b,{label:"Keyword:",mono:!0,children:e.keyword||"unknown"}),e.description&&(0,a.jsx)(b,{label:"Description:",children:e.description})]}),(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)(b,{label:"Action:",children:j(e.action,"BLOCK"===e.action?"red":"blue")})})]})},s))})}),r.length>0&&(0,a.jsx)(y,{title:"Category Keywords Detected",count:r.length,defaultOpen:!0,children:(0,a.jsx)("div",{className:"space-y-2",children:r.map((e,s)=>(0,a.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(b,{label:"Category:",children:e.category||"unknown"}),(0,a.jsx)(b,{label:"Keyword:",mono:!0,children:e.keyword||"unknown"}),e.severity&&(0,a.jsx)(b,{label:"Severity:",children:j(e.severity,"high"===e.severity?"red":"medium"===e.severity?"amber":"slate")})]}),(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)(b,{label:"Action:",children:j(e.action,"BLOCK"===e.action?"red":"blue")})})]})},s))})}),(0,a.jsx)(y,{title:"Raw Detection Data",defaultOpen:!1,children:(0,a.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(s,null,2)})})]})},N=e=>new Date(1e3*e).toLocaleString(),w=new Set(["presidio","bedrock","litellm_content_filter"]),_=({response:e})=>{let[s,t]=(0,i.useState)(!1);return(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>t(!s),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("svg",{className:`w-5 h-5 mr-2 transition-transform ${s?"transform rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,a.jsx)("h5",{className:"font-medium",children:"Raw Guardrail Response"})]})}),s&&(0,a.jsx)("div",{className:"p-3 border-t bg-white",children:(0,a.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-x-auto",children:JSON.stringify(e,null,2)})})]})})},k=({entry:e,index:s,total:t})=>{let l=e.guardrail_provider??"presidio",r=e.guardrail_status??"unknown",n="success"===r.toLowerCase(),i=e.masked_entity_count||{},d=Object.values(i).reduce((e,s)=>e+("number"==typeof s?s:0),0),c=e.guardrail_response,x=Array.isArray(c)?c:[],u="bedrock"!==l||null===c||"object"!=typeof c||Array.isArray(c)?void 0:c;return(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[t>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h4",{className:"text-base font-semibold",children:["Guardrail #",s+1,(0,a.jsx)("span",{className:"ml-2 font-mono text-sm text-gray-600",children:e.guardrail_name})]}),(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded-md text-xs capitalize",children:l})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail Name:"}),(0,a.jsx)("span",{className:"font-mono break-words",children:e.guardrail_name})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Mode:"}),(0,a.jsx)("span",{className:"font-mono break-words",children:e.guardrail_mode})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,a.jsx)(o.Tooltip,{title:n?null:"Guardrail failed to run.",placement:"top",arrow:!0,destroyTooltipOnHide:!0,children:(0,a.jsx)("span",{className:`px-2 py-1 rounded-md text-xs font-medium inline-block ${n?"bg-green-100 text-green-800":"bg-red-100 text-red-800 cursor-help"}`,children:r})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,a.jsx)("span",{children:N(e.start_time)})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,a.jsx)("span",{children:N(e.end_time)})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,a.jsxs)("span",{children:[e.duration.toFixed(4),"s"]})]})]})]}),d>0&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,a.jsx)("h5",{className:"font-medium mb-2",children:"Masked Entity Summary"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(i).map(([e,s])=>(0,a.jsxs)("span",{className:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[e,": ",s]},e))})]}),"presidio"===l&&x.length>0&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(m,{entities:x})}),"bedrock"===l&&u&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(f,{response:u})}),"litellm_content_filter"===l&&c&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(v,{response:c})}),l&&!w.has(l)&&c&&(0,a.jsx)(_,{response:c})]})},S=({data:e})=>{let s=Array.isArray(e)?e.filter(e=>!!e):e?[e]:[],t=1===s.length?s[0].guardrail_name:`${s.length} guardrails`,l=Array.from(new Set(s.map(e=>e.guardrail_status))).every(e=>"success"===(e??"").toLowerCase()),r=s.reduce((e,s)=>e+Object.values(s.masked_entity_count||{}).reduce((e,s)=>e+("number"==typeof s?s:0),0),0);return 0===s.length?null:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,a.jsx)(d.Collapse,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Guardrail Information"}),(0,a.jsx)(o.Tooltip,{title:l?null:"Guardrail failed to run.",placement:"top",arrow:!0,destroyTooltipOnHide:!0,children:(0,a.jsx)("span",{className:`px-2 py-1 rounded-md text-xs font-medium inline-block ${l?"bg-green-100 text-green-800":"bg-red-100 text-red-800 cursor-help"}`,children:l?"success":"failure"})}),(0,a.jsx)("span",{className:"font-mono text-sm text-gray-600",children:t}),r>0&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[r," masked ",1===r?"entity":"entities"]})]}),children:(0,a.jsx)("div",{className:"p-4 space-y-6",children:s.map((e,t)=>(0,a.jsx)(k,{entry:e,index:t,total:s.length},`${e.guardrail_name??"guardrail"}-${t}`))})}]})})};var C=e.i(500330),T=e.i(122550),L=e.i(313603),M=e.i(793130),D=e.i(197647),z=e.i(653824),R=e.i(881073),I=e.i(404206),E=e.i(723731),A=e.i(464571),O=e.i(708347),B=e.i(207082),P=e.i(871943),F=e.i(360820),q=e.i(94629),$=e.i(152990),K=e.i(682830),H=e.i(269200),V=e.i(942232),Y=e.i(977572),W=e.i(427612),J=e.i(64848),U=e.i(496020);function G({keys:e,totalCount:s,isLoading:t,isFetching:l,pageIndex:r,pageSize:n,onPageChange:d}){let[c,m]=(0,i.useState)([{id:"deleted_at",desc:!0}]),[x,u]=(0,i.useState)({pageIndex:r,pageSize:n});i.default.useEffect(()=>{u({pageIndex:r,pageSize:n})},[r,n]);let h=[{id:"token",accessorKey:"token",header:"Key ID",size:150,maxSize:250,cell:e=>{let s=e.getValue();return(0,a.jsx)(o.Tooltip,{title:s,children:(0,a.jsx)("span",{className:"font-mono text-blue-500 text-xs truncate block max-w-[250px]",children:s||"-"})})}},{id:"key_alias",accessorKey:"key_alias",header:"Key Alias",size:150,maxSize:200,cell:e=>{let s=e.getValue();return(0,a.jsx)(o.Tooltip,{title:s,children:(0,a.jsx)("span",{className:"font-mono text-xs truncate block max-w-[200px]",children:s??"-"})})}},{id:"team_alias",accessorKey:"team_alias",header:"Team Alias",size:120,maxSize:180,cell:e=>{let s=e.getValue();return(0,a.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",size:100,maxSize:140,cell:e=>(0,a.jsx)("span",{className:"block max-w-[140px]",children:(0,C.formatNumberWithCommas)(e.getValue(),4)})},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",size:110,maxSize:150,cell:e=>{let s=e.getValue();return(0,a.jsx)("span",{className:"block max-w-[150px]",children:null===s?"Unlimited":`$${(0,C.formatNumberWithCommas)(s)}`})}},{id:"user_email",accessorKey:"user_email",header:"User Email",size:160,maxSize:250,cell:e=>{let s=e.getValue();return(0,a.jsx)(o.Tooltip,{title:s,children:(0,a.jsx)("span",{className:"font-mono text-xs truncate block max-w-[250px]",children:s??"-"})})}},{id:"user_id",accessorKey:"user_id",header:"User ID",size:120,maxSize:200,cell:e=>{let s=e.getValue();return(0,a.jsx)(o.Tooltip,{title:s||void 0,children:(0,a.jsx)("span",{className:"truncate block max-w-[200px]",children:s||"-"})})}},{id:"created_at",accessorKey:"created_at",header:"Created At",size:120,maxSize:140,cell:e=>{let s=e.getValue();return(0,a.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"created_by",accessorKey:"created_by",header:"Created By",size:120,maxSize:180,cell:e=>{let s=e.row.original.created_by;return(0,a.jsx)(o.Tooltip,{title:s||void 0,children:(0,a.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})})}},{id:"deleted_at",accessorKey:"deleted_at",header:"Deleted At",size:120,maxSize:140,cell:e=>{let s=e.row.original.deleted_at;return(0,a.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"deleted_by",accessorKey:"deleted_by",header:"Deleted By",size:120,maxSize:180,cell:e=>{let s=e.row.original.deleted_by;return(0,a.jsx)(o.Tooltip,{title:s||void 0,children:(0,a.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})})}}],p=(0,$.useReactTable)({data:e,columns:h,columnResizeMode:"onChange",columnResizeDirection:"ltr",state:{sorting:c,pagination:x},onSortingChange:m,onPaginationChange:e=>{let s="function"==typeof e?e(x):e;u(s),d(s.pageIndex)},getCoreRowModel:(0,K.getCoreRowModel)(),getSortedRowModel:(0,K.getSortedRowModel)(),getPaginationRowModel:(0,K.getPaginationRowModel)(),enableSorting:!0,manualSorting:!1,manualPagination:!0,pageCount:Math.ceil(s/n)}),{pageIndex:g}=p.getState().pagination,f=g*n+1,j=Math.min((g+1)*n,s),y=`${f} - ${j}`;return(0,a.jsx)("div",{className:"w-full h-full overflow-hidden",children:(0,a.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between w-full mb-4",children:[t||l?(0,a.jsx)("span",{className:"inline-flex text-sm text-gray-700",children:"Loading..."}):(0,a.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",y," of ",s," results"]}),(0,a.jsxs)("div",{className:"inline-flex items-center gap-2",children:[t||l?(0,a.jsx)("span",{className:"text-sm text-gray-700",children:"Loading..."}):(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",g+1," of ",p.getPageCount()]}),(0,a.jsx)("button",{onClick:()=>p.previousPage(),disabled:t||l||!p.getCanPreviousPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>p.nextPage(),disabled:t||l||!p.getCanNextPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),(0,a.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,a.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(H.Table,{className:"[&_td]:py-0.5 [&_th]:py-1",style:{width:p.getCenterTotalSize()},children:[(0,a.jsx)(W.TableHead,{children:p.getHeaderGroups().map(e=>(0,a.jsx)(U.TableRow,{children:e.headers.map(e=>(0,a.jsx)(J.TableHeaderCell,{"data-header-id":e.id,className:"py-1 h-8 relative hover:bg-gray-50",style:{width:e.getSize(),maxWidth:e.column.columnDef.maxSize,position:"relative"},onMouseEnter:()=>{let s=document.querySelector(`[data-header-id="${e.id}"] .resizer`);s&&(s.style.opacity="0.5")},onMouseLeave:()=>{let s=document.querySelector(`[data-header-id="${e.id}"] .resizer`);s&&!e.column.getIsResizing()&&(s.style.opacity="0")},onClick:e.column.getToggleSortingHandler(),children:(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,$.flexRender)(e.column.columnDef.header,e.getContext())}),(0,a.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,a.jsx)(F.ChevronUpIcon,{className:"h-4 w-4 text-blue-500"}),desc:(0,a.jsx)(P.ChevronDownIcon,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,a.jsx)(q.SwitchVerticalIcon,{className:"h-4 w-4 text-gray-400"})}),(0,a.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:`resizer ${p.options.columnResizeDirection} ${e.column.getIsResizing()?"isResizing":""}`,style:{position:"absolute",right:0,top:0,height:"100%",width:"5px",background:e.column.getIsResizing()?"#3b82f6":"transparent",cursor:"col-resize",userSelect:"none",touchAction:"none",opacity:+!!e.column.getIsResizing()}})]})},e.id))},e.id))}),(0,a.jsx)(V.TableBody,{children:t||l?(0,a.jsx)(U.TableRow,{children:(0,a.jsx)(Y.TableCell,{colSpan:h.length,className:"h-8 text-center",children:(0,a.jsx)("div",{className:"text-center text-gray-500",children:(0,a.jsx)("p",{children:"ðŸš… Loading keys..."})})})}):e.length>0?p.getRowModel().rows.map(e=>(0,a.jsx)(U.TableRow,{className:"h-8",children:e.getVisibleCells().map(e=>(0,a.jsx)(Y.TableCell,{style:{width:e.column.getSize(),maxWidth:e.column.columnDef.maxSize,whiteSpace:"pre-wrap",overflow:"hidden"},className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,$.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,a.jsx)(U.TableRow,{children:(0,a.jsx)(Y.TableCell,{colSpan:h.length,className:"h-8 text-center",children:(0,a.jsx)("div",{className:"text-center text-gray-500",children:(0,a.jsx)("p",{children:"No deleted keys found"})})})})})]})})})})]})})}function Q(){let[e,s]=(0,i.useState)(0),[t]=(0,i.useState)(50),{data:l,isPending:r,isFetching:n}=(0,B.useDeletedKeys)(e+1,t);return(0,a.jsx)(G,{keys:l?.keys||[],totalCount:l?.total_count||0,isLoading:r,isFetching:n,pageIndex:e,pageSize:t,onPageChange:s})}var X=e.i(785242),Z=e.i(389083),ee=e.i(599724),es=e.i(355619);function et({teams:e,isLoading:s,isFetching:t}){let[l,r]=(0,i.useState)([{id:"deleted_at",desc:!0}]),n=[{id:"team_alias",accessorKey:"team_alias",header:"Team Name",size:150,maxSize:200,cell:e=>{let s=e.getValue();return(0,a.jsx)(o.Tooltip,{title:s||void 0,children:(0,a.jsx)("span",{className:"truncate block max-w-[200px]",children:s||"-"})})}},{id:"team_id",accessorKey:"team_id",header:"Team ID",size:150,maxSize:250,cell:e=>{let s=e.getValue();return(0,a.jsx)(o.Tooltip,{title:s,children:(0,a.jsx)("span",{className:"font-mono text-blue-500 text-xs truncate block max-w-[250px]",children:s||"-"})})}},{id:"created_at",accessorKey:"created_at",header:"Created",size:120,maxSize:140,cell:e=>{let s=e.getValue();return(0,a.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"spend",accessorKey:"spend",header:"Spend (USD)",size:100,maxSize:140,cell:e=>{let s=e.row.original.spend;return(0,a.jsx)("span",{className:"block max-w-[140px]",children:void 0!==s?(0,C.formatNumberWithCommas)(s,4):"-"})}},{id:"max_budget",accessorKey:"max_budget",header:"Budget (USD)",size:110,maxSize:150,cell:e=>{let s=e.getValue();return(0,a.jsx)("span",{className:"block max-w-[150px]",children:null==s?"No limit":`$${(0,C.formatNumberWithCommas)(s)}`})}},{id:"models",accessorKey:"models",header:"Models",size:200,maxSize:300,cell:e=>{let s=e.getValue();return Array.isArray(s)&&0!==s.length?(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 max-w-[300px]",children:[s.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,a.jsx)(Z.Badge,{size:"xs",color:"red",children:(0,a.jsx)(ee.Text,{children:"All Proxy Models"})},s):(0,a.jsx)(Z.Badge,{size:"xs",color:"blue",children:(0,a.jsx)(ee.Text,{children:e.length>30?`${(0,es.getModelDisplayName)(e).slice(0,30)}...`:(0,es.getModelDisplayName)(e)})},s)),s.length>3&&(0,a.jsx)(Z.Badge,{size:"xs",color:"gray",children:(0,a.jsxs)(ee.Text,{children:["+",s.length-3," ",s.length-3==1?"more model":"more models"]})})]}):(0,a.jsx)(Z.Badge,{size:"xs",color:"red",children:(0,a.jsx)(ee.Text,{children:"All Proxy Models"})})}},{id:"organization_id",accessorKey:"organization_id",header:"Organization",size:150,maxSize:200,cell:e=>{let s=e.getValue();return(0,a.jsx)(o.Tooltip,{title:s||void 0,children:(0,a.jsx)("span",{className:"truncate block max-w-[200px]",children:s||"-"})})}},{id:"deleted_at",accessorKey:"deleted_at",header:"Deleted At",size:120,maxSize:140,cell:e=>{let s=e.row.original.deleted_at;return(0,a.jsx)("span",{className:"block max-w-[140px]",children:s?new Date(s).toLocaleDateString():"-"})}},{id:"deleted_by",accessorKey:"deleted_by",header:"Deleted By",size:120,maxSize:180,cell:e=>{let s=e.row.original.deleted_by;return(0,a.jsx)(o.Tooltip,{title:s||void 0,children:(0,a.jsx)("span",{className:"truncate block max-w-[180px]",children:s||"-"})})}}],d=(0,$.useReactTable)({data:e,columns:n,columnResizeMode:"onChange",columnResizeDirection:"ltr",state:{sorting:l},onSortingChange:r,getCoreRowModel:(0,K.getCoreRowModel)(),getSortedRowModel:(0,K.getSortedRowModel)(),enableSorting:!0,manualSorting:!1});return(0,a.jsx)("div",{className:"w-full h-full overflow-hidden",children:(0,a.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,a.jsx)("div",{className:"flex items-center justify-between w-full mb-4",children:s||t?(0,a.jsx)("span",{className:"inline-flex text-sm text-gray-700",children:"Loading..."}):(0,a.jsxs)("span",{className:"inline-flex text-sm text-gray-700",children:["Showing ",e.length," ",1===e.length?"team":"teams"]})}),(0,a.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,a.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(H.Table,{className:"[&_td]:py-0.5 [&_th]:py-1",style:{width:d.getCenterTotalSize()},children:[(0,a.jsx)(W.TableHead,{children:d.getHeaderGroups().map(e=>(0,a.jsx)(U.TableRow,{children:e.headers.map(e=>(0,a.jsx)(J.TableHeaderCell,{"data-header-id":e.id,className:"py-1 h-8 relative hover:bg-gray-50",style:{width:e.getSize(),maxWidth:e.column.columnDef.maxSize,position:"relative"},onMouseEnter:()=>{let s=document.querySelector(`[data-header-id="${e.id}"] .resizer`);s&&(s.style.opacity="0.5")},onMouseLeave:()=>{let s=document.querySelector(`[data-header-id="${e.id}"] .resizer`);s&&!e.column.getIsResizing()&&(s.style.opacity="0")},onClick:e.column.getToggleSortingHandler(),children:(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,$.flexRender)(e.column.columnDef.header,e.getContext())}),(0,a.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,a.jsx)(F.ChevronUpIcon,{className:"h-4 w-4 text-blue-500"}),desc:(0,a.jsx)(P.ChevronDownIcon,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,a.jsx)(q.SwitchVerticalIcon,{className:"h-4 w-4 text-gray-400"})}),(0,a.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:`resizer ${d.options.columnResizeDirection} ${e.column.getIsResizing()?"isResizing":""}`,style:{position:"absolute",right:0,top:0,height:"100%",width:"5px",background:e.column.getIsResizing()?"#3b82f6":"transparent",cursor:"col-resize",userSelect:"none",touchAction:"none",opacity:+!!e.column.getIsResizing()}})]})},e.id))},e.id))}),(0,a.jsx)(V.TableBody,{children:s||t?(0,a.jsx)(U.TableRow,{children:(0,a.jsx)(Y.TableCell,{colSpan:n.length,className:"h-8 text-center",children:(0,a.jsx)("div",{className:"text-center text-gray-500",children:(0,a.jsx)("p",{children:"ðŸš… Loading teams..."})})})}):e.length>0?d.getRowModel().rows.map(e=>(0,a.jsx)(U.TableRow,{className:"h-8",children:e.getVisibleCells().map(e=>(0,a.jsx)(Y.TableCell,{style:{width:e.column.getSize(),maxWidth:e.column.columnDef.maxSize,whiteSpace:"pre-wrap",overflow:"hidden"},className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,$.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,a.jsx)(U.TableRow,{children:(0,a.jsx)(Y.TableCell,{colSpan:n.length,className:"h-8 text-center",children:(0,a.jsx)("div",{className:"text-center text-gray-500",children:(0,a.jsx)("p",{children:"No deleted teams found"})})})})})]})})})})]})})}function ea(){let{data:e,isPending:s,isFetching:t}=(0,X.useDeletedTeams)(1,100);return(0,a.jsx)(et,{teams:e||[],isLoading:s,isFetching:t})}var el=e.i(633627),er=e.i(969550),en=e.i(764205),ei=e.i(20147),eo=e.i(149121),ed=e.i(994388),ec=e.i(916925);let em=({utcTime:e})=>(0,a.jsx)("span",{style:{fontFamily:"monospace",width:"180px",display:"inline-block"},children:(e=>{try{return new Date(e).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).replace(",","")}catch(e){return"Error converting time"}})(e)}),ex=[{header:"Time",accessorKey:"startTime",cell:e=>(0,a.jsx)(em,{utcTime:e.getValue()})},{header:"Status",accessorKey:"metadata.status",cell:e=>{let s="failure"!==(e.getValue()||"Success").toLowerCase();return(0,a.jsx)("span",{className:`px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ${s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s?"Success":"Failure"})}},{header:"Session ID",accessorKey:"session_id",cell:e=>{let s=String(e.getValue()||""),t=e.row.original.onSessionClick;return(0,a.jsx)(o.Tooltip,{title:String(e.getValue()||""),children:(0,a.jsx)(ed.Button,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal text-xs max-w-[15ch] truncate block",onClick:()=>t?.(s),children:String(e.getValue()||"")})})}},{header:"Request ID",accessorKey:"request_id",cell:e=>(0,a.jsx)(o.Tooltip,{title:String(e.getValue()||""),children:(0,a.jsx)("span",{className:"font-mono text-xs max-w-[15ch] truncate block",children:String(e.getValue()||"")})})},{header:"Cost",accessorKey:"spend",cell:e=>(0,a.jsx)(o.Tooltip,{title:`$${String(e.getValue()||0)} `,children:(0,a.jsx)("span",{children:(0,C.getSpendString)(e.getValue()||0)})})},{header:"Duration (s)",accessorKey:"duration",cell:e=>(0,a.jsx)(o.Tooltip,{title:String(e.getValue()||"-"),children:(0,a.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Team Name",accessorKey:"metadata.user_api_key_team_alias",cell:e=>(0,a.jsx)(o.Tooltip,{title:String(e.getValue()||"-"),children:(0,a.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Key Hash",accessorKey:"metadata.user_api_key",cell:e=>{let s=String(e.getValue()||"-"),t=e.row.original.onKeyHashClick;return(0,a.jsx)(o.Tooltip,{title:s,children:(0,a.jsx)("span",{className:"font-mono max-w-[15ch] truncate block cursor-pointer hover:text-blue-600",onClick:()=>t?.(s),children:s})})}},{header:"Key Name",accessorKey:"metadata.user_api_key_alias",cell:e=>(0,a.jsx)(o.Tooltip,{title:String(e.getValue()||"-"),children:(0,a.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Model",accessorKey:"model",cell:e=>{let s=e.row.original,t=s.custom_llm_provider,l=String(e.getValue()||"");return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&(0,a.jsx)("img",{src:s.metadata?.mcp_tool_call_metadata?.mcp_server_logo_url?s.metadata.mcp_tool_call_metadata.mcp_server_logo_url:t?(0,ec.getProviderLogoAndName)(t).logo:"",alt:"",className:"w-4 h-4",onError:e=>{e.target.style.display="none"}}),(0,a.jsx)(o.Tooltip,{title:l,children:(0,a.jsx)("span",{className:"max-w-[15ch] truncate block",children:l})})]})}},{header:"Tokens",accessorKey:"total_tokens",cell:e=>{let s=e.row.original;return(0,a.jsxs)("span",{className:"text-sm",children:[String(s.total_tokens||"0"),(0,a.jsxs)("span",{className:"text-gray-400 text-xs ml-1",children:["(",String(s.prompt_tokens||"0"),"+",String(s.completion_tokens||"0"),")"]})]})}},{header:"Internal User",accessorKey:"user",cell:e=>(0,a.jsx)(o.Tooltip,{title:String(e.getValue()||"-"),children:(0,a.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"End User",accessorKey:"end_user",cell:e=>(0,a.jsx)(o.Tooltip,{title:String(e.getValue()||"-"),children:(0,a.jsx)("span",{className:"max-w-[15ch] truncate block",children:String(e.getValue()||"-")})})},{header:"Tags",accessorKey:"request_tags",cell:e=>{let s=e.getValue();if(!s||0===Object.keys(s).length)return"-";let t=Object.entries(s),l=t[0],r=t.slice(1);return(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:(0,a.jsx)(o.Tooltip,{title:(0,a.jsx)("div",{className:"flex flex-col gap-1",children:t.map(([e,s])=>(0,a.jsxs)("span",{children:[e,": ",String(s)]},e))}),children:(0,a.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[l[0],": ",String(l[1]),r.length>0&&` +${r.length}`]})})})}}],eu=[{id:"expander",header:()=>null,cell:({row:e})=>(0,a.jsx)(()=>{let[s,t]=i.default.useState(e.getIsExpanded()),l=i.default.useCallback(()=>{t(e=>!e),e.getToggleExpandedHandler()()},[e]);return e.getCanExpand()?(0,a.jsx)("button",{onClick:l,style:{cursor:"pointer"},"aria-label":s?"Collapse row":"Expand row",className:"w-6 h-6 flex items-center justify-center focus:outline-none",children:(0,a.jsx)("svg",{className:`w-4 h-4 transform transition-transform ${s?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):(0,a.jsx)("span",{className:"w-6 h-6 flex items-center justify-center",children:"â—"})},{})},{header:"Timestamp",accessorKey:"updated_at",cell:e=>(0,a.jsx)(em,{utcTime:e.getValue()})},{header:"Table Name",accessorKey:"table_name",cell:e=>{let s=e.getValue(),t=s;switch(s){case"LiteLLM_VerificationToken":t="Keys";break;case"LiteLLM_TeamTable":t="Teams";break;case"LiteLLM_OrganizationTable":t="Organizations";break;case"LiteLLM_UserTable":t="Users";break;case"LiteLLM_ProxyModelTable":t="Models";break;default:t=s}return(0,a.jsx)("span",{children:t})}},{header:"Action",accessorKey:"action",cell:e=>{let s;return(0,a.jsx)("span",{children:(s=e.getValue(),(0,a.jsx)(Z.Badge,{color:"gray",className:"flex items-center gap-1",children:(0,a.jsx)("span",{className:"whitespace-nowrap text-xs",children:s})}))})}},{header:"Changed By",accessorKey:"changed_by",cell:e=>{let s=e.row.original.changed_by,t=e.row.original.changed_by_api_key;return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"font-medium",children:s}),t&&(0,a.jsx)(o.Tooltip,{title:t,children:(0,a.jsxs)("div",{className:"text-xs text-muted-foreground max-w-[15ch] truncate",children:[" ",t]})})]})}},{header:"Affected Item ID",accessorKey:"object_id",cell:e=>(0,a.jsx)(()=>{let s=e.getValue(),[t,l]=(0,i.useState)(!1);if(!s)return(0,a.jsx)(a.Fragment,{children:"-"});let r=async()=>{try{await navigator.clipboard.writeText(String(s)),l(!0),setTimeout(()=>l(!1),1500)}catch(e){console.error("Failed to copy object ID: ",e)}};return(0,a.jsx)(o.Tooltip,{title:t?"Copied!":String(s),children:(0,a.jsx)("span",{className:"max-w-[20ch] truncate block cursor-pointer hover:text-blue-600",onClick:r,children:String(s)})})},{})}];function eh({userID:e,userRole:s,token:t,accessToken:r,isActive:o,premiumUser:d,allTeams:c}){let[m,x]=(0,i.useState)((0,n.default)().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),u=(0,i.useRef)(null),h=(0,i.useRef)(null),[p,g]=(0,i.useState)(1),[f]=(0,i.useState)(50),[j,y]=(0,i.useState)({}),[b,v]=(0,i.useState)(""),[N,w]=(0,i.useState)(""),[_,k]=(0,i.useState)(""),[S,T]=(0,i.useState)("all"),[L,M]=(0,i.useState)("all"),[D,z]=(0,i.useState)(!1),[R,I]=(0,i.useState)(!1),E=(0,l.useQuery)({queryKey:["all_audit_logs",r,t,s,e,m],queryFn:async()=>{if(!r||!t||!s||!e)return[];let a=(0,n.default)(m).utc().format("YYYY-MM-DD HH:mm:ss"),l=(0,n.default)().utc().format("YYYY-MM-DD HH:mm:ss"),i=[],o=1,d=1;do{let e=await (0,en.uiAuditLogsCall)(r,a,l,o,50);i=i.concat(e.audit_logs),d=e.total_pages,o++}while(o<=d)return i},enabled:!!r&&!!t&&!!s&&!!e&&o,refetchInterval:5e3,refetchIntervalInBackground:!0}),A=(0,i.useCallback)(async e=>{if(r)try{let s=(await (0,en.keyListCall)(r,null,null,e,null,null,1,10)).keys.find(s=>s.key_alias===e);s?w(s.token):w("")}catch(e){console.error("Error fetching key hash for alias:",e),w("")}},[r]);(0,i.useEffect)(()=>{if(!r)return;let e=!1,s=!1;j["Team ID"]?b!==j["Team ID"]&&(v(j["Team ID"]),e=!0):""!==b&&(v(""),e=!0),j["Key Hash"]?N!==j["Key Hash"]&&(w(j["Key Hash"]),s=!0):j["Key Alias"]?A(j["Key Alias"]):""!==N&&(w(""),s=!0),(e||s)&&g(1)},[j,r,A,b,N]),(0,i.useEffect)(()=>{g(1)},[b,N,m,_,S,L]),(0,i.useEffect)(()=>{function e(e){u.current&&!u.current.contains(e.target)&&z(!1),h.current&&!h.current.contains(e.target)&&I(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let O=(0,i.useMemo)(()=>E.data?E.data.filter(e=>{let s=!0,t=!0,a=!0,l=!0,r=!0;if(b){let t="string"==typeof e.before_value?JSON.parse(e.before_value)?.team_id:e.before_value?.team_id,a="string"==typeof e.updated_values?JSON.parse(e.updated_values)?.team_id:e.updated_values?.team_id;s=t===b||a===b}if(N)try{let s="string"==typeof e.before_value?JSON.parse(e.before_value):e.before_value,a="string"==typeof e.updated_values?JSON.parse(e.updated_values):e.updated_values,l=s?.token,r=a?.token;t="string"==typeof l&&l.includes(N)||"string"==typeof r&&r.includes(N)}catch(e){t=!1}if(_&&(a=e.object_id?.toLowerCase().includes(_.toLowerCase())),"all"!==S&&(l=e.action?.toLowerCase()===S.toLowerCase()),"all"!==L){let s="";switch(L){case"keys":s="litellm_verificationtoken";break;case"teams":s="litellm_teamtable";break;case"users":s="litellm_usertable";break;default:s=L}r=e.table_name?.toLowerCase()===s}return s&&t&&a&&l&&r}):[],[E.data,b,N,_,S,L]),B=O.length,P=Math.ceil(B/f)||1,F=(0,i.useMemo)(()=>{let e=(p-1)*f,s=e+f;return O.slice(e,s)},[O,p,f]),q=!E.data||0===E.data.length,$=(0,i.useCallback)(({row:e})=>(0,a.jsx)(({rowData:e})=>{let{before_value:s,updated_values:t,table_name:l,action:r}=e,n=(e,s)=>{if(!e||0===Object.keys(e).length)return(0,a.jsx)(ee.Text,{children:"N/A"});if(s){let s=Object.keys(e),t=["token","spend","max_budget"];if(s.every(e=>t.includes(e))&&s.length>0)return(0,a.jsxs)("div",{children:[s.includes("token")&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Token:"})," ",e.token||"N/A"]}),s.includes("spend")&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Spend:"})," ",void 0!==e.spend?`$${(0,C.formatNumberWithCommas)(e.spend,6)}`:"N/A"]}),s.includes("max_budget")&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Max Budget:"})," ",void 0!==e.max_budget?`$${(0,C.formatNumberWithCommas)(e.max_budget,6)}`:"N/A"]})]});if(e["No differing fields detected in 'before' state"]||e["No differing fields detected in 'updated' state"]||e["No fields changed"])return(0,a.jsx)(ee.Text,{children:e[Object.keys(e)[0]]})}return(0,a.jsx)("pre",{className:"p-2 bg-gray-50 border rounded text-xs overflow-auto max-h-60",children:JSON.stringify(e,null,2)})},i=s,o=t;if(("updated"===r||"rotated"===r)&&s&&t&&("LiteLLM_TeamTable"===l||"LiteLLM_UserTable"===l||"LiteLLM_VerificationToken"===l)){let e={},a={};new Set([...Object.keys(s),...Object.keys(t)]).forEach(l=>{JSON.stringify(s[l])!==JSON.stringify(t[l])&&(s.hasOwnProperty(l)&&(e[l]=s[l]),t.hasOwnProperty(l)&&(a[l]=t[l]))}),Object.keys(s).forEach(l=>{t.hasOwnProperty(l)||e.hasOwnProperty(l)||(e[l]=s[l],a[l]=void 0)}),Object.keys(t).forEach(l=>{s.hasOwnProperty(l)||a.hasOwnProperty(l)||(a[l]=t[l],e[l]=void 0)}),i=Object.keys(e).length>0?e:{"No differing fields detected in 'before' state":"N/A"},o=Object.keys(a).length>0?a:{"No differing fields detected in 'updated' state":"N/A"},0===Object.keys(e).length&&0===Object.keys(a).length&&(i={"No fields changed":"N/A"},o={"No fields changed":"N/A"})}return(0,a.jsxs)("div",{className:"-mx-4 p-4 bg-slate-100 border-y border-slate-300 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Before Value:"}),n(i,"LiteLLM_VerificationToken"===l)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-sm text-slate-700",children:"Updated Value:"}),n(o,"LiteLLM_VerificationToken"===l)]})]})},{rowData:e.original}),[]);if(!d)return(0,a.jsxs)("div",{style:{textAlign:"center",marginTop:"20px"},children:[(0,a.jsx)("h1",{style:{display:"block",marginBottom:"10px"},children:"âœ¨ Enterprise Feature."}),(0,a.jsx)(ee.Text,{style:{display:"block",marginBottom:"10px"},children:"This is a LiteLLM Enterprise feature, and requires a valid key to use."}),(0,a.jsx)(ee.Text,{style:{display:"block",marginBottom:"20px",fontStyle:"italic"},children:"Here's a preview of what Audit Logs offer:"}),(0,a.jsx)("img",{src:"../ui/assets/audit-logs-preview.png",alt:"Audit Logs Preview",style:{maxWidth:"100%",maxHeight:"700px",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",margin:"0 auto"},onError:e=>{console.error("Failed to load audit logs preview image"),e.target.style.display="none"}})]});let K=B>0?(p-1)*f+1:0,H=Math.min(p*f,B);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4"}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"border-b px-6 py-4",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold py-4",children:"Audit Logs"}),(0,a.jsx)(({show:e})=>e?(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start mb-6",children:[(0,a.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,a.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Audit Logs Not Available"}),(0,a.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"To enable audit logging, add the following configuration to your LiteLLM proxy configuration file:"}),(0,a.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:`litellm_settings:
  store_audit_logs: true`}),(0,a.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change and proxy restart."})]})]}):null,{show:q}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:[(0,a.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("input",{type:"text",placeholder:"Search by Object ID...",value:_,onChange:e=>k(e.target.value),className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,a.jsxs)("button",{onClick:()=>{E.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,a.jsx)("svg",{className:`w-4 h-4 ${E.isFetching?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,a.jsx)("span",{children:"Refresh"})]})]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"relative",ref:u,children:[(0,a.jsx)("label",{htmlFor:"actionFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Action:"}),(0,a.jsxs)("button",{id:"actionFilterDisplay",onClick:()=>z(!D),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,a.jsxs)("span",{children:["all"===S&&"All Actions","created"===S&&"Created","updated"===S&&"Updated","deleted"===S&&"Deleted","rotated"===S&&"Rotated"]}),(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),D&&(0,a.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,a.jsx)("div",{className:"space-y-1",children:[{label:"All Actions",value:"all"},{label:"Created",value:"created"},{label:"Updated",value:"updated"},{label:"Deleted",value:"deleted"},{label:"Rotated",value:"rotated"}].map(e=>(0,a.jsx)("button",{className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ${S===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"}`,onClick:()=>{T(e.value),z(!1)},children:e.label},e.value))})})]}),(0,a.jsxs)("div",{className:"relative",ref:h,children:[(0,a.jsx)("label",{htmlFor:"tableFilterDisplay",className:"mr-2 text-sm font-medium text-gray-700 sr-only",children:"Table:"}),(0,a.jsxs)("button",{id:"tableFilterDisplay",onClick:()=>I(!R),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 bg-white w-40 text-left justify-between",children:[(0,a.jsxs)("span",{children:["all"===L&&"All Tables","keys"===L&&"Keys","teams"===L&&"Teams","users"===L&&"Users"]}),(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),R&&(0,a.jsx)("div",{className:"absolute left-0 mt-2 w-40 bg-white rounded-lg shadow-lg border p-1 z-50",children:(0,a.jsx)("div",{className:"space-y-1",children:[{label:"All Tables",value:"all"},{label:"Keys",value:"keys"},{label:"Teams",value:"teams"},{label:"Users",value:"users"}].map(e=>(0,a.jsx)("button",{className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ${L===e.value?"bg-blue-50 text-blue-600 font-medium":"font-normal"}`,onClick:()=>{M(e.value),I(!1)},children:e.label},e.value))})})]}),(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Showing ",E.isLoading?"...":K," -"," ",E.isLoading?"...":H," of"," ",E.isLoading?"...":B," results"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",E.isLoading?"...":p," of"," ",E.isLoading?"...":P]}),(0,a.jsx)("button",{onClick:()=>g(e=>Math.max(1,e-1)),disabled:E.isLoading||1===p,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>g(e=>Math.min(P,e+1)),disabled:E.isLoading||p===P,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]}),(0,a.jsx)(eo.DataTable,{columns:eu,data:F,renderSubComponent:$,getRowCanExpand:()=>!0})]})]})}let ep=({show:e,onOpenSettings:s})=>e?(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start",children:[(0,a.jsx)("div",{className:"text-blue-500 mr-3 flex-shrink-0 mt-0.5",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),(0,a.jsx)("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Request/Response Data Not Available"}),(0,a.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["To view request and response details, enable prompt storage in your LiteLLM configuration by adding the following to your ",(0,a.jsx)("code",{className:"bg-blue-100 px-1 py-0.5 rounded",children:"proxy_config.yaml"})," file",s&&(0,a.jsxs)(a.Fragment,{children:[" or"," ",(0,a.jsx)("button",{onClick:s,className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"open the settings"})," ","to configure this directly."]})]}),(0,a.jsx)("pre",{className:"mt-2 bg-white p-3 rounded border border-blue-200 text-xs font-mono overflow-auto",children:`general_settings:
  store_model_in_db: true
  store_prompts_in_spend_logs: true`}),(0,a.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This will only affect new requests after the configuration change."})]})]}):null,eg=e=>null==e?"-":`$${(0,C.formatNumberWithCommas)(e,8)}`,ef=e=>null==e?"-":`${(100*e).toFixed(2)}%`,ej=({costBreakdown:e,totalSpend:s})=>{if(!e)return null;let t=void 0!==e.discount_percent&&0!==e.discount_percent||void 0!==e.discount_amount&&0!==e.discount_amount,l=void 0!==e.margin_percent&&0!==e.margin_percent||void 0!==e.margin_fixed_amount&&0!==e.margin_fixed_amount||void 0!==e.margin_total_amount&&0!==e.margin_total_amount;return void 0!==e.input_cost||void 0!==e.output_cost||t||l?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,a.jsx)(d.Collapse,{expandIconPosition:"start",items:[{key:"1",label:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Cost Breakdown"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mr-4",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Total:"}),(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:eg(s)})]})]}),children:(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2 max-w-2xl",children:[(0,a.jsxs)("div",{className:"flex text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Input Cost:"}),(0,a.jsx)("span",{className:"text-gray-900",children:eg(e.input_cost)})]}),(0,a.jsxs)("div",{className:"flex text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Output Cost:"}),(0,a.jsx)("span",{className:"text-gray-900",children:eg(e.output_cost)})]}),void 0!==e.tool_usage_cost&&e.tool_usage_cost>0&&(0,a.jsxs)("div",{className:"flex text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600 font-medium w-1/3",children:"Tool Usage Cost:"}),(0,a.jsx)("span",{className:"text-gray-900",children:eg(e.tool_usage_cost)})]}),e.additional_costs&&Object.keys(e.additional_costs).length>0&&(0,a.jsx)(a.Fragment,{children:Object.entries(e.additional_costs).map(([e,s])=>(0,a.jsxs)("div",{className:"flex text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-600 font-medium w-1/3",children:[e,":"]}),(0,a.jsx)("span",{className:"text-gray-900",children:eg(s)})]},e))})]}),(0,a.jsx)("div",{className:"pt-2 border-t border-gray-100 max-w-2xl",children:(0,a.jsxs)("div",{className:"flex text-sm font-semibold",children:[(0,a.jsx)("span",{className:"text-gray-900 w-1/3",children:"Original LLM Cost:"}),(0,a.jsx)("span",{className:"text-gray-900",children:eg(e.original_cost)})]})}),(t||l)&&(0,a.jsxs)("div",{className:"pt-2 space-y-2 max-w-2xl",children:[t&&(0,a.jsxs)("div",{className:"space-y-2",children:[void 0!==e.discount_percent&&0!==e.discount_percent&&(0,a.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,a.jsxs)("span",{className:"font-medium w-1/3",children:["Discount (",ef(e.discount_percent),"):"]}),(0,a.jsxs)("span",{className:"text-gray-900",children:["-",eg(e.discount_amount)]})]}),void 0!==e.discount_amount&&void 0===e.discount_percent&&(0,a.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Discount Amount:"}),(0,a.jsxs)("span",{className:"text-gray-900",children:["-",eg(e.discount_amount)]})]})]}),l&&(0,a.jsxs)("div",{className:"space-y-2",children:[void 0!==e.margin_percent&&0!==e.margin_percent&&(0,a.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,a.jsxs)("span",{className:"font-medium w-1/3",children:["Margin (",ef(e.margin_percent),"):"]}),(0,a.jsxs)("span",{className:"text-gray-900",children:["+",eg((e.margin_total_amount||0)-(e.margin_fixed_amount||0))]})]}),void 0!==e.margin_fixed_amount&&0!==e.margin_fixed_amount&&(0,a.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Margin:"}),(0,a.jsxs)("span",{className:"text-gray-900",children:["+",eg(e.margin_fixed_amount)]})]})]})]}),(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 max-w-2xl",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"font-bold text-sm text-gray-900 w-1/3",children:"Final Calculated Cost:"}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:eg(e.total_cost??s)})]})})]})}]})}):null},ey=({errorInfo:e})=>{var s;let[t,l]=i.default.useState({}),[r,n]=i.default.useState(!1),o=e.traceback&&(s=e.traceback)?Array.from(s.matchAll(/File "([^"]+)", line (\d+)/g)).map(e=>{let t=e[1],a=e[2],l=t.split("/").pop()||t,r=e.index||0,n=s.indexOf('File "',r+1),i=n>-1?s.substring(r,n).trim():s.substring(r).trim(),o=i.split("\n"),d="";return o.length>1&&(d=o[o.length-1].trim()),{filePath:t,fileName:l,lineNumber:a,code:d,inFunction:i.includes(" in ")?i.split(" in ")[1].split("\n")[0]:""}}):[];return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)("h3",{className:"text-lg font-medium flex items-center text-red-600",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Error Details"]})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"bg-red-50 rounded-md p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"text-red-800 font-medium w-20",children:"Type:"}),(0,a.jsx)("span",{className:"text-red-700",children:e.error_class||"Unknown Error"})]}),(0,a.jsxs)("div",{className:"flex mt-2",children:[(0,a.jsx)("span",{className:"text-red-800 font-medium w-20 flex-shrink-0",children:"Message:"}),(0,a.jsx)("span",{className:"text-red-700 break-words whitespace-pre-wrap",children:e.error_message||"Unknown error occurred"})]})]}),e.traceback&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Traceback"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("button",{onClick:()=>{let e=!r;if(n(e),o.length>0){let s={};o.forEach((t,a)=>{s[a]=e}),l(s)}},className:"text-gray-500 hover:text-gray-700 flex items-center text-sm",children:r?"Collapse All":"Expand All"}),(0,a.jsxs)("button",{onClick:()=>navigator.clipboard.writeText(e.traceback||""),className:"text-gray-500 hover:text-gray-700 flex items-center",title:"Copy traceback",children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,a.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),(0,a.jsx)("span",{className:"ml-1",children:"Copy"})]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden shadow-sm",children:o.map((e,s)=>(0,a.jsxs)("div",{className:"border-b border-gray-200 last:border-b-0",children:[(0,a.jsxs)("div",{className:"px-4 py-2 flex items-center justify-between cursor-pointer hover:bg-gray-50",onClick:()=>{l(e=>({...e,[s]:!e[s]}))},children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-400 mr-2 w-12 text-right",children:e.lineNumber}),(0,a.jsx)("span",{className:"text-gray-600 font-medium",children:e.fileName}),(0,a.jsx)("span",{className:"text-gray-500 mx-1",children:"in"}),(0,a.jsx)("span",{className:"text-indigo-600 font-medium",children:e.inFunction||e.fileName})]}),(0,a.jsx)("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${t[s]?"transform rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(t[s]||!1)&&e.code&&(0,a.jsx)("div",{className:"px-12 py-2 font-mono text-sm text-gray-800 bg-gray-50 overflow-x-auto border-t border-gray-100",children:e.code})]},s))})]})]})]})};var eb=e.i(374009),ev=e.i(700514);let eN="Team ID",ew="Key Hash",e_="Request ID",ek="Model",eS="User ID",eC="End User",eT="Status",eL="Key Alias",eM="Error Code",eD="Error Message",ez=async(e,s,t,a)=>{console.log("prefetchLogDetails called with",e.length,"logs");let l=e.map(e=>{if(e.request_id)return console.log("Prefetching details for request_id:",e.request_id),a.prefetchQuery({queryKey:["logDetails",e.request_id,s],queryFn:async()=>{console.log("Fetching details for",e.request_id);let a=await (0,en.uiSpendLogDetailsCall)(t,e.request_id,s);return console.log("Received details for",e.request_id,":",a?"success":"failed"),a},staleTime:6e5,gcTime:6e5})});try{let e=await Promise.all(l);return console.log("All prefetch promises completed:",e.length),e}catch(e){throw console.error("Error in prefetchLogDetails:",e),e}};var eR=e.i(727749);let eI=e=>!!e&&e instanceof Date,eE=e=>"object"==typeof e&&null!==e,eA=e=>!!e&&e instanceof Object&&"function"==typeof e;function eO(e,s){return void 0===s&&(s=!1),!e||s?`"${e}"`:e}function eB(e){let{field:s,value:t,data:a,lastElement:l,openBracket:r,closeBracket:n,level:o,style:d,shouldExpandNode:c,clickToExpandNode:m,outerRef:x,beforeExpandChange:u}=e,h=(0,i.useRef)(!1),[p,g]=(0,i.useState)(()=>c(o,t,s)),f=(0,i.useRef)(null);(0,i.useEffect)(()=>{h.current?g(c(o,t,s)):h.current=!0},[c]);let j=(0,i.useId)();if(0===a.length)return function(e){let{field:s,openBracket:t,closeBracket:a,lastElement:l,style:r}=e;return(0,i.createElement)("div",{className:r.basicChildStyle,role:"treeitem","aria-selected":void 0},(s||""===s)&&(0,i.createElement)("span",{className:r.label},eO(s,r.quotesForFieldNames),":"),(0,i.createElement)("span",{className:r.punctuation},t),(0,i.createElement)("span",{className:r.punctuation},a),!l&&(0,i.createElement)("span",{className:r.punctuation},","))}({field:s,openBracket:r,closeBracket:n,lastElement:l,style:d});let y=p?d.collapseIcon:d.expandIcon,b=p?d.ariaLables.collapseJson:d.ariaLables.expandJson,v=o+1,N=a.length-1,w=e=>{p!==e&&(!u||u({level:o,value:t,field:s,newExpandValue:e}))&&g(e)},_=e=>{if("ArrowRight"===e.key||"ArrowLeft"===e.key)e.preventDefault(),w("ArrowRight"===e.key);else if("ArrowUp"===e.key||"ArrowDown"===e.key){e.preventDefault();let s="ArrowUp"===e.key?-1:1;if(!x.current)return;let t=x.current.querySelectorAll("[role=button]"),a=-1;for(let e=0;e<t.length;e++)if(0===t[e].tabIndex){a=e;break}if(a<0)return;let l=(a+s+t.length)%t.length;t[a].tabIndex=-1,t[l].tabIndex=0,t[l].focus()}},k=()=>{var e;w(!p);let s=f.current;if(!s)return;let t=null==(e=x.current)?void 0:e.querySelector('[role=button][tabindex="0"]');t&&(t.tabIndex=-1),s.tabIndex=0,s.focus()};return(0,i.createElement)("div",{className:d.basicChildStyle,role:"treeitem","aria-expanded":p,"aria-selected":void 0},(0,i.createElement)("span",{className:y,onClick:k,onKeyDown:_,role:"button","aria-label":b,"aria-expanded":p,"aria-controls":p?j:void 0,ref:f,tabIndex:0===o?0:-1}),(s||""===s)&&(m?(0,i.createElement)("span",{className:d.clickableLabel,onClick:k,onKeyDown:_},eO(s,d.quotesForFieldNames),":"):(0,i.createElement)("span",{className:d.label},eO(s,d.quotesForFieldNames),":")),(0,i.createElement)("span",{className:d.punctuation},r),p?(0,i.createElement)("ul",{id:j,role:"group",className:d.childFieldsContainer},a.map((e,s)=>(0,i.createElement)(e$,{key:e[0]||s,field:e[0],value:e[1],style:d,lastElement:s===N,level:v,shouldExpandNode:c,clickToExpandNode:m,beforeExpandChange:u,outerRef:x}))):(0,i.createElement)("span",{className:d.collapsedContent,onClick:k,onKeyDown:_}),(0,i.createElement)("span",{className:d.punctuation},n),!l&&(0,i.createElement)("span",{className:d.punctuation},","))}function eP(e){let{field:s,value:t,style:a,lastElement:l,shouldExpandNode:r,clickToExpandNode:n,level:i,outerRef:o,beforeExpandChange:d}=e;return eB({field:s,value:t,lastElement:l||!1,level:i,openBracket:"{",closeBracket:"}",style:a,shouldExpandNode:r,clickToExpandNode:n,data:Object.keys(t).map(e=>[e,t[e]]),outerRef:o,beforeExpandChange:d})}function eF(e){let{field:s,value:t,style:a,lastElement:l,level:r,shouldExpandNode:n,clickToExpandNode:i,outerRef:o,beforeExpandChange:d}=e;return eB({field:s,value:t,lastElement:l||!1,level:r,openBracket:"[",closeBracket:"]",style:a,shouldExpandNode:n,clickToExpandNode:i,data:t.map(e=>[void 0,e]),outerRef:o,beforeExpandChange:d})}function eq(e){let s,{field:t,value:a,style:l,lastElement:r}=e,n=l.otherValue;if(null===a)s="null",n=l.nullValue;else if(void 0===a)s="undefined",n=l.undefinedValue;else if("string"==typeof a||a instanceof String){var o;o=!l.noQuotesForStringValues,s=l.stringifyStringValues?JSON.stringify(a):o?`"${a}"`:a,n=l.stringValue}else if("boolean"==typeof a||a instanceof Boolean)s=a?"true":"false",n=l.booleanValue;else if("number"==typeof a||a instanceof Number)s=a.toString(),n=l.numberValue;else"bigint"==typeof a||a instanceof BigInt?(s=`${a.toString()}n`,n=l.numberValue):s=eI(a)?a.toISOString():eA(a)?"function() { }":a.toString();return(0,i.createElement)("div",{className:l.basicChildStyle,role:"treeitem","aria-selected":void 0},(t||""===t)&&(0,i.createElement)("span",{className:l.label},eO(t,l.quotesForFieldNames),":"),(0,i.createElement)("span",{className:n},s),!r&&(0,i.createElement)("span",{className:l.punctuation},","))}function e$(e){let s=e.value;return Array.isArray(s)?(0,i.createElement)(eF,Object.assign({},e)):!eE(s)||eI(s)||eA(s)?(0,i.createElement)(eq,Object.assign({},e)):(0,i.createElement)(eP,Object.assign({},e))}let eK={container:"_2IvMF _GzYRV",basicChildStyle:"_2bkNM",childFieldsContainer:"_1BXBN",label:"_1MGIk",clickableLabel:"_2YKJg _1MGIk _1MFti",nullValue:"_2T6PJ",undefinedValue:"_1Gho6",stringValue:"_vGjyY",booleanValue:"_3zQKs",numberValue:"_1bQdo",otherValue:"_1xvuR",punctuation:"_3uHL6 _3eOF8",collapseIcon:"_oLqym _f10Tu _1MFti _1LId0",expandIcon:"_2AXVT _f10Tu _1MFti _1UmXx",collapsedContent:"_2KJWg _1pNG9 _1MFti",noQuotesForStringValues:!1,quotesForFieldNames:!1,ariaLables:{collapseJson:"collapse JSON",expandJson:"expand JSON"},stringifyStringValues:!1},eH=()=>!0,eV=e=>{let{data:s,style:t=eK,shouldExpandNode:a=eH,clickToExpandNode:l=!1,beforeExpandChange:r,compactTopLevel:n,...o}=e,d=(0,i.useRef)(null);return(0,i.createElement)("div",Object.assign({"aria-label":"JSON view"},o,{className:t.container,ref:d,role:"tree"}),n&&eE(s)?Object.entries(s).map(e=>{let[s,n]=e;return(0,i.createElement)(e$,{key:s,field:s,value:n,style:{...eK,...t},lastElement:!0,level:1,shouldExpandNode:a,clickToExpandNode:l,beforeExpandChange:r,outerRef:d})}):(0,i.createElement)(e$,{value:s,style:{...eK,...t},lastElement:!0,level:0,shouldExpandNode:a,clickToExpandNode:l,outerRef:d,beforeExpandChange:r}))};function eY({row:e,hasMessages:s,hasResponse:t,hasError:l,errorInfo:r,getRawRequest:n,formattedResponse:i}){let o=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select();let t=document.execCommand("copy");if(document.body.removeChild(s),!t)throw Error("execCommand failed");return!0}}catch(e){return console.error("Copy failed:",e),!1}},d=async()=>{await o(JSON.stringify(n(),null,2))?eR.default.success("Request copied to clipboard"):eR.default.fromBackend("Failed to copy request")},c=async()=>{await o(JSON.stringify(i(),null,2))?eR.default.success("Response copied to clipboard"):eR.default.fromBackend("Failed to copy response")};return(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 w-full max-w-full overflow-hidden box-border",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Request"}),(0,a.jsx)("button",{onClick:d,className:"p-1 hover:bg-gray-200 rounded",title:"Copy request",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,a.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,a.jsx)("div",{className:"p-4 overflow-auto max-h-96 w-full max-w-full box-border",children:(0,a.jsx)("div",{className:"[&_[role='tree']]:bg-white [&_[role='tree']]:text-slate-900",children:(0,a.jsx)(eV,{data:n(),style:eK,clickToExpandNode:!0})})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium",children:["Response",l&&(0,a.jsxs)("span",{className:"ml-2 text-sm text-red-600",children:["â€¢ HTTP code ",r?.error_code||400]})]}),(0,a.jsx)("button",{onClick:c,className:"p-1 hover:bg-gray-200 rounded",title:"Copy response",disabled:!t,children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,a.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,a.jsx)("div",{className:"p-4 overflow-auto max-h-96 w-full max-w-full box-border",children:t?(0,a.jsx)("div",{className:"[&_[role='tree']]:bg-white [&_[role='tree']]:text-slate-900",children:(0,a.jsx)(eV,{data:i(),style:eK,clickToExpandNode:!0})}):(0,a.jsx)("div",{className:"text-gray-500 text-sm italic text-center py-4",children:"Response data not available"})})]})]})}var eW=e.i(304967),eJ=e.i(629569),eU=e.i(165362),eG=e.i(530212),eQ=e.i(678784),eX=e.i(118366);let eZ=({sessionId:e,logs:s,onBack:t})=>{let[l,r]=(0,i.useState)(null),[n,d]=(0,i.useState)({}),c=s.reduce((e,s)=>e+(s.spend||0),0),m=s.reduce((e,s)=>e+(s.total_tokens||0),0),x=s.reduce((e,s)=>e+(s.metadata?.additional_usage_values?.cache_read_input_tokens||0),0),u=s.reduce((e,s)=>e+(s.metadata?.additional_usage_values?.cache_creation_input_tokens||0),0),h=m+x+u,p=s.length>0?new Date(s[0].startTime):new Date;(((s.length>0?new Date(s[s.length-1].endTime):new Date).getTime()-p.getTime())/1e3).toFixed(2),s.map(e=>({time:new Date(e.startTime).toISOString(),tokens:e.total_tokens||0,cost:e.spend||0}));let g=async(e,s)=>{await (0,C.copyToClipboard)(e)&&(d(e=>({...e,[s]:!0})),setTimeout(()=>{d(e=>({...e,[s]:!1}))},2e3))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)(ed.Button,{icon:eG.ArrowLeftIcon,variant:"light",onClick:t,className:"mb-4",children:"Back to All Logs"}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Session Details"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 font-mono",children:e}),(0,a.jsx)(A.Button,{type:"text",size:"small",icon:n["session-id"]?(0,a.jsx)(eQ.CheckIcon,{size:12}):(0,a.jsx)(eX.CopyIcon,{size:12}),onClick:()=>g(e,"session-id"),className:`left-2 z-10 transition-all duration-200 ${n["session-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`})]}),(0,a.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/ui_logs_sessions",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:["Get started with session management here",(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(eW.Card,{children:[(0,a.jsx)(ee.Text,{children:"Total Requests"}),(0,a.jsx)(eU.Metric,{children:s.length})]}),(0,a.jsxs)(eW.Card,{children:[(0,a.jsx)(ee.Text,{children:"Total Cost"}),(0,a.jsxs)(eU.Metric,{children:["$",(0,C.formatNumberWithCommas)(c,6)]})]}),(0,a.jsx)(o.Tooltip,{title:(0,a.jsxs)("div",{className:"text-white min-w-[200px]",children:[(0,a.jsx)("div",{className:"text-lg font-medium mb-3",children:"Usage breakdown"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-base font-medium mb-2",children:"Input usage:"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-300",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"input:"}),(0,a.jsx)("span",{className:"ml-8",children:(0,C.formatNumberWithCommas)(s.reduce((e,s)=>e+(s.prompt_tokens||0),0))})]}),x>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"input_cached_tokens:"}),(0,a.jsx)("span",{className:"ml-8",children:(0,C.formatNumberWithCommas)(x)})]}),u>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"input_cache_creation_tokens:"}),(0,a.jsx)("span",{className:"ml-8",children:(0,C.formatNumberWithCommas)(u)})]})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-600 pt-3",children:[(0,a.jsx)("div",{className:"text-base font-medium mb-2",children:"Output usage:"}),(0,a.jsx)("div",{className:"space-y-2 text-sm text-gray-300",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"output:"}),(0,a.jsx)("span",{className:"ml-8",children:(0,C.formatNumberWithCommas)(s.reduce((e,s)=>e+(s.completion_tokens||0),0))})]})})]}),(0,a.jsx)("div",{className:"border-t border-gray-600 pt-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-base font-medium",children:"Total usage:"}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:(0,C.formatNumberWithCommas)(h)})]})})]})]}),placement:"top",overlayStyle:{minWidth:"300px"},children:(0,a.jsxs)(eW.Card,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(ee.Text,{children:"Total Tokens"}),(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"â“˜"})]}),(0,a.jsx)(eU.Metric,{children:(0,C.formatNumberWithCommas)(h)})]})})]}),(0,a.jsx)(eJ.Title,{children:"Session Logs"}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(eo.DataTable,{columns:ex,data:s,renderSubComponent:tj,getRowCanExpand:()=>!0,loadingMessage:"Loading logs...",noDataMessage:"No logs found"})})]})};var e0=e.i(954616),e1=e.i(243652),e2=e.i(135214),e4=((s={}).GENERAL_SETTINGS="general_settings",s),e5=((t={}).MAXIMUM_SPEND_LOGS_RETENTION_PERIOD="maximum_spend_logs_retention_period",t);let e3=async(e,s)=>{try{let t=en.proxyBaseUrl?`${en.proxyBaseUrl}/config/list?config_type=${s}`:`/config/list?config_type=${s}`,a=await fetch(t,{method:"GET",headers:{[(0,en.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"}});if(!a.ok){let e=await a.json(),s=(0,en.deriveErrorMessage)(e);throw(0,en.handleError)(s),Error(s)}return await a.json()}catch(e){throw console.error(`Failed to get proxy config for ${s}:`,e),e}},e6=(0,e1.createQueryKeys)("proxyConfig"),e8=async(e,s)=>{try{let t=en.proxyBaseUrl?`${en.proxyBaseUrl}/config/field/delete`:"/config/field/delete",a=await fetch(t,{method:"POST",headers:{[(0,en.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){let e=await a.json(),s=(0,en.deriveErrorMessage)(e);throw(0,en.handleError)(s),Error(s)}return await a.json()}catch(e){throw console.error(`Failed to delete proxy config field ${s.field_name}:`,e),e}},e9=async(e,s)=>{let t=(0,en.getProxyBaseUrl)(),a=t?`${t}/config/update`:"/config/update",l=await fetch(a,{method:"POST",headers:{[(0,en.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({general_settings:{store_prompts_in_spend_logs:s.store_prompts_in_spend_logs,...s.maximum_spend_logs_retention_period&&{maximum_spend_logs_retention_period:s.maximum_spend_logs_retention_period}}})});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e?.error?.message||e?.message||e?.detail||"Failed to update spend logs settings")}return await l.json()};var e7=e.i(844444),se=e.i(190702),ss=e.i(637235),st=e.i(808613),sa=e.i(311451),sl=e.i(212931),sr=e.i(981339),sn=e.i(770914),si=e.i(790848),so=e.i(898586);let sd=({isVisible:e,onCancel:s,onSuccess:t})=>{let[r]=st.Form.useForm(),{mutateAsync:n,isPending:o}=(()=>{let{accessToken:e}=(0,e2.default)();return(0,e0.useMutation)({mutationFn:async s=>{if(!e)throw Error("Access token is required");return await e9(e,s)}})})(),{mutateAsync:d,isPending:c}=(()=>{let{accessToken:e}=(0,e2.default)();return(0,e0.useMutation)({mutationFn:async s=>{if(!e)throw Error("Access token is required");return await e8(e,s)}})})(),{data:m,isLoading:x,refetch:u}=(e=>{let{accessToken:s}=(0,e2.default)();return(0,l.useQuery)({queryKey:e6.list({filters:{configType:e}}),queryFn:async()=>await e3(s,e),enabled:!!s})})(e4.GENERAL_SETTINGS),h=st.Form.useWatch("store_prompts_in_spend_logs",r);(0,i.useEffect)(()=>{e&&u()},[e,u]);let p=(0,i.useMemo)(()=>{if(!m)return{store_prompts_in_spend_logs:!1,maximum_spend_logs_retention_period:void 0};let e=m.find(e=>"store_prompts_in_spend_logs"===e.field_name),s=m.find(e=>"maximum_spend_logs_retention_period"===e.field_name);return{store_prompts_in_spend_logs:e?.field_value??!1,maximum_spend_logs_retention_period:s?.field_value??void 0}},[m]),g=async e=>{try{let s=e.maximum_spend_logs_retention_period;if(!s||"string"==typeof s&&""===s.trim())try{await d({config_type:e4.GENERAL_SETTINGS,field_name:e5.MAXIMUM_SPEND_LOGS_RETENTION_PERIOD})}catch(e){console.warn("Failed to delete retention period field (may not exist):",e)}let a={store_prompts_in_spend_logs:e.store_prompts_in_spend_logs,...s&&"string"==typeof s&&""!==s.trim()&&{maximum_spend_logs_retention_period:s}};await n(a,{onSuccess:()=>{eR.default.success("Spend logs settings updated successfully"),u(),t?.()},onError:e=>{eR.default.fromBackend("Failed to save spend logs settings: "+(0,se.parseErrorMessage)(e))}})}catch(e){eR.default.fromBackend("Failed to save spend logs settings: "+(0,se.parseErrorMessage)(e))}},f=()=>{r.resetFields(),s()};return(0,a.jsx)(sl.Modal,{title:(0,a.jsxs)("span",{className:"flex gap-2",children:[(0,a.jsx)(so.Typography.Title,{level:5,children:"Spend Logs Settings"}),(0,a.jsx)(e7.default,{})]}),open:e,footer:(0,a.jsxs)(sn.Space,{children:[(0,a.jsx)(A.Button,{onClick:f,disabled:o||c||x,children:"Cancel"}),(0,a.jsx)(A.Button,{type:"primary",loading:o||c,disabled:x,onClick:()=>r.submit(),children:o||c?"Saving...":"Save Settings"})]}),onCancel:f,children:(0,a.jsxs)(st.Form,{form:r,layout:"horizontal",onFinish:g,initialValues:p,children:[(0,a.jsx)(st.Form.Item,{label:"Store Prompts in Spend Logs",name:"store_prompts_in_spend_logs",tooltip:m?.find(e=>"store_prompts_in_spend_logs"===e.field_name)?.field_description||"When enabled, prompts will be stored in spend logs for tracking and analysis purposes.",valuePropName:"checked",children:(0,a.jsx)("div",{children:x?(0,a.jsx)(sr.Skeleton.Input,{active:!0,block:!0}):(0,a.jsx)(si.Switch,{checked:h??!1,onChange:e=>r.setFieldValue("store_prompts_in_spend_logs",e)})})}),(0,a.jsx)(st.Form.Item,{label:"Maximum Spend Logs Retention Period (Optional)",name:"maximum_spend_logs_retention_period",tooltip:m?.find(e=>"maximum_spend_logs_retention_period"===e.field_name)?.field_description||"Set the maximum retention period for spend logs (e.g., '7d' for 7 days, '30d' for 30 days). Leave empty for no limit.",children:x?(0,a.jsx)(sr.Skeleton.Input,{active:!0,block:!0}):(0,a.jsx)(sa.Input,{placeholder:"e.g., 7d, 30d",prefix:(0,a.jsx)(ss.ClockCircleOutlined,{})})})]},m?JSON.stringify(p):"loading")})};function sc({data:e}){let[s,t]=(0,i.useState)({});if(!e||0===e.length)return null;let l=e=>new Date(1e3*e).toLocaleString();return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,a.jsx)(d.Collapse,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Vector Store Requests"}),children:(0,a.jsx)("div",{className:"p-4",children:e.map((e,r)=>{var n,i;return(0,a.jsxs)("div",{className:"mb-6 last:mb-0",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border p-4 mb-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Query:"}),(0,a.jsx)("span",{className:"font-mono",children:e.query})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Vector Store ID:"}),(0,a.jsx)("span",{className:"font-mono",children:e.vector_store_id})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,a.jsx)("span",{className:"flex items-center",children:(()=>{let{logo:s,displayName:t}=(0,ec.getProviderLogoAndName)(e.custom_llm_provider);return(0,a.jsxs)(a.Fragment,{children:[s&&(0,a.jsx)("img",{src:s,alt:`${t} logo`,className:"h-5 w-5 mr-2"}),t]})})()})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,a.jsx)("span",{children:l(e.start_time)})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,a.jsx)("span",{children:l(e.end_time)})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,a.jsx)("span",{children:(n=e.start_time,i=e.end_time,`${((i-n)*1e3).toFixed(2)}ms`)})]})]})]})}),(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Search Results"}),(0,a.jsx)("div",{className:"space-y-2",children:e.vector_store_search_response.data.map((e,l)=>{let n=s[`${r}-${l}`]||!1;return(0,a.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 cursor-pointer",onClick:()=>{let e;return e=`${r}-${l}`,void t(s=>({...s,[e]:!s[e]}))},children:[(0,a.jsx)("svg",{className:`w-5 h-5 mr-2 transition-transform ${n?"transform rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("span",{className:"font-medium mr-2",children:["Result ",l+1]}),(0,a.jsxs)("span",{className:"text-gray-500 text-sm",children:["Score: ",(0,a.jsx)("span",{className:"font-mono",children:e.score.toFixed(4)})]})]})]}),n&&(0,a.jsx)("div",{className:"p-3 border-t bg-white",children:e.content.map((e,s)=>(0,a.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:e.type}),(0,a.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all bg-gray-50 p-2 rounded",children:e.text})]},s))})]},l)})})]},r)})})}]})})}var sm=e.i(608856),sx=e.i(869216),su=e.i(175712),sh=e.i(262218),sp=e.i(653496),sg=e.i(560445),sf=e.i(91739);let sj="24px",sy="request",sb="response",sv="monospace",sN="#f0f0f0",{Text:sw}=so.Typography;function s_({value:e,maxWidth:s=180}){return e?(0,a.jsx)(o.Tooltip,{title:e,children:(0,a.jsx)(sw,{copyable:{text:e,tooltips:["Copy","Copied!"]},style:{maxWidth:s,display:"inline-block",verticalAlign:"bottom",fontFamily:sv,fontSize:12},ellipsis:!0,children:e})}):(0,a.jsx)(sw,{type:"secondary",children:"-"})}let{Text:sk}=so.Typography;function sS({prompt:e=0,completion:s=0,total:t=0}){return(0,a.jsxs)(sk,{children:[t.toLocaleString()," (",e.toLocaleString()," prompt tokens + ",s.toLocaleString()," completion tokens)"]})}let{Text:sC}=so.Typography;function sT({data:e}){return e?(0,a.jsx)("div",{style:{maxHeight:400,overflow:"auto",background:"#fafafa",padding:12,borderRadius:4},children:(0,a.jsx)("div",{className:"[&_[role='tree']]:bg-white [&_[role='tree']]:text-slate-900",children:(0,a.jsx)(eV,{data:e,style:eK,clickToExpandNode:!0})})}):(0,a.jsx)(sC,{type:"secondary",children:"No data"})}var sL=e.i(149192),sM=e.i(536591),sM=sM,sD=e.i(755151);let{Text:sz}=so.Typography;function sR({log:e,onClose:s,onPrevious:t,onNext:l,statusLabel:r,statusColor:n,environment:i}){let o=e.custom_llm_provider||"",d=o?(0,ec.getProviderLogoAndName)(o):null;return(0,a.jsxs)("div",{style:{padding:"16px 24px",borderBottom:`1px solid ${sN}`,backgroundColor:"#fff",position:"sticky",top:0,zIndex:10},children:[(0,a.jsx)(sI,{model:e.model,providerLogo:d?.logo,providerName:d?.displayName}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,a.jsx)(sE,{requestId:e.request_id}),(0,a.jsx)(sA,{onPrevious:t,onNext:l,onClose:s})]}),(0,a.jsx)(sO,{log:e,statusLabel:r,statusColor:n,environment:i})]})}function sI({model:e,providerLogo:s,providerName:t}){return(0,a.jsxs)(sn.Space,{size:8,style:{marginBottom:8},children:[s&&(0,a.jsx)("img",{src:s,alt:t||"Provider",style:{width:24,height:24},onError:e=>{e.target.style.display="none"}}),(0,a.jsxs)(sn.Space,{size:8,direction:"horizontal",children:[(0,a.jsx)(sz,{strong:!0,style:{fontSize:14},children:e}),t&&(0,a.jsx)(sz,{type:"secondary",style:{fontSize:12},children:t})]})]})}function sE({requestId:e}){return(0,a.jsx)("div",{style:{flex:1,minWidth:0},children:(0,a.jsx)(o.Tooltip,{title:e,children:(0,a.jsx)(sz,{strong:!0,copyable:{text:e,tooltips:["Copy Request ID","Copied!"]},style:{fontSize:16,fontFamily:sv,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:e})})})}function sA({onPrevious:e,onNext:s,onClose:t}){let l={border:"1px solid #d9d9d9",borderRadius:4,padding:"0 4px",fontSize:12,fontFamily:"monospace",marginLeft:4,background:"#fafafa"};return(0,a.jsxs)(sn.Space,{size:4,split:(0,a.jsx)("div",{style:{width:1,height:20,background:sN}}),children:[(0,a.jsxs)(A.Button,{type:"text",size:"small",onClick:e,children:[(0,a.jsx)(sM.default,{}),(0,a.jsx)("span",{style:l,children:"K"})]}),(0,a.jsxs)(A.Button,{type:"text",size:"small",onClick:s,children:[(0,a.jsx)(sD.DownOutlined,{}),(0,a.jsx)("span",{style:l,children:"J"})]}),(0,a.jsx)(o.Tooltip,{title:"ESC to close",children:(0,a.jsx)(A.Button,{type:"text",icon:(0,a.jsx)(sL.CloseOutlined,{}),onClick:t})})]})}function sO({log:e,statusLabel:s,statusColor:t,environment:l}){return(0,a.jsxs)(sn.Space,{size:12,children:[(0,a.jsx)(sh.Tag,{color:t,children:s}),(0,a.jsxs)(sh.Tag,{children:["Env: ",l]}),(0,a.jsxs)(sn.Space,{size:8,children:[(0,a.jsx)(sz,{type:"secondary",style:{fontSize:13},children:(0,n.default)(e.startTime).format("MMM D, YYYY h:mm:ss A")}),(0,a.jsxs)(sz,{type:"secondary",style:{fontSize:13},children:["(",(0,n.default)(e.startTime).fromNow(),")"]})]})]})}function sB(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}function sP(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}var sF=e.i(366308),sq=e.i(240647),s$=e.i(291542);let{Text:sK}=so.Typography;function sH({tool:e}){let s=Object.entries(e.parameters?.properties||{}).map(([s,t])=>({key:s,name:s,type:t.type||"any",description:t.description||"-",required:e.parameters?.required?.includes(s)||!1})),t=[{title:"Parameter",dataIndex:"name",key:"name",render:(e,s)=>(0,a.jsxs)(sK,{code:!0,children:[e,s.required&&(0,a.jsx)(sK,{type:"danger",children:"*"})]})},{title:"Type",dataIndex:"type",key:"type",render:e=>(0,a.jsx)(sK,{code:!0,style:{color:"#1890ff"},children:e})},{title:"Description",dataIndex:"description",key:"description",render:e=>(0,a.jsx)(sK,{type:"secondary",children:e})}];return(0,a.jsxs)("div",{children:[e.description&&(0,a.jsx)("div",{style:{marginBottom:16},children:(0,a.jsx)(sK,{style:{lineHeight:1.6},children:e.description})}),s.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(sK,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:8},children:"Parameters"}),(0,a.jsx)(s$.Table,{dataSource:s,columns:t,pagination:!1,size:"small",bordered:!0})]}),e.called&&e.callData&&(0,a.jsxs)("div",{style:{marginTop:16},children:[(0,a.jsx)(sK,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:8},children:"Called With"}),(0,a.jsx)("div",{style:{background:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:4,padding:12},children:(0,a.jsx)("pre",{style:{margin:0,fontSize:12,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(e.callData.arguments,null,2)})})]})]})}function sV({tool:e}){let s={type:"function",function:{name:e.name,description:e.description,parameters:e.parameters}};return(0,a.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:12,background:"#fafafa",padding:12,borderRadius:4,maxHeight:300,overflow:"auto"},children:JSON.stringify(s,null,2)})}let{Text:sY}=so.Typography;function sW({tool:e}){let[s,t]=(0,i.useState)("formatted");return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[(0,a.jsx)(sY,{type:"secondary",style:{fontSize:12},children:"Description"}),(0,a.jsxs)(sf.Radio.Group,{size:"small",value:s,onChange:e=>t(e.target.value),children:[(0,a.jsx)(sf.Radio.Button,{value:"formatted",children:"Formatted"}),(0,a.jsx)(sf.Radio.Button,{value:"json",children:"JSON"})]})]}),"formatted"===s?(0,a.jsx)(sH,{tool:e}):(0,a.jsx)(sV,{tool:e})]})}let{Text:sJ}=so.Typography;function sU({tool:e}){let[s,t]=(0,i.useState)(!1);return(0,a.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:8,overflow:"hidden"},children:[(0,a.jsxs)("div",{onClick:()=>t(!s),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",cursor:"pointer",background:s?"#fafafa":"#fff",transition:"background 0.2s"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)(sF.ToolOutlined,{style:{color:"#8c8c8c",fontSize:14}}),(0,a.jsxs)(sJ,{style:{fontSize:14},children:[e.index,". ",e.name]})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)(sh.Tag,{color:e.called?"blue":"default",children:e.called?"called":"not called"}),s?(0,a.jsx)(sD.DownOutlined,{style:{fontSize:12,color:"#8c8c8c"}}):(0,a.jsx)(sq.RightOutlined,{style:{fontSize:12,color:"#8c8c8c"}})]})]}),s&&(0,a.jsx)("div",{style:{padding:"16px",borderTop:"1px solid #f0f0f0",background:"#fff"},children:(0,a.jsx)(sW,{tool:e})})]})}let{Text:sG}=so.Typography;function sQ({log:e}){let s=function(e){let s,t=!(s=sP(e.proxy_server_request||e.messages))||Array.isArray(s)?[]:"object"==typeof s&&s.tools&&Array.isArray(s.tools)?s.tools:[];if(0===t.length)return[];let a=function(e){let s=sP(e.response);if(!s||"object"!=typeof s)return[];let t=s.choices;if(Array.isArray(t)&&t.length>0){let e=t[0].message;if(e&&Array.isArray(e.tool_calls))return e.tool_calls}return[]}(e),l=new Set(a.map(e=>e.function?.name).filter(Boolean)),r=new Map;return a.forEach(e=>{let s=e.function?.name;s&&r.set(s,{id:e.id,name:s,arguments:function(e){try{return JSON.parse(e)}catch{return{}}}(e.function?.arguments||"{}")})}),t.map((e,s)=>{let t=e.function||{name:`Tool ${s+1}`},a=t.name||`Tool ${s+1}`;return{index:s+1,name:a,description:t.description||"",parameters:t.parameters||{},called:l.has(a),callData:r.get(a)}})}(e);if(0===s.length)return null;let t=s.length,l=s.filter(e=>e.called).length,r=s.slice(0,2).map(e=>e.name).join(", "),n=s.length>2;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,a.jsx)(d.Collapse,{expandIconPosition:"start",items:[{key:"1",label:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Tools"}),(0,a.jsxs)(sG,{type:"secondary",style:{fontSize:14},children:[t," provided, ",l," called"]}),(0,a.jsxs)(sG,{type:"secondary",style:{fontSize:14},children:["â€¢ ",r,n&&"..."]})]}),children:(0,a.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:s.map(e=>(0,a.jsx)(sU,{tool:e},e.name))})}]})})}let sX=e=>{if(!e)return{};if("string"==typeof e)try{return JSON.parse(e)}catch{return{raw:e}}return e};var sZ=e.i(998573);e.i(247167);var s0=e.i(931067);let s1={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"};var s2=e.i(9583),s4=i.forwardRef(function(e,s){return i.createElement(s2.default,(0,s0.default)({},e,{ref:s,icon:s1}))}),s5=e.i(166406),sM=sM;let{Text:s3}=so.Typography;function s6({type:e,tokens:s,cost:t,onCopy:l,isCollapsed:r,onToggleCollapse:n}){return(0,a.jsxs)("div",{onClick:n,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 16px",borderBottom:r?"none":"1px solid #f0f0f0",background:"#fafafa",cursor:n?"pointer":"default",transition:"background 0.15s ease"},onMouseEnter:e=>{n&&(e.currentTarget.style.background="#f5f5f5")},onMouseLeave:e=>{e.currentTarget.style.background="#fafafa"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[n&&(0,a.jsx)("div",{style:{display:"flex",alignItems:"center"},children:r?(0,a.jsx)(sD.DownOutlined,{style:{fontSize:10,color:"#8c8c8c"}}):(0,a.jsx)(sM.default,{style:{fontSize:10,color:"#8c8c8c"}})}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:["input"===e?(0,a.jsx)(s4,{style:{color:"#8c8c8c",fontSize:14}}):(0,a.jsx)("span",{style:{fontSize:14,filter:"grayscale(1)",opacity:.6},children:"âœ¨"}),(0,a.jsx)(s3,{style:{fontWeight:500,fontSize:14},children:"input"===e?"Input":"Output"})]}),void 0!==s&&(0,a.jsxs)(s3,{type:"secondary",style:{fontSize:12},children:["Tokens: ",s.toLocaleString()]}),void 0!==t&&(0,a.jsxs)(s3,{type:"secondary",style:{fontSize:12},children:["Cost: $",t.toFixed(6)]})]}),(0,a.jsx)(o.Tooltip,{title:"Copy",children:(0,a.jsx)(A.Button,{type:"text",size:"small",icon:(0,a.jsx)(s5.CopyOutlined,{}),onClick:e=>{e.stopPropagation(),l()}})})]})}let{Text:s8}=so.Typography;function s9({label:e,content:s,defaultExpanded:t=!1}){let[l,r]=(0,i.useState)(t),[n,o]=(0,i.useState)(!1),d=s?.length||0;return s&&0!==d?(0,a.jsxs)("div",{style:{marginBottom:8},children:[(0,a.jsxs)("div",{onClick:()=>r(!l),onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",padding:"4px 0",borderRadius:4,background:n?"#f5f5f5":"transparent",transition:"background 0.15s ease",marginBottom:4*!!l},children:[l?(0,a.jsx)(sD.DownOutlined,{style:{fontSize:10,color:"#8c8c8c"}}):(0,a.jsx)(sq.RightOutlined,{style:{fontSize:10,color:"#8c8c8c"}}),(0,a.jsx)(s8,{type:"secondary",style:{fontSize:10,letterSpacing:"0.5px",textTransform:"uppercase"},children:e}),(0,a.jsxs)(s8,{type:"secondary",style:{fontSize:10},children:["(",d.toLocaleString()," chars)"]})]}),(0,a.jsx)("div",{style:{maxHeight:l?"2000px":"0px",overflow:"hidden",transition:"max-height 0.2s ease-out, opacity 0.2s ease-out",opacity:+!!l},children:(0,a.jsx)("div",{style:{paddingLeft:16,fontSize:13,lineHeight:1.7,color:"#262626",borderLeft:"1px solid #f0f0f0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:s})})]}):null}let{Text:s7}=so.Typography;function te({tool:e,compact:s=!1}){return(0,a.jsxs)("div",{style:{background:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:6,padding:s?"6px 10px":"10px 14px",marginTop:8,fontFamily:"monospace",fontSize:12,position:"relative"},children:[(0,a.jsx)("div",{style:{position:"absolute",top:-8,left:12,background:"#fff",padding:"0 6px",fontSize:10,color:"#8c8c8c",border:"1px solid #e9ecef",borderRadius:3},children:"function"}),(0,a.jsx)(s7,{strong:!0,style:{fontSize:13,display:"block",marginBottom:6},children:e.name}),Object.keys(e.arguments).length>0&&(0,a.jsx)("div",{children:Object.entries(e.arguments).map(([e,s])=>(0,a.jsxs)("div",{style:{marginBottom:2},children:[(0,a.jsxs)(s7,{type:"secondary",style:{fontSize:12},children:[e,":"," "]}),(0,a.jsx)(s7,{style:{fontSize:12},children:JSON.stringify(s)})]},e))})]})}let{Text:ts}=so.Typography;function tt({label:e,content:s,toolCalls:t,isCompact:l=!1}){let r=s&&"null"!==s&&s.length>0?s:null,n=t&&t.length>0;return r||n?(0,a.jsxs)("div",{style:{marginBottom:8*!!l},children:[(0,a.jsx)(ts,{type:"secondary",style:{fontSize:10,letterSpacing:"0.5px",textTransform:"uppercase",display:"block",marginBottom:3},children:e}),r&&(0,a.jsx)("div",{style:{fontSize:13,lineHeight:1.7,color:"#262626",whiteSpace:"pre-wrap",wordBreak:"break-word",marginBottom:6*!!n},children:r}),n&&(0,a.jsx)("div",{children:t.map((e,s)=>(0,a.jsx)(te,{tool:e,compact:l},e.id||s))})]}):null}let{Text:ta}=so.Typography;function tl({messages:e}){let[s,t]=(0,i.useState)(!1),[l,r]=(0,i.useState)(!1);return 0===e.length?null:(0,a.jsxs)("div",{style:{marginBottom:8},children:[(0,a.jsxs)("div",{onClick:()=>t(!s),onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",padding:"4px 0",borderRadius:4,background:l?"#f5f5f5":"transparent",transition:"background 0.15s ease",marginBottom:4*!!s},children:[s?(0,a.jsx)(sD.DownOutlined,{style:{fontSize:10,color:"#8c8c8c"}}):(0,a.jsx)(sq.RightOutlined,{style:{fontSize:10,color:"#8c8c8c"}}),(0,a.jsxs)(ta,{type:"secondary",style:{fontSize:10,letterSpacing:"0.5px",textTransform:"uppercase"},children:["HISTORY (",e.length," message",1!==e.length?"s":"",")"]})]}),(0,a.jsx)("div",{style:{maxHeight:s?"2000px":"0px",overflow:"hidden",transition:"max-height 0.2s ease-out, opacity 0.2s ease-out",opacity:+!!s},children:(0,a.jsx)("div",{style:{paddingLeft:16,borderLeft:"1px solid #f0f0f0"},children:e.map((e,s)=>(0,a.jsx)(tt,{label:e.role.toUpperCase(),content:e.content,toolCalls:e.toolCalls,isCompact:!0},s))})})]})}function tr({messages:e,promptTokens:s,inputCost:t}){let[l,r]=(0,i.useState)(!1);if(0===e.length)return null;let n=e.find(e=>"system"===e.role),o=e.filter(e=>"system"!==e.role),d=o.length>0?o[o.length-1]:null,c=o.slice(0,-1);return(0,a.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:6,marginBottom:8,overflow:"hidden"},children:[(0,a.jsx)(s6,{type:"input",tokens:s,cost:t,onCopy:()=>{let s=JSON.stringify(e,null,2);navigator.clipboard.writeText(s),sZ.message.success("Input copied")},isCollapsed:l,onToggleCollapse:()=>r(!l)}),(0,a.jsx)("div",{style:{maxHeight:l?"0px":"10000px",overflow:"hidden",transition:"max-height 0.3s ease-out, opacity 0.3s ease-out",opacity:+!l},children:(0,a.jsxs)("div",{style:{padding:"12px 16px"},children:[n&&(0,a.jsx)(s9,{label:"SYSTEM",content:n.content,defaultExpanded:!!(n.content&&n.content.length<200)}),c.length>0&&(0,a.jsx)(tl,{messages:c}),d&&(0,a.jsx)(tt,{label:d.role.toUpperCase(),content:d.content,toolCalls:d.toolCalls})]})})]})}let{Text:tn}=so.Typography;function ti({message:e,completionTokens:s,outputCost:t}){let[l,r]=(0,i.useState)(!1),n=()=>{if(!e)return;let s=JSON.stringify(e,null,2);navigator.clipboard.writeText(s),sZ.message.success("Output copied")};return e?(0,a.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:6,overflow:"hidden"},children:[(0,a.jsx)(s6,{type:"output",tokens:s,cost:t,onCopy:n,isCollapsed:l,onToggleCollapse:()=>r(!l)}),(0,a.jsx)("div",{style:{maxHeight:l?"0px":"10000px",overflow:"hidden",transition:"max-height 0.3s ease-out, opacity 0.3s ease-out",opacity:+!l},children:(0,a.jsx)("div",{style:{padding:"12px 16px"},children:(0,a.jsx)(tt,{label:"ASSISTANT",content:e.content,toolCalls:e.toolCalls})})})]}):(0,a.jsxs)("div",{style:{border:"1px solid #f0f0f0",borderRadius:6,overflow:"hidden"},children:[(0,a.jsx)(s6,{type:"output",tokens:s,cost:t,onCopy:n,isCollapsed:l,onToggleCollapse:()=>r(!l)}),(0,a.jsx)("div",{style:{maxHeight:l?"0px":"10000px",overflow:"hidden",transition:"max-height 0.3s ease-out, opacity 0.3s ease-out",opacity:+!l},children:(0,a.jsx)("div",{style:{padding:"12px 16px"},children:(0,a.jsx)(tn,{type:"secondary",style:{fontSize:13,fontStyle:"italic"},children:"No response data available"})})})]})}function to({request:e,response:s,metrics:t}){let l,r,n,{requestMessages:i,responseMessage:o}=(l=[],e?.messages&&Array.isArray(e.messages)&&e.messages.forEach(e=>{let s;l.push({role:e.role||"user",content:"string"==typeof(s=e.content)?s:Array.isArray(s)?s.map(e=>"string"==typeof e?e:"text"===e.type?e.text:"image_url"===e.type?"[Image]":JSON.stringify(e)).join("\n"):JSON.stringify(s),toolCallId:e.tool_call_id})}),r=null,(n=s?.choices?.[0]?.message)&&(r={role:n.role||"assistant",content:n.content||"",toolCalls:(e=>{if(e&&Array.isArray(e))return e.map(e=>({id:e.id||"",name:e.function?.name||"unknown",arguments:sX(e.function?.arguments)}))})(n.tool_calls)}),{requestMessages:l,responseMessage:r});return(0,a.jsxs)("div",{children:[(0,a.jsx)(tr,{messages:i,promptTokens:t?.prompt_tokens,inputCost:t?.input_cost}),(0,a.jsx)(ti,{message:o,completionTokens:t?.completion_tokens,outputCost:t?.output_cost})]})}let{Text:td}=so.Typography;function tc({open:e,onClose:s,logEntry:t,onOpenSettings:l,allLogs:r=[],onSelectLog:n}){var o,d;let[c,m]=(0,i.useState)(sy),{selectNextLog:x,selectPreviousLog:u}=function({isOpen:e,currentLog:s,allLogs:t,onClose:a,onSelectLog:l}){(0,i.useEffect)(()=>{let s=s=>{var t;if(!((t=s.target)instanceof HTMLInputElement||t instanceof HTMLTextAreaElement)&&e)switch(s.key){case"Escape":a();break;case"j":case"J":n();break;case"k":case"K":r()}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[e,s,t]);let r=()=>{if(!s||!t.length||!l)return;let e=t.findIndex(e=>e.request_id===s.request_id);e<t.length-1&&l(t[e+1])},n=()=>{if(!s||!t.length||!l)return;let e=t.findIndex(e=>e.request_id===s.request_id);e>0&&l(t[e-1])};return{selectNextLog:r,selectPreviousLog:n}}({isOpen:e,currentLog:t,allLogs:r,onClose:s,onSelectLog:n});if(!t)return null;let h=t.metadata||{},p="failure"===h.status,g=p?h.error_information:null,f=!!(o=t.messages)&&(Array.isArray(o)?o.length>0:"object"==typeof o&&Object.keys(o).length>0),j=!!(d=t.response)&&Object.keys(sB(d)).length>0,y=!f&&!j,b=h?.guardrail_information,v=Array.isArray(b)?b:b?[b]:[],N=v.length>0,w=v.reduce((e,s)=>{let t=s?.masked_entity_count;return t?e+Object.values(t).reduce((e,s)=>"number"==typeof s?e+s:e,0):e},0),_=0===v.length?"-":1===v.length?v[0]?.guardrail_name??"-":`${v.length} guardrails`,k=h.vector_store_request_metadata&&Array.isArray(h.vector_store_request_metadata)&&h.vector_store_request_metadata.length>0,C="failure"===h.status?"Failure":"Success",T="failure"===h.status?"error":"success",L=h?.user_api_key_team_alias||"default";return(0,a.jsxs)(sm.Drawer,{title:null,placement:"right",onClose:s,open:e,width:"60%",closable:!1,mask:!0,maskClosable:!0,styles:{body:{padding:0,overflow:"hidden"},header:{display:"none"}},children:[(0,a.jsx)(sR,{log:t,onClose:s,onPrevious:u,onNext:x,statusLabel:C,statusColor:T,environment:L}),(0,a.jsxs)("div",{style:{height:"calc(100vh - 100px)",overflowY:"auto",padding:`${sj} ${sj} 0`},children:[p&&g&&(0,a.jsx)(sg.Alert,{type:"error",showIcon:!0,message:"Request Failed",description:(0,a.jsx)(tm,{errorInfo:g}),className:"mb-6"}),t.request_tags&&Object.keys(t.request_tags).length>0&&(0,a.jsx)(tx,{tags:t.request_tags}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,a.jsx)(su.Card,{title:"Request Details",size:"small",bordered:!1,style:{marginBottom:0},children:(0,a.jsxs)(sx.Descriptions,{column:2,size:"small",children:[(0,a.jsx)(sx.Descriptions.Item,{label:"Model",children:t.model}),(0,a.jsx)(sx.Descriptions.Item,{label:"Provider",children:t.custom_llm_provider||"-"}),(0,a.jsx)(sx.Descriptions.Item,{label:"Call Type",children:t.call_type}),(0,a.jsx)(sx.Descriptions.Item,{label:"Model ID",children:(0,a.jsx)(s_,{value:t.model_id})}),(0,a.jsx)(sx.Descriptions.Item,{label:"API Base",children:(0,a.jsx)(s_,{value:t.api_base,maxWidth:200})}),t.requester_ip_address&&(0,a.jsx)(sx.Descriptions.Item,{label:"IP Address",children:t.requester_ip_address}),N&&(0,a.jsx)(sx.Descriptions.Item,{label:"Guardrail",children:(0,a.jsx)(tu,{label:_,maskedCount:w})})]})})}),(0,a.jsx)(th,{logEntry:t,metadata:h}),(0,a.jsx)(ej,{costBreakdown:h?.cost_breakdown,totalSpend:t.spend||0}),(0,a.jsx)(sQ,{log:t}),y&&(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(ep,{show:y,onOpenSettings:l})}),(0,a.jsx)(tp,{hasResponse:j,getRawRequest:()=>sB(t.proxy_server_request||t.messages),getFormattedResponse:()=>p&&g?{error:{message:g.error_message||"An error occurred",type:g.error_class||"error",code:g.error_code||"unknown",param:null}}:sB(t.response),logEntry:t}),N&&(0,a.jsx)(S,{data:b}),k&&(0,a.jsx)(sc,{data:h.vector_store_request_metadata}),t.metadata&&Object.keys(t.metadata).length>0&&(0,a.jsx)(tg,{metadata:t.metadata}),(0,a.jsx)("div",{style:{height:sj}})]})]})}function tm({errorInfo:e}){return(0,a.jsxs)("div",{children:[e.error_code&&(0,a.jsxs)("div",{children:[(0,a.jsx)(td,{strong:!0,children:"Error Code:"})," ",e.error_code]}),e.error_message&&(0,a.jsxs)("div",{children:[(0,a.jsx)(td,{strong:!0,children:"Message:"})," ",e.error_message]})]})}function tx({tags:e}){return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden p-4 mb-6",children:[(0,a.jsx)(td,{strong:!0,style:{display:"block",marginBottom:8,fontSize:16},children:"Tags"}),(0,a.jsx)(sn.Space,{size:8,wrap:!0,children:Object.entries(e).map(([e,s])=>(0,a.jsxs)(sh.Tag,{children:[e,": ",String(s)]},e))})]})}function tu({label:e,maskedCount:s}){return(0,a.jsxs)(sn.Space,{size:8,children:[(0,a.jsx)("span",{children:e}),s>0&&(0,a.jsxs)(sh.Tag,{color:"blue",children:[s," masked"]})]})}function th({logEntry:e,metadata:s}){let t=e.cache_hit||s?.additional_usage_values?.cache_read_input_tokens&&s.additional_usage_values.cache_read_input_tokens>0;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,a.jsx)(su.Card,{title:"Metrics",size:"small",bordered:!1,style:{marginBottom:0},children:(0,a.jsxs)(sx.Descriptions,{column:2,size:"small",children:[(0,a.jsx)(sx.Descriptions.Item,{label:"Tokens",children:(0,a.jsx)(sS,{prompt:e.prompt_tokens,completion:e.completion_tokens,total:e.total_tokens})}),(0,a.jsxs)(sx.Descriptions.Item,{label:"Cost",children:["$",(0,C.formatNumberWithCommas)(e.spend||0,8)]}),(0,a.jsxs)(sx.Descriptions.Item,{label:"Duration",children:[e.duration?.toFixed(3)," s"]}),t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sx.Descriptions.Item,{label:"Cache Hit",children:(0,a.jsx)(sh.Tag,{color:e.cache_hit?"green":"default",children:e.cache_hit||"None"})}),s?.additional_usage_values?.cache_read_input_tokens>0&&(0,a.jsx)(sx.Descriptions.Item,{label:"Cache Read Tokens",children:(0,C.formatNumberWithCommas)(s.additional_usage_values.cache_read_input_tokens)}),s?.additional_usage_values?.cache_creation_input_tokens>0&&(0,a.jsx)(sx.Descriptions.Item,{label:"Cache Creation Tokens",children:(0,C.formatNumberWithCommas)(s.additional_usage_values.cache_creation_input_tokens)})]}),s?.litellm_overhead_time_ms!==void 0&&null!==s.litellm_overhead_time_ms&&(0,a.jsxs)(sx.Descriptions.Item,{label:"LiteLLM Overhead",children:[s.litellm_overhead_time_ms.toFixed(2)," ms"]}),(0,a.jsx)(sx.Descriptions.Item,{label:"Start Time",children:(0,n.default)(e.startTime).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}),(0,a.jsx)(sx.Descriptions.Item,{label:"End Time",children:(0,n.default)(e.endTime).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")})]})})})}function tp({hasResponse:e,getRawRequest:s,getFormattedResponse:t,logEntry:l}){let[r,n]=(0,i.useState)(sy),[o,c]=(0,i.useState)("pretty"),m=l.spend||0,x=l.prompt_tokens||0,u=l.completion_tokens||0,h=x+u;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,a.jsx)(d.Collapse,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},onClick:e=>{e.target.closest(".ant-radio-group")&&e.stopPropagation()},children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",style:{margin:0},children:"Request & Response"}),(0,a.jsxs)(sf.Radio.Group,{size:"small",value:o,onChange:e=>c(e.target.value),children:[(0,a.jsx)(sf.Radio.Button,{value:"pretty",children:"Pretty"}),(0,a.jsx)(sf.Radio.Button,{value:"json",children:"JSON"})]})]}),children:(0,a.jsx)("div",{children:"pretty"===o?(0,a.jsx)(to,{request:s(),response:t(),metrics:{prompt_tokens:x,completion_tokens:u,input_cost:h>0?m*x/h:0,output_cost:h>0?m*u/h:0}}):(0,a.jsx)(sp.Tabs,{activeKey:r,onChange:e=>n(e),tabBarExtraContent:(0,a.jsx)(td,{copyable:{text:JSON.stringify(r===sy?s():t(),null,2),tooltips:["Copy JSON","Copied!"]},disabled:r===sb&&!e}),items:[{key:sy,label:"Request",children:(0,a.jsx)("div",{style:{paddingTop:16,paddingBottom:16},children:(0,a.jsx)(sT,{data:s(),mode:"formatted"})})},{key:sb,label:"Response",children:(0,a.jsx)("div",{style:{paddingTop:16,paddingBottom:16},children:e?(0,a.jsx)(sT,{data:t(),mode:"formatted"}):(0,a.jsx)("div",{style:{textAlign:"center",padding:20,color:"#999",fontStyle:"italic"},children:"Response data not available"})})}]})})}]})})}function tg({metadata:e}){return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden mb-6",children:(0,a.jsx)(d.Collapse,{defaultActiveKey:["1"],expandIconPosition:"start",items:[{key:"1",label:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Metadata"}),children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:8},children:(0,a.jsx)(td,{copyable:{text:JSON.stringify(e,null,2),tooltips:["Copy Metadata","Copied!"]}})}),(0,a.jsx)("pre",{style:{maxHeight:300,overflowY:"auto",fontSize:12,fontFamily:sv,whiteSpace:"pre-wrap",wordBreak:"break-all",margin:0},children:JSON.stringify(e,null,2)})]})}]})})}function tf({accessToken:e,token:s,userRole:t,userID:o,allTeams:d,premiumUser:c}){let[m,x]=(0,i.useState)(""),[u,h]=(0,i.useState)(!1),[p,g]=(0,i.useState)(!1),[f,j]=(0,i.useState)(1),[y]=(0,i.useState)(50),b=(0,i.useRef)(null),v=(0,i.useRef)(null),N=(0,i.useRef)(null),[w,_]=(0,i.useState)((0,n.default)().subtract(24,"hours").format("YYYY-MM-DDTHH:mm")),[k,S]=(0,i.useState)((0,n.default)().format("YYYY-MM-DDTHH:mm")),[C,T]=(0,i.useState)(!1),[B,P]=(0,i.useState)(!1),[F,q]=(0,i.useState)(""),[$,K]=(0,i.useState)(""),[H,V]=(0,i.useState)(""),[Y,W]=(0,i.useState)(""),[J,U]=(0,i.useState)(""),[G,X]=(0,i.useState)(null),[Z,ee]=(0,i.useState)(null),[es,et]=(0,i.useState)(""),[ed,ec]=(0,i.useState)(""),[em,eu]=(0,i.useState)(t&&O.internalUserRoles.includes(t)),[ep,eg]=(0,i.useState)("request logs"),[ef,ej]=(0,i.useState)(null),[ey,eR]=(0,i.useState)(!1),[eI,eE]=(0,i.useState)(null),[eA,eO]=(0,i.useState)(!1),eB=(0,r.useQueryClient)(),[eP,eF]=(0,i.useState)(()=>{let e=sessionStorage.getItem("isLiveTail");return null===e||JSON.parse(e)});(0,i.useEffect)(()=>{sessionStorage.setItem("isLiveTail",JSON.stringify(eP))},[eP]);let[eq,e$]=(0,i.useState)({value:24,unit:"hours"});(0,i.useEffect)(()=>{(async()=>{Z&&e&&X({...(await (0,en.keyInfoV1Call)(e,Z)).info,token:Z,api_key:Z})})()},[Z,e]),(0,i.useEffect)(()=>{function e(e){b.current&&!b.current.contains(e.target)&&g(!1),v.current&&!v.current.contains(e.target)&&h(!1),N.current&&!N.current.contains(e.target)&&P(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,i.useEffect)(()=>{t&&O.internalUserRoles.includes(t)&&eu(!0)},[t]);let eK=(0,l.useQuery)({queryKey:["logs","table",f,y,w,k,H,Y,em?o:null,es,J],queryFn:async()=>{if(!e||!s||!t||!o)return{data:[],total:0,page:1,page_size:y,total_pages:0};let a=(0,n.default)(w).utc().format("YYYY-MM-DD HH:mm:ss"),l=C?(0,n.default)(k).utc().format("YYYY-MM-DD HH:mm:ss"):(0,n.default)().utc().format("YYYY-MM-DD HH:mm:ss"),r=await (0,en.uiSpendLogsCall)(e,Y||void 0,H||void 0,void 0,a,l,f,y,em?o:void 0,ed,es,J);return await ez(r.data,a,e,eB),r.data=r.data.map(e=>{let s=eB.getQueryData(["logDetails",e.request_id,a]);return s?.messages&&s?.response&&(e.messages=s.messages,e.response=s.response),e}),r},enabled:!!e&&!!s&&!!t&&!!o&&"request logs"===ep,refetchInterval:!!eP&&1===f&&15e3,refetchIntervalInBackground:!0}),eH=eK.data||{data:[],total:0,page:1,page_size:y||10,total_pages:1},{filters:eV,filteredLogs:eY,allTeams:eW,allKeyAliases:eJ,handleFilterChange:eU,handleFilterReset:eG}=function({logs:e,accessToken:s,startTime:t,endTime:a,pageSize:r=ev.defaultPageSize,isCustomDate:o,setCurrentPage:d,userID:c,userRole:m}){let x=(0,i.useMemo)(()=>({[eN]:"",[ew]:"",[e_]:"",[ek]:"",[eS]:"",[eC]:"",[eT]:"",[eL]:"",[eM]:"",[eD]:""}),[]),[u,h]=(0,i.useState)(x),[p,g]=(0,i.useState)({data:[],total:0,page:1,page_size:50,total_pages:0}),f=(0,i.useRef)(0),j=(0,i.useCallback)(async(e,l=1)=>{if(!s)return;console.log("Filters being sent to API:",e);let i=Date.now();f.current=i;let d=(0,n.default)(t).utc().format("YYYY-MM-DD HH:mm:ss"),c=o?(0,n.default)(a).utc().format("YYYY-MM-DD HH:mm:ss"):(0,n.default)().utc().format("YYYY-MM-DD HH:mm:ss");try{let t=await (0,en.uiSpendLogsCall)(s,e[ew]||void 0,e[eN]||void 0,e[e_]||void 0,d,c,l,r,e[eS]||void 0,e[eC]||void 0,e[eT]||void 0,e[ek]||void 0,e[eL]||void 0,e[eM]||void 0,e[eD]||void 0);i===f.current&&t.data&&g(t)}catch(e){console.error("Error searching users:",e)}},[s,t,a,o,r]),y=(0,i.useMemo)(()=>(0,eb.default)((e,s)=>j(e,s),300),[j]);(0,i.useEffect)(()=>()=>y.cancel(),[y]);let b=(0,l.useQuery)({queryKey:["allKeys"],queryFn:async()=>{if(!s)throw Error("Access token required");return await (0,el.fetchAllKeyAliases)(s)},enabled:!!s}).data||[],v=(0,i.useMemo)(()=>!!(u[eL]||u[ew]||u[e_]||u[eS]||u[eC]||u[eM]||u[eD]),[u]),N=(0,i.useMemo)(()=>{if(!e||!e.data)return{data:[],total:0,page:1,page_size:50,total_pages:0};if(v)return e;let s=[...e.data];return u[eN]&&(s=s.filter(e=>e.team_id===u[eN])),u[eT]&&(s=s.filter(e=>"success"===u[eT]?!e.status||"success"===e.status:e.status===u[eT])),u[ek]&&(s=s.filter(e=>e.model===u[ek])),u[ew]&&(s=s.filter(e=>e.api_key===u[ew])),u[eC]&&(s=s.filter(e=>e.end_user===u[eC])),u[eM]&&(s=s.filter(e=>{let s=(e.metadata||{}).error_information;return s&&s.error_code===u[eM]})),{data:s,total:e.total,page:e.page,page_size:e.page_size,total_pages:e.total_pages}},[e,u,v]),w=(0,i.useMemo)(()=>v?p&&p.data&&p.data.length>0?p:e||{data:[],total:0,page:1,page_size:50,total_pages:0}:N,[v,p,N,e]),{data:_}=(0,l.useQuery)({queryKey:["allTeamsForLogFilters",s],queryFn:async()=>s&&await (0,el.fetchAllTeams)(s)||[],enabled:!!s});return{filters:u,filteredLogs:w,allKeyAliases:b,allTeams:_,handleFilterChange:e=>{h(s=>{let t={...s,...e};for(let e of Object.keys(x))e in t||(t[e]=x[e]);return JSON.stringify(t)!==JSON.stringify(s)&&(d(1),y(t,1)),t})},handleFilterReset:()=>{h(x),g({data:[],total:0,page:1,page_size:50,total_pages:0}),y(x,1)}}}({logs:eH,accessToken:e,startTime:w,endTime:k,pageSize:y,isCustomDate:C,setCurrentPage:j,userID:o,userRole:t}),eQ=(0,i.useCallback)(async s=>{if(e)try{let t=(await (0,en.keyListCall)(e,null,null,s,null,null,f,y)).keys.find(e=>e.key_alias===s);t&&W(t.token)}catch(e){console.error("Error fetching key hash for alias:",e)}},[e,f,y]);(0,i.useEffect)(()=>{e&&(eV["Team ID"]?V(eV["Team ID"]):V(""),et(eV.Status||""),U(eV.Model||""),ec(eV["End User"]||""),eV["Key Hash"]?W(eV["Key Hash"]):eV["Key Alias"]?eQ(eV["Key Alias"]):W(""))},[eV,e,eQ]);let eX=(0,l.useQuery)({queryKey:["sessionLogs",eI],queryFn:async()=>{if(!e||!eI)return{data:[],total:0,page:1,page_size:50,total_pages:1};let s=await (0,en.sessionSpendLogsCall)(e,eI);return{data:s.data||s||[],total:(s.data||s||[]).length,page:1,page_size:1e3,total_pages:1}},enabled:!!e&&!!eI});if(!e||!s||!t||!o)return null;let e0=eY.data.filter(e=>!m||e.request_id.includes(m)||e.model.includes(m)||e.user&&e.user.includes(m)).map(e=>({...e,duration:(Date.parse(e.endTime)-Date.parse(e.startTime))/1e3,onKeyHashClick:e=>ee(e),onSessionClick:e=>{e&&eE(e)}}))||[],e1=eX.data?.data?.map(e=>({...e,onKeyHashClick:e=>ee(e),onSessionClick:e=>{}}))||[],e2=e=>{ej(e),eR(!0)},e4=[{name:"Team ID",label:"Team ID",isSearchable:!0,searchFn:async e=>d&&0!==d.length?d.filter(s=>s.team_id.toLowerCase().includes(e.toLowerCase())||s.team_alias&&s.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:`${e.team_alias||e.team_id} (${e.team_id})`,value:e.team_id})):[]},{name:"Status",label:"Status",isSearchable:!1,options:[{label:"Success",value:"success"},{label:"Failure",value:"failure"}]},{name:"Model",label:"Model",isSearchable:!1},{name:"Key Alias",label:"Key Alias",isSearchable:!0,searchFn:async s=>e?(await (0,el.fetchAllKeyAliases)(e)).filter(e=>e.toLowerCase().includes(s.toLowerCase())).map(e=>({label:e,value:e})):[]},{name:"End User",label:"End User",isSearchable:!0,searchFn:async s=>{if(!e)return[];let t=await (0,en.allEndUsersCall)(e);return(t?.map(e=>e.user_id)||[]).filter(e=>e.toLowerCase().includes(s.toLowerCase())).map(e=>({label:e,value:e}))}},{name:"Error Code",label:"Error Code",isSearchable:!0,searchFn:async e=>((e,s="")=>{let t=new Set;return e.forEach(e=>{let a=e.metadata||{};if("failure"===a.status&&a.error_information){let e=a.error_information.error_code;e&&(!s||e.toLowerCase().includes(s.toLowerCase()))&&t.add(e)}}),Array.from(t).map(e=>({label:e,value:e}))})(eH.data,e)},{name:"Key Hash",label:"Key Hash",isSearchable:!1},{name:"Error Message",label:"Error Message",isSearchable:!1}];if(eI&&eX.data)return(0,a.jsx)("div",{className:"w-full p-6",children:(0,a.jsx)(eZ,{sessionId:eI,logs:eX.data.data,onBack:()=>eE(null)})});let e5=[{label:"Last 15 Minutes",value:15,unit:"minutes"},{label:"Last Hour",value:1,unit:"hours"},{label:"Last 4 Hours",value:4,unit:"hours"},{label:"Last 24 Hours",value:24,unit:"hours"},{label:"Last 7 Days",value:7,unit:"days"}],e3=e5.find(e=>e.value===eq.value&&e.unit===eq.unit),e6=C?((e,s,t)=>{if(e)return`${(0,n.default)(s).format("MMM D, h:mm A")} - ${(0,n.default)(t).format("MMM D, h:mm A")}`;let a=(0,n.default)(),l=(0,n.default)(s),r=a.diff(l,"minutes");if(r>=0&&r<2)return"Last 1 Minute";if(r>=2&&r<16)return"Last 15 Minutes";if(r>=16&&r<61)return"Last Hour";let i=a.diff(l,"hours");return i>=1&&i<5?"Last 4 Hours":i>=5&&i<25?"Last 24 Hours":i>=25&&i<169?"Last 7 Days":`${l.format("MMM D")} - ${a.format("MMM D")}`})(C,w,k):e3?.label;return(0,a.jsxs)("div",{className:"w-full max-w-screen p-6 overflow-x-hidden box-border",children:[(0,a.jsxs)(z.TabGroup,{defaultIndex:0,onIndexChange:e=>eg(0===e?"request logs":"audit logs"),children:[(0,a.jsxs)(R.TabList,{children:[(0,a.jsx)(D.Tab,{children:"Request Logs"}),(0,a.jsx)(D.Tab,{children:"Audit Logs"}),(0,a.jsx)(D.Tab,{children:"Deleted Keys"}),(0,a.jsx)(D.Tab,{children:"Deleted Teams"})]}),(0,a.jsxs)(E.TabPanels,{children:[(0,a.jsxs)(I.TabPanel,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold",children:eI?(0,a.jsxs)(a.Fragment,{children:["Session: ",(0,a.jsx)("span",{className:"font-mono",children:eI}),(0,a.jsx)("button",{className:"ml-4 px-3 py-1 text-sm border rounded hover:bg-gray-50",onClick:()=>eE(null),children:"â† Back to All Logs"})]}):"Request Logs"}),!eI&&(0,a.jsx)(e7.default,{dot:!0,children:(0,a.jsx)(A.Button,{icon:(0,a.jsx)(L.SettingOutlined,{}),onClick:()=>eO(!0),title:"Spend Logs Settings"})})]}),G&&Z&&G.api_key===Z?(0,a.jsx)(ei.default,{keyId:Z,keyData:G,teams:d,onClose:()=>ee(null),backButtonText:"Back to Logs"}):eI?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,a.jsx)(eo.DataTable,{columns:ex,data:e1,onRowClick:e2})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(er.default,{options:e4,onApplyFilters:eU,onResetFilters:eG}),(0,a.jsx)(sd,{isVisible:eA,onCancel:()=>eO(!1),onSuccess:()=>eO(!1)}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full box-border",children:[(0,a.jsx)("div",{className:"border-b px-6 py-4 w-full max-w-full box-border",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0 w-full max-w-full box-border",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3 w-full max-w-full box-border",children:[(0,a.jsxs)("div",{className:"relative w-64 min-w-0 flex-shrink-0",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search by Request ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:m,onChange:e=>x(e.target.value)}),(0,a.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-shrink",children:[(0,a.jsxs)("div",{className:"relative z-50",ref:N,children:[(0,a.jsxs)("button",{onClick:()=>P(!B),className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e6]}),B&&(0,a.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border p-2 z-50",children:(0,a.jsxs)("div",{className:"space-y-1",children:[e5.map(e=>(0,a.jsx)("button",{className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ${e6===e.label?"bg-blue-50 text-blue-600":""}`,onClick:()=>{S((0,n.default)().format("YYYY-MM-DDTHH:mm")),_((0,n.default)().subtract(e.value,e.unit).format("YYYY-MM-DDTHH:mm")),e$({value:e.value,unit:e.unit}),T(!1),P(!1)},children:e.label},e.label)),(0,a.jsx)("div",{className:"border-t my-2"}),(0,a.jsx)("button",{className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-50 rounded-md ${C?"bg-blue-50 text-blue-600":""}`,onClick:()=>T(!C),children:"Custom Range"})]})})]}),(0,a.jsx)(()=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Live Tail"}),(0,a.jsx)(M.Switch,{color:"green",checked:eP,defaultChecked:!0,onChange:eF})]}),{}),(0,a.jsxs)("button",{onClick:()=>{eK.refetch()},className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",title:"Refresh data",children:[(0,a.jsx)("svg",{className:`w-4 h-4 ${eK.isFetching?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,a.jsx)("span",{children:"Refresh"})]})]}),C&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"datetime-local",value:w,onChange:e=>{_(e.target.value),j(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),(0,a.jsx)("span",{className:"text-gray-500",children:"to"}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"datetime-local",value:k,onChange:e=>{S(e.target.value),j(1)},className:"px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700 whitespace-nowrap",children:["Showing ",eK.isLoading?"...":eY?(f-1)*y+1:0," -"," ",eK.isLoading?"...":eY?Math.min(f*y,eY.total):0," ","of ",eK.isLoading?"...":eY?eY.total:0," results"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700 min-w-[90px]",children:["Page ",eK.isLoading?"...":f," of"," ",eK.isLoading?"...":eY?eY.total_pages:1]}),(0,a.jsx)("button",{onClick:()=>j(e=>Math.max(1,e-1)),disabled:eK.isLoading||1===f,className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>j(e=>Math.min(eY.total_pages||1,e+1)),disabled:eK.isLoading||f===(eY.total_pages||1),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}),eP&&1===f&&(0,a.jsxs)("div",{className:"mb-4 px-4 py-2 bg-green-50 border border-greem-200 rounded-md flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:"text-sm text-green-700",children:"Auto-refreshing every 15 seconds"})}),(0,a.jsx)("button",{onClick:()=>eF(!1),className:"text-sm text-green-600 hover:text-green-800",children:"Stop"})]}),(0,a.jsx)(eo.DataTable,{columns:ex,data:e0,onRowClick:e2})]})]})]}),(0,a.jsx)(I.TabPanel,{children:(0,a.jsx)(eh,{userID:o,userRole:t,token:s,accessToken:e,isActive:"audit logs"===ep,premiumUser:c,allTeams:d})}),(0,a.jsx)(I.TabPanel,{children:(0,a.jsx)(Q,{})}),(0,a.jsx)(I.TabPanel,{children:(0,a.jsx)(ea,{})})]})]}),(0,a.jsx)(tc,{open:ey,onClose:()=>{eR(!1)},logEntry:ef,onOpenSettings:()=>eO(!0),allLogs:e0,onSelectLog:e=>{ej(e)}})]})}function tj({row:e,onOpenSettings:s}){let t=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch{}return e},l=e.original.metadata||{},r="failure"===l.status,n=r?l.error_information:null,i=e.original.messages&&(Array.isArray(e.original.messages)?e.original.messages.length>0:Object.keys(e.original.messages).length>0),d=e.original.response&&Object.keys(t(e.original.response)).length>0,c=l.vector_store_request_metadata&&Array.isArray(l.vector_store_request_metadata)&&l.vector_store_request_metadata.length>0,m=e.original.metadata?.guardrail_information,x=Array.isArray(m)?m:m?[m]:[],u=x.length>0,h=x.reduce((e,s)=>{let t=s?.masked_entity_count;return t?e+Object.values(t).reduce((e,s)=>"number"==typeof s?e+s:e,0):e},0),p=1===x.length?x[0]?.guardrail_name??"-":x.length>1?`${x.length} guardrails`:"-",g=(0,T.truncateString)(e.original.request_id,64);return(0,a.jsxs)("div",{className:"p-6 bg-gray-50 space-y-6 w-full max-w-full overflow-hidden box-border",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow w-full max-w-full overflow-hidden",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Request Details"})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 w-full max-w-full overflow-hidden",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Request ID:"}),e.original.request_id.length>64?(0,a.jsx)(o.Tooltip,{title:e.original.request_id,children:(0,a.jsx)("span",{className:"font-mono text-sm",children:g})}):(0,a.jsx)("span",{className:"font-mono text-sm",children:e.original.request_id})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Model:"}),(0,a.jsx)("span",{children:e.original.model})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Model ID:"}),(0,a.jsx)("span",{children:e.original.model_id})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Call Type:"}),(0,a.jsx)("span",{children:e.original.call_type})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Provider:"}),(0,a.jsx)("span",{children:e.original.custom_llm_provider||"-"})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"API Base:"}),(0,a.jsx)(o.Tooltip,{title:e.original.api_base||"-",children:(0,a.jsx)("span",{className:"max-w-[15ch] truncate block",children:e.original.api_base||"-"})})]}),e?.original?.requester_ip_address&&(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"IP Address:"}),(0,a.jsx)("span",{children:e?.original?.requester_ip_address})]}),u&&(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Guardrail:"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-mono",children:p}),h>0&&(0,a.jsxs)("span",{className:"ml-2 px-2 py-0.5 bg-blue-50 text-blue-700 rounded-md text-xs font-medium",children:[h," masked"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Tokens:"}),(0,a.jsxs)("span",{children:[e.original.total_tokens," (",e.original.prompt_tokens," prompt tokens +"," ",e.original.completion_tokens," completion tokens)"]})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Cache Read Tokens:"}),(0,a.jsx)("span",{children:(0,C.formatNumberWithCommas)(e.original.metadata?.additional_usage_values?.cache_read_input_tokens||0)})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Cache Creation Tokens:"}),(0,a.jsx)("span",{children:(0,C.formatNumberWithCommas)(e.original.metadata?.additional_usage_values.cache_creation_input_tokens)})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Cost:"}),(0,a.jsxs)("span",{children:["$",(0,C.formatNumberWithCommas)(e.original.spend||0,6)]})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Cache Hit:"}),(0,a.jsx)("span",{children:e.original.cache_hit})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Status:"}),(0,a.jsx)("span",{className:`px-2 py-1 rounded-md text-xs font-medium inline-block text-center w-16 ${"failure"!==(e.original.metadata?.status||"Success").toLowerCase()?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:"failure"!==(e.original.metadata?.status||"Success").toLowerCase()?"Success":"Failure"})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Start Time:"}),(0,a.jsx)("span",{children:e.original.startTime})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"End Time:"}),(0,a.jsx)("span",{children:e.original.endTime})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"Duration:"}),(0,a.jsxs)("span",{children:[e.original.duration," s."]})]}),e.original.metadata?.litellm_overhead_time_ms!==void 0&&(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"font-medium w-1/3",children:"LiteLLM Overhead:"}),(0,a.jsxs)("span",{children:[e.original.metadata.litellm_overhead_time_ms," ms"]})]})]})]})]}),(0,a.jsx)(ej,{costBreakdown:e.original.metadata?.cost_breakdown,totalSpend:e.original.spend||0}),(0,a.jsx)(ep,{show:!i&&!d,onOpenSettings:s}),(0,a.jsx)("div",{className:"w-full max-w-full overflow-hidden",children:(0,a.jsx)(eY,{row:e,hasMessages:i,hasResponse:d,hasError:r,errorInfo:n,getRawRequest:()=>e.original?.proxy_server_request?t(e.original.proxy_server_request):t(e.original.messages),formattedResponse:()=>r&&n?{error:{message:n.error_message||"An error occurred",type:n.error_class||"error",code:n.error_code||"unknown",param:null}}:t(e.original.response)})}),u&&(0,a.jsx)(S,{data:m}),c&&(0,a.jsx)(sc,{data:l.vector_store_request_metadata}),r&&n&&(0,a.jsx)(ey,{errorInfo:n}),e.original.request_tags&&Object.keys(e.original.request_tags).length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsx)("div",{className:"flex justify-between items-center p-4 border-b",children:(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Request Tags"})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(e.original.request_tags).map(([e,s])=>(0,a.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[e,": ",String(s)]},e))})})]}),e.original.metadata&&Object.keys(e.original.metadata).length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Metadata"}),(0,a.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(e.original.metadata,null,2))},className:"p-1 hover:bg-gray-200 rounded",title:"Copy metadata",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,a.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),(0,a.jsx)("div",{className:"p-4 overflow-auto max-h-64",children:(0,a.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:JSON.stringify(e.original.metadata,null,2)})})]})]})}}]);