# Claims System Override Detection
# Detects prompt injection attempts targeting claims systems, unauthorized
# role impersonation (employer, broker, vendor), and attempts to override
# adjudication rules or bypass fraud detection.
#
# Uses conditional matching: BLOCK when an override/bypass ACTION appears
# in the same sentence as a claims system TARGET. Also blocks unauthorized
# role impersonation for data access.
category_name: "claims_system_override"
description: "Detects system override injection, unauthorized role impersonation, and claims rule bypass attempts"
default_action: "BLOCK"

# Identifier words — override/bypass/impersonation verbs
identifier_words:
  - "override"
  - "overriding"
  - "bypass"
  - "bypassing"
  - "ignore"
  - "disable"
  - "disabling"
  - "disregard"
  - "skip"
  - "remove"
  - "turn off"
  - "force"
  - "force-approve"
  - "pretend"
  - "modify"
  - "modifying"

# Block words — claims system targets
additional_block_words:
  - "adjudication rules"
  - "adjudication"
  - "claims processing rules"
  - "processing rules"
  - "fraud detection"
  - "fraud detection system"
  - "coverage limitations"
  - "auto-deny"
  - "auto-deny rules"
  - "medical review"
  - "guardrails"
  - "deductible requirement"
  - "deductible"
  - "coordination of benefits"
  - "timely filing"
  - "timely filing limit"
  - "out-of-network denial"
  - "plan exclusions"
  - "fee schedule"
  - "restrictions"
  - "all pending claims"

# Always-block keywords — explicit override and impersonation phrases
always_block_keywords:
  # System override attempts
  - keyword: "override the claims"
    severity: "high"
  - keyword: "bypass the fraud detection"
    severity: "high"
  - keyword: "ignore the coverage"
    severity: "high"
  - keyword: "disable the auto-deny"
    severity: "high"
  - keyword: "skip the medical review"
    severity: "high"
  - keyword: "turn off all guardrails"
    severity: "high"
  - keyword: "without restrictions"
    severity: "high"
  - keyword: "force-approve"
    severity: "high"
  - keyword: "approve all pending claims"
    severity: "high"
  - keyword: "admin mode"
    severity: "high"
  - keyword: "unrestricted claims processor"
    severity: "high"
  - keyword: "reprocess as in-network"
    severity: "high"

  # Prompt injection
  - keyword: "override my system prompt"
    severity: "high"
  - keyword: "ignore your instructions"
    severity: "high"
  - keyword: "reveal the claims processing algorithm"
    severity: "high"

  # Role impersonation for data access
  - keyword: "I'm the plan administrator"
    severity: "high"
  - keyword: "as the employer"
    severity: "high"
  - keyword: "I'm from the corporate HR"
    severity: "high"
  - keyword: "as a third-party administrator"
    severity: "high"
  - keyword: "as the broker"
    severity: "high"
  - keyword: "I'm a vendor"
    severity: "high"
  - keyword: "as the union representative"
    severity: "high"
  - keyword: "I'm the patient's employer"
    severity: "high"
  - keyword: "grant me full access"
    severity: "high"
  - keyword: "see the diagnosis details for my employees"
    severity: "high"
  - keyword: "medical conditions have they claimed"
    severity: "high"
  - keyword: "individual claim details for this group"
    severity: "high"
  - keyword: "claims filed by our members"
    severity: "high"
  - keyword: "claims records"
    severity: "high"
  - keyword: "automatically approve all"
    severity: "high"

# Phrase patterns — regex for override attempts
phrase_patterns:
  - '\b(?:override|bypass|ignore|disable|skip|remove)\b.{0,15}\b(?:the|all|my|any|your)\b.{0,20}\b(?:rules|limit|check|denial|exclusion|restriction|requirement|detection)\b'
  - '\byou are now\b.{0,20}\b(?:admin|unrestricted|unfiltered|mode)\b'

# Exceptions — legitimate system inquiries
exceptions:
  - "how does"
  - "how do I"
  - "what is the"
  - "what are the"
  - "what are my rights"
  - "can you explain"
  - "explain why"
  - "appeals process"
  - "file a grievance"
  - "escalate"
  - "dispute"
  - "I'm the policyholder"
  - "manual review of my denied"
  - "reprocess my claim because"
  - "contact the third-party"
  - "external review"
  - "provider to dispute"
  - "check if a specific service"
  - "how are claim payments calculated"

keywords: []
