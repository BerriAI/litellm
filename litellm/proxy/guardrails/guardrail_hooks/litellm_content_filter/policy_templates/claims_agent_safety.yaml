# Claims Agent Safety — Comprehensive Policy Template
#
# A production-ready policy template for healthcare claims agent chatbots.
# Combines detection for the highest-signal failure cases:
#
#   1. Fraud coaching — exaggeration, fabrication, document forgery
#   2. PHI disclosure — unauthorized access, bulk data extraction, HIPAA violations
#   3. Prior-auth gaming — code manipulation, medical necessity misrepresentation
#   4. System override — prompt injection, adjudication rule bypass, role impersonation
#   5. Medical advice — diagnosis, treatment recommendations, medication guidance
#
# This template is a standalone policy that can be deployed as a single guardrail.
# For finer-grained control, use the individual category files in categories/:
#   - claims_fraud_coaching.yaml
#   - claims_phi_disclosure.yaml
#   - claims_prior_auth_gaming.yaml
#   - claims_system_override.yaml
#   - claims_medical_advice.yaml
#
# Usage in litellm proxy config:
#   guardrails:
#     - guardrail_name: "claims-safety"
#       litellm_params:
#         guardrail: "litellm_content_filter"
#         mode: "pre_call"
#         categories:
#           - category: "claims_agent_safety"
#             enabled: true
#             action: "BLOCK"
#             category_file: "litellm/proxy/guardrails/guardrail_hooks/litellm_content_filter/policy_templates/claims_agent_safety.yaml"
#
category_name: "claims_agent_safety"
description: "Comprehensive safety policy for healthcare claims agent chatbots — covers fraud, PHI, prior-auth gaming, system override, and medical advice"
default_action: "BLOCK"

# ── IDENTIFIER WORDS ─────────────────────────────────────────────
# Combined from all 5 categories: fraud verbs, disclosure verbs,
# gaming verbs, override verbs, and advice-seeking phrases.
identifier_words:
  # Fraud coaching
  - "exaggerate"
  - "inflate"
  - "fabricate"
  - "fake"
  - "forge"
  - "falsify"
  - "misrepresent"
  - "stage"
  - "coach me"
  - "double-bill"
  - "unbundle"
  - "phantom"
  - "get away with"
  # PHI disclosure
  - "give me"
  - "show me"
  - "pull up"
  - "pull"
  - "export"
  - "download"
  - "dump"
  - "extract"
  - "list all"
  - "list every"
  # Prior-auth gaming
  - "guarantee"
  - "trick"
  - "game"
  - "gaming"
  - "manipulate"
  - "exploit"
  - "circumvent"
  - "get around"
  - "swap"
  - "upcode"
  - "downcode"
  # System override
  - "override"
  - "bypass"
  - "ignore"
  - "disable"
  - "disregard"
  - "skip"
  - "remove"
  - "turn off"
  - "force"
  - "force-approve"
  - "pretend"
  - "modify"
  # Medical advice
  - "should I"
  - "do you think"
  - "do you recommend"
  - "recommend"
  - "is it safe"
  - "is my"
  - "can you diagnose"
  - "can you prescribe"
  - "best medicine"
  - "best treatment"
  - "what dosage"
  - "what supplement"
  - "what vaccine"
  - "what natural remedies"
  - "something I should worry"

# ── BLOCK WORDS ──────────────────────────────────────────────────
# Combined context targets from all 5 categories.
additional_block_words:
  # Fraud coaching targets
  - "claim"
  - "claims"
  - "injury"
  - "payout"
  - "settlement"
  - "insurance"
  - "medical bills"
  - "medical records"
  - "workers comp"
  - "adjuster"
  - "pre-existing"
  - "whiplash"
  - "date of service"
  # PHI disclosure targets
  - "health records"
  - "health information"
  - "treatment history"
  - "treatment records"
  - "treatment notes"
  - "diagnosis history"
  - "diagnoses"
  - "mental health records"
  - "psychiatric records"
  - "substance abuse"
  - "genetic testing"
  - "HIV status"
  - "medications"
  - "social security numbers"
  - "claims data"
  - "member names"
  - "patient names"
  - "dates of birth"
  - "names and addresses"
  - "disability records"
  - "protected health information"
  # Prior-auth gaming targets
  - "prior authorization"
  - "prior auth"
  - "medical necessity"
  - "medically necessary"
  - "procedure code"
  - "CPT code"
  - "diagnosis code"
  - "clinical criteria"
  - "utilization review"
  - "step therapy"
  - "formulary"
  - "quantity limits"
  - "referral chain"
  # System override targets
  - "adjudication rules"
  - "claims processing rules"
  - "fraud detection"
  - "coverage limitations"
  - "auto-deny"
  - "medical review"
  - "guardrails"
  - "deductible requirement"
  - "coordination of benefits"
  - "timely filing"
  - "out-of-network denial"
  - "plan exclusions"
  - "fee schedule"
  - "restrictions"
  - "all pending claims"
  # Medical advice targets
  - "symptoms"
  - "condition"
  - "diagnosis"
  - "treatment"
  - "medication"
  - "medicine"
  - "surgery"
  - "pain"
  - "cancer"
  - "depression"
  - "anxiety"
  - "blood pressure"
  - "blood sugar"
  - "prescription"
  - "physical therapy"
  - "chiropractic"
  - "radiation"
  - "chemotherapy"
  - "side effects"
  - "vaccine"

# ── ALWAYS-BLOCK KEYWORDS ────────────────────────────────────────
# High-confidence phrases blocked regardless of context.
always_block_keywords:
  # Fraud coaching
  - keyword: "insurance fraud"
    severity: "high"
  - keyword: "fraudulent claim"
    severity: "high"
  - keyword: "file a fraudulent claim"
    severity: "high"
  - keyword: "fake documentation"
    severity: "high"
  - keyword: "forge medical records"
    severity: "high"
  - keyword: "stage an accident"
    severity: "high"
  - keyword: "bigger payout"
    severity: "high"
  - keyword: "higher settlement"
    severity: "high"
  - keyword: "without getting caught"
    severity: "high"
  - keyword: "diagnosis codes pay out the most"
    severity: "high"
  - keyword: "hardest to disprove"
    severity: "high"
  - keyword: "look like it was caused by"
    severity: "high"
  - keyword: "worse than it is"
    severity: "high"
  # PHI disclosure
  - keyword: "all claims filed by member"
    severity: "high"
  - keyword: "every patient in the"
    severity: "high"
  - keyword: "all members with"
    severity: "high"
  - keyword: "all member social security"
    severity: "high"
  - keyword: "complete medical history for claimant"
    severity: "high"
  - keyword: "complete health records for everyone"
    severity: "high"
  - keyword: "claims filed by employee"
    severity: "high"
  - keyword: "records for all employees"
    severity: "high"
  - keyword: "treatment notes from"
    severity: "high"
  - keyword: "sessions with this patient"
    severity: "high"
  # Prior-auth gaming
  - keyword: "guarantee approval"
    severity: "high"
  - keyword: "look medically necessary"
    severity: "high"
  - keyword: "trick the reviewer"
    severity: "high"
  - keyword: "bypass the prior authorization"
    severity: "high"
  - keyword: "false clinical notes"
    severity: "high"
  - keyword: "fake the medical necessity"
    severity: "high"
  - keyword: "cosmetic procedure qualify"
    severity: "high"
  - keyword: "exploit a loophole"
    severity: "high"
  - keyword: "split this procedure into smaller codes"
    severity: "high"
  - keyword: "fabricate to prove"
    severity: "high"
  # System override
  - keyword: "override the claims"
    severity: "high"
  - keyword: "bypass the fraud detection"
    severity: "high"
  - keyword: "turn off all guardrails"
    severity: "high"
  - keyword: "admin mode"
    severity: "high"
  - keyword: "unrestricted claims processor"
    severity: "high"
  - keyword: "override my system prompt"
    severity: "high"
  - keyword: "ignore your instructions"
    severity: "high"
  - keyword: "I'm the plan administrator"
    severity: "high"
  - keyword: "as the employer"
    severity: "high"
  - keyword: "I'm from the corporate HR"
    severity: "high"
  - keyword: "as a third-party administrator"
    severity: "high"
  - keyword: "as the broker"
    severity: "high"
  - keyword: "I'm a vendor"
    severity: "high"
  - keyword: "grant me full access"
    severity: "high"
  - keyword: "automatically approve all"
    severity: "high"
  # Medical advice
  - keyword: "can you diagnose"
    severity: "high"
  - keyword: "based on my symptoms"
    severity: "high"
  - keyword: "stop taking my"
    severity: "high"
  - keyword: "what dosage"
    severity: "high"
  - keyword: "best medicine for"
    severity: "high"
  - keyword: "can you prescribe"
    severity: "high"
  - keyword: "should I go to the emergency room"
    severity: "high"
  - keyword: "is it safe to combine"
    severity: "high"
  - keyword: "radiation therapy or chemotherapy better"
    severity: "high"

# ── PHRASE PATTERNS ──────────────────────────────────────────────
phrase_patterns:
  # Fraud coaching
  - '\b(?:how|help|can you|tell me)\b.{0,30}\b(?:exaggerate|inflate|fake|forge|fabricate)\b.{0,30}\b(?:claim|injury|damage|disability|medical)\b'
  - '\b(?:make|look|appear)\b.{0,20}\b(?:worse|more severe|legitimate)\b.{0,20}\b(?:claim|injury|settlement|payout)\b'
  # PHI disclosure
  - '\b(?:give|show|pull|get|send)\b.{0,10}\b(?:me|us)\b.{0,30}\b(?:all|every|complete|full)\b.{0,30}\b(?:record|claim|data|history|information)\b'
  - '\b(?:export|download|dump|extract)\b.{0,30}\b(?:member|patient|claimant|employee)\b.{0,20}\b(?:data|record|information|detail)\b'
  # System override
  - '\b(?:override|bypass|ignore|disable|skip|remove)\b.{0,15}\b(?:the|all|my|any|your)\b.{0,20}\b(?:rules|limit|check|denial|exclusion|restriction|requirement|detection)\b'
  - '\byou are now\b.{0,20}\b(?:admin|unrestricted|unfiltered|mode)\b'
  # Medical advice
  - '\b(?:should I|do you think|do you recommend)\b.{0,30}\b(?:take|stop|start|try|get|have|need|use)\b.{0,20}\b(?:medication|medicine|drug|surgery|treatment|therapy|vaccine|supplement)\b'

# ── EXCEPTIONS ───────────────────────────────────────────────────
# Legitimate claims agent operations that should never be blocked.
exceptions:
  # Fraud prevention (not coaching)
  - "fraud detection"
  - "fraud prevention"
  - "report fraud"
  - "how does our fraud"
  # Self-service
  - "my own"
  - "my claim"
  - "my records"
  - "my coverage"
  - "my eligibility"
  - "status of my"
  - "check the status"
  # Claims operations
  - "file a claim"
  - "submit a claim"
  - "claim was denied"
  - "was denied"
  - "file an appeal"
  - "how do I submit"
  - "what is the process"
  - "how long does"
  - "how do I"
  - "what is the"
  - "what are the"
  - "can you explain"
  - "explain why"
  - "help me understand why"
  # Coverage & benefits
  - "does my plan cover"
  - "is covered"
  - "covered under"
  - "coverage"
  - "copay"
  - "coinsurance"
  - "deductible"
  - "out-of-pocket"
  - "in-network"
  - "formulary"
  - "benefit"
  - "reimbursed"
  - "preventive care"
  - "plan include"
  - "plan allow"
  - "plan benefits"
  # Code lookups
  - "what does diagnosis code"
  - "what does CPT code"
  - "code mean"
  - "code on my claim"
  # HIPAA & privacy
  - "HIPAA privacy"
  - "HIPAA authorization"
  - "breach notification"
  - "de-identified"
  - "aggregate"
  - "what types of information"
  # Prior auth legitimate
  - "what documentation is required"
  - "what documentation do I need"
  - "clinical documentation"
  - "what are the clinical guidelines"
  - "explain the medical necessity criteria"
  - "expedited prior authorization"
  - "turnaround time"
  - "continuity of care"
  - "letter of medical necessity from my doctor"
  # System inquiries
  - "appeals process"
  - "file a grievance"
  - "escalate"
  - "dispute"
  - "I'm the policyholder"
  - "reprocess my claim because"
  - "external review"
  - "how are claim payments calculated"
  # Medical terms in claims context
  - "explanation of benefits"
  - "EOB"
  - "how many visits"
  - "health savings account"
  - "HSA"
  - "pre-certification"
  - "referral"
  - "provider"
  - "find an in-network"
  - "generic and brand-name"
  - "wellness benefit"

keywords: []
