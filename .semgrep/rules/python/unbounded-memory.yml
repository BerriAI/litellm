# Unbounded memory growth – data structures without a clear max limit
# Can lead to OOM under load or with unbounded input.

rules:
  # asyncio.Queue() with no maxsize is unbounded – bad pattern for integrations (log queues, etc.)
  - id: unbounded-asyncio-queue
    message: asyncio.Queue() with no maxsize can grow unbounded. Use asyncio.Queue(maxsize=N) for integrations (e.g. log queues).
    severity: WARNING
    languages: [python]
    pattern-either:
      - pattern: asyncio.Queue()
      - pattern: asyncio.Queue(maxsize=0)
    metadata:
      category: correctness
      cwe: "CWE-400: Uncontrolled Resource Consumption"
